var bY=Object.defineProperty;var vY=(e,t,r)=>t in e?bY(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Mi=(e,t,r)=>vY(e,typeof t!="symbol"?t+"":t,r);function wY(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var lMe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function sf(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var nB={exports:{}},Qw={},iB={exports:{}},bi={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var q1=Symbol.for("react.element"),SY=Symbol.for("react.portal"),_Y=Symbol.for("react.fragment"),jY=Symbol.for("react.strict_mode"),kY=Symbol.for("react.profiler"),AY=Symbol.for("react.provider"),NY=Symbol.for("react.context"),CY=Symbol.for("react.forward_ref"),EY=Symbol.for("react.suspense"),TY=Symbol.for("react.memo"),PY=Symbol.for("react.lazy"),fT=Symbol.iterator;function OY(e){return e===null||typeof e!="object"?null:(e=fT&&e[fT]||e["@@iterator"],typeof e=="function"?e:null)}var aB={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},sB=Object.assign,oB={};function Jm(e,t,r){this.props=e,this.context=t,this.refs=oB,this.updater=r||aB}Jm.prototype.isReactComponent={};Jm.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Jm.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function lB(){}lB.prototype=Jm.prototype;function pN(e,t,r){this.props=e,this.context=t,this.refs=oB,this.updater=r||aB}var mN=pN.prototype=new lB;mN.constructor=pN;sB(mN,Jm.prototype);mN.isPureReactComponent=!0;var hT=Array.isArray,cB=Object.prototype.hasOwnProperty,gN={current:null},uB={key:!0,ref:!0,__self:!0,__source:!0};function dB(e,t,r){var n,i={},s=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)cB.call(t,n)&&!uB.hasOwnProperty(n)&&(i[n]=t[n]);var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)i[n]===void 0&&(i[n]=l[n]);return{$$typeof:q1,type:e,key:s,ref:o,props:i,_owner:gN.current}}function MY(e,t){return{$$typeof:q1,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function xN(e){return typeof e=="object"&&e!==null&&e.$$typeof===q1}function LY(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var pT=/\/+/g;function m5(e,t){return typeof e=="object"&&e!==null&&e.key!=null?LY(""+e.key):t.toString(36)}function kv(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case q1:case SY:o=!0}}if(o)return o=e,i=i(o),e=n===""?"."+m5(o,0):n,hT(i)?(r="",e!=null&&(r=e.replace(pT,"$&/")+"/"),kv(i,t,r,"",function(u){return u})):i!=null&&(xN(i)&&(i=MY(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(pT,"$&/")+"/")+e)),t.push(i)),1;if(o=0,n=n===""?".":n+":",hT(e))for(var l=0;l<e.length;l++){s=e[l];var c=n+m5(s,l);o+=kv(s,t,r,c,i)}else if(c=OY(e),typeof c=="function")for(e=c.call(e),l=0;!(s=e.next()).done;)s=s.value,c=n+m5(s,l++),o+=kv(s,t,r,c,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function nb(e,t,r){if(e==null)return e;var n=[],i=0;return kv(e,n,"","",function(s){return t.call(r,s,i++)}),n}function RY(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var dl={current:null},Av={transition:null},FY={ReactCurrentDispatcher:dl,ReactCurrentBatchConfig:Av,ReactCurrentOwner:gN};function fB(){throw Error("act(...) is not supported in production builds of React.")}bi.Children={map:nb,forEach:function(e,t,r){nb(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return nb(e,function(){t++}),t},toArray:function(e){return nb(e,function(t){return t})||[]},only:function(e){if(!xN(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};bi.Component=Jm;bi.Fragment=_Y;bi.Profiler=kY;bi.PureComponent=pN;bi.StrictMode=jY;bi.Suspense=EY;bi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FY;bi.act=fB;bi.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=sB({},e.props),i=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=gN.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)cB.call(t,c)&&!uB.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:q1,type:e.type,key:i,ref:s,props:n,_owner:o}};bi.createContext=function(e){return e={$$typeof:NY,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:AY,_context:e},e.Consumer=e};bi.createElement=dB;bi.createFactory=function(e){var t=dB.bind(null,e);return t.type=e,t};bi.createRef=function(){return{current:null}};bi.forwardRef=function(e){return{$$typeof:CY,render:e}};bi.isValidElement=xN;bi.lazy=function(e){return{$$typeof:PY,_payload:{_status:-1,_result:e},_init:RY}};bi.memo=function(e,t){return{$$typeof:TY,type:e,compare:t===void 0?null:t}};bi.startTransition=function(e){var t=Av.transition;Av.transition={};try{e()}finally{Av.transition=t}};bi.unstable_act=fB;bi.useCallback=function(e,t){return dl.current.useCallback(e,t)};bi.useContext=function(e){return dl.current.useContext(e)};bi.useDebugValue=function(){};bi.useDeferredValue=function(e){return dl.current.useDeferredValue(e)};bi.useEffect=function(e,t){return dl.current.useEffect(e,t)};bi.useId=function(){return dl.current.useId()};bi.useImperativeHandle=function(e,t,r){return dl.current.useImperativeHandle(e,t,r)};bi.useInsertionEffect=function(e,t){return dl.current.useInsertionEffect(e,t)};bi.useLayoutEffect=function(e,t){return dl.current.useLayoutEffect(e,t)};bi.useMemo=function(e,t){return dl.current.useMemo(e,t)};bi.useReducer=function(e,t,r){return dl.current.useReducer(e,t,r)};bi.useRef=function(e){return dl.current.useRef(e)};bi.useState=function(e){return dl.current.useState(e)};bi.useSyncExternalStore=function(e,t,r){return dl.current.useSyncExternalStore(e,t,r)};bi.useTransition=function(){return dl.current.useTransition()};bi.version="18.3.1";iB.exports=bi;var x=iB.exports;const sn=sf(x),hB=wY({__proto__:null,default:sn},[x]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BY=x,IY=Symbol.for("react.element"),DY=Symbol.for("react.fragment"),$Y=Object.prototype.hasOwnProperty,UY=BY.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,zY={key:!0,ref:!0,__self:!0,__source:!0};function pB(e,t,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)$Y.call(t,n)&&!zY.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:IY,type:e,key:s,ref:o,props:i,_owner:UY.current}}Qw.Fragment=DY;Qw.jsx=pB;Qw.jsxs=pB;nB.exports=Qw;var a=nB.exports,mB={exports:{}},dc={},gB={exports:{}},xB={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(W,V){var ae=W.length;W.push(V);e:for(;0<ae;){var ee=ae-1>>>1,C=W[ee];if(0<i(C,V))W[ee]=V,W[ae]=C,ae=ee;else break e}}function r(W){return W.length===0?null:W[0]}function n(W){if(W.length===0)return null;var V=W[0],ae=W.pop();if(ae!==V){W[0]=ae;e:for(var ee=0,C=W.length,Y=C>>>1;ee<Y;){var q=2*(ee+1)-1,O=W[q],X=q+1,F=W[X];if(0>i(O,ae))X<C&&0>i(F,O)?(W[ee]=F,W[X]=ae,ee=X):(W[ee]=O,W[q]=ae,ee=q);else if(X<C&&0>i(F,ae))W[ee]=F,W[X]=ae,ee=X;else break e}}return V}function i(W,V){var ae=W.sortIndex-V.sortIndex;return ae!==0?ae:W.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,f=null,h=3,p=!1,m=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(W){for(var V=r(u);V!==null;){if(V.callback===null)n(u);else if(V.startTime<=W)n(u),V.sortIndex=V.expirationTime,t(c,V);else break;V=r(u)}}function S(W){if(g=!1,w(W),!m)if(r(c)!==null)m=!0,oe(j);else{var V=r(u);V!==null&&de(S,V.startTime-W)}}function j(W,V){m=!1,g&&(g=!1,b(R),R=-1),p=!0;var ae=h;try{for(w(V),f=r(c);f!==null&&(!(f.expirationTime>V)||W&&!E());){var ee=f.callback;if(typeof ee=="function"){f.callback=null,h=f.priorityLevel;var C=ee(f.expirationTime<=V);V=e.unstable_now(),typeof C=="function"?f.callback=C:f===r(c)&&n(c),w(V)}else n(c);f=r(c)}if(f!==null)var Y=!0;else{var q=r(u);q!==null&&de(S,q.startTime-V),Y=!1}return Y}finally{f=null,h=ae,p=!1}}var k=!1,A=null,R=-1,M=5,B=-1;function E(){return!(e.unstable_now()-B<M)}function P(){if(A!==null){var W=e.unstable_now();B=W;var V=!0;try{V=A(!0,W)}finally{V?U():(k=!1,A=null)}}else k=!1}var U;if(typeof v=="function")U=function(){v(P)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,H=G.port2;G.port1.onmessage=P,U=function(){H.postMessage(null)}}else U=function(){y(P,0)};function oe(W){A=W,k||(k=!0,U())}function de(W,V){R=y(function(){W(e.unstable_now())},V)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){m||p||(m=!0,oe(j))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(W){switch(h){case 1:case 2:case 3:var V=3;break;default:V=h}var ae=h;h=V;try{return W()}finally{h=ae}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,V){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var ae=h;h=W;try{return V()}finally{h=ae}},e.unstable_scheduleCallback=function(W,V,ae){var ee=e.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?ee+ae:ee):ae=ee,W){case 1:var C=-1;break;case 2:C=250;break;case 5:C=1073741823;break;case 4:C=1e4;break;default:C=5e3}return C=ae+C,W={id:d++,callback:V,priorityLevel:W,startTime:ae,expirationTime:C,sortIndex:-1},ae>ee?(W.sortIndex=ae,t(u,W),r(c)===null&&W===r(u)&&(g?(b(R),R=-1):g=!0,de(S,ae-ee))):(W.sortIndex=C,t(c,W),m||p||(m=!0,oe(j))),W},e.unstable_shouldYield=E,e.unstable_wrapCallback=function(W){var V=h;return function(){var ae=h;h=V;try{return W.apply(this,arguments)}finally{h=ae}}}})(xB);gB.exports=xB;var WY=gB.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qY=x,ac=WY;function Zr(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var yB=new Set,Wx={};function $0(e,t){Am(e,t),Am(e+"Capture",t)}function Am(e,t){for(Wx[e]=t,e=0;e<t.length;e++)yB.add(t[e])}var Hd=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Nk=Object.prototype.hasOwnProperty,HY=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,mT={},gT={};function VY(e){return Nk.call(gT,e)?!0:Nk.call(mT,e)?!1:HY.test(e)?gT[e]=!0:(mT[e]=!0,!1)}function GY(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function KY(e,t,r,n){if(t===null||typeof t>"u"||GY(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function fl(e,t,r,n,i,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var bo={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){bo[e]=new fl(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];bo[t]=new fl(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){bo[e]=new fl(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){bo[e]=new fl(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){bo[e]=new fl(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){bo[e]=new fl(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){bo[e]=new fl(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){bo[e]=new fl(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){bo[e]=new fl(e,5,!1,e.toLowerCase(),null,!1,!1)});var yN=/[\-:]([a-z])/g;function bN(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(yN,bN);bo[t]=new fl(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(yN,bN);bo[t]=new fl(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(yN,bN);bo[t]=new fl(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){bo[e]=new fl(e,1,!1,e.toLowerCase(),null,!1,!1)});bo.xlinkHref=new fl("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){bo[e]=new fl(e,1,!1,e.toLowerCase(),null,!0,!0)});function vN(e,t,r,n){var i=bo.hasOwnProperty(t)?bo[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(KY(t,r,i,n)&&(r=null),n||i===null?VY(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var of=qY.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ib=Symbol.for("react.element"),Up=Symbol.for("react.portal"),zp=Symbol.for("react.fragment"),wN=Symbol.for("react.strict_mode"),Ck=Symbol.for("react.profiler"),bB=Symbol.for("react.provider"),vB=Symbol.for("react.context"),SN=Symbol.for("react.forward_ref"),Ek=Symbol.for("react.suspense"),Tk=Symbol.for("react.suspense_list"),_N=Symbol.for("react.memo"),Lf=Symbol.for("react.lazy"),wB=Symbol.for("react.offscreen"),xT=Symbol.iterator;function Lg(e){return e===null||typeof e!="object"?null:(e=xT&&e[xT]||e["@@iterator"],typeof e=="function"?e:null)}var La=Object.assign,g5;function lx(e){if(g5===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);g5=t&&t[1]||""}return`
`+g5+e}var x5=!1;function y5(e,t){if(!e||x5)return"";x5=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var c=`
`+i[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{x5=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?lx(e):""}function YY(e){switch(e.tag){case 5:return lx(e.type);case 16:return lx("Lazy");case 13:return lx("Suspense");case 19:return lx("SuspenseList");case 0:case 2:case 15:return e=y5(e.type,!1),e;case 11:return e=y5(e.type.render,!1),e;case 1:return e=y5(e.type,!0),e;default:return""}}function Pk(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case zp:return"Fragment";case Up:return"Portal";case Ck:return"Profiler";case wN:return"StrictMode";case Ek:return"Suspense";case Tk:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case vB:return(e.displayName||"Context")+".Consumer";case bB:return(e._context.displayName||"Context")+".Provider";case SN:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case _N:return t=e.displayName||null,t!==null?t:Pk(e.type)||"Memo";case Lf:t=e._payload,e=e._init;try{return Pk(e(t))}catch{}}return null}function XY(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pk(t);case 8:return t===wN?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ch(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function SB(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function QY(e){var t=SB(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ab(e){e._valueTracker||(e._valueTracker=QY(e))}function _B(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=SB(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function r2(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ok(e,t){var r=t.checked;return La({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function yT(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=ch(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function jB(e,t){t=t.checked,t!=null&&vN(e,"checked",t,!1)}function Mk(e,t){jB(e,t);var r=ch(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Lk(e,t.type,r):t.hasOwnProperty("defaultValue")&&Lk(e,t.type,ch(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function bT(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Lk(e,t,r){(t!=="number"||r2(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var cx=Array.isArray;function sm(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ch(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Rk(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Zr(91));return La({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function vT(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Zr(92));if(cx(r)){if(1<r.length)throw Error(Zr(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ch(r)}}function kB(e,t){var r=ch(t.value),n=ch(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function wT(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function AB(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Fk(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?AB(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var sb,NB=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(sb=sb||document.createElement("div"),sb.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=sb.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function qx(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var bx={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},JY=["Webkit","ms","Moz","O"];Object.keys(bx).forEach(function(e){JY.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),bx[t]=bx[e]})});function CB(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||bx.hasOwnProperty(e)&&bx[e]?(""+t).trim():t+"px"}function EB(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=CB(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var ZY=La({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bk(e,t){if(t){if(ZY[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Zr(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Zr(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Zr(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Zr(62))}}function Ik(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Dk=null;function jN(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var $k=null,om=null,lm=null;function ST(e){if(e=G1(e)){if(typeof $k!="function")throw Error(Zr(280));var t=e.stateNode;t&&(t=rS(t),$k(e.stateNode,e.type,t))}}function TB(e){om?lm?lm.push(e):lm=[e]:om=e}function PB(){if(om){var e=om,t=lm;if(lm=om=null,ST(e),t)for(e=0;e<t.length;e++)ST(t[e])}}function OB(e,t){return e(t)}function MB(){}var b5=!1;function LB(e,t,r){if(b5)return e(t,r);b5=!0;try{return OB(e,t,r)}finally{b5=!1,(om!==null||lm!==null)&&(MB(),PB())}}function Hx(e,t){var r=e.stateNode;if(r===null)return null;var n=rS(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Zr(231,t,typeof r));return r}var Uk=!1;if(Hd)try{var Rg={};Object.defineProperty(Rg,"passive",{get:function(){Uk=!0}}),window.addEventListener("test",Rg,Rg),window.removeEventListener("test",Rg,Rg)}catch{Uk=!1}function eX(e,t,r,n,i,s,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var vx=!1,n2=null,i2=!1,zk=null,tX={onError:function(e){vx=!0,n2=e}};function rX(e,t,r,n,i,s,o,l,c){vx=!1,n2=null,eX.apply(tX,arguments)}function nX(e,t,r,n,i,s,o,l,c){if(rX.apply(this,arguments),vx){if(vx){var u=n2;vx=!1,n2=null}else throw Error(Zr(198));i2||(i2=!0,zk=u)}}function U0(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function RB(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function _T(e){if(U0(e)!==e)throw Error(Zr(188))}function iX(e){var t=e.alternate;if(!t){if(t=U0(e),t===null)throw Error(Zr(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return _T(i),e;if(s===n)return _T(i),t;s=s.sibling}throw Error(Zr(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o)throw Error(Zr(189))}}if(r.alternate!==n)throw Error(Zr(190))}if(r.tag!==3)throw Error(Zr(188));return r.stateNode.current===r?e:t}function FB(e){return e=iX(e),e!==null?BB(e):null}function BB(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=BB(e);if(t!==null)return t;e=e.sibling}return null}var IB=ac.unstable_scheduleCallback,jT=ac.unstable_cancelCallback,aX=ac.unstable_shouldYield,sX=ac.unstable_requestPaint,ts=ac.unstable_now,oX=ac.unstable_getCurrentPriorityLevel,kN=ac.unstable_ImmediatePriority,DB=ac.unstable_UserBlockingPriority,a2=ac.unstable_NormalPriority,lX=ac.unstable_LowPriority,$B=ac.unstable_IdlePriority,Jw=null,Ju=null;function cX(e){if(Ju&&typeof Ju.onCommitFiberRoot=="function")try{Ju.onCommitFiberRoot(Jw,e,void 0,(e.current.flags&128)===128)}catch{}}var hu=Math.clz32?Math.clz32:fX,uX=Math.log,dX=Math.LN2;function fX(e){return e>>>=0,e===0?32:31-(uX(e)/dX|0)|0}var ob=64,lb=4194304;function ux(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function s2(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~i;l!==0?n=ux(l):(s&=o,s!==0&&(n=ux(s)))}else o=r&~i,o!==0?n=ux(o):s!==0&&(n=ux(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-hu(t),i=1<<r,n|=e[r],t&=~i;return n}function hX(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pX(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-hu(s),l=1<<o,c=i[o];c===-1?(!(l&r)||l&n)&&(i[o]=hX(l,t)):c<=t&&(e.expiredLanes|=l),s&=~l}}function Wk(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function UB(){var e=ob;return ob<<=1,!(ob&4194240)&&(ob=64),e}function v5(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function H1(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-hu(t),e[t]=r}function mX(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-hu(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function AN(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-hu(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Gi=0;function zB(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var WB,NN,qB,HB,VB,qk=!1,cb=[],Xf=null,Qf=null,Jf=null,Vx=new Map,Gx=new Map,If=[],gX="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function kT(e,t){switch(e){case"focusin":case"focusout":Xf=null;break;case"dragenter":case"dragleave":Qf=null;break;case"mouseover":case"mouseout":Jf=null;break;case"pointerover":case"pointerout":Vx.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gx.delete(t.pointerId)}}function Fg(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=G1(t),t!==null&&NN(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function xX(e,t,r,n,i){switch(t){case"focusin":return Xf=Fg(Xf,e,t,r,n,i),!0;case"dragenter":return Qf=Fg(Qf,e,t,r,n,i),!0;case"mouseover":return Jf=Fg(Jf,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return Vx.set(s,Fg(Vx.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Gx.set(s,Fg(Gx.get(s)||null,e,t,r,n,i)),!0}return!1}function GB(e){var t=Vh(e.target);if(t!==null){var r=U0(t);if(r!==null){if(t=r.tag,t===13){if(t=RB(r),t!==null){e.blockedOn=t,VB(e.priority,function(){qB(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Nv(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Hk(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Dk=n,r.target.dispatchEvent(n),Dk=null}else return t=G1(r),t!==null&&NN(t),e.blockedOn=r,!1;t.shift()}return!0}function AT(e,t,r){Nv(e)&&r.delete(t)}function yX(){qk=!1,Xf!==null&&Nv(Xf)&&(Xf=null),Qf!==null&&Nv(Qf)&&(Qf=null),Jf!==null&&Nv(Jf)&&(Jf=null),Vx.forEach(AT),Gx.forEach(AT)}function Bg(e,t){e.blockedOn===t&&(e.blockedOn=null,qk||(qk=!0,ac.unstable_scheduleCallback(ac.unstable_NormalPriority,yX)))}function Kx(e){function t(i){return Bg(i,e)}if(0<cb.length){Bg(cb[0],e);for(var r=1;r<cb.length;r++){var n=cb[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Xf!==null&&Bg(Xf,e),Qf!==null&&Bg(Qf,e),Jf!==null&&Bg(Jf,e),Vx.forEach(t),Gx.forEach(t),r=0;r<If.length;r++)n=If[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<If.length&&(r=If[0],r.blockedOn===null);)GB(r),r.blockedOn===null&&If.shift()}var cm=of.ReactCurrentBatchConfig,o2=!0;function bX(e,t,r,n){var i=Gi,s=cm.transition;cm.transition=null;try{Gi=1,CN(e,t,r,n)}finally{Gi=i,cm.transition=s}}function vX(e,t,r,n){var i=Gi,s=cm.transition;cm.transition=null;try{Gi=4,CN(e,t,r,n)}finally{Gi=i,cm.transition=s}}function CN(e,t,r,n){if(o2){var i=Hk(e,t,r,n);if(i===null)T5(e,t,n,l2,r),kT(e,n);else if(xX(i,e,t,r,n))n.stopPropagation();else if(kT(e,n),t&4&&-1<gX.indexOf(e)){for(;i!==null;){var s=G1(i);if(s!==null&&WB(s),s=Hk(e,t,r,n),s===null&&T5(e,t,n,l2,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else T5(e,t,n,null,r)}}var l2=null;function Hk(e,t,r,n){if(l2=null,e=jN(n),e=Vh(e),e!==null)if(t=U0(e),t===null)e=null;else if(r=t.tag,r===13){if(e=RB(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return l2=e,null}function KB(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(oX()){case kN:return 1;case DB:return 4;case a2:case lX:return 16;case $B:return 536870912;default:return 16}default:return 16}}var Wf=null,EN=null,Cv=null;function YB(){if(Cv)return Cv;var e,t=EN,r=t.length,n,i="value"in Wf?Wf.value:Wf.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===i[s-n];n++);return Cv=i.slice(e,1<n?1-n:void 0)}function Ev(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ub(){return!0}function NT(){return!1}function fc(e){function t(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?ub:NT,this.isPropagationStopped=NT,this}return La(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=ub)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=ub)},persist:function(){},isPersistent:ub}),t}var Zm={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},TN=fc(Zm),V1=La({},Zm,{view:0,detail:0}),wX=fc(V1),w5,S5,Ig,Zw=La({},V1,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:PN,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ig&&(Ig&&e.type==="mousemove"?(w5=e.screenX-Ig.screenX,S5=e.screenY-Ig.screenY):S5=w5=0,Ig=e),w5)},movementY:function(e){return"movementY"in e?e.movementY:S5}}),CT=fc(Zw),SX=La({},Zw,{dataTransfer:0}),_X=fc(SX),jX=La({},V1,{relatedTarget:0}),_5=fc(jX),kX=La({},Zm,{animationName:0,elapsedTime:0,pseudoElement:0}),AX=fc(kX),NX=La({},Zm,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),CX=fc(NX),EX=La({},Zm,{data:0}),ET=fc(EX),TX={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},PX={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},OX={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function MX(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=OX[e])?!!t[e]:!1}function PN(){return MX}var LX=La({},V1,{key:function(e){if(e.key){var t=TX[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ev(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?PX[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:PN,charCode:function(e){return e.type==="keypress"?Ev(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ev(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),RX=fc(LX),FX=La({},Zw,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),TT=fc(FX),BX=La({},V1,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:PN}),IX=fc(BX),DX=La({},Zm,{propertyName:0,elapsedTime:0,pseudoElement:0}),$X=fc(DX),UX=La({},Zw,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),zX=fc(UX),WX=[9,13,27,32],ON=Hd&&"CompositionEvent"in window,wx=null;Hd&&"documentMode"in document&&(wx=document.documentMode);var qX=Hd&&"TextEvent"in window&&!wx,XB=Hd&&(!ON||wx&&8<wx&&11>=wx),PT=" ",OT=!1;function QB(e,t){switch(e){case"keyup":return WX.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function JB(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Wp=!1;function HX(e,t){switch(e){case"compositionend":return JB(t);case"keypress":return t.which!==32?null:(OT=!0,PT);case"textInput":return e=t.data,e===PT&&OT?null:e;default:return null}}function VX(e,t){if(Wp)return e==="compositionend"||!ON&&QB(e,t)?(e=YB(),Cv=EN=Wf=null,Wp=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return XB&&t.locale!=="ko"?null:t.data;default:return null}}var GX={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function MT(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!GX[e.type]:t==="textarea"}function ZB(e,t,r,n){TB(n),t=c2(t,"onChange"),0<t.length&&(r=new TN("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Sx=null,Yx=null;function KX(e){uI(e,0)}function eS(e){var t=Vp(e);if(_B(t))return e}function YX(e,t){if(e==="change")return t}var eI=!1;if(Hd){var j5;if(Hd){var k5="oninput"in document;if(!k5){var LT=document.createElement("div");LT.setAttribute("oninput","return;"),k5=typeof LT.oninput=="function"}j5=k5}else j5=!1;eI=j5&&(!document.documentMode||9<document.documentMode)}function RT(){Sx&&(Sx.detachEvent("onpropertychange",tI),Yx=Sx=null)}function tI(e){if(e.propertyName==="value"&&eS(Yx)){var t=[];ZB(t,Yx,e,jN(e)),LB(KX,t)}}function XX(e,t,r){e==="focusin"?(RT(),Sx=t,Yx=r,Sx.attachEvent("onpropertychange",tI)):e==="focusout"&&RT()}function QX(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return eS(Yx)}function JX(e,t){if(e==="click")return eS(t)}function ZX(e,t){if(e==="input"||e==="change")return eS(t)}function eQ(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var yu=typeof Object.is=="function"?Object.is:eQ;function Xx(e,t){if(yu(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Nk.call(t,i)||!yu(e[i],t[i]))return!1}return!0}function FT(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function BT(e,t){var r=FT(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=FT(r)}}function rI(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?rI(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function nI(){for(var e=window,t=r2();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=r2(e.document)}return t}function MN(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function tQ(e){var t=nI(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&rI(r.ownerDocument.documentElement,r)){if(n!==null&&MN(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=BT(r,s);var o=BT(r,n);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var rQ=Hd&&"documentMode"in document&&11>=document.documentMode,qp=null,Vk=null,_x=null,Gk=!1;function IT(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Gk||qp==null||qp!==r2(n)||(n=qp,"selectionStart"in n&&MN(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),_x&&Xx(_x,n)||(_x=n,n=c2(Vk,"onSelect"),0<n.length&&(t=new TN("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=qp)))}function db(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Hp={animationend:db("Animation","AnimationEnd"),animationiteration:db("Animation","AnimationIteration"),animationstart:db("Animation","AnimationStart"),transitionend:db("Transition","TransitionEnd")},A5={},iI={};Hd&&(iI=document.createElement("div").style,"AnimationEvent"in window||(delete Hp.animationend.animation,delete Hp.animationiteration.animation,delete Hp.animationstart.animation),"TransitionEvent"in window||delete Hp.transitionend.transition);function tS(e){if(A5[e])return A5[e];if(!Hp[e])return e;var t=Hp[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in iI)return A5[e]=t[r];return e}var aI=tS("animationend"),sI=tS("animationiteration"),oI=tS("animationstart"),lI=tS("transitionend"),cI=new Map,DT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function vh(e,t){cI.set(e,t),$0(t,[e])}for(var N5=0;N5<DT.length;N5++){var C5=DT[N5],nQ=C5.toLowerCase(),iQ=C5[0].toUpperCase()+C5.slice(1);vh(nQ,"on"+iQ)}vh(aI,"onAnimationEnd");vh(sI,"onAnimationIteration");vh(oI,"onAnimationStart");vh("dblclick","onDoubleClick");vh("focusin","onFocus");vh("focusout","onBlur");vh(lI,"onTransitionEnd");Am("onMouseEnter",["mouseout","mouseover"]);Am("onMouseLeave",["mouseout","mouseover"]);Am("onPointerEnter",["pointerout","pointerover"]);Am("onPointerLeave",["pointerout","pointerover"]);$0("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));$0("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));$0("onBeforeInput",["compositionend","keypress","textInput","paste"]);$0("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));$0("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));$0("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var dx="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aQ=new Set("cancel close invalid load scroll toggle".split(" ").concat(dx));function $T(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,nX(n,t,void 0,e),e.currentTarget=null}function uI(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==s&&i.isPropagationStopped())break e;$T(i,l,u),s=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==s&&i.isPropagationStopped())break e;$T(i,l,u),s=c}}}if(i2)throw e=zk,i2=!1,zk=null,e}function fa(e,t){var r=t[Jk];r===void 0&&(r=t[Jk]=new Set);var n=e+"__bubble";r.has(n)||(dI(t,e,2,!1),r.add(n))}function E5(e,t,r){var n=0;t&&(n|=4),dI(r,e,n,t)}var fb="_reactListening"+Math.random().toString(36).slice(2);function Qx(e){if(!e[fb]){e[fb]=!0,yB.forEach(function(r){r!=="selectionchange"&&(aQ.has(r)||E5(r,!1,e),E5(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[fb]||(t[fb]=!0,E5("selectionchange",!1,t))}}function dI(e,t,r,n){switch(KB(t)){case 1:var i=bX;break;case 4:i=vX;break;default:i=CN}r=i.bind(null,t,r,e),i=void 0,!Uk||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function T5(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Vh(l),o===null)return;if(c=o.tag,c===5||c===6){n=s=o;continue e}l=l.parentNode}}n=n.return}LB(function(){var u=s,d=jN(r),f=[];e:{var h=cI.get(e);if(h!==void 0){var p=TN,m=e;switch(e){case"keypress":if(Ev(r)===0)break e;case"keydown":case"keyup":p=RX;break;case"focusin":m="focus",p=_5;break;case"focusout":m="blur",p=_5;break;case"beforeblur":case"afterblur":p=_5;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=CT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=_X;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=IX;break;case aI:case sI:case oI:p=AX;break;case lI:p=$X;break;case"scroll":p=wX;break;case"wheel":p=zX;break;case"copy":case"cut":case"paste":p=CX;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=TT}var g=(t&4)!==0,y=!g&&e==="scroll",b=g?h!==null?h+"Capture":null:h;g=[];for(var v=u,w;v!==null;){w=v;var S=w.stateNode;if(w.tag===5&&S!==null&&(w=S,b!==null&&(S=Hx(v,b),S!=null&&g.push(Jx(v,S,w)))),y)break;v=v.return}0<g.length&&(h=new p(h,m,null,r,d),f.push({event:h,listeners:g}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",h&&r!==Dk&&(m=r.relatedTarget||r.fromElement)&&(Vh(m)||m[Vd]))break e;if((p||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,p?(m=r.relatedTarget||r.toElement,p=u,m=m?Vh(m):null,m!==null&&(y=U0(m),m!==y||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=u),p!==m)){if(g=CT,S="onMouseLeave",b="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(g=TT,S="onPointerLeave",b="onPointerEnter",v="pointer"),y=p==null?h:Vp(p),w=m==null?h:Vp(m),h=new g(S,v+"leave",p,r,d),h.target=y,h.relatedTarget=w,S=null,Vh(d)===u&&(g=new g(b,v+"enter",m,r,d),g.target=w,g.relatedTarget=y,S=g),y=S,p&&m)t:{for(g=p,b=m,v=0,w=g;w;w=pp(w))v++;for(w=0,S=b;S;S=pp(S))w++;for(;0<v-w;)g=pp(g),v--;for(;0<w-v;)b=pp(b),w--;for(;v--;){if(g===b||b!==null&&g===b.alternate)break t;g=pp(g),b=pp(b)}g=null}else g=null;p!==null&&UT(f,h,p,g,!1),m!==null&&y!==null&&UT(f,y,m,g,!0)}}e:{if(h=u?Vp(u):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var j=YX;else if(MT(h))if(eI)j=ZX;else{j=QX;var k=XX}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(j=JX);if(j&&(j=j(e,u))){ZB(f,j,r,d);break e}k&&k(e,h,u),e==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&Lk(h,"number",h.value)}switch(k=u?Vp(u):window,e){case"focusin":(MT(k)||k.contentEditable==="true")&&(qp=k,Vk=u,_x=null);break;case"focusout":_x=Vk=qp=null;break;case"mousedown":Gk=!0;break;case"contextmenu":case"mouseup":case"dragend":Gk=!1,IT(f,r,d);break;case"selectionchange":if(rQ)break;case"keydown":case"keyup":IT(f,r,d)}var A;if(ON)e:{switch(e){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else Wp?QB(e,r)&&(R="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(R="onCompositionStart");R&&(XB&&r.locale!=="ko"&&(Wp||R!=="onCompositionStart"?R==="onCompositionEnd"&&Wp&&(A=YB()):(Wf=d,EN="value"in Wf?Wf.value:Wf.textContent,Wp=!0)),k=c2(u,R),0<k.length&&(R=new ET(R,e,null,r,d),f.push({event:R,listeners:k}),A?R.data=A:(A=JB(r),A!==null&&(R.data=A)))),(A=qX?HX(e,r):VX(e,r))&&(u=c2(u,"onBeforeInput"),0<u.length&&(d=new ET("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=A))}uI(f,t)})}function Jx(e,t,r){return{instance:e,listener:t,currentTarget:r}}function c2(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Hx(e,r),s!=null&&n.unshift(Jx(e,s,i)),s=Hx(e,t),s!=null&&n.push(Jx(e,s,i))),e=e.return}return n}function pp(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function UT(e,t,r,n,i){for(var s=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,i?(c=Hx(r,s),c!=null&&o.unshift(Jx(r,c,l))):i||(c=Hx(r,s),c!=null&&o.push(Jx(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var sQ=/\r\n?/g,oQ=/\u0000|\uFFFD/g;function zT(e){return(typeof e=="string"?e:""+e).replace(sQ,`
`).replace(oQ,"")}function hb(e,t,r){if(t=zT(t),zT(e)!==t&&r)throw Error(Zr(425))}function u2(){}var Kk=null,Yk=null;function Xk(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Qk=typeof setTimeout=="function"?setTimeout:void 0,lQ=typeof clearTimeout=="function"?clearTimeout:void 0,WT=typeof Promise=="function"?Promise:void 0,cQ=typeof queueMicrotask=="function"?queueMicrotask:typeof WT<"u"?function(e){return WT.resolve(null).then(e).catch(uQ)}:Qk;function uQ(e){setTimeout(function(){throw e})}function P5(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),Kx(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Kx(t)}function Zf(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function qT(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var eg=Math.random().toString(36).slice(2),Vu="__reactFiber$"+eg,Zx="__reactProps$"+eg,Vd="__reactContainer$"+eg,Jk="__reactEvents$"+eg,dQ="__reactListeners$"+eg,fQ="__reactHandles$"+eg;function Vh(e){var t=e[Vu];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Vd]||r[Vu]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=qT(e);e!==null;){if(r=e[Vu])return r;e=qT(e)}return t}e=r,r=e.parentNode}return null}function G1(e){return e=e[Vu]||e[Vd],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Vp(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Zr(33))}function rS(e){return e[Zx]||null}var Zk=[],Gp=-1;function wh(e){return{current:e}}function ga(e){0>Gp||(e.current=Zk[Gp],Zk[Gp]=null,Gp--)}function oa(e,t){Gp++,Zk[Gp]=e.current,e.current=t}var uh={},qo=wh(uh),Al=wh(!1),p0=uh;function Nm(e,t){var r=e.type.contextTypes;if(!r)return uh;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Nl(e){return e=e.childContextTypes,e!=null}function d2(){ga(Al),ga(qo)}function HT(e,t,r){if(qo.current!==uh)throw Error(Zr(168));oa(qo,t),oa(Al,r)}function fI(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(Zr(108,XY(e)||"Unknown",i));return La({},r,n)}function f2(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||uh,p0=qo.current,oa(qo,e),oa(Al,Al.current),!0}function VT(e,t,r){var n=e.stateNode;if(!n)throw Error(Zr(169));r?(e=fI(e,t,p0),n.__reactInternalMemoizedMergedChildContext=e,ga(Al),ga(qo),oa(qo,e)):ga(Al),oa(Al,r)}var Nd=null,nS=!1,O5=!1;function hI(e){Nd===null?Nd=[e]:Nd.push(e)}function hQ(e){nS=!0,hI(e)}function Sh(){if(!O5&&Nd!==null){O5=!0;var e=0,t=Gi;try{var r=Nd;for(Gi=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Nd=null,nS=!1}catch(i){throw Nd!==null&&(Nd=Nd.slice(e+1)),IB(kN,Sh),i}finally{Gi=t,O5=!1}}return null}var Kp=[],Yp=0,h2=null,p2=0,Lc=[],Rc=0,m0=null,Od=1,Md="";function Ih(e,t){Kp[Yp++]=p2,Kp[Yp++]=h2,h2=e,p2=t}function pI(e,t,r){Lc[Rc++]=Od,Lc[Rc++]=Md,Lc[Rc++]=m0,m0=e;var n=Od;e=Md;var i=32-hu(n)-1;n&=~(1<<i),r+=1;var s=32-hu(t)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,Od=1<<32-hu(t)+i|r<<i|n,Md=s+e}else Od=1<<s|r<<i|n,Md=e}function LN(e){e.return!==null&&(Ih(e,1),pI(e,1,0))}function RN(e){for(;e===h2;)h2=Kp[--Yp],Kp[Yp]=null,p2=Kp[--Yp],Kp[Yp]=null;for(;e===m0;)m0=Lc[--Rc],Lc[Rc]=null,Md=Lc[--Rc],Lc[Rc]=null,Od=Lc[--Rc],Lc[Rc]=null}var nc=null,ec=null,Sa=!1,ou=null;function mI(e,t){var r=Bc(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function GT(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,nc=e,ec=Zf(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,nc=e,ec=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=m0!==null?{id:Od,overflow:Md}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Bc(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,nc=e,ec=null,!0):!1;default:return!1}}function e4(e){return(e.mode&1)!==0&&(e.flags&128)===0}function t4(e){if(Sa){var t=ec;if(t){var r=t;if(!GT(e,t)){if(e4(e))throw Error(Zr(418));t=Zf(r.nextSibling);var n=nc;t&&GT(e,t)?mI(n,r):(e.flags=e.flags&-4097|2,Sa=!1,nc=e)}}else{if(e4(e))throw Error(Zr(418));e.flags=e.flags&-4097|2,Sa=!1,nc=e}}}function KT(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;nc=e}function pb(e){if(e!==nc)return!1;if(!Sa)return KT(e),Sa=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Xk(e.type,e.memoizedProps)),t&&(t=ec)){if(e4(e))throw gI(),Error(Zr(418));for(;t;)mI(e,t),t=Zf(t.nextSibling)}if(KT(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Zr(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){ec=Zf(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}ec=null}}else ec=nc?Zf(e.stateNode.nextSibling):null;return!0}function gI(){for(var e=ec;e;)e=Zf(e.nextSibling)}function Cm(){ec=nc=null,Sa=!1}function FN(e){ou===null?ou=[e]:ou.push(e)}var pQ=of.ReactCurrentBatchConfig;function Dg(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Zr(309));var n=r.stateNode}if(!n)throw Error(Zr(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(Zr(284));if(!r._owner)throw Error(Zr(290,e))}return e}function mb(e,t){throw e=Object.prototype.toString.call(t),Error(Zr(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function YT(e){var t=e._init;return t(e._payload)}function xI(e){function t(b,v){if(e){var w=b.deletions;w===null?(b.deletions=[v],b.flags|=16):w.push(v)}}function r(b,v){if(!e)return null;for(;v!==null;)t(b,v),v=v.sibling;return null}function n(b,v){for(b=new Map;v!==null;)v.key!==null?b.set(v.key,v):b.set(v.index,v),v=v.sibling;return b}function i(b,v){return b=nh(b,v),b.index=0,b.sibling=null,b}function s(b,v,w){return b.index=w,e?(w=b.alternate,w!==null?(w=w.index,w<v?(b.flags|=2,v):w):(b.flags|=2,v)):(b.flags|=1048576,v)}function o(b){return e&&b.alternate===null&&(b.flags|=2),b}function l(b,v,w,S){return v===null||v.tag!==6?(v=D5(w,b.mode,S),v.return=b,v):(v=i(v,w),v.return=b,v)}function c(b,v,w,S){var j=w.type;return j===zp?d(b,v,w.props.children,S,w.key):v!==null&&(v.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Lf&&YT(j)===v.type)?(S=i(v,w.props),S.ref=Dg(b,v,w),S.return=b,S):(S=Fv(w.type,w.key,w.props,null,b.mode,S),S.ref=Dg(b,v,w),S.return=b,S)}function u(b,v,w,S){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=$5(w,b.mode,S),v.return=b,v):(v=i(v,w.children||[]),v.return=b,v)}function d(b,v,w,S,j){return v===null||v.tag!==7?(v=n0(w,b.mode,S,j),v.return=b,v):(v=i(v,w),v.return=b,v)}function f(b,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=D5(""+v,b.mode,w),v.return=b,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case ib:return w=Fv(v.type,v.key,v.props,null,b.mode,w),w.ref=Dg(b,null,v),w.return=b,w;case Up:return v=$5(v,b.mode,w),v.return=b,v;case Lf:var S=v._init;return f(b,S(v._payload),w)}if(cx(v)||Lg(v))return v=n0(v,b.mode,w,null),v.return=b,v;mb(b,v)}return null}function h(b,v,w,S){var j=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return j!==null?null:l(b,v,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ib:return w.key===j?c(b,v,w,S):null;case Up:return w.key===j?u(b,v,w,S):null;case Lf:return j=w._init,h(b,v,j(w._payload),S)}if(cx(w)||Lg(w))return j!==null?null:d(b,v,w,S,null);mb(b,w)}return null}function p(b,v,w,S,j){if(typeof S=="string"&&S!==""||typeof S=="number")return b=b.get(w)||null,l(v,b,""+S,j);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case ib:return b=b.get(S.key===null?w:S.key)||null,c(v,b,S,j);case Up:return b=b.get(S.key===null?w:S.key)||null,u(v,b,S,j);case Lf:var k=S._init;return p(b,v,w,k(S._payload),j)}if(cx(S)||Lg(S))return b=b.get(w)||null,d(v,b,S,j,null);mb(v,S)}return null}function m(b,v,w,S){for(var j=null,k=null,A=v,R=v=0,M=null;A!==null&&R<w.length;R++){A.index>R?(M=A,A=null):M=A.sibling;var B=h(b,A,w[R],S);if(B===null){A===null&&(A=M);break}e&&A&&B.alternate===null&&t(b,A),v=s(B,v,R),k===null?j=B:k.sibling=B,k=B,A=M}if(R===w.length)return r(b,A),Sa&&Ih(b,R),j;if(A===null){for(;R<w.length;R++)A=f(b,w[R],S),A!==null&&(v=s(A,v,R),k===null?j=A:k.sibling=A,k=A);return Sa&&Ih(b,R),j}for(A=n(b,A);R<w.length;R++)M=p(A,b,R,w[R],S),M!==null&&(e&&M.alternate!==null&&A.delete(M.key===null?R:M.key),v=s(M,v,R),k===null?j=M:k.sibling=M,k=M);return e&&A.forEach(function(E){return t(b,E)}),Sa&&Ih(b,R),j}function g(b,v,w,S){var j=Lg(w);if(typeof j!="function")throw Error(Zr(150));if(w=j.call(w),w==null)throw Error(Zr(151));for(var k=j=null,A=v,R=v=0,M=null,B=w.next();A!==null&&!B.done;R++,B=w.next()){A.index>R?(M=A,A=null):M=A.sibling;var E=h(b,A,B.value,S);if(E===null){A===null&&(A=M);break}e&&A&&E.alternate===null&&t(b,A),v=s(E,v,R),k===null?j=E:k.sibling=E,k=E,A=M}if(B.done)return r(b,A),Sa&&Ih(b,R),j;if(A===null){for(;!B.done;R++,B=w.next())B=f(b,B.value,S),B!==null&&(v=s(B,v,R),k===null?j=B:k.sibling=B,k=B);return Sa&&Ih(b,R),j}for(A=n(b,A);!B.done;R++,B=w.next())B=p(A,b,R,B.value,S),B!==null&&(e&&B.alternate!==null&&A.delete(B.key===null?R:B.key),v=s(B,v,R),k===null?j=B:k.sibling=B,k=B);return e&&A.forEach(function(P){return t(b,P)}),Sa&&Ih(b,R),j}function y(b,v,w,S){if(typeof w=="object"&&w!==null&&w.type===zp&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case ib:e:{for(var j=w.key,k=v;k!==null;){if(k.key===j){if(j=w.type,j===zp){if(k.tag===7){r(b,k.sibling),v=i(k,w.props.children),v.return=b,b=v;break e}}else if(k.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Lf&&YT(j)===k.type){r(b,k.sibling),v=i(k,w.props),v.ref=Dg(b,k,w),v.return=b,b=v;break e}r(b,k);break}else t(b,k);k=k.sibling}w.type===zp?(v=n0(w.props.children,b.mode,S,w.key),v.return=b,b=v):(S=Fv(w.type,w.key,w.props,null,b.mode,S),S.ref=Dg(b,v,w),S.return=b,b=S)}return o(b);case Up:e:{for(k=w.key;v!==null;){if(v.key===k)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){r(b,v.sibling),v=i(v,w.children||[]),v.return=b,b=v;break e}else{r(b,v);break}else t(b,v);v=v.sibling}v=$5(w,b.mode,S),v.return=b,b=v}return o(b);case Lf:return k=w._init,y(b,v,k(w._payload),S)}if(cx(w))return m(b,v,w,S);if(Lg(w))return g(b,v,w,S);mb(b,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(r(b,v.sibling),v=i(v,w),v.return=b,b=v):(r(b,v),v=D5(w,b.mode,S),v.return=b,b=v),o(b)):r(b,v)}return y}var Em=xI(!0),yI=xI(!1),m2=wh(null),g2=null,Xp=null,BN=null;function IN(){BN=Xp=g2=null}function DN(e){var t=m2.current;ga(m2),e._currentValue=t}function r4(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function um(e,t){g2=e,BN=Xp=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(wl=!0),e.firstContext=null)}function Uc(e){var t=e._currentValue;if(BN!==e)if(e={context:e,memoizedValue:t,next:null},Xp===null){if(g2===null)throw Error(Zr(308));Xp=e,g2.dependencies={lanes:0,firstContext:e}}else Xp=Xp.next=e;return t}var Gh=null;function $N(e){Gh===null?Gh=[e]:Gh.push(e)}function bI(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,$N(t)):(r.next=i.next,i.next=r),t.interleaved=r,Gd(e,n)}function Gd(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Rf=!1;function UN(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function vI(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Dd(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function eh(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,ki&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Gd(e,r)}return i=n.interleaved,i===null?(t.next=t,$N(n)):(t.next=i.next,i.next=t),n.interleaved=t,Gd(e,r)}function Tv(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,AN(e,r)}}function XT(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function x2(e,t,r,n){var i=e.updateQueue;Rf=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?s=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(s!==null){var f=i.baseState;o=0,d=u=c=null,l=s;do{var h=l.lane,p=l.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=e,g=l;switch(h=t,p=r,g.tag){case 1:if(m=g.payload,typeof m=="function"){f=m.call(p,f,h);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,h=typeof m=="function"?m.call(p,f,h):m,h==null)break e;f=La({},f,h);break e;case 2:Rf=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=i.effects,h===null?i.effects=[l]:h.push(l))}else p={eventTime:p,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=p,c=f):d=d.next=p,o|=h;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;h=l,l=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(d===null&&(c=f),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);x0|=o,e.lanes=o,e.memoizedState=f}}function QT(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Zr(191,i));i.call(n)}}}var K1={},Zu=wh(K1),e1=wh(K1),t1=wh(K1);function Kh(e){if(e===K1)throw Error(Zr(174));return e}function zN(e,t){switch(oa(t1,t),oa(e1,e),oa(Zu,K1),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Fk(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Fk(t,e)}ga(Zu),oa(Zu,t)}function Tm(){ga(Zu),ga(e1),ga(t1)}function wI(e){Kh(t1.current);var t=Kh(Zu.current),r=Fk(t,e.type);t!==r&&(oa(e1,e),oa(Zu,r))}function WN(e){e1.current===e&&(ga(Zu),ga(e1))}var Ea=wh(0);function y2(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var M5=[];function qN(){for(var e=0;e<M5.length;e++)M5[e]._workInProgressVersionPrimary=null;M5.length=0}var Pv=of.ReactCurrentDispatcher,L5=of.ReactCurrentBatchConfig,g0=0,Ma=null,Ts=null,Vs=null,b2=!1,jx=!1,r1=0,mQ=0;function ko(){throw Error(Zr(321))}function HN(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!yu(e[r],t[r]))return!1;return!0}function VN(e,t,r,n,i,s){if(g0=s,Ma=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Pv.current=e===null||e.memoizedState===null?bQ:vQ,e=r(n,i),jx){s=0;do{if(jx=!1,r1=0,25<=s)throw Error(Zr(301));s+=1,Vs=Ts=null,t.updateQueue=null,Pv.current=wQ,e=r(n,i)}while(jx)}if(Pv.current=v2,t=Ts!==null&&Ts.next!==null,g0=0,Vs=Ts=Ma=null,b2=!1,t)throw Error(Zr(300));return e}function GN(){var e=r1!==0;return r1=0,e}function zu(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vs===null?Ma.memoizedState=Vs=e:Vs=Vs.next=e,Vs}function zc(){if(Ts===null){var e=Ma.alternate;e=e!==null?e.memoizedState:null}else e=Ts.next;var t=Vs===null?Ma.memoizedState:Vs.next;if(t!==null)Vs=t,Ts=e;else{if(e===null)throw Error(Zr(310));Ts=e,e={memoizedState:Ts.memoizedState,baseState:Ts.baseState,baseQueue:Ts.baseQueue,queue:Ts.queue,next:null},Vs===null?Ma.memoizedState=Vs=e:Vs=Vs.next=e}return Vs}function n1(e,t){return typeof t=="function"?t(e):t}function R5(e){var t=zc(),r=t.queue;if(r===null)throw Error(Zr(311));r.lastRenderedReducer=e;var n=Ts,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var l=o=null,c=null,u=s;do{var d=u.lane;if((g0&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,Ma.lanes|=d,x0|=d}u=u.next}while(u!==null&&u!==s);c===null?o=n:c.next=l,yu(n,t.memoizedState)||(wl=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,Ma.lanes|=s,x0|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function F5(e){var t=zc(),r=t.queue;if(r===null)throw Error(Zr(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=e(s,o.action),o=o.next;while(o!==i);yu(s,t.memoizedState)||(wl=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function SI(){}function _I(e,t){var r=Ma,n=zc(),i=t(),s=!yu(n.memoizedState,i);if(s&&(n.memoizedState=i,wl=!0),n=n.queue,KN(AI.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Vs!==null&&Vs.memoizedState.tag&1){if(r.flags|=2048,i1(9,kI.bind(null,r,n,i,t),void 0,null),Js===null)throw Error(Zr(349));g0&30||jI(r,t,i)}return i}function jI(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ma.updateQueue,t===null?(t={lastEffect:null,stores:null},Ma.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function kI(e,t,r,n){t.value=r,t.getSnapshot=n,NI(t)&&CI(e)}function AI(e,t,r){return r(function(){NI(t)&&CI(e)})}function NI(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!yu(e,r)}catch{return!0}}function CI(e){var t=Gd(e,1);t!==null&&pu(t,e,1,-1)}function JT(e){var t=zu();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n1,lastRenderedState:e},t.queue=e,e=e.dispatch=yQ.bind(null,Ma,e),[t.memoizedState,e]}function i1(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Ma.updateQueue,t===null?(t={lastEffect:null,stores:null},Ma.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function EI(){return zc().memoizedState}function Ov(e,t,r,n){var i=zu();Ma.flags|=e,i.memoizedState=i1(1|t,r,void 0,n===void 0?null:n)}function iS(e,t,r,n){var i=zc();n=n===void 0?null:n;var s=void 0;if(Ts!==null){var o=Ts.memoizedState;if(s=o.destroy,n!==null&&HN(n,o.deps)){i.memoizedState=i1(t,r,s,n);return}}Ma.flags|=e,i.memoizedState=i1(1|t,r,s,n)}function ZT(e,t){return Ov(8390656,8,e,t)}function KN(e,t){return iS(2048,8,e,t)}function TI(e,t){return iS(4,2,e,t)}function PI(e,t){return iS(4,4,e,t)}function OI(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function MI(e,t,r){return r=r!=null?r.concat([e]):null,iS(4,4,OI.bind(null,t,e),r)}function YN(){}function LI(e,t){var r=zc();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&HN(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function RI(e,t){var r=zc();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&HN(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function FI(e,t,r){return g0&21?(yu(r,t)||(r=UB(),Ma.lanes|=r,x0|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,wl=!0),e.memoizedState=r)}function gQ(e,t){var r=Gi;Gi=r!==0&&4>r?r:4,e(!0);var n=L5.transition;L5.transition={};try{e(!1),t()}finally{Gi=r,L5.transition=n}}function BI(){return zc().memoizedState}function xQ(e,t,r){var n=rh(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},II(e))DI(t,r);else if(r=bI(e,t,r,n),r!==null){var i=il();pu(r,e,n,i),$I(r,t,n)}}function yQ(e,t,r){var n=rh(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(II(e))DI(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,l=s(o,r);if(i.hasEagerState=!0,i.eagerState=l,yu(l,o)){var c=t.interleaved;c===null?(i.next=i,$N(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}r=bI(e,t,i,n),r!==null&&(i=il(),pu(r,e,n,i),$I(r,t,n))}}function II(e){var t=e.alternate;return e===Ma||t!==null&&t===Ma}function DI(e,t){jx=b2=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function $I(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,AN(e,r)}}var v2={readContext:Uc,useCallback:ko,useContext:ko,useEffect:ko,useImperativeHandle:ko,useInsertionEffect:ko,useLayoutEffect:ko,useMemo:ko,useReducer:ko,useRef:ko,useState:ko,useDebugValue:ko,useDeferredValue:ko,useTransition:ko,useMutableSource:ko,useSyncExternalStore:ko,useId:ko,unstable_isNewReconciler:!1},bQ={readContext:Uc,useCallback:function(e,t){return zu().memoizedState=[e,t===void 0?null:t],e},useContext:Uc,useEffect:ZT,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Ov(4194308,4,OI.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Ov(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ov(4,2,e,t)},useMemo:function(e,t){var r=zu();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=zu();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=xQ.bind(null,Ma,e),[n.memoizedState,e]},useRef:function(e){var t=zu();return e={current:e},t.memoizedState=e},useState:JT,useDebugValue:YN,useDeferredValue:function(e){return zu().memoizedState=e},useTransition:function(){var e=JT(!1),t=e[0];return e=gQ.bind(null,e[1]),zu().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Ma,i=zu();if(Sa){if(r===void 0)throw Error(Zr(407));r=r()}else{if(r=t(),Js===null)throw Error(Zr(349));g0&30||jI(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,ZT(AI.bind(null,n,s,e),[e]),n.flags|=2048,i1(9,kI.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=zu(),t=Js.identifierPrefix;if(Sa){var r=Md,n=Od;r=(n&~(1<<32-hu(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=r1++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=mQ++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},vQ={readContext:Uc,useCallback:LI,useContext:Uc,useEffect:KN,useImperativeHandle:MI,useInsertionEffect:TI,useLayoutEffect:PI,useMemo:RI,useReducer:R5,useRef:EI,useState:function(){return R5(n1)},useDebugValue:YN,useDeferredValue:function(e){var t=zc();return FI(t,Ts.memoizedState,e)},useTransition:function(){var e=R5(n1)[0],t=zc().memoizedState;return[e,t]},useMutableSource:SI,useSyncExternalStore:_I,useId:BI,unstable_isNewReconciler:!1},wQ={readContext:Uc,useCallback:LI,useContext:Uc,useEffect:KN,useImperativeHandle:MI,useInsertionEffect:TI,useLayoutEffect:PI,useMemo:RI,useReducer:F5,useRef:EI,useState:function(){return F5(n1)},useDebugValue:YN,useDeferredValue:function(e){var t=zc();return Ts===null?t.memoizedState=e:FI(t,Ts.memoizedState,e)},useTransition:function(){var e=F5(n1)[0],t=zc().memoizedState;return[e,t]},useMutableSource:SI,useSyncExternalStore:_I,useId:BI,unstable_isNewReconciler:!1};function iu(e,t){if(e&&e.defaultProps){t=La({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function n4(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:La({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var aS={isMounted:function(e){return(e=e._reactInternals)?U0(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=il(),i=rh(e),s=Dd(n,i);s.payload=t,r!=null&&(s.callback=r),t=eh(e,s,i),t!==null&&(pu(t,e,i,n),Tv(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=il(),i=rh(e),s=Dd(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=eh(e,s,i),t!==null&&(pu(t,e,i,n),Tv(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=il(),n=rh(e),i=Dd(r,n);i.tag=2,t!=null&&(i.callback=t),t=eh(e,i,n),t!==null&&(pu(t,e,n,r),Tv(t,e,n))}};function e8(e,t,r,n,i,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,o):t.prototype&&t.prototype.isPureReactComponent?!Xx(r,n)||!Xx(i,s):!0}function UI(e,t,r){var n=!1,i=uh,s=t.contextType;return typeof s=="object"&&s!==null?s=Uc(s):(i=Nl(t)?p0:qo.current,n=t.contextTypes,s=(n=n!=null)?Nm(e,i):uh),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=aS,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function t8(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&aS.enqueueReplaceState(t,t.state,null)}function i4(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},UN(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=Uc(s):(s=Nl(t)?p0:qo.current,i.context=Nm(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(n4(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&aS.enqueueReplaceState(i,i.state,null),x2(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Pm(e,t){try{var r="",n=t;do r+=YY(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function B5(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function a4(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var SQ=typeof WeakMap=="function"?WeakMap:Map;function zI(e,t,r){r=Dd(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){S2||(S2=!0,m4=n),a4(e,t)},r}function WI(e,t,r){r=Dd(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){a4(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){a4(e,t),typeof n!="function"&&(th===null?th=new Set([this]):th.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function r8(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new SQ;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=FQ.bind(null,e,t,r),t.then(e,e))}function n8(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function i8(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Dd(-1,1),t.tag=2,eh(r,t,1))),r.lanes|=1),e)}var _Q=of.ReactCurrentOwner,wl=!1;function Zo(e,t,r,n){t.child=e===null?yI(t,null,r,n):Em(t,e.child,r,n)}function a8(e,t,r,n,i){r=r.render;var s=t.ref;return um(t,i),n=VN(e,t,r,n,s,i),r=GN(),e!==null&&!wl?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Kd(e,t,i)):(Sa&&r&&LN(t),t.flags|=1,Zo(e,t,n,i),t.child)}function s8(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!n3(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,qI(e,t,s,n,i)):(e=Fv(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:Xx,r(o,n)&&e.ref===t.ref)return Kd(e,t,i)}return t.flags|=1,e=nh(s,n),e.ref=t.ref,e.return=t,t.child=e}function qI(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(Xx(s,n)&&e.ref===t.ref)if(wl=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(wl=!0);else return t.lanes=e.lanes,Kd(e,t,i)}return s4(e,t,r,n,i)}function HI(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},oa(Jp,Kl),Kl|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,oa(Jp,Kl),Kl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,oa(Jp,Kl),Kl|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,oa(Jp,Kl),Kl|=n;return Zo(e,t,i,r),t.child}function VI(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function s4(e,t,r,n,i){var s=Nl(r)?p0:qo.current;return s=Nm(t,s),um(t,i),r=VN(e,t,r,n,s,i),n=GN(),e!==null&&!wl?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Kd(e,t,i)):(Sa&&n&&LN(t),t.flags|=1,Zo(e,t,r,i),t.child)}function o8(e,t,r,n,i){if(Nl(r)){var s=!0;f2(t)}else s=!1;if(um(t,i),t.stateNode===null)Mv(e,t),UI(t,r,n),i4(t,r,n,i),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=Uc(u):(u=Nl(r)?p0:qo.current,u=Nm(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&t8(t,o,n,u),Rf=!1;var h=t.memoizedState;o.state=h,x2(t,n,o,i),c=t.memoizedState,l!==n||h!==c||Al.current||Rf?(typeof d=="function"&&(n4(t,r,d,n),c=t.memoizedState),(l=Rf||e8(t,r,l,n,h,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,vI(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:iu(t.type,l),o.props=u,f=t.pendingProps,h=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Uc(c):(c=Nl(r)?p0:qo.current,c=Nm(t,c));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||h!==c)&&t8(t,o,n,c),Rf=!1,h=t.memoizedState,o.state=h,x2(t,n,o,i);var m=t.memoizedState;l!==f||h!==m||Al.current||Rf?(typeof p=="function"&&(n4(t,r,p,n),m=t.memoizedState),(u=Rf||e8(t,r,u,n,h,m,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,m,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,m,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),o.props=n,o.state=m,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return o4(e,t,r,n,s,i)}function o4(e,t,r,n,i,s){VI(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return i&&VT(t,r,!1),Kd(e,t,s);n=t.stateNode,_Q.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=Em(t,e.child,null,s),t.child=Em(t,null,l,s)):Zo(e,t,l,s),t.memoizedState=n.state,i&&VT(t,r,!0),t.child}function GI(e){var t=e.stateNode;t.pendingContext?HT(e,t.pendingContext,t.pendingContext!==t.context):t.context&&HT(e,t.context,!1),zN(e,t.containerInfo)}function l8(e,t,r,n,i){return Cm(),FN(i),t.flags|=256,Zo(e,t,r,n),t.child}var l4={dehydrated:null,treeContext:null,retryLane:0};function c4(e){return{baseLanes:e,cachePool:null,transitions:null}}function KI(e,t,r){var n=t.pendingProps,i=Ea.current,s=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),oa(Ea,i&1),e===null)return t4(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,s?(n=t.mode,s=t.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=lS(o,n,0,null),e=n0(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=c4(r),t.memoizedState=l4,e):XN(t,o));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return jQ(e,t,o,n,l,i,r);if(s){s=n.fallback,o=t.mode,i=e.child,l=i.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=nh(i,c),n.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=nh(l,s):(s=n0(s,o,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,o=e.child.memoizedState,o=o===null?c4(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~r,t.memoizedState=l4,n}return s=e.child,e=s.sibling,n=nh(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function XN(e,t){return t=lS({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function gb(e,t,r,n){return n!==null&&FN(n),Em(t,e.child,null,r),e=XN(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function jQ(e,t,r,n,i,s,o){if(r)return t.flags&256?(t.flags&=-257,n=B5(Error(Zr(422))),gb(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=lS({mode:"visible",children:n.children},i,0,null),s=n0(s,i,o,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Em(t,e.child,null,o),t.child.memoizedState=c4(o),t.memoizedState=l4,s);if(!(t.mode&1))return gb(e,t,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(Zr(419)),n=B5(s,n,void 0),gb(e,t,o,n)}if(l=(o&e.childLanes)!==0,wl||l){if(n=Js,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Gd(e,i),pu(n,e,i,-1))}return r3(),n=B5(Error(Zr(421))),gb(e,t,o,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=BQ.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,ec=Zf(i.nextSibling),nc=t,Sa=!0,ou=null,e!==null&&(Lc[Rc++]=Od,Lc[Rc++]=Md,Lc[Rc++]=m0,Od=e.id,Md=e.overflow,m0=t),t=XN(t,n.children),t.flags|=4096,t)}function c8(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),r4(e.return,t,r)}function I5(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function YI(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Zo(e,t,n.children,r),n=Ea.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&c8(e,r,t);else if(e.tag===19)c8(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(oa(Ea,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&y2(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),I5(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&y2(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}I5(t,!0,r,null,s);break;case"together":I5(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Mv(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Kd(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),x0|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Zr(153));if(t.child!==null){for(e=t.child,r=nh(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=nh(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function kQ(e,t,r){switch(t.tag){case 3:GI(t),Cm();break;case 5:wI(t);break;case 1:Nl(t.type)&&f2(t);break;case 4:zN(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;oa(m2,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(oa(Ea,Ea.current&1),t.flags|=128,null):r&t.child.childLanes?KI(e,t,r):(oa(Ea,Ea.current&1),e=Kd(e,t,r),e!==null?e.sibling:null);oa(Ea,Ea.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return YI(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),oa(Ea,Ea.current),n)break;return null;case 22:case 23:return t.lanes=0,HI(e,t,r)}return Kd(e,t,r)}var XI,u4,QI,JI;XI=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};u4=function(){};QI=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,Kh(Zu.current);var s=null;switch(r){case"input":i=Ok(e,i),n=Ok(e,n),s=[];break;case"select":i=La({},i,{value:void 0}),n=La({},n,{value:void 0}),s=[];break;case"textarea":i=Rk(e,i),n=Rk(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=u2)}Bk(r,n);var o;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Wx.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(l=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(s||(s=[]),s.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Wx.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&fa("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};JI=function(e,t,r,n){r!==n&&(t.flags|=4)};function $g(e,t){if(!Sa)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ao(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function AQ(e,t,r){var n=t.pendingProps;switch(RN(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ao(t),null;case 1:return Nl(t.type)&&d2(),Ao(t),null;case 3:return n=t.stateNode,Tm(),ga(Al),ga(qo),qN(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(pb(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ou!==null&&(y4(ou),ou=null))),u4(e,t),Ao(t),null;case 5:WN(t);var i=Kh(t1.current);if(r=t.type,e!==null&&t.stateNode!=null)QI(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Zr(166));return Ao(t),null}if(e=Kh(Zu.current),pb(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Vu]=t,n[Zx]=s,e=(t.mode&1)!==0,r){case"dialog":fa("cancel",n),fa("close",n);break;case"iframe":case"object":case"embed":fa("load",n);break;case"video":case"audio":for(i=0;i<dx.length;i++)fa(dx[i],n);break;case"source":fa("error",n);break;case"img":case"image":case"link":fa("error",n),fa("load",n);break;case"details":fa("toggle",n);break;case"input":yT(n,s),fa("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},fa("invalid",n);break;case"textarea":vT(n,s),fa("invalid",n)}Bk(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&hb(n.textContent,l,e),i=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&hb(n.textContent,l,e),i=["children",""+l]):Wx.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&fa("scroll",n)}switch(r){case"input":ab(n),bT(n,s,!0);break;case"textarea":ab(n),wT(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=u2)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=AB(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[Vu]=t,e[Zx]=n,XI(e,t,!1,!1),t.stateNode=e;e:{switch(o=Ik(r,n),r){case"dialog":fa("cancel",e),fa("close",e),i=n;break;case"iframe":case"object":case"embed":fa("load",e),i=n;break;case"video":case"audio":for(i=0;i<dx.length;i++)fa(dx[i],e);i=n;break;case"source":fa("error",e),i=n;break;case"img":case"image":case"link":fa("error",e),fa("load",e),i=n;break;case"details":fa("toggle",e),i=n;break;case"input":yT(e,n),i=Ok(e,n),fa("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=La({},n,{value:void 0}),fa("invalid",e);break;case"textarea":vT(e,n),i=Rk(e,n),fa("invalid",e);break;default:i=n}Bk(r,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?EB(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&NB(e,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&qx(e,c):typeof c=="number"&&qx(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Wx.hasOwnProperty(s)?c!=null&&s==="onScroll"&&fa("scroll",e):c!=null&&vN(e,s,c,o))}switch(r){case"input":ab(e),bT(e,n,!1);break;case"textarea":ab(e),wT(e);break;case"option":n.value!=null&&e.setAttribute("value",""+ch(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?sm(e,!!n.multiple,s,!1):n.defaultValue!=null&&sm(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=u2)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ao(t),null;case 6:if(e&&t.stateNode!=null)JI(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Zr(166));if(r=Kh(t1.current),Kh(Zu.current),pb(t)){if(n=t.stateNode,r=t.memoizedProps,n[Vu]=t,(s=n.nodeValue!==r)&&(e=nc,e!==null))switch(e.tag){case 3:hb(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&hb(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Vu]=t,t.stateNode=n}return Ao(t),null;case 13:if(ga(Ea),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Sa&&ec!==null&&t.mode&1&&!(t.flags&128))gI(),Cm(),t.flags|=98560,s=!1;else if(s=pb(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(Zr(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Zr(317));s[Vu]=t}else Cm(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ao(t),s=!1}else ou!==null&&(y4(ou),ou=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ea.current&1?Ms===0&&(Ms=3):r3())),t.updateQueue!==null&&(t.flags|=4),Ao(t),null);case 4:return Tm(),u4(e,t),e===null&&Qx(t.stateNode.containerInfo),Ao(t),null;case 10:return DN(t.type._context),Ao(t),null;case 17:return Nl(t.type)&&d2(),Ao(t),null;case 19:if(ga(Ea),s=t.memoizedState,s===null)return Ao(t),null;if(n=(t.flags&128)!==0,o=s.rendering,o===null)if(n)$g(s,!1);else{if(Ms!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=y2(e),o!==null){for(t.flags|=128,$g(s,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return oa(Ea,Ea.current&1|2),t.child}e=e.sibling}s.tail!==null&&ts()>Om&&(t.flags|=128,n=!0,$g(s,!1),t.lanes=4194304)}else{if(!n)if(e=y2(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),$g(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Sa)return Ao(t),null}else 2*ts()-s.renderingStartTime>Om&&r!==1073741824&&(t.flags|=128,n=!0,$g(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(r=s.last,r!==null?r.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=ts(),t.sibling=null,r=Ea.current,oa(Ea,n?r&1|2:r&1),t):(Ao(t),null);case 22:case 23:return t3(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Kl&1073741824&&(Ao(t),t.subtreeFlags&6&&(t.flags|=8192)):Ao(t),null;case 24:return null;case 25:return null}throw Error(Zr(156,t.tag))}function NQ(e,t){switch(RN(t),t.tag){case 1:return Nl(t.type)&&d2(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Tm(),ga(Al),ga(qo),qN(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return WN(t),null;case 13:if(ga(Ea),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Zr(340));Cm()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ga(Ea),null;case 4:return Tm(),null;case 10:return DN(t.type._context),null;case 22:case 23:return t3(),null;case 24:return null;default:return null}}var xb=!1,Fo=!1,CQ=typeof WeakSet=="function"?WeakSet:Set,Cn=null;function Qp(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Wa(e,t,n)}else r.current=null}function d4(e,t,r){try{r()}catch(n){Wa(e,t,n)}}var u8=!1;function EQ(e,t){if(Kk=o2,e=nI(),MN(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,f=e,h=null;t:for(;;){for(var p;f!==r||i!==0&&f.nodeType!==3||(l=o+i),f!==s||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(p=f.firstChild)!==null;)h=f,f=p;for(;;){if(f===e)break t;if(h===r&&++u===i&&(l=o),h===s&&++d===n&&(c=o),(p=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=p}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Yk={focusedElem:e,selectionRange:r},o2=!1,Cn=t;Cn!==null;)if(t=Cn,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Cn=e;else for(;Cn!==null;){t=Cn;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,y=m.memoizedState,b=t.stateNode,v=b.getSnapshotBeforeUpdate(t.elementType===t.type?g:iu(t.type,g),y);b.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Zr(163))}}catch(S){Wa(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,Cn=e;break}Cn=t.return}return m=u8,u8=!1,m}function kx(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&d4(t,r,s)}i=i.next}while(i!==n)}}function sS(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function f4(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function ZI(e){var t=e.alternate;t!==null&&(e.alternate=null,ZI(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Vu],delete t[Zx],delete t[Jk],delete t[dQ],delete t[fQ])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function eD(e){return e.tag===5||e.tag===3||e.tag===4}function d8(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||eD(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function h4(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=u2));else if(n!==4&&(e=e.child,e!==null))for(h4(e,t,r),e=e.sibling;e!==null;)h4(e,t,r),e=e.sibling}function p4(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(p4(e,t,r),e=e.sibling;e!==null;)p4(e,t,r),e=e.sibling}var po=null,au=!1;function kf(e,t,r){for(r=r.child;r!==null;)tD(e,t,r),r=r.sibling}function tD(e,t,r){if(Ju&&typeof Ju.onCommitFiberUnmount=="function")try{Ju.onCommitFiberUnmount(Jw,r)}catch{}switch(r.tag){case 5:Fo||Qp(r,t);case 6:var n=po,i=au;po=null,kf(e,t,r),po=n,au=i,po!==null&&(au?(e=po,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):po.removeChild(r.stateNode));break;case 18:po!==null&&(au?(e=po,r=r.stateNode,e.nodeType===8?P5(e.parentNode,r):e.nodeType===1&&P5(e,r),Kx(e)):P5(po,r.stateNode));break;case 4:n=po,i=au,po=r.stateNode.containerInfo,au=!0,kf(e,t,r),po=n,au=i;break;case 0:case 11:case 14:case 15:if(!Fo&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&d4(r,t,o),i=i.next}while(i!==n)}kf(e,t,r);break;case 1:if(!Fo&&(Qp(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Wa(r,t,l)}kf(e,t,r);break;case 21:kf(e,t,r);break;case 22:r.mode&1?(Fo=(n=Fo)||r.memoizedState!==null,kf(e,t,r),Fo=n):kf(e,t,r);break;default:kf(e,t,r)}}function f8(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new CQ),t.forEach(function(n){var i=IQ.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function eu(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:po=l.stateNode,au=!1;break e;case 3:po=l.stateNode.containerInfo,au=!0;break e;case 4:po=l.stateNode.containerInfo,au=!0;break e}l=l.return}if(po===null)throw Error(Zr(160));tD(s,o,i),po=null,au=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){Wa(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)rD(t,e),t=t.sibling}function rD(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(eu(t,e),Cu(e),n&4){try{kx(3,e,e.return),sS(3,e)}catch(g){Wa(e,e.return,g)}try{kx(5,e,e.return)}catch(g){Wa(e,e.return,g)}}break;case 1:eu(t,e),Cu(e),n&512&&r!==null&&Qp(r,r.return);break;case 5:if(eu(t,e),Cu(e),n&512&&r!==null&&Qp(r,r.return),e.flags&32){var i=e.stateNode;try{qx(i,"")}catch(g){Wa(e,e.return,g)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,o=r!==null?r.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&jB(i,s),Ik(l,o);var u=Ik(l,s);for(o=0;o<c.length;o+=2){var d=c[o],f=c[o+1];d==="style"?EB(i,f):d==="dangerouslySetInnerHTML"?NB(i,f):d==="children"?qx(i,f):vN(i,d,f,u)}switch(l){case"input":Mk(i,s);break;case"textarea":kB(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?sm(i,!!s.multiple,p,!1):h!==!!s.multiple&&(s.defaultValue!=null?sm(i,!!s.multiple,s.defaultValue,!0):sm(i,!!s.multiple,s.multiple?[]:"",!1))}i[Zx]=s}catch(g){Wa(e,e.return,g)}}break;case 6:if(eu(t,e),Cu(e),n&4){if(e.stateNode===null)throw Error(Zr(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(g){Wa(e,e.return,g)}}break;case 3:if(eu(t,e),Cu(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Kx(t.containerInfo)}catch(g){Wa(e,e.return,g)}break;case 4:eu(t,e),Cu(e);break;case 13:eu(t,e),Cu(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(ZN=ts())),n&4&&f8(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Fo=(u=Fo)||d,eu(t,e),Fo=u):eu(t,e),Cu(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(Cn=e,d=e.child;d!==null;){for(f=Cn=d;Cn!==null;){switch(h=Cn,p=h.child,h.tag){case 0:case 11:case 14:case 15:kx(4,h,h.return);break;case 1:Qp(h,h.return);var m=h.stateNode;if(typeof m.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Wa(n,r,g)}}break;case 5:Qp(h,h.return);break;case 22:if(h.memoizedState!==null){p8(f);continue}}p!==null?(p.return=h,Cn=p):p8(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{i=f.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=CB("display",o))}catch(g){Wa(e,e.return,g)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(g){Wa(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:eu(t,e),Cu(e),n&4&&f8(e);break;case 21:break;default:eu(t,e),Cu(e)}}function Cu(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(eD(r)){var n=r;break e}r=r.return}throw Error(Zr(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(qx(i,""),n.flags&=-33);var s=d8(e);p4(e,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,l=d8(e);h4(e,l,o);break;default:throw Error(Zr(161))}}catch(c){Wa(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function TQ(e,t,r){Cn=e,nD(e)}function nD(e,t,r){for(var n=(e.mode&1)!==0;Cn!==null;){var i=Cn,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||xb;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||Fo;l=xb;var u=Fo;if(xb=o,(Fo=c)&&!u)for(Cn=i;Cn!==null;)o=Cn,c=o.child,o.tag===22&&o.memoizedState!==null?m8(i):c!==null?(c.return=o,Cn=c):m8(i);for(;s!==null;)Cn=s,nD(s),s=s.sibling;Cn=i,xb=l,Fo=u}h8(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Cn=s):h8(e)}}function h8(e){for(;Cn!==null;){var t=Cn;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Fo||sS(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Fo)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:iu(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&QT(t,s,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}QT(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Kx(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Zr(163))}Fo||t.flags&512&&f4(t)}catch(h){Wa(t,t.return,h)}}if(t===e){Cn=null;break}if(r=t.sibling,r!==null){r.return=t.return,Cn=r;break}Cn=t.return}}function p8(e){for(;Cn!==null;){var t=Cn;if(t===e){Cn=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Cn=r;break}Cn=t.return}}function m8(e){for(;Cn!==null;){var t=Cn;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{sS(4,t)}catch(c){Wa(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(c){Wa(t,i,c)}}var s=t.return;try{f4(t)}catch(c){Wa(t,s,c)}break;case 5:var o=t.return;try{f4(t)}catch(c){Wa(t,o,c)}}}catch(c){Wa(t,t.return,c)}if(t===e){Cn=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Cn=l;break}Cn=t.return}}var PQ=Math.ceil,w2=of.ReactCurrentDispatcher,QN=of.ReactCurrentOwner,Dc=of.ReactCurrentBatchConfig,ki=0,Js=null,ms=null,yo=0,Kl=0,Jp=wh(0),Ms=0,a1=null,x0=0,oS=0,JN=0,Ax=null,vl=null,ZN=0,Om=1/0,Ad=null,S2=!1,m4=null,th=null,yb=!1,qf=null,_2=0,Nx=0,g4=null,Lv=-1,Rv=0;function il(){return ki&6?ts():Lv!==-1?Lv:Lv=ts()}function rh(e){return e.mode&1?ki&2&&yo!==0?yo&-yo:pQ.transition!==null?(Rv===0&&(Rv=UB()),Rv):(e=Gi,e!==0||(e=window.event,e=e===void 0?16:KB(e.type)),e):1}function pu(e,t,r,n){if(50<Nx)throw Nx=0,g4=null,Error(Zr(185));H1(e,r,n),(!(ki&2)||e!==Js)&&(e===Js&&(!(ki&2)&&(oS|=r),Ms===4&&Df(e,yo)),Cl(e,n),r===1&&ki===0&&!(t.mode&1)&&(Om=ts()+500,nS&&Sh()))}function Cl(e,t){var r=e.callbackNode;pX(e,t);var n=s2(e,e===Js?yo:0);if(n===0)r!==null&&jT(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&jT(r),t===1)e.tag===0?hQ(g8.bind(null,e)):hI(g8.bind(null,e)),cQ(function(){!(ki&6)&&Sh()}),r=null;else{switch(zB(n)){case 1:r=kN;break;case 4:r=DB;break;case 16:r=a2;break;case 536870912:r=$B;break;default:r=a2}r=dD(r,iD.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function iD(e,t){if(Lv=-1,Rv=0,ki&6)throw Error(Zr(327));var r=e.callbackNode;if(dm()&&e.callbackNode!==r)return null;var n=s2(e,e===Js?yo:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=j2(e,n);else{t=n;var i=ki;ki|=2;var s=sD();(Js!==e||yo!==t)&&(Ad=null,Om=ts()+500,r0(e,t));do try{LQ();break}catch(l){aD(e,l)}while(!0);IN(),w2.current=s,ki=i,ms!==null?t=0:(Js=null,yo=0,t=Ms)}if(t!==0){if(t===2&&(i=Wk(e),i!==0&&(n=i,t=x4(e,i))),t===1)throw r=a1,r0(e,0),Df(e,n),Cl(e,ts()),r;if(t===6)Df(e,n);else{if(i=e.current.alternate,!(n&30)&&!OQ(i)&&(t=j2(e,n),t===2&&(s=Wk(e),s!==0&&(n=s,t=x4(e,s))),t===1))throw r=a1,r0(e,0),Df(e,n),Cl(e,ts()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(Zr(345));case 2:Dh(e,vl,Ad);break;case 3:if(Df(e,n),(n&130023424)===n&&(t=ZN+500-ts(),10<t)){if(s2(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){il(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Qk(Dh.bind(null,e,vl,Ad),t);break}Dh(e,vl,Ad);break;case 4:if(Df(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-hu(n);s=1<<o,o=t[o],o>i&&(i=o),n&=~s}if(n=i,n=ts()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*PQ(n/1960))-n,10<n){e.timeoutHandle=Qk(Dh.bind(null,e,vl,Ad),n);break}Dh(e,vl,Ad);break;case 5:Dh(e,vl,Ad);break;default:throw Error(Zr(329))}}}return Cl(e,ts()),e.callbackNode===r?iD.bind(null,e):null}function x4(e,t){var r=Ax;return e.current.memoizedState.isDehydrated&&(r0(e,t).flags|=256),e=j2(e,t),e!==2&&(t=vl,vl=r,t!==null&&y4(t)),e}function y4(e){vl===null?vl=e:vl.push.apply(vl,e)}function OQ(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!yu(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Df(e,t){for(t&=~JN,t&=~oS,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-hu(t),n=1<<r;e[r]=-1,t&=~n}}function g8(e){if(ki&6)throw Error(Zr(327));dm();var t=s2(e,0);if(!(t&1))return Cl(e,ts()),null;var r=j2(e,t);if(e.tag!==0&&r===2){var n=Wk(e);n!==0&&(t=n,r=x4(e,n))}if(r===1)throw r=a1,r0(e,0),Df(e,t),Cl(e,ts()),r;if(r===6)throw Error(Zr(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Dh(e,vl,Ad),Cl(e,ts()),null}function e3(e,t){var r=ki;ki|=1;try{return e(t)}finally{ki=r,ki===0&&(Om=ts()+500,nS&&Sh())}}function y0(e){qf!==null&&qf.tag===0&&!(ki&6)&&dm();var t=ki;ki|=1;var r=Dc.transition,n=Gi;try{if(Dc.transition=null,Gi=1,e)return e()}finally{Gi=n,Dc.transition=r,ki=t,!(ki&6)&&Sh()}}function t3(){Kl=Jp.current,ga(Jp)}function r0(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,lQ(r)),ms!==null)for(r=ms.return;r!==null;){var n=r;switch(RN(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&d2();break;case 3:Tm(),ga(Al),ga(qo),qN();break;case 5:WN(n);break;case 4:Tm();break;case 13:ga(Ea);break;case 19:ga(Ea);break;case 10:DN(n.type._context);break;case 22:case 23:t3()}r=r.return}if(Js=e,ms=e=nh(e.current,null),yo=Kl=t,Ms=0,a1=null,JN=oS=x0=0,vl=Ax=null,Gh!==null){for(t=0;t<Gh.length;t++)if(r=Gh[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}Gh=null}return e}function aD(e,t){do{var r=ms;try{if(IN(),Pv.current=v2,b2){for(var n=Ma.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}b2=!1}if(g0=0,Vs=Ts=Ma=null,jx=!1,r1=0,QN.current=null,r===null||r.return===null){Ms=1,a1=t,ms=null;break}e:{var s=e,o=r.return,l=r,c=t;if(t=yo,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=n8(o);if(p!==null){p.flags&=-257,i8(p,o,l,s,t),p.mode&1&&r8(s,u,t),t=p,c=u;var m=t.updateQueue;if(m===null){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}else{if(!(t&1)){r8(s,u,t),r3();break e}c=Error(Zr(426))}}else if(Sa&&l.mode&1){var y=n8(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),i8(y,o,l,s,t),FN(Pm(c,l));break e}}s=c=Pm(c,l),Ms!==4&&(Ms=2),Ax===null?Ax=[s]:Ax.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var b=zI(s,c,t);XT(s,b);break e;case 1:l=c;var v=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(th===null||!th.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t;var S=WI(s,l,t);XT(s,S);break e}}s=s.return}while(s!==null)}lD(r)}catch(j){t=j,ms===r&&r!==null&&(ms=r=r.return);continue}break}while(!0)}function sD(){var e=w2.current;return w2.current=v2,e===null?v2:e}function r3(){(Ms===0||Ms===3||Ms===2)&&(Ms=4),Js===null||!(x0&268435455)&&!(oS&268435455)||Df(Js,yo)}function j2(e,t){var r=ki;ki|=2;var n=sD();(Js!==e||yo!==t)&&(Ad=null,r0(e,t));do try{MQ();break}catch(i){aD(e,i)}while(!0);if(IN(),ki=r,w2.current=n,ms!==null)throw Error(Zr(261));return Js=null,yo=0,Ms}function MQ(){for(;ms!==null;)oD(ms)}function LQ(){for(;ms!==null&&!aX();)oD(ms)}function oD(e){var t=uD(e.alternate,e,Kl);e.memoizedProps=e.pendingProps,t===null?lD(e):ms=t,QN.current=null}function lD(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=NQ(r,t),r!==null){r.flags&=32767,ms=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ms=6,ms=null;return}}else if(r=AQ(r,t,Kl),r!==null){ms=r;return}if(t=t.sibling,t!==null){ms=t;return}ms=t=e}while(t!==null);Ms===0&&(Ms=5)}function Dh(e,t,r){var n=Gi,i=Dc.transition;try{Dc.transition=null,Gi=1,RQ(e,t,r,n)}finally{Dc.transition=i,Gi=n}return null}function RQ(e,t,r,n){do dm();while(qf!==null);if(ki&6)throw Error(Zr(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Zr(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(mX(e,s),e===Js&&(ms=Js=null,yo=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||yb||(yb=!0,dD(a2,function(){return dm(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Dc.transition,Dc.transition=null;var o=Gi;Gi=1;var l=ki;ki|=4,QN.current=null,EQ(e,r),rD(r,e),tQ(Yk),o2=!!Kk,Yk=Kk=null,e.current=r,TQ(r),sX(),ki=l,Gi=o,Dc.transition=s}else e.current=r;if(yb&&(yb=!1,qf=e,_2=i),s=e.pendingLanes,s===0&&(th=null),cX(r.stateNode),Cl(e,ts()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(S2)throw S2=!1,e=m4,m4=null,e;return _2&1&&e.tag!==0&&dm(),s=e.pendingLanes,s&1?e===g4?Nx++:(Nx=0,g4=e):Nx=0,Sh(),null}function dm(){if(qf!==null){var e=zB(_2),t=Dc.transition,r=Gi;try{if(Dc.transition=null,Gi=16>e?16:e,qf===null)var n=!1;else{if(e=qf,qf=null,_2=0,ki&6)throw Error(Zr(331));var i=ki;for(ki|=4,Cn=e.current;Cn!==null;){var s=Cn,o=s.child;if(Cn.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Cn=u;Cn!==null;){var d=Cn;switch(d.tag){case 0:case 11:case 15:kx(8,d,s)}var f=d.child;if(f!==null)f.return=d,Cn=f;else for(;Cn!==null;){d=Cn;var h=d.sibling,p=d.return;if(ZI(d),d===u){Cn=null;break}if(h!==null){h.return=p,Cn=h;break}Cn=p}}}var m=s.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}Cn=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Cn=o;else e:for(;Cn!==null;){if(s=Cn,s.flags&2048)switch(s.tag){case 0:case 11:case 15:kx(9,s,s.return)}var b=s.sibling;if(b!==null){b.return=s.return,Cn=b;break e}Cn=s.return}}var v=e.current;for(Cn=v;Cn!==null;){o=Cn;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,Cn=w;else e:for(o=v;Cn!==null;){if(l=Cn,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:sS(9,l)}}catch(j){Wa(l,l.return,j)}if(l===o){Cn=null;break e}var S=l.sibling;if(S!==null){S.return=l.return,Cn=S;break e}Cn=l.return}}if(ki=i,Sh(),Ju&&typeof Ju.onPostCommitFiberRoot=="function")try{Ju.onPostCommitFiberRoot(Jw,e)}catch{}n=!0}return n}finally{Gi=r,Dc.transition=t}}return!1}function x8(e,t,r){t=Pm(r,t),t=zI(e,t,1),e=eh(e,t,1),t=il(),e!==null&&(H1(e,1,t),Cl(e,t))}function Wa(e,t,r){if(e.tag===3)x8(e,e,r);else for(;t!==null;){if(t.tag===3){x8(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(th===null||!th.has(n))){e=Pm(r,e),e=WI(t,e,1),t=eh(t,e,1),e=il(),t!==null&&(H1(t,1,e),Cl(t,e));break}}t=t.return}}function FQ(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=il(),e.pingedLanes|=e.suspendedLanes&r,Js===e&&(yo&r)===r&&(Ms===4||Ms===3&&(yo&130023424)===yo&&500>ts()-ZN?r0(e,0):JN|=r),Cl(e,t)}function cD(e,t){t===0&&(e.mode&1?(t=lb,lb<<=1,!(lb&130023424)&&(lb=4194304)):t=1);var r=il();e=Gd(e,t),e!==null&&(H1(e,t,r),Cl(e,r))}function BQ(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),cD(e,r)}function IQ(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Zr(314))}n!==null&&n.delete(t),cD(e,r)}var uD;uD=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Al.current)wl=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return wl=!1,kQ(e,t,r);wl=!!(e.flags&131072)}else wl=!1,Sa&&t.flags&1048576&&pI(t,p2,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Mv(e,t),e=t.pendingProps;var i=Nm(t,qo.current);um(t,r),i=VN(null,t,n,e,i,r);var s=GN();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Nl(n)?(s=!0,f2(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,UN(t),i.updater=aS,t.stateNode=i,i._reactInternals=t,i4(t,n,e,r),t=o4(null,t,n,!0,s,r)):(t.tag=0,Sa&&s&&LN(t),Zo(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Mv(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=$Q(n),e=iu(n,e),i){case 0:t=s4(null,t,n,e,r);break e;case 1:t=o8(null,t,n,e,r);break e;case 11:t=a8(null,t,n,e,r);break e;case 14:t=s8(null,t,n,iu(n.type,e),r);break e}throw Error(Zr(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:iu(n,i),s4(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:iu(n,i),o8(e,t,n,i,r);case 3:e:{if(GI(t),e===null)throw Error(Zr(387));n=t.pendingProps,s=t.memoizedState,i=s.element,vI(e,t),x2(t,n,null,r);var o=t.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=Pm(Error(Zr(423)),t),t=l8(e,t,n,r,i);break e}else if(n!==i){i=Pm(Error(Zr(424)),t),t=l8(e,t,n,r,i);break e}else for(ec=Zf(t.stateNode.containerInfo.firstChild),nc=t,Sa=!0,ou=null,r=yI(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Cm(),n===i){t=Kd(e,t,r);break e}Zo(e,t,n,r)}t=t.child}return t;case 5:return wI(t),e===null&&t4(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,o=i.children,Xk(n,i)?o=null:s!==null&&Xk(n,s)&&(t.flags|=32),VI(e,t),Zo(e,t,o,r),t.child;case 6:return e===null&&t4(t),null;case 13:return KI(e,t,r);case 4:return zN(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Em(t,null,n,r):Zo(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:iu(n,i),a8(e,t,n,i,r);case 7:return Zo(e,t,t.pendingProps,r),t.child;case 8:return Zo(e,t,t.pendingProps.children,r),t.child;case 12:return Zo(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,oa(m2,n._currentValue),n._currentValue=o,s!==null)if(yu(s.value,o)){if(s.children===i.children&&!Al.current){t=Kd(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=Dd(-1,r&-r),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),r4(s.return,r,t),l.lanes|=r;break}c=c.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Zr(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),r4(o,r,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Zo(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,um(t,r),i=Uc(i),n=n(i),t.flags|=1,Zo(e,t,n,r),t.child;case 14:return n=t.type,i=iu(n,t.pendingProps),i=iu(n.type,i),s8(e,t,n,i,r);case 15:return qI(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:iu(n,i),Mv(e,t),t.tag=1,Nl(n)?(e=!0,f2(t)):e=!1,um(t,r),UI(t,n,i),i4(t,n,i,r),o4(null,t,n,!0,e,r);case 19:return YI(e,t,r);case 22:return HI(e,t,r)}throw Error(Zr(156,t.tag))};function dD(e,t){return IB(e,t)}function DQ(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bc(e,t,r,n){return new DQ(e,t,r,n)}function n3(e){return e=e.prototype,!(!e||!e.isReactComponent)}function $Q(e){if(typeof e=="function")return n3(e)?1:0;if(e!=null){if(e=e.$$typeof,e===SN)return 11;if(e===_N)return 14}return 2}function nh(e,t){var r=e.alternate;return r===null?(r=Bc(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Fv(e,t,r,n,i,s){var o=2;if(n=e,typeof e=="function")n3(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case zp:return n0(r.children,i,s,t);case wN:o=8,i|=8;break;case Ck:return e=Bc(12,r,t,i|2),e.elementType=Ck,e.lanes=s,e;case Ek:return e=Bc(13,r,t,i),e.elementType=Ek,e.lanes=s,e;case Tk:return e=Bc(19,r,t,i),e.elementType=Tk,e.lanes=s,e;case wB:return lS(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case bB:o=10;break e;case vB:o=9;break e;case SN:o=11;break e;case _N:o=14;break e;case Lf:o=16,n=null;break e}throw Error(Zr(130,e==null?e:typeof e,""))}return t=Bc(o,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function n0(e,t,r,n){return e=Bc(7,e,n,t),e.lanes=r,e}function lS(e,t,r,n){return e=Bc(22,e,n,t),e.elementType=wB,e.lanes=r,e.stateNode={isHidden:!1},e}function D5(e,t,r){return e=Bc(6,e,null,t),e.lanes=r,e}function $5(e,t,r){return t=Bc(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function UQ(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=v5(0),this.expirationTimes=v5(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=v5(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function i3(e,t,r,n,i,s,o,l,c){return e=new UQ(e,t,r,l,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Bc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},UN(s),e}function zQ(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Up,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function fD(e){if(!e)return uh;e=e._reactInternals;e:{if(U0(e)!==e||e.tag!==1)throw Error(Zr(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Nl(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Zr(171))}if(e.tag===1){var r=e.type;if(Nl(r))return fI(e,r,t)}return t}function hD(e,t,r,n,i,s,o,l,c){return e=i3(r,n,!0,e,i,s,o,l,c),e.context=fD(null),r=e.current,n=il(),i=rh(r),s=Dd(n,i),s.callback=t??null,eh(r,s,i),e.current.lanes=i,H1(e,i,n),Cl(e,n),e}function cS(e,t,r,n){var i=t.current,s=il(),o=rh(i);return r=fD(r),t.context===null?t.context=r:t.pendingContext=r,t=Dd(s,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=eh(i,t,o),e!==null&&(pu(e,i,o,s),Tv(e,i,o)),o}function k2(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function y8(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function a3(e,t){y8(e,t),(e=e.alternate)&&y8(e,t)}function WQ(){return null}var pD=typeof reportError=="function"?reportError:function(e){console.error(e)};function s3(e){this._internalRoot=e}uS.prototype.render=s3.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Zr(409));cS(e,t,null,null)};uS.prototype.unmount=s3.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;y0(function(){cS(null,e,null,null)}),t[Vd]=null}};function uS(e){this._internalRoot=e}uS.prototype.unstable_scheduleHydration=function(e){if(e){var t=HB();e={blockedOn:null,target:e,priority:t};for(var r=0;r<If.length&&t!==0&&t<If[r].priority;r++);If.splice(r,0,e),r===0&&GB(e)}};function o3(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function dS(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function b8(){}function qQ(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=k2(o);s.call(u)}}var o=hD(t,n,e,0,null,!1,!1,"",b8);return e._reactRootContainer=o,e[Vd]=o.current,Qx(e.nodeType===8?e.parentNode:e),y0(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var l=n;n=function(){var u=k2(c);l.call(u)}}var c=i3(e,0,!1,null,null,!1,!1,"",b8);return e._reactRootContainer=c,e[Vd]=c.current,Qx(e.nodeType===8?e.parentNode:e),y0(function(){cS(t,c,r,n)}),c}function fS(e,t,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var c=k2(o);l.call(c)}}cS(t,o,e,i)}else o=qQ(r,t,e,i,n);return k2(o)}WB=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ux(t.pendingLanes);r!==0&&(AN(t,r|1),Cl(t,ts()),!(ki&6)&&(Om=ts()+500,Sh()))}break;case 13:y0(function(){var n=Gd(e,1);if(n!==null){var i=il();pu(n,e,1,i)}}),a3(e,1)}};NN=function(e){if(e.tag===13){var t=Gd(e,134217728);if(t!==null){var r=il();pu(t,e,134217728,r)}a3(e,134217728)}};qB=function(e){if(e.tag===13){var t=rh(e),r=Gd(e,t);if(r!==null){var n=il();pu(r,e,t,n)}a3(e,t)}};HB=function(){return Gi};VB=function(e,t){var r=Gi;try{return Gi=e,t()}finally{Gi=r}};$k=function(e,t,r){switch(t){case"input":if(Mk(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=rS(n);if(!i)throw Error(Zr(90));_B(n),Mk(n,i)}}}break;case"textarea":kB(e,r);break;case"select":t=r.value,t!=null&&sm(e,!!r.multiple,t,!1)}};OB=e3;MB=y0;var HQ={usingClientEntryPoint:!1,Events:[G1,Vp,rS,TB,PB,e3]},Ug={findFiberByHostInstance:Vh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},VQ={bundleType:Ug.bundleType,version:Ug.version,rendererPackageName:Ug.rendererPackageName,rendererConfig:Ug.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:of.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=FB(e),e===null?null:e.stateNode},findFiberByHostInstance:Ug.findFiberByHostInstance||WQ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bb=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bb.isDisabled&&bb.supportsFiber)try{Jw=bb.inject(VQ),Ju=bb}catch{}}dc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=HQ;dc.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!o3(t))throw Error(Zr(200));return zQ(e,t,null,r)};dc.createRoot=function(e,t){if(!o3(e))throw Error(Zr(299));var r=!1,n="",i=pD;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=i3(e,1,!1,null,null,r,!1,n,i),e[Vd]=t.current,Qx(e.nodeType===8?e.parentNode:e),new s3(t)};dc.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Zr(188)):(e=Object.keys(e).join(","),Error(Zr(268,e)));return e=FB(t),e=e===null?null:e.stateNode,e};dc.flushSync=function(e){return y0(e)};dc.hydrate=function(e,t,r){if(!dS(t))throw Error(Zr(200));return fS(null,e,t,!0,r)};dc.hydrateRoot=function(e,t,r){if(!o3(e))throw Error(Zr(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=pD;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=hD(t,null,e,1,r??null,i,!1,s,o),e[Vd]=t.current,Qx(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new uS(t)};dc.render=function(e,t,r){if(!dS(t))throw Error(Zr(200));return fS(null,e,t,!1,r)};dc.unmountComponentAtNode=function(e){if(!dS(e))throw Error(Zr(40));return e._reactRootContainer?(y0(function(){fS(null,null,e,!1,function(){e._reactRootContainer=null,e[Vd]=null})}),!0):!1};dc.unstable_batchedUpdates=e3;dc.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!dS(r))throw Error(Zr(200));if(e==null||e._reactInternals===void 0)throw Error(Zr(38));return fS(e,t,r,!1,n)};dc.version="18.3.1-next-f1338f8080-20240426";function mD(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(mD)}catch(e){console.error(e)}}mD(),mB.exports=dc;var Y1=mB.exports,gD,v8=Y1;gD=v8.createRoot,v8.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function s1(){return s1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s1.apply(this,arguments)}var Hf;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Hf||(Hf={}));const w8="popstate";function GQ(e){e===void 0&&(e={});function t(n,i){let{pathname:s,search:o,hash:l}=n.location;return b4("",{pathname:s,search:o,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:A2(i)}return YQ(t,r,null,e)}function ss(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function l3(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function KQ(){return Math.random().toString(36).substr(2,8)}function S8(e,t){return{usr:e.state,key:e.key,idx:t}}function b4(e,t,r,n){return r===void 0&&(r=null),s1({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?tg(t):t,{state:r,key:t&&t.key||n||KQ()})}function A2(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function tg(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function YQ(e,t,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,o=i.history,l=Hf.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(s1({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function f(){l=Hf.Pop;let y=d(),b=y==null?null:y-u;u=y,c&&c({action:l,location:g.location,delta:b})}function h(y,b){l=Hf.Push;let v=b4(g.location,y,b);u=d()+1;let w=S8(v,u),S=g.createHref(v);try{o.pushState(w,"",S)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;i.location.assign(S)}s&&c&&c({action:l,location:g.location,delta:1})}function p(y,b){l=Hf.Replace;let v=b4(g.location,y,b);u=d();let w=S8(v,u),S=g.createHref(v);o.replaceState(w,"",S),s&&c&&c({action:l,location:g.location,delta:0})}function m(y){let b=i.location.origin!=="null"?i.location.origin:i.location.href,v=typeof y=="string"?y:A2(y);return v=v.replace(/ $/,"%20"),ss(b,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,b)}let g={get action(){return l},get location(){return e(i,o)},listen(y){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(w8,f),c=y,()=>{i.removeEventListener(w8,f),c=null}},createHref(y){return t(i,y)},createURL:m,encodeLocation(y){let b=m(y);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:h,replace:p,go(y){return o.go(y)}};return g}var _8;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(_8||(_8={}));function XQ(e,t,r){return r===void 0&&(r="/"),QQ(e,t,r)}function QQ(e,t,r,n){let i=typeof t=="string"?tg(t):t,s=c3(i.pathname||"/",r);if(s==null)return null;let o=xD(e);JQ(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=uJ(s);l=oJ(o[c],u)}return l}function xD(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,o,l)=>{let c={relativePath:l===void 0?s.path||"":l,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};c.relativePath.startsWith("/")&&(ss(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=ih([n,c.relativePath]),d=r.concat(c);s.children&&s.children.length>0&&(ss(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),xD(s.children,t,d,u)),!(s.path==null&&!s.index)&&t.push({path:u,score:aJ(u,s.index),routesMeta:d})};return e.forEach((s,o)=>{var l;if(s.path===""||!((l=s.path)!=null&&l.includes("?")))i(s,o);else for(let c of yD(s.path))i(s,o,c)}),t}function yD(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let o=yD(n.join("/")),l=[];return l.push(...o.map(c=>c===""?s:[s,c].join("/"))),i&&l.push(...o),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function JQ(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:sJ(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const ZQ=/^:[\w-]+$/,eJ=3,tJ=2,rJ=1,nJ=10,iJ=-2,j8=e=>e==="*";function aJ(e,t){let r=e.split("/"),n=r.length;return r.some(j8)&&(n+=iJ),t&&(n+=tJ),r.filter(i=>!j8(i)).reduce((i,s)=>i+(ZQ.test(s)?eJ:s===""?rJ:nJ),n)}function sJ(e,t){return e.length===t.length&&e.slice(0,-1).every((n,i)=>n===t[i])?e[e.length-1]-t[t.length-1]:0}function oJ(e,t,r){let{routesMeta:n}=e,i={},s="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,d=s==="/"?t:t.slice(s.length)||"/",f=lJ({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),h=c.route;if(!f)return null;Object.assign(i,f.params),o.push({params:i,pathname:ih([s,f.pathname]),pathnameBase:mJ(ih([s,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(s=ih([s,f.pathnameBase]))}return o}function lJ(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=cJ(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:n.reduce((u,d,f)=>{let{paramName:h,isOptional:p}=d;if(h==="*"){let g=l[f]||"";o=s.slice(0,s.length-g.length).replace(/(.)\/+$/,"$1")}const m=l[f];return p&&!m?u[h]=void 0:u[h]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:e}}function cJ(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),l3(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function uJ(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return l3(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function c3(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}const dJ=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,fJ=e=>dJ.test(e);function hJ(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:i=""}=typeof e=="string"?tg(e):e,s;if(r)if(fJ(r))s=r;else{if(r.includes("//")){let o=r;r=r.replace(/\/\/+/g,"/"),l3(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+r))}r.startsWith("/")?s=k8(r.substring(1),"/"):s=k8(r,t)}else s=t;return{pathname:s,search:gJ(n),hash:xJ(i)}}function k8(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function U5(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function pJ(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function u3(e,t){let r=pJ(e);return t?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function d3(e,t,r,n){n===void 0&&(n=!1);let i;typeof e=="string"?i=tg(e):(i=s1({},e),ss(!i.pathname||!i.pathname.includes("?"),U5("?","pathname","search",i)),ss(!i.pathname||!i.pathname.includes("#"),U5("#","pathname","hash",i)),ss(!i.search||!i.search.includes("#"),U5("#","search","hash",i)));let s=e===""||i.pathname==="",o=s?"/":i.pathname,l;if(o==null)l=r;else{let f=t.length-1;if(!n&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),f-=1;i.pathname=h.join("/")}l=f>=0?t[f]:"/"}let c=hJ(i,l),u=o&&o!=="/"&&o.endsWith("/"),d=(s||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const ih=e=>e.join("/").replace(/\/\/+/g,"/"),mJ=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),gJ=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,xJ=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function yJ(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const bD=["post","put","patch","delete"];new Set(bD);const bJ=["get",...bD];new Set(bJ);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function o1(){return o1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o1.apply(this,arguments)}const f3=x.createContext(null),vJ=x.createContext(null),_h=x.createContext(null),hS=x.createContext(null),lf=x.createContext({outlet:null,matches:[],isDataRoute:!1}),vD=x.createContext(null);function wJ(e,t){let{relative:r}=t===void 0?{}:t;rg()||ss(!1);let{basename:n,navigator:i}=x.useContext(_h),{hash:s,pathname:o,search:l}=SD(e,{relative:r}),c=o;return n!=="/"&&(c=o==="/"?n:ih([n,o])),i.createHref({pathname:c,search:l,hash:s})}function rg(){return x.useContext(hS)!=null}function hl(){return rg()||ss(!1),x.useContext(hS).location}function wD(e){x.useContext(_h).static||x.useLayoutEffect(e)}function vo(){let{isDataRoute:e}=x.useContext(lf);return e?LJ():SJ()}function SJ(){rg()||ss(!1);let e=x.useContext(f3),{basename:t,future:r,navigator:n}=x.useContext(_h),{matches:i}=x.useContext(lf),{pathname:s}=hl(),o=JSON.stringify(u3(i,r.v7_relativeSplatPath)),l=x.useRef(!1);return wD(()=>{l.current=!0}),x.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){n.go(u);return}let f=d3(u,JSON.parse(o),s,d.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:ih([t,f.pathname])),(d.replace?n.replace:n.push)(f,d.state,d)},[t,n,o,s,e])}function z0(){let{matches:e}=x.useContext(lf),t=e[e.length-1];return t?t.params:{}}function SD(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=x.useContext(_h),{matches:i}=x.useContext(lf),{pathname:s}=hl(),o=JSON.stringify(u3(i,n.v7_relativeSplatPath));return x.useMemo(()=>d3(e,JSON.parse(o),s,r==="path"),[e,o,s,r])}function _J(e,t){return jJ(e,t)}function jJ(e,t,r,n){rg()||ss(!1);let{navigator:i}=x.useContext(_h),{matches:s}=x.useContext(lf),o=s[s.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=hl(),d;if(t){var f;let y=typeof t=="string"?tg(t):t;c==="/"||(f=y.pathname)!=null&&f.startsWith(c)||ss(!1),d=y}else d=u;let h=d.pathname||"/",p=h;if(c!=="/"){let y=c.replace(/^\//,"").split("/");p="/"+h.replace(/^\//,"").split("/").slice(y.length).join("/")}let m=XQ(e,{pathname:p}),g=EJ(m&&m.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:ih([c,i.encodeLocation?i.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:ih([c,i.encodeLocation?i.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),s,r,n);return t&&g?x.createElement(hS.Provider,{value:{location:o1({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Hf.Pop}},g):g}function kJ(){let e=MJ(),t=yJ(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return x.createElement(x.Fragment,null,x.createElement("h2",null,"Unexpected Application Error!"),x.createElement("h3",{style:{fontStyle:"italic"}},t),r?x.createElement("pre",{style:i},r):null,null)}const AJ=x.createElement(kJ,null);class NJ extends x.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?x.createElement(lf.Provider,{value:this.props.routeContext},x.createElement(vD.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function CJ(e){let{routeContext:t,match:r,children:n}=e,i=x.useContext(f3);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),x.createElement(lf.Provider,{value:t},n)}function EJ(e,t,r,n){var i;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var s;if(!r)return null;if(r.errors)e=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let o=e,l=(i=r)==null?void 0:i.errors;if(l!=null){let d=o.findIndex(f=>f.route.id&&(l==null?void 0:l[f.route.id])!==void 0);d>=0||ss(!1),o=o.slice(0,Math.min(o.length,d+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<o.length;d++){let f=o[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:h,errors:p}=r,m=f.route.loader&&h[f.route.id]===void 0&&(!p||p[f.route.id]===void 0);if(f.route.lazy||m){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,f,h)=>{let p,m=!1,g=null,y=null;r&&(p=l&&f.route.id?l[f.route.id]:void 0,g=f.route.errorElement||AJ,c&&(u<0&&h===0?(RJ("route-fallback"),m=!0,y=null):u===h&&(m=!0,y=f.route.hydrateFallbackElement||null)));let b=t.concat(o.slice(0,h+1)),v=()=>{let w;return p?w=g:m?w=y:f.route.Component?w=x.createElement(f.route.Component,null):f.route.element?w=f.route.element:w=d,x.createElement(CJ,{match:f,routeContext:{outlet:d,matches:b,isDataRoute:r!=null},children:w})};return r&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?x.createElement(NJ,{location:r.location,revalidation:r.revalidation,component:g,error:p,children:v(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):v()},null)}var _D=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(_D||{}),jD=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(jD||{});function TJ(e){let t=x.useContext(f3);return t||ss(!1),t}function PJ(e){let t=x.useContext(vJ);return t||ss(!1),t}function OJ(e){let t=x.useContext(lf);return t||ss(!1),t}function kD(e){let t=OJ(),r=t.matches[t.matches.length-1];return r.route.id||ss(!1),r.route.id}function MJ(){var e;let t=x.useContext(vD),r=PJ(),n=kD();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function LJ(){let{router:e}=TJ(_D.UseNavigateStable),t=kD(jD.UseNavigateStable),r=x.useRef(!1);return wD(()=>{r.current=!0}),x.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,o1({fromRouteId:t},s)))},[e,t])}const A8={};function RJ(e,t,r){A8[e]||(A8[e]=!0)}function FJ(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Zp(e){let{to:t,replace:r,state:n,relative:i}=e;rg()||ss(!1);let{future:s,static:o}=x.useContext(_h),{matches:l}=x.useContext(lf),{pathname:c}=hl(),u=vo(),d=d3(t,u3(l,s.v7_relativeSplatPath),c,i==="path"),f=JSON.stringify(d);return x.useEffect(()=>u(JSON.parse(f),{replace:r,state:n,relative:i}),[u,f,i,r,n]),null}function ei(e){ss(!1)}function BJ(e){let{basename:t="/",children:r=null,location:n,navigationType:i=Hf.Pop,navigator:s,static:o=!1,future:l}=e;rg()&&ss(!1);let c=t.replace(/^\/*/,"/"),u=x.useMemo(()=>({basename:c,navigator:s,static:o,future:o1({v7_relativeSplatPath:!1},l)}),[c,l,s,o]);typeof n=="string"&&(n=tg(n));let{pathname:d="/",search:f="",hash:h="",state:p=null,key:m="default"}=n,g=x.useMemo(()=>{let y=c3(d,c);return y==null?null:{location:{pathname:y,search:f,hash:h,state:p,key:m},navigationType:i}},[c,d,f,h,p,m,i]);return g==null?null:x.createElement(_h.Provider,{value:u},x.createElement(hS.Provider,{children:r,value:g}))}function v4(e){let{children:t,location:r}=e;return _J(w4(t),r)}new Promise(()=>{});function w4(e,t){t===void 0&&(t=[]);let r=[];return x.Children.forEach(e,(n,i)=>{if(!x.isValidElement(n))return;let s=[...t,i];if(n.type===x.Fragment){r.push.apply(r,w4(n.props.children,s));return}n.type!==ei&&ss(!1),!n.props.index||!n.props.children||ss(!1);let o={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=w4(n.props.children,s)),r.push(o)}),r}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function S4(){return S4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},S4.apply(this,arguments)}function IJ(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function DJ(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function $J(e,t){return e.button===0&&(!t||t==="_self")&&!DJ(e)}function _4(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(i=>[r,i]):[[r,n]])},[]))}function UJ(e,t){let r=_4(e);return t&&t.forEach((n,i)=>{r.has(i)||t.getAll(i).forEach(s=>{r.append(i,s)})}),r}const zJ=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],WJ="6";try{window.__reactRouterVersion=WJ}catch{}const qJ="startTransition",N8=hB[qJ];function HJ(e){let{basename:t,children:r,future:n,window:i}=e,s=x.useRef();s.current==null&&(s.current=GQ({window:i,v5Compat:!0}));let o=s.current,[l,c]=x.useState({action:o.action,location:o.location}),{v7_startTransition:u}=n||{},d=x.useCallback(f=>{u&&N8?N8(()=>c(f)):c(f)},[c,u]);return x.useLayoutEffect(()=>o.listen(d),[o,d]),x.useEffect(()=>FJ(n),[n]),x.createElement(BJ,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:o,future:n})}const VJ=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",GJ=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,es=x.forwardRef(function(t,r){let{onClick:n,relative:i,reloadDocument:s,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:f}=t,h=IJ(t,zJ),{basename:p}=x.useContext(_h),m,g=!1;if(typeof u=="string"&&GJ.test(u)&&(m=u,VJ))try{let w=new URL(window.location.href),S=u.startsWith("//")?new URL(w.protocol+u):new URL(u),j=c3(S.pathname,p);S.origin===w.origin&&j!=null?u=j+S.search+S.hash:g=!0}catch{}let y=wJ(u,{relative:i}),b=KJ(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:i,viewTransition:f});function v(w){n&&n(w),w.defaultPrevented||b(w)}return x.createElement("a",S4({},h,{href:m||y,onClick:g||s?n:v,ref:r,target:c}))});var C8;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(C8||(C8={}));var E8;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(E8||(E8={}));function KJ(e,t){let{target:r,replace:n,state:i,preventScrollReset:s,relative:o,viewTransition:l}=t===void 0?{}:t,c=vo(),u=hl(),d=SD(e,{relative:o});return x.useCallback(f=>{if($J(f,r)){f.preventDefault();let h=n!==void 0?n:A2(u)===A2(d);c(e,{replace:h,state:i,preventScrollReset:s,relative:o,viewTransition:l})}},[u,c,d,n,i,r,e,s,o,l])}function YJ(e){let t=x.useRef(_4(e)),r=x.useRef(!1),n=hl(),i=x.useMemo(()=>UJ(n.search,r.current?null:t.current),[n.search]),s=vo(),o=x.useCallback((l,c)=>{const u=_4(typeof l=="function"?l(i):l);r.current=!0,s("?"+u,c)},[s,i]);return[i,o]}function AD(e,t){return function(){return e.apply(t,arguments)}}const{toString:XJ}=Object.prototype,{getPrototypeOf:h3}=Object,{iterator:pS,toStringTag:ND}=Symbol,mS=(e=>t=>{const r=XJ.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Su=e=>(e=e.toLowerCase(),t=>mS(t)===e),gS=e=>t=>typeof t===e,{isArray:ng}=Array,Mm=gS("undefined");function X1(e){return e!==null&&!Mm(e)&&e.constructor!==null&&!Mm(e.constructor)&&El(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const CD=Su("ArrayBuffer");function QJ(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&CD(e.buffer),t}const JJ=gS("string"),El=gS("function"),ED=gS("number"),Q1=e=>e!==null&&typeof e=="object",ZJ=e=>e===!0||e===!1,Bv=e=>{if(mS(e)!=="object")return!1;const t=h3(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(ND in e)&&!(pS in e)},eZ=e=>{if(!Q1(e)||X1(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},tZ=Su("Date"),rZ=Su("File"),nZ=Su("Blob"),iZ=Su("FileList"),aZ=e=>Q1(e)&&El(e.pipe),sZ=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||El(e.append)&&((t=mS(e))==="formdata"||t==="object"&&El(e.toString)&&e.toString()==="[object FormData]"))},oZ=Su("URLSearchParams"),[lZ,cZ,uZ,dZ]=["ReadableStream","Request","Response","Headers"].map(Su),fZ=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function J1(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,i;if(typeof e!="object"&&(e=[e]),ng(e))for(n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else{if(X1(e))return;const s=r?Object.getOwnPropertyNames(e):Object.keys(e),o=s.length;let l;for(n=0;n<o;n++)l=s[n],t.call(null,e[l],l,e)}}function TD(e,t){if(X1(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,i;for(;n-- >0;)if(i=r[n],t===i.toLowerCase())return i;return null}const Yh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,PD=e=>!Mm(e)&&e!==Yh;function j4(){const{caseless:e,skipUndefined:t}=PD(this)&&this||{},r={},n=(i,s)=>{const o=e&&TD(r,s)||s;Bv(r[o])&&Bv(i)?r[o]=j4(r[o],i):Bv(i)?r[o]=j4({},i):ng(i)?r[o]=i.slice():(!t||!Mm(i))&&(r[o]=i)};for(let i=0,s=arguments.length;i<s;i++)arguments[i]&&J1(arguments[i],n);return r}const hZ=(e,t,r,{allOwnKeys:n}={})=>(J1(t,(i,s)=>{r&&El(i)?e[s]=AD(i,r):e[s]=i},{allOwnKeys:n}),e),pZ=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),mZ=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},gZ=(e,t,r,n)=>{let i,s,o;const l={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),s=i.length;s-- >0;)o=i[s],(!n||n(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=r!==!1&&h3(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},xZ=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},yZ=e=>{if(!e)return null;if(ng(e))return e;let t=e.length;if(!ED(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},bZ=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&h3(Uint8Array)),vZ=(e,t)=>{const n=(e&&e[pS]).call(e);let i;for(;(i=n.next())&&!i.done;){const s=i.value;t.call(e,s[0],s[1])}},wZ=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},SZ=Su("HTMLFormElement"),_Z=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,i){return n.toUpperCase()+i}),T8=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),jZ=Su("RegExp"),OD=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};J1(r,(i,s)=>{let o;(o=t(i,s,e))!==!1&&(n[s]=o||i)}),Object.defineProperties(e,n)},kZ=e=>{OD(e,(t,r)=>{if(El(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(El(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},AZ=(e,t)=>{const r={},n=i=>{i.forEach(s=>{r[s]=!0})};return ng(e)?n(e):n(String(e).split(t)),r},NZ=()=>{},CZ=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function EZ(e){return!!(e&&El(e.append)&&e[ND]==="FormData"&&e[pS])}const TZ=e=>{const t=new Array(10),r=(n,i)=>{if(Q1(n)){if(t.indexOf(n)>=0)return;if(X1(n))return n;if(!("toJSON"in n)){t[i]=n;const s=ng(n)?[]:{};return J1(n,(o,l)=>{const c=r(o,i+1);!Mm(c)&&(s[l]=c)}),t[i]=void 0,s}}return n};return r(e,0)},PZ=Su("AsyncFunction"),OZ=e=>e&&(Q1(e)||El(e))&&El(e.then)&&El(e.catch),MD=((e,t)=>e?setImmediate:t?((r,n)=>(Yh.addEventListener("message",({source:i,data:s})=>{i===Yh&&s===r&&n.length&&n.shift()()},!1),i=>{n.push(i),Yh.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",El(Yh.postMessage)),MZ=typeof queueMicrotask<"u"?queueMicrotask.bind(Yh):typeof process<"u"&&process.nextTick||MD,LZ=e=>e!=null&&El(e[pS]),fr={isArray:ng,isArrayBuffer:CD,isBuffer:X1,isFormData:sZ,isArrayBufferView:QJ,isString:JJ,isNumber:ED,isBoolean:ZJ,isObject:Q1,isPlainObject:Bv,isEmptyObject:eZ,isReadableStream:lZ,isRequest:cZ,isResponse:uZ,isHeaders:dZ,isUndefined:Mm,isDate:tZ,isFile:rZ,isBlob:nZ,isRegExp:jZ,isFunction:El,isStream:aZ,isURLSearchParams:oZ,isTypedArray:bZ,isFileList:iZ,forEach:J1,merge:j4,extend:hZ,trim:fZ,stripBOM:pZ,inherits:mZ,toFlatObject:gZ,kindOf:mS,kindOfTest:Su,endsWith:xZ,toArray:yZ,forEachEntry:vZ,matchAll:wZ,isHTMLForm:SZ,hasOwnProperty:T8,hasOwnProp:T8,reduceDescriptors:OD,freezeMethods:kZ,toObjectSet:AZ,toCamelCase:_Z,noop:NZ,toFiniteNumber:CZ,findKey:TD,global:Yh,isContextDefined:PD,isSpecCompliantForm:EZ,toJSONObject:TZ,isAsyncFn:PZ,isThenable:OZ,setImmediate:MD,asap:MZ,isIterable:LZ};function oi(e,t,r,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),i&&(this.response=i,this.status=i.status?i.status:null)}fr.inherits(oi,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:fr.toJSONObject(this.config),code:this.code,status:this.status}}});const LD=oi.prototype,RD={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{RD[e]={value:e}});Object.defineProperties(oi,RD);Object.defineProperty(LD,"isAxiosError",{value:!0});oi.from=(e,t,r,n,i,s)=>{const o=Object.create(LD);fr.toFlatObject(e,o,function(d){return d!==Error.prototype},u=>u!=="isAxiosError");const l=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return oi.call(o,l,c,r,n,i),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",s&&Object.assign(o,s),o};const RZ=null;function k4(e){return fr.isPlainObject(e)||fr.isArray(e)}function FD(e){return fr.endsWith(e,"[]")?e.slice(0,-2):e}function P8(e,t,r){return e?e.concat(t).map(function(i,s){return i=FD(i),!r&&s?"["+i+"]":i}).join(r?".":""):t}function FZ(e){return fr.isArray(e)&&!e.some(k4)}const BZ=fr.toFlatObject(fr,{},null,function(t){return/^is[A-Z]/.test(t)});function xS(e,t,r){if(!fr.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=fr.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,y){return!fr.isUndefined(y[g])});const n=r.metaTokens,i=r.visitor||d,s=r.dots,o=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&fr.isSpecCompliantForm(t);if(!fr.isFunction(i))throw new TypeError("visitor must be a function");function u(m){if(m===null)return"";if(fr.isDate(m))return m.toISOString();if(fr.isBoolean(m))return m.toString();if(!c&&fr.isBlob(m))throw new oi("Blob is not supported. Use a Buffer instead.");return fr.isArrayBuffer(m)||fr.isTypedArray(m)?c&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function d(m,g,y){let b=m;if(m&&!y&&typeof m=="object"){if(fr.endsWith(g,"{}"))g=n?g:g.slice(0,-2),m=JSON.stringify(m);else if(fr.isArray(m)&&FZ(m)||(fr.isFileList(m)||fr.endsWith(g,"[]"))&&(b=fr.toArray(m)))return g=FD(g),b.forEach(function(w,S){!(fr.isUndefined(w)||w===null)&&t.append(o===!0?P8([g],S,s):o===null?g:g+"[]",u(w))}),!1}return k4(m)?!0:(t.append(P8(y,g,s),u(m)),!1)}const f=[],h=Object.assign(BZ,{defaultVisitor:d,convertValue:u,isVisitable:k4});function p(m,g){if(!fr.isUndefined(m)){if(f.indexOf(m)!==-1)throw Error("Circular reference detected in "+g.join("."));f.push(m),fr.forEach(m,function(b,v){(!(fr.isUndefined(b)||b===null)&&i.call(t,b,fr.isString(v)?v.trim():v,g,h))===!0&&p(b,g?g.concat(v):[v])}),f.pop()}}if(!fr.isObject(e))throw new TypeError("data must be an object");return p(e),t}function O8(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function p3(e,t){this._pairs=[],e&&xS(e,this,t)}const BD=p3.prototype;BD.append=function(t,r){this._pairs.push([t,r])};BD.toString=function(t){const r=t?function(n){return t.call(this,n,O8)}:O8;return this._pairs.map(function(i){return r(i[0])+"="+r(i[1])},"").join("&")};function IZ(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function ID(e,t,r){if(!t)return e;const n=r&&r.encode||IZ;fr.isFunction(r)&&(r={serialize:r});const i=r&&r.serialize;let s;if(i?s=i(t,r):s=fr.isURLSearchParams(t)?t.toString():new p3(t,r).toString(n),s){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class M8{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){fr.forEach(this.handlers,function(n){n!==null&&t(n)})}}const DD={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},DZ=typeof URLSearchParams<"u"?URLSearchParams:p3,$Z=typeof FormData<"u"?FormData:null,UZ=typeof Blob<"u"?Blob:null,zZ={isBrowser:!0,classes:{URLSearchParams:DZ,FormData:$Z,Blob:UZ},protocols:["http","https","file","blob","url","data"]},m3=typeof window<"u"&&typeof document<"u",A4=typeof navigator=="object"&&navigator||void 0,WZ=m3&&(!A4||["ReactNative","NativeScript","NS"].indexOf(A4.product)<0),qZ=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",HZ=m3&&window.location.href||"http://localhost",VZ=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:m3,hasStandardBrowserEnv:WZ,hasStandardBrowserWebWorkerEnv:qZ,navigator:A4,origin:HZ},Symbol.toStringTag,{value:"Module"})),Do={...VZ,...zZ};function GZ(e,t){return xS(e,new Do.classes.URLSearchParams,{visitor:function(r,n,i,s){return Do.isNode&&fr.isBuffer(r)?(this.append(n,r.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...t})}function KZ(e){return fr.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function YZ(e){const t={},r=Object.keys(e);let n;const i=r.length;let s;for(n=0;n<i;n++)s=r[n],t[s]=e[s];return t}function $D(e){function t(r,n,i,s){let o=r[s++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=s>=r.length;return o=!o&&fr.isArray(i)?i.length:o,c?(fr.hasOwnProp(i,o)?i[o]=[i[o],n]:i[o]=n,!l):((!i[o]||!fr.isObject(i[o]))&&(i[o]=[]),t(r,n,i[o],s)&&fr.isArray(i[o])&&(i[o]=YZ(i[o])),!l)}if(fr.isFormData(e)&&fr.isFunction(e.entries)){const r={};return fr.forEachEntry(e,(n,i)=>{t(KZ(n),i,r,0)}),r}return null}function XZ(e,t,r){if(fr.isString(e))try{return(t||JSON.parse)(e),fr.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const Z1={transitional:DD,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",i=n.indexOf("application/json")>-1,s=fr.isObject(t);if(s&&fr.isHTMLForm(t)&&(t=new FormData(t)),fr.isFormData(t))return i?JSON.stringify($D(t)):t;if(fr.isArrayBuffer(t)||fr.isBuffer(t)||fr.isStream(t)||fr.isFile(t)||fr.isBlob(t)||fr.isReadableStream(t))return t;if(fr.isArrayBufferView(t))return t.buffer;if(fr.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return GZ(t,this.formSerializer).toString();if((l=fr.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return xS(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return s||i?(r.setContentType("application/json",!1),XZ(t)):t}],transformResponse:[function(t){const r=this.transitional||Z1.transitional,n=r&&r.forcedJSONParsing,i=this.responseType==="json";if(fr.isResponse(t)||fr.isReadableStream(t))return t;if(t&&fr.isString(t)&&(n&&!this.responseType||i)){const o=!(r&&r.silentJSONParsing)&&i;try{return JSON.parse(t,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?oi.from(l,oi.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Do.classes.FormData,Blob:Do.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};fr.forEach(["delete","get","head","post","put","patch"],e=>{Z1.headers[e]={}});const QZ=fr.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),JZ=e=>{const t={};let r,n,i;return e&&e.split(`
`).forEach(function(o){i=o.indexOf(":"),r=o.substring(0,i).trim().toLowerCase(),n=o.substring(i+1).trim(),!(!r||t[r]&&QZ[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},L8=Symbol("internals");function zg(e){return e&&String(e).trim().toLowerCase()}function Iv(e){return e===!1||e==null?e:fr.isArray(e)?e.map(Iv):String(e)}function ZZ(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const eee=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function z5(e,t,r,n,i){if(fr.isFunction(n))return n.call(this,t,r);if(i&&(t=r),!!fr.isString(t)){if(fr.isString(n))return t.indexOf(n)!==-1;if(fr.isRegExp(n))return n.test(t)}}function tee(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function ree(e,t){const r=fr.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(i,s,o){return this[n].call(this,t,i,s,o)},configurable:!0})})}let Tl=class{constructor(t){t&&this.set(t)}set(t,r,n){const i=this;function s(l,c,u){const d=zg(c);if(!d)throw new Error("header name must be a non-empty string");const f=fr.findKey(i,d);(!f||i[f]===void 0||u===!0||u===void 0&&i[f]!==!1)&&(i[f||c]=Iv(l))}const o=(l,c)=>fr.forEach(l,(u,d)=>s(u,d,c));if(fr.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(fr.isString(t)&&(t=t.trim())&&!eee(t))o(JZ(t),r);else if(fr.isObject(t)&&fr.isIterable(t)){let l={},c,u;for(const d of t){if(!fr.isArray(d))throw TypeError("Object iterator must return a key-value pair");l[u=d[0]]=(c=l[u])?fr.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}o(l,r)}else t!=null&&s(r,t,n);return this}get(t,r){if(t=zg(t),t){const n=fr.findKey(this,t);if(n){const i=this[n];if(!r)return i;if(r===!0)return ZZ(i);if(fr.isFunction(r))return r.call(this,i,n);if(fr.isRegExp(r))return r.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=zg(t),t){const n=fr.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||z5(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let i=!1;function s(o){if(o=zg(o),o){const l=fr.findKey(n,o);l&&(!r||z5(n,n[l],l,r))&&(delete n[l],i=!0)}}return fr.isArray(t)?t.forEach(s):s(t),i}clear(t){const r=Object.keys(this);let n=r.length,i=!1;for(;n--;){const s=r[n];(!t||z5(this,this[s],s,t,!0))&&(delete this[s],i=!0)}return i}normalize(t){const r=this,n={};return fr.forEach(this,(i,s)=>{const o=fr.findKey(n,s);if(o){r[o]=Iv(i),delete r[s];return}const l=t?tee(s):String(s).trim();l!==s&&delete r[s],r[l]=Iv(i),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return fr.forEach(this,(n,i)=>{n!=null&&n!==!1&&(r[i]=t&&fr.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(i=>n.set(i)),n}static accessor(t){const n=(this[L8]=this[L8]={accessors:{}}).accessors,i=this.prototype;function s(o){const l=zg(o);n[l]||(ree(i,o),n[l]=!0)}return fr.isArray(t)?t.forEach(s):s(t),this}};Tl.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);fr.reduceDescriptors(Tl.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});fr.freezeMethods(Tl);function W5(e,t){const r=this||Z1,n=t||r,i=Tl.from(n.headers);let s=n.data;return fr.forEach(e,function(l){s=l.call(r,s,i.normalize(),t?t.status:void 0)}),i.normalize(),s}function UD(e){return!!(e&&e.__CANCEL__)}function ig(e,t,r){oi.call(this,e??"canceled",oi.ERR_CANCELED,t,r),this.name="CanceledError"}fr.inherits(ig,oi,{__CANCEL__:!0});function zD(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new oi("Request failed with status code "+r.status,[oi.ERR_BAD_REQUEST,oi.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function nee(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function iee(e,t){e=e||10;const r=new Array(e),n=new Array(e);let i=0,s=0,o;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),d=n[s];o||(o=u),r[i]=c,n[i]=u;let f=s,h=0;for(;f!==i;)h+=r[f++],f=f%e;if(i=(i+1)%e,i===s&&(s=(s+1)%e),u-o<t)return;const p=d&&u-d;return p?Math.round(h*1e3/p):void 0}}function aee(e,t){let r=0,n=1e3/t,i,s;const o=(u,d=Date.now())=>{r=d,i=null,s&&(clearTimeout(s),s=null),e(...u)};return[(...u)=>{const d=Date.now(),f=d-r;f>=n?o(u,d):(i=u,s||(s=setTimeout(()=>{s=null,o(i)},n-f)))},()=>i&&o(i)]}const N2=(e,t,r=3)=>{let n=0;const i=iee(50,250);return aee(s=>{const o=s.loaded,l=s.lengthComputable?s.total:void 0,c=o-n,u=i(c),d=o<=l;n=o;const f={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&d?(l-o)/u:void 0,event:s,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(f)},r)},R8=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},F8=e=>(...t)=>fr.asap(()=>e(...t)),see=Do.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Do.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Do.origin),Do.navigator&&/(msie|trident)/i.test(Do.navigator.userAgent)):()=>!0,oee=Do.hasStandardBrowserEnv?{write(e,t,r,n,i,s,o){if(typeof document>"u")return;const l=[`${e}=${encodeURIComponent(t)}`];fr.isNumber(r)&&l.push(`expires=${new Date(r).toUTCString()}`),fr.isString(n)&&l.push(`path=${n}`),fr.isString(i)&&l.push(`domain=${i}`),s===!0&&l.push("secure"),fr.isString(o)&&l.push(`SameSite=${o}`),document.cookie=l.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function lee(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function cee(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function WD(e,t,r){let n=!lee(t);return e&&(n||r==!1)?cee(e,t):t}const B8=e=>e instanceof Tl?{...e}:e;function b0(e,t){t=t||{};const r={};function n(u,d,f,h){return fr.isPlainObject(u)&&fr.isPlainObject(d)?fr.merge.call({caseless:h},u,d):fr.isPlainObject(d)?fr.merge({},d):fr.isArray(d)?d.slice():d}function i(u,d,f,h){if(fr.isUndefined(d)){if(!fr.isUndefined(u))return n(void 0,u,f,h)}else return n(u,d,f,h)}function s(u,d){if(!fr.isUndefined(d))return n(void 0,d)}function o(u,d){if(fr.isUndefined(d)){if(!fr.isUndefined(u))return n(void 0,u)}else return n(void 0,d)}function l(u,d,f){if(f in t)return n(u,d);if(f in e)return n(void 0,u)}const c={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(u,d,f)=>i(B8(u),B8(d),f,!0)};return fr.forEach(Object.keys({...e,...t}),function(d){const f=c[d]||i,h=f(e[d],t[d],d);fr.isUndefined(h)&&f!==l||(r[d]=h)}),r}const qD=e=>{const t=b0({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:i,xsrfCookieName:s,headers:o,auth:l}=t;if(t.headers=o=Tl.from(o),t.url=ID(WD(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),fr.isFormData(r)){if(Do.hasStandardBrowserEnv||Do.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(fr.isFunction(r.getHeaders)){const c=r.getHeaders(),u=["content-type","content-length"];Object.entries(c).forEach(([d,f])=>{u.includes(d.toLowerCase())&&o.set(d,f)})}}if(Do.hasStandardBrowserEnv&&(n&&fr.isFunction(n)&&(n=n(t)),n||n!==!1&&see(t.url))){const c=i&&s&&oee.read(s);c&&o.set(i,c)}return t},uee=typeof XMLHttpRequest<"u",dee=uee&&function(e){return new Promise(function(r,n){const i=qD(e);let s=i.data;const o=Tl.from(i.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=i,d,f,h,p,m;function g(){p&&p(),m&&m(),i.cancelToken&&i.cancelToken.unsubscribe(d),i.signal&&i.signal.removeEventListener("abort",d)}let y=new XMLHttpRequest;y.open(i.method.toUpperCase(),i.url,!0),y.timeout=i.timeout;function b(){if(!y)return;const w=Tl.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),j={data:!l||l==="text"||l==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:w,config:e,request:y};zD(function(A){r(A),g()},function(A){n(A),g()},j),y=null}"onloadend"in y?y.onloadend=b:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(b)},y.onabort=function(){y&&(n(new oi("Request aborted",oi.ECONNABORTED,e,y)),y=null)},y.onerror=function(S){const j=S&&S.message?S.message:"Network Error",k=new oi(j,oi.ERR_NETWORK,e,y);k.event=S||null,n(k),y=null},y.ontimeout=function(){let S=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const j=i.transitional||DD;i.timeoutErrorMessage&&(S=i.timeoutErrorMessage),n(new oi(S,j.clarifyTimeoutError?oi.ETIMEDOUT:oi.ECONNABORTED,e,y)),y=null},s===void 0&&o.setContentType(null),"setRequestHeader"in y&&fr.forEach(o.toJSON(),function(S,j){y.setRequestHeader(j,S)}),fr.isUndefined(i.withCredentials)||(y.withCredentials=!!i.withCredentials),l&&l!=="json"&&(y.responseType=i.responseType),u&&([h,m]=N2(u,!0),y.addEventListener("progress",h)),c&&y.upload&&([f,p]=N2(c),y.upload.addEventListener("progress",f),y.upload.addEventListener("loadend",p)),(i.cancelToken||i.signal)&&(d=w=>{y&&(n(!w||w.type?new ig(null,e,y):w),y.abort(),y=null)},i.cancelToken&&i.cancelToken.subscribe(d),i.signal&&(i.signal.aborted?d():i.signal.addEventListener("abort",d)));const v=nee(i.url);if(v&&Do.protocols.indexOf(v)===-1){n(new oi("Unsupported protocol "+v+":",oi.ERR_BAD_REQUEST,e));return}y.send(s||null)})},fee=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,i;const s=function(u){if(!i){i=!0,l();const d=u instanceof Error?u:this.reason;n.abort(d instanceof oi?d:new ig(d instanceof Error?d.message:d))}};let o=t&&setTimeout(()=>{o=null,s(new oi(`timeout ${t} of ms exceeded`,oi.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(s):u.removeEventListener("abort",s)}),e=null)};e.forEach(u=>u.addEventListener("abort",s));const{signal:c}=n;return c.unsubscribe=()=>fr.asap(l),c}},hee=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,i;for(;n<r;)i=n+t,yield e.slice(n,i),n=i},pee=async function*(e,t){for await(const r of mee(e))yield*hee(r,t)},mee=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},I8=(e,t,r,n)=>{const i=pee(e,t);let s=0,o,l=c=>{o||(o=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await i.next();if(u){l(),c.close();return}let f=d.byteLength;if(r){let h=s+=f;r(h)}c.enqueue(new Uint8Array(d))}catch(u){throw l(u),u}},cancel(c){return l(c),i.return()}},{highWaterMark:2})},D8=64*1024,{isFunction:vb}=fr,gee=(({Request:e,Response:t})=>({Request:e,Response:t}))(fr.global),{ReadableStream:$8,TextEncoder:U8}=fr.global,z8=(e,...t)=>{try{return!!e(...t)}catch{return!1}},xee=e=>{e=fr.merge.call({skipUndefined:!0},gee,e);const{fetch:t,Request:r,Response:n}=e,i=t?vb(t):typeof fetch=="function",s=vb(r),o=vb(n);if(!i)return!1;const l=i&&vb($8),c=i&&(typeof U8=="function"?(m=>g=>m.encode(g))(new U8):async m=>new Uint8Array(await new r(m).arrayBuffer())),u=s&&l&&z8(()=>{let m=!1;const g=new r(Do.origin,{body:new $8,method:"POST",get duplex(){return m=!0,"half"}}).headers.has("Content-Type");return m&&!g}),d=o&&l&&z8(()=>fr.isReadableStream(new n("").body)),f={stream:d&&(m=>m.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach(m=>{!f[m]&&(f[m]=(g,y)=>{let b=g&&g[m];if(b)return b.call(g);throw new oi(`Response type '${m}' is not supported`,oi.ERR_NOT_SUPPORT,y)})});const h=async m=>{if(m==null)return 0;if(fr.isBlob(m))return m.size;if(fr.isSpecCompliantForm(m))return(await new r(Do.origin,{method:"POST",body:m}).arrayBuffer()).byteLength;if(fr.isArrayBufferView(m)||fr.isArrayBuffer(m))return m.byteLength;if(fr.isURLSearchParams(m)&&(m=m+""),fr.isString(m))return(await c(m)).byteLength},p=async(m,g)=>{const y=fr.toFiniteNumber(m.getContentLength());return y??h(g)};return async m=>{let{url:g,method:y,data:b,signal:v,cancelToken:w,timeout:S,onDownloadProgress:j,onUploadProgress:k,responseType:A,headers:R,withCredentials:M="same-origin",fetchOptions:B}=qD(m),E=t||fetch;A=A?(A+"").toLowerCase():"text";let P=fee([v,w&&w.toAbortSignal()],S),U=null;const G=P&&P.unsubscribe&&(()=>{P.unsubscribe()});let H;try{if(k&&u&&y!=="get"&&y!=="head"&&(H=await p(R,b))!==0){let ee=new r(g,{method:"POST",body:b,duplex:"half"}),C;if(fr.isFormData(b)&&(C=ee.headers.get("content-type"))&&R.setContentType(C),ee.body){const[Y,q]=R8(H,N2(F8(k)));b=I8(ee.body,D8,Y,q)}}fr.isString(M)||(M=M?"include":"omit");const oe=s&&"credentials"in r.prototype,de={...B,signal:P,method:y.toUpperCase(),headers:R.normalize().toJSON(),body:b,duplex:"half",credentials:oe?M:void 0};U=s&&new r(g,de);let W=await(s?E(U,B):E(g,de));const V=d&&(A==="stream"||A==="response");if(d&&(j||V&&G)){const ee={};["status","statusText","headers"].forEach(O=>{ee[O]=W[O]});const C=fr.toFiniteNumber(W.headers.get("content-length")),[Y,q]=j&&R8(C,N2(F8(j),!0))||[];W=new n(I8(W.body,D8,Y,()=>{q&&q(),G&&G()}),ee)}A=A||"text";let ae=await f[fr.findKey(f,A)||"text"](W,m);return!V&&G&&G(),await new Promise((ee,C)=>{zD(ee,C,{data:ae,headers:Tl.from(W.headers),status:W.status,statusText:W.statusText,config:m,request:U})})}catch(oe){throw G&&G(),oe&&oe.name==="TypeError"&&/Load failed|fetch/i.test(oe.message)?Object.assign(new oi("Network Error",oi.ERR_NETWORK,m,U),{cause:oe.cause||oe}):oi.from(oe,oe&&oe.code,m,U)}}},yee=new Map,HD=e=>{let t=e&&e.env||{};const{fetch:r,Request:n,Response:i}=t,s=[n,i,r];let o=s.length,l=o,c,u,d=yee;for(;l--;)c=s[l],u=d.get(c),u===void 0&&d.set(c,u=l?new Map:xee(t)),d=u;return u};HD();const g3={http:RZ,xhr:dee,fetch:{get:HD}};fr.forEach(g3,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const W8=e=>`- ${e}`,bee=e=>fr.isFunction(e)||e===null||e===!1;function vee(e,t){e=fr.isArray(e)?e:[e];const{length:r}=e;let n,i;const s={};for(let o=0;o<r;o++){n=e[o];let l;if(i=n,!bee(n)&&(i=g3[(l=String(n)).toLowerCase()],i===void 0))throw new oi(`Unknown adapter '${l}'`);if(i&&(fr.isFunction(i)||(i=i.get(t))))break;s[l||"#"+o]=i}if(!i){const o=Object.entries(s).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let l=r?o.length>1?`since :
`+o.map(W8).join(`
`):" "+W8(o[0]):"as no adapter specified";throw new oi("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return i}const VD={getAdapter:vee,adapters:g3};function q5(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ig(null,e)}function q8(e){return q5(e),e.headers=Tl.from(e.headers),e.data=W5.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),VD.getAdapter(e.adapter||Z1.adapter,e)(e).then(function(n){return q5(e),n.data=W5.call(e,e.transformResponse,n),n.headers=Tl.from(n.headers),n},function(n){return UD(n)||(q5(e),n&&n.response&&(n.response.data=W5.call(e,e.transformResponse,n.response),n.response.headers=Tl.from(n.response.headers))),Promise.reject(n)})}const GD="1.13.2",yS={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{yS[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const H8={};yS.transitional=function(t,r,n){function i(s,o){return"[Axios v"+GD+"] Transitional option '"+s+"'"+o+(n?". "+n:"")}return(s,o,l)=>{if(t===!1)throw new oi(i(o," has been removed"+(r?" in "+r:"")),oi.ERR_DEPRECATED);return r&&!H8[o]&&(H8[o]=!0,console.warn(i(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(s,o,l):!0}};yS.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function wee(e,t,r){if(typeof e!="object")throw new oi("options must be an object",oi.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let i=n.length;for(;i-- >0;){const s=n[i],o=t[s];if(o){const l=e[s],c=l===void 0||o(l,s,e);if(c!==!0)throw new oi("option "+s+" must be "+c,oi.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new oi("Unknown option "+s,oi.ERR_BAD_OPTION)}}const Dv={assertOptions:wee,validators:yS},Eu=Dv.validators;let i0=class{constructor(t){this.defaults=t||{},this.interceptors={request:new M8,response:new M8}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{n.stack?s&&!String(n.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+s):n.stack=s}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=b0(this.defaults,r);const{transitional:n,paramsSerializer:i,headers:s}=r;n!==void 0&&Dv.assertOptions(n,{silentJSONParsing:Eu.transitional(Eu.boolean),forcedJSONParsing:Eu.transitional(Eu.boolean),clarifyTimeoutError:Eu.transitional(Eu.boolean)},!1),i!=null&&(fr.isFunction(i)?r.paramsSerializer={serialize:i}:Dv.assertOptions(i,{encode:Eu.function,serialize:Eu.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Dv.assertOptions(r,{baseUrl:Eu.spelling("baseURL"),withXsrfToken:Eu.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=s&&fr.merge(s.common,s[r.method]);s&&fr.forEach(["delete","get","head","post","put","patch","common"],m=>{delete s[m]}),r.headers=Tl.concat(o,s);const l=[];let c=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(r)===!1||(c=c&&g.synchronous,l.unshift(g.fulfilled,g.rejected))});const u=[];this.interceptors.response.forEach(function(g){u.push(g.fulfilled,g.rejected)});let d,f=0,h;if(!c){const m=[q8.bind(this),void 0];for(m.unshift(...l),m.push(...u),h=m.length,d=Promise.resolve(r);f<h;)d=d.then(m[f++],m[f++]);return d}h=l.length;let p=r;for(;f<h;){const m=l[f++],g=l[f++];try{p=m(p)}catch(y){g.call(this,y);break}}try{d=q8.call(this,p)}catch(m){return Promise.reject(m)}for(f=0,h=u.length;f<h;)d=d.then(u[f++],u[f++]);return d}getUri(t){t=b0(this.defaults,t);const r=WD(t.baseURL,t.url,t.allowAbsoluteUrls);return ID(r,t.params,t.paramsSerializer)}};fr.forEach(["delete","get","head","options"],function(t){i0.prototype[t]=function(r,n){return this.request(b0(n||{},{method:t,url:r,data:(n||{}).data}))}});fr.forEach(["post","put","patch"],function(t){function r(n){return function(s,o,l){return this.request(b0(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}i0.prototype[t]=r(),i0.prototype[t+"Form"]=r(!0)});let See=class KD{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(s){r=s});const n=this;this.promise.then(i=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](i);n._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(l=>{n.subscribe(l),s=l}).then(i);return o.cancel=function(){n.unsubscribe(s)},o},t(function(s,o,l){n.reason||(n.reason=new ig(s,o,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new KD(function(i){t=i}),cancel:t}}};function _ee(e){return function(r){return e.apply(null,r)}}function jee(e){return fr.isObject(e)&&e.isAxiosError===!0}const N4={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(N4).forEach(([e,t])=>{N4[t]=e});function YD(e){const t=new i0(e),r=AD(i0.prototype.request,t);return fr.extend(r,i0.prototype,t,{allOwnKeys:!0}),fr.extend(r,t,null,{allOwnKeys:!0}),r.create=function(i){return YD(b0(e,i))},r}const Ra=YD(Z1);Ra.Axios=i0;Ra.CanceledError=ig;Ra.CancelToken=See;Ra.isCancel=UD;Ra.VERSION=GD;Ra.toFormData=xS;Ra.AxiosError=oi;Ra.Cancel=Ra.CanceledError;Ra.all=function(t){return Promise.all(t)};Ra.spread=_ee;Ra.isAxiosError=jee;Ra.mergeConfig=b0;Ra.AxiosHeaders=Tl;Ra.formToJSON=e=>$D(fr.isHTMLForm(e)?new FormData(e):e);Ra.getAdapter=VD.getAdapter;Ra.HttpStatusCode=N4;Ra.default=Ra;const{Axios:dMe,AxiosError:fMe,CanceledError:hMe,isCancel:pMe,CancelToken:mMe,VERSION:gMe,all:xMe,Cancel:yMe,isAxiosError:bMe,spread:vMe,toFormData:wMe,AxiosHeaders:C4,HttpStatusCode:SMe,formToJSON:_Me,getAdapter:jMe,mergeConfig:kMe}=Ra;function kee(){var e;if(typeof window<"u"&&((e=window.location)!=null&&e.origin)){const t=String(window.location.hostname||"").trim().toLowerCase();return t==="localhost"||t==="127.0.0.1"?"http://localhost:8000":String(window.location.origin).replace(/\/+$/,"")}return"https://db.krgi.co.in"}const XD=`${kee()}/api/accounts/`,Uo=Ra.create({baseURL:XD});let H5=!1,E4=[];function Aee(e){E4.push(e)}function Nee(e){E4.forEach(t=>t(e)),E4=[]}async function Cee(){const e=localStorage.getItem("refresh");if(!e)throw new Error("no refresh token");const t=await Ra.post(`${XD}token/refresh/`,{refresh:e}),{access:r,refresh:n}=t.data;return r&&localStorage.setItem("access",r),n&&localStorage.setItem("refresh",n),r}Uo.interceptors.response.use(e=>e,async e=>{const t=e.config;if(e.response&&e.response.status===401&&!t._retry){if(t._retry=!0,H5)return new Promise(r=>{Aee(n=>{const i=t.headers??{};i.Authorization=`Bearer ${n}`,t.headers=new C4(i),r(Uo(t))})});H5=!0;try{const r=await Cee();Nee(r);const n=t.headers??{};return n.Authorization=`Bearer ${r}`,t.headers=new C4(n),Uo(t)}catch(r){return x3(),Promise.reject(r)}finally{H5=!1}}return Promise.reject(e)});async function QD(e,t){const r=await Uo.post("token/",{identifier:e,password:t}),{access:n,refresh:i}=r.data;localStorage.setItem("access",n),localStorage.setItem("refresh",i);try{await ah()}catch{}return r.data}function x3(){localStorage.removeItem("access"),localStorage.removeItem("refresh"),localStorage.removeItem("roles"),localStorage.removeItem("permissions"),localStorage.removeItem("me")}Uo.interceptors.request.use(e=>{const t=localStorage.getItem("access");if(t){const r=e.headers??{};r.Authorization=`Bearer ${t}`,e.headers=new C4(r)}return e});async function ah(){if(!localStorage.getItem("access"))throw new Error("no access token");const r=(await Uo.get("me/")).data;try{localStorage.setItem("roles",JSON.stringify(r.roles||[])),localStorage.setItem("permissions",JSON.stringify(r.permissions||[])),localStorage.setItem("me",JSON.stringify(r||null))}catch{}return r}function JD(){try{const e=localStorage.getItem("me");return e?JSON.parse(e):null}catch{return null}}function ZD(){var t;const e=JD();return!!((t=e==null?void 0:e.profile)!=null&&t.mobile_verified)}async function as(){var e;if(ZD())return!0;try{const t=await ah();return!!((e=t==null?void 0:t.profile)!=null&&e.mobile_verified)}catch{return!1}}async function e9(e){return(await Uo.post("mobile/request-otp/",{mobile_number:e})).data}async function t9(e,t){return(await Uo.post("mobile/verify-otp/",{mobile_number:e,otp:t})).data}async function r9(e){return(await Uo.post("mobile/remove/",{password:e})).data}const Eee=Object.freeze(Object.defineProperty({__proto__:null,apiClient:Uo,ensureMobileVerified:as,getCachedMe:JD,getMe:ah,isMobileVerifiedCached:ZD,login:QD,logout:x3,removeMobileNumber:r9,requestMobileOtp:e9,verifyMobileOtp:t9},Symbol.toStringTag,{value:"Module"})),n9="/assets/idcs-logo-Ci6ccowJ.png";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i9=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tee=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pee=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase());/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V8=e=>{const t=Pee(e);return t.charAt(0).toUpperCase()+t.slice(1)};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Oee={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mee=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lee=x.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:o,...l},c)=>x.createElement("svg",{ref:c,...Oee,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:i9("lucide",i),...!s&&!Mee(l)&&{"aria-hidden":"true"},...l},[...o.map(([u,d])=>x.createElement(u,d)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vn=(e,t)=>{const r=x.forwardRef(({className:n,...i},s)=>x.createElement(Lee,{ref:s,iconNode:t,className:i9(`lucide-${Tee(V8(e))}`,`lucide-${e}`,n),...i}));return r.displayName=V8(e),r};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ree=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Cx=Vn("bell",Ree);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fee=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],gs=Vn("book-open",Fee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bee=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],Iee=Vn("briefcase",Bee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dee=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],$ee=Vn("building",Dee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uee=[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]],T4=Vn("calendar-clock",Uee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zee=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],xs=Vn("calendar",zee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wee=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],qee=Vn("check",Wee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hee=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Vee=Vn("chevron-down",Hee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gee=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ed=Vn("circle-alert",Gee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kee=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],y3=Vn("circle-check-big",Kee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yee=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Ld=Vn("circle-check",Yee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xee=[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Qee=Vn("circle-user-round",Xee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jee=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],b3=Vn("circle-x",Jee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zee=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],C2=Vn("clipboard-list",Zee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ete=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],sc=Vn("clock",ete);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tte=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],P4=Vn("download",tte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rte=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],nte=Vn("eye-off",rte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ite=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],a9=Vn("eye",ite);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ate=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],ste=Vn("file-spreadsheet",ate);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ote=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],lte=Vn("file-text",ote);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cte=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],ute=Vn("funnel",cte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dte=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],Lm=Vn("graduation-cap",dte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fte=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],O4=Vn("grid-3x3",fte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hte=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],E2=Vn("house",hte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pte=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Gu=Vn("loader-circle",pte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mte=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],gte=Vn("lock-open",mte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xte=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],a0=Vn("lock",xte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yte=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],bte=Vn("log-in",yte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vte=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],wte=Vn("log-out",vte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ste=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],v3=Vn("mail",Ste);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _te=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],jte=Vn("menu",_te);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kte=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],G8=Vn("panels-top-left",kte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ate=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Nte=Vn("phone",Ate);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cte=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Rm=Vn("plus",Cte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ete=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],T2=Vn("refresh-cw",Ete);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tte=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],rd=Vn("save",Tte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pte=[["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M18 5v16",key:"1ethyx"}],["path",{d:"m4 6 7.106-3.79a2 2 0 0 1 1.788 0L20 6",key:"zywc2d"}],["path",{d:"m6 11-3.52 2.147a1 1 0 0 0-.48.854V19a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a1 1 0 0 0-.48-.853L18 11",key:"1d4ql0"}],["path",{d:"M6 5v16",key:"1sn0nx"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]],Ote=Vn("school",Pte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mte=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Lte=Vn("send",Mte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rte=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Fte=Vn("shield",Rte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bte=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],dh=Vn("square-pen",Bte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ite=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Fm=Vn("trash-2",Ite);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dte=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],$te=Vn("trending-up",Dte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ute=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],P2=Vn("upload",Ute);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zte=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],$v=Vn("user-check",zte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wte=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],qte=Vn("user-plus",Wte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hte=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],Vte=Vn("user-x",Hte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gte=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],W0=Vn("user",Gte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kte=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ys=Vn("users",Kte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yte=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],bu=Vn("x",Yte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xte=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Qte=Vn("zoom-in",Xte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jte=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Zte=Vn("zoom-out",Jte),s9=x.createContext(void 0);function ere({children:e}){const[t,r]=x.useState(()=>typeof window<"u"?window.innerWidth<1024:!0),n=()=>r(i=>!i);return a.jsx(s9.Provider,{value:{collapsed:t,toggle:n,setCollapsed:r},children:e})}function w3(){const e=x.useContext(s9);if(!e)throw new Error("useSidebar must be used within SidebarProvider");return e}function o9({user:e}){const t=vo(),n=hl().pathname==="/login",{collapsed:i,toggle:s}=w3(),o=()=>{x3(),t("/login")};return a.jsx("nav",{className:"bg-white shadow-md border-b border-gray-200 fixed top-0 left-0 right-0 z-40 overflow-x-hidden",children:a.jsx("div",{className:"px-4 max-w-full",children:a.jsxs("div",{className:"flex items-center justify-between h-16",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("button",{className:"p-2 rounded-lg text-gray-600 hover:bg-gray-100 hover:text-gray-900 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:s,"aria-label":"Toggle sidebar",children:i?a.jsx(jte,{className:"h-6 w-6"}):a.jsx(bu,{className:"h-6 w-6"})}),a.jsx(es,{to:"/dashboard",className:"flex items-center gap-3 group",children:a.jsx("img",{src:n9,alt:"IDCS Logo",className:"h-12 w-12 object-contain transition-transform duration-200 group-hover:scale-110",onError:l=>{l.currentTarget.style.display="none"}})})]}),a.jsx("div",{className:"flex items-center gap-3",children:e?a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"hidden sm:block",children:a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-blue-50 rounded-lg",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-white font-semibold text-sm",children:e.username.charAt(0).toUpperCase()})}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:e.username})]})}),a.jsxs("button",{onClick:o,className:"flex items-center gap-2 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg font-medium transition-colors",children:[a.jsx(wte,{className:"h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]}):n?a.jsxs(es,{to:"/",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md transform hover:scale-105",children:[a.jsx(E2,{className:"h-4 w-4"}),a.jsx("span",{children:"Home"})]}):a.jsxs(es,{to:"/login",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md transform hover:scale-105",children:[a.jsx(bte,{className:"h-4 w-4"}),a.jsx("span",{children:"Login"})]})})]})})})}function l9(){var e;if(typeof window<"u"&&((e=window.location)!=null&&e.origin)){const t=String(window.location.hostname||"").trim().toLowerCase();return t==="localhost"||t==="127.0.0.1"?"http://localhost:8000":String(window.location.origin).replace(/\/+$/,"")}return"https://db.krgi.co.in"}const tre=l9();let V5=!1,Wg=null;async function rre(){return V5&&Wg||(V5=!0,Wg=(async()=>{try{const e=window.localStorage.getItem("refresh");if(!e)throw new Error("no refresh token");const t=await fetch(`${tre}/api/accounts/token/refresh/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:e})});if(!t.ok)throw window.localStorage.removeItem("access"),window.localStorage.removeItem("refresh"),new Error("refresh failed");const r=await t.json();return r.access&&window.localStorage.setItem("access",r.access),r.refresh&&window.localStorage.setItem("refresh",r.refresh),r.access}finally{V5=!1,Wg=null}})()),Wg}async function mr(e,t={},r=!0){const n=window.localStorage.getItem("access"),i=t.body instanceof FormData,s=Object.assign({},t.headers||{});i||(s["Content-Type"]="application/json"),n?s.Authorization=`Bearer ${n}`:console.warn("No access token found in localStorage");let o=e;try{typeof e=="string"&&e.startsWith("/api")&&(o=`${l9()}${e}`)}catch{}const l=await fetch(o,{...t,headers:s});if(l.status===400){const c=await l.text();console.error("400 Bad Request:",{url:o,token:n,response:c})}if(l.status===401||l.status===403){let c="";try{c=await l.text()}catch{}const u={};try{l.headers.forEach((d,f)=>{u[f]=d})}catch{}console.error("Auth error from fetchWithAuth",{url:String(o),status:l.status,requestHeaders:s,responseHeaders:u,token:n,responseText:c})}if(l.status!==401||!r)return l;try{const c=await rre(),u=Object.assign({},t.headers||{});return i||(u["Content-Type"]="application/json"),u.Authorization=`Bearer ${c}`,fetch(o,{...t,headers:u})}catch(c){try{window.localStorage.removeItem("access"),window.localStorage.removeItem("refresh")}catch{}console.error("Token refresh failed:",c);try{typeof window<"u"&&setTimeout(()=>{try{window.location.href="/login"}catch{}},50)}catch{}return l}}async function nre(e=""){const t=e?`${e}/api/accounts/dashboard/`:"/api/accounts/dashboard/",r=await mr(t,{method:"GET"});if(!r.ok){const n=await r.text();throw new Error(`Dashboard fetch failed: ${r.status} ${n}`)}return r.json()}function ire(e=""){const[t,r]=x.useState(null),[n,i]=x.useState(!0),[s,o]=x.useState(null),l=x.useCallback(async()=>{i(!0),o(null);try{const c=await nre(e);r(c)}catch(c){o(c)}finally{i(!1)}},[e]);return x.useEffect(()=>{l()},[l]),{data:t,loading:n,error:s,refresh:l}}const are="modulepreload",sre=function(e){return"/"+e},K8={},fm=function(t,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(r.map(c=>{if(c=sre(c),c in K8)return;K8[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":are,u||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),u)return new Promise((h,p)=>{f.addEventListener("load",h),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return t().catch(s)})};async function hc(){var t;const e=`${wn()}/api/academics/my-teaching-assignments/`;try{return(await Uo.get(e)).data}catch(r){if(((t=r==null?void 0:r.response)==null?void 0:t.status)===401)return[];throw r}}function wn(){var e;if(typeof window<"u"&&((e=window.location)!=null&&e.origin)){const t=String(window.location.hostname||"").trim().toLowerCase();return t==="localhost"||t==="127.0.0.1"?"http://localhost:8000":String(window.location.origin).replace(/\/+$/,"")}return"https://db.krgi.co.in"}function ai(){const e=window.localStorage.getItem("access");return e?{Authorization:`Bearer ${e}`}:{}}async function S3(e,t,r){const n=`${wn()}/api/obe/iqac/reset/${encodeURIComponent(String(e))}/${encodeURIComponent(String(t))}`;return(await Uo.post(n,{teaching_assignment_id:r})).data}async function c9(e){var i;const t=`${wn()}/api/obe/iqac/reset-notifications`,r=e?{teaching_assignment_id:e}:{};return((i=(await Uo.get(t,{params:r})).data)==null?void 0:i.notifications)||[]}async function u9(e){const t=`${wn()}/api/obe/iqac/reset-notifications/dismiss`;return(await Uo.post(t,{notification_ids:e})).data}async function ore(){try{const e=wn(),t=localStorage.getItem("refresh");if(!t)return null;const r=await Ra.post(`${e}/api/accounts/token/refresh/`,{refresh:t}),{access:n,refresh:i}=r.data||{};return n&&localStorage.setItem("access",n),i&&localStorage.setItem("refresh",i),n||null}catch{try{(await fm(()=>Promise.resolve().then(()=>Eee),void 0)).logout()}catch{}return null}}async function la(e,t){const r={"Content-Type":"application/json",...(t==null?void 0:t.headers)||{},...ai()},n={...t||{},headers:r};let i=await fetch(e,n);if(i.status!==401)return i;const s=await ore();if(!s)return i;const o={...n.headers,Authorization:`Bearer ${s}`},l={...n,headers:o};return i=await fetch(e,l),i}async function bS(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${wn()}/api/obe/mark-table-lock/${encodeURIComponent(e)}/${encodeURIComponent(t)}${n}`,s=await la(i,{method:"GET"});return s.status===401?{assessment:e,subject_code:String(t),teaching_assignment_id:typeof r=="number"?r:null,academic_year:null,section_name:null,exists:!1,is_published:!1,published_blocked:!1,mark_entry_blocked:!1,mark_manager_locked:!1,mark_entry_unblocked_until:null,mark_manager_unlocked_until:null,entry_open:!1,mark_manager_editable:!0,updated_at:null}:(s.ok||await Nn(s,"Mark table lock fetch failed"),s.json())}async function lre(e){const t=await hm(e);return Array.isArray(t==null?void 0:t.enabled_assessments)?t.enabled_assessments.map(r=>String(r).trim().toLowerCase()).filter(Boolean):[]}async function hm(e){const t=`${wn()}/api/academics/teaching-assignments/${encodeURIComponent(String(e))}/enabled_assessments/`,r=await la(t,{method:"GET"});if(r.status===401||r.status===404)return{enabled_assessments:[],meta:{locked:!1,can_edit:!1}};r.ok||await Nn(r,"Failed to fetch enabled assessments");const n=await r.json();return{enabled_assessments:Array.isArray(n==null?void 0:n.enabled_assessments)?n.enabled_assessments.map(i=>String(i).trim().toLowerCase()).filter(Boolean):[],meta:(n==null?void 0:n.meta)||void 0}}async function cre(e,t){const r=`${wn()}/api/academics/teaching-assignments/${encodeURIComponent(String(e))}/enabled_assessments/`,n=await la(r,{method:"POST",body:JSON.stringify({enabled_assessments:t})});if(n.status===401)throw new Error("Authentication required");n.ok||await Nn(n,"Failed to save enabled assessments");const i=await n.json();return Array.isArray(i==null?void 0:i.enabled_assessments)?i.enabled_assessments:[]}async function d9(e,t){const r=`${wn()}/api/academics/teaching-assignments/${encodeURIComponent(String(e))}/enabled_assessments/`,n=await la(r,{method:"POST",body:JSON.stringify({enabled_assessments:t})});if(n.status===401)throw new Error("Authentication required");n.ok||await Nn(n,"Failed to save enabled assessments");const i=await n.json();return{enabled_assessments:Array.isArray(i==null?void 0:i.enabled_assessments)?i.enabled_assessments:[],meta:(i==null?void 0:i.meta)||void 0}}async function f9(e){const t=`${wn()}/api/academics/teaching-assignments/${encodeURIComponent(String(e))}/enabled_assessments/request-edit/`,r=await la(t,{method:"POST",body:JSON.stringify({})});if(r.status===401)throw new Error("Authentication required");return r.ok||await Nn(r,"Failed to request edit approval"),r.json()}async function vS(e,t){const r=t?`?academic_year_id=${encodeURIComponent(String(t))}`:"",n=`${wn()}/api/academics/special-courses/${encodeURIComponent(String(e))}/enabled_assessments/${r}`,i=await la(n,{method:"GET"});if(i.status===401)throw new Error("Authentication required");i.ok||await Nn(i,"Failed to fetch enabled assessments");const s=await i.json();return(Array.isArray(s==null?void 0:s.enabled_assessments)?s.enabled_assessments:[]).map(l=>String(l).trim().toLowerCase()).filter(Boolean)}async function fh(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${wn()}/api/obe/mark-table-lock/${encodeURIComponent(e)}/${encodeURIComponent(t)}/confirm-mark-manager${n}`,s=await la(i,{method:"POST",body:JSON.stringify({})});if(s.status===401)throw new Error("Authentication required");return s.ok||await Nn(s,"Mark Manager confirm failed"),s.json()}async function _3(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${wn()}/api/obe/publish-window/${encodeURIComponent(e)}/${encodeURIComponent(t)}${n}`,s=await fetch(i,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return s.status===401?{assessment:e,subject_code:String(t),publish_allowed:!1,allowed_by_due:!1,allowed_by_approval:!1,global_override_active:!1,global_is_open:null,allowed_by_global:null,due_at:null,now:null,remaining_seconds:null,approval_until:null,academic_year:null,teaching_assignment_id:typeof r=="number"?r:null}:(s.ok||await Nn(s,"Publish window fetch failed"),s.json())}async function l1(e,t,r,n){const i=[`scope=${encodeURIComponent(String(r))}`];n&&i.push(`teaching_assignment_id=${encodeURIComponent(String(n))}`);const s=i.length?`?${i.join("&")}`:"",o=`${wn()}/api/obe/edit-window/${encodeURIComponent(e)}/${encodeURIComponent(t)}${s}`,l=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return l.status===401?{assessment:e,subject_code:String(t),scope:r,allowed_by_approval:!1,approval_until:null,now:null,academic_year:null,teaching_assignment_id:typeof n=="number"?n:null}:(l.ok||await Nn(l,"Edit window fetch failed"),l.json())}async function fx(e,t){const r=[];e!=null&&e.length&&r.push(`semester_ids=${encodeURIComponent(e.join(","))}`),t!=null&&t.length&&r.push(`assessments=${encodeURIComponent(t.join(","))}`);const n=r.length?`?${r.join("&")}`:"",i=`${wn()}/api/obe/global-publish-controls${n}`,s=await fetch(i,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return s.ok||await Nn(s,"Global publish controls fetch failed"),s.json()}async function M4(e){const t=`${wn()}/api/obe/global-publish-controls/bulk-set`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify(e)});return r.ok||await Nn(r,"Bulk set global publish controls failed"),r.json()}async function h9(e){const t=`${wn()}/api/obe/global-publish-controls/bulk-reset`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify(e)});return r.ok||await Nn(r,"Bulk reset global publish controls failed"),r.json()}async function p9(){const e=`${wn()}/api/obe/semesters`,t=await fetch(e,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return t.ok||await Nn(t,"Semesters fetch failed"),t.json()}async function Uv(e){const t=e!=null&&e.length?`?semester_ids=${encodeURIComponent(e.join(","))}`:"",r=`${wn()}/api/obe/assessment-controls${t}`,n=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});if(!n.ok){if(n.status===404)throw new Error(`Assessment controls endpoint not found (404).

URL requested:
${r}

This usually means your frontend is calling an older backend that does not include /api/obe/assessment-controls.
- Deploy/restart the updated backend OR
- Set VITE_API_BASE to the backend instance that has the new endpoints.`);await Nn(n,"Assessment controls fetch failed")}return n.json()}async function L4(e){const t=`${wn()}/api/obe/assessment-controls/bulk-set`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify(e)});if(!r.ok){if(r.status===404)throw new Error(`Assessment controls bulk-set endpoint not found (404).

URL requested:
${t}

Your backend is missing /api/obe/assessment-controls/bulk-set. Deploy/restart the updated backend or point VITE_API_BASE to the correct server.`);await Nn(r,"Bulk set assessment controls failed")}return r.json()}async function R4(e){const t=e!=null&&e.length?`?semester_ids=${encodeURIComponent(e.join(","))}`:"",r=`${wn()}/api/obe/due-schedules${t}`,n=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return n.ok||await Nn(n,"Due schedules fetch failed"),n.json()}async function m9(e){const t=`?semester_ids=${encodeURIComponent(e.join(","))}`,r=`${wn()}/api/obe/due-schedule-subjects${t}`,n=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return n.ok||await Nn(n,"Due schedule subjects fetch failed"),n.json()}async function ure(e){const t=`${wn()}/api/obe/due-schedule-upsert`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify(e)});return r.ok||await Nn(r,"Due schedule save failed"),r.json()}async function g9(e){const t=`${wn()}/api/obe/due-schedule-bulk-upsert`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify(e)});return r.ok||await Nn(r,"Due schedule bulk save failed"),r.json()}async function x9(e){const t=`${wn()}/api/obe/due-schedule-bulk-delete`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify(e)});return r.ok||await Nn(r,"Due schedule bulk delete failed"),r.json()}function y9(e){if(Array.isArray(e))return{marks:e.map(r=>Number(r)).filter(r=>Number.isFinite(r))};if(e&&typeof e=="object"){const r=(Array.isArray(e.marks)?e.marks:[]).map(o=>Number(o)).filter(o=>Number.isFinite(o)),n=Array.isArray(e.cos)?e.cos:void 0,i=n?n.map(o=>{if(typeof o=="string")return o;const l=Number(o);return Number.isFinite(l)?l:""}):void 0,s={marks:r};return i&&(s.cos=i.filter(o=>o!=="")),s}return{marks:[]}}async function sh(e){const t=[];t.push(`class_type=${encodeURIComponent(String(e.class_type||"").trim())}`),e.question_paper_type&&t.push(`question_paper_type=${encodeURIComponent(String(e.question_paper_type||"").trim())}`),t.push(`exam=${encodeURIComponent(String(e.exam||"").trim())}`);const r=t.length?`?${t.join("&")}`:"",n=`${wn()}/api/obe/iqac/qp-pattern${r}`,i=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});i.ok||await Nn(i,"QP pattern fetch failed");const s=await i.json(),o=y9(s==null?void 0:s.pattern);return{class_type:String((s==null?void 0:s.class_type)||""),question_paper_type:(s==null?void 0:s.question_paper_type)==null?null:String(s.question_paper_type),exam:(()=>{const l=String((s==null?void 0:s.exam)||"CIA").trim().toUpperCase();return l==="MODEL"?"MODEL":l==="CIA1"?"CIA1":l==="CIA2"?"CIA2":"CIA"})(),pattern:o,updated_at:(s==null?void 0:s.updated_at)??null,updated_by:typeof(s==null?void 0:s.updated_by)=="number"?s.updated_by:null}}async function b9(e){var o,l;const t=`${wn()}/api/obe/iqac/qp-pattern/save`,r={class_type:String(e.class_type||"").trim(),question_paper_type:e.question_paper_type?String(e.question_paper_type||"").trim():null,exam:e.exam,pattern:{marks:Array.isArray((o=e.pattern)==null?void 0:o.marks)?e.pattern.marks:[],cos:Array.isArray((l=e.pattern)==null?void 0:l.cos)?e.pattern.cos:void 0}},n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify(r)});n.ok||await Nn(n,"QP pattern save failed");const i=await n.json(),s=y9(i==null?void 0:i.pattern);return{class_type:String((i==null?void 0:i.class_type)||""),question_paper_type:(i==null?void 0:i.question_paper_type)==null?null:String(i.question_paper_type),exam:(()=>{const c=String((i==null?void 0:i.exam)||"CIA").trim().toUpperCase();return c==="MODEL"?"MODEL":c==="CIA1"?"CIA1":c==="CIA2"?"CIA2":"CIA"})(),pattern:s,updated_at:(i==null?void 0:i.updated_at)??null,updated_by:typeof(i==null?void 0:i.updated_by)=="number"?i.updated_by:null}}async function wS(){const e=`${wn()}/api/obe/iqac/cqi-config`,t=await fetch(e,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});t.ok||await Nn(t,"CQI config fetch failed");const r=await t.json();return{options:Array.isArray(r==null?void 0:r.options)?r.options:[],divider:Number.isFinite(Number(r==null?void 0:r.divider))?Number(r==null?void 0:r.divider):2,multiplier:Number.isFinite(Number(r==null?void 0:r.multiplier))?Number(r==null?void 0:r.multiplier):.15,updated_at:(r==null?void 0:r.updated_at)??null,updated_by:typeof(r==null?void 0:r.updated_by)=="number"?r.updated_by:null}}async function v9(e){const t=`${wn()}/api/obe/iqac/cqi-config/save`,r={options:Array.isArray(e.options)?e.options:[],divider:Number.isFinite(Number(e.divider))?Number(e.divider):2,multiplier:Number.isFinite(Number(e.multiplier))?Number(e.multiplier):.15},n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify(r)});return n.ok||await Nn(n,"CQI config save failed"),n.json()}async function dre(e){const t=`${wn()}/api/obe/due-schedule-delete`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify(e)});return r.ok||await Nn(r,"Due schedule delete failed"),r.json()}async function jh(e){const t=`${wn()}/api/obe/publish-request`,r=await la(t,{method:"POST",body:JSON.stringify(e)});if(r.status===401)throw new Error("Authentication required");return r.ok||await Nn(r,"Publish request failed"),r.json()}async function sl(e){const t=`${wn()}/api/obe/edit-request`,r=await la(t,{method:"POST",body:JSON.stringify(e)});if(r.status===401)throw new Error("Authentication required");return r.ok||await Nn(r,"Edit request failed"),r.json()}function ol(e){var o,l,c,u,d;const t=e||{},r=`Edit request ID: ${typeof t.id=="number"?t.id:""}`;if((String(t.routed_to||"IQAC").trim().toUpperCase()==="HOD"?"HOD":"IQAC")==="HOD"){const f=String(((o=t.department)==null?void 0:o.short_name)||((l=t.department)==null?void 0:l.name)||((c=t.department)==null?void 0:c.code)||"").trim(),h=String(((u=t.hod)==null?void 0:u.name)||((d=t.hod)==null?void 0:d.username)||"").trim(),p=f&&h?`Sent to: ${f} HOD, ${h}`:"Sent to: HOD";return`${r}
${p}`}const s=String(t.routing_warning||"").trim();return s?`${r}
Sent to: IQAC
Note: ${s}`:`${r}
Sent to: IQAC`}function ll(e,t="Request failed"){var i,s;const r=String((e==null?void 0:e.message)||"").trim();if(r)return r;const n=String(((s=(i=e==null?void 0:e.response)==null?void 0:i.data)==null?void 0:s.detail)||"").trim();return n||t}async function Bm(e){const t=[];t.push(`assessment=${encodeURIComponent(String(e.assessment))}`),t.push(`subject_code=${encodeURIComponent(String(e.subject_code))}`),t.push(`scope=${encodeURIComponent(String(e.scope))}`),typeof e.teaching_assignment_id=="number"&&t.push(`teaching_assignment_id=${encodeURIComponent(String(e.teaching_assignment_id))}`);const r=t.length?`?${t.join("&")}`:"",n=`${wn()}/api/obe/edit-requests/my-latest${r}`,i=await la(n,{method:"GET"});return i.status===401?{result:null}:(i.ok||await Nn(i,"My edit request status fetch failed"),i.json())}async function w9(e){const t=e?`?scope=${encodeURIComponent(e)}`:"",r=`${wn()}/api/obe/edit-requests/pending${t}`,n=await la(r,{method:"GET"});return n.status===401?{results:[]}:(n.ok||await Nn(n,"Pending edit requests fetch failed"),n.json())}async function S9(e){const t=e?`?scope=${encodeURIComponent(e)}`:"",r=`${wn()}/api/obe/edit-requests/hod/pending${t}`,n=await la(r,{method:"GET"});return n.status===401?{results:[]}:(n.ok||await Nn(n,"HOD pending edit requests fetch failed"),n.json())}async function _9(e){var l;const t=(l=e==null?void 0:e.statuses)!=null&&l.length?e.statuses.join(","):"",r=typeof(e==null?void 0:e.limit)=="number"?e.limit:200,n=[];t&&n.push(`statuses=${encodeURIComponent(t)}`),Number.isFinite(r)&&n.push(`limit=${encodeURIComponent(String(r))}`),e!=null&&e.scope&&n.push(`scope=${encodeURIComponent(e.scope)}`);const i=n.length?`?${n.join("&")}`:"",s=`${wn()}/api/obe/edit-requests/history${i}`,o=await la(s,{method:"GET"});return o.status===401?{results:[]}:(o.ok||await Nn(o,"Edit requests history fetch failed"),o.json())}async function SS(){const e=`${wn()}/api/obe/iqac/class-type-weights`,t=await la(e,{method:"GET"});if(t.status===401)throw new Error("Authentication required to fetch class-type weights");t.ok||await Nn(t,"Fetch class-type weights failed");const r=await t.json();return(r==null?void 0:r.results)||{}}async function j9(e){const t=`${wn()}/api/obe/iqac/internal-mark-mapping/${encodeURIComponent(e)}`,r=await la(t,{method:"GET"});if(r.status===401)throw new Error("Authentication required");return r.ok||await Nn(r,"Failed to fetch internal mark mapping"),r.json()}async function k9(e,t){const r=`${wn()}/api/obe/iqac/internal-mark-mapping/${encodeURIComponent(e)}/save`,n=await la(r,{method:"POST",body:JSON.stringify({mapping:t})});if(n.status===401)throw new Error("Authentication required");return n.ok||await Nn(n,"Failed to save internal mark mapping"),n.json()}async function fre(e){const t=`${wn()}/api/obe/iqac/class-type-weights/save`,r=await la(t,{method:"POST",body:JSON.stringify(e)});if(r.status===401)throw new Error("Authentication required");r.ok||await Nn(r,"Save class-type weights failed");const n=await r.json();return(n==null?void 0:n.results)||{}}async function hre(e){const t=e?`?scope=${encodeURIComponent(e)}`:"",r=`${wn()}/api/obe/edit-requests/pending-count${t}`,n=await la(r,{method:"GET"});return n.status===401?{pending:0}:(n.ok||await Nn(n,"Pending edit requests count fetch failed"),n.json())}async function pre(e){const t=e?`?scope=${encodeURIComponent(e)}`:"",r=`${wn()}/api/obe/edit-requests/hod/pending-count${t}`,n=await la(r,{method:"GET"});return n.status===401?{pending:0}:(n.ok||await Nn(n,"HOD pending edit requests count fetch failed"),n.json())}async function A9(e,t=120){const r=`${wn()}/api/obe/edit-requests/${encodeURIComponent(String(e))}/approve`,n=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify({window_minutes:t})});return n.ok||await Nn(n,"Approve edit request failed"),n.json()}async function N9(e){const t=`${wn()}/api/obe/edit-requests/${encodeURIComponent(String(e))}/reject`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ai()}});return r.ok||await Nn(r,"Reject edit request failed"),r.json()}async function C9(e){const t=`${wn()}/api/obe/edit-requests/${encodeURIComponent(String(e))}/hod-approve`,r=await la(t,{method:"POST"});return r.ok||await Nn(r,"HOD approve/forward failed"),r.json()}async function E9(e){const t=`${wn()}/api/obe/edit-requests/${encodeURIComponent(String(e))}/hod-reject`,r=await la(t,{method:"POST"});return r.ok||await Nn(r,"HOD reject failed"),r.json()}async function mre(){const e=`${wn()}/api/obe/publish-requests/pending`,t=await la(e,{method:"GET"});return t.status===401?{results:[]}:(t.ok||await Nn(t,"Pending requests fetch failed"),t.json())}async function gre(e){var l;const t=(l=e==null?void 0:e.statuses)!=null&&l.length?e.statuses.join(","):"",r=typeof(e==null?void 0:e.limit)=="number"?e.limit:200,n=[];t&&n.push(`statuses=${encodeURIComponent(t)}`),Number.isFinite(r)&&n.push(`limit=${encodeURIComponent(String(r))}`);const i=n.length?`?${n.join("&")}`:"",s=`${wn()}/api/obe/publish-requests/history${i}`,o=await la(s,{method:"GET"});return o.status===401?{results:[]}:(o.ok||await Nn(o,"History requests fetch failed"),o.json())}async function F4(){const e=`${wn()}/api/obe/publish-requests/pending-count`,t=await la(e,{method:"GET"});return t.status===401?{pending:0}:(t.ok||await Nn(t,"Pending requests count fetch failed"),t.json())}async function xre(e,t=120){const r=`${wn()}/api/obe/publish-requests/${encodeURIComponent(String(e))}/approve`,n=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify({window_minutes:t})});return n.ok||await Nn(n,"Approve request failed"),n.json()}async function yre(e){const t=`${wn()}/api/obe/publish-requests/${encodeURIComponent(String(e))}/reject`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ai()}});return r.ok||await Nn(r,"Reject request failed"),r.json()}async function Nn(e,t){const r=await e.text();try{const n=String(r??"").replace(/^\uFEFF/,"").trim(),i=JSON.parse(n),s=(i==null?void 0:i.detail)||t,o=Array.isArray(i==null?void 0:i.how_to_fix)?`
How to fix:
- ${i.how_to_fix.join(`
- `)}`:"",l=Array.isArray(i==null?void 0:i.errors)?`
Errors:
- ${i.errors.join(`
- `)}`:"",c=new Error(`${s}${o}${l}`);throw c.status=e.status,c.body=i,c}catch{const n=new Error(`${t}: ${e.status} ${r}`);throw n.status=e.status,n.bodyText=r,n}}async function ri(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${wn()}/api/obe/draft/${encodeURIComponent(e)}/${encodeURIComponent(t)}${n}`,s=await la(i,{method:"GET"});return s.status===401?{subject:{code:String(t),name:""},draft:null,updated_at:null,updated_by:null}:(s.ok||await Nn(s,"Draft fetch failed"),s.json())}async function Fi(e,t,r){const n=`${wn()}/api/obe/draft/${encodeURIComponent(e)}/${encodeURIComponent(t)}`,i=await la(n,{method:"PUT",body:JSON.stringify({data:r})});if(i.status===401)throw new Error("Authentication required");return i.ok||await Nn(i,"Draft save failed"),i.json()}async function ag(e,t){const r=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${wn()}/api/obe/ssa1-published/${encodeURIComponent(e)}${r}`,i=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return i.ok||await Nn(i,"SSA1 published fetch failed"),i.json()}async function T9(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${wn()}/api/obe/ssa1-publish/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify({data:t})});return s.ok||await Nn(s,"SSA1 publish failed"),s.json()}async function _S(e){const t=`${wn()}/api/obe/review1-published/${encodeURIComponent(e)}`,r=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return r.ok||await Nn(r,"Review 1 published fetch failed"),r.json()}async function P9(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${wn()}/api/obe/review1-publish/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify({data:t})});return s.ok||await Nn(s,"Review 1 publish failed"),s.json()}async function ey(e,t){const r=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${wn()}/api/obe/ssa2-published/${encodeURIComponent(e)}${r}`,i=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return i.ok||await Nn(i,"SSA2 published fetch failed"),i.json()}async function O9(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${wn()}/api/obe/ssa2-publish/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify({data:t})});return s.ok||await Nn(s,"SSA2 publish failed"),s.json()}async function jS(e){const t=`${wn()}/api/obe/review2-published/${encodeURIComponent(e)}`,r=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return r.ok||await Nn(r,"Review 2 published fetch failed"),r.json()}async function M9(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${wn()}/api/obe/review2-publish/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify({data:t})});return s.ok||await Nn(s,"Review 2 publish failed"),s.json()}async function kS(e,t){const r=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${wn()}/api/obe/formative1-published/${encodeURIComponent(e)}${r}`,i=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return i.ok||await Nn(i,"Formative1 published fetch failed"),i.json()}async function bre(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${wn()}/api/obe/formative1-publish/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify({data:t})});return s.ok||await Nn(s,"Formative1 publish failed"),s.json()}async function v0(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${wn()}/api/obe/${encodeURIComponent(e)}-published/${encodeURIComponent(t)}${n}`,s=await fetch(i,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return s.ok||await Nn(s,`${e} published fetch failed`),s.json()}async function L9(e,t,r,n){const i=n?`?teaching_assignment_id=${encodeURIComponent(String(n))}`:"",s=`${wn()}/api/obe/${encodeURIComponent(e)}-publish/${encodeURIComponent(t)}${i}`,o=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify({data:r})});return o.ok||await Nn(o,`${e} publish failed`),o.json()}async function Ys(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${wn()}/api/obe/lab-published-sheet/${encodeURIComponent(e)}/${encodeURIComponent(t)}${n}`,s=await fetch(i,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return s.ok||await Nn(s,"Lab published sheet fetch failed"),s.json()}async function j3(e,t,r,n){const i=n?`?teaching_assignment_id=${encodeURIComponent(String(n))}`:"",s=`${wn()}/api/obe/lab-publish-sheet/${encodeURIComponent(e)}/${encodeURIComponent(t)}${i}`,o=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify({data:r})});return o.ok||await Nn(o,"Lab publish failed"),o.json()}async function ty(e,t){const r=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${wn()}/api/obe/cia1-published-sheet/${encodeURIComponent(e)}${r}`,i=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return i.ok||await Nn(i,"CIA1 published sheet fetch failed"),i.json()}async function vre(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${wn()}/api/obe/cia1-publish-sheet/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify({data:t})});return s.ok||await Nn(s,"CIA1 publish failed"),s.json()}async function Im(e,t){const r=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${wn()}/api/obe/model-published-sheet/${encodeURIComponent(e)}${r}`;try{const i=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});if(i.ok)return i.json();if(i.status===404){const s=await Ys("model",e,t);return{subject:s.subject,data:s.data}}await Nn(i,"MODEL published sheet fetch failed")}catch(i){throw i}}async function R9(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${wn()}/api/obe/model-publish-sheet/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify({data:t})});return s.ok||await Nn(s,"MODEL publish failed"),s.json()}async function w0(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${wn()}/api/obe/${encodeURIComponent(e)}-published-sheet/${encodeURIComponent(t)}${n}`,s=await fetch(i,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return s.ok||await Nn(s,`${e} published sheet fetch failed`),s.json()}async function F9(e,t,r,n){const i=n?`?teaching_assignment_id=${encodeURIComponent(String(n))}`:"",s=`${wn()}/api/obe/${encodeURIComponent(e)}-publish-sheet/${encodeURIComponent(t)}${i}`,o=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify({data:r})});return o.ok||await Nn(o,`${e} publish failed`),o.json()}async function B9(e,t,r){const n=(c,u=1200)=>{const d=String(c||""),p=d.replace(/<script[\s\S]*?<\/script>/gi," ").replace(/<style[\s\S]*?<\/style>/gi," ").replace(/<[^>]+>/g," ").replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&quot;/gi,'"').replace(/&#39;/gi,"'").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/\s+/g," ").trim()||d.replace(/\s+/g," ").trim();return p.length<=u?p:p.slice(0,u)+" (truncated)"},i=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",s=`${wn()}/api/obe/${encodeURIComponent(e)}-marks/${encodeURIComponent(t)}${i}`,o=window.localStorage.getItem("access"),l=await fetch(s,{method:"GET",headers:{"Content-Type":"application/json",...o?{Authorization:`Bearer ${o}`}:{}}});if(!l.ok){const c=await l.text();try{const u=JSON.parse(c),d=(u==null?void 0:u.detail)||`${e.toUpperCase()} roster fetch failed: ${l.status}`,f=Array.isArray(u==null?void 0:u.how_to_fix)?`
How to fix:
- ${u.how_to_fix.join(`
- `)}`:"";throw new Error(`${d}${f}`)}catch{const u=n(c);throw new Error(`${e.toUpperCase()} roster fetch failed: ${l.status}
${u||"Server returned a non-JSON error response."}`)}}return l.json()}async function wre(e,t){const r=(u,d=1200)=>{const f=String(u||""),m=f.replace(/<script[\s\S]*?<\/script>/gi," ").replace(/<style[\s\S]*?<\/style>/gi," ").replace(/<[^>]+>/g," ").replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&quot;/gi,'"').replace(/&#39;/gi,"'").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/\s+/g," ").trim()||f.replace(/\s+/g," ").trim();return m.length<=d?m:m.slice(0,d)+" (truncated)"},i=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":"https://db.krgi.co.in",s=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",o=`${i}/api/obe/cia1-marks/${encodeURIComponent(e)}${s}`,l=window.localStorage.getItem("access"),c=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json",...l?{Authorization:`Bearer ${l}`}:{}}});if(!c.ok){const u=await c.text();try{const d=JSON.parse(u),f=(d==null?void 0:d.detail)||`CIA1 roster fetch failed: ${c.status}`,h=Array.isArray(d==null?void 0:d.how_to_fix)?`
How to fix:
- ${d.how_to_fix.join(`
- `)}`:"";throw new Error(`${f}${h}`)}catch{const d=r(u);throw new Error(`CIA1 roster fetch failed: ${c.status}
${d||"Server returned a non-JSON error response."}`)}}return c.json()}async function Sre(e,t){const r=(u,d=1200)=>{const f=String(u||""),m=f.replace(/<script[\s\S]*?<\/script>/gi," ").replace(/<style[\s\S]*?<\/style>/gi," ").replace(/<[^>]+>/g," ").replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&quot;/gi,'"').replace(/&#39;/gi,"'").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/\s+/g," ").trim()||f.replace(/\s+/g," ").trim();return m.length<=d?m:m.slice(0,d)+" (truncated)"},s=`${typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":"https://db.krgi.co.in"}/api/obe/cia1-marks/${encodeURIComponent(e)}`,o=window.localStorage.getItem("access"),l=await fetch(s,{method:"PUT",headers:{"Content-Type":"application/json",...o?{Authorization:`Bearer ${o}`}:{}},body:JSON.stringify({marks:t})}),c=await l.text();if(!l.ok)try{const u=JSON.parse(c),d=(u==null?void 0:u.detail)||`CIA1 save failed: ${l.status}`,f=Array.isArray(u==null?void 0:u.how_to_fix)?`
How to fix:
- ${u.how_to_fix.join(`
- `)}`:"",h=Array.isArray(u==null?void 0:u.errors)?`
Errors:
- ${u.errors.join(`
- `)}`:"";throw new Error(`${d}${f}${h}`)}catch{const u=r(c);throw new Error(`CIA1 save failed: ${l.status}
${u||"Server returned a non-JSON error response."}`)}return JSON.parse(c)}const Y8=Object.freeze(Object.defineProperty({__proto__:null,approveEditRequest:A9,approvePublishRequest:xre,bulkDeleteDueSchedule:x9,bulkResetGlobalPublishControls:h9,bulkSetAssessmentControls:L4,bulkSetGlobalPublishControls:M4,bulkUpsertDueSchedule:g9,confirmMarkManagerLock:fh,createEditRequest:sl,createPublishRequest:jh,deleteDueSchedule:dre,dismissResetNotifications:u9,fetchAssessmentControls:Uv,fetchCia1Marks:wre,fetchCiaMarks:B9,fetchClassTypeWeights:SS,fetchDraft:ri,fetchDueScheduleSubjects:m9,fetchDueSchedules:R4,fetchEditRequestsHistory:_9,fetchEditWindow:l1,fetchGlobalPublishControls:fx,fetchHodPendingEditRequestCount:pre,fetchHodPendingEditRequests:S9,fetchInternalMarkMapping:j9,fetchIqacCqiConfig:wS,fetchIqacQpPattern:sh,fetchMarkTableLockStatus:bS,fetchMyLatestEditRequest:Bm,fetchMyTeachingAssignments:hc,fetchObeSemesters:p9,fetchPendingEditRequestCount:hre,fetchPendingEditRequests:w9,fetchPendingPublishRequestCount:F4,fetchPendingPublishRequests:mre,fetchPublishRequestsHistory:gre,fetchPublishWindow:_3,fetchPublishedCia1Sheet:ty,fetchPublishedCiaSheet:w0,fetchPublishedFormative:v0,fetchPublishedFormative1:kS,fetchPublishedLabSheet:Ys,fetchPublishedModelSheet:Im,fetchPublishedReview1:_S,fetchPublishedReview2:jS,fetchPublishedSsa1:ag,fetchPublishedSsa2:ey,fetchResetNotifications:c9,fetchSpecialCourseEnabledAssessments:vS,fetchTeachingAssignmentEnabledAssessments:lre,fetchTeachingAssignmentEnabledAssessmentsInfo:hm,formatApiErrorMessage:ll,formatEditRequestSentMessage:ol,hodApproveEditRequest:C9,hodRejectEditRequest:E9,iqacResetAssessment:S3,publishCia1Sheet:vre,publishCiaSheet:F9,publishFormative:L9,publishFormative1:bre,publishLabSheet:j3,publishModelSheet:R9,publishReview1:P9,publishReview2:M9,publishSsa1:T9,publishSsa2:O9,rejectEditRequest:N9,rejectPublishRequest:yre,requestTeachingAssignmentEnabledAssessmentsEdit:f9,saveCia1Marks:Sre,saveDraft:Fi,setTeachingAssignmentEnabledAssessments:cre,setTeachingAssignmentEnabledAssessmentsInfo:d9,upsertClassTypeWeights:fre,upsertDueSchedule:ure,upsertInternalMarkMapping:k9,upsertIqacCqiConfig:v9,upsertIqacQpPattern:b9},Symbol.toStringTag,{value:"Module"})),_re={profile:W0,curriculum_master:gs,assigned_subjects:gs,department_curriculum:G8,elective_import:P2,student_curriculum_view:O4,home:E2,hod_advisors:ys,hod_teaching:gs,advisor_students:Lm,mentor_assign:ys,timetable_templates:xs,timetable_assignments:xs,student_timetable:xs,staff_timetable:xs,student_attendance:C2,student_academics:Lm,my_mentees:ys,period_attendance:C2,obe:gs,obe_master:gs,obe_due_dates:T4,obe_requests:Cx,hod_obe_requests:Cx,academic_controller:G8,notifications:Cx};function jre({baseUrl:e=""}){const{data:t,loading:r,error:n}=ire(e),i=hl(),{collapsed:s,toggle:o}=w3(),[l,c]=x.useState(0),[u,d]=x.useState({}),h=((t==null?void 0:t.permissions)||[]).map(j=>String(j||"").toLowerCase()).includes("obe.master.manage");if(x.useEffect(()=>{let j=!0;const k=window.localStorage.getItem("access");if(!h||!k)return c(0),()=>{j=!1};(async()=>{try{const R=await F4();if(!j)return;c(Number(R.pending||0))}catch{}})();const A=window.setInterval(()=>{(async()=>{try{const R=await F4();if(!j)return;c(Number(R.pending||0))}catch{}})()},3e4);return()=>{j=!1,window.clearInterval(A)}},[h]),x.useEffect(()=>{i.pathname.startsWith("/academic")&&d(j=>({...j,academic:!0}))},[i.pathname]),x.useEffect(()=>{i.pathname.startsWith("/iqac/academic-controller")&&d(j=>({...j,academic_controller:!0}))},[i.pathname]),r)return a.jsx("aside",{className:`fixed top-16 left-0 h-[calc(100vh-4rem)] bg-white shadow-lg transition-all duration-300 z-30 ${s?"-translate-x-full lg:translate-x-0 lg:w-20":"w-full lg:w-64"}`,children:a.jsx("div",{className:"p-6 flex items-center justify-center h-full",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})});if(n)return a.jsx("aside",{className:`fixed top-16 left-0 h-[calc(100vh-4rem)] bg-white shadow-lg transition-all duration-300 z-30 ${s?"-translate-x-full lg:translate-x-0 lg:w-20":"w-full lg:w-64"}`,children:a.jsx("div",{className:"p-6 text-red-600 text-sm",children:"Error loading sidebar"})});if(!t)return null;const p=t.entry_points||{},m=[],g=(t.permissions||[]).map(j=>(j||"").toString().toLowerCase()),y=(t.roles||[]).map(j=>(j||"").toString().toUpperCase()),b=t.flags||{},v=y.includes("IQAC");return p.curriculum_master&&(g.some(j=>j.includes("curriculum"))||p.curriculum_master)&&m.push({key:"curriculum_master",label:"Curriculum Master",to:"/curriculum/master"}),p.department_curriculum&&(g.some(j=>j.includes("curriculum"))||p.department_curriculum)&&m.push({key:"department_curriculum",label:"Department Curriculum",to:"/curriculum/department"}),g.includes("curriculum.import_elective_choices")&&m.push({key:"elective_import",label:"Elective Import",to:"/curriculum/elective-import"}),p.hod_advisors&&(y.includes("HOD")||g.includes("academics.assign_advisor"))&&m.push({key:"hod_advisors",label:"Advisor Assign",to:"/hod/advisors"}),p.hod_teaching&&(y.includes("ADVISOR")||g.includes("academics.assign_teaching"))&&m.push({key:"hod_teaching",label:"Teaching Assign",to:"/advisor/teaching"}),(!!(p!=null&&p.hod_obe_requests)||y.includes("HOD"))&&m.push({key:"hod_obe_requests",label:"HOD: OBE Requests",to:"/hod/obe-requests"}),p.advisor_students&&(y.includes("ADVISOR")||g.includes("academics.view_my_students"))&&m.push({key:"advisor_students",label:"My Students",to:"/advisor/students"}),(y.includes("ADVISOR")||g.includes("academics.assign_mentor"))&&m.push({key:"mentor_assign",label:"Mentor Assign",to:"/advisor/mentor"}),p.student_curriculum_view&&g.some(j=>j.includes("curriculum"))&&m.push({key:"student_curriculum_view",label:"My Curriculum",to:"/curriculum/student"}),(b.can_manage_timetable_templates||g.includes("timetable.manage_templates"))&&p.timetable_templates&&m.push({key:"timetable_templates",label:"IQAC: Timetable Templates",to:"/iqac/timetable"}),(!!b.can_assign_timetable||g.includes("timetable.assign")||y.includes("ADVISOR"))&&p.timetable_assignments&&m.push({key:"timetable_assignments",label:"Timetable Assignments",to:"/advisor/timetable"}),b.can_view_timetable&&b.is_student&&g.includes("timetable.view")&&m.push({key:"student_timetable",label:"My Timetable",to:"/student/timetable"}),b.can_view_timetable&&b.is_staff&&g.includes("timetable.view")&&m.push({key:"staff_timetable",label:"My Timetable (Staff)",to:"/staff/timetable"}),b.is_student&&(m.push({key:"student_academics",label:"Academics",to:"/student/academics"}),m.push({key:"student_attendance",label:"My Attendance",to:"/student/attendance"})),b.is_staff&&(g.includes("academics.view_assigned_subjects")||y.includes("HOD"))&&m.push({key:"assigned_subjects",label:"Assigned Subjects",to:"/staff/assigned-subjects"}),b.is_staff&&g.includes("academics.view_mentees")&&m.push({key:"my_mentees",label:"My Mentees",to:"/staff/mentees"}),b.is_staff&&(g.includes("academics.mark_attendance")||y.includes("HOD")||y.includes("ADVISOR"))&&m.push({key:"period_attendance",label:"Mark Attendance",to:"/staff/period-attendance"}),b.is_staff&&(g.includes("academics.view_all_attendance")||g.includes("academics.view_attendance_overall")||g.includes("academics.view_all_departments")||g.includes("academics.view_department_attendance")||g.includes("academics.view_class_attendance")||g.includes("academics.view_section_attendance"))&&m.push({key:"attendance_analytics",label:"Attendance Analytics",to:"/staff/analytics"}),m.unshift({key:"profile",label:"Profile",to:"/profile"}),v&&m.push({key:"notifications",label:"Notifications",to:"/notifications"}),b.is_staff&&!m.some(j=>j.key==="academic")&&m.push({key:"academic",label:"Academic",to:"/academic"}),v&&!m.some(j=>j.key==="academic_controller")&&m.push({key:"academic_controller",label:"Academic Controller",to:"/iqac/academic-controller"}),h&&!v&&!m.some(j=>j.key==="obe_due_dates")&&m.push({key:"obe_due_dates",label:"OBE: Due Dates",to:"/obe/master/due-dates"}),h&&!m.some(j=>j.key==="obe_requests")&&m.push({key:"obe_requests",label:"OBE: Requests",to:"/obe/master/requests"}),a.jsxs(a.Fragment,{children:[!s&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-20 lg:hidden",onClick:o}),a.jsxs("aside",{className:`fixed top-16 left-0 h-[calc(100vh-4rem)] bg-white shadow-lg transition-all duration-300 z-30 overflow-y-auto ${s?"-translate-x-full lg:translate-x-0 lg:w-20":"w-full lg:w-64"}`,children:[a.jsx("div",{className:"hidden"}),a.jsx("nav",{className:"py-6",children:a.jsxs("ul",{className:"space-y-2 px-3",children:[a.jsx("li",{children:a.jsxs(es,{to:"/dashboard",className:`flex items-center gap-3 px-3 py-3 rounded-lg transition-all duration-200 ${i.pathname==="/dashboard"?"bg-blue-600 text-white shadow-md":"text-gray-700 hover:bg-blue-50 hover:text-blue-600"} ${s?"lg:justify-center lg:px-2":""}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(E2,{className:`flex-shrink-0 ${s?"lg:w-5 lg:h-5":"w-6 h-6"}`}),a.jsx("span",{className:`font-medium text-base ${s?"lg:hidden":""}`,children:"Dashboard"})]})}),m.map(j=>{const k=_re[j.key]||W0,A=i.pathname.startsWith(j.to);return a.jsxs("li",{className:"relative",children:[a.jsxs(es,{to:j.to,className:`flex items-center gap-3 px-3 py-3 rounded-lg transition-all duration-200 ${A?"bg-blue-600 text-white shadow-md":"text-gray-700 hover:bg-blue-50 hover:text-blue-600"} ${s?"lg:justify-center lg:px-2":""}`,onClick:()=>{window.innerWidth<1024&&o(),j.key==="academic"&&d(R=>({...R,academic:!R.academic})),j.key==="academic_controller"&&d(R=>({...R,academic_controller:!R.academic_controller}))},children:[a.jsx(k,{className:`flex-shrink-0 ${s?"lg:w-5 lg:h-5":"w-6 h-6"}`}),a.jsxs("span",{className:`font-medium text-base ${s?"lg:hidden":""}`,children:[j.label,j.key==="obe_requests"&&l>0?a.jsx("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-medium rounded-full bg-red-600 text-white",children:l}):null]})]}),j.key==="academic"&&h&&u.academic?a.jsxs("ul",{className:"pl-8 mt-1 space-y-1",children:[a.jsx("li",{children:a.jsxs(es,{to:"/academic?tab=obe_master",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${i.pathname.startsWith("/academic")&&new URLSearchParams(i.search).get("tab")==="obe_master"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(gs,{className:"w-4 h-4"})," ",a.jsx("span",{children:"OBE Master"})]})}),v?null:a.jsx("li",{children:a.jsxs(es,{to:"/academic?tab=due_dates",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${i.pathname.startsWith("/academic")&&new URLSearchParams(i.search).get("tab")==="due_dates"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(T4,{className:"w-4 h-4"})," ",a.jsx("span",{children:"OBE: Due Dates"})]})})]}):null,j.key==="academic_controller"&&u.academic_controller?a.jsxs("ul",{className:"pl-8 mt-1 space-y-1",children:[a.jsx("li",{children:a.jsxs(es,{to:"/iqac/academic-controller?tab=dashboard",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${i.pathname.startsWith("/iqac/academic-controller")&&new URLSearchParams(i.search).get("tab")==="dashboard"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(E2,{className:"w-4 h-4"})," ",a.jsx("span",{children:"Dashboard"})]})}),a.jsx("li",{children:a.jsxs(es,{to:"/iqac/academic-controller?tab=qp",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${i.pathname.startsWith("/iqac/academic-controller")&&new URLSearchParams(i.search).get("tab")==="qp"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(O4,{className:"w-4 h-4"})," ",a.jsx("span",{children:"QP"})]})}),a.jsx("li",{children:a.jsxs(es,{to:"/iqac/academic-controller?tab=due_dates",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${i.pathname.startsWith("/iqac/academic-controller")&&new URLSearchParams(i.search).get("tab")==="due_dates"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(T4,{className:"w-4 h-4"})," ",a.jsx("span",{children:"OBE Due Dates"})]})}),a.jsx("li",{children:a.jsxs(es,{to:"/iqac/academic-controller?tab=courses",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${i.pathname.startsWith("/iqac/academic-controller")&&new URLSearchParams(i.search).get("tab")==="courses"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(O4,{className:"w-4 h-4"})," ",a.jsx("span",{children:"Courses"})]})})]}):null]},j.key)})]})})]})]})}const kre=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];function Are({editingCell:e,periods:t,assignmentMap:r,specialName:n,setSpecialName:i,selectedSpecialId:s,setSelectedSpecialId:o,specialTimetables:l,specialDate:c,setSpecialDate:u,curriculum:d,currentSectionRegulation:f,editingCurriculumId:h,setEditingCurriculumId:p,customSubjectText:m,setCustomSubjectText:g,editingAvailableBatches:y,setEditingAvailableBatches:b,editingBatchId:v,setEditingBatchId:w,isCustomAssignment:S,setIsCustomAssignment:j,customAssignmentText:k,setCustomAssignmentText:A,selectedStaffId:R,setSelectedStaffId:M,staffList:B,sectionId:E,shortLabel:P,loadBatchesForCurriculum:U,handleDeleteSpecialEntry:G,handleDeleteAssignment:H,handleUpdateAssignment:oe,handleAssign:de,loadTimetable:W,setShowCellPopup:V,customSubjectOptions:ae,setEditingCell:ee,fetchWithAuth:C}){if(!e)return null;const Y=e.day,q=e.periodId,O=r[Y]&&r[Y][q]||[],X=t.find(F=>F.id===q)||{};return a.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 px-6 py-4 flex justify-between items-center",children:[a.jsxs("div",{className:"flex items-center gap-3 text-white",children:[a.jsx(xs,{className:"h-5 w-5"}),a.jsxs("h3",{className:"text-lg font-semibold",children:["Day ",Y,"  ",X.label||`${X.start_time||""} - ${X.end_time||""}`]})]}),a.jsx("button",{onClick:()=>{V(!1),ee(null)},className:"text-white hover:bg-white hover:bg-opacity-20 rounded-lg p-1.5 transition-colors",children:a.jsx(bu,{className:"h-5 w-5"})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(gs,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Existing Assignments"})]}),O.length===0?a.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg border-2 border-dashed border-gray-200",children:[a.jsx(ed,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-gray-500",children:"No assignment yet"})]}):a.jsx("div",{className:"space-y-3",children:O.map(F=>{var Q;return a.jsxs("div",{className:`rounded-lg p-4 border-2 ${F.is_special?"bg-amber-50 border-amber-200":"bg-blue-50 border-blue-200"}`,children:[a.jsxs("div",{className:"font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(gs,{className:"h-4 w-4"}),F.is_special?F.timetable_name||"Special":P(F.curriculum_row||F.subject_text),F.is_special&&a.jsxs("span",{className:"text-amber-600 text-sm",children:[" ",P(F.curriculum_row||F.subject_text)]})]}),a.jsxs("div",{className:"text-sm text-gray-700 mt-2 flex items-center gap-1",children:[a.jsx(ys,{className:"h-3.5 w-3.5"}),((Q=F.staff)==null?void 0:Q.username)||"",F.subject_batch?`  Batch: ${F.subject_batch.name}`:""]}),F.is_special&&a.jsxs("div",{className:"text-xs text-amber-700 mt-2 flex items-center gap-1",children:[a.jsx(xs,{className:"h-3.5 w-3.5"}),"Date: ",F.date||"","  ",X.label||`${X.start_time||""}${X.start_time&&X.end_time?" - ":""}${X.end_time||""}`]}),a.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[a.jsxs("button",{onClick:async()=>{var re,T;const K=((re=F.curriculum_row)==null?void 0:re.id)||null,ne=((T=F.subject_batch)==null?void 0:T.id)||null;if(p(K),w(ne),K){const I=await U(K);if(ne&&!I.find(ie=>ie.id===ne))try{const ie=await C(`/api/academics/subject-batches/${ne}/`);if(ie.ok){const D=await ie.json();b(Z=>Z.find(me=>me.id===D.id)?Z:[...Z,D])}}catch(ie){console.error("failed to load existing batch",ie)}}else if(ne)try{const I=await C(`/api/academics/subject-batches/${ne}/`);if(I.ok){const ie=await I.json();b(D=>D.find(Z=>Z.id===ie.id)?D:[...D,ie])}}catch(I){console.error("failed to load existing batch",I)}},className:"px-3 py-1.5 bg-indigo-600 text-white text-sm rounded-lg hover:bg-indigo-700 transition-colors flex items-center gap-1",children:[a.jsx(dh,{className:"h-3.5 w-3.5"}),"Edit"]}),a.jsxs("button",{onClick:()=>{F.is_special?G(F.id):H(F.id)},className:"px-3 py-1.5 bg-red-600 text-white text-sm rounded-lg hover:bg-red-700 transition-colors flex items-center gap-1",children:[a.jsx(Fm,{className:"h-3.5 w-3.5"}),"Delete"]}),a.jsxs("button",{onClick:async()=>{if(!h)return alert("Select new subject from right panel then click Update");const K={};h&&(K.curriculum_row=h),v!==null&&(K.subject_batch_id=v),await oe(F.id,K)},className:"px-3 py-1.5 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 transition-colors flex items-center gap-1",children:[a.jsx(rd,{className:"h-3.5 w-3.5"}),"Update"]})]})]},F.id)})})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(Rm,{className:"h-5 w-5 text-green-600"}),a.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Assign / Edit"})]}),a.jsxs("div",{className:"space-y-4 bg-gray-50 rounded-lg p-4 border border-gray-200",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assignment Type"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>{j(!1),A(""),M(null)},className:`px-3 py-2 text-sm rounded-lg border transition-colors ${S?"bg-white text-gray-700 border-gray-300 hover:border-indigo-300":"bg-indigo-600 text-white border-indigo-600"}`,children:"From Curriculum"}),a.jsx("button",{onClick:()=>{j(!0),p(null),w(null),b([])},className:`px-3 py-2 text-sm rounded-lg border transition-colors ${S?"bg-indigo-600 text-white border-indigo-600":"bg-white text-gray-700 border-gray-300 hover:border-indigo-300"}`,children:"Custom Subject"})]})]}),S?a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Subject Name"}),a.jsxs("select",{value:k||"",onChange:F=>A(F.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[a.jsx("option",{value:"",children:"Select custom subject"}),ae.map(F=>a.jsx("option",{value:F.label,children:F.label},F.value))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Staff (optional)"}),a.jsxs("select",{value:R||"",onChange:F=>M(Number(F.target.value)||null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[a.jsx("option",{value:"",children:"Select staff (optional)"}),B.map(F=>a.jsx("option",{value:F.id,children:(()=>{var re,T,I;const Q=((re=F.user)==null?void 0:re.first_name)||"",K=((T=F.user)==null?void 0:T.last_name)||"";return`${Q} ${K}`.trim()||((I=F.user)==null?void 0:I.username)||F.staff_id})()},F.id))]})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Subject"}),a.jsxs("select",{value:h||"",onChange:async F=>{const Q=Number(F.target.value)||null;p(Q),w(null),Q?await U(Q):b([])},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[a.jsx("option",{value:"",children:"Select subject"}),d.filter(F=>!(f!=null&&f.code)||F.regulation===f.code).map(F=>a.jsxs("option",{value:F.id,children:[F.course_code,"  ",F.course_name]},F.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Batch (optional)"}),a.jsxs("select",{value:v||"",onChange:F=>w(Number(F.target.value)||null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[a.jsx("option",{value:"",children:"Select batch (optional)"}),y.map(F=>a.jsx("option",{value:F.id,children:F.name},F.id))]})]})]}),a.jsxs("button",{onClick:async()=>{if(S){if(!k.trim())return alert("Subject name is required");await de(Y,q)}else{if(!h)return alert("Select a subject");await de(Y,q,h)}V(!1),ee(null)},className:"w-full px-4 py-2.5 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center gap-2 font-medium",children:[a.jsx(Rm,{className:"h-4 w-4"}),"Assign to Period"]})]}),a.jsxs("div",{className:"mt-6 border-t border-gray-200 pt-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(ed,{className:"h-5 w-5 text-amber-600"}),a.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Mark Special Period"})]}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Create a date-specific override for this period."}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Special timetable"}),a.jsxs("select",{value:s??"",onChange:F=>o(F.target.value?Number(F.target.value):null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",children:[a.jsx("option",{value:"",children:"Create new"}),l.map(F=>a.jsxs("option",{value:F.id,children:[F.name," ",F.is_active?"":"(inactive)"]},F.id))]}),!s&&a.jsx("input",{placeholder:"Name for new special timetable",value:n,onChange:F=>{F.preventDefault(),i(F.target.value)},className:"w-full mt-2 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500"},"special-name-input")]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Date"}),a.jsx("input",{type:"date",value:c||"",onChange:F=>u(F.target.value||null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Subject"}),a.jsxs("select",{value:h??"",onChange:F=>{const Q=Number(F.target.value)||null;p(Q),g(""),w(null),Q&&Q!==-1&&U(Q).catch(console.error)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",children:[a.jsx("option",{value:"",children:"-- choose from section subjects --"}),d.filter(F=>!(f!=null&&f.code)||F.regulation===f.code).map(F=>a.jsxs("option",{value:F.id,children:[F.course_code,"  ",F.course_name]},F.id)),a.jsx("option",{value:"-1",children:"Custom text"})]}),h===-1&&a.jsxs("select",{value:m||"",onChange:F=>{F.preventDefault(),g(F.target.value)},className:"w-full mt-2 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",children:[a.jsx("option",{value:"",children:"-- choose custom subject --"}),ae.map(F=>a.jsx("option",{value:F.label,children:F.label},F.value))]},"custom-subject-input")]}),y&&y.length>0&&h&&h!==-1&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Batch (optional)"}),a.jsxs("select",{value:v||"",onChange:F=>w(Number(F.target.value)||null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",children:[a.jsx("option",{value:"",children:"None"}),y.map(F=>a.jsx("option",{value:F.id,children:F.name},F.id))]})]}),a.jsxs("button",{onClick:async()=>{if(!c)return alert("Select a date");try{let F=s;if(!F){const ne=n||`Special - ${c}`,re=await C("/api/timetable/special-timetables/",{method:"POST",body:JSON.stringify({name:ne,section:E,is_active:!0})});if(!re.ok){const I=await re.text();return alert("Failed to create special timetable: "+I)}F=(await re.json()).id}const Q={timetable_id:F,timetable:F,date:c,period_id:q,period:q};h&&h!==-1&&(Q.curriculum_row=h),h===-1&&m&&(Q.subject_text=m),v&&(Q.subject_batch_id=v);const K=await C("/api/timetable/special-entries/",{method:"POST",body:JSON.stringify(Q)});if(!K.ok){const ne=await K.text();return alert("Failed to create special entry: "+ne)}alert("Special period created"),await W(),V(!1),ee(null)}catch(F){console.error(F),alert("Failed to create special entry")}},className:"w-full px-4 py-2.5 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors flex items-center justify-center gap-2 font-medium",children:[a.jsx(ed,{className:"h-4 w-4"}),"Mark Special Period"]})]})]})]})]})})]})})}function Nre(){const[e,t]=x.useState([]),[r,n]=x.useState([]),[i,s]=x.useState([]),[o,l]=x.useState(null),[c,u]=x.useState(null),[d,f]=x.useState(null),[h,p]=x.useState(null),[m,g]=x.useState([]),[y,b]=x.useState([]),[v,w]=x.useState([]),[S,j]=x.useState(null),[k,A]=x.useState(null),[R,M]=x.useState([]),[B,E]=x.useState(null),[P,U]=x.useState(!1),[G,H]=x.useState(new Date().toISOString().slice(0,10)),[oe,de]=x.useState([]),[W,V]=x.useState(null),[ae,ee]=x.useState(""),[C,Y]=x.useState(""),[q,O]=x.useState([]),[X,F]=x.useState(!1),[Q,K]=x.useState(""),[ne,re]=x.useState(null),[T,I]=x.useState([]);x.useEffect(()=>{mr("/api/academics/my-students/").then(Ye=>Ye.ok?Ye.json():[]).then(Ye=>{const lt=(Ye.results||[]).map(be=>({id:be.section_id,name:be.section_name,batch:be.batch,batch_regulation:be.batch_regulation,department_id:be.department_id}));t(lt),!o&&lt.length>0&&(l(lt[0].id),u(lt[0].department_id),f(lt[0].batch_regulation))}),mr("/api/timetable/templates/").then(Ye=>Ye.json()).then(Ye=>{const lt=Ye||[];n(lt);const be=lt.find(ke=>ke.is_active)||lt[0];be&&(p(be.id),s(be.periods||[]))}),mr("/api/academics/custom-subjects/").then(Ye=>Ye.ok?Ye.json():{results:[]}).then(Ye=>O(Ye.results||[])).catch(Ye=>console.error("Failed to load custom subjects",Ye))},[]),x.useEffect(()=>{if(o){const Ye=e.find(lt=>lt.id===o);Ye&&f(Ye.batch_regulation),mr(`/api/timetable/curriculum-for-section/?section_id=${o}`).then(lt=>lt.json()).then(lt=>g(lt.results||[])),ie(),mr(`/api/timetable/section/${o}/subjects-staff/`).then(lt=>lt.ok?lt.json():[]).then(lt=>w(lt.results||[])),mr(`/api/timetable/special-timetables/?section_id=${o}`).then(lt=>lt.ok?lt.json():[]).then(lt=>de(lt.results||[])),c&&mr(`/api/academics/advisor-staff/?department=${c}`).then(lt=>lt.ok?lt.json():[]).then(lt=>I(lt.results||lt||[]))}},[o,c]);async function ie(){if(o)try{const Ye=await mr(`/api/timetable/section/${o}/timetable/`);if(!Ye.ok)return;const lt=await Ye.json();b(lt.results||[])}catch(Ye){console.error("loadTimetable failed",Ye)}}const D={};for(const Ye of y){const lt=Ye.day;D[lt]=D[lt]||{};for(const be of Ye.assignments||[])D[lt][be.period_id]=D[lt][be.period_id]||[],D[lt][be.period_id].push(be)}function Z(Ye){if(!Ye)return"";if(typeof Ye=="string"){const ke=Ye.trim();return ke.length<=12?ke:ke.slice(0,12)+""}if(Ye.course_code)return Ye.course_code;const lt=Ye.course_name||Ye.course||Ye.subject_text||"",be=String(lt).trim();return be.length<=12?be:be.split(" ").map(ke=>ke[0]).slice(0,3).join("")||be.slice(0,12)}function me(Ye){const lt=new Date,be=lt.getDay(),ke=new Date(lt),ce=be===0?-6:1-be;ke.setDate(lt.getDate()+ce);const we=new Date(ke);return we.setDate(ke.getDate()+(Ye-1)),we.toISOString().slice(0,10)}async function Te(Ye,lt,be){if(!o)return alert("Section is required");const ke={period_id:lt,day:Ye,section_id:o};if(X){if(!Q.trim())return alert("Subject name is required");ke.subject_text=Q.trim(),ne&&(ke.staff_id=ne)}else{if(!be)return alert("Select a curriculum row first");ke.curriculum_row=be,B&&(ke.subject_batch_id=B)}const ce=await mr("/api/timetable/assignments/",{method:"POST",body:JSON.stringify(ke)});if(!ce.ok){const we=await ce.text();return alert("Failed: "+we)}A(null),M([]),E(null),K(""),re(null),await ie()}async function je(Ye){if(M([]),!Ye)return[];try{const lt=await mr(`/api/academics/subject-batches/?curriculum_row_id=${Ye}&page_size=0&include_all=1`);if(lt.ok){const be=await lt.json(),ke=be.results||be||[];return M(ke),ke}}catch(lt){console.error("loadBatches failed",lt)}return[]}function Le(Ye,lt){if(lt.is_break||lt.is_lunch)return a.jsx("div",{className:"flex items-center justify-center py-2",children:a.jsx("span",{className:"text-sm text-gray-500 italic",children:lt.label||(lt.is_break?"Break":"Lunch")})});const be=D[Ye]&&D[Ye][lt.id];return a.jsx("div",{children:be&&be.length?a.jsx("div",{className:"space-y-2",children:be.map((ke,ce)=>a.jsxs("div",{className:`rounded-lg p-2.5 cursor-pointer transition-all hover:shadow-md ${ke.is_special?"bg-amber-50 border border-amber-200 hover:border-amber-300":"bg-blue-50 border border-blue-200 hover:border-blue-300"}`,onClick:()=>{j({day:Ye,periodId:lt.id}),H(me(Ye)),U(!0)},children:[a.jsxs("div",{className:"font-semibold text-gray-900 text-xs leading-tight flex items-center gap-1",children:[a.jsx(gs,{className:"h-3 w-3"}),ke.is_special?ke.timetable_name||"Special":Z(ke.curriculum_row||ke.subject_text),ke.is_special&&a.jsxs("span",{className:"text-amber-600 ml-1",children:[" ",Z(ke.curriculum_row||ke.subject_text)]})]}),a.jsxs("div",{className:"text-xs text-gray-700 mt-1 flex items-center gap-1",children:[a.jsx(ys,{className:"h-3 w-3"}),"Staff: ",(()=>{if(!ke.staff)return"";const we=ke.staff.first_name||"",ht=ke.staff.last_name||"";return`${we} ${ht}`.trim()||ke.staff.username||""})(),ke.subject_batch?`  Batch: ${ke.subject_batch.name}`:""]})]},ce))}):a.jsxs("div",{className:"py-4 text-gray-400 text-sm cursor-pointer hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-all flex items-center justify-center gap-1",onClick:()=>{j({day:Ye,periodId:lt.id}),H(me(Ye)),U(!0)},children:[a.jsx(Rm,{className:"h-4 w-4"}),"Click to assign"]})})}async function _e(Ye){if(Ye&&confirm("Delete this assignment?"))try{const lt=await mr(`/api/timetable/assignments/${Ye}/`,{method:"DELETE"});if(!lt.ok){const be=await lt.text();return alert("Failed: "+be)}await ie()}catch(lt){console.error(lt),alert("Delete failed")}}async function He(Ye){if(!Ye||!confirm("Delete this special period?"))return;let lt=String(Ye);lt.startsWith("special-")&&(lt=lt.replace("special-",""));const be=Number(lt);if(!be)return alert("Invalid special entry id");try{const ke=await mr(`/api/timetable/special-entries/${be}/`,{method:"DELETE"});if(!ke.ok){const ce=await ke.text();return alert("Failed: "+ce)}await ie()}catch(ke){console.error(ke),alert("Delete failed")}}async function We(Ye,lt){if(Ye)try{const be=await mr(`/api/timetable/assignments/${Ye}/`,{method:"PATCH",body:JSON.stringify(lt)});if(!be.ok){const ke=await be.text();return alert("Failed: "+ke)}await ie(),U(!1),j(null)}catch(be){console.error(be),alert("Update failed")}}const dt=(()=>{if(!(d!=null&&d.code))return[];const Ye=m.filter(ke=>ke.regulation===d.code),lt=new Map;return v.forEach(ke=>{ke.id&&ke.staff&&lt.set(ke.id,ke.staff)}),Ye.map(ke=>({...ke,staff:lt.get(ke.id)||""}))})();return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-6",children:[a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6 border border-gray-100",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-3 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl",children:a.jsx(xs,{className:"h-7 w-7 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Timetable Editor"}),a.jsx("p",{className:"text-gray-600",children:"Manage class schedules and assignments"})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"px-4 py-2 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg border border-indigo-200",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Lm,{className:"h-4 w-4 text-indigo-600"}),a.jsx("span",{className:"font-semibold text-indigo-900",children:(e.find(Ye=>Ye.id===o)||{name:"Section"}).name})]})}),d&&a.jsx("div",{className:"px-4 py-2 bg-gradient-to-r from-emerald-50 to-teal-50 rounded-lg border border-emerald-200",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(gs,{className:"h-4 w-4 text-emerald-600"}),a.jsxs("span",{className:"font-semibold text-emerald-900",children:["Regulation: ",d.code]})]})}),h&&a.jsx("div",{className:"px-4 py-2 bg-gray-50 rounded-lg border border-gray-200",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sc,{className:"h-4 w-4 text-gray-600"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:(r.find(Ye=>Ye.id===h)||{name:"Template"}).name})]})})]})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 mb-6 overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sc,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Weekly Schedule"})]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-slate-50 to-blue-50 border-b-2 border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700 min-w-[120px] sticky left-0 bg-gradient-to-r from-slate-50 to-blue-50 z-10",children:"Day / Period"}),i.map(Ye=>a.jsxs("th",{className:"px-4 py-3 min-w-[160px]",children:[a.jsx("div",{className:"text-sm font-bold text-indigo-700",children:Ye.label||`Period ${Ye.index||""}`}),a.jsx("div",{className:"text-xs text-gray-600 mt-0.5",children:Ye.start_time?`${Ye.start_time}${Ye.end_time?" - "+Ye.end_time:""}`:Ye.is_break?"Break":""})]},Ye.id))]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:kre.map((Ye,lt)=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-4 py-3 font-bold text-gray-900 bg-gray-50 sticky left-0 z-10",children:Ye}),i.map(be=>{const ke=S&&S.day===lt+1&&S.periodId===be.id;return a.jsx("td",{className:`px-4 py-3 align-top ${ke?"bg-indigo-50 border-2 border-indigo-300 shadow-md":""}`,children:Le(lt+1,be)},be.id)})]},Ye))})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ys,{className:"h-5 w-5 text-indigo-600"}),a.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Subjects & Staff Reference",d&&a.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-600",children:["(Regulation: ",d.code,")"]})]})]})}),a.jsx("div",{className:"overflow-x-auto max-h-96",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 sticky top-0",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Subject"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Staff"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:dt.length===0?a.jsx("tr",{children:a.jsxs("td",{colSpan:2,className:"px-6 py-8 text-center",children:[a.jsx(gs,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-gray-500",children:d?`No subjects found for regulation ${d.code}`:"No subjects found"})]})}):dt.map(Ye=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-6 py-3 text-sm text-gray-900",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(gs,{className:"h-4 w-4 text-indigo-600"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:Ye.course_code?`${Ye.course_code}  ${Ye.course_name}`:Ye.course_name}),Ye.class_type&&a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[Ye.class_type," ",Ye.is_elective?" Elective":""]})]})]})}),a.jsx("td",{className:"px-6 py-3 text-sm text-gray-700",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ys,{className:"h-4 w-4 text-gray-500"}),a.jsx("span",{className:Ye.staff===""?"text-gray-400 italic":"",children:Ye.staff}),Ye.staff===""&&a.jsx("span",{className:"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full",children:"Not Assigned"})]})})]},String(Ye.id)))})]})})]})]}),P?a.jsx(Are,{editingCell:S,periods:i,assignmentMap:D,specialName:ae,setSpecialName:ee,selectedSpecialId:W,setSelectedSpecialId:V,specialTimetables:oe,specialDate:G,setSpecialDate:H,curriculum:m,currentSectionRegulation:d,editingCurriculumId:k,setEditingCurriculumId:A,customSubjectText:C,setCustomSubjectText:Y,editingAvailableBatches:R,setEditingAvailableBatches:M,editingBatchId:B,setEditingBatchId:E,isCustomAssignment:X,setIsCustomAssignment:F,customAssignmentText:Q,setCustomAssignmentText:K,selectedStaffId:ne,setSelectedStaffId:re,staffList:T,sectionId:o,shortLabel:Z,loadBatchesForCurriculum:je,handleDeleteSpecialEntry:He,handleDeleteAssignment:_e,handleUpdateAssignment:We,handleAssign:Te,loadTimetable:ie,setShowCellPopup:U,setEditingCell:j,fetchWithAuth:mr,customSubjectOptions:q}):null]})}function Cre(){const[e,t]=x.useState([]),[r,n]=x.useState(null),[i,s]=x.useState(!1),[o,l]=x.useState({name:"",description:"",parity:"BOTH",is_public:!1,is_active:!1}),[c,u]=x.useState([]),[d,f]=x.useState({name:"",parity:"ODD",is_active:!1}),[h,p]=x.useState({index:1,start_time:"",end_time:"",is_break:!1,is_lunch:!1,label:""}),[m,g]=x.useState(null),[y,b]=x.useState({});x.useEffect(()=>{v()},[]),x.useEffect(()=>{w()},[]);async function v(){s(!0);try{const E=await mr("/api/timetable/templates/");if(!E.ok)throw new Error(await E.text());const P=await E.json(),U=Array.isArray(P)?P:P.results||P;if(t(U||[]),U&&U.length){const G=U.find(H=>H.is_active)||U[0];n(G);try{const H=G&&G.periods||[],oe=H.length?Math.max(...H.map(de=>Number(de.index||de.position||0))):0;p(de=>({...de,index:Number(oe)+1}))}catch{}}}catch(E){console.error(E),alert("Failed to load templates")}finally{s(!1)}}async function w(){try{const E=await mr("/api/academics/academic-years/");if(!E.ok)throw new Error(await E.text());const P=await E.json(),U=Array.isArray(P)?P:P.results||P;u(U||[])}catch(E){console.error(E)}}async function S(){try{const E=await mr("/api/academics/academic-years/",{method:"POST",body:JSON.stringify(d)});if(!E.ok)throw new Error(await E.text());await w(),f({name:"",parity:"ODD",is_active:!1})}catch(E){console.error(E),alert("Failed to create academic year: "+String(E))}}async function j(E,P){try{const U=await mr(`/api/academics/academic-years/${E}/`,{method:"PATCH",body:JSON.stringify({is_active:P})});if(!U.ok)throw new Error(await U.text());await w(),await v()}catch(U){console.error(U),alert("Failed to update academic year: "+String(U))}}async function k(){if(!r)return alert("Select a template first");try{const E={...h,template:r.id},P=await mr("/api/timetable/slots/",{method:"POST",body:JSON.stringify(E)});if(!P.ok)throw new Error(await P.text());await v(),p({index:h.index+1,start_time:"",end_time:"",is_break:!1,is_lunch:!1,label:""})}catch(E){console.error(E),alert("Failed to add slot: "+String(E))}}async function A(E){if(confirm("Delete this period?"))try{const P=await mr(`/api/timetable/slots/${E}/`,{method:"DELETE"});if(!P.ok)throw new Error(await P.text());await v()}catch(P){console.error(P),alert("Failed to delete slot: "+String(P))}}function R(E){g(E.id),b({...E})}function M(){g(null),b({})}async function B(){if(!(!m||!y))try{const E=await mr(`/api/timetable/slots/${m}/`,{method:"PATCH",body:JSON.stringify(y)});if(!E.ok)throw new Error(await E.text());await v(),g(null),b({})}catch(E){console.error(E),alert("Failed to update slot: "+String(E))}}return a.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[a.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[a.jsx("span",{className:"p-3 bg-indigo-100 rounded-xl",children:a.jsxs("svg",{width:"28",height:"28",fill:"none",viewBox:"0 0 48 48",children:[a.jsx("rect",{width:"48",height:"48",rx:"12",fill:"#e0e7ff"}),a.jsx("path",{d:"M16 24h16M16 32h16M16 16h16",stroke:"#6366f1",strokeWidth:"2",strokeLinecap:"round"})]})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"IQAC  Timetable Templates"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Create and manage timetable templates and periods."})]})]}),i&&a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),"Loading templates..."]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsx("div",{className:"lg:col-span-1",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(xs,{className:"w-5 h-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Academic Years"})]}),a.jsxs("div",{className:"space-y-3 mb-6 p-4 bg-gray-50 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{type:"text",placeholder:"e.g. 2025-26",value:d.name,onChange:E=>f({...d,name:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Parity"}),a.jsxs("select",{value:d.parity,onChange:E=>f({...d,parity:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"ODD",children:"Odd"}),a.jsx("option",{value:"EVEN",children:"Even"})]})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",id:"activate",checked:d.is_active,onChange:E=>f({...d,is_active:E.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("label",{htmlFor:"activate",className:"ml-2 text-sm text-gray-700",children:"Activate on create"})]}),a.jsx("button",{onClick:S,className:"w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Create Academic Year"})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Existing Years"}),a.jsx("div",{className:"space-y-2",children:c.map(E=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsx("div",{children:a.jsxs("div",{className:"font-medium text-gray-900",children:[E.name," ",E.parity&&`(${E.parity})`,E.is_active&&a.jsx("span",{className:"ml-2 text-xs bg-green-100 text-green-800 px-2 py-0.5 rounded-full",children:"Active"})]})}),a.jsx("button",{onClick:()=>j(E.id,!E.is_active),className:`px-3 py-1 text-xs font-medium rounded-lg transition-colors ${E.is_active?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:E.is_active?"Deactivate":"Activate"})]},E.id))})]})]})}),a.jsx("div",{className:"lg:col-span-2",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[a.jsx(sc,{className:"w-5 h-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Template Management"})]}),!r&&a.jsxs("div",{className:"text-center py-12 text-gray-500",children:[a.jsx(sc,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),a.jsx("p",{children:"Select a template to manage its periods."})]}),r&&a.jsxs("div",{children:[a.jsxs("div",{className:"border-b border-gray-200 pb-4 mb-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("h4",{className:"text-xl font-semibold text-gray-900",children:r.name}),a.jsx("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded-full",children:r.parity}),r.is_active&&a.jsx("span",{className:"px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full",children:"Active"})]}),r.description&&a.jsx("p",{className:"text-gray-600",children:r.description})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h5",{className:"text-lg font-medium text-gray-900 mb-3",children:"Periods"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full border-collapse border border-gray-200 rounded-lg",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-indigo-50",children:[a.jsx("th",{className:"border border-gray-200 px-4 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider",children:"Label"}),a.jsx("th",{className:"border border-gray-200 px-4 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider",children:"Start Time"}),a.jsx("th",{className:"border border-gray-200 px-4 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider",children:"End Time"}),a.jsx("th",{className:"border border-gray-200 px-4 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider",children:"Type"}),a.jsx("th",{className:"border border-gray-200 px-4 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white",children:(r.periods||[]).map(E=>a.jsx("tr",{className:"hover:bg-gray-50",children:m===E.id?a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"border border-gray-200 px-4 py-3",children:a.jsx("input",{type:"text",value:y.label||"",onChange:P=>b({...y,label:P.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Label"})}),a.jsx("td",{className:"border border-gray-200 px-4 py-3",children:a.jsx("input",{type:"time",value:y.start_time||"",onChange:P=>b({...y,start_time:P.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"border border-gray-200 px-4 py-3",children:a.jsx("input",{type:"time",value:y.end_time||"",onChange:P=>b({...y,end_time:P.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"border border-gray-200 px-4 py-3",children:a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("label",{className:"flex items-center text-xs",children:[a.jsx("input",{type:"checkbox",checked:y.is_break||!1,onChange:P=>b({...y,is_break:P.target.checked,is_lunch:!1}),className:"mr-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),"Break"]}),a.jsxs("label",{className:"flex items-center text-xs",children:[a.jsx("input",{type:"checkbox",checked:y.is_lunch||!1,onChange:P=>b({...y,is_lunch:P.target.checked,is_break:!1}),className:"mr-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),"Lunch"]})]})}),a.jsx("td",{className:"border border-gray-200 px-4 py-3",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:B,className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Save Changes",children:a.jsx(rd,{className:"w-4 h-4"})}),a.jsx("button",{onClick:M,className:"p-2 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors",title:"Cancel Edit",children:a.jsx(bu,{className:"w-4 h-4"})})]})})]}):a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"border border-gray-200 px-4 py-3 text-sm text-gray-900",children:E.label||""}),a.jsx("td",{className:"border border-gray-200 px-4 py-3 text-sm text-gray-900",children:E.start_time||""}),a.jsx("td",{className:"border border-gray-200 px-4 py-3 text-sm text-gray-900",children:E.end_time||""}),a.jsx("td",{className:"border border-gray-200 px-4 py-3 text-sm",children:E.is_break?a.jsx("span",{className:"px-2 py-1 text-xs bg-yellow-100 text-yellow-800 rounded-full",children:"Break"}):E.is_lunch?a.jsx("span",{className:"px-2 py-1 text-xs bg-orange-100 text-orange-800 rounded-full",children:"Lunch"}):a.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full",children:"Period"})}),a.jsx("td",{className:"border border-gray-200 px-4 py-3",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>R(E),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit Period",children:a.jsx(dh,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>A(E.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete Period",children:a.jsx(Fm,{className:"w-4 h-4"})})]})})]})},E.id))})]})})]}),a.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(Rm,{className:"w-5 h-5 text-green-600"}),a.jsx("h5",{className:"text-lg font-medium text-gray-900",children:"Add New Period"})]}),a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Index"}),a.jsx("input",{type:"number",value:h.index,onChange:E=>p({...h,index:Number(E.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Time"}),a.jsx("input",{type:"time",value:h.start_time,onChange:E=>p({...h,start_time:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Time"}),a.jsx("input",{type:"time",value:h.end_time,onChange:E=>p({...h,end_time:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Label"}),a.jsx("input",{type:"text",placeholder:"Period 1, Break, etc.",value:h.label,onChange:E=>p({...h,label:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),a.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:h.is_break,onChange:E=>p({...h,is_break:E.target.checked,is_lunch:!1}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Break Period"})]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:h.is_lunch,onChange:E=>p({...h,is_lunch:E.target.checked,is_break:!1}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Lunch Period"})]})]}),a.jsxs("button",{onClick:k,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors font-medium flex items-center gap-2",children:[a.jsx(Rm,{className:"w-4 h-4"}),"Add Period"]})]})]})]})})]})]})}function I9(){var j,k,A,R,M;const[e,t]=x.useState(!1),[r,n]=x.useState(null),[i,s]=x.useState([]),[o,l]=x.useState([]),[c,u]=x.useState({}),[d,f]=x.useState({}),[h,p]=x.useState(null);async function m(){t(!0),n(null);try{const[B,E]=await Promise.all([w9(),_9({statuses:["APPROVED","REJECTED"],limit:200})]),P=Array.isArray(B==null?void 0:B.results)?B.results:[],U=Array.isArray(E==null?void 0:E.results)?E.results:[];s(P),l(U),u(G=>{const H={...G};for(const oe of P)H[oe.id]==null&&(H[oe.id]=120);return H})}catch(B){n((B==null?void 0:B.message)||"Failed to load requests")}finally{t(!1)}}x.useEffect(()=>{m()},[]);const g=x.useMemo(()=>[...i].sort((B,E)=>String(E.requested_at||"").localeCompare(String(B.requested_at||""))),[i]),y=x.useMemo(()=>[...o].sort((B,E)=>String(E.reviewed_at||E.requested_at||"").localeCompare(String(B.reviewed_at||B.requested_at||""))),[o]);function b(B){const E=String(B||"").trim();if(!E)return"?";const P=E.split(/\s+/g).filter(Boolean);return P.length===1?P[0].slice(0,2).toUpperCase():(P[0][0]+P[P.length-1][0]).toUpperCase()}function v(B){if(!B)return"";const E=new Date(B);return Number.isNaN(E.getTime())?String(B):E.toLocaleString()}async function w(B){const E=Number(c[B]??120);f(P=>({...P,[B]:!0})),n(null);try{await A9(B,Number.isFinite(E)?E:120),await m()}catch(P){n((P==null?void 0:P.message)||"Approve failed")}finally{f(P=>({...P,[B]:!1}))}}async function S(B){f(E=>({...E,[B]:!0})),n(null);try{await N9(B),await m()}catch(E){n((E==null?void 0:E.message)||"Reject failed")}finally{f(E=>({...E,[B]:!1}))}}return a.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",padding:20},children:[a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center",marginBottom:20},children:[a.jsx(sc,{size:24,color:"#9a3412"}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:24,fontWeight:950,color:"#111827"},children:"OBE Edit Requests"}),a.jsx("div",{style:{color:"#6b7280",fontSize:14},children:"Manage pending requests for Mark Entry and Mark Manager edits from faculty"})]}),a.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:a.jsxs("button",{className:"obe-btn obe-btn-secondary",onClick:m,disabled:e,children:[a.jsx(T2,{size:16,style:{marginRight:6}}),e?"Refreshing":"Refresh"]})})]}),r?a.jsxs("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:12,borderRadius:12,marginBottom:20},children:[a.jsx(b3,{size:16,style:{marginRight:8,verticalAlign:"middle"}}),r]}):null,a.jsxs("div",{style:{display:"grid",gap:18},children:[a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontSize:16,fontWeight:950,color:"#111827"},children:"Answered Now"}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["(",g.length,")"]})]}),g.length===0?a.jsxs("div",{style:{textAlign:"center",padding:22,color:"#6b7280",border:"1px dashed #e5e7eb",borderRadius:14,background:"#fff"},children:[a.jsx(y3,{size:34,color:"#10b981",style:{marginBottom:8}}),a.jsx("div",{children:"No pending requests"})]}):a.jsx("div",{style:{display:"grid",gap:10},children:g.map(B=>{var G,H,oe;const E=!!d[B.id],P=String(((G=B.staff)==null?void 0:G.name)||((H=B.staff)==null?void 0:H.username)||"Unknown"),U=(oe=B.staff)==null?void 0:oe.department;return a.jsxs("div",{onClick:()=>p({kind:"pending",item:B}),style:{border:"1px solid #e5e7eb",borderRadius:14,background:"#fff",padding:12,display:"flex",gap:12,alignItems:"center",cursor:"pointer"},children:[a.jsx("div",{style:{width:44,height:44,borderRadius:999,background:"#fff7ed",border:"1px solid #fed7aa",display:"grid",placeItems:"center",fontWeight:950,color:"#9a3412"},children:b(P)}),a.jsxs("div",{style:{flex:1,minWidth:220},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"baseline"},children:[a.jsx("div",{style:{fontWeight:900,color:"#111827"},children:P}),U?a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[" ",U]}):null]}),a.jsxs("div",{style:{fontSize:13,color:"#374151",fontWeight:700},children:[B.subject_code,"  ",a.jsx("span",{style:{color:"#2563eb",fontWeight:800},children:B.subject_name||B.subject_code})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["Mark Manager  ",B.assessment.toUpperCase(),"  ",v(B.requested_at)]})]}),a.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[a.jsxs("div",{style:{background:"#fef3c7",color:"#92400e",padding:"4px 8px",borderRadius:999,fontSize:12,fontWeight:800,whiteSpace:"nowrap"},children:[a.jsx(sc,{size:12,style:{marginRight:4,verticalAlign:"middle"}}),"Pending"]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},onClick:de=>de.stopPropagation(),children:[a.jsx("input",{type:"number",value:c[B.id]??120,onChange:de=>u(W=>({...W,[B.id]:Number(de.target.value)})),min:1,max:1440,style:{width:82,padding:"6px 8px",border:"1px solid #d1d5db",borderRadius:10},disabled:E,title:"Window minutes"}),a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>w(B.id),disabled:E,children:E?"Approving":"Approve"}),a.jsx("button",{className:"obe-btn obe-btn-danger",onClick:()=>S(B.id),disabled:E,children:E?"Rejecting":"Reject"})]})]})]},B.id)})})]}),a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontSize:16,fontWeight:950,color:"#111827"},children:"History"}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["(",y.length,")"]})]}),y.length===0?a.jsx("div",{style:{textAlign:"center",padding:22,color:"#6b7280",border:"1px dashed #e5e7eb",borderRadius:14,background:"#fff"},children:a.jsx("div",{children:"No reviewed requests yet"})}):a.jsx("div",{style:{display:"grid",gap:10},children:y.map(B=>{var de,W,V;const E=String(((de=B.staff)==null?void 0:de.name)||((W=B.staff)==null?void 0:W.username)||"Unknown"),P=(V=B.staff)==null?void 0:V.department,U=B.status==="APPROVED",G=U?"#ecfdf5":"#fef2f2",H=U?"#065f46":"#991b1b",oe=U?"#10b98133":"#ef444433";return a.jsxs("div",{onClick:()=>p({kind:"history",item:B}),style:{border:"1px solid #e5e7eb",borderRadius:14,background:"#fff",padding:12,display:"flex",gap:12,alignItems:"center",cursor:"pointer"},children:[a.jsx("div",{style:{width:44,height:44,borderRadius:999,background:"#f9fafb",border:"1px solid #e5e7eb",display:"grid",placeItems:"center",fontWeight:950,color:"#111827"},children:b(E)}),a.jsxs("div",{style:{flex:1,minWidth:220},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"baseline"},children:[a.jsx("div",{style:{fontWeight:900,color:"#111827"},children:E}),P?a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[" ",P]}):null]}),a.jsxs("div",{style:{fontSize:13,color:"#374151",fontWeight:700},children:[B.subject_code,"  ",a.jsx("span",{style:{color:"#2563eb",fontWeight:800},children:B.subject_name||B.subject_code})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["Mark Manager  ",B.assessment.toUpperCase(),"  Reviewed ",v(B.reviewed_at)]})]}),a.jsx("div",{style:{display:"flex",gap:10,alignItems:"center"},children:a.jsx("div",{style:{background:G,color:H,border:`1px solid ${oe}`,padding:"4px 10px",borderRadius:999,fontSize:12,fontWeight:900,whiteSpace:"nowrap"},children:U?"Approved":"Rejected"})})]},B.id)})})]})]}),h?a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:60},onClick:()=>p(null),children:a.jsxs("div",{style:{width:"min(760px, 96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:16},onClick:B=>B.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,color:"#111827"},children:"Request Details"}),a.jsx("div",{style:{marginLeft:"auto"},children:a.jsx("button",{className:"obe-btn",onClick:()=>p(null),children:"Close"})})]}),a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#f9fafb"},children:a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"160px 1fr",rowGap:8,columnGap:10,fontSize:13},children:[a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Status"}),a.jsx("div",{style:{color:"#111827",fontWeight:900},children:h.item.status}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Staff"}),a.jsxs("div",{style:{color:"#111827",fontWeight:900},children:[String(((j=h.item.staff)==null?void 0:j.name)||((k=h.item.staff)==null?void 0:k.username)||"Unknown"),(A=h.item.staff)!=null&&A.department?a.jsxs("span",{style:{color:"#6b7280",fontWeight:700},children:["  ",h.item.staff.department]}):null]}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Subject"}),a.jsxs("div",{style:{color:"#111827"},children:[a.jsx("span",{style:{fontWeight:900},children:h.item.subject_code}),"  ",a.jsx("span",{style:{color:"#2563eb",fontWeight:800},children:h.item.subject_name||h.item.subject_code})]}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Assessment"}),a.jsx("div",{style:{color:"#111827",fontWeight:900},children:h.item.assessment.toUpperCase()}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Requested At"}),a.jsx("div",{style:{color:"#111827"},children:v(h.item.requested_at)}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Reason"}),a.jsx("div",{style:{color:"#111827",whiteSpace:"pre-wrap"},children:h.item.reason||""}),"reviewed_at"in h.item?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Reviewed At"}),a.jsx("div",{style:{color:"#111827"},children:v(h.item.reviewed_at)}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Reviewed By"}),a.jsx("div",{style:{color:"#111827"},children:String(((R=h.item.reviewed_by)==null?void 0:R.name)||((M=h.item.reviewed_by)==null?void 0:M.username)||"")}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Approved Until"}),a.jsx("div",{style:{color:"#111827"},children:v(h.item.approved_until)})]}):null]})})]})}):null]})}const X8=[1,2,3,4,5,6,7,8],Ere=["THEORY","LAB","TCPL","TCPR","PRACTICAL","PROJECT","AUDIT","SPECIAL"],Af={THEORY:"Theory",LAB:"Lab",TCPL:"TCPL",TCPR:"TCPR",PRACTICAL:"Practical",PROJECT:"Project",AUDIT:"Audit",SPECIAL:"Special"},Tre=["ssa1","formative1","cia1","ssa2","formative2","cia2","model"],Pre=["ssa1","review1","cia1","ssa2","review2","cia2","model"],Ore=["cia1","cia2","model"],Mre=["cia1","cia2","model"],Lre=["review1","review2","model"],Q8=["ssa1","formative1","cia1","ssa2","formative2","cia2"],Tu=["ssa1","review1","formative1","cia1","ssa2","review2","formative2","cia2","model"];function J8(e){var l;const{controls:t,semesterIds:r,assessments:n}=e;if(!r.length||!n.length)return"MIXED";const i=new Set(r.map(c=>Number(c))),s=new Map;for(const c of t||[]){const u=Number((l=c==null?void 0:c.semester)==null?void 0:l.id);if(!Number.isFinite(u)||!i.has(u))continue;const d=String((c==null?void 0:c.assessment)||"").trim().toLowerCase();d&&s.set(`${u}::${d}`,!!(c!=null&&c.is_open))}const o=new Set;for(const c of r)for(const u of n){const d=`${Number(c)}::${String(u).toLowerCase()}`;if(!s.has(d))o.add("ON");else{const f=!!s.get(d);o.add(f?"UNLIMITED":"OFF")}}return o.size===1?Array.from(o)[0]:"MIXED"}function Rre(e,t){if(e==="LAB")return Ore;if(e==="TCPR")return Pre;if(e==="PRACTICAL")return Mre;if(e==="PROJECT")return Lre;if(e==="SPECIAL"){const r=[];for(const o of t){const l=Array.isArray(o==null?void 0:o.enabled_assessments)?o.enabled_assessments:[];for(const c of l)r.push(String(c||"").trim().toLowerCase())}const n=B4(r).filter(Boolean);if(!n.length)return[];const i=new Set(Q8),s=[];for(const o of Q8)n.includes(String(o))&&s.push(o);for(const o of n)i.has(o)&&!s.includes(o)&&s.push(o);return s}return Tre}function Z8(e,t){if(e==="TCPL"){if(t==="formative1")return"LAB 1";if(t==="formative2")return"LAB 2"}if(e==="LAB"){if(t==="cia1")return"CIA 1 LAB";if(t==="cia2")return"CIA 2 LAB";if(t==="model")return"MODEL LAB"}if(e==="PRACTICAL"){if(t==="cia1")return"CIA 1 Review";if(t==="cia2")return"CIA 2 Review";if(t==="model")return"MODEL Review"}return e==="PROJECT"&&t==="model"?"MODEL Review":t==="ssa1"?"SSA1":t==="ssa2"?"SSA2":t==="review1"?"Review 1":t==="review2"?"Review 2":t==="formative1"?"Formative 1":t==="formative2"?"Formative 2":t==="cia1"?"CIA 1":t==="cia2"?"CIA 2":t==="model"?"MODEL":String(t).toUpperCase()}function Fre(e){const t=String(e||"").trim().toUpperCase();return t==="THEORY"?"THEORY":t==="LAB"?"LAB":t==="TCPL"?"TCPL":t==="TCPR"?"TCPR":t==="PRACTICAL"?"PRACTICAL":t==="PROJECT"?"PROJECT":t==="AUDIT"?"AUDIT":t==="SPECIAL"?"SPECIAL":"THEORY"}function Bre(e,t){const r=String(e||"").trim(),n=String(t||"").trim();return!r||!n?null:`${r}T${n}:00`}function B4(e){const t=new Set,r=[];for(const n of e)t.has(n)||(t.add(n),r.push(n));return r}function Ire(e){const{controls:t,subjectCodes:r,assessments:n}=e;if(!r.length||!n.length)return"MIXED";const i=new Map;for(const l of t||[]){const c=String(l.subject_code||"").trim(),u=String(l.assessment||"").trim().toLowerCase();!c||!u||i.set(`${c}::${u}`,{is_open:!!l.is_open,is_enabled:!!l.is_enabled})}let s=0,o=0;for(const l of r)for(const c of n){const u=`${l}::${String(c).toLowerCase()}`,d=i.get(u);(d?!!d.is_open:!0)?s+=1:o+=1}return s>0&&o>0?"MIXED":o>0?"READONLY":"EDITABLE"}function k3(){const[e,t]=x.useState([]),[r,n]=x.useState(1),[i,s]=x.useState({}),[o,l]=x.useState([]),[c,u]=x.useState([]),[d,f]=x.useState([]),[h,p]=x.useState([]),[m,g]=x.useState("THEORY"),[y,b]=x.useState([]),[v,w]=x.useState(""),[S,j]=x.useState(""),[k,A]=x.useState(!1),[R,M]=x.useState(null),[B,E]=x.useState(null),P=x.useCallback(re=>({padding:"8px 12px",borderRadius:8,border:re?"1px solid #10b981":"1px solid #e5e7eb",background:re?"#ecfdf5":"#fff",fontWeight:700,cursor:"pointer",whiteSpace:"nowrap"}),[]);x.useEffect(()=>{let re=!0;return(async()=>{try{const T=await p9(),I=Array.isArray(T==null?void 0:T.results)?T.results:[];if(!re)return;const ie=I.map(D=>({id:Number(D.id),number:(D==null?void 0:D.number)===null||typeof(D==null?void 0:D.number)>"u"?null:Number(D.number)})).filter(D=>Number.isFinite(D.id));ie.sort((D,Z)=>Number(D.number??9999)-Number(Z.number??9999)||D.id-Z.id),t(ie)}catch(T){if(!re)return;E((T==null?void 0:T.message)||"Failed to load semesters")}})(),()=>{re=!1}},[]);const U=x.useMemo(()=>{const re=new Map;for(const T of e){const I=T.number;typeof I=="number"&&Number.isFinite(I)&&re.set(I,T.id)}return re},[e]),G=U.get(r)??null,H=x.useMemo(()=>{const re=[];for(const T of X8){const I=U.get(T);I&&re.push(I)}return re},[U]);x.useEffect(()=>{let re=!0;return(async()=>{try{if(!H.length)return;const T=await fx(H,Tu);if(!re)return;p(Array.isArray(T==null?void 0:T.results)?T.results:[])}catch{}})(),()=>{re=!1}},[H.join(",")]);const oe=x.useCallback(async()=>{A(!0),M(null),E(null);try{if(!G){s({}),l([]),u([]),f([]),M(`Semester ${r} is not available in the database.`);return}const[re,T,I,ie]=await Promise.all([m9([G]),R4([G]),Uv([G]),fx([G],Tu)]),D=(re==null?void 0:re.subjects_by_semester)||{},Z=Array.isArray(T==null?void 0:T.results)?T.results:[];s(D),l(Z),u(Array.isArray(I==null?void 0:I.results)?I.results:[]),f(Array.isArray(ie==null?void 0:ie.results)?ie.results:[])}catch(re){E((re==null?void 0:re.message)||"Failed to load semester data")}finally{A(!1)}},[G,r,m]);x.useEffect(()=>{oe()},[oe]);const de=x.useMemo(()=>{if(!G)return[];const re=(i==null?void 0:i[String(G)])||[];return(Array.isArray(re)?re:[]).filter(T=>T&&T.subject_code)},[i,G]),W=x.useMemo(()=>Ere.slice(),[]);x.useEffect(()=>{W.includes(m)||g(W[0]||"THEORY")},[W.join("|")]);const V=x.useMemo(()=>de.filter(re=>Fre(re==null?void 0:re.class_type)===m),[de,m]),ae=x.useMemo(()=>B4(V.map(re=>String(re.subject_code||"").trim()).filter(Boolean)),[V]),ee=x.useMemo(()=>B4(de.map(re=>String(re.subject_code||"").trim()).filter(Boolean)),[de]),C=x.useMemo(()=>Rre(m,V),[m,V]);x.useEffect(()=>{var Z;const re=C;if(!re.length){b([]);return}if(!G){b(re);return}const T=new Set(ae),I=new Map;for(const me of c||[]){const Te=String(me.subject_code||"").trim();if(!T.has(Te))continue;const je=String(me.assessment||"").trim().toLowerCase();je&&I.set(je,!!me.is_enabled)}const ie=new Set;for(const me of o||[])me!=null&&me.is_active&&(!((Z=me==null?void 0:me.semester)!=null&&Z.id)||Number(me.semester.id)!==Number(G)||T.has(String(me.subject_code||"").trim())&&ie.add(String(me.assessment||"").trim().toLowerCase()));const D=re.filter(me=>{const Te=String(me).toLowerCase();return I.has(Te)?!!I.get(Te):ie.has(Te)});b(D)},[G,m,c,o,C,ae]);const Y=x.useMemo(()=>Ire({controls:c,subjectCodes:ae,assessments:y}),[c,ae,y]),q=x.useMemo(()=>G?J8({controls:d,semesterIds:[G],assessments:Tu}):"MIXED",[d,G]),O=x.useMemo(()=>H.length?J8({controls:h,semesterIds:H,assessments:Tu}):"MIXED",[h,H.join(",")]),X=x.useCallback(async(re,T)=>{A(!0),M(null),E(null);try{const I=T==="ALL"?H:G?[G]:[];if(!I.length)throw new Error("No semester ids available for this action.");if(re==="ON"?await h9({semester_ids:I,assessments:Tu}):re==="OFF"?await M4({semester_ids:I,assessments:Tu,is_open:!1}):await M4({semester_ids:I,assessments:Tu,is_open:!0}),G){const ie=await fx([G],Tu);f(Array.isArray(ie==null?void 0:ie.results)?ie.results:[])}if(H.length){const ie=await fx(H,Tu);p(Array.isArray(ie==null?void 0:ie.results)?ie.results:[])}M(`${T==="ALL"?"All Semesters":`SEM ${r}`}: Publish set to ${re==="ON"?"On (Timed)":re==="OFF"?"Off (Locked)":"Unlimited (No Time Limit)"}.`)}catch(I){E((I==null?void 0:I.message)||"Publish toggle failed")}finally{A(!1)}},[H,G,r]),F=x.useCallback(async re=>{const T=!y.includes(re),I=y;b(ie=>T?[...ie,re]:ie.filter(D=>D!==re)),A(!0),M(null),E(null);try{if(!G)throw new Error(`Semester ${r} is not available in the database.`);if(!ae.length)throw new Error(`No courses found for SEM ${r} (${Af[m]}).`);await L4({semester_id:G,subject_codes:ae,assessments:[re],is_enabled:T}),T||await x9({semester_id:G,subject_codes:ae,assessments:[re]});const[ie,D]=await Promise.all([Uv([G]),R4([G])]);u(Array.isArray(ie==null?void 0:ie.results)?ie.results:[]),l(Array.isArray(D==null?void 0:D.results)?D.results:[]),M(`SEM ${r}  ${Af[m]}: ${Z8(m,re)} ${T?"enabled":"disabled"}.`)}catch(ie){b(I),E((ie==null?void 0:ie.message)||"Update failed")}finally{A(!1)}},[y,G,r,m,ae]),Q=x.useCallback(async()=>{A(!0),M(null),E(null);try{if(!G)throw new Error(`Semester ${r} is not available in the database.`);if(!ee.length)throw new Error(`No courses found for SEM ${r}.`);if(q!=="ON")throw new Error(q==="OFF"?"Publish is OFF (Locked). Set Publish to ON to use a timer.":q==="UNLIMITED"?"Publish is UNLIMITED (No Time Limit). Set Publish to ON to use a due-date timer.":"Publish mode is MIXED. Set a single Publish mode first.");const re=Bre(v,S);if(!re)throw new Error("Select Due Date and Due Time");await g9({semester_id:G,subject_codes:ee,assessments:Tu,due_at:re}),M(`SEM ${r}: Timer applied to all class types.`),await oe()}catch(re){E((re==null?void 0:re.message)||"Save failed")}finally{A(!1)}},[G,r,ee,v,S,oe,q]),K=x.useCallback(async re=>{A(!0),M(null),E(null);try{if(!G)throw new Error(`Semester ${r} is not available in the database.`);if(!y.length)throw new Error("Select at least one exam/assessment");if(!ae.length)throw new Error(`No courses found for SEM ${r} (${Af[m]}).`);await L4({semester_id:G,subject_codes:ae,assessments:y,is_open:re});const T=await Uv([G]);u(Array.isArray(T==null?void 0:T.results)?T.results:[]),M(`SEM ${r}  ${Af[m]}: ${re?"Editable":"Read-only"}`)}catch(T){E((T==null?void 0:T.message)||"Lock toggle failed")}finally{A(!1)}},[G,r,y,m,ae]),ne=re=>{const T=re==="THIS"?q:O,I=re==="THIS"&&O==="OFF",ie=k||re==="ALL"&&!H.length||I;return a.jsxs("div",{className:`pub3${ie?" pub3--disabled":""}`,title:I?"Locked by Common Publish (Off)":void 0,children:[a.jsx("button",{className:`pub3__btn pub3__btn--off${T==="OFF"?" pub3__btn--active":""}`,onClick:()=>void X("OFF",re),disabled:ie,children:"Off"}),a.jsx("button",{className:`pub3__btn pub3__btn--on${T==="ON"?" pub3__btn--active":""}`,onClick:()=>void X("ON",re),disabled:ie,children:"On"}),a.jsx("button",{className:`pub3__btn pub3__btn--unlimited${T==="UNLIMITED"?" pub3__btn--active":""}`,onClick:()=>void X("UNLIMITED",re),disabled:ie,children:"Unlimited"})]})};return a.jsxs("main",{style:{padding:0,fontFamily:"Arial, sans-serif",minHeight:"100vh",background:"#f3f4f6"},children:[a.jsx("style",{children:`
        /*  Neon 3-state publish switch  */
        .pub3 {
          display: inline-flex;
          border-radius: 999px;
          background: #0f172a;
          padding: 4px;
          gap: 3px;
          box-shadow: 0 0 0 1px #1e293b, 0 4px 12px rgba(0,0,0,0.55);
        }
        .pub3--disabled { opacity: 0.4; pointer-events: none; }
        .pub3__btn {
          padding: 8px 18px;
          border-radius: 999px;
          border: none;
          font-weight: 900;
          font-size: 13px;
          cursor: pointer;
          background: transparent;
          color: #64748b;
          transition: background 0.35s cubic-bezier(0.65,0,0.35,1),
                      color 0.35s cubic-bezier(0.65,0,0.35,1),
                      box-shadow 0.35s cubic-bezier(0.65,0,0.35,1);
          letter-spacing: 0.02em;
          min-width: 64px;
        }
        .pub3__btn:disabled { cursor: not-allowed; }
        .pub3__btn--off.pub3__btn--active {
          background: #450a0a;
          color: #fca5a5;
          box-shadow: 0 0 6px #ef4444, 0 0 18px #ef444455, inset 0 0 8px #ef444418;
        }
        .pub3__btn--on.pub3__btn--active {
          background: #052e16;
          color: #86efac;
          box-shadow: 0 0 6px #22c55e, 0 0 18px #22c55e55, inset 0 0 8px #22c55e18;
        }
        .pub3__btn--unlimited.pub3__btn--active {
          background: #1e3a8a;
          color: #93c5fd;
          box-shadow: 0 0 6px #3b82f6, 0 0 18px #3b82f655, inset 0 0 8px #3b82f618;
        }
      `}),a.jsxs("div",{style:{padding:20,maxWidth:1100,margin:"0 auto"},children:[a.jsx("div",{className:"welcome",style:{marginBottom:18},children:a.jsxs("div",{className:"welcome-left",children:[a.jsx("h2",{className:"welcome-title",style:{fontSize:22,marginBottom:2},children:"OBE Master  Lock & Timer Controls"}),a.jsx("div",{className:"welcome-sub",children:"Common Publish  Semester  Publish & Timer  Class Type  Exams"})]})}),B&&a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:12,whiteSpace:"pre-wrap"},children:B}),R&&a.jsx("div",{style:{background:"#ecfdf5",border:"1px solid #10b98133",color:"#065f46",padding:10,borderRadius:10,marginBottom:12,whiteSpace:"pre-wrap"},children:R}),a.jsxs("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:14,padding:"16px 20px",marginBottom:16,display:"flex",alignItems:"center",gap:20,flexWrap:"wrap"},children:[a.jsxs("div",{style:{flex:"0 0 auto"},children:[a.jsx("div",{style:{fontWeight:900,fontSize:14,marginBottom:4,color:"#111827"},children:"Common Publish  All Semesters"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Applies the same publish mode to every semester at once."})]}),a.jsxs("div",{style:{flex:"1 1 auto",display:"flex",alignItems:"center",gap:14,flexWrap:"wrap"},children:[ne("ALL"),a.jsx("span",{style:{fontSize:13,fontWeight:700,color:O==="OFF"?"#991b1b":O==="ON"?"#065f46":O==="UNLIMITED"?"#1e40af":"#6b7280"},children:O==="OFF"?"All Locked":O==="ON"?"All Timer-based":O==="UNLIMITED"?"All Unlimited":"Mixed"})]})]}),a.jsxs("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:14,padding:"14px 18px",marginBottom:0,borderBottomLeftRadius:0,borderBottomRightRadius:0,borderBottom:"2px solid #10b981"},children:[a.jsx("div",{style:{fontWeight:900,fontSize:12,color:"#6b7280",marginBottom:10,textTransform:"uppercase",letterSpacing:1},children:"Select Semester"}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:X8.map(re=>a.jsxs("button",{disabled:k,onClick:()=>n(re),style:P(re===r),children:["SEM ",re]},re))})]}),a.jsxs("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderTop:0,borderRadius:14,borderTopLeftRadius:0,borderTopRightRadius:0,padding:"18px 20px",marginBottom:16},children:[a.jsxs("div",{style:{display:"flex",gap:18,alignItems:"center",flexWrap:"wrap",marginBottom:18,paddingBottom:16,borderBottom:"1px solid #f3f4f6"},children:[a.jsxs("div",{style:{flex:"0 0 auto"},children:[a.jsxs("div",{style:{fontWeight:900,fontSize:13,marginBottom:6,color:"#111827"},children:["Publish  SEM ",r]}),ne("THIS")]}),O==="OFF"?a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"10px 16px",borderRadius:10,background:"#fef2f2",border:"1px solid #fecaca",color:"#991b1b",fontWeight:800,fontSize:13},children:[a.jsx("span",{style:{fontSize:16},children:""})," Locked  Common Publish is Off"]}):q==="ON"?a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap",flex:"1 1 auto"},children:[a.jsx("input",{type:"date",value:v,onChange:re=>w(re.target.value),disabled:k,style:{padding:"8px 10px",borderRadius:8,border:"1px solid #e5e7eb",fontSize:13}}),a.jsx("input",{type:"time",value:S,onChange:re=>j(re.target.value),disabled:k,style:{padding:"8px 10px",borderRadius:8,border:"1px solid #e5e7eb",fontSize:13}}),a.jsx("button",{onClick:()=>void Q(),disabled:k,className:"obe-btn obe-btn-primary",style:{padding:"9px 16px",borderRadius:8,fontWeight:900,fontSize:13},children:k?"Saving":`Apply Timer  SEM ${r}`}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["All ",ee.length," subjects  all class types"]})]}):q==="UNLIMITED"?a.jsx("div",{style:{padding:"10px 16px",borderRadius:10,background:"#eff6ff",color:"#1e40af",fontWeight:800,border:"1px solid #bfdbfe",fontSize:13},children:" No Time Limit  always open"}):q==="OFF"?a.jsx("div",{style:{padding:"10px 16px",borderRadius:10,background:"#fef2f2",color:"#991b1b",fontWeight:800,border:"1px solid #fecaca",fontSize:13},children:" This semester locked"}):null]}),a.jsxs("div",{style:{marginBottom:14},children:[a.jsx("div",{style:{fontWeight:900,fontSize:12,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:1},children:"Class Type"}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:W.map(re=>a.jsx("button",{disabled:k,onClick:()=>g(re),style:P(re===m),children:Af[re]},re))}),a.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:[V.length," course",V.length!==1?"s":""," in SEM ",r,"  ",Af[m]]})]}),a.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:"14px 16px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12,flexWrap:"wrap",gap:8},children:[a.jsxs("div",{style:{fontWeight:900,fontSize:14,color:"#111827"},children:["SEM ",r,"  ",Af[m]," Exams"]}),a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Mark Entry Mode:"}),a.jsxs("div",{style:{display:"inline-flex",border:"1px solid #e5e7eb",borderRadius:999,overflow:"hidden",background:"#fff"},children:[a.jsx("button",{onClick:()=>void K(!1),disabled:k||!y.length,style:{padding:"7px 14px",fontWeight:900,border:0,cursor:"pointer",fontSize:13,background:Y==="READONLY"?"#fee2e2":"#fff",color:Y==="READONLY"?"#991b1b":"#374151",minWidth:100},children:"Read-only"}),a.jsx("button",{onClick:()=>void K(!0),disabled:k||!y.length,style:{padding:"7px 14px",fontWeight:900,border:0,cursor:"pointer",fontSize:13,background:Y==="EDITABLE"?"#dcfce7":"#fff",color:Y==="EDITABLE"?"#065f46":"#374151",minWidth:90},children:"Editable"})]})]})]}),C.length?a.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:10},children:C.map(re=>a.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center",fontSize:13,padding:"8px 14px",borderRadius:10,border:`2px solid ${y.includes(re)?"#10b981":"#e5e7eb"}`,background:y.includes(re)?"#ecfdf5":"#fff",color:y.includes(re)?"#065f46":"#374151",cursor:"pointer",userSelect:"none",fontWeight:700},children:[a.jsx("input",{type:"checkbox",checked:y.includes(re),onChange:()=>void F(re),disabled:k,style:{accentColor:"#10b981",width:15,height:15}}),Z8(m,re)]},re))}):a.jsxs("div",{style:{color:"#6b7280",fontSize:13,padding:"8px 0"},children:["No exams configured for ",Af[m],"."]}),a.jsx("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:"Uncheck an exam to hide it from staff (message-only). Selected exams also control the Mark Entry Mode lever above."})]})]})]})]})}const cf="https://db.krgi.co.in";async function Yd(){const e=await mr(`${cf}/api/curriculum/master/`);if(!e.ok)throw new Error("Failed to fetch masters");return e.json()}async function Dre(e){const t=await mr(`${cf}/api/curriculum/master/`,{method:"POST",body:JSON.stringify(e)});if(!t.ok)throw new Error(await t.text());return t.json()}async function $re(e,t){const r=await mr(`${cf}/api/curriculum/master/${e}/`,{method:"PATCH",body:JSON.stringify(t)});try{if(!r.ok){const n=r.headers.get("content-type");if(n&&n.includes("application/json")){const i=await r.json();throw new Error(i.detail||"An error occurred")}else throw new Error(await r.text())}return r.json()}catch(n){throw console.error("Error in updateMaster:",n),n}}async function Sl(){const e=await mr(`${cf}/api/curriculum/department/`);if(!e.ok)throw new Error("Failed to fetch dept rows");return e.json()}async function A3(e){const t=await mr(`${cf}/api/curriculum/department/${encodeURIComponent(String(e))}/`);if(!t.ok)throw new Error("Failed to fetch dept row");return t.json()}async function pm(e){const t=new URLSearchParams;e!=null&&e.department_id&&t.set("department_id",String(e.department_id)),e!=null&&e.regulation&&t.set("regulation",e.regulation),e!=null&&e.semester&&t.set("semester",String(e.semester));const r=`${cf}/api/curriculum/elective/?${t.toString()}`,n=await mr(r);if(!n.ok)throw new Error("Failed to fetch electives");return n.json()}async function Ure(e){const t=await mr(`${cf}/api/curriculum/elective/`,{method:"POST",body:JSON.stringify(e)});if(!t.ok)throw new Error(await t.text());return t.json()}async function zre(e,t){const r=await mr(`${cf}/api/curriculum/department/${e}/`,{method:"PATCH",body:JSON.stringify(t)});if(!r.ok)throw new Error(await r.text());return r.json()}async function Wre(e,t){const r=await mr(`${cf}/api/curriculum/department/${e}/approve/`,{method:"POST",body:JSON.stringify({action:t})});if(!r.ok)throw new Error(await r.text());return r.json()}function qg(e){return String(e||"").trim()}function qre(){const e=vo(),[t,r]=x.useState([]),[n,i]=x.useState(!0),[s,o]=x.useState(null),[l,c]=x.useState("");x.useEffect(()=>{let f=!0;return(async()=>{try{const h=await Sl();if(!f)return;r(Array.isArray(h)?h:[]),o(null)}catch(h){if(!f)return;r([]),o((h==null?void 0:h.message)||"Failed to load courses")}finally{f&&i(!1)}})(),()=>{f=!1}},[]);const u=x.useMemo(()=>{const f=new Map;for(const h of t||[]){const p=qg(h.course_code);if(!p)continue;const m={course_code:p,course_name:qg(h.course_name),class_type:qg(h.class_type)||null,question_paper_type:qg(h.question_paper_type)||null},g=f.get(p);if(!g){f.set(p,m);continue}const y=b=>(b.course_name?1:0)+(b.class_type?1:0)+(b.question_paper_type?1:0)+(String(b.question_paper_type||"").trim().toUpperCase()&&String(b.question_paper_type||"").trim().toUpperCase()!=="QP1"?1:0);y(m)>y(g)&&f.set(p,m)}return Array.from(f.values()).sort((h,p)=>h.course_code.localeCompare(p.course_code))},[t]),d=x.useMemo(()=>{const f=qg(l).toLowerCase();return f?u.filter(h=>`${h.course_code} ${h.course_name}`.toLowerCase().includes(f)):u},[u,l]);return n?a.jsx("div",{style:{color:"#6b7280"},children:"Loading courses"}):s?a.jsx("div",{style:{color:"#b91c1c"},children:s}):a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,alignItems:"flex-end",flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:16,fontWeight:800,color:"#0f172a"},children:"Courses"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Search and open a course to view sections and staff mappings."})]}),a.jsxs("div",{style:{minWidth:280},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Search"}),a.jsx("input",{value:l,onChange:f=>c(f.target.value),placeholder:"Course code or name",className:"obe-input"})]})]}),d.length===0?a.jsx("div",{style:{color:"#6b7280"},children:"No courses found."}):a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(260px, 1fr))",gap:12},children:d.map(f=>a.jsxs("div",{className:"obe-card",style:{display:"flex",flexDirection:"column",gap:8},children:[a.jsx("div",{style:{fontWeight:900,color:"#0f172a"},children:f.course_code}),a.jsx("div",{style:{color:"#374151",fontWeight:700},children:f.course_name||""}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[f.class_type?`Class type: ${f.class_type}`:"",f.question_paper_type?`    QP: ${f.question_paper_type}`:""]}),a.jsx("div",{style:{marginTop:6},children:a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:()=>e(`/iqac/academic-controller/course/${encodeURIComponent(f.course_code)}`),children:"Open"})})]},f.course_code))})]})}function Hre(){var e;if(typeof window<"u"&&((e=window.location)!=null&&e.origin)){const t=String(window.location.hostname||"").trim().toLowerCase();return t==="localhost"||t==="127.0.0.1"?"http://localhost:8000":String(window.location.origin).replace(/\/+$/,"")}return"https://db.krgi.co.in"}const q0=Hre(),O2="obe_assessment_master_config_cache";async function H0(e,t){const r=e.headers.get("content-type")||"";try{if(r.includes("application/json")){const s=await e.json(),o=(s==null?void 0:s.detail)||(s==null?void 0:s.message);if(o)return`${t}: ${o}`}}catch{}if(e.status===401)return`${t}: Authentication required. Please login.`;if(e.status===403)return`${t}: Permission required.`;if(e.status===404)return`${t}: No CDAP found for this course yet. Upload the Excel to create one.`;let n="";try{n=await e.text()}catch{}const i=(n||"").trim();return i&&!i.startsWith("<")?`${t}: ${i}`:`${t}: Server returned ${e.status}.`}async function D9(e,t){const r=typeof t=="number"?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${q0}/api/obe/cdap-revision/${encodeURIComponent(e)}${r}`,i=await mr(n,{method:"GET"});if(!i.ok){const s=await H0(i,"CDAP revision fetch failed");throw new Error(s)}return i.json()}async function I4(e,t){const r=typeof t=="number"?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${q0}/api/obe/articulation-matrix/${encodeURIComponent(e)}${r}`,i=await mr(n,{method:"GET"});if(!i.ok){const s=await H0(i,"Articulation Matrix fetch failed");throw new Error(s)}return i.json()}async function $9(e){const t=(e==null?void 0:e.subjectId)||(e==null?void 0:e.subject_id);if(!t)throw new Error("subjectId is required to save CDAP revision");const r=e==null?void 0:e.teaching_assignment_id,n=typeof r=="number"?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${q0}/api/obe/cdap-revision/${encodeURIComponent(t)}${n}`,s=await mr(i,{method:"PUT",body:JSON.stringify(e)});if(!s.ok){const o=await H0(s,"CDAP revision save failed");throw new Error(o)}return s.json()}async function N3(){const e=`${q0}/api/obe/active-learning-mapping`,t=await mr(e,{method:"GET"});if(!t.ok){try{const i=window.localStorage.getItem(O2);if(i){const s=JSON.parse(i);if(s&&typeof s=="object")return s}}catch{}const n=await H0(t,"Active learning mapping fetch failed");throw new Error(n)}const r=await t.json();return(r==null?void 0:r.mapping)||{}}async function U9(e){const t=`${q0}/api/obe/active-learning-mapping`,r=await mr(t,{method:"PUT",body:JSON.stringify({mapping:e})});if(!r.ok){const i=await H0(r,"Active learning mapping save failed");throw new Error(i)}const n=await r.json();return(n==null?void 0:n.mapping)||{}}async function oc(){const e=`${q0}/api/obe/assessment-master-config`,t=await mr(e,{method:"GET"});if(!t.ok){try{const s=window.localStorage.getItem(O2);if(s){const o=JSON.parse(s);if(o&&typeof o=="object")return o}}catch{}const i=await H0(t,"Assessment master config fetch failed");throw new Error(i)}const r=await t.json(),n=(r==null?void 0:r.config)||{};try{window.localStorage.setItem(O2,JSON.stringify(n))}catch{}return n}async function z9(e){const t=`${q0}/api/obe/assessment-master-config`,r=await mr(t,{method:"PUT",body:JSON.stringify({config:e})});if(!r.ok){const s=await H0(r,"Assessment master config save failed");throw new Error(s)}const n=await r.json(),i=(n==null?void 0:n.config)||{};try{window.localStorage.setItem(O2,JSON.stringify(i))}catch{}return i}function Vre(e,t=3e4){const r=window.setInterval(()=>e(),t);return()=>window.clearInterval(r)}function Gre(){var q;const e=x.useMemo(()=>[{key:"THEORY_QP1",label:"Theory QP 1",class_type:"THEORY",question_paper_type:"QP1"},{key:"THEORY_QP2",label:"Theory QP 2",class_type:"THEORY",question_paper_type:"QP2"},{key:"TCPR",label:"TCPR",class_type:"TCPR"},{key:"TCPL",label:"TCPL",class_type:"TCPL"},{key:"LAB",label:"LAB",class_type:"LAB"}],[]),[t,r]=x.useState(((q=e[0])==null?void 0:q.key)||""),n=x.useMemo(()=>e.find(O=>O.key===t)||null,[e,t]),[i,s]=x.useState("CIA1"),o=(n==null?void 0:n.class_type)==="TCPR"||(n==null?void 0:n.class_type)==="TCPL",[l,c]=x.useState("review1"),[u,d]=x.useState({}),[f,h]=x.useState(!1),[p,m]=x.useState(!1),[g,y]=x.useState(null),[b,v]=x.useState(null),[w,S]=x.useState([]),[j,k]=x.useState(null),[A,R]=x.useState(null),[M,B]=x.useState(!1),[E,P]=x.useState(!1),[U,G]=x.useState(null),H=x.useMemo(()=>{const O=(n==null?void 0:n.class_type)||"THEORY",X=(n==null?void 0:n.question_paper_type)||null;return{class_type:O,question_paper_type:X,exam:i}},[n,i]);x.useEffect(()=>{let O=!1;async function X(){var F,Q;k(null),R(null),B(!0),G(null);try{const K=await sh(H);if(O)return;const ne=Array.isArray((F=K==null?void 0:K.pattern)==null?void 0:F.marks)?K.pattern.marks:[],re=Array.isArray((Q=K==null?void 0:K.pattern)==null?void 0:Q.cos)?K.pattern.cos:[],T=ne.map((I,ie)=>({marks:String(I),co:re[ie]==null?"":String(re[ie])}));S(T),G((K==null?void 0:K.updated_at)??null)}catch(K){if(O)return;R(String((K==null?void 0:K.message)||K||"Failed to load pattern.")),S([])}finally{O||B(!1)}}return X(),()=>{O=!0}},[H]),x.useEffect(()=>{let O=!1;if(o)return(async()=>{h(!0),y(null),v(null);try{const X=await oc();if(O)return;const F=X==null?void 0:X.review_config;d(F&&typeof F=="object"?F:{})}catch(X){if(O)return;v(String((X==null?void 0:X.message)||X||"Failed to load review config."))}finally{O||h(!1)}})(),()=>{O=!0}},[o,n==null?void 0:n.class_type]);const oe=x.useMemo(()=>{const O=n==null?void 0:n.class_type,F=O&&(u||{})[O]||{};return F&&F[l]||{}},[u,n==null?void 0:n.class_type,l]),de=O=>{const X=n==null?void 0:n.class_type;if(!X)return;const F=O===""?void 0:Number(O);d(Q=>{const K={...Q||{}},ne={...K[X]||{}},re={...ne[l]||{}};return re.cia_max=Number.isFinite(F)?Math.max(0,Math.trunc(F)):void 0,ne[l]=re,K[X]=ne,K})},W=async()=>{y(null),v(null);try{m(!0);const X={...await oc()||{},review_config:u||{}};await z9(X),y("Review config saved.")}catch(O){v(String((O==null?void 0:O.message)||O||"Save failed."))}finally{m(!1)}},V=()=>{S(O=>[...O,{marks:"",co:i==="CIA2"?"3":"1"}])},ae=O=>{S(X=>X.filter((F,Q)=>Q!==O))},ee=(O,X)=>{S(F=>{const Q=[...F],K=Q[O]||{marks:"",co:""};return Q[O]={...K,marks:X},Q})},C=(O,X)=>{S(F=>{const Q=[...F],K=Q[O]||{marks:"",co:""};return Q[O]={...K,co:X},Q})},Y=async()=>{k(null),R(null);try{const O=w.map(ne=>({marks:String(ne.marks??"").trim(),co:String((ne==null?void 0:ne.co)??"").trim()}));if(O.length&&O.some(ne=>!ne.marks||!ne.co)){R("Enter marks and CO for all rows (or delete empty rows).");return}for(const ne of O){const re=Number(ne.marks);if(!Number.isFinite(re)||re<0){R("Marks must be a non-negative number.");return}}const X=ne=>{const re=String(ne||"").trim();if(!re)return"";if(re==="both")return"both";if(re==="1&2")return 12;if(re==="3&4")return 34;const T=Number(re);return Number.isFinite(T)?Math.trunc(T):""};P(!0);const F=O.map(ne=>Number(ne.marks)),Q=O.map(ne=>X(ne.co)).filter(ne=>ne!=="");if(Q.length!==F.length){R("CO values must be valid for all rows.");return}const K=await b9({class_type:H.class_type,question_paper_type:H.question_paper_type,exam:H.exam,pattern:{marks:F,cos:Q}});G((K==null?void 0:K.updated_at)??null),k("Saved.")}catch(O){R((O==null?void 0:O.message)||"Save failed.")}finally{P(!1)}};return a.jsxs("div",{children:[a.jsxs("div",{style:{marginBottom:12},children:[a.jsx("div",{style:{fontSize:16,fontWeight:800,color:"#0f172a"},children:"QP"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Select the QP/class type option."})]}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:12},children:e.map(O=>{const X=O.key===t;return a.jsx("button",{onClick:()=>r(O.key),className:X?"obe-btn obe-btn-primary":"obe-btn obe-btn-secondary",type:"button",children:O.label},O.key)})}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:12},children:["CIA1","CIA2","MODEL"].map(O=>{const X=i===O;return a.jsx("button",{onClick:()=>s(O),className:X?"obe-btn obe-btn-primary":"obe-btn obe-btn-secondary",type:"button",children:O==="CIA1"?"CIA 1":O==="CIA2"?"CIA 2":"MODEL"},O)})}),n?a.jsxs("div",{className:"obe-card",style:{padding:12},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",fontWeight:800,marginBottom:6},children:"Selected"}),a.jsx("div",{style:{fontWeight:900,color:"#111827"},children:n.label}),a.jsxs("div",{style:{marginTop:6,fontSize:13,color:"#374151"},children:["Class type: ",a.jsx("strong",{children:n.class_type}),n.question_paper_type?a.jsxs(a.Fragment,{children:[" "," QP: ",a.jsx("strong",{children:n.question_paper_type})]}):null," "," Exam: ",a.jsx("strong",{children:i==="CIA1"?"CIA 1":i==="CIA2"?"CIA 2":"MODEL"})]}),M?a.jsx("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:"Loading saved pattern"}):U?a.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:["Last saved: ",new Date(U).toLocaleString()]}):null]}):null,a.jsxs("div",{className:"obe-card",style:{padding:12,marginTop:12},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,alignItems:"baseline",flexWrap:"wrap",marginBottom:10},children:[a.jsx("div",{style:{fontWeight:900,color:"#111827"},children:"QP Pattern"}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[i==="CIA1"?"CIA 1":i==="CIA2"?"CIA 2":"MODEL","  ",(n==null?void 0:n.label)||t]})]}),A?a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10},children:A}):null,j?a.jsx("div",{style:{background:"#ecfdf5",border:"1px solid #10b98133",color:"#065f46",padding:10,borderRadius:10,marginBottom:10},children:j}):null,a.jsx("div",{style:{overflowX:"auto"},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{textAlign:"left",fontSize:12,color:"#6b7280",padding:"8px 6px",borderBottom:"1px solid #e5e7eb"},children:"S.No"}),a.jsx("th",{style:{textAlign:"left",fontSize:12,color:"#6b7280",padding:"8px 6px",borderBottom:"1px solid #e5e7eb"},children:"Marks"}),a.jsx("th",{style:{textAlign:"left",fontSize:12,color:"#6b7280",padding:"8px 6px",borderBottom:"1px solid #e5e7eb"},children:"CO"}),a.jsx("th",{style:{width:120,borderBottom:"1px solid #e5e7eb"}})]})}),a.jsx("tbody",{children:w.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:4,style:{padding:10,color:"#6b7280"},children:"No questions yet. Click + to add."})}):w.map((O,X)=>a.jsxs("tr",{children:[a.jsx("td",{style:{padding:"8px 6px",borderBottom:"1px solid #f3f4f6",fontWeight:800},children:X+1}),a.jsx("td",{style:{padding:"8px 6px",borderBottom:"1px solid #f3f4f6"},children:a.jsx("input",{className:"obe-input",type:"number",min:0,step:"0.5",value:O.marks,onChange:F=>ee(X,F.target.value),placeholder:"Marks",style:{maxWidth:160}})}),a.jsx("td",{style:{padding:"8px 6px",borderBottom:"1px solid #f3f4f6"},children:a.jsxs("select",{className:"obe-input",value:String((O==null?void 0:O.co)??""),onChange:F=>C(X,F.target.value),style:{maxWidth:160},children:[a.jsx("option",{value:"",children:"Select"}),i==="MODEL"?a.jsxs(a.Fragment,{children:[a.jsx("option",{value:"1",children:"1"}),a.jsx("option",{value:"2",children:"2"}),a.jsx("option",{value:"3",children:"3"}),a.jsx("option",{value:"4",children:"4"}),a.jsx("option",{value:"5",children:"5"})]}):i==="CIA2"?a.jsxs(a.Fragment,{children:[a.jsx("option",{value:"3",children:"3"}),a.jsx("option",{value:"4",children:"4"}),a.jsx("option",{value:"3&4",children:"3&4"})]}):a.jsxs(a.Fragment,{children:[a.jsx("option",{value:"1",children:"1"}),a.jsx("option",{value:"2",children:"2"}),a.jsx("option",{value:"1&2",children:"1&2"})]})]})}),a.jsx("td",{style:{padding:"8px 6px",borderBottom:"1px solid #f3f4f6"},children:a.jsx("button",{type:"button",className:"obe-btn obe-btn-danger",onClick:()=>ae(X),children:"Delete"})})]},X))})]})}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginTop:12},children:[a.jsx("button",{type:"button",className:"obe-btn obe-btn-secondary",onClick:V,children:"+"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-primary",onClick:Y,disabled:E,children:E?"Saving":"Save"})]})]}),o?a.jsxs("div",{className:"obe-card",style:{padding:12,marginTop:12},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,alignItems:"baseline",flexWrap:"wrap",marginBottom:10},children:[a.jsx("div",{style:{fontWeight:900,color:"#111827"},children:"Review Config"}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[(n==null?void 0:n.label)||t,"  ",l==="review1"?"Review 1":"Review 2"]})]}),b?a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10},children:b}):null,g?a.jsx("div",{style:{background:"#ecfdf5",border:"1px solid #10b98133",color:"#065f46",padding:10,borderRadius:10,marginBottom:10},children:g}):null,a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"end"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",fontWeight:800,marginBottom:6},children:"Exam type"}),a.jsxs("select",{className:"obe-input",value:l,onChange:O=>c(O.target.value),style:{minWidth:160},children:[a.jsx("option",{value:"review1",children:"Review 1"}),a.jsx("option",{value:"review2",children:"Review 2"})]})]}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",fontWeight:800,marginBottom:6},children:"CIA exam max marks"}),a.jsx("input",{className:"obe-input",type:"number",min:0,step:1,value:String((oe==null?void 0:oe.cia_max)??""),onChange:O=>de(O.target.value),placeholder:"e.g. 40",style:{maxWidth:160},disabled:f})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{type:"button",className:"obe-btn obe-btn-secondary",onClick:()=>{y(null),v(null)},disabled:p,children:"Clear message"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-primary",onClick:W,disabled:p||f,children:p?"Saving":"Save Review Config"})]})]})]}):null]})}const em=["Theory","Lab","Tcpl","Tcpr","Practical","Project","Audit","Special"];function ni(e){return String(e??"").trim().toUpperCase()}function C3(e){const t=ni(e);return t?!!(t==="LAB"||t==="L"||t.startsWith("LAB")||t.includes("LAB")||t.includes("PRACTICAL")||t.includes("PRACT")):!1}function Kre(e){return ni(e)==="SPECIAL"}function Zn(e){try{const t=window.localStorage.getItem(e);return t?JSON.parse(t):null}catch{return null}}function Kn(e,t){try{window.localStorage.setItem(e,JSON.stringify(t))}catch{}}function Pu(e){try{window.localStorage.removeItem(e)}catch{}}const Wu=[1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,2,2,2,2,4],Yre=["THEORY","TCPR","TCPL","LAB","AUDIT","PRACTICAL","SPECIAL"],G5=6,Xre=64;function Qre(e){const t=ni(e);return t==="THEORY"?"Theory":t==="TCPL"?"TCPL":t==="TCPR"?"TCPR":t?t.charAt(0).toUpperCase()+t.slice(1).toLowerCase():""}function W9(e){const t=Array.isArray(e)?[...e]:[...Wu];for(;t.length<17;)t.push("");return t.slice(0,17)}function eP(e,t,r,n){const i=Number(e),s=Number(t),o=Number(r),l=Number(n),c=(Number.isFinite(s)?s:0)+(Number.isFinite(o)?o:0)+(Number.isFinite(l)?l:0);if(!Number.isFinite(i)||i<=0||!c)return[0,0,0];const u=Math.round(i*(s||0)/c*100)/100,d=Math.round(i*(o||0)/c*100)/100,f=Math.round(i*(l||0)/c*100)/100;return[u,d,f]}function K5(e,t){let r=Array.isArray(e)?[...e]:[...Wu];if(r.length===13){const[n,i,s]=eP(r[0]??0,(t==null?void 0:t.ssa1)??1.5,(t==null?void 0:t.cia1)??3,(t==null?void 0:t.formative1)??2.5),[o,l,c]=eP(r[1]??0,(t==null?void 0:t.ssa1)??1.5,(t==null?void 0:t.cia1)??3,(t==null?void 0:t.formative1)??2.5);r=[n,i,s,o,l,c,...r.slice(2)]}return r=W9(r),r}function Jre(e){const t=ni(e);if(t==="LAB"||t==="PRACTICAL")return[{header:"CO1",cols:[{label:"CIA 1",index:1}]},{header:"CO2",cols:[{label:"CIA 1",index:4}]},{header:"CO3",cols:[{label:"CIA 2",index:7}]},{header:"CO4",cols:[{label:"CIA 2",index:10}]},{header:"ME",cols:[{label:"MODEL",index:16}]}];const r=o=>t==="TCPR"?o===1||o===2?"Review 1":"Review 2":t==="TCPL"?o===1||o===2?"LAB 1":"LAB 2":o===1||o===2?"Formative 1":"Formative 2",n=o=>o===1||o===2?"CIA 1":"CIA 2",i=o=>o===1||o===2?"SSA 1":"SSA 2",s=(o,l)=>({header:`CO${o}`,cols:[{label:i(o),index:l},{label:n(o),index:l+1},{label:r(o),index:l+2}]});return[s(1,0),s(2,3),s(3,6),s(4,9),{header:"ME",cols:[{label:"CO1",index:12},{label:"CO2",index:13},{label:"CO3",index:14},{label:"CO4",index:15},{label:"CO5",index:16}]}]}function Zre(){const[e,t]=x.useState({}),[r,n]=x.useState(!1),[i,s]=x.useState(!1),[o,l]=x.useState(null),[c,u]=x.useState(null);x.useEffect(()=>{n(!0),l(null),(async()=>{const p=()=>{const g={};for(const y of em){const b=ni(String(y));let v=1.5,w=3,S=2.5;b==="TCPL"?(v=1,w=3.25,S=3.5):b==="TCPR"?(v=1,w=3.25,S=4):b==="LAB"&&(v=1,w=1,S=1);let j=[...Wu];if(b==="THEORY")j=[...Wu];else if(b==="TCPL"){j=[];for(let k=0;k<4;k++)j.push(v,w,S);j.push(3,3,3,3,7)}else if(b==="TCPR"){j=[];for(let k=0;k<4;k++)j.push(v,w,S);j.push(3,3,3,3,10)}g[b]={ssa1:v,cia1:w,formative1:S,internal_mark_weights:j}}return g.THEORY||(g.THEORY={ssa1:1.5,cia1:3,formative1:2.5,internal_mark_weights:[...Wu]}),g},m=g=>{const y=p();if(!g||typeof g!="object")return y;const b={...y},v=Array.from(new Set([...em.map(S=>ni(String(S))),"THEORY"])),w=g.THEORY??g.Theory??g.theory??null;w&&typeof w=="object"&&(g.THEORY=w);for(const S of v){const j=g[S]??g[String(S)]??g[String(S).toUpperCase()]??null;if(!j||typeof j!="object")continue;const k=Array.isArray(j.internal_mark_weights)?j.internal_mark_weights:null,A={ssa1:j.ssa1??b[S].ssa1,cia1:j.cia1??b[S].cia1,formative1:j.formative1??b[S].formative1};b[S]={ssa1:A.ssa1,cia1:A.cia1,formative1:A.formative1,internal_mark_weights:K5(k&&k.length?k:b[S].internal_mark_weights,A)}}return b};try{const y=await(await fm(()=>Promise.resolve().then(()=>Y8),void 0)).fetchClassTypeWeights(),b=m(y);t(b);return}catch{}try{const g=Zn("iqac_class_type_weights"),y=m(g);t(y)}catch{const g=p();t(g)}finally{n(!1)}})().finally(()=>n(!1))},[]);const d=(p,m,g)=>{t(y=>({...y,[p]:{...y[p],[m]:g}}))},f=(p,m,g)=>{t(y=>{const b=y[p]||{ssa1:"",cia1:"",formative1:"",internal_mark_weights:[...Wu]},v=Array.isArray(b.internal_mark_weights)?[...b.internal_mark_weights]:[...Wu];for(;v.length<17;)v.push("");return v[m]=g,{...y,[p]:{...b,internal_mark_weights:v}}})},h=async()=>{s(!0),l(null),u(null);try{const p={},m=Array.from(new Set([...em.map(y=>ni(String(y))),"THEORY"]));for(const y of m){const b=e[y]??e[y.toLowerCase()]??e[y.toUpperCase()]??{},v=K5(Array.isArray(b==null?void 0:b.internal_mark_weights)?b.internal_mark_weights:Wu,{ssa1:b==null?void 0:b.ssa1,cia1:b==null?void 0:b.cia1,formative1:b==null?void 0:b.formative1});p[y]={ssa1:Number(b==null?void 0:b.ssa1)||0,cia1:Number(b==null?void 0:b.cia1)||0,formative1:Number(b==null?void 0:b.formative1)||0,internal_mark_weights:W9(v).map((w,S)=>{const j=Number(w);return Number.isFinite(j)?j:Wu[S]??0})}}p.THEORY||(p.THEORY=p.THEORY||null);let g=!1;try{await(await fm(()=>Promise.resolve().then(()=>Y8),void 0)).upsertClassTypeWeights(p),g=!0}catch{Kn("iqac_class_type_weights",p)}t(p),u(g?"Weights saved to server successfully.":"Saved locally (backend not reachable).")}catch(p){l((p==null?void 0:p.message)||"Failed to save weights")}finally{s(!1)}};return a.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",padding:24},children:[a.jsx("h2",{children:"Class Type Weights"}),a.jsx("p",{children:"Set the weights for each class type. These weights are IQAC-controlled and are not editable by staff."}),r?a.jsx("div",{children:"Loading..."}):a.jsxs("form",{onSubmit:p=>{p.preventDefault(),h()},children:[a.jsxs("div",{style:{marginBottom:16},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"CO Attainment Weights"}),a.jsx("div",{style:{color:"#6b7280",fontSize:13},children:"Used in CO Attainment (SSA/CIA/Formative blend)."})]}),a.jsx("div",{style:{overflowX:"auto",marginBottom:24},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{border:"1px solid #ccc",padding:8},children:"Class Type"}),a.jsx("th",{style:{border:"1px solid #ccc",padding:8},children:"SSA1"}),a.jsx("th",{style:{border:"1px solid #ccc",padding:8},children:"CIA1"}),a.jsx("th",{style:{border:"1px solid #ccc",padding:8},children:"Formative1"})]})}),a.jsx("tbody",{children:em.map(p=>{var y,b,v;const m=ni(String(p)),g=String(p).charAt(0).toUpperCase()+String(p).slice(1);return a.jsxs("tr",{children:[a.jsx("td",{style:{border:"1px solid #ccc",padding:8},children:g}),a.jsx("td",{style:{border:"1px solid #ccc",padding:8},children:a.jsx("input",{type:"number",step:"0.1",value:((y=e[m])==null?void 0:y.ssa1)??"",onChange:w=>d(m,"ssa1",w.target.value),required:!0})}),a.jsx("td",{style:{border:"1px solid #ccc",padding:8},children:a.jsx("input",{type:"number",step:"0.1",value:((b=e[m])==null?void 0:b.cia1)??"",onChange:w=>d(m,"cia1",w.target.value),required:!0})}),a.jsxs("td",{style:{border:"1px solid #ccc",padding:8},children:[a.jsx("input",{type:"number",step:"0.1",value:((v=e[m])==null?void 0:v.formative1)??"",onChange:w=>d(m,"formative1",w.target.value),required:!0}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:4},children:m==="TCPL"?"Lab":m==="TCPR"?"Review":"Formative"})]})]},m)})})]})}),a.jsxs("div",{style:{marginBottom:16},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Internal Mark Weightage"}),a.jsx("div",{style:{color:"#6b7280",fontSize:13},children:"Inputs are mapped exactly to class-type exam assignments used in Internal Mark calculation."})]}),a.jsx("div",{style:{marginBottom:24},children:Yre.map(p=>{const m=ni(String(p)),g=e[m],y=K5(Array.isArray(g==null?void 0:g.internal_mark_weights)?g.internal_mark_weights:Wu,g),b=Jre(m),v=b.flatMap(w=>w.cols);return a.jsxs("div",{style:{marginBottom:18,overflowX:"auto"},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:8},children:Qre(m)}),a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:b.map(w=>a.jsx("th",{colSpan:w.cols.length,style:{border:"1px solid #ccc",padding:G5,textAlign:"center",whiteSpace:"nowrap",fontSize:13},children:w.header},w.header))}),a.jsx("tr",{children:v.map(w=>a.jsx("th",{style:{border:"1px solid #ccc",padding:G5,textAlign:"center",whiteSpace:"nowrap",fontSize:12},children:w.label},`${w.label}_${w.index}`))})]}),a.jsx("tbody",{children:a.jsx("tr",{children:v.map(w=>a.jsx("td",{style:{border:"1px solid #ccc",padding:G5,textAlign:"center"},children:a.jsx("input",{type:"number",step:"0.1",value:y[w.index]??"",onChange:S=>f(m,w.index,S.target.value),required:!0,style:{width:Xre}})},w.index))})})]})]},m)})}),a.jsx("button",{type:"submit",disabled:i,style:{padding:"8px 18px",fontWeight:700},children:i?"Saving...":"Save"}),o&&a.jsx("div",{style:{color:"red",marginTop:12},children:o}),c&&a.jsx("div",{style:{color:"green",marginTop:12},children:c})]})]})}const Y5=[{id:"cia1_co1_co2",label:"CIA 1",cos:["CO1","CO2"],assessment:"cia1"},{id:"cia2_co3_co4",label:"CIA 2",cos:["CO3","CO4"],assessment:"cia2"},{id:"model_co1_co2_co3_co4_co5",label:"MODEL",cos:["CO1","CO2","CO3","CO4","CO5"],assessment:"model"},{id:"model_co3_co4_co5",label:"MODEL",cos:["CO3","CO4","CO5"],assessment:"model"},{id:"model_co5",label:"MODEL",cos:["CO5"],assessment:"model"}];function tP(e){const t=String(e||"").trim().toLowerCase();return t==="cia1_co1_co2"?"cia1_co1_co2":t==="cia2_co3_co4"?"cia2_co3_co4":t==="model_co1_co2_co3_co4_co5"?"model_co1_co2_co3_co4_co5":t==="model_co3_co4_co5"?"model_co3_co4_co5":t==="model_co5"?"model_co5":null}function X5(e){const t=new Set,r={cia1_co1_co2:"CIA 1",cia2_co3_co4:"CIA 2",model_co1_co2_co3_co4_co5:"MODEL",model_co3_co4_co5:"MODEL",model_co5:"MODEL"},n=Array.isArray(e)?e:[];for(const i of n){if(typeof i=="string"){const s=tP(i);s&&t.add(s);continue}if(i&&typeof i=="object"){const s=tP(i.id);if(!s)continue;t.add(s);const o=String(i.name||"").trim();o&&(r[s]=o)}}return{selected:t,names:r}}function ene({isOpen:e,onClose:t,onSave:r,currentSelection:n}){const i=X5(n.options),[s,o]=x.useState(i.selected),[l,c]=x.useState(i.names),[u,d]=x.useState(Number(n.divider)||2),[f,h]=x.useState(Number(n.multiplier)||.15),[p,m]=x.useState("");x.useEffect(()=>{const v=X5(n.options);o(v.selected),c(v.names),d(Number(n.divider)||2),h(Number(n.multiplier)||.15),m("")},[n,e]);const g=v=>{const w=new Set(s);if(w.has(v))w.delete(v),o(w),m("");else{const S=Y5.find(j=>j.id===v);if(S){const j=new Set;w.forEach(R=>{const M=Y5.find(B=>B.id===R);M&&M.cos.forEach(B=>j.add(B))});const A=S.cos.filter(R=>j.has(R));if(A.length>0){m(`Cannot select this option: ${A.join(", ")} already selected in another option. Only one option per CO is allowed.`);return}w.add(v),o(w),m("")}}},y=()=>{const v=Number(u),w=Number(f);if(!Number.isFinite(v)||v<=0){m("Divider must be a number greater than 0.");return}if(!Number.isFinite(w)||w<0){m("Multiplier must be a number greater than or equal to 0.");return}m("");const S=Array.from(s).map(j=>({id:j,name:String((l==null?void 0:l[j])||"").trim()||void 0}));r({options:S,divider:v,multiplier:w}),t()},b=()=>{m("");const v=X5(n.options);o(v.selected),c(v.names),d(Number(n.divider)||2),h(Number(n.multiplier)||.15),t()};return e?a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:b,children:a.jsxs("div",{style:{backgroundColor:"white",borderRadius:12,padding:24,maxWidth:500,width:"90%",maxHeight:"80vh",overflow:"auto",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)"},onClick:v=>v.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[a.jsx("h2",{style:{margin:0,fontSize:20,fontWeight:700,color:"#0f172a"},children:"CQI Editor"}),a.jsx("button",{onClick:b,style:{background:"transparent",border:"none",fontSize:24,cursor:"pointer",color:"#64748b",padding:0,width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center"},title:"Close",children:""})]}),a.jsx("div",{style:{fontSize:14,color:"#64748b",marginBottom:20},children:"Select when to show the CQI buttons. Multiple options can be selected as long as COs don't overlap."}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:16},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"TOTAL<58 Divider"}),a.jsx("input",{type:"number",value:String(u),onChange:v=>d(Number(v.target.value)),className:"obe-input",min:.1,step:.1})]}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"TOTAL58 Multiplier"}),a.jsx("input",{type:"number",value:String(f),onChange:v=>h(Number(v.target.value)),className:"obe-input",min:0,step:.01})]})]}),p&&a.jsx("div",{style:{padding:12,marginBottom:16,backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:8,color:"#b91c1c",fontSize:13},children:p}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12,marginBottom:24},children:Y5.map(v=>a.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:12,padding:16,border:"2px solid",borderColor:s.has(v.id)?"#3b82f6":"#e2e8f0",borderRadius:8,cursor:"pointer",backgroundColor:s.has(v.id)?"#eff6ff":"white",transition:"all 0.2s"},children:[a.jsx("input",{type:"checkbox",checked:s.has(v.id),onChange:()=>g(v.id),style:{marginTop:3,width:18,height:18,cursor:"pointer"}}),a.jsxs("div",{style:{flex:1},children:[a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:12,marginBottom:6},children:[a.jsxs("div",{style:{fontWeight:600,color:"#0f172a"},children:[v.label," - ",v.cos.join(" and ")]}),a.jsxs("div",{style:{minWidth:190},children:[a.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"Display name"}),a.jsx("input",{type:"text",value:String((l==null?void 0:l[v.id])||v.label),onChange:w=>{const S=String(w.target.value||"");c(j=>({...j,[v.id]:S}))},className:"obe-input",style:{padding:8},placeholder:v.label})]})]}),a.jsxs("div",{style:{fontSize:13,color:"#64748b"},children:["Show CQI button after ",v.label," exam"]})]})]},v.id))}),a.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end"},children:[a.jsx("button",{onClick:b,className:"obe-btn",style:{minWidth:80},children:"Cancel"}),a.jsx("button",{onClick:y,className:"obe-btn obe-btn-primary",style:{minWidth:80},children:"Save"})]})]})}):null}function tne(){const e={options:[],divider:2,multiplier:.15},[t,r]=x.useState(!1),[n,i]=x.useState(e),[s,o]=x.useState(!1);x.useEffect(()=>{let c=!0;return o(!0),wS().then(u=>{c&&i({options:Array.isArray(u.options)?u.options:[],divider:Number.isFinite(Number(u.divider))?Number(u.divider):2,multiplier:Number.isFinite(Number(u.multiplier))?Number(u.multiplier):.15})}).catch(()=>{}).finally(()=>{c&&o(!1)}),()=>{c=!1}},[]);const l=async c=>{i(c);try{await v9({options:Array.isArray(c.options)?c.options:[],divider:c.divider,multiplier:c.multiplier}),window.alert("CQI configuration saved.")}catch{window.alert("Failed to save CQI configuration.")}};return a.jsxs("div",{style:{padding:18},children:[a.jsx("h3",{style:{marginTop:0},children:"CQI Editor"}),a.jsx("div",{style:{color:"#6b7280",marginBottom:12},children:"Edit global CQI defaults for courses."}),a.jsx("div",{style:{display:"flex",gap:8},children:a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:()=>r(!0),disabled:s,children:s?"Loading":"Open CQI Editor"})}),a.jsx(ene,{isOpen:t,onClose:()=>r(!1),onSave:l,currentSelection:n})]})}function Fc(e){return String(e??"").toLowerCase().replace(/[^a-z0-9]+/g,"").trim()}function rne(){return{}}const Dm=["Technical magazine","Journal paper reading","Real time problems","Case study","Dipstick (Writing explanation content of CO)","Dipstick (Sketch Representation)","Real time Photography or Video Explanation","Course competition","Active Learing Exercies (Group Discussion)","Active Learing Exercies (Technical Question and answering Session)","Technical Role play","Interview Assessment","Active Projects","Journal Preparation"],Rp=Array.from({length:11},(e,t)=>`PO${t+1}`);function nne(){const e={};for(const t of Dm)e[Fc(t)]=Array(Rp.length).fill(!1);return e}function ine(){const[e,t]=x.useState(nne),[r,n]=x.useState(!0),[i,s]=x.useState(!1),[o,l]=x.useState(null);x.useEffect(()=>{let d=!0;return n(!0),N3().then(f=>{d&&t(h=>{const p={...h};for(const m of Dm){const g=Fc(m),y=f==null?void 0:f[g];Array.isArray(y)&&y.length===Rp.length&&(p[g]=y)}return p})}).catch(()=>{}).finally(()=>{d&&n(!1)}),()=>{d=!1}},[]);function c(d,f){const h=Fc(d);t(p=>{const m=p[h]?[...p[h]]:Array(Rp.length).fill(!1);return m[f]=!m[f],{...p,[h]:m}}),l(null)}async function u(){s(!0),l(null);try{await U9(e),l(" Saved  changes are now active for all courses.")}catch(d){l(`Save failed: ${(d==null?void 0:d.message)||"Unknown error"}`)}finally{s(!1)}}return a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:6},children:[a.jsxs("div",{children:[a.jsx("h3",{style:{margin:0},children:"Active Learning  PO Mapping (Global)"}),a.jsxs("p",{style:{color:"#6b7280",marginTop:4,marginBottom:0,fontSize:13},children:["For each active-learning activity, tick which POs it contributes to. These settings apply to"," ",a.jsx("strong",{children:"all courses"})," immediately after saving."]})]}),a.jsx("button",{onClick:u,disabled:i||r,style:{padding:"8px 18px",borderRadius:8,background:i||r?"#d1fae5":"#10b981",color:"#fff",border:"none",fontWeight:700,cursor:i||r?"default":"pointer",whiteSpace:"nowrap"},children:i?"Saving":"Save Global Mapping"})]}),o&&a.jsx("div",{style:{marginBottom:10,padding:"8px 12px",borderRadius:6,background:o.startsWith("")?"#ecfdf5":"#fef2f2",color:o.startsWith("")?"#065f46":"#991b1b",fontSize:13},children:o}),r?a.jsx("div",{style:{color:"#6b7280",padding:16},children:"Loading global mapping"}):a.jsx("div",{style:{overflowX:"auto"},children:a.jsxs("table",{style:{borderCollapse:"collapse",fontSize:13,minWidth:700,width:"100%"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:"8px 10px",border:"1px solid #e5e7eb",minWidth:220},children:"Active Learning Activity"}),Rp.map(d=>a.jsx("th",{style:{padding:"6px 8px",border:"1px solid #e5e7eb",textAlign:"center",minWidth:46},children:d},d))]})}),a.jsx("tbody",{children:Dm.map((d,f)=>{const h=Fc(d),p=e[h]??Array(Rp.length).fill(!1);return a.jsxs("tr",{style:{background:f%2===0?"#fff":"#f9fafb"},children:[a.jsx("td",{style:{padding:"7px 10px",border:"1px solid #e5e7eb",fontWeight:500},children:d}),Rp.map((m,g)=>a.jsx("td",{style:{padding:"4px",border:"1px solid #e5e7eb",textAlign:"center"},children:a.jsx("input",{type:"checkbox",checked:!!p[g],onChange:()=>c(d,g),style:{cursor:"pointer",width:16,height:16}})},g))]},d)})})]})})]})}function ane(){const e=hl(),t=vo(),n=x.useMemo(()=>new URLSearchParams(e.search),[e.search]).get("tab")||"dashboard",[i,s]=x.useState(n);x.useEffect(()=>{const l=new URLSearchParams(e.search).get("tab");l&&l!==i&&s(l)},[e.search]);const o=[{key:"dashboard",label:"Dashboard"},{key:"weights",label:"Weights"},{key:"active_learning",label:"Active Learning Mapping"},{key:"due_dates",label:"OBE Due Dates"},{key:"courses",label:"Courses"},{key:"qp",label:"QP"},{key:"cqi",label:"CQI Editor"}];return a.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[a.jsxs("div",{style:{marginBottom:12},children:[a.jsx("h2",{style:{margin:0,fontSize:20},children:"Academic Controller"}),a.jsx("div",{style:{color:"#6b7280",marginTop:6},children:"IQAC tools for OBE oversight."})]}),a.jsx("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:18,flexWrap:"wrap"},children:o.map(l=>a.jsx("button",{onClick:()=>{s(l.key),t(`/iqac/academic-controller?tab=${encodeURIComponent(l.key)}`)},style:{padding:"8px 12px",borderRadius:8,border:i===l.key?"1px solid #10b981":"1px solid #e5e7eb",background:i===l.key?"#ecfdf5":"#fff",fontWeight:700,cursor:"pointer"},children:l.label},l.key))}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[i==="dashboard"&&a.jsx("div",{style:{color:"#6b7280"},children:"Dashboard coming soon."}),i==="weights"&&a.jsx(Zre,{}),i==="active_learning"&&a.jsx(ine,{}),i==="due_dates"&&a.jsx(k3,{}),i==="courses"&&a.jsx(qre,{}),i==="qp"&&a.jsx(Gre,{}),i==="cqi"&&a.jsx(tne,{})]})]})}const sne="https://db.krgi.co.in",one=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":sne;async function M2(e){const t=encodeURIComponent(String(e||"").trim()),r=await mr(`${one}/api/academics/iqac/course-teaching/${t}/`);if(!r.ok)throw new Error("Failed to fetch course teaching map");const n=await r.json();if(Array.isArray(n))return n;const i=n==null?void 0:n.results;return Array.isArray(i)?i:[]}function L2(e,t){const r=String(t||"").trim().toLowerCase(),n=String(e||"").trim();!n||!r||(Pu(`marks_${n}_${r}`),r==="ssa1"&&Pu(`ssa1_sheet_${n}`),r==="review1"&&Pu(`review1_sheet_${n}`),r==="ssa2"&&Pu(`ssa2_sheet_${n}`),r==="review2"&&Pu(`review2_sheet_${n}`),r==="formative1"&&Pu(`formative1_sheet_${n}`),r==="formative2"&&Pu(`formative2_sheet_${n}`),r==="cia1"&&Pu(`cia1_sheet_${n}`),r==="cia2"&&Pu(`cia2_sheet_${n}`),r==="model"&&Pu(`model_sheet_${n}`))}function lne(){var m;const{courseCode:e}=z0(),t=vo(),r=x.useMemo(()=>decodeURIComponent(String(e||"")).trim(),[e]),[n,i]=x.useState([]),[s,o]=x.useState(null),[l,c]=x.useState(!0),[u,d]=x.useState(null);x.useEffect(()=>{let g=!0;return(async()=>{if(r)try{const[y,b]=await Promise.all([M2(r),Sl()]);if(!g)return;i(Array.isArray(y)?y:[]),o(Array.isArray(b)?b:[]),d(null)}catch(y){if(!g)return;i([]),d((y==null?void 0:y.message)||"Failed to load course mapping")}finally{g&&c(!1)}})(),()=>{g=!1}},[r]);const f=((m=n[0])==null?void 0:m.course_name)||r,h=x.useMemo(()=>{const g=new Map;for(const b of n||[]){const v=String((b==null?void 0:b.section_name)||"").trim()||"Section",w=b!=null&&b.academic_year?String(b.academic_year):null,S=`${v}__${w||""}`,j=g.get(S);j?j.items.push(b):g.set(S,{section_name:v,academic_year:w,items:[b]})}const y=Array.from(g.values());y.sort((b,v)=>{const w=b.section_name.localeCompare(v.section_name);return w!==0?w:String(b.academic_year||"").localeCompare(String(v.academic_year||""))});for(const b of y)b.items.sort((v,w)=>{var k,A,R,M;const S=String(((k=v.staff)==null?void 0:k.name)||((A=v.staff)==null?void 0:A.username)||"").trim(),j=String(((R=w.staff)==null?void 0:R.name)||((M=w.staff)==null?void 0:M.username)||"").trim();return S.localeCompare(j)});return y},[n]);async function p(g){if(!g||!window.confirm("Resetting this course will delete all entered exam data for this teaching assignment. This cannot be undone. Proceed?"))return;const b=["ssa1","review1","ssa2","review2","cia1","cia2","formative1","formative2","model"];try{for(const w of b)try{await S3(w,r,g),L2(r,w)}catch(S){console.warn("reset assessment failed",w,S)}c(!0);const v=await M2(r);i(Array.isArray(v)?v:[]),d(null),window.alert("Reset completed.")}catch(v){window.alert("Reset failed: "+((v==null?void 0:v.message)||String(v)))}finally{c(!1)}}return a.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",gap:12,flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{children:[a.jsx("h2",{style:{margin:0,fontSize:20},children:r}),a.jsx("div",{style:{color:"#374151",marginTop:6,fontWeight:800},children:f}),a.jsx("div",{style:{color:"#6b7280",marginTop:4},children:"Sections and staff mapping."})]}),a.jsxs("div",{style:{display:"flex",gap:8},children:[a.jsx(es,{className:"obe-btn obe-btn-secondary",to:"/iqac/academic-controller?tab=courses",children:"Back"}),a.jsx("button",{className:"obe-btn",onClick:()=>t(`/obe/course/${encodeURIComponent(r)}`),children:"Open OBE (faculty view)"})]})]}),l?a.jsx("div",{style:{color:"#6b7280"},children:"Loading"}):null,u?a.jsx("div",{style:{color:"#b91c1c"},children:u}):null,!l&&!u&&n.length===0?a.jsx("div",{style:{color:"#6b7280"},children:"No active teaching assignments found for this course."}):null,!l&&!u&&n.length>0?a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:h.map(g=>a.jsxs("div",{className:"obe-card",style:{display:"flex",flexDirection:"column",gap:10},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",alignItems:"baseline"},children:[a.jsx("div",{style:{fontWeight:900,color:"#0f172a"},children:g.section_name}),a.jsx("div",{style:{color:"#6b7280",fontSize:13},children:g.academic_year||""})]}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:10},children:g.items.map(y=>{var b,v;return a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:10,background:"#fff",display:"flex",flexDirection:"column",gap:8},children:[a.jsx("div",{style:{color:"#111827",fontWeight:800},children:((b=y.staff)==null?void 0:b.name)||((v=y.staff)==null?void 0:v.username)||""}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[y.section_name?`Section: ${y.section_name}`:"",y.academic_year?`    AY: ${y.academic_year}`:"",(()=>{var S,j;const w=(s||[]).find(k=>String((k==null?void 0:k.course_code)||"").trim().toUpperCase()===r.toUpperCase());return w?`    Dept: ${((S=w.department)==null?void 0:S.name)||((j=w.department)==null?void 0:j.code)||""}    Sem: ${w.semester||""}`:""})()]}),a.jsxs("div",{style:{marginTop:2,display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:()=>t(`/iqac/academic-controller/course/${encodeURIComponent(r)}/marks/${encodeURIComponent(String(y.teaching_assignment_id))}`),children:"Open Mark Entry"}),a.jsx("button",{className:"obe-btn",onClick:()=>t(`/iqac/academic-controller/course/${encodeURIComponent(r)}/obe/${encodeURIComponent(String(y.teaching_assignment_id))}/marks`),children:"Open OBE (view-only)"}),a.jsx("button",{className:"obe-btn",onClick:()=>p(Number(y.teaching_assignment_id)),children:"Reset Course"})]})]},String(y.teaching_assignment_id))})})]},`${g.section_name}__${g.academic_year||""}`))}):null]})}async function pc(e){const t=`/api/academics/teaching-assignments/${encodeURIComponent(String(e))}/students/`,r=(i,s=800)=>{const o=String(i||""),u=o.replace(/<script[\s\S]*?<\/script>/gi," ").replace(/<style[\s\S]*?<\/style>/gi," ").replace(/<[^>]+>/g," ").replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&quot;/gi,'"').replace(/&#39;/gi,"'").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/\s+/g," ").trim()||o.replace(/\s+/g," ").trim();return u.length<=s?u:u.slice(0,s)+" (truncated)"},n=await mr(t,{method:"GET"});if(!n.ok){const i=await n.text();throw new Error(`Roster fetch failed: ${n.status}
${r(i)}`)}return n.json()}function cne(e,t){if(!e)return null;const r=new Date(e).getTime();if(!Number.isFinite(r))return null;const n=t?new Date(t).getTime():Date.now();return Number.isFinite(n)?Math.floor((r-n)/1e3):null}function sg(e){if(e==null)return"";const t=Math.max(0,Math.floor(e)),r=Math.floor(t/3600),n=Math.floor(t%3600/60),i=t%60;return r>0?`${r}h ${String(n).padStart(2,"0")}m`:`${n}m ${String(i).padStart(2,"0")}s`}function V0(e){const{assessment:t,subjectCode:r,teachingAssignmentId:n,options:i}=e,[s,o]=x.useState(null),[l,c]=x.useState(!1),[u,d]=x.useState(null),[f,h]=x.useState(null),p=x.useMemo(()=>`${t}|${r}|${n||""}`,[t,r,n]),m=async y=>{if(!t||!r)return;const b=!!(y!=null&&y.silent);b||c(!0),b||d(null);try{const v=await _3(t,r,n);o(v);const w=v.remaining_seconds??cne(v.due_at,v.now);h(w)}catch(v){d((v==null?void 0:v.message)||"Failed to check publish window")}finally{b||c(!1)}};x.useEffect(()=>{o(null),h(null),m()},[p]),x.useEffect(()=>{if((i==null?void 0:i.poll)===!1)return;const y=window.setInterval(()=>{m({silent:!0})},3e4);return()=>window.clearInterval(y)},[p,i==null?void 0:i.poll]),x.useEffect(()=>{if(f==null||f<=0)return;const y=window.setInterval(()=>{h(b=>b==null?b:b<=0?0:b-1)},1e3);return()=>window.clearInterval(y)},[f]);const g=(s==null?void 0:s.publish_allowed)??!0;return{data:s,loading:l,error:u,remainingSeconds:f,publishAllowed:g,refresh:m}}function lc(e){const{assessment:t,subjectCode:r,scope:n,teachingAssignmentId:i,options:s}=e,[o,l]=x.useState(null),[c,u]=x.useState(!1),[d,f]=x.useState(null),h=x.useMemo(()=>`${t}|${r}|${n}|${i||""}`,[t,r,n,i]),p=async m=>{if(!t||!r||!n)return;const g=!!(m!=null&&m.silent);g||u(!0),g||f(null);try{const y=await l1(t,r,n,i);l(y)}catch(y){f((y==null?void 0:y.message)||"Failed to check edit window")}finally{g||u(!1)}};return x.useEffect(()=>{l(null),p()},[h]),x.useEffect(()=>{if((s==null?void 0:s.poll)===!1)return;const m=window.setInterval(()=>{p({silent:!0})},3e4);return()=>window.clearInterval(m)},[h,s==null?void 0:s.poll]),{data:o,loading:c,error:d,refresh:p}}function G0(e){const{assessment:t,subjectCode:r,teachingAssignmentId:n,options:i}=e,[s,o]=x.useState(null),[l,c]=x.useState(!1),[u,d]=x.useState(null),f=x.useMemo(()=>`${t}|${r}|${n||""}`,[t,r,n]),h=async p=>{if(!t||!r)return;const m=!!(p!=null&&p.silent);m||c(!0),m||d(null);try{const g=await bS(t,r,n);o(g)}catch(g){d((g==null?void 0:g.message)||"Failed to load lock status")}finally{m||c(!1)}};return x.useEffect(()=>{o(null),h()},[f]),x.useEffect(()=>{if((i==null?void 0:i.poll)===!1)return;const p=window.setInterval(()=>{h({silent:!0})},3e4);return()=>window.clearInterval(p)},[f,i==null?void 0:i.poll]),{data:s,loading:l,error:u,refresh:h}}const une=24*60*60*1e3;function dne(e){if(!e||String(e.status||"").toUpperCase()!=="PENDING"||!e.is_active)return null;const r=e.requested_at?new Date(String(e.requested_at)).getTime():0;if(!r||!Number.isFinite(r))return null;const n=r+une;return Number.isFinite(n)?n:null}function K0(e){const{enabled:t,assessment:r,subjectCode:n,scope:i,teachingAssignmentId:s}=e,[o,l]=x.useState(null),[c,u]=x.useState(null),[d,f]=x.useState(!1),h=x.useMemo(()=>c?c>Date.now():!1,[c]),p=async m=>{if(!t||!r||!n||!i)return;const g=!!(m!=null&&m.silent);g||f(!0);try{const y=await Bm({assessment:r,subject_code:String(n),scope:i,teaching_assignment_id:s}),b=(y==null?void 0:y.result)??null;l(b),u(dne(b))}catch{l(null),u(null)}finally{g||f(!1)}};return x.useEffect(()=>{if(!t){l(null),u(null);return}p({silent:!0});const m=window.setInterval(()=>{p({silent:!0})},6e4);return()=>window.clearInterval(m)},[t,r,n,i,s]),{latest:o,pending:h,pendingUntilMs:c,loading:d,refresh:p,setPendingUntilMs:u}}function Y0(e){x.useEffect(()=>{if(!e||typeof document>"u")return;const t=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=t}},[e])}function fne({size:e=22}){return a.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,focusable:"false",children:[a.jsx("path",{d:"M7 10V8a5 5 0 0 1 10 0v2",stroke:"#111827",strokeWidth:"1.8",strokeLinecap:"round"}),a.jsx("path",{d:"M6.5 10h11A2.5 2.5 0 0 1 20 12.5v6A2.5 2.5 0 0 1 17.5 21h-11A2.5 2.5 0 0 1 4 18.5v-6A2.5 2.5 0 0 1 6.5 10Z",fill:"#F3F4F6",stroke:"#111827",strokeWidth:"1.2"}),a.jsx("path",{d:"M12 14.2v2.6",stroke:"#111827",strokeWidth:"1.8",strokeLinecap:"round"})]})}function og({locked:e,title:t,subtitle:r,children:n}){return e?a.jsxs("div",{style:{position:"relative"},children:[a.jsx("div",{style:{position:"sticky",top:0,left:0,right:0,zIndex:10,marginBottom:12},children:a.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center",background:"#ffffff",border:"2px solid #fde68a",borderRadius:12,padding:"12px 16px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)"},children:[a.jsx("div",{style:{width:36,height:36,borderRadius:999,display:"grid",placeItems:"center",background:"#fef3c7",border:"1px solid #fde68a",flex:"0 0 auto"},children:a.jsx(fne,{size:20})}),a.jsxs("div",{style:{minWidth:0,flex:1},children:[a.jsx("div",{style:{fontWeight:800,color:"#111827",fontSize:14},children:t||"Locked by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:2},children:r||"Publishing is turned OFF globally for this assessment."})]})]})}),a.jsx("div",{style:{filter:"brightness(0.97)",pointerEvents:"none",userSelect:"none"},children:n})]}):a.jsx(a.Fragment,{children:n})}function X0({children:e}){const t={minHeight:"100vh",background:"linear-gradient(180deg, #f0f9ff 0%, #ffffff 65%)",padding:"18px 14px"},r={maxWidth:1400,margin:"0 auto"},n={border:"1px solid rgba(15,23,42,0.08)",borderRadius:16,background:"rgba(255,255,255,0.88)",boxShadow:"0 12px 30px rgba(15,23,42,0.08)",padding:16,backdropFilter:"blur(10px)",overflowX:"auto",minWidth:0};return a.jsx("div",{style:t,children:a.jsx("div",{style:{...r,...n},children:e})})}function Va(e){return typeof document>"u"?a.jsx(a.Fragment,{children:e.children}):Y1.createPortal(a.jsx(a.Fragment,{children:e.children}),document.body)}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var R2={};R2.version="0.18.5";var q9=1252,hne=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],E3={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},T3=function(e){hne.indexOf(e)!=-1&&(q9=E3[0]=e)};function pne(){T3(1252)}var du=function(e){T3(e)};function P3(){du(1200),pne()}function rP(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function mne(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function H9(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var hx=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?mne(e.slice(2)):t==254&&r==255?H9(e.slice(2)):t==65279?e.slice(1):e},wb=function(t){return String.fromCharCode(t)},nP=function(t){return String.fromCharCode(t)},c1,Vf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function u1(e){for(var t="",r=0,n=0,i=0,s=0,o=0,l=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),s=r>>2,n=e.charCodeAt(u++),o=(r&3)<<4|n>>4,i=e.charCodeAt(u++),l=(n&15)<<2|i>>6,c=i&63,isNaN(n)?l=c=64:isNaN(i)&&(c=64),t+=Vf.charAt(s)+Vf.charAt(o)+Vf.charAt(l)+Vf.charAt(c);return t}function cc(e){var t="",r=0,n=0,i=0,s=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=Vf.indexOf(e.charAt(u++)),o=Vf.indexOf(e.charAt(u++)),r=s<<2|o>>4,t+=String.fromCharCode(r),l=Vf.indexOf(e.charAt(u++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=Vf.indexOf(e.charAt(u++)),i=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(i));return t}var gi=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),uf=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function hh(e){return gi?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function iP(e){return gi?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ql=function(t){return gi?uf(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function AS(e){if(typeof ArrayBuffer>"u")return Ql(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function kh(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function gne(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function O3(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return O3(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Ks=gi?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:uf(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function xne(e){for(var t=[],r=0,n=e.length+250,i=hh(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++s)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|l>>6&15|(o&3)<<4,i[r++]=128|l&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(t.push(i.slice(0,r)),r=0,i=hh(65535),n=65530)}return t.push(i.slice(0,r)),Ks(t)}var al=/\u0000/g,px=/[\u0001-\u0006]/g;function mm(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function fu(e,t){var r=""+e;return r.length>=t?r:qa("0",t-r.length)+r}function M3(e,t){var r=""+e;return r.length>=t?r:qa(" ",t-r.length)+r}function F2(e,t){var r=""+e;return r.length>=t?r:r+qa(" ",t-r.length)}function yne(e,t){var r=""+Math.round(e);return r.length>=t?r:qa("0",t-r.length)+r}function bne(e,t){var r=""+e;return r.length>=t?r:qa("0",t-r.length)+r}var aP=Math.pow(2,32);function mp(e,t){if(e>aP||e<-aP)return yne(e,t);var r=Math.round(e);return bne(r,t)}function B2(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var sP=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Q5=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function vne(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Gn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},oP={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},wne={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function I2(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,o=1,l=0,c=1,u=0,d=0,f=Math.floor(i);u<t&&(f=Math.floor(i),l=f*o+s,d=f*u+c,!(i-f<5e-8));)i=1/(i-f),s=o,o=l,c=u,u=d;if(d>t&&(u>t?(d=c,l=s):(d=u,l=o)),!r)return[0,n*l,d];var h=Math.floor(n*l/d);return[h,n*l-h*d,d]}function Xh(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,o=[],l={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++i==86400&&(l.T=i=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=Nne(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=i%60,i=Math.floor(i/60),l.M=i%60,i=Math.floor(i/60),l.H=i,l.q=s,l}var V9=new Date(1899,11,31,0,0,0),Sne=V9.getTime(),_ne=new Date(1900,2,1,0,0,0);function G9(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=_ne&&(r+=24*60*60*1e3),(r-(Sne+(e.getTimezoneOffset()-V9.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function L3(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function jne(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function kne(e){var t=e<0?12:11,r=L3(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Ane(e){var t=L3(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function d1(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=kne(e):t===10?r=e.toFixed(10).substr(0,12):r=Ane(e),L3(jne(r.toUpperCase()))}function S0(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):d1(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Wc(14,G9(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Nne(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Cne(e,t,r,n){var i="",s=0,o=0,l=r.y,c,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return Q5[r.m-1][1];case 5:return Q5[r.m-1][0];default:return Q5[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return sP[r.q][0];default:return sP[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?fu(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),t==="s"?s===0?"0":""+s/o:(i=fu(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?fu(c,u):"";return d}function Gf(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var K9=/%/g;function Ene(e,t,r){var n=t.replace(K9,""),i=t.length-n.length;return $d(e,n,r*Math.pow(10,2*i))+qa("%",i)}function Tne(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return $d(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Y9(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Y9(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var X9=/# (\?+)( ?)\/( ?)(\d+)/;function Pne(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),o=i-s*n,l=n;return r+(s===0?"":""+s)+" "+(o===0?qa(" ",e[1].length+1+e[4].length):M3(o,e[1].length)+e[2]+"/"+e[3]+fu(l,e[4].length))}function One(e,t,r){return r+(t===0?"":""+t)+qa(" ",e[1].length+2+e[4].length)}var Q9=/^#*0*\.([0#]+)/,J9=/\).*[0#]/,Z9=/\(###\) ###\\?-####/;function el(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function lP(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function cP(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Mne(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Lne(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ac(e,t,r){if(e.charCodeAt(0)===40&&!t.match(J9)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ac("n",n,r):"("+Ac("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Tne(e,t,r);if(t.indexOf("%")!==-1)return Ene(e,t,r);if(t.indexOf("E")!==-1)return Y9(t,r);if(t.charCodeAt(0)===36)return"$"+Ac(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+mp(c,t.length);if(t.match(/^[#?]+$/))return i=mp(r,0),i==="0"&&(i=""),i.length>t.length?i:el(t.substr(0,t.length-i.length))+i;if(s=t.match(X9))return Pne(s,c,u);if(t.match(/^#+0+$/))return u+mp(c,t.length-t.indexOf("0"));if(s=t.match(Q9))return i=lP(r,s[1].length).replace(/^([^\.]+)$/,"$1."+el(s[1])).replace(/\.$/,"."+el(s[1])).replace(/\.(\d*)$/,function(m,g){return"."+g+qa("0",el(s[1]).length-g.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+lP(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+Gf(mp(c,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ac(e,t,-r):Gf(""+(Math.floor(r)+Mne(r,s[1].length)))+"."+fu(cP(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Ac(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=mm(Ac(e,t.replace(/[\\-]/g,""),r)),o=0,mm(mm(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<i.length?i.charAt(o++):m==="0"?"0":""}));if(t.match(Z9))return i=Ac(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=I2(c,Math.pow(10,o)-1,!1),i=""+u,d=$d("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=F2(l[2],o),d.length<s[4].length&&(d=el(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=I2(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?M3(l[1],o)+s[2]+"/"+s[3]+F2(l[2],o):qa(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=mp(r,0),t.length<=i.length?i:el(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var f=t.indexOf(".")-o,h=t.length-i.length-f;return el(t.substr(0,f)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=cP(r,s[1].length),r<0?"-"+Ac(e,t,-r):Gf(Lne(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?fu(0,3-m.length):"")+m})+"."+fu(o,s[1].length);switch(t){case"###,##0.00":return Ac(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Gf(mp(c,0));return p!=="0"?u+p:"";case"###,###.00":return Ac(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ac(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Rne(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return $d(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Fne(e,t,r){var n=t.replace(K9,""),i=t.length-n.length;return $d(e,n,r*Math.pow(10,2*i))+qa("%",i)}function e$(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+e$(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Iu(e,t,r){if(e.charCodeAt(0)===40&&!t.match(J9)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Iu("n",n,r):"("+Iu("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Rne(e,t,r);if(t.indexOf("%")!==-1)return Fne(e,t,r);if(t.indexOf("E")!==-1)return e$(t,r);if(t.charCodeAt(0)===36)return"$"+Iu(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+fu(c,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:el(t.substr(0,t.length-i.length))+i;if(s=t.match(X9))return One(s,c,u);if(t.match(/^#+0+$/))return u+fu(c,t.length-t.indexOf("0"));if(s=t.match(Q9))return i=(""+r).replace(/^([^\.]+)$/,"$1."+el(s[1])).replace(/\.$/,"."+el(s[1])),i=i.replace(/\.(\d*)$/,function(m,g){return"."+g+qa("0",el(s[1]).length-g.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+Gf(""+c);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Iu(e,t,-r):Gf(""+r)+"."+qa("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Iu(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=mm(Iu(e,t.replace(/[\\-]/g,""),r)),o=0,mm(mm(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<i.length?i.charAt(o++):m==="0"?"0":""}));if(t.match(Z9))return i=Iu(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=I2(c,Math.pow(10,o)-1,!1),i=""+u,d=$d("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=F2(l[2],o),d.length<s[4].length&&(d=el(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=I2(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?M3(l[1],o)+s[2]+"/"+s[3]+F2(l[2],o):qa(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:el(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var f=t.indexOf(".")-o,h=t.length-i.length-f;return el(t.substr(0,f)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Iu(e,t,-r):Gf(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?fu(0,3-m.length):"")+m})+"."+fu(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Gf(""+c);return p!=="0"?u+p:"";default:if(t.match(/\.[0#?]*$/))return Iu(e,t.slice(0,t.lastIndexOf(".")),r)+el(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function $d(e,t,r){return(r|0)===r?Iu(e,t,r):Ac(e,t,r)}function Bne(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var t$=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function lg(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":B2(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(t$))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Ine(e,t,r,n){for(var i=[],s="",o=0,l="",c="t",u,d,f,h="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!B2(e,o))throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(f=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++o;break;case"\\":var p=e.charAt(++o),m=p==="("||p===")"?p:"t";i[i.length]={t:m,v:p},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=Xh(t,r,e.charAt(o+1)==="2"),u==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Xh(t,r),u==null))return"";for(s=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)s+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=h),i[i.length]={t:l,v:s},c=l;break;case"A":case"a":case"":var g={t:l,v:l};if(u==null&&(u=Xh(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",h="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",o+=5,h="h"):e.substr(o,5).toUpperCase()==="/"?(u!=null&&(g.v=u.H>=12?"":""),g.t="T",o+=5,h="h"):(g.t="t",++o),u==null&&g.t==="T")return"";i[i.length]=g,c=l;break;case"[":for(s=l;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(t$)){if(u==null&&(u=Xh(t,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",lg(e)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=l;++o<e.length&&(l=e.charAt(o))==="0";)s+=l;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)s+=l;i[i.length]={t:"n",v:s};break;case"?":for(s=l;e.charAt(++o)===l;)s+=l;i[i.length]={t:l,v:s},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:l,v:l},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"t",v:l},++o;break}var y=0,b=0,v;for(o=i.length-1,c="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=h,c="h",y<1&&(y=1);break;case"s":(v=i[o].v.match(/\.0+$/))&&(b=Math.max(b,v[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":c=i[o].t;break;case"m":c==="s"&&(i[o].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&i[o].v.match(/[Hh]/)&&(y=1),y<2&&i[o].v.match(/[Mm]/)&&(y=2),y<3&&i[o].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var w="",S;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=Cne(i[o].t.charCodeAt(0),i[o].v,u,b),i[o].t="t";break;case"n":case"?":for(S=o+1;i[S]!=null&&((l=i[S].t)==="?"||l==="D"||(l===" "||l==="t")&&i[S+1]!=null&&(i[S+1].t==="?"||i[S+1].t==="t"&&i[S+1].v==="/")||i[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(i[S].v==="/"||i[S].v===" "&&i[S+1]!=null&&i[S+1].t=="?"));)i[o].v+=i[S].v,i[S]={v:"",t:";"},++S;w+=i[o].v,o=S-1;break;case"G":i[o].t="t",i[o].v=S0(t,r);break}var j="",k,A;if(w.length>0){w.charCodeAt(0)==40?(k=t<0&&w.charCodeAt(0)===45?-t:t,A=$d("n",w,k)):(k=t<0&&n>1?-t:t,A=$d("n",w,k),k<0&&i[0]&&i[0].t=="t"&&(A=A.substr(1),i[0].v="-"+i[0].v)),S=A.length-1;var R=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){R=o;break}var M=i.length;if(R===i.length&&A.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(S>=i[o].v.length-1?(S-=i[o].v.length,i[o].v=A.substr(S+1,i[o].v.length)):S<0?i[o].v="":(i[o].v=A.substr(0,S+1),S=-1),i[o].t="t",M=o);S>=0&&M<i.length&&(i[M].v=A.substr(0,S+1)+i[M].v)}else if(R!==i.length&&A.indexOf("E")===-1){for(S=A.indexOf(".")-1,o=R;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(d=i[o].v.indexOf(".")>-1&&o===R?i[o].v.indexOf(".")-1:i[o].v.length-1,j=i[o].v.substr(d+1);d>=0;--d)S>=0&&(i[o].v.charAt(d)==="0"||i[o].v.charAt(d)==="#")&&(j=A.charAt(S--)+j);i[o].v=j,i[o].t="t",M=o}for(S>=0&&M<i.length&&(i[M].v=A.substr(0,S+1)+i[M].v),S=A.indexOf(".")+1,o=R;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==R)){for(d=i[o].v.indexOf(".")>-1&&o===R?i[o].v.indexOf(".")+1:0,j=i[o].v.substr(0,d);d<i[o].v.length;++d)S<A.length&&(j+=A.charAt(S++));i[o].v=j,i[o].t="t",M=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(k=n>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=$d(i[o].t,i[o].v,k),i[o].t="t");var B="";for(o=0;o!==i.length;++o)i[o]!=null&&(B+=i[o].v);return B}var uP=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function dP(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Dne(e,t){var r=Bne(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(uP),l=r[1].match(uP);return dP(t,o)?[n,r[0]]:dP(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,s]}function Wc(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Gn)[e],n==null&&(n=r.table&&r.table[oP[e]]||Gn[oP[e]]),n==null&&(n=wne[e]||"General");break}if(B2(n,0))return S0(t,r);t instanceof Date&&(t=G9(t,r.date1904));var i=Dne(n,t);if(B2(i[1]))return S0(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Ine(i[1],t,r,i[0])}function Ud(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Gn[r]==null){t<0&&(t=r);continue}if(Gn[r]==e){t=r;break}}t<0&&(t=391)}return Gn[t]=e,t}function NS(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Ud(e[t],t)}function cg(){Gn=vne()}var $ne={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},r$=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Une(e){var t=typeof e=="number"?Gn[e]:e;return t=t.replace(r$,"(\\d+)"),new RegExp("^"+t+"$")}function zne(e,t,r){var n=-1,i=-1,s=-1,o=-1,l=-1,c=-1;(t.match(r$)||[]).forEach(function(f,h){var p=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=p;break;case"d":s=p;break;case"h":o=p;break;case"s":c=p;break;case"m":o>=0?l=p:i=p;break}}),c>=0&&l==-1&&i>=0&&(l=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?u:n==-1&&i==-1&&s==-1?d:u+"T"+d}var Wne=function(){var e={};e.version="1.2.0";function t(){for(var A=0,R=new Array(256),M=0;M!=256;++M)A=M,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,R[M]=A;return typeof Int32Array<"u"?new Int32Array(R):R}var r=t();function n(A){var R=0,M=0,B=0,E=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)E[B]=A[B];for(B=0;B!=256;++B)for(M=A[B],R=256+B;R<4096;R+=256)M=E[R]=M>>>8^A[M&255];var P=[];for(B=1;B!=16;++B)P[B-1]=typeof Int32Array<"u"?E.subarray(B*256,B*256+256):E.slice(B*256,B*256+256);return P}var i=n(r),s=i[0],o=i[1],l=i[2],c=i[3],u=i[4],d=i[5],f=i[6],h=i[7],p=i[8],m=i[9],g=i[10],y=i[11],b=i[12],v=i[13],w=i[14];function S(A,R){for(var M=R^-1,B=0,E=A.length;B<E;)M=M>>>8^r[(M^A.charCodeAt(B++))&255];return~M}function j(A,R){for(var M=R^-1,B=A.length-15,E=0;E<B;)M=w[A[E++]^M&255]^v[A[E++]^M>>8&255]^b[A[E++]^M>>16&255]^y[A[E++]^M>>>24]^g[A[E++]]^m[A[E++]]^p[A[E++]]^h[A[E++]]^f[A[E++]]^d[A[E++]]^u[A[E++]]^c[A[E++]]^l[A[E++]]^o[A[E++]]^s[A[E++]]^r[A[E++]];for(B+=15;E<B;)M=M>>>8^r[(M^A[E++])&255];return~M}function k(A,R){for(var M=R^-1,B=0,E=A.length,P=0,U=0;B<E;)P=A.charCodeAt(B++),P<128?M=M>>>8^r[(M^P)&255]:P<2048?(M=M>>>8^r[(M^(192|P>>6&31))&255],M=M>>>8^r[(M^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,U=A.charCodeAt(B++)&1023,M=M>>>8^r[(M^(240|P>>8&7))&255],M=M>>>8^r[(M^(128|P>>2&63))&255],M=M>>>8^r[(M^(128|U>>6&15|(P&3)<<4))&255],M=M>>>8^r[(M^(128|U&63))&255]):(M=M>>>8^r[(M^(224|P>>12&15))&255],M=M>>>8^r[(M^(128|P>>6&63))&255],M=M>>>8^r[(M^(128|P&63))&255]);return~M}return e.table=r,e.bstr=S,e.buf=j,e.str=k,e}(),qn=function(){var t={};t.version="1.2.1";function r(se,ue){for(var J=se.split("/"),pe=ue.split("/"),xe=0,Ne=0,St=Math.min(J.length,pe.length);xe<St;++xe){if(Ne=J[xe].length-pe[xe].length)return Ne;if(J[xe]!=pe[xe])return J[xe]<pe[xe]?-1:1}return J.length-pe.length}function n(se){if(se.charAt(se.length-1)=="/")return se.slice(0,-1).indexOf("/")===-1?se:n(se.slice(0,-1));var ue=se.lastIndexOf("/");return ue===-1?se:se.slice(0,ue+1)}function i(se){if(se.charAt(se.length-1)=="/")return i(se.slice(0,-1));var ue=se.lastIndexOf("/");return ue===-1?se:se.slice(ue+1)}function s(se,ue){typeof ue=="string"&&(ue=new Date(ue));var J=ue.getHours();J=J<<6|ue.getMinutes(),J=J<<5|ue.getSeconds()>>>1,se.write_shift(2,J);var pe=ue.getFullYear()-1980;pe=pe<<4|ue.getMonth()+1,pe=pe<<5|ue.getDate(),se.write_shift(2,pe)}function o(se){var ue=se.read_shift(2)&65535,J=se.read_shift(2)&65535,pe=new Date,xe=J&31;J>>>=5;var Ne=J&15;J>>>=4,pe.setMilliseconds(0),pe.setFullYear(J+1980),pe.setMonth(Ne-1),pe.setDate(xe);var St=ue&31;ue>>>=5;var Ve=ue&63;return ue>>>=6,pe.setHours(ue),pe.setMinutes(Ve),pe.setSeconds(St<<1),pe}function l(se){go(se,0);for(var ue={},J=0;se.l<=se.length-4;){var pe=se.read_shift(2),xe=se.read_shift(2),Ne=se.l+xe,St={};switch(pe){case 21589:J=se.read_shift(1),J&1&&(St.mtime=se.read_shift(4)),xe>5&&(J&2&&(St.atime=se.read_shift(4)),J&4&&(St.ctime=se.read_shift(4))),St.mtime&&(St.mt=new Date(St.mtime*1e3));break}se.l=Ne,ue[pe]=St}return ue}var c;function u(){return c||(c={})}function d(se,ue){if(se[0]==80&&se[1]==75)return Nt(se,ue);if((se[0]|32)==109&&(se[1]|32)==105)return qe(se,ue);if(se.length<512)throw new Error("CFB file size "+se.length+" < 512");var J=3,pe=512,xe=0,Ne=0,St=0,Ve=0,De=0,Re=[],xt=se.slice(0,512);go(xt,0);var Vt=f(xt);switch(J=Vt[0],J){case 3:pe=512;break;case 4:pe=4096;break;case 0:if(Vt[1]==0)return Nt(se,ue);default:throw new Error("Major Version: Expected 3 or 4 saw "+J)}pe!==512&&(xt=se.slice(0,pe),go(xt,28));var qt=se.slice(0,pe);h(xt,J);var zt=xt.read_shift(4,"i");if(J===3&&zt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+zt);xt.l+=4,St=xt.read_shift(4,"i"),xt.l+=4,xt.chk("00100000","Mini Stream Cutoff Size: "),Ve=xt.read_shift(4,"i"),xe=xt.read_shift(4,"i"),De=xt.read_shift(4,"i"),Ne=xt.read_shift(4,"i");for(var vt=-1,Lt=0;Lt<109&&(vt=xt.read_shift(4,"i"),!(vt<0));++Lt)Re[Lt]=vt;var er=p(se,pe);y(De,Ne,er,pe,Re);var yr=v(er,St,Re,pe);yr[St].name="!Directory",xe>0&&Ve!==U&&(yr[Ve].name="!MiniFAT"),yr[Re[0]].name="!FAT",yr.fat_addrs=Re,yr.ssz=pe;var Br={},cr=[],ur=[],en=[];w(St,yr,er,cr,xe,Br,ur,Ve),m(ur,en,cr),cr.shift();var nn={FileIndex:ur,FullPaths:en};return ue&&ue.raw&&(nn.raw={header:qt,sectors:er}),nn}function f(se){if(se[se.l]==80&&se[se.l+1]==75)return[0,0];se.chk(G,"Header Signature: "),se.l+=16;var ue=se.read_shift(2,"u");return[se.read_shift(2,"u"),ue]}function h(se,ue){var J=9;switch(se.l+=2,J=se.read_shift(2)){case 9:if(ue!=3)throw new Error("Sector Shift: Expected 9 saw "+J);break;case 12:if(ue!=4)throw new Error("Sector Shift: Expected 12 saw "+J);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+J)}se.chk("0600","Mini Sector Shift: "),se.chk("000000000000","Reserved: ")}function p(se,ue){for(var J=Math.ceil(se.length/ue)-1,pe=[],xe=1;xe<J;++xe)pe[xe-1]=se.slice(xe*ue,(xe+1)*ue);return pe[J-1]=se.slice(J*ue),pe}function m(se,ue,J){for(var pe=0,xe=0,Ne=0,St=0,Ve=0,De=J.length,Re=[],xt=[];pe<De;++pe)Re[pe]=xt[pe]=pe,ue[pe]=J[pe];for(;Ve<xt.length;++Ve)pe=xt[Ve],xe=se[pe].L,Ne=se[pe].R,St=se[pe].C,Re[pe]===pe&&(xe!==-1&&Re[xe]!==xe&&(Re[pe]=Re[xe]),Ne!==-1&&Re[Ne]!==Ne&&(Re[pe]=Re[Ne])),St!==-1&&(Re[St]=pe),xe!==-1&&pe!=Re[pe]&&(Re[xe]=Re[pe],xt.lastIndexOf(xe)<Ve&&xt.push(xe)),Ne!==-1&&pe!=Re[pe]&&(Re[Ne]=Re[pe],xt.lastIndexOf(Ne)<Ve&&xt.push(Ne));for(pe=1;pe<De;++pe)Re[pe]===pe&&(Ne!==-1&&Re[Ne]!==Ne?Re[pe]=Re[Ne]:xe!==-1&&Re[xe]!==xe&&(Re[pe]=Re[xe]));for(pe=1;pe<De;++pe)if(se[pe].type!==0){if(Ve=pe,Ve!=Re[Ve])do Ve=Re[Ve],ue[pe]=ue[Ve]+"/"+ue[pe];while(Ve!==0&&Re[Ve]!==-1&&Ve!=Re[Ve]);Re[pe]=-1}for(ue[0]+="/",pe=1;pe<De;++pe)se[pe].type!==2&&(ue[pe]+="/")}function g(se,ue,J){for(var pe=se.start,xe=se.size,Ne=[],St=pe;J&&xe>0&&St>=0;)Ne.push(ue.slice(St*P,St*P+P)),xe-=P,St=qh(J,St*4);return Ne.length===0?kr(0):Ks(Ne).slice(0,se.size)}function y(se,ue,J,pe,xe){var Ne=U;if(se===U){if(ue!==0)throw new Error("DIFAT chain shorter than expected")}else if(se!==-1){var St=J[se],Ve=(pe>>>2)-1;if(!St)return;for(var De=0;De<Ve&&(Ne=qh(St,De*4))!==U;++De)xe.push(Ne);y(qh(St,pe-4),ue-1,J,pe,xe)}}function b(se,ue,J,pe,xe){var Ne=[],St=[];xe||(xe=[]);var Ve=pe-1,De=0,Re=0;for(De=ue;De>=0;){xe[De]=!0,Ne[Ne.length]=De,St.push(se[De]);var xt=J[Math.floor(De*4/pe)];if(Re=De*4&Ve,pe<4+Re)throw new Error("FAT boundary crossed: "+De+" 4 "+pe);if(!se[xt])break;De=qh(se[xt],Re)}return{nodes:Ne,data:_P([St])}}function v(se,ue,J,pe){var xe=se.length,Ne=[],St=[],Ve=[],De=[],Re=pe-1,xt=0,Vt=0,qt=0,zt=0;for(xt=0;xt<xe;++xt)if(Ve=[],qt=xt+ue,qt>=xe&&(qt-=xe),!St[qt]){De=[];var vt=[];for(Vt=qt;Vt>=0;){vt[Vt]=!0,St[Vt]=!0,Ve[Ve.length]=Vt,De.push(se[Vt]);var Lt=J[Math.floor(Vt*4/pe)];if(zt=Vt*4&Re,pe<4+zt)throw new Error("FAT boundary crossed: "+Vt+" 4 "+pe);if(!se[Lt]||(Vt=qh(se[Lt],zt),vt[Vt]))break}Ne[qt]={nodes:Ve,data:_P([De])}}return Ne}function w(se,ue,J,pe,xe,Ne,St,Ve){for(var De=0,Re=pe.length?2:0,xt=ue[se].data,Vt=0,qt=0,zt;Vt<xt.length;Vt+=128){var vt=xt.slice(Vt,Vt+128);go(vt,64),qt=vt.read_shift(2),zt=U3(vt,0,qt-Re),pe.push(zt);var Lt={name:zt,type:vt.read_shift(1),color:vt.read_shift(1),L:vt.read_shift(4,"i"),R:vt.read_shift(4,"i"),C:vt.read_shift(4,"i"),clsid:vt.read_shift(16),state:vt.read_shift(4,"i"),start:0,size:0},er=vt.read_shift(2)+vt.read_shift(2)+vt.read_shift(2)+vt.read_shift(2);er!==0&&(Lt.ct=S(vt,vt.l-8));var yr=vt.read_shift(2)+vt.read_shift(2)+vt.read_shift(2)+vt.read_shift(2);yr!==0&&(Lt.mt=S(vt,vt.l-8)),Lt.start=vt.read_shift(4,"i"),Lt.size=vt.read_shift(4,"i"),Lt.size<0&&Lt.start<0&&(Lt.size=Lt.type=0,Lt.start=U,Lt.name=""),Lt.type===5?(De=Lt.start,xe>0&&De!==U&&(ue[De].name="!StreamData")):Lt.size>=4096?(Lt.storage="fat",ue[Lt.start]===void 0&&(ue[Lt.start]=b(J,Lt.start,ue.fat_addrs,ue.ssz)),ue[Lt.start].name=Lt.name,Lt.content=ue[Lt.start].data.slice(0,Lt.size)):(Lt.storage="minifat",Lt.size<0?Lt.size=0:De!==U&&Lt.start!==U&&ue[De]&&(Lt.content=g(Lt,ue[De].data,(ue[Ve]||{}).data))),Lt.content&&go(Lt.content,0),Ne[zt]=Lt,St.push(Lt)}}function S(se,ue){return new Date((Xl(se,ue+4)/1e7*Math.pow(2,32)+Xl(se,ue)/1e7-11644473600)*1e3)}function j(se,ue){return u(),d(c.readFileSync(se),ue)}function k(se,ue){var J=ue&&ue.type;switch(J||gi&&Buffer.isBuffer(se)&&(J="buffer"),J||"base64"){case"file":return j(se,ue);case"base64":return d(Ql(cc(se)),ue);case"binary":return d(Ql(se),ue)}return d(se,ue)}function A(se,ue){var J=ue||{},pe=J.root||"Root Entry";if(se.FullPaths||(se.FullPaths=[]),se.FileIndex||(se.FileIndex=[]),se.FullPaths.length!==se.FileIndex.length)throw new Error("inconsistent CFB structure");se.FullPaths.length===0&&(se.FullPaths[0]=pe+"/",se.FileIndex[0]={name:pe,type:5}),J.CLSID&&(se.FileIndex[0].clsid=J.CLSID),R(se)}function R(se){var ue="Sh33tJ5";if(!qn.find(se,"/"+ue)){var J=kr(4);J[0]=55,J[1]=J[3]=50,J[2]=54,se.FileIndex.push({name:ue,type:2,content:J,size:4,L:69,R:69,C:69}),se.FullPaths.push(se.FullPaths[0]+ue),M(se)}}function M(se,ue){A(se);for(var J=!1,pe=!1,xe=se.FullPaths.length-1;xe>=0;--xe){var Ne=se.FileIndex[xe];switch(Ne.type){case 0:pe?J=!0:(se.FileIndex.pop(),se.FullPaths.pop());break;case 1:case 2:case 5:pe=!0,isNaN(Ne.R*Ne.L*Ne.C)&&(J=!0),Ne.R>-1&&Ne.L>-1&&Ne.R==Ne.L&&(J=!0);break;default:J=!0;break}}if(!(!J&&!ue)){var St=new Date(1987,1,19),Ve=0,De=Object.create?Object.create(null):{},Re=[];for(xe=0;xe<se.FullPaths.length;++xe)De[se.FullPaths[xe]]=!0,se.FileIndex[xe].type!==0&&Re.push([se.FullPaths[xe],se.FileIndex[xe]]);for(xe=0;xe<Re.length;++xe){var xt=n(Re[xe][0]);pe=De[xt],pe||(Re.push([xt,{name:i(xt).replace("/",""),type:1,clsid:oe,ct:St,mt:St,content:null}]),De[xt]=!0)}for(Re.sort(function(zt,vt){return r(zt[0],vt[0])}),se.FullPaths=[],se.FileIndex=[],xe=0;xe<Re.length;++xe)se.FullPaths[xe]=Re[xe][0],se.FileIndex[xe]=Re[xe][1];for(xe=0;xe<Re.length;++xe){var Vt=se.FileIndex[xe],qt=se.FullPaths[xe];if(Vt.name=i(qt).replace("/",""),Vt.L=Vt.R=Vt.C=-(Vt.color=1),Vt.size=Vt.content?Vt.content.length:0,Vt.start=0,Vt.clsid=Vt.clsid||oe,xe===0)Vt.C=Re.length>1?1:-1,Vt.size=0,Vt.type=5;else if(qt.slice(-1)=="/"){for(Ve=xe+1;Ve<Re.length&&n(se.FullPaths[Ve])!=qt;++Ve);for(Vt.C=Ve>=Re.length?-1:Ve,Ve=xe+1;Ve<Re.length&&n(se.FullPaths[Ve])!=n(qt);++Ve);Vt.R=Ve>=Re.length?-1:Ve,Vt.type=1}else n(se.FullPaths[xe+1]||"")==n(qt)&&(Vt.R=xe+1),Vt.type=2}}}function B(se,ue){var J=ue||{};if(J.fileType=="mad")return ut(se,J);switch(M(se),J.fileType){case"zip":return Ur(se,J)}var pe=function(zt){for(var vt=0,Lt=0,er=0;er<zt.FileIndex.length;++er){var yr=zt.FileIndex[er];if(yr.content){var Br=yr.content.length;Br>0&&(Br<4096?vt+=Br+63>>6:Lt+=Br+511>>9)}}for(var cr=zt.FullPaths.length+3>>2,ur=vt+7>>3,en=vt+127>>7,nn=ur+Lt+cr+en,gn=nn+127>>7,nr=gn<=109?0:Math.ceil((gn-109)/127);nn+gn+nr+127>>7>gn;)nr=++gn<=109?0:Math.ceil((gn-109)/127);var Tr=[1,nr,gn,en,cr,Lt,vt,0];return zt.FileIndex[0].size=vt<<6,Tr[7]=(zt.FileIndex[0].start=Tr[0]+Tr[1]+Tr[2]+Tr[3]+Tr[4]+Tr[5])+(Tr[6]+7>>3),Tr}(se),xe=kr(pe[7]<<9),Ne=0,St=0;{for(Ne=0;Ne<8;++Ne)xe.write_shift(1,H[Ne]);for(Ne=0;Ne<8;++Ne)xe.write_shift(2,0);for(xe.write_shift(2,62),xe.write_shift(2,3),xe.write_shift(2,65534),xe.write_shift(2,9),xe.write_shift(2,6),Ne=0;Ne<3;++Ne)xe.write_shift(2,0);for(xe.write_shift(4,0),xe.write_shift(4,pe[2]),xe.write_shift(4,pe[0]+pe[1]+pe[2]+pe[3]-1),xe.write_shift(4,0),xe.write_shift(4,4096),xe.write_shift(4,pe[3]?pe[0]+pe[1]+pe[2]-1:U),xe.write_shift(4,pe[3]),xe.write_shift(-4,pe[1]?pe[0]-1:U),xe.write_shift(4,pe[1]),Ne=0;Ne<109;++Ne)xe.write_shift(-4,Ne<pe[2]?pe[1]+Ne:-1)}if(pe[1])for(St=0;St<pe[1];++St){for(;Ne<236+St*127;++Ne)xe.write_shift(-4,Ne<pe[2]?pe[1]+Ne:-1);xe.write_shift(-4,St===pe[1]-1?U:St+1)}var Ve=function(zt){for(St+=zt;Ne<St-1;++Ne)xe.write_shift(-4,Ne+1);zt&&(++Ne,xe.write_shift(-4,U))};for(St=Ne=0,St+=pe[1];Ne<St;++Ne)xe.write_shift(-4,de.DIFSECT);for(St+=pe[2];Ne<St;++Ne)xe.write_shift(-4,de.FATSECT);Ve(pe[3]),Ve(pe[4]);for(var De=0,Re=0,xt=se.FileIndex[0];De<se.FileIndex.length;++De)xt=se.FileIndex[De],xt.content&&(Re=xt.content.length,!(Re<4096)&&(xt.start=St,Ve(Re+511>>9)));for(Ve(pe[6]+7>>3);xe.l&511;)xe.write_shift(-4,de.ENDOFCHAIN);for(St=Ne=0,De=0;De<se.FileIndex.length;++De)xt=se.FileIndex[De],xt.content&&(Re=xt.content.length,!(!Re||Re>=4096)&&(xt.start=St,Ve(Re+63>>6)));for(;xe.l&511;)xe.write_shift(-4,de.ENDOFCHAIN);for(Ne=0;Ne<pe[4]<<2;++Ne){var Vt=se.FullPaths[Ne];if(!Vt||Vt.length===0){for(De=0;De<17;++De)xe.write_shift(4,0);for(De=0;De<3;++De)xe.write_shift(4,-1);for(De=0;De<12;++De)xe.write_shift(4,0);continue}xt=se.FileIndex[Ne],Ne===0&&(xt.start=xt.size?xt.start-1:U);var qt=Ne===0&&J.root||xt.name;if(Re=2*(qt.length+1),xe.write_shift(64,qt,"utf16le"),xe.write_shift(2,Re),xe.write_shift(1,xt.type),xe.write_shift(1,xt.color),xe.write_shift(-4,xt.L),xe.write_shift(-4,xt.R),xe.write_shift(-4,xt.C),xt.clsid)xe.write_shift(16,xt.clsid,"hex");else for(De=0;De<4;++De)xe.write_shift(4,0);xe.write_shift(4,xt.state||0),xe.write_shift(4,0),xe.write_shift(4,0),xe.write_shift(4,0),xe.write_shift(4,0),xe.write_shift(4,xt.start),xe.write_shift(4,xt.size),xe.write_shift(4,0)}for(Ne=1;Ne<se.FileIndex.length;++Ne)if(xt=se.FileIndex[Ne],xt.size>=4096)if(xe.l=xt.start+1<<9,gi&&Buffer.isBuffer(xt.content))xt.content.copy(xe,xe.l,0,xt.size),xe.l+=xt.size+511&-512;else{for(De=0;De<xt.size;++De)xe.write_shift(1,xt.content[De]);for(;De&511;++De)xe.write_shift(1,0)}for(Ne=1;Ne<se.FileIndex.length;++Ne)if(xt=se.FileIndex[Ne],xt.size>0&&xt.size<4096)if(gi&&Buffer.isBuffer(xt.content))xt.content.copy(xe,xe.l,0,xt.size),xe.l+=xt.size+63&-64;else{for(De=0;De<xt.size;++De)xe.write_shift(1,xt.content[De]);for(;De&63;++De)xe.write_shift(1,0)}if(gi)xe.l=xe.length;else for(;xe.l<xe.length;)xe.write_shift(1,0);return xe}function E(se,ue){var J=se.FullPaths.map(function(De){return De.toUpperCase()}),pe=J.map(function(De){var Re=De.split("/");return Re[Re.length-(De.slice(-1)=="/"?2:1)]}),xe=!1;ue.charCodeAt(0)===47?(xe=!0,ue=J[0].slice(0,-1)+ue):xe=ue.indexOf("/")!==-1;var Ne=ue.toUpperCase(),St=xe===!0?J.indexOf(Ne):pe.indexOf(Ne);if(St!==-1)return se.FileIndex[St];var Ve=!Ne.match(px);for(Ne=Ne.replace(al,""),Ve&&(Ne=Ne.replace(px,"!")),St=0;St<J.length;++St)if((Ve?J[St].replace(px,"!"):J[St]).replace(al,"")==Ne||(Ve?pe[St].replace(px,"!"):pe[St]).replace(al,"")==Ne)return se.FileIndex[St];return null}var P=64,U=-2,G="d0cf11e0a1b11ae1",H=[208,207,17,224,161,177,26,225],oe="00000000000000000000000000000000",de={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:U,FREESECT:-1,HEADER_SIGNATURE:G,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:oe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function W(se,ue,J){u();var pe=B(se,J);c.writeFileSync(ue,pe)}function V(se){for(var ue=new Array(se.length),J=0;J<se.length;++J)ue[J]=String.fromCharCode(se[J]);return ue.join("")}function ae(se,ue){var J=B(se,ue);switch(ue&&ue.type||"buffer"){case"file":return u(),c.writeFileSync(ue.filename,J),J;case"binary":return typeof J=="string"?J:V(J);case"base64":return u1(typeof J=="string"?J:V(J));case"buffer":if(gi)return Buffer.isBuffer(J)?J:uf(J);case"array":return typeof J=="string"?Ql(J):J}return J}var ee;function C(se){try{var ue=se.InflateRaw,J=new ue;if(J._processChunk(new Uint8Array([3,0]),J._finishFlushFlag),J.bytesRead)ee=se;else throw new Error("zlib does not expose bytesRead")}catch(pe){console.error("cannot use native zlib: "+(pe.message||pe))}}function Y(se,ue){if(!ee)return xr(se,ue);var J=ee.InflateRaw,pe=new J,xe=pe._processChunk(se.slice(se.l),pe._finishFlushFlag);return se.l+=pe.bytesRead,xe}function q(se){return ee?ee.deflateRawSync(se):ce(se)}var O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],F=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Q(se){var ue=(se<<1|se<<11)&139536|(se<<5|se<<15)&558144;return(ue>>16|ue>>8|ue)&255}for(var K=typeof Uint8Array<"u",ne=K?new Uint8Array(256):[],re=0;re<256;++re)ne[re]=Q(re);function T(se,ue){var J=ne[se&255];return ue<=8?J>>>8-ue:(J=J<<8|ne[se>>8&255],ue<=16?J>>>16-ue:(J=J<<8|ne[se>>16&255],J>>>24-ue))}function I(se,ue){var J=ue&7,pe=ue>>>3;return(se[pe]|(J<=6?0:se[pe+1]<<8))>>>J&3}function ie(se,ue){var J=ue&7,pe=ue>>>3;return(se[pe]|(J<=5?0:se[pe+1]<<8))>>>J&7}function D(se,ue){var J=ue&7,pe=ue>>>3;return(se[pe]|(J<=4?0:se[pe+1]<<8))>>>J&15}function Z(se,ue){var J=ue&7,pe=ue>>>3;return(se[pe]|(J<=3?0:se[pe+1]<<8))>>>J&31}function me(se,ue){var J=ue&7,pe=ue>>>3;return(se[pe]|(J<=1?0:se[pe+1]<<8))>>>J&127}function Te(se,ue,J){var pe=ue&7,xe=ue>>>3,Ne=(1<<J)-1,St=se[xe]>>>pe;return J<8-pe||(St|=se[xe+1]<<8-pe,J<16-pe)||(St|=se[xe+2]<<16-pe,J<24-pe)||(St|=se[xe+3]<<24-pe),St&Ne}function je(se,ue,J){var pe=ue&7,xe=ue>>>3;return pe<=5?se[xe]|=(J&7)<<pe:(se[xe]|=J<<pe&255,se[xe+1]=(J&7)>>8-pe),ue+3}function Le(se,ue,J){var pe=ue&7,xe=ue>>>3;return J=(J&1)<<pe,se[xe]|=J,ue+1}function _e(se,ue,J){var pe=ue&7,xe=ue>>>3;return J<<=pe,se[xe]|=J&255,J>>>=8,se[xe+1]=J,ue+8}function He(se,ue,J){var pe=ue&7,xe=ue>>>3;return J<<=pe,se[xe]|=J&255,J>>>=8,se[xe+1]=J&255,se[xe+2]=J>>>8,ue+16}function We(se,ue){var J=se.length,pe=2*J>ue?2*J:ue+5,xe=0;if(J>=ue)return se;if(gi){var Ne=iP(pe);if(se.copy)se.copy(Ne);else for(;xe<se.length;++xe)Ne[xe]=se[xe];return Ne}else if(K){var St=new Uint8Array(pe);if(St.set)St.set(se);else for(;xe<J;++xe)St[xe]=se[xe];return St}return se.length=pe,se}function Pt(se){for(var ue=new Array(se),J=0;J<se;++J)ue[J]=0;return ue}function dt(se,ue,J){var pe=1,xe=0,Ne=0,St=0,Ve=0,De=se.length,Re=K?new Uint16Array(32):Pt(32);for(Ne=0;Ne<32;++Ne)Re[Ne]=0;for(Ne=De;Ne<J;++Ne)se[Ne]=0;De=se.length;var xt=K?new Uint16Array(De):Pt(De);for(Ne=0;Ne<De;++Ne)Re[xe=se[Ne]]++,pe<xe&&(pe=xe),xt[Ne]=0;for(Re[0]=0,Ne=1;Ne<=pe;++Ne)Re[Ne+16]=Ve=Ve+Re[Ne-1]<<1;for(Ne=0;Ne<De;++Ne)Ve=se[Ne],Ve!=0&&(xt[Ne]=Re[Ve+16]++);var Vt=0;for(Ne=0;Ne<De;++Ne)if(Vt=se[Ne],Vt!=0)for(Ve=T(xt[Ne],pe)>>pe-Vt,St=(1<<pe+4-Vt)-1;St>=0;--St)ue[Ve|St<<Vt]=Vt&15|Ne<<4;return pe}var Ye=K?new Uint16Array(512):Pt(512),lt=K?new Uint16Array(32):Pt(32);if(!K){for(var be=0;be<512;++be)Ye[be]=0;for(be=0;be<32;++be)lt[be]=0}(function(){for(var se=[],ue=0;ue<32;ue++)se.push(5);dt(se,lt,32);var J=[];for(ue=0;ue<=143;ue++)J.push(8);for(;ue<=255;ue++)J.push(9);for(;ue<=279;ue++)J.push(7);for(;ue<=287;ue++)J.push(8);dt(J,Ye,288)})();var ke=function(){for(var ue=K?new Uint8Array(32768):[],J=0,pe=0;J<F.length-1;++J)for(;pe<F[J+1];++pe)ue[pe]=J;for(;pe<32768;++pe)ue[pe]=29;var xe=K?new Uint8Array(259):[];for(J=0,pe=0;J<X.length-1;++J)for(;pe<X[J+1];++pe)xe[pe]=J;function Ne(Ve,De){for(var Re=0;Re<Ve.length;){var xt=Math.min(65535,Ve.length-Re),Vt=Re+xt==Ve.length;for(De.write_shift(1,+Vt),De.write_shift(2,xt),De.write_shift(2,~xt&65535);xt-- >0;)De[De.l++]=Ve[Re++]}return De.l}function St(Ve,De){for(var Re=0,xt=0,Vt=K?new Uint16Array(32768):[];xt<Ve.length;){var qt=Math.min(65535,Ve.length-xt);if(qt<10){for(Re=je(De,Re,+(xt+qt==Ve.length)),Re&7&&(Re+=8-(Re&7)),De.l=Re/8|0,De.write_shift(2,qt),De.write_shift(2,~qt&65535);qt-- >0;)De[De.l++]=Ve[xt++];Re=De.l*8;continue}Re=je(De,Re,+(xt+qt==Ve.length)+2);for(var zt=0;qt-- >0;){var vt=Ve[xt];zt=(zt<<5^vt)&32767;var Lt=-1,er=0;if((Lt=Vt[zt])&&(Lt|=xt&-32768,Lt>xt&&(Lt-=32768),Lt<xt))for(;Ve[Lt+er]==Ve[xt+er]&&er<250;)++er;if(er>2){vt=xe[er],vt<=22?Re=_e(De,Re,ne[vt+1]>>1)-1:(_e(De,Re,3),Re+=5,_e(De,Re,ne[vt-23]>>5),Re+=3);var yr=vt<8?0:vt-4>>2;yr>0&&(He(De,Re,er-X[vt]),Re+=yr),vt=ue[xt-Lt],Re=_e(De,Re,ne[vt]>>3),Re-=3;var Br=vt<4?0:vt-2>>1;Br>0&&(He(De,Re,xt-Lt-F[vt]),Re+=Br);for(var cr=0;cr<er;++cr)Vt[zt]=xt&32767,zt=(zt<<5^Ve[xt])&32767,++xt;qt-=er-1}else vt<=143?vt=vt+48:Re=Le(De,Re,1),Re=_e(De,Re,ne[vt]),Vt[zt]=xt&32767,++xt}Re=_e(De,Re,0)-1}return De.l=(Re+7)/8|0,De.l}return function(De,Re){return De.length<8?Ne(De,Re):St(De,Re)}}();function ce(se){var ue=kr(50+Math.floor(se.length*1.1)),J=ke(se,ue);return ue.slice(0,J)}var we=K?new Uint16Array(32768):Pt(32768),ht=K?new Uint16Array(32768):Pt(32768),nt=K?new Uint16Array(128):Pt(128),Ie=1,It=1;function ct(se,ue){var J=Z(se,ue)+257;ue+=5;var pe=Z(se,ue)+1;ue+=5;var xe=D(se,ue)+4;ue+=4;for(var Ne=0,St=K?new Uint8Array(19):Pt(19),Ve=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],De=1,Re=K?new Uint8Array(8):Pt(8),xt=K?new Uint8Array(8):Pt(8),Vt=St.length,qt=0;qt<xe;++qt)St[O[qt]]=Ne=ie(se,ue),De<Ne&&(De=Ne),Re[Ne]++,ue+=3;var zt=0;for(Re[0]=0,qt=1;qt<=De;++qt)xt[qt]=zt=zt+Re[qt-1]<<1;for(qt=0;qt<Vt;++qt)(zt=St[qt])!=0&&(Ve[qt]=xt[zt]++);var vt=0;for(qt=0;qt<Vt;++qt)if(vt=St[qt],vt!=0){zt=ne[Ve[qt]]>>8-vt;for(var Lt=(1<<7-vt)-1;Lt>=0;--Lt)nt[zt|Lt<<vt]=vt&7|qt<<3}var er=[];for(De=1;er.length<J+pe;)switch(zt=nt[me(se,ue)],ue+=zt&7,zt>>>=3){case 16:for(Ne=3+I(se,ue),ue+=2,zt=er[er.length-1];Ne-- >0;)er.push(zt);break;case 17:for(Ne=3+ie(se,ue),ue+=3;Ne-- >0;)er.push(0);break;case 18:for(Ne=11+me(se,ue),ue+=7;Ne-- >0;)er.push(0);break;default:er.push(zt),De<zt&&(De=zt);break}var yr=er.slice(0,J),Br=er.slice(J);for(qt=J;qt<286;++qt)yr[qt]=0;for(qt=pe;qt<30;++qt)Br[qt]=0;return Ie=dt(yr,we,286),It=dt(Br,ht,30),ue}function Mt(se,ue){if(se[0]==3&&!(se[1]&3))return[hh(ue),2];for(var J=0,pe=0,xe=iP(ue||1<<18),Ne=0,St=xe.length>>>0,Ve=0,De=0;!(pe&1);){if(pe=ie(se,J),J+=3,pe>>>1)pe>>1==1?(Ve=9,De=5):(J=ct(se,J),Ve=Ie,De=It);else{J&7&&(J+=8-(J&7));var Re=se[J>>>3]|se[(J>>>3)+1]<<8;if(J+=32,Re>0)for(!ue&&St<Ne+Re&&(xe=We(xe,Ne+Re),St=xe.length);Re-- >0;)xe[Ne++]=se[J>>>3],J+=8;continue}for(;;){!ue&&St<Ne+32767&&(xe=We(xe,Ne+32767),St=xe.length);var xt=Te(se,J,Ve),Vt=pe>>>1==1?Ye[xt]:we[xt];if(J+=Vt&15,Vt>>>=4,!(Vt>>>8&255))xe[Ne++]=Vt;else{if(Vt==256)break;Vt-=257;var qt=Vt<8?0:Vt-4>>2;qt>5&&(qt=0);var zt=Ne+X[Vt];qt>0&&(zt+=Te(se,J,qt),J+=qt),xt=Te(se,J,De),Vt=pe>>>1==1?lt[xt]:ht[xt],J+=Vt&15,Vt>>>=4;var vt=Vt<4?0:Vt-2>>1,Lt=F[Vt];for(vt>0&&(Lt+=Te(se,J,vt),J+=vt),!ue&&St<zt&&(xe=We(xe,zt+100),St=xe.length);Ne<zt;)xe[Ne]=xe[Ne-Lt],++Ne}}}return ue?[xe,J+7>>>3]:[xe.slice(0,Ne),J+7>>>3]}function xr(se,ue){var J=se.slice(se.l||0),pe=Mt(J,ue);return se.l+=pe[1],pe[0]}function Pr(se,ue){if(se)typeof console<"u"&&console.error(ue);else throw new Error(ue)}function Nt(se,ue){var J=se;go(J,0);var pe=[],xe=[],Ne={FileIndex:pe,FullPaths:xe};A(Ne,{root:ue.root});for(var St=J.length-4;(J[St]!=80||J[St+1]!=75||J[St+2]!=5||J[St+3]!=6)&&St>=0;)--St;J.l=St+4,J.l+=4;var Ve=J.read_shift(2);J.l+=6;var De=J.read_shift(4);for(J.l=De,St=0;St<Ve;++St){J.l+=20;var Re=J.read_shift(4),xt=J.read_shift(4),Vt=J.read_shift(2),qt=J.read_shift(2),zt=J.read_shift(2);J.l+=8;var vt=J.read_shift(4),Lt=l(J.slice(J.l+Vt,J.l+Vt+qt));J.l+=Vt+qt+zt;var er=J.l;J.l=vt+4,Jr(J,Re,xt,Ne,Lt),J.l=er}return Ne}function Jr(se,ue,J,pe,xe){se.l+=2;var Ne=se.read_shift(2),St=se.read_shift(2),Ve=o(se);if(Ne&8257)throw new Error("Unsupported ZIP encryption");for(var De=se.read_shift(4),Re=se.read_shift(4),xt=se.read_shift(4),Vt=se.read_shift(2),qt=se.read_shift(2),zt="",vt=0;vt<Vt;++vt)zt+=String.fromCharCode(se[se.l++]);if(qt){var Lt=l(se.slice(se.l,se.l+qt));(Lt[21589]||{}).mt&&(Ve=Lt[21589].mt),((xe||{})[21589]||{}).mt&&(Ve=xe[21589].mt)}se.l+=qt;var er=se.slice(se.l,se.l+Re);switch(St){case 8:er=Y(se,xt);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+St)}var yr=!1;Ne&8&&(De=se.read_shift(4),De==134695760&&(De=se.read_shift(4),yr=!0),Re=se.read_shift(4),xt=se.read_shift(4)),Re!=ue&&Pr(yr,"Bad compressed size: "+ue+" != "+Re),xt!=J&&Pr(yr,"Bad uncompressed size: "+J+" != "+xt),At(pe,zt,er,{unsafe:!0,mt:Ve})}function Ur(se,ue){var J=ue||{},pe=[],xe=[],Ne=kr(1),St=J.compression?8:0,Ve=0,De=0,Re=0,xt=0,Vt=0,qt=se.FullPaths[0],zt=qt,vt=se.FileIndex[0],Lt=[],er=0;for(De=1;De<se.FullPaths.length;++De)if(zt=se.FullPaths[De].slice(qt.length),vt=se.FileIndex[De],!(!vt.size||!vt.content||zt=="Sh33tJ5")){var yr=xt,Br=kr(zt.length);for(Re=0;Re<zt.length;++Re)Br.write_shift(1,zt.charCodeAt(Re)&127);Br=Br.slice(0,Br.l),Lt[Vt]=Wne.buf(vt.content,0);var cr=vt.content;St==8&&(cr=q(cr)),Ne=kr(30),Ne.write_shift(4,67324752),Ne.write_shift(2,20),Ne.write_shift(2,Ve),Ne.write_shift(2,St),vt.mt?s(Ne,vt.mt):Ne.write_shift(4,0),Ne.write_shift(-4,Lt[Vt]),Ne.write_shift(4,cr.length),Ne.write_shift(4,vt.content.length),Ne.write_shift(2,Br.length),Ne.write_shift(2,0),xt+=Ne.length,pe.push(Ne),xt+=Br.length,pe.push(Br),xt+=cr.length,pe.push(cr),Ne=kr(46),Ne.write_shift(4,33639248),Ne.write_shift(2,0),Ne.write_shift(2,20),Ne.write_shift(2,Ve),Ne.write_shift(2,St),Ne.write_shift(4,0),Ne.write_shift(-4,Lt[Vt]),Ne.write_shift(4,cr.length),Ne.write_shift(4,vt.content.length),Ne.write_shift(2,Br.length),Ne.write_shift(2,0),Ne.write_shift(2,0),Ne.write_shift(2,0),Ne.write_shift(2,0),Ne.write_shift(4,0),Ne.write_shift(4,yr),er+=Ne.l,xe.push(Ne),er+=Br.length,xe.push(Br),++Vt}return Ne=kr(22),Ne.write_shift(4,101010256),Ne.write_shift(2,0),Ne.write_shift(2,0),Ne.write_shift(2,Vt),Ne.write_shift(2,Vt),Ne.write_shift(4,er),Ne.write_shift(4,xt),Ne.write_shift(2,0),Ks([Ks(pe),Ks(xe),Ne])}var qr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function cn(se,ue){if(se.ctype)return se.ctype;var J=se.name||"",pe=J.match(/\.([^\.]+)$/);return pe&&qr[pe[1]]||ue&&(pe=(J=ue).match(/[\.\\]([^\.\\])+$/),pe&&qr[pe[1]])?qr[pe[1]]:"application/octet-stream"}function Pn(se){for(var ue=u1(se),J=[],pe=0;pe<ue.length;pe+=76)J.push(ue.slice(pe,pe+76));return J.join(`\r
`)+`\r
`}function Lr(se){var ue=se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Re){var xt=Re.charCodeAt(0).toString(16).toUpperCase();return"="+(xt.length==1?"0"+xt:xt)});ue=ue.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ue.charAt(0)==`
`&&(ue="=0D"+ue.slice(1)),ue=ue.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var J=[],pe=ue.split(`\r
`),xe=0;xe<pe.length;++xe){var Ne=pe[xe];if(Ne.length==0){J.push("");continue}for(var St=0;St<Ne.length;){var Ve=76,De=Ne.slice(St,St+Ve);De.charAt(Ve-1)=="="?Ve--:De.charAt(Ve-2)=="="?Ve-=2:De.charAt(Ve-3)=="="&&(Ve-=3),De=Ne.slice(St,St+Ve),St+=Ve,St<Ne.length&&(De+="="),J.push(De)}}return J.join(`\r
`)}function mn(se){for(var ue=[],J=0;J<se.length;++J){for(var pe=se[J];J<=se.length&&pe.charAt(pe.length-1)=="=";)pe=pe.slice(0,pe.length-1)+se[++J];ue.push(pe)}for(var xe=0;xe<ue.length;++xe)ue[xe]=ue[xe].replace(/[=][0-9A-Fa-f]{2}/g,function(Ne){return String.fromCharCode(parseInt(Ne.slice(1),16))});return Ql(ue.join(`\r
`))}function Me(se,ue,J){for(var pe="",xe="",Ne="",St,Ve=0;Ve<10;++Ve){var De=ue[Ve];if(!De||De.match(/^\s*$/))break;var Re=De.match(/^(.*?):\s*([^\s].*)$/);if(Re)switch(Re[1].toLowerCase()){case"content-location":pe=Re[2].trim();break;case"content-type":Ne=Re[2].trim();break;case"content-transfer-encoding":xe=Re[2].trim();break}}switch(++Ve,xe.toLowerCase()){case"base64":St=Ql(cc(ue.slice(Ve).join("")));break;case"quoted-printable":St=mn(ue.slice(Ve));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+xe)}var xt=At(se,pe.slice(J.length),St,{unsafe:!0});Ne&&(xt.ctype=Ne)}function qe(se,ue){if(V(se.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var J=ue&&ue.root||"",pe=(gi&&Buffer.isBuffer(se)?se.toString("binary"):V(se)).split(`\r
`),xe=0,Ne="";for(xe=0;xe<pe.length;++xe)if(Ne=pe[xe],!!/^Content-Location:/i.test(Ne)&&(Ne=Ne.slice(Ne.indexOf("file")),J||(J=Ne.slice(0,Ne.lastIndexOf("/")+1)),Ne.slice(0,J.length)!=J))for(;J.length>0&&(J=J.slice(0,J.length-1),J=J.slice(0,J.lastIndexOf("/")+1),Ne.slice(0,J.length)!=J););var St=(pe[1]||"").match(/boundary="(.*?)"/);if(!St)throw new Error("MAD cannot find boundary");var Ve="--"+(St[1]||""),De=[],Re=[],xt={FileIndex:De,FullPaths:Re};A(xt);var Vt,qt=0;for(xe=0;xe<pe.length;++xe){var zt=pe[xe];zt!==Ve&&zt!==Ve+"--"||(qt++&&Me(xt,pe.slice(Vt,xe),J),Vt=xe)}return xt}function ut(se,ue){var J=ue||{},pe=J.boundary||"SheetJS";pe="------="+pe;for(var xe=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+pe.slice(2)+'"',"","",""],Ne=se.FullPaths[0],St=Ne,Ve=se.FileIndex[0],De=1;De<se.FullPaths.length;++De)if(St=se.FullPaths[De].slice(Ne.length),Ve=se.FileIndex[De],!(!Ve.size||!Ve.content||St=="Sh33tJ5")){St=St.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(er){return"_x"+er.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(er){return"_u"+er.charCodeAt(0).toString(16)+"_"});for(var Re=Ve.content,xt=gi&&Buffer.isBuffer(Re)?Re.toString("binary"):V(Re),Vt=0,qt=Math.min(1024,xt.length),zt=0,vt=0;vt<=qt;++vt)(zt=xt.charCodeAt(vt))>=32&&zt<128&&++Vt;var Lt=Vt>=qt*4/5;xe.push(pe),xe.push("Content-Location: "+(J.root||"file:///C:/SheetJS/")+St),xe.push("Content-Transfer-Encoding: "+(Lt?"quoted-printable":"base64")),xe.push("Content-Type: "+cn(Ve,St)),xe.push(""),xe.push(Lt?Lr(xt):Pn(xt))}return xe.push(pe+`--\r
`),xe.join(`\r
`)}function wt(se){var ue={};return A(ue,se),ue}function At(se,ue,J,pe){var xe=pe&&pe.unsafe;xe||A(se);var Ne=!xe&&qn.find(se,ue);if(!Ne){var St=se.FullPaths[0];ue.slice(0,St.length)==St?St=ue:(St.slice(-1)!="/"&&(St+="/"),St=(St+ue).replace("//","/")),Ne={name:i(ue),type:2},se.FileIndex.push(Ne),se.FullPaths.push(St),xe||qn.utils.cfb_gc(se)}return Ne.content=J,Ne.size=J?J.length:0,pe&&(pe.CLSID&&(Ne.clsid=pe.CLSID),pe.mt&&(Ne.mt=pe.mt),pe.ct&&(Ne.ct=pe.ct)),Ne}function sr(se,ue){A(se);var J=qn.find(se,ue);if(J){for(var pe=0;pe<se.FileIndex.length;++pe)if(se.FileIndex[pe]==J)return se.FileIndex.splice(pe,1),se.FullPaths.splice(pe,1),!0}return!1}function Zt(se,ue,J){A(se);var pe=qn.find(se,ue);if(pe){for(var xe=0;xe<se.FileIndex.length;++xe)if(se.FileIndex[xe]==pe)return se.FileIndex[xe].name=i(J),se.FullPaths[xe]=J,!0}return!1}function Cr(se){M(se,!0)}return t.find=E,t.read=k,t.parse=d,t.write=ae,t.writeFile=W,t.utils={cfb_new:wt,cfb_add:At,cfb_del:sr,cfb_mov:Zt,cfb_gc:Cr,ReadShift:Ex,CheckField:j$,prep_blob:go,bconcat:Ks,use_zlib:C,_deflateRaw:ce,_inflateRaw:xr,consts:de},t}();function qne(e){return typeof e=="string"?AS(e):Array.isArray(e)?gne(e):e}function ry(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=AS(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Ku(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([qne(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=kh(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function Hne(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Ka(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function fP(e,t){for(var r=[],n=Ka(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function CS(e){for(var t=[],r=Ka(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function ES(e){for(var t=[],r=Ka(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function Vne(e){for(var t=[],r=Ka(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var D2=new Date(1899,11,30,0,0,0);function Ls(e,t){var r=e.getTime(),n=D2.getTime()+(e.getTimezoneOffset()-D2.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var n$=new Date,Gne=D2.getTime()+(n$.getTimezoneOffset()-D2.getTimezoneOffset())*6e4,hP=n$.getTimezoneOffset();function TS(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Gne),t.getTimezoneOffset()!==hP&&t.setTime(t.getTime()+(t.getTimezoneOffset()-hP)*6e4),t}function Kne(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[s],10)}return t}var pP=new Date("2017-02-19T19:06:09.000Z"),i$=isNaN(pP.getFullYear())?new Date("2/19/17"):pP,Yne=i$.getFullYear()==2017;function xa(e,t){var r=new Date(e);if(Yne)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(i$.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function _0(e,t){if(gi&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Ku(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ku(H9(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Ku(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ku(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function ya(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=ya(e[r]));return t}function qa(e,t){for(var r="";r.length<t;)r+=e;return r}function mu(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var Xne=["january","february","march","april","may","june","july","august","september","october","november","december"];function $m(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&Xne.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Qne=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),o=[s[0]],l=1;l<s.length;++l)o.push(i),o.push(s[l]);return o}}();function a$(e){return e?e.content&&e.type?_0(e.content,!0):e.data?hx(e.data):e.asNodeBuffer&&gi?hx(e.asNodeBuffer().toString("binary")):e.asBinary?hx(e.asBinary()):e._data&&e._data.getContent?hx(_0(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function s$(e){if(!e)return null;if(e.data)return rP(e.data);if(e.asNodeBuffer&&gi)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?rP(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Jne(e){return e&&e.name.slice(-4)===".bin"?s$(e):a$(e)}function Oc(e,t){for(var r=e.FullPaths||Ka(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function R3(e,t){var r=Oc(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function hs(e,t,r){if(!r)return Jne(R3(e,t));if(!t)return null;try{return hs(e,t)}catch{return null}}function Jl(e,t,r){if(!r)return a$(R3(e,t));if(!t)return null;try{return Jl(e,t)}catch{return null}}function Zne(e,t,r){return s$(R3(e,t))}function mP(e){for(var t=e.FullPaths||Ka(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function hi(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return gi?n=uf(r):n=xne(r),qn.utils.cfb_add(e,t,n)}qn.utils.cfb_add(e,t,r)}else e.file(t,r)}function F3(){return qn.utils.cfb_new()}function o$(e,t){switch(t.type){case"base64":return qn.read(e,{type:"base64"});case"binary":return qn.read(e,{type:"binary"});case"buffer":case"array":return qn.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function mx(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var ls=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,eie=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,gP=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,tie=/<[^>]*>/g,Go=ls.match(gP)?gP:tie,rie=/<\w*:/,nie=/<(\/?)\w+:/;function Xn(e,t,r){for(var n={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var o=e.match(eie),l=0,c="",u=0,d="",f="",h=1;if(o)for(u=0;u!=o.length;++u){for(f=o[u],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(d=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(h=(i=f.charCodeAt(s+1))==34||i==39?1:0,c=f.slice(s+1+h,f.length-h),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,n[d.toLowerCase()]=c;else{var p=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(n[p]&&d.slice(l-3,l)=="ext")continue;n[p]=c,n[p.toLowerCase()]=c}}return n}function ld(e){return e.replace(nie,"<$1")}var l$={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},B3=CS(l$),Ai=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(l,c){return l$[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,o)+r(i.slice(o+3))}}(),I3=/[&<>'"]/g,iie=/[\u0000-\u0008\u000b-\u001f]/g;function Vi(e){var t=e+"";return t.replace(I3,function(r){return B3[r]}).replace(iie,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function xP(e){return Vi(e).replace(/ /g,"_x0020_")}var c$=/[\u0000-\u001f]/g;function D3(e){var t=e+"";return t.replace(I3,function(r){return B3[r]}).replace(/\n/g,"<br/>").replace(c$,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function aie(e){var t=e+"";return t.replace(I3,function(r){return B3[r]}).replace(c$,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var yP=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function sie(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function pa(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function J5(e){for(var t="",r=0,n=0,i=0,s=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function bP(e){var t=hh(2*e.length),r,n,i=1,s=0,o=0,l;for(n=0;n<e.length;n+=i)i=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),i=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[s++]=o&255,t[s++]=o>>>8,o=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function vP(e){return uf(e,"binary").toString("utf8")}var Sb="foo bar baz",Ji=gi&&(vP(Sb)==J5(Sb)&&vP||bP(Sb)==J5(Sb)&&bP)||J5,Ku=gi?function(e){return uf(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},f1=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),u$=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),oie=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),lie=/<\/?(?:vt:)?variant>/g,cie=/<(?:vt:)([^>]*)>([\s\S]*)</;function wP(e,t){var r=Xn(e),n=e.match(oie(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var o=s.replace(lie,"").match(cie);o&&i.push({v:Ji(o[2]),t:o[1]})}),i}var d$=/(^\s|\s$|\n)/;function xo(e,t){return"<"+e+(t.match(d$)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function h1(e){return Ka(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ln(e,t,r){return"<"+e+(r!=null?h1(r):"")+(t!=null?(t.match(d$)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function D4(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function uie(e,t){switch(typeof e){case"string":var r=ln("vt:lpwstr",Vi(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ln((e|0)==e?"vt:i4":"vt:r8",Vi(String(e)));case"boolean":return ln("vt:bool",e?"true":"false")}if(e instanceof Date)return ln("vt:filetime",D4(e));throw new Error("Unable to serialize "+e)}function $3(e){if(gi&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Ji(kh(O3(e)));throw new Error("Bad input format: expected Buffer or string")}var p1=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Os={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Q0=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Yl={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function die(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function fie(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,o=n?-t:t;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var l=0;l<=5;++l,s/=256)e[r+l]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var SP=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},_P=gi?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:uf(t)})):SP(e)}:SP,jP=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(Rd(e,i)));return n.join("").replace(al,"")},U3=gi?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(al,""):jP(e,t,r)}:jP,kP=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},f$=gi?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):kP(e,t,r)}:kP,AP=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Fp(e,i)));return n.join("")},ny=gi?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):AP(t,r,n)}:AP,h$=function(e,t){var r=Xl(e,t);return r>0?ny(e,t+4,t+4+r-1):""},p$=h$,m$=function(e,t){var r=Xl(e,t);return r>0?ny(e,t+4,t+4+r-1):""},g$=m$,x$=function(e,t){var r=2*Xl(e,t);return r>0?ny(e,t+4,t+4+r-1):""},y$=x$,b$=function(t,r){var n=Xl(t,r);return n>0?U3(t,r+4,r+4+n):""},v$=b$,w$=function(e,t){var r=Xl(e,t);return r>0?ny(e,t+4,t+4+r):""},S$=w$,_$=function(e,t){return die(e,t)},$2=_$,z3=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};gi&&(p$=function(t,r){if(!Buffer.isBuffer(t))return h$(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},g$=function(t,r){if(!Buffer.isBuffer(t))return m$(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},y$=function(t,r){if(!Buffer.isBuffer(t))return x$(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},v$=function(t,r){if(!Buffer.isBuffer(t))return b$(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},S$=function(t,r){if(!Buffer.isBuffer(t))return w$(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},$2=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):_$(t,r)},z3=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Fp=function(e,t){return e[t]},Rd=function(e,t){return e[t+1]*256+e[t]},hie=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Xl=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},qh=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},pie=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ex(e,t){var r="",n,i,s=[],o,l,c,u;switch(t){case"dbcs":if(u=this.l,gi&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Rd(this,u)),u+=2;e*=2;break;case"utf8":r=ny(this,this.l,this.l+e);break;case"utf16le":e*=2,r=U3(this,this.l,this.l+e);break;case"wstr":return Ex.call(this,e,"dbcs");case"lpstr-ansi":r=p$(this,this.l),e=4+Xl(this,this.l);break;case"lpstr-cp":r=g$(this,this.l),e=4+Xl(this,this.l);break;case"lpwstr":r=y$(this,this.l),e=4+2*Xl(this,this.l);break;case"lpp4":e=4+Xl(this,this.l),r=v$(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Xl(this,this.l),r=S$(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Fp(this,this.l+e++))!==0;)s.push(wb(o));r=s.join("");break;case"_wstr":for(e=0,r="";(o=Rd(this,this.l+e))!==0;)s.push(wb(o)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Fp(this,u),this.l=u+1,l=Ex.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(wb(Rd(this,u))),u+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Fp(this,u),this.l=u+1,l=Ex.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(wb(Fp(this,u))),u+=1}r=s.join("");break;default:switch(e){case 1:return n=Fp(this,this.l),this.l++,n;case 2:return n=(t==="i"?hie:Rd)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?qh:pie)(this,this.l),this.l+=4,n):(i=Xl(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=$2(this,this.l):i=$2([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=f$(this,this.l,e);break}}return this.l+=e,r}var mie=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},gie=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},xie=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function yie(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)xie(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,mie(this,t,this.l);break;case 8:if(n=8,r==="f"){fie(this,t,this.l);break}case 16:break;case-4:n=4,gie(this,t,this.l);break}return this.l+=n,this}function j$(e,t){var r=f$(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function go(e,t){e.l=t,e.read_shift=Ex,e.chk=j$,e.write_shift=yie}function Ho(e,t){e.l+=t}function kr(e){var t=hh(e);return go(t,0),t}function df(e,t,r){if(e){var n,i,s;go(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var u=v1[l]||v1[65535];for(n=e.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=e.read_shift(1))&127)<<7*i;c=e.l+s;var d=u.f&&u.f(e,s,r);if(e.l=c,t(d,u,l))return}}}function Pl(){var e=[],t=gi?256:2048,r=function(u){var d=kr(u);return go(d,0),d},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,t)))},o=function(){return i(),Ks(e)},l=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:l,end:o,_bufs:e}}function $r(e,t,r,n){var i=+t,s;if(!isNaN(i)){n||(n=v1[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var o=e.next(s);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&z3(r)&&e.push(r)}}function Tx(e,t,r){var n=ya(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function NP(e,t,r){var n=ya(e);return n.s=Tx(n.s,t.s,r),n.e=Tx(n.e,t.s,r),n}function Px(e,t){if(e.cRel&&e.c<0)for(e=ya(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ya(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Yn(e);return!e.cRel&&e.cRel!=null&&(r=wie(r)),!e.rRel&&e.rRel!=null&&(r=bie(r)),r}function Z5(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ta(e.s.c)+":"+(e.e.cRel?"":"$")+Ta(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+os(e.s.r)+":"+(e.e.rRel?"":"$")+os(e.e.r):Px(e.s,t.biff)+":"+Px(e.e,t.biff)}function W3(e){return parseInt(vie(e),10)-1}function os(e){return""+(e+1)}function bie(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function vie(e){return e.replace(/\$(\d+)$/,"$1")}function q3(e){for(var t=Sie(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Ta(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function wie(e){return e.replace(/^([A-Z])/,"$$$1")}function Sie(e){return e.replace(/^\$([A-Z])/,"$1")}function _ie(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Pa(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function Yn(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ol(e){var t=e.indexOf(":");return t==-1?{s:Pa(e),e:Pa(e)}:{s:Pa(e.slice(0,t)),e:Pa(e.slice(t+1))}}function li(e,t){return typeof t>"u"||typeof t=="number"?li(e.s,e.e):(typeof e!="string"&&(e=Yn(e)),typeof t!="string"&&(t=Yn(t)),e==t?e:e+":"+t)}function Ni(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function CP(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Wc(e.z,r?Ls(t):t)}catch{}try{return e.w=Wc((e.XF||{}).numFmtId||(r?14:0),r?Ls(t):t)}catch{return""+t}}function Xd(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ff[e.v]||e.v:t==null?CP(e,e.v):CP(e,t))}function Ah(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function k$(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),o=0,l=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Pa(n.origin):n.origin;o=c.r,l=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=Ni(s["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(u.e.r=o=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var p={v:t[f][h]},m=o+f,g=l+h;if(u.s.r>m&&(u.s.r=m),u.s.c>g&&(u.s.c=g),u.e.r<m&&(u.e.r=m),u.e.c<g&&(u.e.c=g),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))p=t[f][h];else if(Array.isArray(p.v)&&(p.f=t[f][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Gn[14],n.cellDates?(p.t="d",p.w=Wc(p.z,Ls(p.v))):(p.t="n",p.v=Ls(p.v),p.w=Wc(p.z,p.v))):p.t="s";if(i)s[m]||(s[m]=[]),s[m][g]&&s[m][g].z&&(p.z=s[m][g].z),s[m][g]=p;else{var y=Yn({c:g,r:m});s[y]&&s[y].z&&(p.z=s[y].z),s[y]=p}}}return u.s.c<1e7&&(s["!ref"]=li(u)),s}function ug(e,t){return k$(null,e,t)}function jie(e){return e.read_shift(4,"i")}function gu(e,t){return t||(t=kr(4)),t.write_shift(4,e),t}function zo(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Xs(e,t){var r=!1;return t==null&&(r=!0,t=kr(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function kie(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Aie(e,t){return t||(t=kr(4)),t.write_shift(2,0),t.write_shift(2,0),t}function H3(e,t){var r=e.l,n=e.read_shift(1),i=zo(e),s=[],o={t:i,h:i};if(n&1){for(var l=e.read_shift(4),c=0;c!=l;++c)s.push(kie(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function Nie(e,t){var r=!1;return t==null&&(r=!0,t=kr(15+4*e.t.length)),t.write_shift(1,0),Xs(e.t,t),r?t.slice(0,t.l):t}var Cie=H3;function Eie(e,t){var r=!1;return t==null&&(r=!0,t=kr(23+4*e.t.length)),t.write_shift(1,1),Xs(e.t,t),t.write_shift(4,1),Aie({},t),r?t.slice(0,t.l):t}function Kc(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function J0(e,t){return t==null&&(t=kr(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Z0(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function ep(e,t){return t==null&&(t=kr(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Tie=zo,A$=Xs;function V3(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function U2(e,t){var r=!1;return t==null&&(r=!0,t=kr(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Pie=zo,$4=V3,G3=U2;function K3(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?$2([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):qh(t,0)>>2;return r?i/100:i}function N$(e,t){t==null&&(t=kr(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function C$(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Oie(e,t){return t||(t=kr(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var tp=C$,dg=Oie;function $o(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function j0(e,t){return(t||kr(8)).write_shift(8,e,"f")}function Mie(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var u=s0[i];u&&(t.rgb=g1(u));break;case 2:t.rgb=g1([o,l,c]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function z2(e,t){if(t||(t=kr(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function Lie(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Rie(e,t){t||(t=kr(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function E$(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Fie(e){return E$(e,1)}function Bie(e){return E$(e,2)}var Y3=2,bl=3,_b=11,EP=12,W2=19,jb=64,Iie=65,Die=71,$ie=4108,Uie=4126,qs=80,T$=81,zie=[qs,T$],U4={1:{n:"CodePage",t:Y3},2:{n:"Category",t:qs},3:{n:"PresentationFormat",t:qs},4:{n:"ByteCount",t:bl},5:{n:"LineCount",t:bl},6:{n:"ParagraphCount",t:bl},7:{n:"SlideCount",t:bl},8:{n:"NoteCount",t:bl},9:{n:"HiddenCount",t:bl},10:{n:"MultimediaClipCount",t:bl},11:{n:"ScaleCrop",t:_b},12:{n:"HeadingPairs",t:$ie},13:{n:"TitlesOfParts",t:Uie},14:{n:"Manager",t:qs},15:{n:"Company",t:qs},16:{n:"LinksUpToDate",t:_b},17:{n:"CharacterCount",t:bl},19:{n:"SharedDoc",t:_b},22:{n:"HyperlinksChanged",t:_b},23:{n:"AppVersion",t:bl,p:"version"},24:{n:"DigSig",t:Iie},26:{n:"ContentType",t:qs},27:{n:"ContentStatus",t:qs},28:{n:"Language",t:qs},29:{n:"Version",t:qs},255:{},2147483648:{n:"Locale",t:W2},2147483651:{n:"Behavior",t:W2},1919054434:{}},z4={1:{n:"CodePage",t:Y3},2:{n:"Title",t:qs},3:{n:"Subject",t:qs},4:{n:"Author",t:qs},5:{n:"Keywords",t:qs},6:{n:"Comments",t:qs},7:{n:"Template",t:qs},8:{n:"LastAuthor",t:qs},9:{n:"RevNumber",t:qs},10:{n:"EditTime",t:jb},11:{n:"LastPrinted",t:jb},12:{n:"CreatedDate",t:jb},13:{n:"ModifiedDate",t:jb},14:{n:"PageCount",t:bl},15:{n:"WordCount",t:bl},16:{n:"CharCount",t:bl},17:{n:"Thumbnail",t:Die},18:{n:"Application",t:qs},19:{n:"DocSecurity",t:bl},255:{},2147483648:{n:"Locale",t:W2},2147483651:{n:"Behavior",t:W2},1919054434:{}},TP={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Wie=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function qie(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Hie=qie([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),s0=ya(Hie),ff={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},P$={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},W4={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},kb={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function X3(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Vie(e){var t=X3();if(!e||!e.match)return t;var r={};if((e.match(Go)||[]).forEach(function(n){var i=Xn(n);switch(i[0].replace(rie,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[W4[i.ContentType]]!==void 0&&t[W4[i.ContentType]].push(i.PartName);break}}),t.xmlns!==Os.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function O$(e,t){var r=Vne(W4),n=[],i;n[n.length]=ls,n[n.length]=ln("Types",null,{xmlns:Os.CT,"xmlns:xsd":Os.xsd,"xmlns:xsi":Os.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return ln("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){e[c]&&e[c].length>0&&(i=e[c][0],n[n.length]=ln("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:kb[c][t.bookType]||kb[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=ln("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:kb[c][t.bookType]||kb[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(u){n[n.length]=ln("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return s("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var yi={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function m1(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ox(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Go)||[]).forEach(function(i){var s=Xn(i);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var l=s.TargetMode==="External"?s.Target:mx(s.Target,t);r[l]=o,n[s.Id]=o}}),r["!id"]=n,r}function gm(e){var t=[ls,ln("Relationships",null,{xmlns:Os.RELS})];return Ka(e["!id"]).forEach(function(r){t[t.length]=ln("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Wi(e,t,r,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[yi.HLINK,yi.XPATH,yi.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var Gie="application/vnd.oasis.opendocument.spreadsheet";function Kie(e,t){for(var r=$3(e),n,i;n=p1.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Xn(n[0],!1),i.path=="/"&&i.type!==Gie)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function Yie(e){var t=[ls];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function PP(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Xie(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Qie(e){var t=[ls];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(PP(e[r][0],e[r][1])),t.push(Xie("",e[r][0]));return t.push(PP("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function M$(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+R2.version+"</meta:generator></office:meta></office:document-meta>"}var $c=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Jie=function(){for(var e=new Array($c.length),t=0;t<$c.length;++t){var r=$c[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function L$(e){var t={};e=Ji(e);for(var r=0;r<$c.length;++r){var n=$c[r],i=e.match(Jie[r]);i!=null&&i.length>0&&(t[n[1]]=Ai(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=xa(t[n[1]]))}return t}function ej(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=Vi(t),n[n.length]=r?ln(e,t,r):xo(e,t))}function R$(e,t){var r=t||{},n=[ls,ln("cp:coreProperties",null,{"xmlns:cp":Os.CORE_PROPS,"xmlns:dc":Os.dc,"xmlns:dcterms":Os.dcterms,"xmlns:dcmitype":Os.dcmitype,"xmlns:xsi":Os.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&ej("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:D4(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&ej("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:D4(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=$c.length;++s){var o=$c[s],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&ej(o[0],l,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var o0=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],F$=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function B$(e,t,r,n){var i=[];if(typeof e=="string")i=wP(e,n);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(d){return{v:d}}));var o=typeof t=="string"?wP(t,n).map(function(d){return d.v}):t,l=0,c=0;if(o.length>0)for(var u=0;u!==i.length;u+=2){switch(c=+i[u+1].v,i[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function Zie(e,t,r){var n={};return t||(t={}),e=Ji(e),o0.forEach(function(i){var s=(e.match(f1(i[0]))||[])[1];switch(i[2]){case"string":s&&(t[i[1]]=Ai(s));break;case"bool":t[i[1]]=s==="true";break;case"raw":var o=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&B$(n.HeadingPairs,n.TitlesOfParts,t,r),t}function I$(e){var t=[],r=ln;return e||(e={}),e.Application="SheetJS",t[t.length]=ls,t[t.length]=ln("Properties",null,{xmlns:Os.EXT_PROPS,"xmlns:vt":Os.vt}),o0.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Vi(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Vi(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var eae=/<[^>]+>[^<]*/g;function tae(e,t){var r={},n="",i=e.match(eae);if(i)for(var s=0;s!=i.length;++s){var o=i[s],l=Xn(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ai(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=Ai(d);break;case"bool":r[n]=pa(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=xa(d);break;case"cy":case"error":r[n]=Ai(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function D$(e){var t=[ls,ln("Properties",null,{xmlns:Os.CUST_PROPS,"xmlns:vt":Os.vt})];if(!e)return t.join("");var r=1;return Ka(e).forEach(function(i){++r,t[t.length]=ln("property",uie(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Vi(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var q4={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},tj;function rae(e,t,r){tj||(tj=CS(q4)),t=tj[t]||t,e[t]=r}function nae(e,t){var r=[];return Ka(q4).map(function(n){for(var i=0;i<$c.length;++i)if($c[i][1]==n)return $c[i];for(i=0;i<o0.length;++i)if(o0[i][1]==n)return o0[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(xo(q4[n[1]]||n[1],i))}}),ln("DocumentProperties",r.join(""),{xmlns:Yl.o})}function iae(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&Ka(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var o=0;o<$c.length;++o)if(s==$c[o][1])return;for(o=0;o<o0.length;++o)if(s==o0[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var l=e[s],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),i.push(ln(xP(s),l,{"dt:dt":c}))}}),t&&Ka(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),i.push(ln(xP(s),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+Yl.o+'">'+i.join("")+"</"+n+">"}function Q3(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function aae(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var o=kr(8);return o.write_shift(4,n),o.write_shift(4,i),o}function $$(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function U$(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function z$(e,t,r){return t===31?U$(e):$$(e,t,r)}function H4(e,t,r){return z$(e,t,r===!1?0:4)}function sae(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return z$(e,t,0)}function oae(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(al,""),e.l-i&2&&(e.l+=2)}return r}function lae(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(al,"");return r}function cae(e){var t=e.l,r=q2(e,T$);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=q2(e,bl);return[r,n]}function uae(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(cae(e));return r}function OP(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var s=e.read_shift(4),o=e.read_shift(4);n[s]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(al,"").replace(px,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function W$(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function dae(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function q2(e,t,r){var n=e.read_shift(2),i,s=r||{};if(e.l+=2,t!==EP&&n!==t&&zie.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===EP?n:t){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return $$(e,n,4).replace(al,"");case 31:return U$(e);case 64:return Q3(e);case 65:return W$(e);case 71:return dae(e);case 80:return H4(e,n,!s.raw).replace(al,"");case 81:return sae(e,n).replace(al,"");case 4108:return uae(e);case 4126:case 4127:return n==4127?oae(e):lae(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function MP(e,t){var r=kr(4),n=kr(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=kr(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=aae(t);break;case 31:case 80:for(n=kr(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Ks([r,n])}function LP(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),s=[],o=0,l=0,c=-1,u={};for(o=0;o!=i;++o){var d=e.read_shift(4),f=e.read_shift(4);s[o]=[d,f+r]}s.sort(function(v,w){return v[1]-w[1]});var h={};for(o=0;o!=i;++o){if(e.l!==s[o][1]){var p=!0;if(o>0&&t)switch(t[s[o-1][0]].t){case 2:e.l+2===s[o][1]&&(e.l+=2,p=!1);break;case 80:e.l<=s[o][1]&&(e.l=s[o][1],p=!1);break;case 4108:e.l<=s[o][1]&&(e.l=s[o][1],p=!1);break}if((!t||o==0)&&e.l<=s[o][1]&&(p=!1,e.l=s[o][1]),p)throw new Error("Read Error: Expected address "+s[o][1]+" at "+e.l+" :"+o)}if(t){var m=t[s[o][0]];if(h[m.n]=q2(e,m.t,{raw:!0}),m.p==="version"&&(h[m.n]=String(h[m.n]>>16)+"."+("0000"+String(h[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(h[m.n]){case 0:h[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:du(l=h[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[m.n])}}else if(s[o][0]===1){if(l=h.CodePage=q2(e,Y3),du(l),c!==-1){var g=e.l;e.l=s[c][1],u=OP(e,l),e.l=g}}else if(s[o][0]===0){if(l===0){c=o,e.l=s[o+1][1];continue}u=OP(e,l)}else{var y=u[s[o][0]],b;switch(e[e.l]){case 65:e.l+=4,b=W$(e);break;case 30:e.l+=4,b=H4(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,b=H4(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,b=e.read_shift(4,"i");break;case 19:e.l+=4,b=e.read_shift(4);break;case 5:e.l+=4,b=e.read_shift(8,"f");break;case 11:e.l+=4,b=Za(e,4);break;case 64:e.l+=4,b=xa(Q3(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[y]=b}}return e.l=r+n,h}var q$=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function fae(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function RP(e,t,r){var n=kr(8),i=[],s=[],o=8,l=0,c=kr(8),u=kr(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),s.push(c),i.push(u),o+=8+c.length,!t){u=kr(8),u.write_shift(4,0),i.unshift(u);var d=[kr(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(c=kr(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=Ks(d),s.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(q$.indexOf(e[l][0])>-1||F$.indexOf(e[l][0])>-1)&&e[l][1]!=null){var h=e[l][1],p=0;if(t){p=+t[e[l][0]];var m=r[p];if(m.p=="version"&&typeof h=="string"){var g=h.split(".");h=(+g[0]<<16)+(+g[1]||0)}c=MP(m.t,h)}else{var y=fae(h);y==-1&&(y=31,h=String(h)),c=MP(y,h)}s.push(c),u=kr(8),u.write_shift(4,t?p:2+l),i.push(u),o+=8+c.length}var b=8*(s.length+1);for(l=0;l<s.length;++l)i[l].write_shift(4,b),b+=s[l].length;return n.write_shift(4,o),n.write_shift(4,s.length),Ks([n].concat(i).concat(s))}function FP(e,t,r){var n=e.content;if(!n)return{};go(n,0);var i,s,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==qn.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),l=n.read_shift(4),i===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);i===2&&(o=n.read_shift(16),c=n.read_shift(4));var f=LP(n,t),h={SystemIdentifier:u};for(var p in f)h[p]=f[p];if(h.FMTID=s,i===1)return h;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var m;try{m=LP(n,null)}catch{}for(p in m)h[p]=m[p];return h.FMTID=[s,o],h}function BP(e,t,r,n,i,s){var o=kr(i?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,qn.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,i?68:48);var c=RP(e,r,n);if(l.push(c),i){var u=RP(i,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+c.length),l.push(u)}return Ks(l)}function Nf(e,t){return e.read_shift(t),null}function hae(e,t){t||(t=kr(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function pae(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function Za(e,t){return e.read_shift(t)===1}function tl(e,t){return t||(t=kr(2)),t.write_shift(2,+!!e),t}function ps(e){return e.read_shift(2,"u")}function Mc(e,t){return t||(t=kr(2)),t.write_shift(2,e),t}function H$(e,t){return pae(e,t,ps)}function mae(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function V$(e,t,r){return r||(r=kr(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function iy(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?e.read_shift(n,i):"";return o}function gae(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,s=1+(r&1),o=0,l,c={};i&&(o=e.read_shift(2)),n&&(l=e.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return i&&(e.l+=4*o),n&&(e.l+=l),c.t=d,i||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function xae(e){var t=e.t||"",r=kr(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=kr(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return Ks(i)}function k0(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function ay(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):k0(e,n,r)}function rp(e,t,r){if(r.biff>5)return ay(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function G$(e,t,r){return r||(r=kr(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function yae(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function bae(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(al,"");return n&&(e.l+=24),i}function vae(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(s>>1,"utf16le").replace(al,"");return r+o}function wae(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return bae(e);case"0303000000000000c000000000000046":return vae(e);default:throw new Error("Unsupported Moniker "+r)}}function Ab(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(al,""):"";return r}function IP(e,t){t||(t=kr(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function Sae(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var s,o,l,c,u="",d,f;i&16&&(s=Ab(e,r-e.l)),i&128&&(o=Ab(e,r-e.l)),(i&257)===257&&(l=Ab(e,r-e.l)),(i&257)===1&&(c=wae(e,r-e.l)),i&8&&(u=Ab(e,r-e.l)),i&32&&(d=e.read_shift(16)),i&64&&(f=Q3(e)),e.l=r;var h=o||l||c||"";h&&u&&(h+="#"+u),h||(h="#"+u),i&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var p={Target:h};return d&&(p.guid=d),f&&(p.time=f),s&&(p.Tooltip=s),p}function _ae(e){var t=kr(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(s==28)n=n.slice(1),IP(n,t);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),s&8&&IP(i>-1?n.slice(i+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function K$(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function Y$(e,t){var r=K$(e);return r[3]=0,r}function cd(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function A0(e,t,r,n){return n||(n=kr(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function jae(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function kae(e,t,r){return t===0?"":rp(e,t,r)}function Aae(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[i,s,o]}function X$(e){var t=e.read_shift(2),r=K3(e);return[t,r]}function Nae(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=iy(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,i}function PS(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function Q$(e,t){return t||(t=kr(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function J$(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var Cae=J$;function Z$(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function Eae(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function Tae(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function No(e){e.l+=2,e.l+=e.read_shift(2)}var Pae={0:No,4:No,5:No,6:No,7:Tae,8:No,9:No,10:No,11:No,12:No,13:Eae,14:No,15:No,16:No,17:No,18:No,19:No,20:No,21:Z$};function Oae(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(Pae[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Nb(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function J3(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=kr(i);return s.write_shift(2,n),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function Mae(e,t){return t===0||e.read_shift(2),1200}function Lae(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=rp(e,0,r);return e.read_shift(t+n-e.l),i}function Rae(e,t){var r=!t||t.biff==8,n=kr(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function Fae(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function Bae(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=iy(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:s,name:o}}function Iae(e,t){var r=!t||t.biff>=8?2:1,n=kr(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function Dae(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),s=[],o=0;o!=i&&e.l<r;++o)s.push(gae(e));return s.Count=n,s.Unique=i,s}function $ae(e,t){var r=kr(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=xae(e[i]);var s=Ks([r].concat(n));return s.parts=[r.length].concat(n.map(function(o){return o.length})),s}function Uae(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function zae(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function Wae(e){var t=jae(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function qae(e){return e.read_shift(2),e.read_shift(4)}function DP(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function Hae(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:s,CurTab:o,FirstTab:l,Selected:c,TabRatio:u}}function Vae(){var e=kr(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Gae(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function Kae(e){var t=kr(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Yae(){}function Xae(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=iy(e,0,r),n}function Qae(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,s=kr(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function Jae(e){var t=cd(e);return t.isst=e.read_shift(4),t}function Zae(e,t,r,n){var i=kr(10);return A0(e,t,n,i),i.write_shift(4,r),i}function ese(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=cd(e);r.biff==2&&e.l++;var s=ay(e,n-e.l,r);return i.val=s,i}function tse(e,t,r,n,i){var s=!i||i.biff==8,o=kr(8+ +s+(1+s)*r.length);return A0(e,t,n,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function rse(e,t,r){var n=e.read_shift(2),i=rp(e,0,r);return[n,i]}function nse(e,t,r,n){var i=r&&r.biff==5;n||(n=kr(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var ise=rp;function $P(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,s=e.read_shift(i),o=e.read_shift(i),l=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:s,c:l},e:{r:o,c}}}function ase(e,t){var r=t.biff==8||!t.biff?4:2,n=kr(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function sse(e){var t=e.read_shift(2),r=e.read_shift(2),n=X$(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function ose(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(X$(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:s}}function lse(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:s}}function cse(e,t,r,n){var i={},s=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return i.patternType=Wie[l>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=l&127,i.icvBottom=l>>7&127,i.icvDiag=l>>14&127,i.dgDiag=l>>21&15,i.icvFore=c&127,i.icvBack=c>>7&127,i.fsxButton=c>>14&1),i}function use(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=cse(e,t,n.fStyle,r),n}function UP(e,t,r,n){var i=r&&r.biff==5;n||(n=kr(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function dse(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function fse(e){var t=kr(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function zP(e,t,r){var n=cd(e);(r.biff==2||t==9)&&++e.l;var i=mae(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function hse(e,t,r,n,i,s){var o=kr(8);return A0(e,t,n,o),V$(r,s,o),o}function pse(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=cd(e),i=$o(e);return n.val=i,n}function mse(e,t,r,n){var i=kr(14);return A0(e,t,n,i),j0(r,i),i}var WP=kae;function gse(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=k0(e,s),l=[];n>e.l;)l.push(ay(e));return[s,i,o,l]}function qP(e,t,r){var n=e.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=Nae(e,t-2,r)),s.body=i||e.read_shift(t-2),typeof i=="string"&&(s.Name=i),s}var xse=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function HP(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=k0(e,o,r);i&32&&(u=xse[u.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var f=n==e.l||l===0||!(d>0)?[]:Oue(e,d,r,l);return{chKey:s,Name:u,itab:c,rgce:f}}function eU(e,t,r){if(r.biff<8)return yse(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(Aae(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function yse(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=iy(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function bse(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),s=k0(e,n,r),o=k0(e,i,r);return[s,o]}function vse(e,t,r){var n=J$(e);e.l++;var i=e.read_shift(1);return t-=8,[Mue(e,t,r),i,n]}function VP(e,t,r){var n=Cae(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Tue(e,t,r)]}function wse(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function Sse(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=rp(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},l,o,s]}}function _se(e,t,r){return Sse(e,t,r)}function jse(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(PS(e));return r}function kse(e){var t=kr(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Q$(e[r],t);return t}function Ase(e,t,r){if(r&&r.biff<8)return Cse(e,t,r);var n=Z$(e),i=Oae(e,t-22,n[1]);return{cmo:n,ft:i}}var Nse={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function Cse(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((Nse[n]||Ho)(e,t,r)),{cmo:[i,n,s],ft:o}}function Ese(e,t,r){var n=e.l,i="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:o=yae(e,6,r);var l=e.read_shift(2);e.read_shift(2),ps(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=k0(e,e.lens[u+1]-e.lens[u]-1);if(i+=f,i.length>=(d?l:2*l))break}if(i.length!==l&&i.length!==l*2)throw new Error("cchText: "+l+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function Tse(e,t){var r=PS(e);e.l+=16;var n=Sae(e,t-24);return[r,n]}function Pse(e){var t=kr(24),r=Pa(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return Ks([t,_ae(e[1])])}function Ose(e,t){e.read_shift(2);var r=PS(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(al,""),[r,n]}function Mse(e){var t=e[1].Tooltip,r=kr(10+2*(t.length+1));r.write_shift(2,2048);var n=Pa(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function Lse(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=TP[r]||r,r=e.read_shift(2),t[1]=TP[r]||r,t}function Rse(e){return e||(e=kr(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Fse(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Y$(e));return r}function Bse(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Y$(e));return r}function Ise(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function tU(e,t,r){if(!r.cellStyles)return Ho(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s:i,e:s,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function Dse(e,t){var r=kr(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function $se(e,t){var r={};return t<32||(e.l+=16,r.header=$o(e),r.footer=$o(e),e.l+=2),r}function Use(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}function zse(e){for(var t=kr(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var Wse=cd,qse=H$,Hse=ay;function Vse(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function Gse(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=cd(e);++e.l;var i=rp(e,t-7,r);return n.t="str",n.val=i,n}function Kse(e){var t=cd(e);++e.l;var r=$o(e);return t.t="n",t.val=r,t}function Yse(e,t,r){var n=kr(15);return cy(n,e,t),n.write_shift(8,r,"f"),n}function Xse(e){var t=cd(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function Qse(e,t,r){var n=kr(9);return cy(n,e,t),n.write_shift(2,r),n}function Jse(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function Zse(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function eoe(e,t,r){var n=e.l+t,i=cd(e),s=e.read_shift(2),o=k0(e,s,r);return e.l=n,i.t="str",i.val=o,i}var toe=[2,3,48,49,131,139,140,245],V4=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=CS({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],d=hh(1);switch(c.type){case"base64":d=Ql(cc(l));break;case"binary":d=Ql(l);break;case"buffer":case"array":d=l;break}go(d,0);var f=d.read_shift(1),h=!!(f&136),p=!1,m=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var g=0,y=521;f==2&&(g=d.read_shift(2)),d.l+=3,f!=2&&(g=d.read_shift(4)),g>1048576&&(g=1e6),f!=2&&(y=d.read_shift(2));var b=d.read_shift(2),v=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(v=e[d[d.l]]),d.l+=1,d.l+=2),m&&(d.l+=36);for(var w=[],S={},j=Math.min(d.length,f==2?521:y-10-(p?264:0)),k=m?32:11;d.l<j&&d[d.l]!=13;)switch(S={},S.name=c1.utils.decode(v,d.slice(d.l,d.l+k)).replace(/[\u0000\r\n].*$/g,""),d.l+=k,S.type=String.fromCharCode(d.read_shift(1)),f!=2&&!m&&(S.offset=d.read_shift(4)),S.len=d.read_shift(1),f==2&&(S.offset=d.read_shift(2)),S.dec=d.read_shift(1),S.name.length&&w.push(S),f!=2&&(d.l+=m?13:14),S.type){case"B":(!p||S.len!=8)&&c.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(d[d.l]!==13&&(d.l=y-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=y;var A=0,R=0;for(u[0]=[],R=0;R!=w.length;++R)u[0][R]=w[R].name;for(;g-- >0;){if(d[d.l]===42){d.l+=b;continue}for(++d.l,u[++A]=[],R=0,R=0;R!=w.length;++R){var M=d.slice(d.l,d.l+w[R].len);d.l+=w[R].len,go(M,0);var B=c1.utils.decode(v,M);switch(w[R].type){case"C":B.trim().length&&(u[A][R]=B.replace(/\s+$/,""));break;case"D":B.length===8?u[A][R]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):u[A][R]=B;break;case"F":u[A][R]=parseFloat(B.trim());break;case"+":case"I":u[A][R]=m?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":u[A][R]=!0;break;case"N":case"F":u[A][R]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[A][R]="##MEMO##"+(m?parseInt(B.trim(),10):M.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(u[A][R]=+B||0);break;case"@":u[A][R]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":u[A][R]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":u[A][R]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[A][R]=-M.read_shift(-8,"f");break;case"B":if(p&&w[R].len==8){u[A][R]=M.read_shift(8,"f");break}case"G":case"P":M.l+=w[R].len;break;case"0":if(w[R].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[R].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=w,u}function n(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=ug(r(l,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function i(l,c){try{return Ah(n(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var u=c||{};if(+u.codepage>=0&&du(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Pl(),f=G2(l,{header:1,raw:!0,cellDates:!0}),h=f[0],p=f.slice(1),m=l["!cols"]||[],g=0,y=0,b=0,v=1;for(g=0;g<h.length;++g){if(((m[g]||{}).DBF||{}).name){h[g]=m[g].DBF.name,++b;continue}if(h[g]!=null){if(++b,typeof h[g]=="number"&&(h[g]=h[g].toString(10)),typeof h[g]!="string")throw new Error("DBF Invalid column name "+h[g]+" |"+typeof h[g]+"|");if(h.indexOf(h[g])!==g){for(y=0;y<1024;++y)if(h.indexOf(h[g]+"_"+y)==-1){h[g]+="_"+y;break}}}}var w=Ni(l["!ref"]),S=[],j=[],k=[];for(g=0;g<=w.e.c-w.s.c;++g){var A="",R="",M=0,B=[];for(y=0;y<p.length;++y)p[y][g]!=null&&B.push(p[y][g]);if(B.length==0||h[g]==null){S[g]="?";continue}for(y=0;y<B.length;++y){switch(typeof B[y]){case"number":R="B";break;case"string":R="C";break;case"boolean":R="L";break;case"object":R=B[y]instanceof Date?"D":"C";break;default:R="C"}M=Math.max(M,String(B[y]).length),A=A&&A!=R?"C":R}M>250&&(M=250),R=((m[g]||{}).DBF||{}).type,R=="C"&&m[g].DBF.len>M&&(M=m[g].DBF.len),A=="B"&&R=="N"&&(A="N",k[g]=m[g].DBF.dec,M=m[g].DBF.len),j[g]=A=="C"||R=="N"?M:s[A]||0,v+=j[g],S[g]=A}var E=d.next(32);for(E.write_shift(4,318902576),E.write_shift(4,p.length),E.write_shift(2,296+32*b),E.write_shift(2,v),g=0;g<4;++g)E.write_shift(4,0);for(E.write_shift(4,0|(+t[q9]||3)<<8),g=0,y=0;g<h.length;++g)if(h[g]!=null){var P=d.next(32),U=(h[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,U,"sbcs"),P.write_shift(1,S[g]=="?"?"C":S[g],"sbcs"),P.write_shift(4,y),P.write_shift(1,j[g]||s[S[g]]||0),P.write_shift(1,k[g]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),y+=j[g]||s[S[g]]||0}var G=d.next(264);for(G.write_shift(4,13),g=0;g<65;++g)G.write_shift(4,0);for(g=0;g<p.length;++g){var H=d.next(v);for(H.write_shift(1,0),y=0;y<h.length;++y)if(h[y]!=null)switch(S[y]){case"L":H.write_shift(1,p[g][y]==null?63:p[g][y]?84:70);break;case"B":H.write_shift(8,p[g][y]||0,"f");break;case"N":var oe="0";for(typeof p[g][y]=="number"&&(oe=p[g][y].toFixed(k[y]||0)),b=0;b<j[y]-oe.length;++b)H.write_shift(1,32);H.write_shift(1,oe,"sbcs");break;case"D":p[g][y]?(H.write_shift(4,("0000"+p[g][y].getFullYear()).slice(-4),"sbcs"),H.write_shift(2,("00"+(p[g][y].getMonth()+1)).slice(-2),"sbcs"),H.write_shift(2,("00"+p[g][y].getDate()).slice(-2),"sbcs")):H.write_shift(8,"00000000","sbcs");break;case"C":var de=String(p[g][y]!=null?p[g][y]:"").slice(0,j[y]);for(H.write_shift(1,de,"sbcs"),b=0;b<j[y]-de.length;++b)H.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),rU=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ka(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var m=e[p];return typeof m=="number"?nP(m):m},n=function(h,p,m){var g=p.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return g==59?h:nP(g)};e["|"]=254;function i(h,p){switch(p.type){case"base64":return s(cc(h),p);case"binary":return s(h,p);case"buffer":return s(gi&&Buffer.isBuffer(h)?h.toString("binary"):kh(h),p);case"array":return s(_0(h),p)}throw new Error("Unrecognized type "+p.type)}function s(h,p){var m=h.split(/[\n\r]+/),g=-1,y=-1,b=0,v=0,w=[],S=[],j=null,k={},A=[],R=[],M=[],B=0,E;for(+p.codepage>=0&&du(+p.codepage);b!==m.length;++b){B=0;var P=m[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),U=P.replace(/;;/g,"\0").split(";").map(function(O){return O.replace(/\u0000/g,";")}),G=U[0],H;if(P.length>0)switch(G){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":U[1].charAt(0)=="P"&&S.push(P.slice(3).replace(/;;/g,";"));break;case"C":var oe=!1,de=!1,W=!1,V=!1,ae=-1,ee=-1;for(v=1;v<U.length;++v)switch(U[v].charAt(0)){case"A":break;case"X":y=parseInt(U[v].slice(1))-1,de=!0;break;case"Y":for(g=parseInt(U[v].slice(1))-1,de||(y=0),E=w.length;E<=g;++E)w[E]=[];break;case"K":H=U[v].slice(1),H.charAt(0)==='"'?H=H.slice(1,H.length-1):H==="TRUE"?H=!0:H==="FALSE"?H=!1:isNaN(mu(H))?isNaN($m(H).getDate())||(H=xa(H)):(H=mu(H),j!==null&&lg(j)&&(H=TS(H))),oe=!0;break;case"E":V=!0;var C=xm(U[v].slice(1),{r:g,c:y});w[g][y]=[w[g][y],C];break;case"S":W=!0,w[g][y]=[w[g][y],"S5S"];break;case"G":break;case"R":ae=parseInt(U[v].slice(1))-1;break;case"C":ee=parseInt(U[v].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}if(oe&&(w[g][y]&&w[g][y].length==2?w[g][y][0]=H:w[g][y]=H,j=null),W){if(V)throw new Error("SYLK shared formula cannot have own formula");var Y=ae>-1&&w[ae][ee];if(!Y||!Y[1])throw new Error("SYLK shared formula cannot find base");w[g][y][1]=vU(Y[1],{r:g-ae,c:y-ee})}break;case"F":var q=0;for(v=1;v<U.length;++v)switch(U[v].charAt(0)){case"X":y=parseInt(U[v].slice(1))-1,++q;break;case"Y":for(g=parseInt(U[v].slice(1))-1,E=w.length;E<=g;++E)w[E]=[];break;case"M":B=parseInt(U[v].slice(1))/20;break;case"F":break;case"G":break;case"P":j=S[parseInt(U[v].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=U[v].slice(1).split(" "),E=parseInt(M[0],10);E<=parseInt(M[1],10);++E)B=parseInt(M[2],10),R[E-1]=B===0?{hidden:!0}:{wch:B},ph(R[E-1]);break;case"C":y=parseInt(U[v].slice(1))-1,R[y]||(R[y]={});break;case"R":g=parseInt(U[v].slice(1))-1,A[g]||(A[g]={}),B>0?(A[g].hpt=B,A[g].hpx=zm(B)):B===0&&(A[g].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}q<1&&(j=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}}return A.length>0&&(k["!rows"]=A),R.length>0&&(k["!cols"]=R),p&&p.sheetRows&&(w=w.slice(0,p.sheetRows)),[w,k]}function o(h,p){var m=i(h,p),g=m[0],y=m[1],b=ug(g,p);return Ka(y).forEach(function(v){b[v]=y[v]}),b}function l(h,p){return Ah(o(h,p),p)}function c(h,p,m,g){var y="C;Y"+(m+1)+";X"+(g+1)+";K";switch(h.t){case"n":y+=h.v||0,h.f&&!h.F&&(y+=";E"+iC(h.f,{r:m,c:g}));break;case"b":y+=h.v?"TRUE":"FALSE";break;case"e":y+=h.w||h.v;break;case"d":y+='"'+(h.w||h.v)+'"';break;case"s":y+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function u(h,p){p.forEach(function(m,g){var y="F;W"+(g+1)+" "+(g+1)+" ";m.hidden?y+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=x1(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=y1(m.wpx)),typeof m.wch=="number"&&(y+=Math.round(m.wch))),y.charAt(y.length-1)!=" "&&h.push(y)})}function d(h,p){p.forEach(function(m,g){var y="F;";m.hidden?y+="M0;":m.hpt?y+="M"+20*m.hpt+";":m.hpx&&(y+="M"+20*b1(m.hpx)+";"),y.length>2&&h.push(y+"R"+(g+1))})}function f(h,p){var m=["ID;PWXL;N;E"],g=[],y=Ni(h["!ref"]),b,v=Array.isArray(h),w=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),h["!cols"]&&u(m,h["!cols"]),h["!rows"]&&d(m,h["!rows"]),m.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var S=y.s.r;S<=y.e.r;++S)for(var j=y.s.c;j<=y.e.c;++j){var k=Yn({r:S,c:j});b=v?(h[S]||[])[j]:h[k],!(!b||b.v==null&&(!b.f||b.F))&&g.push(c(b,h,S,j))}return m.join(w)+w+g.join(w)+w+"E"+w}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),nU=function(){function e(s,o){switch(o.type){case"base64":return t(cc(s),o);case"binary":return t(s,o);case"buffer":return t(gi&&Buffer.isBuffer(s)?s.toString("binary"):kh(s),o);case"array":return t(_0(s),o)}throw new Error("Unrecognized type "+o.type)}function t(s,o){for(var l=s.split(`
`),c=-1,u=-1,d=0,f=[];d!==l.length;++d){if(l[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var h=l[d].trim().split(","),p=h[0],m=h[1];++d;for(var g=l[d]||"";(g.match(/["]/g)||[]).length&1&&d<l.length-1;)g+=`
`+l[++d];switch(g=g.trim(),+p){case-1:if(g==="BOT"){f[++c]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?f[c][u]=!0:g==="FALSE"?f[c][u]=!1:isNaN(mu(m))?isNaN($m(m).getDate())?f[c][u]=m:f[c][u]=xa(m):f[c][u]=mu(m),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),f[c][u++]=g!==""?g:null;break}if(g==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(s,o){return ug(e(s,o),o)}function n(s,o){return Ah(r(s,o),o)}var i=function(){var s=function(c,u,d,f,h){c.push(u),c.push(d+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},o=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=Ni(c["!ref"]),f,h=Array.isArray(c);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,d.e.r-d.s.r+1,""),s(u,"TUPLES",0,d.e.c-d.s.c+1,""),s(u,"DATA",0,0,"");for(var p=d.s.r;p<=d.e.r;++p){o(u,-1,0,"BOT");for(var m=d.s.c;m<=d.e.c;++m){var g=Yn({r:p,c:m});if(f=h?(c[p]||[])[m]:c[g],!f){o(u,1,0,"");continue}switch(f.t){case"n":var y=f.w;!y&&f.v!=null&&(y=f.v),y==null?f.f&&!f.F?o(u,1,0,"="+f.f):o(u,1,0,""):o(u,0,y,"V");break;case"b":o(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Wc(f.z||Gn[14],Ls(xa(f.v)))),o(u,0,f.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var b=`\r
`,v=u.join(b);return v}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),iU=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var p=f.split(`
`),m=-1,g=-1,y=0,b=[];y!==p.length;++y){var v=p[y].trim().split(":");if(v[0]==="cell"){var w=Pa(v[1]);if(b.length<=w.r)for(m=b.length;m<=w.r;++m)b[m]||(b[m]=[]);switch(m=w.r,g=w.c,v[2]){case"t":b[m][g]=e(v[3]);break;case"v":b[m][g]=+v[3];break;case"vtf":var S=v[v.length-1];case"vtc":switch(v[3]){case"nl":b[m][g]=!!+v[4];break;default:b[m][g]=+v[4];break}v[2]=="vtf"&&(b[m][g]=[b[m][g],S])}}}return h&&h.sheetRows&&(b=b.slice(0,h.sheetRows)),b}function n(f,h){return ug(r(f,h),h)}function i(f,h){return Ah(n(f,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var h=[],p=[],m,g="",y=Ol(f["!ref"]),b=Array.isArray(f),v=y.s.r;v<=y.e.r;++v)for(var w=y.s.c;w<=y.e.c;++w)if(g=Yn({r:v,c:w}),m=b?(f[v]||[])[w]:f[g],!(!m||m.v==null||m.t==="z")){switch(p=["cell",g,"t"],m.t){case"s":case"str":p.push(t(m.v));break;case"n":m.f?(p[2]="vtf",p[3]="n",p[4]=m.v,p[5]=t(m.f)):(p[2]="v",p[3]=m.v);break;case"b":p[2]="vt"+(m.f?"f":"c"),p[3]="nl",p[4]=m.v?"1":"0",p[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var S=Ls(xa(m.v));p[2]="vtc",p[3]="nd",p[4]=""+S,p[5]=m.w||Wc(m.z||Gn[14],S);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[s,o,l,o,u(f),c].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),Um=function(){function e(d,f,h,p,m){m.raw?f[h][p]=d:d===""||(d==="TRUE"?f[h][p]=!0:d==="FALSE"?f[h][p]=!1:isNaN(mu(d))?isNaN($m(d).getDate())?f[h][p]=d:f[h][p]=xa(d):f[h][p]=mu(d))}function t(d,f){var h=f||{},p=[];if(!d||d.length===0)return p;for(var m=d.split(/[\r\n]/),g=m.length-1;g>=0&&m[g].length===0;)--g;for(var y=10,b=0,v=0;v<=g;++v)b=m[v].indexOf(" "),b==-1?b=m[v].length:b++,y=Math.max(y,b);for(v=0;v<=g;++v){p[v]=[];var w=0;for(e(m[v].slice(0,y).trim(),p,v,w,h),w=1;w<=(m[v].length-y)/10+1;++w)e(m[v].slice(y+(w-1)*10,y+w*10).trim(),p,v,w,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var f={},h=!1,p=0,m=0;p<d.length;++p)(m=d.charCodeAt(p))==34?h=!h:!h&&m in r&&(f[m]=(f[m]||0)+1);m=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&m.push([f[p],p]);if(!m.length){f=n;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&m.push([f[p],p])}return m.sort(function(g,y){return g[0]-y[0]||n[g[1]]-n[y[1]]}),r[m.pop()[1]]||44}function s(d,f){var h=f||{},p="",m=h.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(p=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(p=d.charAt(4),d=d.slice(6)):p=i(d.slice(0,1024)):h&&h.FS?p=h.FS:p=i(d.slice(0,1024));var y=0,b=0,v=0,w=0,S=0,j=p.charCodeAt(0),k=!1,A=0,R=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var M=h.dateNF!=null?Une(h.dateNF):null;function B(){var E=d.slice(w,S),P={};if(E.charAt(0)=='"'&&E.charAt(E.length-1)=='"'&&(E=E.slice(1,-1).replace(/""/g,'"')),E.length===0)P.t="z";else if(h.raw)P.t="s",P.v=E;else if(E.trim().length===0)P.t="s",P.v=E;else if(E.charCodeAt(0)==61)E.charCodeAt(1)==34&&E.charCodeAt(E.length-1)==34?(P.t="s",P.v=E.slice(2,-1).replace(/""/g,'"')):gce(E)?(P.t="n",P.f=E.slice(1)):(P.t="s",P.v=E);else if(E=="TRUE")P.t="b",P.v=!0;else if(E=="FALSE")P.t="b",P.v=!1;else if(!isNaN(v=mu(E)))P.t="n",h.cellText!==!1&&(P.w=E),P.v=v;else if(!isNaN($m(E).getDate())||M&&E.match(M)){P.z=h.dateNF||Gn[14];var U=0;M&&E.match(M)&&(E=zne(E,h.dateNF,E.match(M)||[]),U=1),h.cellDates?(P.t="d",P.v=xa(E,U)):(P.t="n",P.v=Ls(xa(E,U))),h.cellText!==!1&&(P.w=Wc(P.z,P.v instanceof Date?Ls(P.v):P.v)),h.cellNF||delete P.z}else P.t="s",P.v=E;if(P.t=="z"||(h.dense?(m[y]||(m[y]=[]),m[y][b]=P):m[Yn({c:b,r:y})]=P),w=S+1,R=d.charCodeAt(w),g.e.c<b&&(g.e.c=b),g.e.r<y&&(g.e.r=y),A==j)++b;else if(b=0,++y,h.sheetRows&&h.sheetRows<=y)return!0}e:for(;S<d.length;++S)switch(A=d.charCodeAt(S)){case 34:R===34&&(k=!k);break;case j:case 10:case 13:if(!k&&B())break e;break}return S-w>0&&B(),m["!ref"]=li(g),m}function o(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,f):ug(t(d,f),f)}function l(d,f){var h="",p=f.type=="string"?[0,0,0,0]:fC(d,f);switch(f.type){case"base64":h=cc(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof c1<"u"||(h=gi&&Buffer.isBuffer(d)?d.toString("binary"):kh(d));break;case"array":h=_0(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=Ji(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=Ji(h):f.type=="binary"&&typeof c1<"u",h.slice(0,19)=="socialcalc:version:"?iU.to_sheet(f.type=="string"?h:Ji(h),f):o(h,f)}function c(d,f){return Ah(l(d,f),f)}function u(d){for(var f=[],h=Ni(d["!ref"]),p,m=Array.isArray(d),g=h.s.r;g<=h.e.r;++g){for(var y=[],b=h.s.c;b<=h.e.c;++b){var v=Yn({r:g,c:b});if(p=m?(d[g]||[])[b]:d[v],!p||p.v==null){y.push("          ");continue}for(var w=(p.w||(Xd(p),p.w)||"").slice(0,10);w.length<10;)w+=" ";y.push(w+(b===0?" ":""))}f.push(y.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}();function roe(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=rU.to_workbook(e,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Um.to_workbook(e,t)}}var l0=function(){function e(C,Y,q){if(C){go(C,C.l||0);for(var O=q.Enum||ae;C.l<C.length;){var X=C.read_shift(2),F=O[X]||O[65535],Q=C.read_shift(2),K=C.l+Q,ne=F.f&&F.f(C,Q,q);if(C.l=K,Y(ne,F,X))return}}}function t(C,Y){switch(Y.type){case"base64":return r(Ql(cc(C)),Y);case"binary":return r(Ql(C),Y);case"buffer":case"array":return r(C,Y)}throw"Unsupported type "+Y.type}function r(C,Y){if(!C)return C;var q=Y||{},O=q.dense?[]:{},X="Sheet1",F="",Q=0,K={},ne=[],re=[],T={s:{r:0,c:0},e:{r:0,c:0}},I=q.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)q.Enum=ae,e(C,function(me,Te,je){switch(je){case 0:q.vers=me,me>=4096&&(q.qpro=!0);break;case 6:T=me;break;case 204:me&&(F=me);break;case 222:F=me;break;case 15:case 51:q.qpro||(me[1].v=me[1].v.slice(1));case 13:case 14:case 16:je==14&&(me[2]&112)==112&&(me[2]&15)>1&&(me[2]&15)<15&&(me[1].z=q.dateNF||Gn[14],q.cellDates&&(me[1].t="d",me[1].v=TS(me[1].v))),q.qpro&&me[3]>Q&&(O["!ref"]=li(T),K[X]=O,ne.push(X),O=q.dense?[]:{},T={s:{r:0,c:0},e:{r:0,c:0}},Q=me[3],X=F||"Sheet"+(Q+1),F="");var Le=q.dense?(O[me[0].r]||[])[me[0].c]:O[Yn(me[0])];if(Le){Le.t=me[1].t,Le.v=me[1].v,me[1].z!=null&&(Le.z=me[1].z),me[1].f!=null&&(Le.f=me[1].f);break}q.dense?(O[me[0].r]||(O[me[0].r]=[]),O[me[0].r][me[0].c]=me[1]):O[Yn(me[0])]=me[1];break}},q);else if(C[2]==26||C[2]==14)q.Enum=ee,C[2]==14&&(q.qpro=!0,C.l=0),e(C,function(me,Te,je){switch(je){case 204:X=me;break;case 22:me[1].v=me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(me[3]>Q&&(O["!ref"]=li(T),K[X]=O,ne.push(X),O=q.dense?[]:{},T={s:{r:0,c:0},e:{r:0,c:0}},Q=me[3],X="Sheet"+(Q+1)),I>0&&me[0].r>=I)break;q.dense?(O[me[0].r]||(O[me[0].r]=[]),O[me[0].r][me[0].c]=me[1]):O[Yn(me[0])]=me[1],T.e.c<me[0].c&&(T.e.c=me[0].c),T.e.r<me[0].r&&(T.e.r=me[0].r);break;case 27:me[14e3]&&(re[me[14e3][0]]=me[14e3][1]);break;case 1537:re[me[0]]=me[1],me[0]==Q&&(X=me[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(O["!ref"]=li(T),K[F||X]=O,ne.push(F||X),!re.length)return{SheetNames:ne,Sheets:K};for(var ie={},D=[],Z=0;Z<re.length;++Z)K[ne[Z]]?(D.push(re[Z]||ne[Z]),ie[re[Z]]=K[re[Z]]||K[ne[Z]]):(D.push(re[Z]),ie[re[Z]]={"!ref":"A1"});return{SheetNames:D,Sheets:ie}}function n(C,Y){var q=Y||{};if(+q.codepage>=0&&du(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var O=Pl(),X=Ni(C["!ref"]),F=Array.isArray(C),Q=[];un(O,0,s(1030)),un(O,6,c(X));for(var K=Math.min(X.e.r,8191),ne=X.s.r;ne<=K;++ne)for(var re=os(ne),T=X.s.c;T<=X.e.c;++T){ne===X.s.r&&(Q[T]=Ta(T));var I=Q[T]+re,ie=F?(C[ne]||[])[T]:C[I];if(!(!ie||ie.t=="z"))if(ie.t=="n")(ie.v|0)==ie.v&&ie.v>=-32768&&ie.v<=32767?un(O,13,p(ne,T,ie.v)):un(O,14,g(ne,T,ie.v));else{var D=Xd(ie);un(O,15,f(ne,T,D.slice(0,239)))}}return un(O,1),O.end()}function i(C,Y){var q=Y||{};if(+q.codepage>=0&&du(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var O=Pl();un(O,0,o(C));for(var X=0,F=0;X<C.SheetNames.length;++X)(C.Sheets[C.SheetNames[X]]||{})["!ref"]&&un(O,27,V(C.SheetNames[X],F++));var Q=0;for(X=0;X<C.SheetNames.length;++X){var K=C.Sheets[C.SheetNames[X]];if(!(!K||!K["!ref"])){for(var ne=Ni(K["!ref"]),re=Array.isArray(K),T=[],I=Math.min(ne.e.r,8191),ie=ne.s.r;ie<=I;++ie)for(var D=os(ie),Z=ne.s.c;Z<=ne.e.c;++Z){ie===ne.s.r&&(T[Z]=Ta(Z));var me=T[Z]+D,Te=re?(K[ie]||[])[Z]:K[me];if(!(!Te||Te.t=="z"))if(Te.t=="n")un(O,23,B(ie,Z,Q,Te.v));else{var je=Xd(Te);un(O,22,A(ie,Z,Q,je.slice(0,239)))}}++Q}}return un(O,1),O.end()}function s(C){var Y=kr(2);return Y.write_shift(2,C),Y}function o(C){var Y=kr(26);Y.write_shift(2,4096),Y.write_shift(2,4),Y.write_shift(4,0);for(var q=0,O=0,X=0,F=0;F<C.SheetNames.length;++F){var Q=C.SheetNames[F],K=C.Sheets[Q];if(!(!K||!K["!ref"])){++X;var ne=Ol(K["!ref"]);q<ne.e.r&&(q=ne.e.r),O<ne.e.c&&(O=ne.e.c)}}return q>8191&&(q=8191),Y.write_shift(2,q),Y.write_shift(1,X),Y.write_shift(1,O),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(1,1),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(4,0),Y}function l(C,Y,q){var O={s:{c:0,r:0},e:{c:0,r:0}};return Y==8&&q.qpro?(O.s.c=C.read_shift(1),C.l++,O.s.r=C.read_shift(2),O.e.c=C.read_shift(1),C.l++,O.e.r=C.read_shift(2),O):(O.s.c=C.read_shift(2),O.s.r=C.read_shift(2),Y==12&&q.qpro&&(C.l+=2),O.e.c=C.read_shift(2),O.e.r=C.read_shift(2),Y==12&&q.qpro&&(C.l+=2),O.s.c==65535&&(O.s.c=O.e.c=O.s.r=O.e.r=0),O)}function c(C){var Y=kr(8);return Y.write_shift(2,C.s.c),Y.write_shift(2,C.s.r),Y.write_shift(2,C.e.c),Y.write_shift(2,C.e.r),Y}function u(C,Y,q){var O=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(O[0].c=C.read_shift(1),O[3]=C.read_shift(1),O[0].r=C.read_shift(2),C.l+=2):(O[2]=C.read_shift(1),O[0].c=C.read_shift(2),O[0].r=C.read_shift(2)),O}function d(C,Y,q){var O=C.l+Y,X=u(C,Y,q);if(X[1].t="s",q.vers==20768){C.l++;var F=C.read_shift(1);return X[1].v=C.read_shift(F,"utf8"),X}return q.qpro&&C.l++,X[1].v=C.read_shift(O-C.l,"cstr"),X}function f(C,Y,q){var O=kr(7+q.length);O.write_shift(1,255),O.write_shift(2,Y),O.write_shift(2,C),O.write_shift(1,39);for(var X=0;X<O.length;++X){var F=q.charCodeAt(X);O.write_shift(1,F>=128?95:F)}return O.write_shift(1,0),O}function h(C,Y,q){var O=u(C,Y,q);return O[1].v=C.read_shift(2,"i"),O}function p(C,Y,q){var O=kr(7);return O.write_shift(1,255),O.write_shift(2,Y),O.write_shift(2,C),O.write_shift(2,q,"i"),O}function m(C,Y,q){var O=u(C,Y,q);return O[1].v=C.read_shift(8,"f"),O}function g(C,Y,q){var O=kr(13);return O.write_shift(1,255),O.write_shift(2,Y),O.write_shift(2,C),O.write_shift(8,q,"f"),O}function y(C,Y,q){var O=C.l+Y,X=u(C,Y,q);if(X[1].v=C.read_shift(8,"f"),q.qpro)C.l=O;else{var F=C.read_shift(2);S(C.slice(C.l,C.l+F),X),C.l+=F}return X}function b(C,Y,q){var O=Y&32768;return Y&=-32769,Y=(O?C:0)+(Y>=8192?Y-16384:Y),(O?"":"$")+(q?Ta(Y):os(Y))}var v={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(C,Y){go(C,0);for(var q=[],O=0,X="",F="",Q="",K="";C.l<C.length;){var ne=C[C.l++];switch(ne){case 0:q.push(C.read_shift(8,"f"));break;case 1:F=b(Y[0].c,C.read_shift(2),!0),X=b(Y[0].r,C.read_shift(2),!1),q.push(F+X);break;case 2:{var re=b(Y[0].c,C.read_shift(2),!0),T=b(Y[0].r,C.read_shift(2),!1);F=b(Y[0].c,C.read_shift(2),!0),X=b(Y[0].r,C.read_shift(2),!1),q.push(re+T+":"+F+X)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(C.read_shift(2));break;case 6:{for(var I="";ne=C[C.l++];)I+=String.fromCharCode(ne);q.push('"'+I.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:K=q.pop(),Q=q.pop(),q.push(["AND","OR"][ne-20]+"("+Q+","+K+")");break;default:if(ne<32&&w[ne])K=q.pop(),Q=q.pop(),q.push(Q+w[ne]+K);else if(v[ne]){if(O=v[ne][1],O==69&&(O=C[C.l++]),O>q.length){console.error("WK1 bad formula parse 0x"+ne.toString(16)+":|"+q.join("|")+"|");return}var ie=q.slice(-O);q.length-=O,q.push(v[ne][0]+"("+ie.join(",")+")")}else return ne<=7?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=24?console.error("WK1 unsupported op "+ne.toString(16)):ne<=30?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=115?console.error("WK1 unsupported function opcode "+ne.toString(16)):console.error("WK1 unrecognized opcode "+ne.toString(16))}}q.length==1?Y[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function j(C){var Y=[{c:0,r:0},{t:"n",v:0},0];return Y[0].r=C.read_shift(2),Y[3]=C[C.l++],Y[0].c=C[C.l++],Y}function k(C,Y){var q=j(C);return q[1].t="s",q[1].v=C.read_shift(Y-4,"cstr"),q}function A(C,Y,q,O){var X=kr(6+O.length);X.write_shift(2,C),X.write_shift(1,q),X.write_shift(1,Y),X.write_shift(1,39);for(var F=0;F<O.length;++F){var Q=O.charCodeAt(F);X.write_shift(1,Q>=128?95:Q)}return X.write_shift(1,0),X}function R(C,Y){var q=j(C);q[1].v=C.read_shift(2);var O=q[1].v>>1;if(q[1].v&1)switch(O&7){case 0:O=(O>>3)*5e3;break;case 1:O=(O>>3)*500;break;case 2:O=(O>>3)/20;break;case 3:O=(O>>3)/200;break;case 4:O=(O>>3)/2e3;break;case 5:O=(O>>3)/2e4;break;case 6:O=(O>>3)/16;break;case 7:O=(O>>3)/64;break}return q[1].v=O,q}function M(C,Y){var q=j(C),O=C.read_shift(4),X=C.read_shift(4),F=C.read_shift(2);if(F==65535)return O===0&&X===3221225472?(q[1].t="e",q[1].v=15):O===0&&X===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var Q=F&32768;return F=(F&32767)-16446,q[1].v=(1-Q*2)*(X*Math.pow(2,F+32)+O*Math.pow(2,F)),q}function B(C,Y,q,O){var X=kr(14);if(X.write_shift(2,C),X.write_shift(1,q),X.write_shift(1,Y),O==0)return X.write_shift(4,0),X.write_shift(4,0),X.write_shift(2,65535),X;var F=0,Q=0,K=0,ne=0;return O<0&&(F=1,O=-O),Q=Math.log2(O)|0,O/=Math.pow(2,Q-31),ne=O>>>0,ne&2147483648||(O/=2,++Q,ne=O>>>0),O-=ne,ne|=2147483648,ne>>>=0,O*=Math.pow(2,32),K=O>>>0,X.write_shift(4,K),X.write_shift(4,ne),Q+=16383+(F?32768:0),X.write_shift(2,Q),X}function E(C,Y){var q=M(C);return C.l+=Y-14,q}function P(C,Y){var q=j(C),O=C.read_shift(4);return q[1].v=O>>6,q}function U(C,Y){var q=j(C),O=C.read_shift(8,"f");return q[1].v=O,q}function G(C,Y){var q=U(C);return C.l+=Y-10,q}function H(C,Y){return C[C.l+Y-1]==0?C.read_shift(Y,"cstr"):""}function oe(C,Y){var q=C[C.l++];q>Y-1&&(q=Y-1);for(var O="";O.length<q;)O+=String.fromCharCode(C[C.l++]);return O}function de(C,Y,q){if(!(!q.qpro||Y<21)){var O=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var X=C.read_shift(Y-21,"cstr");return[O,X]}}function W(C,Y){for(var q={},O=C.l+Y;C.l<O;){var X=C.read_shift(2);if(X==14e3){for(q[X]=[0,""],q[X][0]=C.read_shift(2);C[C.l];)q[X][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return q}function V(C,Y){var q=kr(5+C.length);q.write_shift(2,14e3),q.write_shift(2,Y);for(var O=0;O<C.length;++O){var X=C.charCodeAt(O);q[q.l++]=X>127?95:X}return q[q.l++]=0,q}var ae={0:{n:"BOF",f:ps},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:H},222:{n:"SHEETNAMELP",f:oe},65535:{n:""}},ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:R},25:{n:"FORMULA19",f:E},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:W},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:U},40:{n:"FORMULA28",f:G},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:H},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:de},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function noe(e){var t={},r=e.match(Go),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Xn(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=E3[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var ioe=function(){var e=f1("t"),t=f1("rPr");function r(s){var o=s.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:Ai(o[1])},c=s.match(t);return c&&(l.s=noe(c[1])),l}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(l){return l.v})}}(),aoe=function(){var t=/(\r\n|\n)/g;function r(i,s,o){var l=[];i.u&&l.push("text-decoration: underline;"),i.uval&&l.push("text-underline-style:"+i.uval+";"),i.sz&&l.push("font-size:"+i.sz+"pt;"),i.outline&&l.push("text-effect: outline;"),i.shadow&&l.push("text-shadow: auto;"),s.push('<span style="'+l.join("")+'">'),i.b&&(s.push("<b>"),o.push("</b>")),i.i&&(s.push("<i>"),o.push("</i>")),i.strike&&(s.push("<s>"),o.push("</s>"));var c=i.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),soe=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,ooe=/<(?:\w+:)?r>/,loe=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Z3(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ai(Ji(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Ji(e),r&&(n.h=D3(n.t))):e.match(ooe)&&(n.r=Ji(e),n.t=Ai(Ji((e.replace(loe,"").match(soe)||[]).join("").replace(Go,""))),r&&(n.h=aoe(ioe(n.r)))),n):{t:""}}var coe=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,uoe=/<(?:\w+:)?(?:si|sstItem)>/g,doe=/<\/(?:\w+:)?(?:si|sstItem)>/;function foe(e,t){var r=[],n="";if(!e)return r;var i=e.match(coe);if(i){n=i[2].replace(uoe,"").split(doe);for(var s=0;s!=n.length;++s){var o=Z3(n[s].trim(),t);o!=null&&(r[r.length]=o)}i=Xn(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var hoe=/^\s|\s$|[\t\n\r]/;function aU(e,t){if(!t.bookSST)return"";var r=[ls];r[r.length]=ln("sst",null,{xmlns:Q0[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(hoe)&&(s+=' xml:space="preserve"'),s+=">"+Vi(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function poe(e){return[e.read_shift(4),e.read_shift(4)]}function moe(e,t){var r=[],n=!1;return df(e,function(s,o,l){switch(l){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function goe(e,t){return t||(t=kr(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var xoe=Nie;function yoe(e){var t=Pl();$r(t,159,goe(e));for(var r=0;r<e.length;++r)$r(t,19,xoe(e[r]));return $r(t,160),t.end()}function sU(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function zd(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function boe(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=zd(e,4),t.U=zd(e,4),t.W=zd(e,4),t}function voe(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function woe(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(voe(e));return t}function Soe(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function _oe(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=zd(e,4),t.U=zd(e,4),t.W=zd(e,4),t}function joe(e){var t=_oe(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function oU(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function lU(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function koe(e){var t=zd(e);switch(t.Minor){case 2:return[t.Minor,Aoe(e)];case 3:return[t.Minor,Noe()];case 4:return[t.Minor,Coe(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Aoe(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=oU(e,r),i=lU(e,e.length-e.l);return{t:"Std",h:n,v:i}}function Noe(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Coe(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Go,function(s){var o=Xn(s);switch(ld(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function Eoe(e,t){var r={},n=r.EncryptionVersionInfo=zd(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=oU(e,i),t-=i,r.EncryptionVerifier=lU(e,t),r}function Toe(e){var t={},r=t.EncryptionVersionInfo=zd(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function eC(e){var t=0,r,n=sU(e),i=n.length+1,s,o,l,c,u;for(r=hh(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)o=r[s],l=t&16384?1:0,c=t<<1&32767,u=l|c,t=u^o;return t^52811}var cU=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,l){return n(o^l)},s=function(o){for(var l=t[o.length-1],c=104,u=o.length-1;u>=0;--u)for(var d=o[u],f=0;f!=7;++f)d&64&&(l^=r[c]),d*=2,--c;return l};return function(o){for(var l=sU(o),c=s(l),u=l.length,d=hh(16),f=0;f!=16;++f)d[f]=0;var h,p,m;for((u&1)===1&&(h=c>>8,d[u]=i(e[0],h),--u,h=c&255,p=l[l.length-1],d[u]=i(p,h));u>0;)--u,h=c>>8,d[u]=i(l[u],h),--u,h=c&255,d[u]=i(l[u],h);for(u=15,m=15-l.length;m>0;)h=c>>8,d[u]=i(e[m],h),--u,--m,h=c&255,d[u]=i(l[u],h),--u,--m;return d}}(),Poe=function(e,t,r,n,i){i||(i=t),n||(n=cU(e));var s,o;for(s=0;s!=t.length;++s)o=t[s],o^=n[r],o=(o>>5|o<<3)&255,i[s]=o,++r;return[i,r,n]},Ooe=function(e){var t=0,r=cU(e);return function(n){var i=Poe("",n,t,r);return t=i[1],i[0]}};function Moe(e,t,r,n){var i={key:ps(e),verificationBytes:ps(e)};return r.password&&(i.verifier=eC(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=Ooe(r.password)),i}function Loe(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Toe(e):n.Data=Eoe(e,t),n}function Roe(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Loe(e,t-2,n):Moe(e,r.biff>=8?t:t-2,r,n),n}var uU=function(){function e(i,s){switch(s.type){case"base64":return t(cc(i),s);case"binary":return t(i,s);case"buffer":return t(gi&&Buffer.isBuffer(i)?i.toString("binary"):kh(i),s);case"array":return t(_0(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var o=s||{},l=o.dense?[]:{},c=i.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(l)&&(l[f]=[]);for(var h=/\\\w+\b/g,p=0,m,g=-1;m=h.exec(d);){switch(m[0]){case"\\cell":var y=d.slice(p,h.lastIndex-m[0].length);if(y[0]==" "&&(y=y.slice(1)),++g,y.length){var b={v:y,t:"s"};Array.isArray(l)?l[f][g]=b:l[Yn({r:f,c:g})]=b}break}p=h.lastIndex}g>u.e.c&&(u.e.c=g)}),l["!ref"]=li(u),l}function r(i,s){return Ah(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],o=Ni(i["!ref"]),l,c=Array.isArray(i),u=o.s.r;u<=o.e.r;++u){s.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var f=Yn({r:u,c:d});l=c?(i[u]||[])[d]:i[f],!(!l||l.v==null&&(!l.f||l.F))&&(s.push(" "+(l.w||(Xd(l),l.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Foe(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function g1(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Boe(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),s=Math.min(t,r,n),o=i-s;if(o===0)return[0,0,t];var l=0,c=0,u=i+s;switch(c=o/(u>1?2-u:u),i){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4;break}return[l/6,c,u/2]}function Ioe(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),s=n-i/2,o=[s,s,s],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=i*l,o[0]+=i,o[1]+=c;break;case 1:c=i*(2-l),o[0]+=c,o[1]+=i;break;case 2:c=i*(l-2),o[1]+=i,o[2]+=c;break;case 3:c=i*(4-l),o[1]+=c,o[2]+=i;break;case 4:c=i*(l-4),o[2]+=i,o[0]+=c;break;case 5:c=i*(6-l),o[2]+=c,o[0]+=i;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function H2(e,t){if(t===0)return e;var r=Boe(Foe(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),g1(Ioe(r))}var dU=6,Doe=15,$oe=1,Bo=dU;function x1(e){return Math.floor((e+Math.round(128/Bo)/256)*Bo)}function y1(e){return Math.floor((e-5)/Bo*100+.5)/100}function V2(e){return Math.round((e*Bo+5)/Bo*256)/256}function rj(e){return V2(y1(x1(e)))}function tC(e){var t=Math.abs(e-rj(e)),r=Bo;if(t>.005)for(Bo=$oe;Bo<Doe;++Bo)Math.abs(e-rj(e))<=t&&(t=Math.abs(e-rj(e)),r=Bo);Bo=r}function ph(e){e.width?(e.wpx=x1(e.width),e.wch=y1(e.wpx),e.MDW=Bo):e.wpx?(e.wch=y1(e.wpx),e.width=V2(e.wch),e.MDW=Bo):typeof e.wch=="number"&&(e.width=V2(e.wch),e.wpx=x1(e.width),e.MDW=Bo),e.customWidth&&delete e.customWidth}var Uoe=96,fU=Uoe;function b1(e){return e*96/fU}function zm(e){return e*fU/96}var zoe={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Woe(e,t,r,n){t.Borders=[];var i={},s=!1;(e[0].match(Go)||[]).forEach(function(o){var l=Xn(o);switch(ld(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},l.diagonalUp&&(i.diagonalUp=pa(l.diagonalUp)),l.diagonalDown&&(i.diagonalDown=pa(l.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in borders")}})}function qoe(e,t,r,n){t.Fills=[];var i={},s=!1;(e[0].match(Go)||[]).forEach(function(o){var l=Xn(o);switch(ld(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":l.patternType&&(i.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),l.indexed&&(i.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(i.bgColor.theme=parseInt(l.theme,10)),l.tint&&(i.bgColor.tint=parseFloat(l.tint)),l.rgb&&(i.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),l.theme&&(i.fgColor.theme=parseInt(l.theme,10)),l.tint&&(i.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(i.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fills")}})}function Hoe(e,t,r,n){t.Fonts=[];var i={},s=!1;(e[0].match(Go)||[]).forEach(function(o){var l=Xn(o);switch(ld(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":l.val&&(i.name=Ji(l.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=l.val?pa(l.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=l.val?pa(l.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(l.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=l.val?pa(l.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=l.val?pa(l.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=l.val?pa(l.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=l.val?pa(l.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=l.val?pa(l.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":l.val&&(i.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(i.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(i.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(i.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=E3[parseInt(l.val,10)];break;case"<color":if(i.color||(i.color={}),l.auto&&(i.color.auto=pa(l.auto)),l.rgb)i.color.rgb=l.rgb.slice(-6);else if(l.indexed){i.color.index=parseInt(l.indexed,10);var c=s0[i.color.index];i.color.index==81&&(c=s0[1]),c||(c=s0[1]),i.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(i.color.theme=parseInt(l.theme,10),l.tint&&(i.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=H2(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fonts")}})}function Voe(e,t,r){t.NumberFmt=[];for(var n=Ka(Gn),i=0;i<n.length;++i)t.NumberFmt[n[i]]=Gn[n[i]];var s=e[0].match(Go);if(s)for(i=0;i<s.length;++i){var o=Xn(s[i]);switch(ld(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=Ai(Ji(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}Ud(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function Goe(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=ln("numFmt",null,{numFmtId:n,formatCode:Vi(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ln("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Cb=["numFmtId","fillId","fontId","borderId","xfId"],Eb=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Koe(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(Go)||[]).forEach(function(s){var o=Xn(s),l=0;switch(ld(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<Cb.length;++l)n[Cb[l]]&&(n[Cb[l]]=parseInt(n[Cb[l]],10));for(l=0;l<Eb.length;++l)n[Eb[l]]&&(n[Eb[l]]=pa(n[Eb[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=pa(o.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function Yoe(e){var t=[];return t[t.length]=ln("cellXfs",null),e.forEach(function(r){t[t.length]=ln("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ln("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Xoe=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(t))&&Voe(f,d,u),(f=l.match(i))&&Hoe(f,d,c,u),(f=l.match(n))&&qoe(f,d,c,u),(f=l.match(s))&&Woe(f,d,c,u),(f=l.match(r))&&Koe(f,d,u),d}}();function hU(e,t){var r=[ls,ln("styleSheet",null,{xmlns:Q0[0],"xmlns:vt":Os.vt})],n;return e.SSF&&(n=Goe(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Yoe(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Qoe(e,t){var r=e.read_shift(2),n=zo(e);return[r,n]}function Joe(e,t,r){r||(r=kr(6+4*t.length)),r.write_shift(2,e),Xs(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Zoe(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=Lie(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=Mie(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=zo(e),n}function ele(e,t){t||(t=kr(25+4*32)),t.write_shift(2,e.sz*20),Rie(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),z2(e.color,t);var n=0;return n=2,t.write_shift(1,n),Xs(e.name,t),t.length>t.l?t.slice(0,t.l):t}var tle=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],nj,rle=Ho;function GP(e,t){t||(t=kr(4*3+8*7+16*1)),nj||(nj=CS(tle));var r=nj[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(z2({auto:1},t),z2({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function nle(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function pU(e,t,r){r||(r=kr(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Hg(e,t){return t||(t=kr(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var ile=Ho;function ale(e,t){return t||(t=kr(51)),t.write_shift(1,0),Hg(null,t),Hg(null,t),Hg(null,t),Hg(null,t),Hg(null,t),t.length>t.l?t.slice(0,t.l):t}function sle(e,t){return t||(t=kr(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),U2(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function ole(e,t,r){var n=kr(2052);return n.write_shift(4,e),U2(t,n),U2(r,n),n.length>n.l?n.slice(0,n.l):n}function lle(e,t,r){var n={};n.NumberFmt=[];for(var i in Gn)n.NumberFmt[i]=Gn[i];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return df(e,function(c,u,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],Ud(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=H2(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(d),o=!0;break;case 38:s.pop(),o=!1;break;default:if(u.T>0)s.push(d);else if(u.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function cle(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&($r(e,615,gu(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&$r(e,44,Joe(i,t[i]))}),$r(e,616))}}function ule(e){var t=1;$r(e,611,gu(t)),$r(e,43,ele({sz:12,color:{theme:1},name:"Calibri",family:2})),$r(e,612)}function dle(e){var t=2;$r(e,603,gu(t)),$r(e,45,GP({patternType:"none"})),$r(e,45,GP({patternType:"gray125"})),$r(e,604)}function fle(e){var t=1;$r(e,613,gu(t)),$r(e,46,ale()),$r(e,614)}function hle(e){var t=1;$r(e,626,gu(t)),$r(e,47,pU({numFmtId:0},65535)),$r(e,627)}function ple(e,t){$r(e,617,gu(t.length)),t.forEach(function(r){$r(e,47,pU(r,0))}),$r(e,618)}function mle(e){var t=1;$r(e,619,gu(t)),$r(e,48,sle({xfId:0,name:"Normal"})),$r(e,620)}function gle(e){var t=0;$r(e,505,gu(t)),$r(e,506)}function xle(e){var t=0;$r(e,508,ole(t,"TableStyleMedium9","PivotStyleMedium4")),$r(e,509)}function yle(e,t){var r=Pl();return $r(r,278),cle(r,e.SSF),ule(r),dle(r),fle(r),hle(r),ple(r,t.cellXfs),mle(r),gle(r),xle(r),$r(r,279),r.end()}var ble=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function vle(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Go)||[]).forEach(function(i){var s=Xn(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[ble.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function wle(){}function Sle(){}var _le=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,jle=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,kle=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Ale(e,t,r){t.themeElements={};var n;[["clrScheme",_le,vle],["fontScheme",jle,wle],["fmtScheme",kle,Sle]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var Nle=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function mU(e,t){(!e||e.length===0)&&(e=rC());var r,n={};if(!(r=e.match(Nle)))throw new Error("themeElements not found in theme");return Ale(r[0],n,t),n.raw=e,n}function rC(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[ls];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Cle(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var o;try{o=o$(s,{type:"array"})}catch{return}var l=Jl(o,"theme/theme/theme1.xml",!0);if(l)return mU(l,r)}}function Ele(e){return e.read_shift(4)}function Tle(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Ple(e,4);break;case 2:t.xclrValue=K$(e);break;case 3:t.xclrValue=Ele(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Ple(e,t){return Ho(e,t)}function Ole(e,t){return Ho(e,t)}function Mle(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Tle(e);break;case 6:n[1]=Ole(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Lle(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(Mle(e,r-e.l));return{ixfe:n,ext:s}}function Rle(e,t){t.forEach(function(r){switch(r[0]){}})}function Fle(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:zo(e)}}function Ble(e){var t=kr(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Xs(e.name,t),t.slice(0,t.l)}function Ile(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Dle(e){var t=kr(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function $le(e,t){var r=kr(8+2*t.length);return r.write_shift(4,e),Xs(t,r),r.slice(0,r.l)}function Ule(e){return e.l+=4,e.read_shift(4)!=0}function zle(e,t){var r=kr(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Wle(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],o=!1,l=2;return df(e,function(c,u,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):l==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:s.push(d),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!u.T){if(!o||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function qle(){var e=Pl();return $r(e,332),$r(e,334,gu(1)),$r(e,335,Ble({name:"XLDAPR",version:12e4,flags:3496657072})),$r(e,336),$r(e,339,$le(1,"XLDAPR")),$r(e,52),$r(e,35,gu(514)),$r(e,4096,gu(0)),$r(e,4097,Mc(1)),$r(e,36),$r(e,53),$r(e,340),$r(e,337,zle(1)),$r(e,51,Dle([[1,0]])),$r(e,338),$r(e,333),e.end()}function Hle(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,s=2,o;return e.replace(Go,function(l){var c=Xn(l);switch(ld(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(o=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function gU(){var e=[ls];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Vle(e){var t=[];if(!e)return t;var r=1;return(e.match(Go)||[]).forEach(function(n){var i=Xn(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function Gle(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Yn(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Kle(e,t,r){var n=[];return df(e,function(s,o,l){switch(l){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function Yle(e,t,r,n){if(!e)return e;var i=n||{},s=!1;df(e,function(l,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},i)}function Xle(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var tm=1024;function xU(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[ln("xml",null,{"xmlns:v":Yl.v,"xmlns:o":Yl.o,"xmlns:x":Yl.x,"xmlns:mv":Yl.mv}).replace(/\/>/,">"),ln("o:shapelayout",ln("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ln("v:shapetype",[ln("v:stroke",null,{joinstyle:"miter"}),ln("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];tm<e*1e3;)tm+=1e3;return t.forEach(function(s){var o=Pa(s[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?ln("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=ln("v:fill",c,l),d={on:"t",obscured:"t"};++tm,i=i.concat(["<v:shape"+h1({id:"_x0000_s"+tm,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,ln("v:shadow",null,d),ln("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",xo("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),xo("x:AutoFill","False"),xo("x:Row",String(o.r)),xo("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function KP(e,t,r,n){var i=Array.isArray(e),s;t.forEach(function(o){var l=Pa(o.ref);if(i?(e[l.r]||(e[l.r]=[]),s=e[l.r][l.c]):s=e[o.ref],!s){s={t:"z"},i?e[l.r][l.c]=s:e[o.ref]=s;var c=Ni(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=li(c);u!==e["!ref"]&&(e["!ref"]=u)}s.c||(s.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}s.c.push(d)})}function Qle(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Xn(l[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=Pa(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&Z3(f[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),n.push(u)}}}}),n}function yU(e){var t=[ls,ln("comments",null,{xmlns:Q0[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var s=Vi(i.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(i=r.indexOf(Vi(c.a))),s.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(xo("t",Vi(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,l=1;l<s.length;++l)o+=`Reply:
    `+s[l]+`
`;t.push(xo("t",Vi(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Jle(e,t){var r=[],n=!1,i={},s=0;return e.replace(Go,function(l,c){var u=Xn(l);switch(ld(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=c+l.length;break;case"</text>":i.t=e.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function Zle(e,t,r){var n=[ls,ln("ThreadedComments",null,{xmlns:Os.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?s=c.id:c.parentId=s,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(ln("threadedComment",xo("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function ece(e,t){var r=[],n=!1;return e.replace(Go,function(s){var o=Xn(s);switch(ld(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function tce(e){var t=[ls,ln("personList",null,{xmlns:Os.TCMNT,"xmlns:x":Q0[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(ln("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function rce(e){var t={};t.iauthor=e.read_shift(4);var r=tp(e);return t.rfx=r.s,t.ref=Yn(r.s),e.l+=16,t}function nce(e,t){return t==null&&(t=kr(36)),t.write_shift(4,e[1].iauthor),dg(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var ice=zo;function ace(e){return Xs(e.slice(0,54))}function sce(e,t){var r=[],n=[],i={},s=!1;return df(e,function(l,c,u){switch(u){case 632:n.push(l);break;case 635:i=l;break;case 637:i.t=l.t,i.h=l.h,i.r=l.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function oce(e){var t=Pl(),r=[];return $r(t,628),$r(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),$r(t,632,ace(i.a)))})}),$r(t,631),$r(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Pa(n[0]),e:Pa(n[0])};$r(t,635,nce([s,i])),i.t&&i.t.length>0&&$r(t,637,Eie(i)),$r(t,636),delete i.iauthor})}),$r(t,634),$r(t,629),t.end()}var lce="application/vnd.ms-office.vbaProject";function cce(e){var t=qn.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");qn.utils.cfb_add(t,i,e.FileIndex[n].content)}}),qn.write(t)}function uce(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&qn.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var bU=["xlsb","xlsm","xlam","biff8","xla"];function dce(){return{"!type":"dialog"}}function fce(){return{"!type":"dialog"}}function hce(){return{"!type":"macro"}}function pce(){return{"!type":"macro"}}var xm=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,o){var l=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=t.c:--d,c?u+=t.r:--u,i+(l?"":"$")+Ta(d)+(c?"":"$")+os(u)}return function(i,s){return t=s,i.replace(e,r)}}(),nC=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,iC=function(){return function(t,r){return t.replace(nC,function(n,i,s,o,l,c){var u=q3(o)-(s?0:r.c),d=W3(c)-(l?0:r.r),f=d==0?"":l?d+1:"["+d+"]",h=u==0?"":s?u+1:"["+u+"]";return i+"R"+f+"C"+h})}}();function vU(e,t){return e.replace(nC,function(r,n,i,s,o,l){return n+(i=="$"?i+s:Ta(q3(s)+t.c))+(o=="$"?o+l:os(W3(l)+t.r))})}function mce(e,t,r){var n=Ol(t),i=n.s,s=Pa(r),o={r:s.r-i.r,c:s.c-i.c};return vU(e,o)}function gce(e){return e.length!=1}function YP(e){return e.replace(/_xlfn\./g,"")}function us(e){e.l+=1}function mh(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function wU(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return SU(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),o=mh(e),l=mh(e);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function SU(e){var t=mh(e),r=mh(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function xce(e,t,r){if(r.biff<8)return SU(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=mh(e),o=mh(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function _U(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return yce(e);var n=e.read_shift(r&&r.biff==12?4:2),i=mh(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function yce(e){var t=mh(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function bce(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function vce(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return wce(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:l}}function wce(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function Sce(e,t,r){var n=(e[e.l++]&96)>>5,i=wU(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function _ce(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=wU(e,s,r);return[n,i,o]}function jce(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function kce(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function Ace(e,t,r){var n=(e[e.l++]&96)>>5,i=xce(e,t-1,r);return[n,i]}function Nce(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function XP(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Cce(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function Ece(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Tce(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Pce(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Oce(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function jU(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Mce(e){return e.read_shift(2),jU(e)}function Lce(e){return e.read_shift(2),jU(e)}function Rce(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=_U(e,0,r);return[n,i]}function Fce(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=vce(e,0,r);return[n,i]}function Bce(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=_U(e,0,r);return[n,i,s]}function Ice(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[Uue[i],NU[i],n]}function Dce(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:$ce(e);return[i,(s[0]===0?NU:$ue)[s[1]]]}function $ce(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Uce(e,t,r){e.l+=r&&r.biff==2?3:4}function zce(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function Wce(e){return e.l++,ff[e.read_shift(1)]}function qce(e){return e.l++,e.read_shift(2)}function Hce(e){return e.l++,e.read_shift(1)!==0}function Vce(e){return e.l++,$o(e)}function Gce(e,t,r){return e.l++,iy(e,t-1,r)}function Kce(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Za(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ff[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=$o(e);break;case 2:r[1]=rp(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Yce(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?tp:PS)(e));return i}function Xce(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var l=0;l!=i;++l)o[s][l]=Kce(e,r.biff);return o}function Qce(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function Jce(e,t,r){if(r.biff==5)return Zce(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function Zce(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function eue(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function tue(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function rue(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function nue(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var iue=Ho,aue=Ho,sue=Ho;function sy(e,t,r){return e.l+=2,[bce(e)]}function aC(e){return e.l+=6,[]}var oue=sy,lue=aC,cue=aC,uue=sy;function kU(e){return e.l+=2,[ps(e),e.read_shift(2)&1]}var due=sy,fue=kU,hue=aC,pue=sy,mue=sy,gue=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function xue(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),o=gue[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:i,C:s}}function yue(e){return e.l+=2,[e.read_shift(4)]}function bue(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function vue(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function wue(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Sue(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function _ue(e){return e.l+=4,[0,0]}var QP={1:{n:"PtgExp",f:zce},2:{n:"PtgTbl",f:sue},3:{n:"PtgAdd",f:us},4:{n:"PtgSub",f:us},5:{n:"PtgMul",f:us},6:{n:"PtgDiv",f:us},7:{n:"PtgPower",f:us},8:{n:"PtgConcat",f:us},9:{n:"PtgLt",f:us},10:{n:"PtgLe",f:us},11:{n:"PtgEq",f:us},12:{n:"PtgGe",f:us},13:{n:"PtgGt",f:us},14:{n:"PtgNe",f:us},15:{n:"PtgIsect",f:us},16:{n:"PtgUnion",f:us},17:{n:"PtgRange",f:us},18:{n:"PtgUplus",f:us},19:{n:"PtgUminus",f:us},20:{n:"PtgPercent",f:us},21:{n:"PtgParen",f:us},22:{n:"PtgMissArg",f:us},23:{n:"PtgStr",f:Gce},26:{n:"PtgSheet",f:bue},27:{n:"PtgEndSheet",f:vue},28:{n:"PtgErr",f:Wce},29:{n:"PtgBool",f:Hce},30:{n:"PtgInt",f:qce},31:{n:"PtgNum",f:Vce},32:{n:"PtgArray",f:Nce},33:{n:"PtgFunc",f:Ice},34:{n:"PtgFuncVar",f:Dce},35:{n:"PtgName",f:Qce},36:{n:"PtgRef",f:Rce},37:{n:"PtgArea",f:Sce},38:{n:"PtgMemArea",f:eue},39:{n:"PtgMemErr",f:iue},40:{n:"PtgMemNoMem",f:aue},41:{n:"PtgMemFunc",f:tue},42:{n:"PtgRefErr",f:rue},43:{n:"PtgAreaErr",f:jce},44:{n:"PtgRefN",f:Fce},45:{n:"PtgAreaN",f:Ace},46:{n:"PtgMemAreaN",f:wue},47:{n:"PtgMemNoMemN",f:Sue},57:{n:"PtgNameX",f:Jce},58:{n:"PtgRef3d",f:Bce},59:{n:"PtgArea3d",f:_ce},60:{n:"PtgRefErr3d",f:nue},61:{n:"PtgAreaErr3d",f:kce},255:{}},jue={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},kue={1:{n:"PtgElfLel",f:kU},2:{n:"PtgElfRw",f:pue},3:{n:"PtgElfCol",f:oue},6:{n:"PtgElfRwV",f:mue},7:{n:"PtgElfColV",f:uue},10:{n:"PtgElfRadical",f:due},11:{n:"PtgElfRadicalS",f:hue},13:{n:"PtgElfColS",f:lue},15:{n:"PtgElfColSV",f:cue},16:{n:"PtgElfRadicalLel",f:fue},25:{n:"PtgList",f:xue},29:{n:"PtgSxName",f:yue},255:{}},Aue={0:{n:"PtgAttrNoop",f:_ue},1:{n:"PtgAttrSemi",f:Oce},2:{n:"PtgAttrIf",f:Tce},4:{n:"PtgAttrChoose",f:Cce},8:{n:"PtgAttrGoto",f:Ece},16:{n:"PtgAttrSum",f:Uce},32:{n:"PtgAttrBaxcel",f:XP},33:{n:"PtgAttrBaxcel",f:XP},64:{n:"PtgAttrSpace",f:Mce},65:{n:"PtgAttrSpaceSemi",f:Lce},128:{n:"PtgAttrIfError",f:Pce},255:{}};function oy(e,t,r,n){if(n.biff<8)return Ho(e,t);for(var i=e.l+t,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=Xce(e,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=Yce(e,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=i-e.l,t!==0&&s.push(Ho(e,t)),s}function ly(e,t,r){for(var n=e.l+t,i,s,o=[];n!=e.l;)t=n-e.l,s=e[e.l],i=QP[s]||QP[jue[s]],(s===24||s===25)&&(i=(s===24?kue:Aue)[e[e.l+1]]),!i||!i.f?Ho(e,t):o.push([i.n,i.f(e,t,r)]);return o}function Nue(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var Cue={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Eue(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function AU(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function JP(e,t,r){var n=AU(e,t,r);return n=="#REF"?n:Eue(n,r)}function Ro(e,t,r,n,i){var s=i&&i.biff||8,o={s:{c:0,r:0}},l=[],c,u,d,f=0,h=0,p,m="";if(!e[0]||!e[0][0])return"";for(var g=-1,y="",b=0,v=e[0].length;b<v;++b){var w=e[0][b];switch(w[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),g>=0){switch(e[0][g][1][0]){case 0:y=qa(" ",e[0][g][1][1]);break;case 1:y=qa("\r",e[0][g][1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+y,g=-1}l.push(u+Cue[w[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Tx(w[1][1],o,i),l.push(Px(d,s));break;case"PtgRefN":d=r?Tx(w[1][1],r,i):w[1][1],l.push(Px(d,s));break;case"PtgRef3d":f=w[1][1],d=Tx(w[1][2],o,i),m=JP(n,f,i),l.push(m+"!"+Px(d,s));break;case"PtgFunc":case"PtgFuncVar":var S=w[1][0],j=w[1][1];S||(S=0),S&=127;var k=S==0?[]:l.slice(-S);l.length-=S,j==="User"&&(j=k.shift()),l.push(j+"("+k.join(",")+")");break;case"PtgBool":l.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(w[1]);break;case"PtgNum":l.push(String(w[1]));break;case"PtgStr":l.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(w[1]);break;case"PtgAreaN":p=NP(w[1][1],r?{s:r}:o,i),l.push(Z5(p,i));break;case"PtgArea":p=NP(w[1][1],o,i),l.push(Z5(p,i));break;case"PtgArea3d":f=w[1][1],p=w[1][2],m=JP(n,f,i),l.push(m+"!"+Z5(p,i));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=w[1][2];var A=(n.names||[])[h-1]||(n[0]||[])[h],R=A?A.Name:"SH33TJSNAME"+String(h);R&&R.slice(0,6)=="_xlfn."&&!i.xlfn&&(R=R.slice(6)),l.push(R);break;case"PtgNameX":var M=w[1][1];h=w[1][2];var B;if(i.biff<=5)M<0&&(M=-M),n[M]&&(B=n[M][h]);else{var E="";if(((n[M]||[])[0]||[])[0]==14849||(((n[M]||[])[0]||[])[0]==1025?n[M][h]&&n[M][h].itab>0&&(E=n.SheetNames[n[M][h].itab-1]+"!"):E=n.SheetNames[h-1]+"!"),n[M]&&n[M][h])E+=n[M][h].Name;else if(n[0]&&n[0][h])E+=n[0][h].Name;else{var P=(AU(n,M,i)||"").split(";;");P[h-1]?E=P[h-1]:E+="SH33TJSERRX"}l.push(E);break}B||(B={Name:"SH33TJSERRY"}),l.push(B.Name);break;case"PtgParen":var U="(",G=")";if(g>=0){switch(y="",e[0][g][1][0]){case 2:U=qa(" ",e[0][g][1][1])+U;break;case 3:U=qa("\r",e[0][g][1][1])+U;break;case 4:G=qa(" ",e[0][g][1][1])+G;break;case 5:G=qa("\r",e[0][g][1][1])+G;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}l.push(U+l.pop()+G);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:w[1][1],r:w[1][0]};var H={c:r.c,r:r.r};if(n.sharedf[Yn(d)]){var oe=n.sharedf[Yn(d)];l.push(Ro(oe,o,H,n,i))}else{var de=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(Ro(u[1],o,H,n,i)),de=!0;break}de||l.push(w[1])}break;case"PtgArray":l.push("{"+Nue(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var W=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&g>=0&&W.indexOf(e[0][b][0])==-1){w=e[0][g];var V=!0;switch(w[1][0]){case 4:V=!1;case 0:y=qa(" ",w[1][1]);break;case 5:V=!1;case 1:y=qa("\r",w[1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}l.push((V?y:"")+l.pop()+(V?"":y)),g=-1}}if(l.length>1&&i.WTF)throw new Error("bad formula stack");return l[0]}function Tue(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],Ho(e,t-2)];var l=ly(e,o,r);return t!==o+i&&(s=oy(e,t-o-i,l,r)),e.l=n,[l,s]}function Pue(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],Ho(e,t-2)];var l=ly(e,o,r);return t!==o+i&&(s=oy(e,t-o-i,l,r)),e.l=n,[l,s]}function Oue(e,t,r,n){var i=e.l+t,s=ly(e,n,r),o;return i!==e.l&&(o=oy(e,i-e.l,s,r)),[s,o]}function Mue(e,t,r){var n=e.l+t,i,s=e.read_shift(2),o=ly(e,s,r);return s==65535?[[],Ho(e,t-2)]:(t!==s+2&&(i=oy(e,n-s-2,o,r)),[o,i])}function Lue(e){var t;if(Rd(e,e.l+6)!==65535)return[$o(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Rue(e){if(e==null){var t=kr(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return j0(e);return j0(0)}function ij(e,t,r){var n=e.l+t,i=cd(e);r.biff==2&&++e.l;var s=Lue(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=Pue(e,n-e.l,r);return{cell:i,val:s[0],formula:l,shared:o>>3&1,tt:s[1]}}function Fue(e,t,r,n,i){var s=A0(t,r,i),o=Rue(e.v),l=kr(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=kr(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=Ks([s,o,l,u]);return f}function OS(e,t,r){var n=e.read_shift(4),i=ly(e,n,r),s=e.read_shift(4),o=s>0?oy(e,s,i,r):null;return[i,o]}var Bue=OS,MS=OS,Iue=OS,Due=OS,$ue={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},NU={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Uue={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ZP(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function zue(e){var t="of:="+e.replace(nC,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function aj(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Wue(e){return e.replace(/\./,"!")}var Mx={},ym={},Lx=typeof Map<"u";function sC(e,t,r){var n=0,i=e.length;if(r){if(Lx?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Lx?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(Lx?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function LS(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Bo=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=y1(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=V2(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function c0(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Nh(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Ud(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function CU(e,t,r,n,i,s){try{n.cellNF&&(e.z=Gn[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=xa(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Gn[t]==null&&Ud($ne[t]||"General",t),e.t==="e")e.w=e.w||ff[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=d1(e.v);else if(e.t==="d"){var o=Ls(e.v);(o|0)===o?e.w=o.toString(10):e.w=d1(o)}else{if(e.v===void 0)return"";e.w=S0(e.v,ym)}else e.t==="d"?e.w=Wc(t,Ls(e.v),ym):e.w=Wc(t,e.v,ym)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=H2(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=H2(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&s.Fills)throw l}}}function que(e,t,r){if(e&&e["!ref"]){var n=Ni(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Hue(e,t){var r=Ni(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=li(r))}var Vue=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Gue=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Kue=/<(?:\w:)?hyperlink [^>]*>/mg,Yue=/"(\w*:\w*)"/,Xue=/<(?:\w:)?col\b[^>]*[\/]?>/g,Que=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Jue=/<(?:\w:)?pageMargins[^>]*\/>/g,EU=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Zue=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,ede=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function tde(e,t,r,n,i,s,o){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(Gue);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var h=u.match(EU);h?oC(h[0],l,i,r):(h=u.match(Zue))&&nde(h[0],h[1]||"",l,i,r);var p=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var m=u.slice(p,p+50).match(Yue);m&&Hue(l,m[1])}var g=u.match(ede);g&&g[1]&&gde(g[1],i);var y=[];if(t.cellStyles){var b=u.match(Xue);b&&dde(y,b)}f&&bde(f[1],l,t,c,s,o);var v=d.match(Que);v&&(l["!autofilter"]=hde(v[0]));var w=[],S=d.match(Vue);if(S)for(p=0;p!=S.length;++p)w[p]=Ni(S[p].slice(S[p].indexOf('"')+1));var j=d.match(Kue);j&&lde(l,j,n);var k=d.match(Jue);if(k&&(l["!margins"]=cde(Xn(k[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=li(c)),t.sheetRows>0&&l["!ref"]){var A=Ni(l["!ref"]);t.sheetRows<=+A.e.r&&(A.e.r=t.sheetRows-1,A.e.r>c.e.r&&(A.e.r=c.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>c.e.c&&(A.e.c=c.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),l["!fullref"]=l["!ref"],l["!ref"]=li(A))}return y.length>0&&(l["!cols"]=y),w.length>0&&(l["!merges"]=w),l}function rde(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+li(e[r])+'"/>';return t+"</mergeCells>"}function oC(e,t,r,n){var i=Xn(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Ai(Ji(i.codeName)))}function nde(e,t,r,n,i){oC(e.slice(0,e.indexOf(">")),r,n,i)}function ide(e,t,r,n,i){var s=!1,o={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,o.codeName=Ku(Vi(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),l=(l||"")+ln("outlinePr",null,u)}!s&&!l||(i[i.length]=ln("sheetPr",l,o))}var ade=["objects","scenarios","selectLockedCells","selectUnlockedCells"],sde=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function ode(e){var t={sheet:1};return ade.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),sde.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=eC(e.password).toString(16).toUpperCase()),ln("sheetProtection",null,t)}function lde(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var s=Xn(Ji(t[i]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+Ai(s.location))):(s.Target="#"+Ai(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var l=Ni(s.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var d=Yn({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=s):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=s)}}}function cde(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function ude(e){return c0(e),ln("pageMargins",null,e)}function dde(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=Xn(t[n],!0);i.hidden&&(i.hidden=pa(i.hidden));var s=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,tC(i.width)),ph(i);s<=o;)e[s++]=ya(i)}}function fde(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=ln("col",null,LS(i,n)));return r[r.length]="</cols>",r.join("")}function hde(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function pde(e,t,r,n){var i=typeof e.ref=="string"?e.ref:li(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=Ol(i);o.s.r==o.e.r&&(o.e.r=Ol(t["!ref"]).e.r,i=li(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),ln("autoFilter",null,{ref:i})}var mde=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function gde(e,t){t.Views||(t.Views=[{}]),(e.match(mde)||[]).forEach(function(r,n){var i=Xn(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),pa(i.rightToLeft)&&(t.Views[n].RTL=!0)})}function xde(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ln("sheetViews",ln("sheetView",null,i),{})}function yde(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=ff[e.v];break;case"d":n&&n.cellDates?i=xa(e.v,-1).toISOString():(e=ya(e),e.t="n",i=""+(e.v=Ls(xa(e.v)))),typeof e.z>"u"&&(e.z=Gn[14]);break;default:i=e.v;break}var l=xo("v",Vi(i)),c={r:t},u=Nh(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=xo("v",""+sC(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=s&&(e.t=s,e.v=o),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=ln("f",Vi(e.f),d)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),ln("c",l,c)}var bde=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=f1("v"),o=f1("f");return function(c,u,d,f,h,p){for(var m=0,g="",y=[],b=[],v=0,w=0,S=0,j="",k,A,R=0,M=0,B,E,P=0,U=0,G=Array.isArray(p.CellXf),H,oe=[],de=[],W=Array.isArray(u),V=[],ae={},ee=!1,C=!!d.sheetStubs,Y=c.split(t),q=0,O=Y.length;q!=O;++q){g=Y[q].trim();var X=g.length;if(X!==0){var F=0;e:for(m=0;m<X;++m)switch(g[m]){case">":if(g[m-1]!="/"){++m;break e}if(d&&d.cellStyles){if(A=Xn(g.slice(F,m),!0),R=A.r!=null?parseInt(A.r,10):R+1,M=-1,d.sheetRows&&d.sheetRows<R)continue;ae={},ee=!1,A.ht&&(ee=!0,ae.hpt=parseFloat(A.ht),ae.hpx=zm(ae.hpt)),A.hidden=="1"&&(ee=!0,ae.hidden=!0),A.outlineLevel!=null&&(ee=!0,ae.level=+A.outlineLevel),ee&&(V[R-1]=ae)}break;case"<":F=m;break}if(F>=m)break;if(A=Xn(g.slice(F,m),!0),R=A.r!=null?parseInt(A.r,10):R+1,M=-1,!(d.sheetRows&&d.sheetRows<R)){f.s.r>R-1&&(f.s.r=R-1),f.e.r<R-1&&(f.e.r=R-1),d&&d.cellStyles&&(ae={},ee=!1,A.ht&&(ee=!0,ae.hpt=parseFloat(A.ht),ae.hpx=zm(ae.hpt)),A.hidden=="1"&&(ee=!0,ae.hidden=!0),A.outlineLevel!=null&&(ee=!0,ae.level=+A.outlineLevel),ee&&(V[R-1]=ae)),y=g.slice(m).split(e);for(var Q=0;Q!=y.length&&y[Q].trim().charAt(0)=="<";++Q);for(y=y.slice(Q),m=0;m!=y.length;++m)if(g=y[m].trim(),g.length!==0){if(b=g.match(r),v=m,w=0,S=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,b!=null&&b.length===2){for(v=0,j=b[1],w=0;w!=j.length&&!((S=j.charCodeAt(w)-64)<1||S>26);++w)v=26*v+S;--v,M=v}else++M;for(w=0;w!=g.length&&g.charCodeAt(w)!==62;++w);if(++w,A=Xn(g.slice(0,w),!0),A.r||(A.r=Yn({r:R-1,c:M})),j=g.slice(w),k={t:""},(b=j.match(s))!=null&&b[1]!==""&&(k.v=Ai(b[1])),d.cellFormula){if((b=j.match(o))!=null&&b[1]!==""){if(k.f=Ai(Ji(b[1])).replace(/\r\n/g,`
`),d.xlfn||(k.f=YP(k.f)),b[0].indexOf('t="array"')>-1)k.F=(j.match(i)||[])[1],k.F.indexOf(":")>-1&&oe.push([Ni(k.F),k.F]);else if(b[0].indexOf('t="shared"')>-1){E=Xn(b[0]);var K=Ai(Ji(b[1]));d.xlfn||(K=YP(K)),de[parseInt(E.si,10)]=[E,K,A.r]}}else(b=j.match(/<f[^>]*\/>/))&&(E=Xn(b[0]),de[E.si]&&(k.f=mce(de[E.si][1],de[E.si][2],A.r)));var ne=Pa(A.r);for(w=0;w<oe.length;++w)ne.r>=oe[w][0].s.r&&ne.r<=oe[w][0].e.r&&ne.c>=oe[w][0].s.c&&ne.c<=oe[w][0].e.c&&(k.F=oe[w][1])}if(A.t==null&&k.v===void 0)if(k.f||k.F)k.v=0,k.t="n";else if(C)k.t="z";else continue;else k.t=A.t||"n";switch(f.s.c>M&&(f.s.c=M),f.e.c<M&&(f.e.c=M),k.t){case"n":if(k.v==""||k.v==null){if(!C)continue;k.t="z"}else k.v=parseFloat(k.v);break;case"s":if(typeof k.v>"u"){if(!C)continue;k.t="z"}else B=Mx[parseInt(k.v,10)],k.v=B.t,k.r=B.r,d.cellHTML&&(k.h=B.h);break;case"str":k.t="s",k.v=k.v!=null?Ji(k.v):"",d.cellHTML&&(k.h=D3(k.v));break;case"inlineStr":b=j.match(n),k.t="s",b!=null&&(B=Z3(b[1]))?(k.v=B.t,d.cellHTML&&(k.h=B.h)):k.v="";break;case"b":k.v=pa(k.v);break;case"d":d.cellDates?k.v=xa(k.v,1):(k.v=Ls(xa(k.v,1)),k.t="n");break;case"e":(!d||d.cellText!==!1)&&(k.w=k.v),k.v=P$[k.v];break}if(P=U=0,H=null,G&&A.s!==void 0&&(H=p.CellXf[A.s],H!=null&&(H.numFmtId!=null&&(P=H.numFmtId),d.cellStyles&&H.fillId!=null&&(U=H.fillId))),CU(k,P,U,d,h,p),d.cellDates&&G&&k.t=="n"&&lg(Gn[P])&&(k.t="d",k.v=TS(k.v)),A.cm&&d.xlmeta){var re=(d.xlmeta.Cell||[])[+A.cm-1];re&&re.type=="XLDAPR"&&(k.D=!0)}if(W){var T=Pa(A.r);u[T.r]||(u[T.r]=[]),u[T.r][T.c]=k}else u[A.r]=k}}}}V.length>0&&(u["!rows"]=V)}}();function vde(e,t,r,n){var i=[],s=[],o=Ni(e["!ref"]),l="",c,u="",d=[],f=0,h=0,p=e["!rows"],m=Array.isArray(e),g={r:u},y,b=-1;for(h=o.s.c;h<=o.e.c;++h)d[h]=Ta(h);for(f=o.s.r;f<=o.e.r;++f){for(s=[],u=os(f),h=o.s.c;h<=o.e.c;++h){c=d[h]+u;var v=m?(e[f]||[])[h]:e[c];v!==void 0&&(l=yde(v,c,e,t))!=null&&s.push(l)}(s.length>0||p&&p[f])&&(g={r:u},p&&p[f]&&(y=p[f],y.hidden&&(g.hidden=1),b=-1,y.hpx?b=b1(y.hpx):y.hpt&&(b=y.hpt),b>-1&&(g.ht=b,g.customHeight=1),y.level&&(g.outlineLevel=y.level)),i[i.length]=ln("row",s.join(""),g))}if(p)for(;f<p.length;++f)p&&p[f]&&(g={r:f+1},y=p[f],y.hidden&&(g.hidden=1),b=-1,y.hpx?b=b1(y.hpx):y.hpt&&(b=y.hpt),b>-1&&(g.ht=b,g.customHeight=1),y.level&&(g.outlineLevel=y.level),i[i.length]=ln("row","",g));return i.join("")}function TU(e,t,r,n){var i=[ls,ln("worksheet",null,{xmlns:Q0[0],"xmlns:r":Os.r})],s=r.SheetNames[e],o=0,l="",c=r.Sheets[s];c==null&&(c={});var u=c["!ref"]||"A1",d=Ni(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=li(d)}n||(n={}),c["!comments"]=[];var f=[];ide(c,r,e,t,i),i[i.length]=ln("dimension",null,{ref:u}),i[i.length]=xde(c,t,e,r),t.sheetFormat&&(i[i.length]=ln("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(i[i.length]=fde(c,c["!cols"])),i[o=i.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=vde(c,t),l.length>0&&(i[i.length]=l)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),c["!protect"]&&(i[i.length]=ode(c["!protect"])),c["!autofilter"]!=null&&(i[i.length]=pde(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(i[i.length]=rde(c["!merges"]));var h=-1,p,m=-1;return c["!links"].length>0&&(i[i.length]="<hyperlinks>",c["!links"].forEach(function(g){g[1].Target&&(p={ref:g[0]},g[1].Target.charAt(0)!="#"&&(m=Wi(n,-1,Vi(g[1].Target).replace(/#.*$/,""),yi.HLINK),p["r:id"]="rId"+m),(h=g[1].Target.indexOf("#"))>-1&&(p.location=Vi(g[1].Target.slice(h+1))),g[1].Tooltip&&(p.tooltip=Vi(g[1].Tooltip)),i[i.length]=ln("hyperlink",null,p))}),i[i.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(i[i.length]=ude(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=xo("ignoredErrors",ln("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(m=Wi(n,-1,"../drawings/drawing"+(e+1)+".xml",yi.DRAW),i[i.length]=ln("drawing",null,{"r:id":"rId"+m}),c["!drawing"]=f),c["!comments"].length>0&&(m=Wi(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",yi.VML),i[i.length]=ln("legacyDrawing",null,{"r:id":"rId"+m}),c["!legacy"]=m),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function wde(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function Sde(e,t,r){var n=kr(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=b1(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,h=-1,p=d<<10;p<d+1<<10;++p){u.c=p;var m=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Yn(u)];m&&(f<0&&(f=p),h=p)}f<0||(++l,n.write_shift(4,f),n.write_shift(4,h))}var g=n.l;return n.l=c,n.write_shift(4,l),n.l=g,n.length>n.l?n.slice(0,n.l):n}function _de(e,t,r,n){var i=Sde(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&$r(e,0,i)}var jde=tp,kde=dg;function Ade(){}function Nde(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Tie(e),r}function Cde(e,t,r){r==null&&(r=kr(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return z2({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),A$(e,r),r.slice(0,r.l)}function Ede(e){var t=Kc(e);return[t]}function Tde(e,t,r){return r==null&&(r=kr(8)),J0(t,r)}function Pde(e){var t=Z0(e);return[t]}function Ode(e,t,r){return r==null&&(r=kr(4)),ep(t,r)}function Mde(e){var t=Kc(e),r=e.read_shift(1);return[t,r,"b"]}function Lde(e,t,r){return r==null&&(r=kr(9)),J0(t,r),r.write_shift(1,e.v?1:0),r}function Rde(e){var t=Z0(e),r=e.read_shift(1);return[t,r,"b"]}function Fde(e,t,r){return r==null&&(r=kr(5)),ep(t,r),r.write_shift(1,e.v?1:0),r}function Bde(e){var t=Kc(e),r=e.read_shift(1);return[t,r,"e"]}function Ide(e,t,r){return r==null&&(r=kr(9)),J0(t,r),r.write_shift(1,e.v),r}function Dde(e){var t=Z0(e),r=e.read_shift(1);return[t,r,"e"]}function $de(e,t,r){return r==null&&(r=kr(8)),ep(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Ude(e){var t=Kc(e),r=e.read_shift(4);return[t,r,"s"]}function zde(e,t,r){return r==null&&(r=kr(12)),J0(t,r),r.write_shift(4,t.v),r}function Wde(e){var t=Z0(e),r=e.read_shift(4);return[t,r,"s"]}function qde(e,t,r){return r==null&&(r=kr(8)),ep(t,r),r.write_shift(4,t.v),r}function Hde(e){var t=Kc(e),r=$o(e);return[t,r,"n"]}function Vde(e,t,r){return r==null&&(r=kr(16)),J0(t,r),j0(e.v,r),r}function PU(e){var t=Z0(e),r=$o(e);return[t,r,"n"]}function Gde(e,t,r){return r==null&&(r=kr(12)),ep(t,r),j0(e.v,r),r}function Kde(e){var t=Kc(e),r=K3(e);return[t,r,"n"]}function Yde(e,t,r){return r==null&&(r=kr(12)),J0(t,r),N$(e.v,r),r}function Xde(e){var t=Z0(e),r=K3(e);return[t,r,"n"]}function Qde(e,t,r){return r==null&&(r=kr(8)),ep(t,r),N$(e.v,r),r}function Jde(e){var t=Kc(e),r=H3(e);return[t,r,"is"]}function Zde(e){var t=Kc(e),r=zo(e);return[t,r,"str"]}function efe(e,t,r){return r==null&&(r=kr(12+4*e.v.length)),J0(t,r),Xs(e.v,r),r.length>r.l?r.slice(0,r.l):r}function tfe(e){var t=Z0(e),r=zo(e);return[t,r,"str"]}function rfe(e,t,r){return r==null&&(r=kr(8+4*e.v.length)),ep(t,r),Xs(e.v,r),r.length>r.l?r.slice(0,r.l):r}function nfe(e,t,r){var n=e.l+t,i=Kc(e);i.r=r["!row"];var s=e.read_shift(1),o=[i,s,"b"];if(r.cellFormula){e.l+=2;var l=MS(e,n-e.l,r);o[3]=Ro(l,null,i,r.supbooks,r)}else e.l=n;return o}function ife(e,t,r){var n=e.l+t,i=Kc(e);i.r=r["!row"];var s=e.read_shift(1),o=[i,s,"e"];if(r.cellFormula){e.l+=2;var l=MS(e,n-e.l,r);o[3]=Ro(l,null,i,r.supbooks,r)}else e.l=n;return o}function afe(e,t,r){var n=e.l+t,i=Kc(e);i.r=r["!row"];var s=$o(e),o=[i,s,"n"];if(r.cellFormula){e.l+=2;var l=MS(e,n-e.l,r);o[3]=Ro(l,null,i,r.supbooks,r)}else e.l=n;return o}function sfe(e,t,r){var n=e.l+t,i=Kc(e);i.r=r["!row"];var s=zo(e),o=[i,s,"str"];if(r.cellFormula){e.l+=2;var l=MS(e,n-e.l,r);o[3]=Ro(l,null,i,r.supbooks,r)}else e.l=n;return o}var ofe=tp,lfe=dg;function cfe(e,t){return t==null&&(t=kr(4)),t.write_shift(4,e),t}function ufe(e,t){var r=e.l+t,n=tp(e),i=V3(e),s=zo(e),o=zo(e),l=zo(e);e.l=r;var c={rfx:n,relId:i,loc:s,display:l};return o&&(c.Tooltip=o),c}function dfe(e,t){var r=kr(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));dg({s:Pa(e[0]),e:Pa(e[0])},r),G3("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return Xs(i||"",r),Xs(e[1].Tooltip||"",r),Xs("",r),r.slice(0,r.l)}function ffe(){}function hfe(e,t,r){var n=e.l+t,i=C$(e),s=e.read_shift(1),o=[i];if(o[2]=s,r.cellFormula){var l=Bue(e,n-e.l,r);o[1]=l}else e.l=n;return o}function pfe(e,t,r){var n=e.l+t,i=tp(e),s=[i];if(r.cellFormula){var o=Due(e,n-e.l,r);s[1]=o,e.l=n}else e.l=n;return s}function mfe(e,t,r){r==null&&(r=kr(18));var n=LS(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var OU=["left","right","top","bottom","header","footer"];function gfe(e){var t={};return OU.forEach(function(r){t[r]=$o(e)}),t}function xfe(e,t){return t==null&&(t=kr(6*8)),c0(e),OU.forEach(function(r){j0(e[r],t)}),t}function yfe(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function bfe(e,t,r){r==null&&(r=kr(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function vfe(e){var t=kr(24);return t.write_shift(4,4),t.write_shift(4,1),dg(e,t),t}function wfe(e,t){return t==null&&(t=kr(16*4+2)),t.write_shift(2,e.password?eC(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Sfe(){}function _fe(){}function jfe(e,t,r,n,i,s,o){if(!e)return e;var l=t||{};n||(n={"!id":{}});var c=l.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,p,m,g,y,b,v,w,S,j,k=[];l.biff=12,l["!row"]=0;var A=0,R=!1,M=[],B={},E=l.supbooks||i.supbooks||[[]];if(E.sharedf=B,E.arrayf=M,E.SheetNames=i.SheetNames||i.Sheets.map(function(W){return W.name}),!l.supbooks&&(l.supbooks=E,i.Names))for(var P=0;P<i.Names.length;++P)E[0][P+1]=i.Names[P];var U=[],G=[],H=!1;v1[16]={n:"BrtShortReal",f:PU};var oe;if(df(e,function(V,ae,ee){if(!h)switch(ee){case 148:u=V;break;case 0:p=V,l.sheetRows&&l.sheetRows<=p.r&&(h=!0),S=os(y=p.r),l["!row"]=p.r,(V.hidden||V.hpt||V.level!=null)&&(V.hpt&&(V.hpx=zm(V.hpt)),G[V.r]=V);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:V[2]},V[2]){case"n":m.v=V[1];break;case"s":w=Mx[V[1]],m.v=w.t,m.r=w.r;break;case"b":m.v=!!V[1];break;case"e":m.v=V[1],l.cellText!==!1&&(m.w=ff[m.v]);break;case"str":m.t="s",m.v=V[1];break;case"is":m.t="s",m.v=V[1].t;break}if((g=o.CellXf[V[0].iStyleRef])&&CU(m,g.numFmtId,null,l,s,o),b=V[0].c==-1?b+1:V[0].c,l.dense?(c[y]||(c[y]=[]),c[y][b]=m):c[Ta(b)+S]=m,l.cellFormula){for(R=!1,A=0;A<M.length;++A){var C=M[A];p.r>=C[0].s.r&&p.r<=C[0].e.r&&b>=C[0].s.c&&b<=C[0].e.c&&(m.F=li(C[0]),R=!0)}!R&&V.length>3&&(m.f=V[3])}if(d.s.r>p.r&&(d.s.r=p.r),d.s.c>b&&(d.s.c=b),d.e.r<p.r&&(d.e.r=p.r),d.e.c<b&&(d.e.c=b),l.cellDates&&g&&m.t=="n"&&lg(Gn[g.numFmtId])){var Y=Xh(m.v);Y&&(m.t="d",m.v=new Date(Y.y,Y.m-1,Y.d,Y.H,Y.M,Y.S,Y.u))}oe&&(oe.type=="XLDAPR"&&(m.D=!0),oe=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;m={t:"z",v:void 0},b=V[0].c==-1?b+1:V[0].c,l.dense?(c[y]||(c[y]=[]),c[y][b]=m):c[Ta(b)+S]=m,d.s.r>p.r&&(d.s.r=p.r),d.s.c>b&&(d.s.c=b),d.e.r<p.r&&(d.e.r=p.r),d.e.c<b&&(d.e.c=b),oe&&(oe.type=="XLDAPR"&&(m.D=!0),oe=void 0);break;case 176:k.push(V);break;case 49:oe=((l.xlmeta||{}).Cell||[])[V-1];break;case 494:var q=n["!id"][V.relId];for(q?(V.Target=q.Target,V.loc&&(V.Target+="#"+V.loc),V.Rel=q):V.relId==""&&(V.Target="#"+V.loc),y=V.rfx.s.r;y<=V.rfx.e.r;++y)for(b=V.rfx.s.c;b<=V.rfx.e.c;++b)l.dense?(c[y]||(c[y]=[]),c[y][b]||(c[y][b]={t:"z",v:void 0}),c[y][b].l=V):(v=Yn({c:b,r:y}),c[v]||(c[v]={t:"z",v:void 0}),c[v].l=V);break;case 426:if(!l.cellFormula)break;M.push(V),j=l.dense?c[y][b]:c[Ta(b)+S],j.f=Ro(V[1],d,{r:p.r,c:b},E,l),j.F=li(V[0]);break;case 427:if(!l.cellFormula)break;B[Yn(V[0].s)]=V[1],j=l.dense?c[y][b]:c[Ta(b)+S],j.f=Ro(V[1],d,{r:p.r,c:b},E,l);break;case 60:if(!l.cellStyles)break;for(;V.e>=V.s;)U[V.e--]={width:V.w/256,hidden:!!(V.flags&1),level:V.level},H||(H=!0,tC(V.w/256)),ph(U[V.e+1]);break;case 161:c["!autofilter"]={ref:li(V)};break;case 476:c["!margins"]=V;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),V.name&&(i.Sheets[r].CodeName=V.name),(V.above||V.left)&&(c["!outline"]={above:V.above,left:V.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),V.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!ae.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+ee.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=li(u||d)),l.sheetRows&&c["!ref"]){var de=Ni(c["!ref"]);l.sheetRows<=+de.e.r&&(de.e.r=l.sheetRows-1,de.e.r>d.e.r&&(de.e.r=d.e.r),de.e.r<de.s.r&&(de.s.r=de.e.r),de.e.c>d.e.c&&(de.e.c=d.e.c),de.e.c<de.s.c&&(de.s.c=de.e.c),c["!fullref"]=c["!ref"],c["!ref"]=li(de))}return k.length>0&&(c["!merges"]=k),U.length>0&&(c["!cols"]=U),G.length>0&&(c["!rows"]=G),c}function kfe(e,t,r,n,i,s,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=ya(t),t.z=t.z||Gn[14],t.v=Ls(xa(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:n};switch(c.s=Nh(i.cellXfs,t,i),t.l&&s["!links"].push([Yn(c),t.l]),t.c&&s["!comments"].push([Yn(c),t.c]),t.t){case"s":case"str":return i.bookSST?(l=sC(i.Strings,t.v,i.revStrings),c.t="s",c.v=l,o?$r(e,18,qde(t,c)):$r(e,7,zde(t,c))):(c.t="str",o?$r(e,17,rfe(t,c)):$r(e,6,efe(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?$r(e,13,Qde(t,c)):$r(e,2,Yde(t,c)):o?$r(e,16,Gde(t,c)):$r(e,5,Vde(t,c)),!0;case"b":return c.t="b",o?$r(e,15,Fde(t,c)):$r(e,4,Lde(t,c)),!0;case"e":return c.t="e",o?$r(e,14,$de(t,c)):$r(e,3,Ide(t,c)),!0}return o?$r(e,12,Ode(t,c)):$r(e,1,Tde(t,c)),!0}function Afe(e,t,r,n){var i=Ni(t["!ref"]||"A1"),s,o="",l=[];$r(e,145);var c=Array.isArray(t),u=i.e.r;t["!rows"]&&(u=Math.max(i.e.r,t["!rows"].length-1));for(var d=i.s.r;d<=u;++d){o=os(d),_de(e,t,i,d);var f=!1;if(d<=i.e.r)for(var h=i.s.c;h<=i.e.c;++h){d===i.s.r&&(l[h]=Ta(h)),s=l[h]+o;var p=c?(t[d]||[])[h]:t[s];if(!p){f=!1;continue}f=kfe(e,p,d,h,n,t,f)}}$r(e,146)}function Nfe(e,t){!t||!t["!merges"]||($r(e,177,cfe(t["!merges"].length)),t["!merges"].forEach(function(r){$r(e,176,lfe(r))}),$r(e,178))}function Cfe(e,t){!t||!t["!cols"]||($r(e,390),t["!cols"].forEach(function(r,n){r&&$r(e,60,mfe(n,r))}),$r(e,391))}function Efe(e,t){!t||!t["!ref"]||($r(e,648),$r(e,649,vfe(Ni(t["!ref"]))),$r(e,650))}function Tfe(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=Wi(r,-1,n[1].Target.replace(/#.*$/,""),yi.HLINK);$r(e,494,dfe(n,i))}}),delete t["!links"]}function Pfe(e,t,r,n){if(t["!comments"].length>0){var i=Wi(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",yi.VML);$r(e,551,G3("rId"+i)),t["!legacy"]=i}}function Ofe(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:li(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=Ol(s);l.s.r==l.e.r&&(l.e.r=Ol(t["!ref"]).e.r,s=li(l));for(var c=0;c<o.length;++c){var u=o[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),$r(e,161,dg(Ni(s))),$r(e,162)}}function Mfe(e,t,r){$r(e,133),$r(e,137,bfe(t,r)),$r(e,138),$r(e,134)}function Lfe(e,t){t["!protect"]&&$r(e,535,wfe(t["!protect"]))}function Rfe(e,t,r,n){var i=Pl(),s=r.SheetNames[e],o=r.Sheets[s]||{},l=s;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=Ni(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],$r(i,129),(r.vbaraw||o["!outline"])&&$r(i,147,Cde(l,o["!outline"])),$r(i,148,kde(c)),Mfe(i,o,r.Workbook),Cfe(i,o),Afe(i,o,e,t),Lfe(i,o),Ofe(i,o,r,e),Nfe(i,o),Tfe(i,o,n),o["!margins"]&&$r(i,476,xfe(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Efe(i,o),Pfe(i,o,e,n),$r(i,130),i.end()}function Ffe(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var i=Ai((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,i,n]}function Bfe(e,t,r,n,i,s){var o=s||{"!type":"chart"};if(!e)return s;var l=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=Ffe(f);d.s.r=d.s.c=0,d.e.c=l,u=Ta(l),h[0].forEach(function(p,m){o[u+os(m)]={t:"n",v:p,z:h[1]},c=m}),d.e.r<c&&(d.e.r=c),++l}),l>0&&(o["!ref"]=li(d)),o}function Ife(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(EU);return l&&oC(l[0],s,i,r),(o=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function Dfe(e,t){e.l+=10;var r=zo(e);return{name:r}}function $fe(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return df(e,function(c,u,d){switch(d){case 550:s["!rel"]=c;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),c.name&&(i.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var lC=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Ufe=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],zfe=[],Wfe=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function eO(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var s=t[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=pa(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function tO(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=pa(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function MU(e){tO(e.WBProps,lC),tO(e.CalcPr,Wfe),eO(e.WBView,Ufe),eO(e.Sheets,zfe),ym.date1904=pa(e.WBProps.date1904)}function qfe(e){return!e.Workbook||!e.Workbook.WBProps?"false":pa(e.Workbook.WBProps.date1904)?"true":"false"}var Hfe="][*?/\\".split("");function LU(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Hfe.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Vfe(e,t,r){e.forEach(function(n,i){LU(n);for(var s=0;s<i;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[i]&&t[i].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function Gfe(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Vfe(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)que(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var Kfe=/<\w+:workbook/;function Yfe(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},o=0;if(e.replace(Go,function(c,u){var d=Xn(c);switch(ld(d[0])){case"<?xml":break;case"<workbook":c.match(Kfe)&&(i="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[i];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":lC.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=pa(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=Ji(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Ai(Ji(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Ji(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),pa(d.hidden||"0")&&(s.Hidden=!0),o=u+c.length;break;case"</definedName>":s.Ref=Ai(Ji(e.slice(o,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),Q0.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return MU(r),r}function RU(e){var t=[ls];t[t.length]=ln("workbook",null,{xmlns:Q0[0],"xmlns:r":Os.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(lC.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=ln("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var o={name:Vi(e.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=ln("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=ln("definedName",Vi(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Xfe(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=$4(e),r.name=zo(e),r}function Qfe(e,t){return t||(t=kr(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),G3(e.strRelID,t),Xs(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Jfe(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?zo(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Zfe(e,t){t||(t=kr(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),A$(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function ehe(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function the(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=Pie(e),o=Iue(e,0,r),l=V3(e);e.l=n;var c={Name:s,Ptg:o};return i<268435455&&(c.Sheet=i),l&&(c.Comment=l),c}function rhe(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],v1[16]={n:"BrtFRTArchID$",f:ehe},df(e,function(c,u,d){switch(d){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Ro(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,c]):o[0]=[d,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(d),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!u.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),MU(r),r.Names=s,r.supbooks=o,r}function nhe(e,t){$r(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};$r(e,156,Qfe(i))}$r(e,144)}function ihe(e,t){t||(t=kr(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Xs("SheetJS",t),Xs(R2.version,t),Xs(R2.version,t),Xs("7262",t),t.length>t.l?t.slice(0,t.l):t}function ahe(e,t){t||(t=kr(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function she(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||($r(e,135),$r(e,158,ahe(i)),$r(e,136))}}function ohe(e,t){var r=Pl();return $r(r,131),$r(r,128,ihe()),$r(r,153,Zfe(e.Workbook&&e.Workbook.WBProps||null)),she(r,e),nhe(r,e),$r(r,132),r.end()}function lhe(e,t,r){return t.slice(-4)===".bin"?rhe(e,r):Yfe(e,r)}function che(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?jfe(e,n,r,i,s,o,l):tde(e,n,r,i,s,o,l)}function uhe(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?$fe(e,n,r,i,s):Ife(e,n,r,i,s)}function dhe(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?hce():pce()}function fhe(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?dce():fce()}function hhe(e,t,r,n){return t.slice(-4)===".bin"?lle(e,r,n):Xoe(e,r,n)}function phe(e,t,r){return mU(e,r)}function mhe(e,t,r){return t.slice(-4)===".bin"?moe(e,r):foe(e,r)}function ghe(e,t,r){return t.slice(-4)===".bin"?sce(e,r):Qle(e,r)}function xhe(e,t,r){return t.slice(-4)===".bin"?Kle(e):Vle(e)}function yhe(e,t,r,n){return r.slice(-4)===".bin"?Yle(e,t,r,n):void 0}function bhe(e,t,r){return t.slice(-4)===".bin"?Wle(e,t,r):Hle(e,t,r)}function vhe(e,t,r){return(t.slice(-4)===".bin"?ohe:RU)(e)}function whe(e,t,r,n,i){return(t.slice(-4)===".bin"?Rfe:TU)(e,r,n,i)}function She(e,t,r){return(t.slice(-4)===".bin"?yle:hU)(e,r)}function _he(e,t,r){return(t.slice(-4)===".bin"?yoe:aU)(e,r)}function jhe(e,t,r){return(t.slice(-4)===".bin"?oce:yU)(e)}function khe(e){return(e.slice(-4)===".bin"?qle:gU)()}var FU=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,BU=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function tu(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=e.match(FU),s,o,l,c;if(i)for(c=0;c!=i.length;++c)s=i[c].match(BU),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(o+1),n[l]=s[2].slice(1,s[2].length-1));return n}function Ahe(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(FU),i,s,o,l;if(n)for(l=0;l!=n.length;++l)i=n[l].match(BU),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),r[o]=i[2].slice(1,i[2].length-1));return r}var Rx;function Nhe(e,t){var r=Rx[e]||Ai(e);return r==="General"?S0(t):Wc(r,t)}function Che(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=pa(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=xa(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ai(t)]=i}function Ehe(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ff[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=d1(e.v):e.w=S0(e.v):e.w=Nhe(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=Rx[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&lg(n)){var i=Xh(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function The(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=zoe[n.Pattern]||n.Pattern)}e[t.ID]=t}function Phe(e,t,r,n,i,s,o,l,c,u){var d="General",f=n.StyleID,h={};u=u||{};var p=[],m=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&o&&(f=o.StyleID);s[f]!==void 0&&(s[f].nf&&(d=s[f].nf),s[f].Interior&&p.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=pa(e);break;case"String":n.t="s",n.r=yP(Ai(e)),n.v=e.indexOf("<")>-1?Ai(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(xa(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ai(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=P$[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=yP(t||e));break}if(Ehe(n,d,u),u.cellFormula!==!1)if(n.Formula){var g=Ai(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=xm(g,i),delete n.Formula,n.ArrayRange=="RC"?n.F=xm("RC:RC",i):n.ArrayRange&&(n.F=xm(n.ArrayRange,i),c.push([Ni(n.F),n.F]))}else for(m=0;m<c.length;++m)i.r>=c[m][0].s.r&&i.r<=c[m][0].e.r&&i.c>=c[m][0].s.c&&i.c<=c[m][0].e.c&&(n.F=c[m][1]);u.cellStyles&&(p.forEach(function(y){!h.patternType&&y.patternType&&(h.patternType=y.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Ohe(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function sj(e,t){var r=t||{};cg();var n=hx($3(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Ji(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=ya(r);return o.type="string",Um.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Te){i.indexOf("<"+Te)>=0&&(s=!0)}),s)return x0e(n,r);Rx={"General Number":"General","General Date":Gn[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Gn[15],"Short Date":Gn[14],"Long Time":Gn[19],"Medium Time":Gn[18],"Short Time":Gn[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Gn[2],Standard:Gn[4],Percent:Gn[10],Scientific:Gn[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],u,d={},f=[],h=r.dense?[]:{},p="",m={},g={},y=tu('<Data ss:Type="String">'),b=0,v=0,w=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},j={},k={},A="",R=0,M=[],B={},E={},P=0,U=[],G=[],H={},oe=[],de,W=!1,V=[],ae=[],ee={},C=0,Y=0,q={Sheets:[],WBProps:{date1904:!1}},O={};p1.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var X="";l=p1.exec(n);)switch(l[3]=(X=l[3]).toLowerCase()){case"data":if(X=="data"){if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?Phe(n.slice(b,l.index),A,y,c[c.length-1][0]=="comment"?H:m,{c:v,r:w},j,oe[v],g,V,r):(A="",y=tu(l[0]),b=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(G.length>0&&(m.c=G),(!r.sheetRows||r.sheetRows>w)&&m.v!==void 0&&(r.dense?(h[w]||(h[w]=[]),h[w][v]=m):h[Ta(v)+os(w)]=m),m.HRef&&(m.l={Target:Ai(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(C=v+(parseInt(m.MergeAcross,10)|0),Y=w+(parseInt(m.MergeDown,10)|0),M.push({s:{c:v,r:w},e:{c:C,r:Y}})),!r.sheetStubs)m.MergeAcross?v=C+1:++v;else if(m.MergeAcross||m.MergeDown){for(var F=v;F<=C;++F)for(var Q=w;Q<=Y;++Q)(F>v||Q>w)&&(r.dense?(h[Q]||(h[Q]=[]),h[Q][F]={t:"z"}):h[Ta(F)+os(Q)]={t:"z"});v=C+1}else++v;else m=Ahe(l[0]),m.Index&&(v=+m.Index-1),v<S.s.c&&(S.s.c=v),v>S.e.c&&(S.e.c=v),l[0].slice(-2)==="/>"&&++v,G=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(w<S.s.r&&(S.s.r=w),w>S.e.r&&(S.e.r=w),l[0].slice(-2)==="/>"&&(g=tu(l[0]),g.Index&&(w=+g.Index-1)),v=0,++w):(g=tu(l[0]),g.Index&&(w=+g.Index-1),ee={},(g.AutoFitHeight=="0"||g.Height)&&(ee.hpx=parseInt(g.Height,10),ee.hpt=b1(ee.hpx),ae[w]=ee),g.Hidden=="1"&&(ee.hidden=!0,ae[w]=ee));break;case"worksheet":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));f.push(p),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(h["!ref"]=li(S),r.sheetRows&&r.sheetRows<=S.e.r&&(h["!fullref"]=h["!ref"],S.e.r=r.sheetRows-1,h["!ref"]=li(S))),M.length&&(h["!merges"]=M),oe.length>0&&(h["!cols"]=oe),ae.length>0&&(h["!rows"]=ae),d[p]=h}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=v=0,c.push([l[3],!1]),u=tu(l[0]),p=Ai(u.Name),h=r.dense?[]:{},M=[],V=[],ae=[],O={name:p,Hidden:0},q.Sheets.push(O);break;case"table":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),oe=[],W=!1}break;case"style":l[1]==="/"?The(j,k,r):k=tu(l[0]);break;case"numberformat":k.nf=Ai(tu(l[0]).Format||"General"),Rx[k.nf]&&(k.nf=Rx[k.nf]);for(var K=0;K!=392&&Gn[K]!=k.nf;++K);if(K==392){for(K=57;K!=392;++K)if(Gn[K]==null){Ud(k.nf,K);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(de=tu(l[0]),de.Hidden&&(de.hidden=!0,delete de.Hidden),de.Width&&(de.wpx=parseInt(de.Width,10)),!W&&de.wpx>10){W=!0,Bo=dU;for(var ne=0;ne<oe.length;++ne)oe[ne]&&ph(oe[ne])}W&&ph(de),oe[de.Index-1||oe.length]=de;for(var re=0;re<+de.Span;++re)oe[oe.length]=ya(de);break;case"namedrange":if(l[1]==="/")break;q.Names||(q.Names=[]);var T=Xn(l[0]),I={Name:T.Name,Ref:xm(T.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(I.Sheet=q.Sheets.length-1),q.Names.push(I);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?A+=n.slice(R,l.index):R=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;k.Interior=tu(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?rae(B,X,n.slice(P,l.index)):P=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));Ohe(H),G.push(H)}else c.push([l[3],!1]),u=tu(l[0]),H={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var ie=tu(l[0]);h["!autofilter"]={ref:xm(ie.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return sO(n,r);var D=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:D=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:D=!1}break;case"excelworkbook":switch(l[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:D=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:D=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(P,l.index)){case"SheetHidden":O.Hidden=1;break;case"SheetVeryHidden":O.Hidden=2;break}else P=l.index+l[0].length;break;case"header":h["!margins"]||c0(h["!margins"]={},"xlml"),isNaN(+Xn(l[0]).Margin)||(h["!margins"].header=+Xn(l[0]).Margin);break;case"footer":h["!margins"]||c0(h["!margins"]={},"xlml"),isNaN(+Xn(l[0]).Margin)||(h["!margins"].footer=+Xn(l[0]).Margin);break;case"pagemargins":var Z=Xn(l[0]);h["!margins"]||c0(h["!margins"]={},"xlml"),isNaN(+Z.Top)||(h["!margins"].top=+Z.Top),isNaN(+Z.Left)||(h["!margins"].left=+Z.Left),isNaN(+Z.Right)||(h["!margins"].right=+Z.Right),isNaN(+Z.Bottom)||(h["!margins"].bottom=+Z.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:D=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:D=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:D=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:D=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:D=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:D=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:D=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:D=!1}break;case"smarttags":break;default:D=!1;break}if(D||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?Che(E,X,U,n.slice(P,l.index)):(U=l,P=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var me={};return!r.bookSheets&&!r.bookProps&&(me.Sheets=d),me.SheetNames=f,me.Workbook=q,me.SSF=ya(Gn),me.Props=B,me.Custprops=E,me}function G4(e,t){switch(uC(t=t||{}),t.type||"base64"){case"base64":return sj(cc(e),t);case"binary":case"buffer":case"file":return sj(e,t);case"array":return sj(kh(e),t)}}function Mhe(e,t){var r=[];return e.Props&&r.push(nae(e.Props,t)),e.Custprops&&r.push(iae(e.Props,e.Custprops)),r.join("")}function Lhe(){return""}function Rhe(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var s=[];s.push(ln("NumberFormat",null,{"ss:Format":Vi(Gn[n.numFmtId])}));var o={"ss:ID":"s"+(21+i)};r.push(ln("Style",s.join(""),o))}),ln("Styles",r.join(""))}function IU(e){return ln("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+iC(e.Ref,{r:0,c:0})})}function Fhe(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(IU(i)))}return ln("Names",r.join(""))}function Bhe(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],o=0;o<i.length;++o){var l=i[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||s.push(IU(l)))}return s.join("")}function Ihe(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(ln("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(ln("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(ln("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(ln("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(xo("ProtectContents","True")),e["!protect"].objects&&i.push(xo("ProtectObjects","True")),e["!protect"].scenarios&&i.push(xo("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(xo("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(xo("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":ln("WorksheetOptions",i.join(""),{xmlns:Yl.x})}function Dhe(e){return e.map(function(t){var r=sie(t.t||""),n=ln("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ln("Comment",n,{"ss:Author":t.a})}).join("")}function $he(e,t,r,n,i,s,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Vi(iC(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=Pa(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Vi(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Vi(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=o.c||u[d].s.r!=o.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=ff[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Gn[14]);break;case"s":f="String",h=aie(e.v||"");break}var p=Nh(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+p),l["ss:Index"]=o.c+1;var m=e.v!=null?h:"",g=e.t=="z"?"":'<Data ss:Type="'+f+'">'+m+"</Data>";return(e.c||[]).length>0&&(g+=Dhe(e.c)),ln("Cell",g,l)}function Uhe(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=zm(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function zhe(e,t,r,n){if(!e["!ref"])return"";var i=Ni(e["!ref"]),s=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(y,b){ph(y);var v=!!y.width,w=LS(b,y),S={"ss:Index":b+1};v&&(S["ss:Width"]=x1(w.width)),y.hidden&&(S["ss:Hidden"]="1"),l.push(ln("Column",null,S))});for(var c=Array.isArray(e),u=i.s.r;u<=i.e.r;++u){for(var d=[Uhe(u,(e["!rows"]||[])[u])],f=i.s.c;f<=i.e.c;++f){var h=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>f)&&!(s[o].s.r>u)&&!(s[o].e.c<f)&&!(s[o].e.r<u)){(s[o].s.c!=f||s[o].s.r!=u)&&(h=!0);break}if(!h){var p={r:u,c:f},m=Yn(p),g=c?(e[u]||[])[f]:e[m];d.push($he(g,m,e,t,r,n,p))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function Whe(e,t,r){var n=[],i=r.SheetNames[e],s=r.Sheets[i],o=s?Bhe(s,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=s?zhe(s,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(Ihe(s,t,e,r)),n.join("")}function qhe(e,t){t||(t={}),e.SSF||(e.SSF=ya(Gn)),e.SSF&&(cg(),NS(e.SSF),t.revssf=ES(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Nh(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Mhe(e,t)),r.push(Lhe()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(ln("Worksheet",Whe(n,t,e),{"ss:Name":Vi(e.SheetNames[n])}));return r[2]=Rhe(e,t),r[3]=Fhe(e),ls+ln("Workbook",r.join(""),{xmlns:Yl.ss,"xmlns:o":Yl.o,"xmlns:x":Yl.x,"xmlns:ss":Yl.ss,"xmlns:dt":Yl.dt,"xmlns:html":Yl.html})}function Hhe(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Fie(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=Bie(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Vhe=[60,1084,2066,2165,2175];function Ghe(e,t,r,n,i){var s=n,o=[],l=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(l)}o.push(l),r.l+=s;for(var c=Rd(r,r.l),u=K4[c],d=0;u!=null&&Vhe.indexOf(c)>-1;)s=Rd(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),l=r.slice(d,r.l+4+s),o.push(l),r.l+=4+s,u=K4[c=Rd(r,r.l)];var f=Ks(o);go(f,0);var h=0;f.lens=[];for(var p=0;p<o.length;++p)f.lens.push(h),h+=o[p].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,i)}function Ou(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Gn[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ff[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=d1(e.v):e.w=S0(e.v):e.w=Wc(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&lg(Gn[n]||String(n))){var i=Xh(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Tb(e,t,r){return{v:e,ixfe:t,t:r}}function Khe(e,t){var r={opts:{}},n={},i=t.dense?[]:{},s={},o={},l=null,c=[],u="",d={},f,h="",p,m,g,y,b={},v=[],w,S,j=[],k=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},R={},M=function(ce){return ce<8?s0[ce]:ce<64&&k[ce-8]||s0[ce]},B=function(ce,we,ht){var nt=we.XF.data;if(!(!nt||!nt.patternType||!ht||!ht.cellStyles)){we.s={},we.s.patternType=nt.patternType;var Ie;(Ie=g1(M(nt.icvFore)))&&(we.s.fgColor={rgb:Ie}),(Ie=g1(M(nt.icvBack)))&&(we.s.bgColor={rgb:Ie})}},E=function(ce,we,ht){if(!(ee>1)&&!(ht.sheetRows&&ce.r>=ht.sheetRows)){if(ht.cellStyles&&we.XF&&we.XF.data&&B(ce,we,ht),delete we.ixfe,delete we.XF,f=ce,h=Yn(ce),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),ce.r<o.s.r&&(o.s.r=ce.r),ce.c<o.s.c&&(o.s.c=ce.c),ce.r+1>o.e.r&&(o.e.r=ce.r+1),ce.c+1>o.e.c&&(o.e.c=ce.c+1),ht.cellFormula&&we.f){for(var nt=0;nt<v.length;++nt)if(!(v[nt][0].s.c>ce.c||v[nt][0].s.r>ce.r)&&!(v[nt][0].e.c<ce.c||v[nt][0].e.r<ce.r)){we.F=li(v[nt][0]),(v[nt][0].s.c!=ce.c||v[nt][0].s.r!=ce.r)&&delete we.f,we.f&&(we.f=""+Ro(v[nt][1],o,ce,V,P));break}}ht.dense?(i[ce.r]||(i[ce.r]=[]),i[ce.r][ce.c]=we):i[h]=we}},P={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:v,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(P.password=t.password);var U,G=[],H=[],oe=[],de=[],W=!1,V=[];V.SheetNames=P.snames,V.sharedf=P.sharedf,V.arrayf=P.arrayf,V.names=[],V.XTI=[];var ae=0,ee=0,C=0,Y=[],q=[],O;P.codepage=1200,du(1200);for(var X=!1;e.l<e.length-1;){var F=e.l,Q=e.read_shift(2);if(Q===0&&ae===10)break;var K=e.l===e.length?0:e.read_shift(2),ne=K4[Q];if(ne&&ne.f){if(t.bookSheets&&ae===133&&Q!==133)break;if(ae=Q,ne.r===2||ne.r==12){var re=e.read_shift(2);if(K-=2,!P.enc&&re!==Q&&((re&255)<<8|re>>8)!==Q)throw new Error("rt mismatch: "+re+"!="+Q);ne.r==12&&(e.l+=10,K-=10)}var T={};if(Q===10?T=ne.f(e,K,P):T=Ghe(Q,ne,e,K,P),ee==0&&[9,521,1033,2057].indexOf(ae)===-1)continue;switch(Q){case 34:r.opts.Date1904=A.WBProps.date1904=T;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(e.l=0),P.enc=T,!t.password)throw new Error("File is password-protected");if(T.valid==null)throw new Error("Encryption scheme unsupported");if(!T.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=T;break;case 66:var I=Number(T);switch(I){case 21010:I=1200;break;case 32768:I=1e4;break;case 32769:I=1252;break}du(P.codepage=I),X=!0;break;case 317:P.rrtabid=T;break;case 25:P.winlocked=T;break;case 439:r.opts.RefreshAll=T;break;case 12:r.opts.CalcCount=T;break;case 16:r.opts.CalcDelta=T;break;case 17:r.opts.CalcIter=T;break;case 13:r.opts.CalcMode=T;break;case 14:r.opts.CalcPrecision=T;break;case 95:r.opts.CalcSaveRecalc=T;break;case 15:P.CalcRefMode=T;break;case 2211:r.opts.FullCalc=T;break;case 129:T.fDialog&&(i["!type"]="dialog"),T.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),T.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:j.push(T);break;case 430:V.push([T]),V[V.length-1].XTI=[];break;case 35:case 547:V[V.length-1].push(T);break;case 24:case 536:O={Name:T.Name,Ref:Ro(T.rgce,o,null,V,P)},T.itab>0&&(O.Sheet=T.itab-1),V.names.push(O),V[0]||(V[0]=[],V[0].XTI=[]),V[V.length-1].push(T),T.Name=="_xlnm._FilterDatabase"&&T.itab>0&&T.rgce&&T.rgce[0]&&T.rgce[0][0]&&T.rgce[0][0][0]=="PtgArea3d"&&(q[T.itab-1]={ref:li(T.rgce[0][0][1][2])});break;case 22:P.ExternCount=T;break;case 23:V.length==0&&(V[0]=[],V[0].XTI=[]),V[V.length-1].XTI=V[V.length-1].XTI.concat(T),V.XTI=V.XTI.concat(T);break;case 2196:if(P.biff<8)break;O!=null&&(O.Comment=T[1]);break;case 18:i["!protect"]=T;break;case 19:T!==0&&P.WTF&&console.error("Password verifier: "+T);break;case 133:s[T.pos]=T,P.snames.push(T.name);break;case 10:{if(--ee)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=li(o),t.sheetRows&&t.sheetRows<=o.e.r){var ie=o.e.r;o.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=li(o),o.e.r=ie}o.e.r++,o.e.c++}G.length>0&&(i["!merges"]=G),H.length>0&&(i["!objects"]=H),oe.length>0&&(i["!cols"]=oe),de.length>0&&(i["!rows"]=de),A.Sheets.push(R)}u===""?d=i:n[u]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[Q]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[T.BIFFVer]||8),P.biffguess=T.BIFFVer==0,T.BIFFVer==0&&T.dt==4096&&(P.biff=5,X=!0,du(P.codepage=28591)),P.biff==8&&T.BIFFVer==0&&T.dt==16&&(P.biff=2),ee++)break;if(i=t.dense?[]:{},P.biff<8&&!X&&(X=!0,du(P.codepage=t.codepage||1252)),P.biff<5||T.BIFFVer==0&&T.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var D={pos:e.l-K,name:u};s[D.pos]=D,P.snames.push(u)}else u=(s[F]||{name:""}).name;T.dt==32&&(i["!type"]="chart"),T.dt==64&&(i["!type"]="macro"),G=[],H=[],P.arrayf=v=[],oe=[],de=[],W=!1,R={Hidden:(s[F]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[T.r]||[])[T.c]:i[Yn({c:T.c,r:T.r})])&&++T.c,w={ixfe:T.ixfe,XF:j[T.ixfe]||{},v:T.val,t:"n"},C>0&&(w.z=Y[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E({c:T.c,r:T.r},w,t);break;case 5:case 517:w={ixfe:T.ixfe,XF:j[T.ixfe],v:T.val,t:T.t},C>0&&(w.z=Y[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E({c:T.c,r:T.r},w,t);break;case 638:w={ixfe:T.ixfe,XF:j[T.ixfe],v:T.rknum,t:"n"},C>0&&(w.z=Y[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E({c:T.c,r:T.r},w,t);break;case 189:for(var Z=T.c;Z<=T.C;++Z){var me=T.rkrec[Z-T.c][0];w={ixfe:me,XF:j[me],v:T.rkrec[Z-T.c][1],t:"n"},C>0&&(w.z=Y[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E({c:Z,r:T.r},w,t)}break;case 6:case 518:case 1030:{if(T.val=="String"){l=T;break}if(w=Tb(T.val,T.cell.ixfe,T.tt),w.XF=j[w.ixfe],t.cellFormula){var Te=T.formula;if(Te&&Te[0]&&Te[0][0]&&Te[0][0][0]=="PtgExp"){var je=Te[0][0][1][0],Le=Te[0][0][1][1],_e=Yn({r:je,c:Le});b[_e]?w.f=""+Ro(T.formula,o,T.cell,V,P):w.F=((t.dense?(i[je]||[])[Le]:i[_e])||{}).F}else w.f=""+Ro(T.formula,o,T.cell,V,P)}C>0&&(w.z=Y[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E(T.cell,w,t),l=T}break;case 7:case 519:if(l)l.val=T,w=Tb(T,l.cell.ixfe,"s"),w.XF=j[w.ixfe],t.cellFormula&&(w.f=""+Ro(l.formula,o,l.cell,V,P)),C>0&&(w.z=Y[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E(l.cell,w,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{v.push(T);var He=Yn(T[0].s);if(p=t.dense?(i[T[0].s.r]||[])[T[0].s.c]:i[He],t.cellFormula&&p){if(!l||!He||!p)break;p.f=""+Ro(T[1],o,T[0],V,P),p.F=li(T[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!l)break;b[Yn(l.cell)]=T[0],p=t.dense?(i[l.cell.r]||[])[l.cell.c]:i[Yn(l.cell)],(p||{}).f=""+Ro(T[0],o,f,V,P)}}break;case 253:w=Tb(c[T.isst].t,T.ixfe,"s"),c[T.isst].h&&(w.h=c[T.isst].h),w.XF=j[w.ixfe],C>0&&(w.z=Y[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E({c:T.c,r:T.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:T.ixfe,XF:j[T.ixfe],t:"z"},C>0&&(w.z=Y[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E({c:T.c,r:T.r},w,t));break;case 190:if(t.sheetStubs)for(var We=T.c;We<=T.C;++We){var Pt=T.ixfe[We-T.c];w={ixfe:Pt,XF:j[Pt],t:"z"},C>0&&(w.z=Y[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E({c:We,r:T.r},w,t)}break;case 214:case 516:case 4:w=Tb(T.val,T.ixfe,"s"),w.XF=j[w.ixfe],C>0&&(w.z=Y[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E({c:T.c,r:T.r},w,t);break;case 0:case 512:ee===1&&(o=T);break;case 252:c=T;break;case 1054:if(P.biff==4){Y[C++]=T[1];for(var dt=0;dt<C+163&&Gn[dt]!=T[1];++dt);dt>=163&&Ud(T[1],C+163)}else Ud(T[1],T[0]);break;case 30:{Y[C++]=T;for(var Ye=0;Ye<C+163&&Gn[Ye]!=T;++Ye);Ye>=163&&Ud(T,C+163)}break;case 229:G=G.concat(T);break;case 93:H[T.cmo[0]]=P.lastobj=T;break;case 438:P.lastobj.TxO=T;break;case 127:P.lastobj.ImData=T;break;case 440:for(y=T[0].s.r;y<=T[0].e.r;++y)for(g=T[0].s.c;g<=T[0].e.c;++g)p=t.dense?(i[y]||[])[g]:i[Yn({c:g,r:y})],p&&(p.l=T[1]);break;case 2048:for(y=T[0].s.r;y<=T[0].e.r;++y)for(g=T[0].s.c;g<=T[0].e.c;++g)p=t.dense?(i[y]||[])[g]:i[Yn({c:g,r:y})],p&&p.l&&(p.l.Tooltip=T[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;p=t.dense?(i[T[0].r]||[])[T[0].c]:i[Yn(T[0])];var lt=H[T[2]];p||(t.dense?(i[T[0].r]||(i[T[0].r]=[]),p=i[T[0].r][T[0].c]={t:"z"}):p=i[Yn(T[0])]={t:"z"},o.e.r=Math.max(o.e.r,T[0].r),o.s.r=Math.min(o.s.r,T[0].r),o.e.c=Math.max(o.e.c,T[0].c),o.s.c=Math.min(o.s.c,T[0].c)),p.c||(p.c=[]),m={a:T[1],t:lt.TxO.t},p.c.push(m)}break;case 2173:Rle(j[T.ixfe],T.ext);break;case 125:{if(!P.cellStyles)break;for(;T.e>=T.s;)oe[T.e--]={width:T.w/256,level:T.level||0,hidden:!!(T.flags&1)},W||(W=!0,tC(T.w/256)),ph(oe[T.e+1])}break;case 520:{var be={};T.level!=null&&(de[T.r]=be,be.level=T.level),T.hidden&&(de[T.r]=be,be.hidden=!0),T.hpt&&(de[T.r]=be,be.hpt=T.hpt,be.hpx=zm(T.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||c0(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Q]]=T;break;case 161:i["!margins"]||c0(i["!margins"]={}),i["!margins"].header=T.header,i["!margins"].footer=T.footer;break;case 574:T.RTL&&(A.Views[0].RTL=!0);break;case 146:k=T;break;case 2198:U=T;break;case 140:S=T;break;case 442:u?R.CodeName=T||R.name:A.WBProps.CodeName=T||"ThisWorkbook";break}}else ne||console.error("Missing Info for XLS Record 0x"+Q.toString(16)),e.l+=K}return r.SheetNames=Ka(s).sort(function(ke,ce){return Number(ke)-Number(ce)}).map(function(ke){return s[ke].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&q.forEach(function(ke,ce){r.Sheets[r.SheetNames[ce]]["!autofilter"]=ke}),r.Strings=c,r.SSF=ya(Gn),P.enc&&(r.Encryption=P.enc),U&&(r.Themes=U),r.Metadata={},S!==void 0&&(r.Metadata.Country=S),V.names.length>0&&(A.Names=V.names),r.Workbook=A,r}var Fx={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Yhe(e,t,r){var n=qn.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=FP(n,U4,Fx.DSI);for(var s in i)t[s]=i[s]}catch(u){if(r.WTF)throw u}var o=qn.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=FP(o,z4,Fx.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(B$(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Xhe(e,t){var r=[],n=[],i=[],s=0,o,l=fP(U4,"n"),c=fP(z4,"n");if(e.Props)for(o=Ka(e.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:i).push([o[s],e.Props[o[s]]]);if(e.Custprops)for(o=Ka(e.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:i).push([o[s],e.Custprops[o[s]]]);var u=[];for(s=0;s<i.length;++s)q$.indexOf(i[s][0])>-1||F$.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);n.length&&qn.utils.cfb_add(t,"/SummaryInformation",BP(n,Fx.SI,c,z4)),(r.length||u.length)&&qn.utils.cfb_add(t,"/DocumentSummaryInformation",BP(r,Fx.DSI,l,U4,u.length?u:null,Fx.UDI))}function DU(e,t){t||(t={}),uC(t),P3(),t.codepage&&T3(t.codepage);var r,n;if(e.FullPaths){if(qn.find(e,"/encryption"))throw new Error("File is password-protected");r=qn.find(e,"!CompObj"),n=qn.find(e,"/Workbook")||qn.find(e,"/Book")}else{switch(t.type){case"base64":e=Ql(cc(e));break;case"binary":e=Ql(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}go(e,0),n={content:e}}var i,s;if(r&&Hhe(r),t.bookProps&&!t.bookSheets)i={};else{var o=gi?"buffer":"array";if(n&&n.content)i=Khe(n.content,t);else if((s=qn.find(e,"PerfectOffice_MAIN"))&&s.content)i=l0.to_workbook(s.content,(t.type=o,t));else if((s=qn.find(e,"NativeContent_MAIN"))&&s.content)i=l0.to_workbook(s.content,(t.type=o,t));else throw(s=qn.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&qn.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=cce(e))}var l={};return e.FullPaths&&Yhe(e,l,t),i.Props=i.Custprops=l,t.bookFiles&&(i.cfb=e),i}function Qhe(e,t){var r=t||{},n=qn.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return qn.utils.cfb_add(n,i,$U(e,r)),r.biff==8&&(e.Props||e.Custprops)&&Xhe(e,n),r.biff==8&&e.vbaraw&&uce(n,qn.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var v1={0:{f:wde},1:{f:Ede},2:{f:Kde},3:{f:Bde},4:{f:Mde},5:{f:Hde},6:{f:Zde},7:{f:Ude},8:{f:sfe},9:{f:afe},10:{f:nfe},11:{f:ife},12:{f:Pde},13:{f:Xde},14:{f:Dde},15:{f:Rde},16:{f:PU},17:{f:tfe},18:{f:Wde},19:{f:H3},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:the},40:{},42:{},43:{f:Zoe},44:{f:Qoe},45:{f:rle},46:{f:ile},47:{f:nle},48:{},49:{f:jie},50:{},51:{f:Ile},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:tU},62:{f:Jde},63:{f:Gle},64:{f:Sfe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ho,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:yfe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Nde},148:{f:jde,p:16},151:{f:ffe},152:{},153:{f:Jfe},154:{},155:{},156:{f:Xfe},157:{},158:{},159:{T:1,f:poe},160:{T:-1},161:{T:1,f:tp},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:ofe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Fle},336:{T:-1},337:{f:Ule,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:$4},357:{},358:{},359:{},360:{T:1},361:{},362:{f:eU},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:hfe},427:{f:pfe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:gfe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Ade},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:ufe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:$4},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:ice},633:{T:1},634:{T:-1},635:{T:1,f:rce},636:{T:-1},637:{f:Cie},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Dfe},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:_fe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},K4={6:{f:ij},10:{f:Nf},12:{f:ps},13:{f:ps},14:{f:Za},15:{f:Za},16:{f:$o},17:{f:Za},18:{f:Za},19:{f:ps},20:{f:WP},21:{f:WP},23:{f:eU},24:{f:HP},25:{f:Za},26:{},27:{},28:{f:_se},29:{},34:{f:Za},35:{f:qP},38:{f:$o},39:{f:$o},40:{f:$o},41:{f:$o},42:{f:Za},43:{f:Za},47:{f:Roe},49:{f:Xae},51:{f:ps},60:{},61:{f:Hae},64:{f:Za},65:{f:Yae},66:{f:ps},77:{},80:{},81:{},82:{},85:{f:ps},89:{},90:{},91:{},92:{f:Lae},93:{f:Ase},94:{},95:{f:Za},96:{},97:{},99:{f:Za},125:{f:tU},128:{f:dse},129:{f:Fae},130:{f:ps},131:{f:Za},132:{f:Za},133:{f:Bae},134:{},140:{f:Lse},141:{f:ps},144:{},146:{f:Bse},151:{},152:{},153:{},154:{},155:{},156:{f:ps},157:{},158:{},160:{f:qse},161:{f:$se},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:ose},190:{f:lse},193:{f:Nf},197:{},198:{},199:{},200:{},201:{},202:{f:Za},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ps},220:{},221:{f:Za},222:{},224:{f:use},225:{f:Mae},226:{f:Nf},227:{},229:{f:jse},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Dae},253:{f:Jae},255:{f:Uae},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:H$},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Za},353:{f:Nf},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:gse},431:{f:Za},432:{},433:{},434:{},437:{},438:{f:Ese},439:{f:Za},440:{f:Tse},441:{},442:{f:ay},443:{},444:{f:ps},445:{},446:{},448:{f:Nf},449:{f:qae,r:2},450:{f:Nf},512:{f:$P},513:{f:Wse},515:{f:pse},516:{f:ese},517:{f:zP},519:{f:Hse},520:{f:zae},523:{},545:{f:VP},549:{f:DP},566:{},574:{f:Gae},638:{f:sse},659:{},1048:{},1054:{f:rse},1084:{},1212:{f:vse},2048:{f:Ose},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Nb},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Nf},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Ise,r:12},2173:{f:Lle,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Za,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:bse,r:12},2197:{},2198:{f:Cle,r:12},2199:{},2200:{},2201:{},2202:{f:wse,r:12},2203:{f:Nf},2204:{},2205:{},2206:{},2207:{},2211:{f:Wae},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ps},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Use},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Fse},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:$P},1:{},2:{f:Xse},3:{f:Kse},4:{f:Gse},5:{f:zP},7:{f:Jse},8:{},9:{f:Nb},11:{},22:{f:ps},30:{f:ise},31:{},32:{},33:{f:VP},36:{},37:{f:DP},50:{f:Zse},62:{},52:{},67:{},68:{f:ps},69:{},86:{},126:{},127:{f:Vse},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:eoe},223:{},234:{},354:{},421:{},518:{f:ij},521:{f:Nb},536:{f:HP},547:{f:qP},561:{},579:{},1030:{f:ij},1033:{f:Nb},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function un(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&z3(r)&&e.push(r)}}function Jhe(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return un(e,t,r,i);var s=t;if(!isNaN(s)){for(var o=r.parts||[],l=0,c=0,u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;var d=e.next(4);for(d.write_shift(2,s),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<i;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function cy(e,t,r){return e||(e=kr(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Zhe(e,t,r,n){var i=kr(9);return cy(i,e,t),V$(r,n||"b",i),i}function e0e(e,t,r){var n=kr(8+2*r.length);return cy(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function t0e(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?Ls(xa(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?un(e,2,Qse(r,n,i)):un(e,3,Yse(r,n,i));return;case"b":case"e":un(e,5,Zhe(r,n,t.v,t.t));return;case"s":case"str":un(e,4,e0e(r,n,(t.v||"").slice(0,255)));return}un(e,1,cy(null,r,n))}function r0e(e,t,r,n){var i=Array.isArray(t),s=Ni(t["!ref"]||"A1"),o,l="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=li(s)}for(var u=s.s.r;u<=s.e.r;++u){l=os(u);for(var d=s.s.c;d<=s.e.c;++d){u===s.s.r&&(c[d]=Ta(d)),o=c[d]+l;var f=i?(t[u]||[])[d]:t[o];f&&t0e(e,f,u,d)}}}function n0e(e,t){for(var r=t||{},n=Pl(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return un(n,r.biff==4?1033:r.biff==3?521:9,J3(e,16,r)),r0e(n,e.Sheets[e.SheetNames[i]],i,r),un(n,10),n.end()}function i0e(e,t,r){un(e,49,Qae({sz:12,name:"Arial"},r))}function a0e(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&un(e,1054,nse(i,t[i],r))})}function s0e(e,t){var r=kr(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),un(e,2151,r),r=kr(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Q$(Ni(t["!ref"]||"A1"),r),r.write_shift(4,4),un(e,2152,r)}function o0e(e,t){for(var r=0;r<16;++r)un(e,224,UP({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){un(e,224,UP(n,0,t))})}function l0e(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];un(e,440,Pse(n)),n[1].Tooltip&&un(e,2048,Mse(n))}delete t["!links"]}function c0e(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&un(e,125,Dse(LS(i,n),i))})}}function u0e(e,t,r,n,i){var s=16+Nh(i.cellXfs,t,i);if(t.v==null&&!t.bf){un(e,513,A0(r,n,s));return}if(t.bf)un(e,6,Fue(t,r,n,i,s));else switch(t.t){case"d":case"n":var o=t.t=="d"?Ls(xa(t.v)):t.v;un(e,515,mse(r,n,o,s));break;case"b":case"e":un(e,517,hse(r,n,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var l=sC(i.Strings,t.v,i.revStrings);un(e,253,Zae(r,n,l,s))}else un(e,516,tse(r,n,(t.v||"").slice(0,255),s,i));break;default:un(e,513,A0(r,n,s))}}function d0e(e,t,r){var n=Pl(),i=r.SheetNames[e],s=r.Sheets[i]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(s),u=t.biff==8,d,f="",h=[],p=Ni(s["!ref"]||"A1"),m=u?65536:16384;if(p.e.c>255||p.e.r>=m){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,m-1)}un(n,2057,J3(r,16,t)),un(n,13,Mc(1)),un(n,12,Mc(100)),un(n,15,tl(!0)),un(n,17,tl(!1)),un(n,16,j0(.001)),un(n,95,tl(!0)),un(n,42,tl(!1)),un(n,43,tl(!1)),un(n,130,Mc(1)),un(n,128,fse()),un(n,131,tl(!1)),un(n,132,tl(!1)),u&&c0e(n,s["!cols"]),un(n,512,ase(p,t)),u&&(s["!links"]=[]);for(var g=p.s.r;g<=p.e.r;++g){f=os(g);for(var y=p.s.c;y<=p.e.c;++y){g===p.s.r&&(h[y]=Ta(y)),d=h[y]+f;var b=c?(s[g]||[])[y]:s[d];b&&(u0e(n,b,g,y,t),u&&b.l&&s["!links"].push([d,b.l]))}}var v=l.CodeName||l.name||i;return u&&un(n,574,Kae((o.Views||[])[0])),u&&(s["!merges"]||[]).length&&un(n,229,kse(s["!merges"])),u&&l0e(n,s),un(n,442,G$(v)),u&&s0e(n,s),un(n,10),n.end()}function f0e(e,t,r){var n=Pl(),i=(e||{}).Workbook||{},s=i.Sheets||[],o=i.WBProps||{},l=r.biff==8,c=r.biff==5;if(un(n,2057,J3(e,5,r)),r.bookType=="xla"&&un(n,135),un(n,225,l?Mc(1200):null),un(n,193,hae(2)),c&&un(n,191),c&&un(n,192),un(n,226),un(n,92,Rae("SheetJS",r)),un(n,66,Mc(l?1200:1252)),l&&un(n,353,Mc(0)),l&&un(n,448),un(n,317,zse(e.SheetNames.length)),l&&e.vbaraw&&un(n,211),l&&e.vbaraw){var u=o.CodeName||"ThisWorkbook";un(n,442,G$(u))}un(n,156,Mc(17)),un(n,25,tl(!1)),un(n,18,tl(!1)),un(n,19,Mc(0)),l&&un(n,431,tl(!1)),l&&un(n,444,Mc(0)),un(n,61,Vae()),un(n,64,tl(!1)),un(n,141,Mc(0)),un(n,34,tl(qfe(e)=="true")),un(n,14,tl(!0)),l&&un(n,439,tl(!1)),un(n,218,Mc(0)),i0e(n,e,r),a0e(n,e.SSF,r),o0e(n,r),l&&un(n,352,tl(!1));var d=n.end(),f=Pl();l&&un(f,140,Rse()),l&&r.Strings&&Jhe(f,252,$ae(r.Strings)),un(f,10);var h=f.end(),p=Pl(),m=0,g=0;for(g=0;g<e.SheetNames.length;++g)m+=(l?12:11)+(l?2:1)*e.SheetNames[g].length;var y=d.length+m+h.length;for(g=0;g<e.SheetNames.length;++g){var b=s[g]||{};un(p,133,Iae({pos:y,hs:b.Hidden||0,dt:0,name:e.SheetNames[g]},r)),y+=t[g].length}var v=p.end();if(m!=v.length)throw new Error("BS8 "+m+" != "+v.length);var w=[];return d.length&&w.push(d),v.length&&w.push(v),h.length&&w.push(h),Ks(w)}function h0e(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=ya(Gn)),e&&e.SSF&&(cg(),NS(e.SSF),r.revssf=ES(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,dC(r),r.cellXfs=[],Nh(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=d0e(i,r,e);return n.unshift(f0e(e,n,r)),Ks(n)}function $U(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Ol(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return h0e(e,t);case 4:case 3:case 2:return n0e(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function rO(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=i.index,l=s&&s.index||e.length,c=Qne(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(o=0;o<c.length;++o){var g=c[o].trim(),y=g.slice(0,3).toLowerCase();if(y=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(y!="<td"&&y!="<th")){var b=g.split(/<\/t[dh]>/i);for(l=0;l<b.length;++l){var v=b[l].trim();if(v.match(/<t[dh]/i)){for(var w=v,S=0;w.charAt(0)=="<"&&(S=w.indexOf(">"))>-1;)w=w.slice(S+1);for(var j=0;j<m.length;++j){var k=m[j];k.s.c==d&&k.s.r<u&&u<=k.e.r&&(d=k.e.c+1,j=-1)}var A=Xn(v.slice(0,v.indexOf(">")));h=A.colspan?+A.colspan:1,((f=+A.rowspan)>1||h>1)&&m.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+h-1}});var R=A.t||A["data-t"]||"";if(!w.length){d+=h;continue}if(w=u$(w),p.s.r>u&&(p.s.r=u),p.e.r<u&&(p.e.r=u),p.s.c>d&&(p.s.c=d),p.e.c<d&&(p.e.c=d),!w.length){d+=h;continue}var M={t:"s",v:w};r.raw||!w.trim().length||R=="s"||(w==="TRUE"?M={t:"b",v:!0}:w==="FALSE"?M={t:"b",v:!1}:isNaN(mu(w))?isNaN($m(w).getDate())||(M={t:"d",v:xa(w)},r.cellDates||(M={t:"n",v:Ls(M.v)}),M.z=r.dateNF||Gn[14]):M={t:"n",v:mu(w)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=M):n[Yn({r:u,c:d})]=M,d+=h}}}}return n["!ref"]=li(p),m.length&&(n["!merges"]=m),n}function p0e(e,t,r,n){for(var i=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>o)&&!(i[u].e.r<r||i[u].e.c<o)){if(i[u].s.r<r||i[u].s.c<o){l=-1;break}l=i[u].e.r-i[u].s.r+1,c=i[u].e.c-i[u].s.c+1;break}if(!(l<0)){var d=Yn({r,c:o}),f=n.dense?(e[r]||[])[o]:e[d],h=f&&f.v!=null&&(f.h||D3(f.w||(Xd(f),f.w)||""))||"",p={};l>1&&(p.rowspan=l),c>1&&(p.colspan=c),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(p["data-t"]=f&&f.t||"z",f.v!=null&&(p["data-v"]=f.v),f.z!=null&&(p["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),p.id=(n.id||"sjs")+"-"+d,s.push(ln("td",h,p))}}var m="<tr>";return m+s.join("")+"</tr>"}var m0e='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',g0e="</body></html>";function x0e(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ah(rO(r[0],t),t);var n=pC();return r.forEach(function(i,s){mC(n,rO(i,t),"Sheet"+(s+1))}),n}function y0e(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function UU(e,t){var r=t||{},n=r.header!=null?r.header:m0e,i=r.footer!=null?r.footer:g0e,s=[n],o=Ol(e["!ref"]);r.dense=Array.isArray(e),s.push(y0e(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)s.push(p0e(e,o,l,r));return s.push("</table>"+i),s.join("")}function zU(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?Pa(n.origin):n.origin;i=o.r,s=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var d=Ol(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),i==-1&&(u.e.r=i=d.e.r+1)}var f=[],h=0,p=e["!rows"]||(e["!rows"]=[]),m=0,g=0,y=0,b=0,v=0,w=0;for(e["!cols"]||(e["!cols"]=[]);m<l.length&&g<c;++m){var S=l[m];if(nO(S)){if(n.display)continue;p[g]={hidden:!0}}var j=S.children;for(y=b=0;y<j.length;++y){var k=j[y];if(!(n.display&&nO(k))){var A=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):u$(k.innerHTML),R=k.getAttribute("data-z")||k.getAttribute("z");for(h=0;h<f.length;++h){var M=f[h];M.s.c==b+s&&M.s.r<g+i&&g+i<=M.e.r&&(b=M.e.c+1-s,h=-1)}w=+k.getAttribute("colspan")||1,((v=+k.getAttribute("rowspan")||1)>1||w>1)&&f.push({s:{r:g+i,c:b+s},e:{r:g+i+(v||1)-1,c:b+s+(w||1)-1}});var B={t:"s",v:A},E=k.getAttribute("data-t")||k.getAttribute("t")||"";A!=null&&(A.length==0?B.t=E||"z":n.raw||A.trim().length==0||E=="s"||(A==="TRUE"?B={t:"b",v:!0}:A==="FALSE"?B={t:"b",v:!1}:isNaN(mu(A))?isNaN($m(A).getDate())||(B={t:"d",v:xa(A)},n.cellDates||(B={t:"n",v:Ls(B.v)}),B.z=n.dateNF||Gn[14]):B={t:"n",v:mu(A)})),B.z===void 0&&R!=null&&(B.z=R);var P="",U=k.getElementsByTagName("A");if(U&&U.length)for(var G=0;G<U.length&&!(U[G].hasAttribute("href")&&(P=U[G].getAttribute("href"),P.charAt(0)!="#"));++G);P&&P.charAt(0)!="#"&&(B.l={Target:P}),n.dense?(e[g+i]||(e[g+i]=[]),e[g+i][b+s]=B):e[Yn({c:b+s,r:g+i})]=B,u.e.c<b+s&&(u.e.c=b+s),b+=w}}++g}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,g-1+i),e["!ref"]=li(u),g>=c&&(e["!fullref"]=li((u.e.r=l.length-m+g-1+i,u))),e}function WU(e,t){var r=t||{},n=r.dense?[]:{};return zU(n,e,t)}function b0e(e,t){return Ah(WU(e,t),t)}function nO(e){var t="",r=v0e(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function v0e(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function w0e(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ai(t.replace(/<[^>]*>/g,""));return[r]}var iO={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function qU(e,t){var r=t||{},n=$3(e),i=[],s,o,l={name:""},c="",u=0,d,f,h={},p=[],m=r.dense?[]:{},g,y,b={value:""},v="",w=0,S=[],j=-1,k=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},R=0,M={},B=[],E={},P=0,U=0,G=[],H=1,oe=1,de=[],W={Names:[]},V={},ae=["",""],ee=[],C={},Y="",q=0,O=!1,X=!1,F=0;for(p1.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=p1.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?m["!ref"]=li(A):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(m["!fullref"]=m["!ref"],A.e.r=r.sheetRows-1,m["!ref"]=li(A)),B.length&&(m["!merges"]=B),G.length&&(m["!rows"]=G),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),p.push(d.name),h[d.name]=m,X=!1):g[0].charAt(g[0].length-2)!=="/"&&(d=Xn(g[0],!1),j=k=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,m=r.dense?[]:{},B=[],G=[],X=!0);break;case"table-row-group":g[1]==="/"?--R:++R;break;case"table-row":case"":if(g[1]==="/"){j+=H,H=1;break}if(f=Xn(g[0],!1),f.?j=f.-1:j==-1&&(j=0),H=+f["number-rows-repeated"]||1,H<10)for(F=0;F<H;++F)R>0&&(G[j+F]={level:R});k=-1;break;case"covered-table-cell":g[1]!=="/"&&++k,r.sheetStubs&&(r.dense?(m[j]||(m[j]=[]),m[j][k]={t:"z"}):m[Yn({r:j,c:k})]={t:"z"}),v="",S=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++k,b=Xn(g[0],!1),oe=parseInt(b["number-columns-repeated"]||"1",10),y={t:"z",v:null},b.formula&&r.cellFormula!=!1&&(y.f=ZP(Ai(b.formula))),(b.||b["value-type"])=="string"&&(y.t="s",y.v=Ai(b["string-value"]||""),r.dense?(m[j]||(m[j]=[]),m[j][k]=y):m[Yn({r:j,c:k})]=y),k+=oe-1;else if(g[1]!=="/"){++k,v="",w=0,S=[],oe=1;var Q=H?j+H-1:j;if(k>A.e.c&&(A.e.c=k),k<A.s.c&&(A.s.c=k),j<A.s.r&&(A.s.r=j),Q>A.e.r&&(A.e.r=Q),b=Xn(g[0],!1),ee=[],C={},y={t:b.||b["value-type"],v:null},r.cellFormula)if(b.formula&&(b.formula=Ai(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(P=parseInt(b["number-matrix-rows-spanned"],10)||0,U=parseInt(b["number-matrix-columns-spanned"],10)||0,E={s:{r:j,c:k},e:{r:j+P-1,c:k+U-1}},y.F=li(E),de.push([E,y.F])),b.formula)y.f=ZP(b.formula);else for(F=0;F<de.length;++F)j>=de[F][0].s.r&&j<=de[F][0].e.r&&k>=de[F][0].s.c&&k<=de[F][0].e.c&&(y.F=de[F][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(P=parseInt(b["number-rows-spanned"],10)||0,U=parseInt(b["number-columns-spanned"],10)||0,E={s:{r:j,c:k},e:{r:j+P-1,c:k+U-1}},B.push(E)),b["number-columns-repeated"]&&(oe=parseInt(b["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=pa(b["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(b.value);break;case"percentage":y.t="n",y.v=parseFloat(b.value);break;case"currency":y.t="n",y.v=parseFloat(b.value);break;case"date":y.t="d",y.v=xa(b["date-value"]),r.cellDates||(y.t="n",y.v=Ls(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=Kne(b["time-value"])/86400,r.cellDates&&(y.t="d",y.v=TS(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(b.);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",b["string-value"]!=null&&(v=Ai(b["string-value"]),S=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(O=!1,y.t==="s"&&(y.v=v||"",S.length&&(y.R=S),O=w==0),V.Target&&(y.l=V),ee.length>0&&(y.c=ee,ee=[]),v&&r.cellText!==!1&&(y.w=v),O&&(y.t="z",delete y.v),(!O||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=j))for(var K=0;K<H;++K){if(oe=parseInt(b["number-columns-repeated"]||"1",10),r.dense)for(m[j+K]||(m[j+K]=[]),m[j+K][k]=K==0?y:ya(y);--oe>0;)m[j+K][k+oe]=ya(y);else for(m[Yn({r:j+K,c:k})]=y;--oe>0;)m[Yn({r:j+K,c:k+oe})]=ya(y);A.e.c<=k&&(A.e.c=k)}oe=parseInt(b["number-columns-repeated"]||"1",10),k+=oe-1,oe=0,y={},v="",S=[]}V={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((s=i.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((s=i.pop())[0]!==g[3])throw"Bad state: "+s;C.t=v,S.length&&(C.R=S),C.a=Y,ee.push(C)}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);Y="",q=0,v="",w=0,S=[];break;case"creator":g[1]==="/"?Y=n.slice(q,g.index):q=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((s=i.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);v="",w=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(M[l.name]=c,(s=i.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&(c="",l=Xn(g[0],!1),i.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Xn(g[0],!1),c+=iO[g[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Xn(g[0],!1),c+=iO[g[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,g.index);break}else u=g.index+g[0].length;break;case"named-range":o=Xn(g[0],!1),ae=aj(o["cell-range-address"]);var ne={Name:o.name,Ref:ae[0]+"!"+ae[1]};X&&(ne.Sheet=p.length),W.Names.push(ne);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(g[1]==="/"&&(!b||!b["string-value"])){var re=w0e(n.slice(w,g.index));v=(v.length>0?v+`
`:"")+re[0]}else Xn(g[0],!1),w=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{ae=aj(Xn(g[0])["target-range-address"]),h[ae[0]]["!autofilter"]={ref:ae[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(V=Xn(g[0],!1),!V.href)break;V.Target=Ai(V.href),delete V.href,V.Target.charAt(0)=="#"&&V.Target.indexOf(".")>-1?(ae=aj(V.Target.slice(1)),V.Target="#"+ae[0]+"!"+ae[1]):V.Target.match(/^\.\.[\\\/]/)&&(V.Target=V.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var T={Sheets:h,SheetNames:p,Workbook:W};return r.bookSheets&&delete T.Sheets,T}function aO(e,t){t=t||{},Oc(e,"META-INF/manifest.xml")&&Kie(hs(e,"META-INF/manifest.xml"),t);var r=Jl(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=qU(Ji(r),t);return Oc(e,"meta.xml")&&(n.Props=L$(hs(e,"meta.xml"))),n}function sO(e,t){return qU(e,t)}var S0e=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+h1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ls+t}}(),oO=function(){var e=function(s){return Vi(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,o,l){var c=[];c.push('      <table:table table:name="'+Vi(o.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,d=0,f=Ol(s["!ref"]||"A1"),h=s["!merges"]||[],p=0,m=Array.isArray(s);if(s["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var g="",y=s["!rows"]||[];for(u=0;u<f.s.r;++u)g=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+g+`></table:table-row>
`);for(;u<=f.e.r;++u){for(g=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+g+`>
`),d=0;d<f.s.c;++d)c.push(t);for(;d<=f.e.c;++d){var b=!1,v={},w="";for(p=0;p!=h.length;++p)if(!(h[p].s.c>d)&&!(h[p].s.r>u)&&!(h[p].e.c<d)&&!(h[p].e.r<u)){(h[p].s.c!=d||h[p].s.r!=u)&&(b=!0),v["table:number-columns-spanned"]=h[p].e.c-h[p].s.c+1,v["table:number-rows-spanned"]=h[p].e.r-h[p].s.r+1;break}if(b){c.push(r);continue}var S=Yn({r:u,c:d}),j=m?(s[u]||[])[d]:s[S];if(j&&j.f&&(v["table:formula"]=Vi(zue(j.f)),j.F&&j.F.slice(0,S.length)==S)){var k=Ol(j.F);v["table:number-matrix-columns-spanned"]=k.e.c-k.s.c+1,v["table:number-matrix-rows-spanned"]=k.e.r-k.s.r+1}if(!j){c.push(t);continue}switch(j.t){case"b":w=j.v?"TRUE":"FALSE",v["office:value-type"]="boolean",v["office:boolean-value"]=j.v?"true":"false";break;case"n":w=j.w||String(j.v||0),v["office:value-type"]="float",v["office:value"]=j.v||0;break;case"s":case"str":w=j.v==null?"":j.v,v["office:value-type"]="string";break;case"d":w=j.w||xa(j.v).toISOString(),v["office:value-type"]="date",v["office:date-value"]=xa(j.v).toISOString(),v["table:style-name"]="ce1";break;default:c.push(t);continue}var A=e(w);if(j.l&&j.l.Target){var R=j.l.Target;R=R.charAt(0)=="#"?"#"+Wue(R.slice(1)):R,R.charAt(0)!="#"&&!R.match(/^\w+:/)&&(R="../"+R),A=ln("text:a",A,{"xlink:href":R.replace(/&/g,"&amp;")})}c.push("          "+ln("table:table-cell",ln("text:p",A,{}),v)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},i=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;ph(f),f.ods=l;var h=u["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,l){var c=[ls],u=h1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=h1({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(M$().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),i(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(n(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function HU(e,t){if(t.bookType=="fods")return oO(e,t);var r=F3(),n="",i=[],s=[];return n="mimetype",hi(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",hi(r,n,oO(e,t)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",hi(r,n,S0e(e,t)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",hi(r,n,ls+M$()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",hi(r,n,Qie(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",hi(r,n,Yie(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function N0(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Y4(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Ji(kh(e))}function _0e(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ql(Ku(e))}function j0e(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function gh(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function lO(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function k0e(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function A0e(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=r>=0?0:128}function w1(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function zi(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Ga(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ei(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=w1(e,r),s=i&7;i=Math.floor(i/8);var o=0,l;if(i==0)break;switch(s){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=w1(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:l,type:s};t[i]==null?t[i]=[u]:t[i].push(u)}return t}function uo(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(zi(n*8+i.type)),i.type==2&&t.push(zi(i.data.length)),t.push(i.data))})}),gh(t)}function cC(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Nc(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=w1(e,n),s=Ei(e.slice(n[0],n[0]+i));n[0]+=i;var o={id:Ga(s[1][0].data),messages:[]};s[2].forEach(function(l){var c=Ei(l.data),u=Ga(c[3][0].data);o.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=s[3])!=null&&t[0]&&(o.merge=Ga(s[3][0].data)>>>0>0),r.push(o)}return r}function gp(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:zi(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:zi(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:zi(o.data.length)}],n[2].push({data:uo(o.meta),type:2})});var s=uo(n);t.push(zi(s.length)),t.push(s),i.forEach(function(o){return t.push(o)})}),gh(t)}function N0e(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=w1(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}i.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,u=0;if(s==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,s==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[gh(i)],c==0)throw new Error("Invalid offset 0");if(c>i[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(i.push(i[0].slice(-c)),u-=c;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-c,-c+u))}}var d=gh(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Cc(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(N0e(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return gh(t)}function xp(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var s=zi(n),o=s.length;t.push(s),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,r+=n}return gh(t)}function C0e(e,t,r,n){var i=N0(e),s=i.getUint32(4,!0),o=(n>1?12:8)+lO(s&(n>1?3470:398))*4,l=-1,c=-1,u=NaN,d=new Date(2001,0,1);s&512&&(l=i.getUint32(o,!0),o+=4),o+=lO(s&(n>1?12288:4096))*4,s&16&&(c=i.getUint32(o,!0),o+=4),s&32&&(u=i.getFloat64(o,!0),o+=8),s&64&&(d.setTime(d.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function E0e(e,t,r){var n=N0(e),i=n.getUint32(8,!0),s=12,o=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);i&1&&(c=k0e(e,s),s+=16),i&2&&(u=n.getFloat64(s,!0),s+=8),i&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(l=n.getUint32(s,!0),s+=4),i&16&&(o=n.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return f}function oj(e,t){var r=new Uint8Array(32),n=N0(r),i=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,A0e(r,i,e.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,i)}function lj(e,t){var r=new Uint8Array(32),n=N0(r),i=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,i)}function T0e(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return C0e(e,t,r,e[0]);case 5:return E0e(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Lo(e){var t=Ei(e);return w1(t[1][0].data)}function cO(e,t){var r=Ei(t.data),n=Ga(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(o){var l=Ei(o.data),c=Ga(l[1][0].data)>>>0;switch(n){case 1:s[c]=Y4(l[3][0].data);break;case 8:{var u=e[Lo(l[9][0].data)][0],d=Ei(u.data),f=e[Lo(d[1][0].data)][0],h=Ga(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var p=Ei(f.data);s[c]=p[3].map(function(m){return Y4(m.data)}).join("")}break}}),s}function P0e(e,t){var r,n,i,s,o,l,c,u,d,f,h,p,m,g,y=Ei(e),b=Ga(y[1][0].data)>>>0,v=Ga(y[2][0].data)>>>0,w=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&Ga(y[8][0].data)>0||!1,S,j;if((s=(i=y[7])==null?void 0:i[0])!=null&&s.data&&t!=0)S=(l=(o=y[7])==null?void 0:o[0])==null?void 0:l.data,j=(u=(c=y[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=y[4])==null?void 0:d[0])!=null&&f.data&&t!=1)S=(p=(h=y[4])==null?void 0:h[0])==null?void 0:p.data,j=(g=(m=y[3])==null?void 0:m[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var k=w?4:1,A=N0(S),R=[],M=0;M<S.length/2;++M){var B=A.getUint16(M*2,!0);B<65535&&R.push([M,B])}if(R.length!=v)throw"Expected ".concat(v," cells, found ").concat(R.length);var E=[];for(M=0;M<R.length-1;++M)E[R[M][0]]=j.subarray(R[M][1]*k,R[M+1][1]*k);return R.length>=1&&(E[R[R.length-1][0]]=j.subarray(R[R.length-1][1]*k)),{R:b,cells:E}}function O0e(e,t){var r,n=Ei(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Ga(n[7][0].data)>>>0>0?1:0:-1,s=cC(n[5],function(o){return P0e(o,i)});return{nrows:Ga(n[4][0].data)>>>0,data:s.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,u){if(o[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));o[l.R][u]=c}),o},[])}}function M0e(e,t,r){var n,i=Ei(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Ga(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Ga(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=li(s);var o=Ei(i[4][0].data),l=cO(e,e[Lo(o[4][0].data)][0]),c=(n=o[17])!=null&&n[0]?cO(e,e[Lo(o[17][0].data)][0]):[],u=Ei(o[3][0].data),d=0;u[1].forEach(function(f){var h=Ei(f.data),p=e[Lo(h[2][0].data)][0],m=Ga(p.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var g=O0e(e,p);g.data.forEach(function(y,b){y.forEach(function(v,w){var S=Yn({r:d+b,c:w}),j=T0e(v,l,c);j&&(r[S]=j)})}),d+=g.nrows})}function L0e(e,t){var r=Ei(t.data),n={"!ref":"A1"},i=e[Lo(r[2][0].data)],s=Ga(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return M0e(e,i[0],n),n}function R0e(e,t){var r,n=Ei(t.data),i={name:(r=n[1])!=null&&r[0]?Y4(n[1][0].data):"",sheets:[]},s=cC(n[2],Lo);return s.forEach(function(o){e[o].forEach(function(l){var c=Ga(l.meta[1][0].data);c==6e3&&i.sheets.push(L0e(e,l))})}),i}function F0e(e,t){var r=pC(),n=Ei(t.data),i=cC(n[1],Lo);if(i.forEach(function(s){e[s].forEach(function(o){var l=Ga(o.meta[1][0].data);if(l==2){var c=R0e(e,o);c.sheets.forEach(function(u,d){mC(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function cj(e){var t,r,n,i,s={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=Cc(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=Nc(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){s[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var l=((i=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Ga(s[1][0].meta[1][0].data)==1&&s[1][0];if(l||o.forEach(function(c){s[c].forEach(function(u){var d=Ga(u.meta[1][0].data)>>>0;if(d==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return F0e(s,l)}function B0e(e,t,r){var n,i,s,o;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(s=e[8])==null?void 0:s[0])==null?void 0:o.data)&&Ga(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=N0(e[7][0].data),d=0,f=[],h=N0(e[4][0].data),p=0,m=[],g=0;g<t.length;++g){if(t[g]==null){u.setUint16(g*2,65535,!0),h.setUint16(g*2,65535);continue}u.setUint16(g*2,d,!0),h.setUint16(g*2,p,!0);var y,b;switch(typeof t[g]){case"string":y=oj({t:"s",v:t[g]},r),b=lj({t:"s",v:t[g]},r);break;case"number":y=oj({t:"n",v:t[g]},r),b=lj({t:"n",v:t[g]},r);break;case"boolean":y=oj({t:"b",v:t[g]},r),b=lj({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}f.push(y),d+=y.length,m.push(b),p+=b.length,++c}for(e[2][0].data=zi(c);g<e[7][0].data.length/2;++g)u.setUint16(g*2,65535,!0),h.setUint16(g*2,65535,!0);return e[6][0].data=gh(f),e[3][0].data=gh(m),c}function I0e(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ol(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(li(n)));var s=G2(r,{range:n,header:1}),o=["~Sh33tJ5~"];s.forEach(function(Y){return Y.forEach(function(q){typeof q=="string"&&o.push(q)})});var l={},c=[],u=qn.read(t.numbers,{type:"base64"});u.FileIndex.map(function(Y,q){return[Y,u.FullPaths[q]]}).forEach(function(Y){var q=Y[0],O=Y[1];if(q.type==2&&q.name.match(/\.iwa/)){var X=q.content,F=Cc(X),Q=Nc(F);Q.forEach(function(K){c.push(K.id),l[K.id]={deps:[],location:O,type:Ga(K.messages[0].meta[1][0].data)}})}}),c.sort(function(Y,q){return Y-q});var d=c.filter(function(Y){return Y>1}).map(function(Y){return[Y,zi(Y)]});u.FileIndex.map(function(Y,q){return[Y,u.FullPaths[q]]}).forEach(function(Y){var q=Y[0];if(Y[1],!!q.name.match(/\.iwa/)){var O=Nc(Cc(q.content));O.forEach(function(X){X.messages.forEach(function(F){d.forEach(function(Q){X.messages.some(function(K){return Ga(K.meta[1][0].data)!=11006&&j0e(K.data,Q[1])})&&l[Q[0]].deps.push(X.id)})})})}});for(var f=qn.find(u,l[1].location),h=Nc(Cc(f.content)),p,m=0;m<h.length;++m){var g=h[m];g.id==1&&(p=g)}var y=Lo(Ei(p.messages[0].data)[1][0].data);for(f=qn.find(u,l[y].location),h=Nc(Cc(f.content)),m=0;m<h.length;++m)g=h[m],g.id==y&&(p=g);for(y=Lo(Ei(p.messages[0].data)[2][0].data),f=qn.find(u,l[y].location),h=Nc(Cc(f.content)),m=0;m<h.length;++m)g=h[m],g.id==y&&(p=g);for(y=Lo(Ei(p.messages[0].data)[2][0].data),f=qn.find(u,l[y].location),h=Nc(Cc(f.content)),m=0;m<h.length;++m)g=h[m],g.id==y&&(p=g);var b=Ei(p.messages[0].data);{b[6][0].data=zi(n.e.r+1),b[7][0].data=zi(n.e.c+1);var v=Lo(b[46][0].data),w=qn.find(u,l[v].location),S=Nc(Cc(w.content));{for(var j=0;j<S.length&&S[j].id!=v;++j);if(S[j].id!=v)throw"Bad ColumnRowUIDMapArchive";var k=Ei(S[j].messages[0].data);k[1]=[],k[2]=[],k[3]=[];for(var A=0;A<=n.e.c;++A){var R=[];R[1]=R[2]=[{type:0,data:zi(A+420690)}],k[1].push({type:2,data:uo(R)}),k[2].push({type:0,data:zi(A)}),k[3].push({type:0,data:zi(A)})}k[4]=[],k[5]=[],k[6]=[];for(var M=0;M<=n.e.r;++M)R=[],R[1]=R[2]=[{type:0,data:zi(M+726270)}],k[4].push({type:2,data:uo(R)}),k[5].push({type:0,data:zi(M)}),k[6].push({type:0,data:zi(M)});S[j].messages[0].data=uo(k)}w.content=xp(gp(S)),w.size=w.content.length,delete b[46];var B=Ei(b[4][0].data);{B[7][0].data=zi(n.e.r+1);var E=Ei(B[1][0].data),P=Lo(E[2][0].data);w=qn.find(u,l[P].location),S=Nc(Cc(w.content));{if(S[0].id!=P)throw"Bad HeaderStorageBucket";var U=Ei(S[0].messages[0].data);for(M=0;M<s.length;++M){var G=Ei(U[2][0].data);G[1][0].data=zi(M),G[4][0].data=zi(s[M].length),U[2][M]={type:U[2][0].type,data:uo(G)}}S[0].messages[0].data=uo(U)}w.content=xp(gp(S)),w.size=w.content.length;var H=Lo(B[2][0].data);w=qn.find(u,l[H].location),S=Nc(Cc(w.content));{if(S[0].id!=H)throw"Bad HeaderStorageBucket";for(U=Ei(S[0].messages[0].data),A=0;A<=n.e.c;++A)G=Ei(U[2][0].data),G[1][0].data=zi(A),G[4][0].data=zi(n.e.r+1),U[2][A]={type:U[2][0].type,data:uo(G)};S[0].messages[0].data=uo(U)}w.content=xp(gp(S)),w.size=w.content.length;var oe=Lo(B[4][0].data);(function(){for(var Y=qn.find(u,l[oe].location),q=Nc(Cc(Y.content)),O,X=0;X<q.length;++X){var F=q[X];F.id==oe&&(O=F)}var Q=Ei(O.messages[0].data);{Q[3]=[];var K=[];o.forEach(function(T,I){K[1]=[{type:0,data:zi(I)}],K[2]=[{type:0,data:zi(1)}],K[3]=[{type:2,data:_0e(T)}],Q[3].push({type:2,data:uo(K)})})}O.messages[0].data=uo(Q);var ne=gp(q),re=xp(ne);Y.content=re,Y.size=Y.content.length})();var de=Ei(B[3][0].data);{var W=de[1][0];delete de[2];var V=Ei(W.data);{var ae=Lo(V[2][0].data);(function(){for(var Y=qn.find(u,l[ae].location),q=Nc(Cc(Y.content)),O,X=0;X<q.length;++X){var F=q[X];F.id==ae&&(O=F)}var Q=Ei(O.messages[0].data);{delete Q[6],delete de[7];var K=new Uint8Array(Q[5][0].data);Q[5]=[];for(var ne=0,re=0;re<=n.e.r;++re){var T=Ei(K);ne+=B0e(T,s[re],o),T[1][0].data=zi(re),Q[5].push({data:uo(T),type:2})}Q[1]=[{type:0,data:zi(n.e.c+1)}],Q[2]=[{type:0,data:zi(n.e.r+1)}],Q[3]=[{type:0,data:zi(ne)}],Q[4]=[{type:0,data:zi(n.e.r+1)}]}O.messages[0].data=uo(Q);var I=gp(q),ie=xp(I);Y.content=ie,Y.size=Y.content.length})()}W.data=uo(V)}B[3][0].data=uo(de)}b[4][0].data=uo(B)}p.messages[0].data=uo(b);var ee=gp(h),C=xp(ee);return f.content=C,f.size=f.content.length,u}function VU(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function uC(e){VU([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function dC(e){VU([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function D0e(e){return yi.WS.indexOf(e)>-1?"sheet":e==yi.CS?"chart":e==yi.DS?"dialog":e==yi.MS?"macro":e&&e.length?e:"sheet"}function $0e(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,D0e(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function U0e(e,t,r,n,i,s,o,l,c,u,d,f){try{s[n]=Ox(Jl(e,r,!0),t);var h=hs(e,t),p;switch(l){case"sheet":p=che(h,t,i,c,s[n],u,d,f);break;case"chart":if(p=uhe(h,t,i,c,s[n],u,d,f),!p||!p["!drawel"])break;var m=mx(p["!drawel"].Target,t),g=m1(m),y=Xle(Jl(e,m,!0),Ox(Jl(e,g,!0),m)),b=mx(y,m),v=m1(b);p=Bfe(Jl(e,b,!0),b,c,Ox(Jl(e,v,!0),b),u,p);break;case"macro":p=dhe(h,t,i,c,s[n],u,d,f);break;case"dialog":p=fhe(h,t,i,c,s[n],u,d,f);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=p;var w=[];s&&s[n]&&Ka(s[n]).forEach(function(S){var j="";if(s[n][S].Type==yi.CMNT){j=mx(s[n][S].Target,t);var k=ghe(hs(e,j,!0),j,c);if(!k||!k.length)return;KP(p,k,!1)}s[n][S].Type==yi.TCMNT&&(j=mx(s[n][S].Target,t),w=w.concat(Jle(hs(e,j,!0),c)))}),w&&w.length&&KP(p,w,!0,c.people||[])}catch(S){if(c.WTF)throw S}}function Sc(e){return e.charAt(0)=="/"?e.slice(1):e}function z0e(e,t){if(cg(),t=t||{},uC(t),Oc(e,"META-INF/manifest.xml")||Oc(e,"objectdata.xml"))return aO(e,t);if(Oc(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof cj<"u"){if(e.FileIndex)return cj(e);var r=qn.utils.cfb_new();return mP(e).forEach(function(G){hi(r,G,Zne(e,G))}),cj(r)}throw new Error("Unsupported NUMBERS file")}if(!Oc(e,"[Content_Types].xml"))throw Oc(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Oc(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=mP(e),i=Vie(Jl(e,"[Content_Types].xml")),s=!1,o,l;if(i.workbooks.length===0&&(l="xl/workbook.xml",hs(e,l,!0)&&i.workbooks.push(l)),i.workbooks.length===0){if(l="xl/workbook.bin",!hs(e,l,!0))throw new Error("Could not find workbook");i.workbooks.push(l),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(Mx=[],i.sst)try{Mx=mhe(hs(e,Sc(i.sst)),i.sst,t)}catch(G){if(t.WTF)throw G}t.cellStyles&&i.themes.length&&(c=phe(Jl(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(u=hhe(hs(e,Sc(i.style)),i.style,c,t))}i.links.map(function(G){try{var H=Ox(Jl(e,m1(Sc(G))),G);return yhe(hs(e,Sc(G)),H,G,t)}catch{}});var d=lhe(hs(e,Sc(i.workbooks[0])),i.workbooks[0],t),f={},h="";i.coreprops.length&&(h=hs(e,Sc(i.coreprops[0]),!0),h&&(f=L$(h)),i.extprops.length!==0&&(h=hs(e,Sc(i.extprops[0]),!0),h&&Zie(h,f,t)));var p={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(h=Jl(e,Sc(i.custprops[0]),!0),h&&(p=tae(h,t)));var m={};if((t.bookSheets||t.bookProps)&&(d.Sheets?o=d.Sheets.map(function(H){return H.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),t.bookProps&&(m.Props=f,m.Custprops=p),t.bookSheets&&typeof o<"u"&&(m.SheetNames=o),t.bookSheets?m.SheetNames:t.bookProps))return m;o={};var g={};t.bookDeps&&i.calcchain&&(g=xhe(hs(e,Sc(i.calcchain)),i.calcchain));var y=0,b={},v,w;{var S=d.Sheets;f.Worksheets=S.length,f.SheetNames=[];for(var j=0;j!=S.length;++j)f.SheetNames[j]=S[j].name}var k=s?"bin":"xml",A=i.workbooks[0].lastIndexOf("/"),R=(i.workbooks[0].slice(0,A+1)+"_rels/"+i.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");Oc(e,R)||(R="xl/_rels/workbook."+k+".rels");var M=Ox(Jl(e,R,!0),R.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=bhe(hs(e,Sc(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=ece(hs(e,Sc(i.people[0])),t)),M&&(M=$0e(M,d.Sheets));var B=hs(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=f.Worksheets;++y){var E="sheet";if(M&&M[y]?(v="xl/"+M[y][1].replace(/[\/]?xl\//,""),Oc(e,v)||(v=M[y][1]),Oc(e,v)||(v=R.replace(/_rels\/.*$/,"")+M[y][1]),E=M[y][2]):(v="xl/worksheets/sheet"+(y+1-B)+"."+k,v=v.replace(/sheet0\./,"sheet.")),w=v.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(f.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var P=!1,U=0;U!=t.sheets.length;++U)typeof t.sheets[U]=="number"&&t.sheets[U]==y&&(P=1),typeof t.sheets[U]=="string"&&t.sheets[U].toLowerCase()==f.SheetNames[y].toLowerCase()&&(P=1);if(!P)continue e}}U0e(e,v,w,f.SheetNames[y],y,b,o,E,t,d,c,u)}return m={Directory:i,Workbook:d,Props:f,Custprops:p,Deps:g,Sheets:o,SheetNames:f.SheetNames,Strings:Mx,Styles:u,Themes:c,SSF:ya(Gn)},t&&t.bookFiles&&(e.files?(m.keys=n,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(G,H){G=G.replace(/^Root Entry[\/]/,""),m.keys.push(G),m.files[G]=e.FileIndex[H]}))),t&&t.bookVBA&&(i.vba.length>0?m.vbaraw=hs(e,Sc(i.vba[0]),!0):i.defaults&&i.defaults.bin===lce&&(m.vbaraw=hs(e,"xl/vbaProject.bin",!0))),m}function W0e(e,t){var r=t||{},n="Workbook",i=qn.find(e,n);try{if(n="/!DataSpaces/Version",i=qn.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(boe(i.content),n="/!DataSpaces/DataSpaceMap",i=qn.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=woe(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=qn.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Soe(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=qn.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);joe(i.content)}catch{}if(n="/EncryptionInfo",i=qn.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=koe(i.content);if(n="/EncryptedPackage",i=qn.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],i.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function q0e(e,t){return t.bookType=="ods"?HU(e,t):t.bookType=="numbers"?I0e(e,t):t.bookType=="xlsb"?H0e(e,t):V0e(e,t)}function H0e(e,t){tm=1024,e&&!e.SSF&&(e.SSF=ya(Gn)),e&&e.SSF&&(cg(),NS(e.SSF),t.revssf=ES(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Lx?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=bU.indexOf(t.bookType)>-1,i=X3();dC(t=t||{});var s=F3(),o="",l=0;if(t.cellXfs=[],Nh(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",hi(s,o,R$(e.Props,t)),i.coreprops.push(o),Wi(t.rels,2,o,yi.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,hi(s,o,I$(e.Props)),i.extprops.push(o),Wi(t.rels,3,o,yi.EXT_PROPS),e.Custprops!==e.Props&&Ka(e.Custprops||{}).length>0&&(o="docProps/custom.xml",hi(s,o,D$(e.Custprops)),i.custprops.push(o),Wi(t.rels,4,o,yi.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,hi(s,o,whe(l-1,o,t,e,d)),i.sheets.push(o),Wi(t.wbrels,-1,"worksheets/sheet"+l+"."+r,yi.WS[0])}if(f){var p=f["!comments"],m=!1,g="";p&&p.length>0&&(g="xl/comments"+l+"."+r,hi(s,g,jhe(p,g)),i.comments.push(g),Wi(d,-1,"../comments"+l+"."+r,yi.CMNT),m=!0),f["!legacy"]&&m&&hi(s,"xl/drawings/vmlDrawing"+l+".vml",xU(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&hi(s,m1(o),gm(d))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,hi(s,o,_he(t.Strings,o,t)),i.strs.push(o),Wi(t.wbrels,-1,"sharedStrings."+r,yi.SST)),o="xl/workbook."+r,hi(s,o,vhe(e,o)),i.workbooks.push(o),Wi(t.rels,1,o,yi.WB),o="xl/theme/theme1.xml",hi(s,o,rC(e.Themes,t)),i.themes.push(o),Wi(t.wbrels,-1,"theme/theme1.xml",yi.THEME),o="xl/styles."+r,hi(s,o,She(e,o,t)),i.styles.push(o),Wi(t.wbrels,-1,"styles."+r,yi.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",hi(s,o,e.vbaraw),i.vba.push(o),Wi(t.wbrels,-1,"vbaProject.bin",yi.VBA)),o="xl/metadata."+r,hi(s,o,khe(o)),i.metadata.push(o),Wi(t.wbrels,-1,"metadata."+r,yi.XLMETA),hi(s,"[Content_Types].xml",O$(i,t)),hi(s,"_rels/.rels",gm(t.rels)),hi(s,"xl/_rels/workbook."+r+".rels",gm(t.wbrels)),delete t.revssf,delete t.ssf,s}function V0e(e,t){tm=1024,e&&!e.SSF&&(e.SSF=ya(Gn)),e&&e.SSF&&(cg(),NS(e.SSF),t.revssf=ES(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Lx?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=bU.indexOf(t.bookType)>-1,i=X3();dC(t=t||{});var s=F3(),o="",l=0;if(t.cellXfs=[],Nh(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",hi(s,o,R$(e.Props,t)),i.coreprops.push(o),Wi(t.rels,2,o,yi.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,hi(s,o,I$(e.Props)),i.extprops.push(o),Wi(t.rels,3,o,yi.EXT_PROPS),e.Custprops!==e.Props&&Ka(e.Custprops||{}).length>0&&(o="docProps/custom.xml",hi(s,o,D$(e.Custprops)),i.custprops.push(o),Wi(t.rels,4,o,yi.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,hi(s,o,TU(l-1,t,e,f)),i.sheets.push(o),Wi(t.wbrels,-1,"worksheets/sheet"+l+"."+r,yi.WS[0])}if(h){var m=h["!comments"],g=!1,y="";if(m&&m.length>0){var b=!1;m.forEach(function(v){v[1].forEach(function(w){w.T==!0&&(b=!0)})}),b&&(y="xl/threadedComments/threadedComment"+l+"."+r,hi(s,y,Zle(m,d,t)),i.threadedcomments.push(y),Wi(f,-1,"../threadedComments/threadedComment"+l+"."+r,yi.TCMNT)),y="xl/comments"+l+"."+r,hi(s,y,yU(m)),i.comments.push(y),Wi(f,-1,"../comments"+l+"."+r,yi.CMNT),g=!0}h["!legacy"]&&g&&hi(s,"xl/drawings/vmlDrawing"+l+".vml",xU(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&hi(s,m1(o),gm(f))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,hi(s,o,aU(t.Strings,t)),i.strs.push(o),Wi(t.wbrels,-1,"sharedStrings."+r,yi.SST)),o="xl/workbook."+r,hi(s,o,RU(e)),i.workbooks.push(o),Wi(t.rels,1,o,yi.WB),o="xl/theme/theme1.xml",hi(s,o,rC(e.Themes,t)),i.themes.push(o),Wi(t.wbrels,-1,"theme/theme1.xml",yi.THEME),o="xl/styles."+r,hi(s,o,hU(e,t)),i.styles.push(o),Wi(t.wbrels,-1,"styles."+r,yi.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",hi(s,o,e.vbaraw),i.vba.push(o),Wi(t.wbrels,-1,"vbaProject.bin",yi.VBA)),o="xl/metadata."+r,hi(s,o,gU()),i.metadata.push(o),Wi(t.wbrels,-1,"metadata."+r,yi.XLMETA),d.length>1&&(o="xl/persons/person.xml",hi(s,o,tce(d)),i.people.push(o),Wi(t.wbrels,-1,"persons/person.xml",yi.PEOPLE)),hi(s,"[Content_Types].xml",O$(i,t)),hi(s,"_rels/.rels",gm(t.rels)),hi(s,"xl/_rels/workbook."+r+".rels",gm(t.wbrels)),delete t.revssf,delete t.ssf,s}function fC(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=cc(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function G0e(e,t){return qn.find(e,"EncryptedPackage")?W0e(e,t):DU(e,t)}function K0e(e,t){var r,n=e,i=t||{};return i.type||(i.type=gi&&Buffer.isBuffer(e)?"buffer":"base64"),r=o$(n,i),z0e(r,i)}function GU(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return G4(e.slice(r),t);default:break e}return Um.to_workbook(e,t)}function Y0e(e,t){var r="",n=fC(e,t);switch(t.type){case"base64":r=cc(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=_0(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Ji(r)),t.type="binary",GU(r,t)}function X0e(e,t){var r=e;return t.type=="base64"&&(r=cc(r)),r=c1.utils.decode(1200,r.slice(2),"str"),t.type="binary",GU(r,t)}function Q0e(e){return e.match(/[^\x00-\x7F]/)?Ku(e):e}function uj(e,t,r,n){return n?(r.type="string",Um.to_workbook(e,r)):Um.to_workbook(t,r)}function C0(e,t){P3();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return C0(new Uint8Array(e),(r=ya(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),ym={},r.dateNF&&(ym.dateNF=r.dateNF),r.type||(r.type=gi&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=gi?"buffer":"binary",n=Hne(e),typeof Uint8Array<"u"&&!gi&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=Q0e(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=ya(r),r.type="array",C0(O3(n),r)}switch((i=fC(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return G0e(qn.read(n,r),r);break;case 9:if(i[1]<=8)return DU(n,r);break;case 60:return G4(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return roe(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return nU.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?K0e(n,r):uj(e,n,r,s);case 239:return i[3]===60?G4(n,r):uj(e,n,r,s);case 255:if(i[1]===254)return X0e(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return l0.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return l0.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return V4.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return uU.to_workbook(n,r);break;case 10:case 13:case 32:return Y0e(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return toe.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?V4.to_workbook(n,r):uj(e,n,r,s)}function KU(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return ry(t.file,qn.write(e,{type:gi?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return qn.write(e,t)}function J0e(e,t){var r=ya(t||{}),n=q0e(e,r);return Z0e(n,r)}function Z0e(e,t){var r={},n=gi?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?qn.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(AS(i))}return t.password&&typeof encrypt_agile<"u"?KU(encrypt_agile(i,t.password),t):t.type==="file"?ry(t.file,i):t.type=="string"?Ji(i):i}function epe(e,t){var r=t||{},n=Qhe(e,r);return KU(n,r)}function Du(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return u1(Ku(n));case"binary":return Ku(n);case"string":return e;case"file":return ry(t.file,n,"utf8");case"buffer":return gi?uf(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Du(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function tpe(e,t){switch(t.type){case"base64":return u1(e);case"binary":return e;case"string":return e;case"file":return ry(t.file,e,"binary");case"buffer":return gi?uf(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Pb(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?u1(r):t.type=="string"?Ji(r):r;case"file":return ry(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function YU(e,t){P3(),Gfe(e);var r=ya(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=YU(e,r);return r.type="array",AS(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Du(qhe(e,r),r);case"slk":case"sylk":return Du(rU.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return Du(UU(e.Sheets[e.SheetNames[i]],r),r);case"txt":return tpe(XU(e.Sheets[e.SheetNames[i]],r),r);case"csv":return Du(hC(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return Du(nU.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return Pb(V4.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return Du(Um.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return Du(uU.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return Du(iU.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return Du(HU(e,r),r);case"wk1":return Pb(l0.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return Pb(l0.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Pb($U(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),epe(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return J0e(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function rpe(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function uy(e,t,r){var n={};return n.type="file",n.file=t,rpe(n),YU(e,n)}function npe(e,t,r,n,i,s,o,l){var c=os(r),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!o||e[r])for(var p=t.s.c;p<=t.e.c;++p){var m=o?e[r][p]:e[n[p]+c];if(m===void 0||m.t===void 0){if(u===void 0)continue;s[p]!=null&&(h[s[p]]=u);continue}var g=m.v;switch(m.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[p]!=null){if(g==null)if(m.t=="e"&&g===null)h[s[p]]=null;else if(u!==void 0)h[s[p]]=u;else if(d&&g===null)h[s[p]]=null;else continue;else h[s[p]]=d&&(m.t!=="n"||m.t==="n"&&l.rawNumbers!==!1)?g:Xd(m,g,l);g!=null&&(f=!1)}}return{row:h,isempty:f}}function G2(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=Ni(d);break;case"number":c=Ni(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(i=0);var f=os(c.s.r),h=[],p=[],m=0,g=0,y=Array.isArray(e),b=c.s.r,v=0,w={};y&&!e[b]&&(e[b]=[]);var S=u.skipHidden&&e["!cols"]||[],j=u.skipHidden&&e["!rows"]||[];for(v=c.s.c;v<=c.e.c;++v)if(!(S[v]||{}).hidden)switch(h[v]=Ta(v),r=y?e[b][v]:e[h[v]+f],n){case 1:s[v]=v-c.s.c;break;case 2:s[v]=h[v];break;case 3:s[v]=u.header[v-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=Xd(r,null,u),g=w[o]||0,!g)w[o]=1;else{do l=o+"_"+g++;while(w[l]);w[o]=g,w[l]=1}s[v]=l}for(b=c.s.r+i;b<=c.e.r;++b)if(!(j[b]||{}).hidden){var k=npe(e,c,b,h,n,s,y,u);(k.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(p[m++]=k.row)}return p.length=m,p}var uO=/"/g;function ipe(e,t,r,n,i,s,o,l){for(var c=!0,u=[],d="",f=os(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var p=l.dense?(e[r]||[])[h]:e[n[h]+f];if(p==null)d="";else if(p.v!=null){c=!1,d=""+(l.rawNumbers&&p.t=="n"?p.v:Xd(p,null,l));for(var m=0,g=0;m!==d.length;++m)if((g=d.charCodeAt(m))===i||g===s||g===34||l.forceQuotes){d='"'+d.replace(uO,'""')+'"';break}d=="ID"&&(d='"ID"')}else p.f!=null&&!p.F?(c=!1,d="="+p.f,d.indexOf(",")>=0&&(d='"'+d.replace(uO,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(o)}function hC(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=Ni(e["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],m=i.s.c;m<=i.e.c;++m)(h[m]||{}).hidden||(f[m]=Ta(m));for(var g=0,y=i.s.r;y<=i.e.r;++y)(p[y]||{}).hidden||(d=ipe(e,i,y,f,o,c,s,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((g++?l:"")+d)));return delete n.dense,r.join("")}function XU(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=hC(e,t);return r}function ape(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=Ni(e["!ref"]),s="",o=[],l,c=[],u=Array.isArray(e);for(l=i.s.c;l<=i.e.c;++l)o[l]=Ta(l);for(var d=i.s.r;d<=i.e.r;++d)for(s=os(d),l=i.s.c;l<=i.e.c;++l)if(t=o[l]+s,r=u?(e[d]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function QU(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},o=0,l=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Pa(n.origin):n.origin;o=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:o+t.length-1+i}};if(s["!ref"]){var f=Ni(s["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),o==-1&&(o=f.e.r+1,d.e.r=o+t.length-1+i)}else o==-1&&(o=0,d.e.r=t.length-1+i);var h=n.header||[],p=0;t.forEach(function(g,y){Ka(g).forEach(function(b){(p=h.indexOf(b))==-1&&(h[p=h.length]=b);var v=g[b],w="z",S="",j=Yn({c:l+p,r:o+y+i});u=S1(s,j),v&&typeof v=="object"&&!(v instanceof Date)?s[j]=v:(typeof v=="number"?w="n":typeof v=="boolean"?w="b":typeof v=="string"?w="s":v instanceof Date?(w="d",n.cellDates||(w="n",v=Ls(v)),S=n.dateNF||Gn[14]):v===null&&n.nullError&&(w="e",v=0),u?(u.t=w,u.v=v,delete u.w,delete u.R,S&&(u.z=S)):s[j]=u={t:w,v},S&&(u.z=S))})}),d.e.c=Math.max(d.e.c,l+h.length-1);var m=os(o);if(i)for(p=0;p<h.length;++p)s[Ta(p+l)+m]={t:"s",v:h[p]};return s["!ref"]=li(d),s}function spe(e,t){return QU(null,e,t)}function S1(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Pa(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?S1(e,Yn(t)):S1(e,Yn({r:t,c:r||0}))}function ope(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function pC(){return{SheetNames:[],Sheets:{}}}function mC(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=o+i)!=-1;++i);}if(LU(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function lpe(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=ope(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function cpe(e,t){return e.z=t,e}function JU(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function upe(e,t,r){return JU(e,"#"+t,r)}function dpe(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function fpe(e,t,r,n){for(var i=typeof t!="string"?t:Ni(t),s=typeof t=="string"?t:li(t),o=i.s.r;o<=i.e.r;++o)for(var l=i.s.c;l<=i.e.c;++l){var c=S1(e,o,l);c.t="n",c.F=s,delete c.v,o==i.s.r&&l==i.s.c&&(c.f=r,n&&(c.D=!0))}return e}var bs={encode_col:Ta,encode_row:os,encode_cell:Yn,encode_range:li,decode_col:q3,decode_row:W3,split_cell:_ie,decode_cell:Pa,decode_range:Ol,format_cell:Xd,sheet_add_aoa:k$,sheet_add_json:QU,sheet_add_dom:zU,aoa_to_sheet:ug,json_to_sheet:spe,table_to_sheet:WU,table_to_book:b0e,sheet_to_csv:hC,sheet_to_txt:XU,sheet_to_json:G2,sheet_to_html:UU,sheet_to_formulae:ape,sheet_to_row_object_array:G2,sheet_get_cell:S1,book_new:pC,book_append_sheet:mC,book_set_sheet_visibility:lpe,cell_set_number_format:cpe,cell_set_hyperlink:JU,cell_set_internal_link:upe,cell_add_comment:dpe,sheet_set_array_formula:fpe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function Hi(e){"@babel/helpers - typeof";return Hi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hi(e)}var vu=Uint8Array,tc=Uint16Array,gC=Int32Array,xC=new vu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),yC=new vu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),dO=new vu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ZU=function(e,t){for(var r=new tc(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var i=new gC(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)i[s]=s-r[n]<<5|n;return{b:r,r:i}},ez=ZU(xC,2),hpe=ez.b,X4=ez.r;hpe[28]=258,X4[258]=28;var ppe=ZU(yC,0),fO=ppe.r,Q4=new tc(32768);for(var ma=0;ma<32768;++ma){var Cf=(ma&43690)>>1|(ma&21845)<<1;Cf=(Cf&52428)>>2|(Cf&13107)<<2,Cf=(Cf&61680)>>4|(Cf&3855)<<4,Q4[ma]=((Cf&65280)>>8|(Cf&255)<<8)>>1}var Bx=function(e,t,r){for(var n=e.length,i=0,s=new tc(t);i<n;++i)e[i]&&++s[e[i]-1];var o=new tc(t);for(i=1;i<t;++i)o[i]=o[i-1]+s[i-1]<<1;var l;if(r){l=new tc(1<<t);var c=15-t;for(i=0;i<n;++i)if(e[i])for(var u=i<<4|e[i],d=t-e[i],f=o[e[i]-1]++<<d,h=f|(1<<d)-1;f<=h;++f)l[Q4[f]>>c]=u}else for(l=new tc(n),i=0;i<n;++i)e[i]&&(l[i]=Q4[o[e[i]-1]++]>>15-e[i]);return l},E0=new vu(288);for(var ma=0;ma<144;++ma)E0[ma]=8;for(var ma=144;ma<256;++ma)E0[ma]=9;for(var ma=256;ma<280;++ma)E0[ma]=7;for(var ma=280;ma<288;++ma)E0[ma]=8;var K2=new vu(32);for(var ma=0;ma<32;++ma)K2[ma]=5;var mpe=Bx(E0,9,0),gpe=Bx(K2,5,0),tz=function(e){return(e+7)/8|0},xpe=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new vu(e.subarray(t,r))},yd=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},Vg=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},dj=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var i=r.length,s=r.slice();if(!i)return{t:nz,l:0};if(i==1){var o=new vu(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(j,k){return j.f-k.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],u=0,d=1,f=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};d!=i-1;)l=r[r[u].f<r[f].f?u++:f++],c=r[u!=d&&r[u].f<r[f].f?u++:f++],r[d++]={s:-1,f:l.f+c.f,l,r:c};for(var h=s[0].s,n=1;n<i;++n)s[n].s>h&&(h=s[n].s);var p=new tc(h+1),m=J4(r[d-1],p,0);if(m>t){var n=0,g=0,y=m-t,b=1<<y;for(s.sort(function(k,A){return p[A.s]-p[k.s]||k.f-A.f});n<i;++n){var v=s[n].s;if(p[v]>t)g+=b-(1<<m-p[v]),p[v]=t;else break}for(g>>=y;g>0;){var w=s[n].s;p[w]<t?g-=1<<t-p[w]++-1:++n}for(;n>=0&&g;--n){var S=s[n].s;p[S]==t&&(--p[S],++g)}m=t}return{t:new vu(p),l:m}},J4=function(e,t,r){return e.s==-1?Math.max(J4(e.l,t,r+1),J4(e.r,t,r+1)):t[e.s]=r},hO=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new tc(++t),n=0,i=e[0],s=1,o=function(c){r[n++]=c},l=1;l<=t;++l)if(e[l]==i&&l!=t)++s;else{if(!i&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(i),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(i);s=1,i=e[l]}return{c:r.subarray(0,n),n:t}},Gg=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},rz=function(e,t,r){var n=r.length,i=tz(t+2);e[i]=n&255,e[i+1]=n>>8,e[i+2]=e[i]^255,e[i+3]=e[i+1]^255;for(var s=0;s<n;++s)e[i+s+4]=r[s];return(i+4+n)*8},pO=function(e,t,r,n,i,s,o,l,c,u,d){yd(t,d++,r),++i[256];for(var f=dj(i,15),h=f.t,p=f.l,m=dj(s,15),g=m.t,y=m.l,b=hO(h),v=b.c,w=b.n,S=hO(g),j=S.c,k=S.n,A=new tc(19),R=0;R<v.length;++R)++A[v[R]&31];for(var R=0;R<j.length;++R)++A[j[R]&31];for(var M=dj(A,7),B=M.t,E=M.l,P=19;P>4&&!B[dO[P-1]];--P);var U=u+5<<3,G=Gg(i,E0)+Gg(s,K2)+o,H=Gg(i,h)+Gg(s,g)+o+14+3*P+Gg(A,B)+2*A[16]+3*A[17]+7*A[18];if(c>=0&&U<=G&&U<=H)return rz(t,d,e.subarray(c,c+u));var oe,de,W,V;if(yd(t,d,1+(H<G)),d+=2,H<G){oe=Bx(h,p,0),de=h,W=Bx(g,y,0),V=g;var ae=Bx(B,E,0);yd(t,d,w-257),yd(t,d+5,k-1),yd(t,d+10,P-4),d+=14;for(var R=0;R<P;++R)yd(t,d+3*R,B[dO[R]]);d+=3*P;for(var ee=[v,j],C=0;C<2;++C)for(var Y=ee[C],R=0;R<Y.length;++R){var q=Y[R]&31;yd(t,d,ae[q]),d+=B[q],q>15&&(yd(t,d,Y[R]>>5&127),d+=Y[R]>>12)}}else oe=mpe,de=E0,W=gpe,V=K2;for(var R=0;R<l;++R){var O=n[R];if(O>255){var q=O>>18&31;Vg(t,d,oe[q+257]),d+=de[q+257],q>7&&(yd(t,d,O>>23&31),d+=xC[q]);var X=O&31;Vg(t,d,W[X]),d+=V[X],X>3&&(Vg(t,d,O>>5&8191),d+=yC[X])}else Vg(t,d,oe[O]),d+=de[O]}return Vg(t,d,oe[256]),d+de[256]},ype=new gC([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),nz=new vu(0),bpe=function(e,t,r,n,i,s){var o=s.z||e.length,l=new vu(n+o+5*(1+Math.ceil(o/7e3))+i),c=l.subarray(n,l.length-i),u=s.l,d=(s.r||0)&7;if(t){d&&(c[0]=s.r>>3);for(var f=ype[t-1],h=f>>13,p=f&8191,m=(1<<r)-1,g=s.p||new tc(32768),y=s.h||new tc(m+1),b=Math.ceil(r/3),v=2*b,w=function(ie){return(e[ie]^e[ie+1]<<b^e[ie+2]<<v)&m},S=new gC(25e3),j=new tc(288),k=new tc(32),A=0,R=0,M=s.i||0,B=0,E=s.w||0,P=0;M+2<o;++M){var U=w(M),G=M&32767,H=y[U];if(g[G]=H,y[U]=G,E<=M){var oe=o-M;if((A>7e3||B>24576)&&(oe>423||!u)){d=pO(e,c,0,S,j,k,R,B,P,M-P,d),B=A=R=0,P=M;for(var de=0;de<286;++de)j[de]=0;for(var de=0;de<30;++de)k[de]=0}var W=2,V=0,ae=p,ee=G-H&32767;if(oe>2&&U==w(M-ee))for(var C=Math.min(h,oe)-1,Y=Math.min(32767,M),q=Math.min(258,oe);ee<=Y&&--ae&&G!=H;){if(e[M+W]==e[M+W-ee]){for(var O=0;O<q&&e[M+O]==e[M+O-ee];++O);if(O>W){if(W=O,V=ee,O>C)break;for(var X=Math.min(ee,O-2),F=0,de=0;de<X;++de){var Q=M-ee+de&32767,K=g[Q],ne=Q-K&32767;ne>F&&(F=ne,H=Q)}}}G=H,H=g[G],ee+=G-H&32767}if(V){S[B++]=268435456|X4[W]<<18|fO[V];var re=X4[W]&31,T=fO[V]&31;R+=xC[re]+yC[T],++j[257+re],++k[T],E=M+W,++A}else S[B++]=e[M],++j[e[M]]}}for(M=Math.max(M,E);M<o;++M)S[B++]=e[M],++j[e[M]];d=pO(e,c,u,S,j,k,R,B,P,M-P,d),u||(s.r=d&7|c[d/8|0]<<3,d-=7,s.h=y,s.p=g,s.i=M,s.w=E)}else{for(var M=s.w||0;M<o+u;M+=65535){var I=M+65535;I>=o&&(c[d/8|0]=u,I=o),d=rz(c,d+1,e.subarray(M,I))}s.i=o}return xpe(l,0,n+tz(d)+i)},iz=function(){var e=1,t=0;return{p:function(r){for(var n=e,i=t,s=r.length|0,o=0;o!=s;){for(var l=Math.min(o+2655,s);o<l;++o)i+=n+=r[o];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}e=n,t=i},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},vpe=function(e,t,r,n,i){if(!i&&(i={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),o=new vu(s.length+e.length);o.set(s),o.set(e,s.length),e=o,i.w=s.length}return bpe(e,t.level==null?6:t.level,t.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,i)},az=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},wpe=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var i=iz();i.p(t.dictionary),az(e,2,i.d())}};function Z4(e,t){t||(t={});var r=iz();r.p(e);var n=vpe(e,t,t.dictionary?6:2,4);return wpe(n,t),az(n,n.length-4,r.d()),n}var Spe=typeof TextDecoder<"u"&&new TextDecoder,_pe=0;try{Spe.decode(nz,{stream:!0}),_pe=1}catch{}function jpe(e){if(Array.isArray(e))return e}function kpe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,s,o,l=[],c=!0,u=!1;try{if(s=(r=r.call(e)).next,t!==0)for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,i=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}function mO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Ape(e,t){if(e){if(typeof e=="string")return mO(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?mO(e,t):void 0}}function Npe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gO(e,t){return jpe(e)||kpe(e,t)||Ape(e,t)||Npe()}function xO(e,t="utf8"){return new TextDecoder(t).decode(e)}const Cpe=new TextEncoder;function Epe(e){return Cpe.encode(e)}const Tpe=1024*8,Ppe=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),fj={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class bC{constructor(t=Tpe,r={}){Mi(this,"buffer");Mi(this,"byteLength");Mi(this,"byteOffset");Mi(this,"length");Mi(this,"offset");Mi(this,"lastWrittenByte");Mi(this,"littleEndian");Mi(this,"_data");Mi(this,"_mark");Mi(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const i=r.offset?r.offset>>>0:0,s=t.byteLength-i;let o=i;(ArrayBuffer.isView(t)||t instanceof bC)&&(t.byteLength!==t.buffer.byteLength&&(o=t.byteOffset+i),t=t.buffer),n?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=t,this.length=s,this.byteLength=s,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,s),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,i=new Uint8Array(n);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=fj[r].BYTES_PER_ELEMENT*t,i=this.byteOffset+this.offset,s=this.buffer.slice(i,i+n);if(this.littleEndian===Ppe&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(i,i+n));l.reverse();const c=new fj[r](l.buffer);return this.offset+=n,c.reverse(),c}const o=new fj[r](s);return this.offset+=n,o}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return xO(this.readBytes(t))}decodeText(t=1,r="utf8"){return xO(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(Epe(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function fg(e){let t=e.length;for(;--t>=0;)e[t]=0}const Ope=3,Mpe=258,sz=29,Lpe=256,Rpe=Lpe+1+sz,oz=30,Fpe=512,Bpe=new Array((Rpe+2)*2);fg(Bpe);const Ipe=new Array(oz*2);fg(Ipe);const Dpe=new Array(Fpe);fg(Dpe);const $pe=new Array(Mpe-Ope+1);fg($pe);const Upe=new Array(sz);fg(Upe);const zpe=new Array(oz);fg(zpe);const Wpe=(e,t,r,n)=>{let i=e&65535|0,s=e>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do i=i+t[n++]|0,s=s+i|0;while(--o);i%=65521,s%=65521}return i|s<<16|0};var eA=Wpe;const qpe=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},Hpe=new Uint32Array(qpe()),Vpe=(e,t,r,n)=>{const i=Hpe,s=n+r;e^=-1;for(let o=n;o<s;o++)e=e>>>8^i[(e^t[o])&255];return e^-1};var Mu=Vpe,tA={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},lz={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const Gpe=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Kpe=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)Gpe(r,n)&&(e[n]=r[n])}}return e},Ype=e=>{let t=0;for(let n=0,i=e.length;n<i;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,i=0,s=e.length;n<s;n++){let o=e[n];r.set(o,i),i+=o.length}return r},cz={assign:Kpe,flattenChunks:Ype};let uz=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{uz=!1}const _1=new Uint8Array(256);for(let e=0;e<256;e++)_1[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;_1[254]=_1[254]=1;var Xpe=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,i,s,o=e.length,l=0;for(i=0;i<o;i++)r=e.charCodeAt(i),(r&64512)===55296&&i+1<o&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(l),s=0,i=0;s<l;i++)r=e.charCodeAt(i),(r&64512)===55296&&i+1<o&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?t[s++]=r:r<2048?(t[s++]=192|r>>>6,t[s++]=128|r&63):r<65536?(t[s++]=224|r>>>12,t[s++]=128|r>>>6&63,t[s++]=128|r&63):(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63,t[s++]=128|r>>>6&63,t[s++]=128|r&63);return t};const Qpe=(e,t)=>{if(t<65534&&e.subarray&&uz)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var Jpe=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,i;const s=new Array(r*2);for(i=0,n=0;n<r;){let o=e[n++];if(o<128){s[i++]=o;continue}let l=_1[o];if(l>4){s[i++]=65533,n+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&n<r;)o=o<<6|e[n++]&63,l--;if(l>1){s[i++]=65533;continue}o<65536?s[i++]=o:(o-=65536,s[i++]=55296|o>>10&1023,s[i++]=56320|o&1023)}return Qpe(s,i)},Zpe=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+_1[e[r]]>t?r:t},rA={string2buf:Xpe,buf2string:Jpe,utf8border:Zpe};function eme(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var tme=eme;const Ob=16209,rme=16191;var nme=function(t,r){let n,i,s,o,l,c,u,d,f,h,p,m,g,y,b,v,w,S,j,k,A,R,M,B;const E=t.state;n=t.next_in,M=t.input,i=n+(t.avail_in-5),s=t.next_out,B=t.output,o=s-(r-t.avail_out),l=s+(t.avail_out-257),c=E.dmax,u=E.wsize,d=E.whave,f=E.wnext,h=E.window,p=E.hold,m=E.bits,g=E.lencode,y=E.distcode,b=(1<<E.lenbits)-1,v=(1<<E.distbits)-1;e:do{m<15&&(p+=M[n++]<<m,m+=8,p+=M[n++]<<m,m+=8),w=g[p&b];t:for(;;){if(S=w>>>24,p>>>=S,m-=S,S=w>>>16&255,S===0)B[s++]=w&65535;else if(S&16){j=w&65535,S&=15,S&&(m<S&&(p+=M[n++]<<m,m+=8),j+=p&(1<<S)-1,p>>>=S,m-=S),m<15&&(p+=M[n++]<<m,m+=8,p+=M[n++]<<m,m+=8),w=y[p&v];r:for(;;){if(S=w>>>24,p>>>=S,m-=S,S=w>>>16&255,S&16){if(k=w&65535,S&=15,m<S&&(p+=M[n++]<<m,m+=8,m<S&&(p+=M[n++]<<m,m+=8)),k+=p&(1<<S)-1,k>c){t.msg="invalid distance too far back",E.mode=Ob;break e}if(p>>>=S,m-=S,S=s-o,k>S){if(S=k-S,S>d&&E.sane){t.msg="invalid distance too far back",E.mode=Ob;break e}if(A=0,R=h,f===0){if(A+=u-S,S<j){j-=S;do B[s++]=h[A++];while(--S);A=s-k,R=B}}else if(f<S){if(A+=u+f-S,S-=f,S<j){j-=S;do B[s++]=h[A++];while(--S);if(A=0,f<j){S=f,j-=S;do B[s++]=h[A++];while(--S);A=s-k,R=B}}}else if(A+=f-S,S<j){j-=S;do B[s++]=h[A++];while(--S);A=s-k,R=B}for(;j>2;)B[s++]=R[A++],B[s++]=R[A++],B[s++]=R[A++],j-=3;j&&(B[s++]=R[A++],j>1&&(B[s++]=R[A++]))}else{A=s-k;do B[s++]=B[A++],B[s++]=B[A++],B[s++]=B[A++],j-=3;while(j>2);j&&(B[s++]=B[A++],j>1&&(B[s++]=B[A++]))}}else if(S&64){t.msg="invalid distance code",E.mode=Ob;break e}else{w=y[(w&65535)+(p&(1<<S)-1)];continue r}break}}else if(S&64)if(S&32){E.mode=rme;break e}else{t.msg="invalid literal/length code",E.mode=Ob;break e}else{w=g[(w&65535)+(p&(1<<S)-1)];continue t}break}}while(n<i&&s<l);j=m>>3,n-=j,m-=j<<3,p&=(1<<m)-1,t.next_in=n,t.next_out=s,t.avail_in=n<i?5+(i-n):5-(n-i),t.avail_out=s<l?257+(l-s):257-(s-l),E.hold=p,E.bits=m};const yp=15,yO=852,bO=592,vO=0,hj=1,wO=2,ime=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),ame=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),sme=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),ome=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),lme=(e,t,r,n,i,s,o,l)=>{const c=l.bits;let u=0,d=0,f=0,h=0,p=0,m=0,g=0,y=0,b=0,v=0,w,S,j,k,A,R=null,M;const B=new Uint16Array(yp+1),E=new Uint16Array(yp+1);let P=null,U,G,H;for(u=0;u<=yp;u++)B[u]=0;for(d=0;d<n;d++)B[t[r+d]]++;for(p=c,h=yp;h>=1&&B[h]===0;h--);if(p>h&&(p=h),h===0)return i[s++]=1<<24|64<<16|0,i[s++]=1<<24|64<<16|0,l.bits=1,0;for(f=1;f<h&&B[f]===0;f++);for(p<f&&(p=f),y=1,u=1;u<=yp;u++)if(y<<=1,y-=B[u],y<0)return-1;if(y>0&&(e===vO||h!==1))return-1;for(E[1]=0,u=1;u<yp;u++)E[u+1]=E[u]+B[u];for(d=0;d<n;d++)t[r+d]!==0&&(o[E[t[r+d]]++]=d);if(e===vO?(R=P=o,M=20):e===hj?(R=ime,P=ame,M=257):(R=sme,P=ome,M=0),v=0,d=0,u=f,A=s,m=p,g=0,j=-1,b=1<<p,k=b-1,e===hj&&b>yO||e===wO&&b>bO)return 1;for(;;){U=u-g,o[d]+1<M?(G=0,H=o[d]):o[d]>=M?(G=P[o[d]-M],H=R[o[d]-M]):(G=96,H=0),w=1<<u-g,S=1<<m,f=S;do S-=w,i[A+(v>>g)+S]=U<<24|G<<16|H|0;while(S!==0);for(w=1<<u-1;v&w;)w>>=1;if(w!==0?(v&=w-1,v+=w):v=0,d++,--B[u]===0){if(u===h)break;u=t[r+o[d]]}if(u>p&&(v&k)!==j){for(g===0&&(g=p),A+=f,m=u-g,y=1<<m;m+g<h&&(y-=B[m+g],!(y<=0));)m++,y<<=1;if(b+=1<<m,e===hj&&b>yO||e===wO&&b>bO)return 1;j=v&k,i[j]=p<<24|m<<16|A-s|0}}return v!==0&&(i[A+v]=u-g<<24|64<<16|0),l.bits=p,0};var Ix=lme;const cme=0,dz=1,fz=2,{Z_FINISH:SO,Z_BLOCK:ume,Z_TREES:Mb,Z_OK:T0,Z_STREAM_END:dme,Z_NEED_DICT:fme,Z_STREAM_ERROR:qc,Z_DATA_ERROR:hz,Z_MEM_ERROR:pz,Z_BUF_ERROR:hme,Z_DEFLATED:_O}=lz,RS=16180,jO=16181,kO=16182,AO=16183,NO=16184,CO=16185,EO=16186,TO=16187,PO=16188,OO=16189,Y2=16190,bd=16191,pj=16192,MO=16193,mj=16194,LO=16195,RO=16196,FO=16197,BO=16198,Lb=16199,Rb=16200,IO=16201,DO=16202,$O=16203,UO=16204,zO=16205,gj=16206,WO=16207,qO=16208,va=16209,mz=16210,gz=16211,pme=852,mme=592,gme=15,xme=gme,HO=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function yme(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const np=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<RS||t.mode>gz?1:0},xz=e=>{if(np(e))return qc;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=RS,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(pme),t.distcode=t.distdyn=new Int32Array(mme),t.sane=1,t.back=-1,T0},yz=e=>{if(np(e))return qc;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,xz(e)},bz=(e,t)=>{let r;if(np(e))return qc;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?qc:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,yz(e))},vz=(e,t)=>{if(!e)return qc;const r=new yme;e.state=r,r.strm=e,r.window=null,r.mode=RS;const n=bz(e,t);return n!==T0&&(e.state=null),n},bme=e=>vz(e,xme);let VO=!0,xj,yj;const vme=e=>{if(VO){xj=new Int32Array(512),yj=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Ix(dz,e.lens,0,288,xj,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Ix(fz,e.lens,0,32,yj,0,e.work,{bits:5}),VO=!1}e.lencode=xj,e.lenbits=9,e.distcode=yj,e.distbits=5},wz=(e,t,r,n)=>{let i;const s=e.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(t.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>n&&(i=n),s.window.set(t.subarray(r-n,r-n+i),s.wnext),n-=i,n?(s.window.set(t.subarray(r-n,r),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0},wme=(e,t)=>{let r,n,i,s,o,l,c,u,d,f,h,p,m,g,y=0,b,v,w,S,j,k,A,R;const M=new Uint8Array(4);let B,E;const P=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(np(e)||!e.output||!e.input&&e.avail_in!==0)return qc;r=e.state,r.mode===bd&&(r.mode=pj),o=e.next_out,i=e.output,c=e.avail_out,s=e.next_in,n=e.input,l=e.avail_in,u=r.hold,d=r.bits,f=l,h=c,R=T0;e:for(;;)switch(r.mode){case RS:if(r.wrap===0){r.mode=pj;break}for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&2&&u===35615){r.wbits===0&&(r.wbits=15),r.check=0,M[0]=u&255,M[1]=u>>>8&255,r.check=Mu(r.check,M,2,0),u=0,d=0,r.mode=jO;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){e.msg="incorrect header check",r.mode=va;break}if((u&15)!==_O){e.msg="unknown compression method",r.mode=va;break}if(u>>>=4,d-=4,A=(u&15)+8,r.wbits===0&&(r.wbits=A),A>15||A>r.wbits){e.msg="invalid window size",r.mode=va;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=u&512?OO:bd,u=0,d=0;break;case jO:for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.flags=u,(r.flags&255)!==_O){e.msg="unknown compression method",r.mode=va;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=va;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&r.wrap&4&&(M[0]=u&255,M[1]=u>>>8&255,r.check=Mu(r.check,M,2,0)),u=0,d=0,r.mode=kO;case kO:for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.head&&(r.head.time=u),r.flags&512&&r.wrap&4&&(M[0]=u&255,M[1]=u>>>8&255,M[2]=u>>>16&255,M[3]=u>>>24&255,r.check=Mu(r.check,M,4,0)),u=0,d=0,r.mode=AO;case AO:for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&r.wrap&4&&(M[0]=u&255,M[1]=u>>>8&255,r.check=Mu(r.check,M,2,0)),u=0,d=0,r.mode=NO;case NO:if(r.flags&1024){for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&r.wrap&4&&(M[0]=u&255,M[1]=u>>>8&255,r.check=Mu(r.check,M,2,0)),u=0,d=0}else r.head&&(r.head.extra=null);r.mode=CO;case CO:if(r.flags&1024&&(p=r.length,p>l&&(p=l),p&&(r.head&&(A=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(s,s+p),A)),r.flags&512&&r.wrap&4&&(r.check=Mu(r.check,n,p,s)),l-=p,s+=p,r.length-=p),r.length))break e;r.length=0,r.mode=EO;case EO:if(r.flags&2048){if(l===0)break e;p=0;do A=n[s+p++],r.head&&A&&r.length<65536&&(r.head.name+=String.fromCharCode(A));while(A&&p<l);if(r.flags&512&&r.wrap&4&&(r.check=Mu(r.check,n,p,s)),l-=p,s+=p,A)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=TO;case TO:if(r.flags&4096){if(l===0)break e;p=0;do A=n[s+p++],r.head&&A&&r.length<65536&&(r.head.comment+=String.fromCharCode(A));while(A&&p<l);if(r.flags&512&&r.wrap&4&&(r.check=Mu(r.check,n,p,s)),l-=p,s+=p,A)break e}else r.head&&(r.head.comment=null);r.mode=PO;case PO:if(r.flags&512){for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&4&&u!==(r.check&65535)){e.msg="header crc mismatch",r.mode=va;break}u=0,d=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=bd;break;case OO:for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}e.adler=r.check=HO(u),u=0,d=0,r.mode=Y2;case Y2:if(r.havedict===0)return e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=u,r.bits=d,fme;e.adler=r.check=1,r.mode=bd;case bd:if(t===ume||t===Mb)break e;case pj:if(r.last){u>>>=d&7,d-=d&7,r.mode=gj;break}for(;d<3;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}switch(r.last=u&1,u>>>=1,d-=1,u&3){case 0:r.mode=MO;break;case 1:if(vme(r),r.mode=Lb,t===Mb){u>>>=2,d-=2;break e}break;case 2:r.mode=RO;break;case 3:e.msg="invalid block type",r.mode=va}u>>>=2,d-=2;break;case MO:for(u>>>=d&7,d-=d&7;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if((u&65535)!==(u>>>16^65535)){e.msg="invalid stored block lengths",r.mode=va;break}if(r.length=u&65535,u=0,d=0,r.mode=mj,t===Mb)break e;case mj:r.mode=LO;case LO:if(p=r.length,p){if(p>l&&(p=l),p>c&&(p=c),p===0)break e;i.set(n.subarray(s,s+p),o),l-=p,s+=p,c-=p,o+=p,r.length-=p;break}r.mode=bd;break;case RO:for(;d<14;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.nlen=(u&31)+257,u>>>=5,d-=5,r.ndist=(u&31)+1,u>>>=5,d-=5,r.ncode=(u&15)+4,u>>>=4,d-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=va;break}r.have=0,r.mode=FO;case FO:for(;r.have<r.ncode;){for(;d<3;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.lens[P[r.have++]]=u&7,u>>>=3,d-=3}for(;r.have<19;)r.lens[P[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,B={bits:r.lenbits},R=Ix(cme,r.lens,0,19,r.lencode,0,r.work,B),r.lenbits=B.bits,R){e.msg="invalid code lengths set",r.mode=va;break}r.have=0,r.mode=BO;case BO:for(;r.have<r.nlen+r.ndist;){for(;y=r.lencode[u&(1<<r.lenbits)-1],b=y>>>24,v=y>>>16&255,w=y&65535,!(b<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(w<16)u>>>=b,d-=b,r.lens[r.have++]=w;else{if(w===16){for(E=b+2;d<E;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(u>>>=b,d-=b,r.have===0){e.msg="invalid bit length repeat",r.mode=va;break}A=r.lens[r.have-1],p=3+(u&3),u>>>=2,d-=2}else if(w===17){for(E=b+3;d<E;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=b,d-=b,A=0,p=3+(u&7),u>>>=3,d-=3}else{for(E=b+7;d<E;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=b,d-=b,A=0,p=11+(u&127),u>>>=7,d-=7}if(r.have+p>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=va;break}for(;p--;)r.lens[r.have++]=A}}if(r.mode===va)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=va;break}if(r.lenbits=9,B={bits:r.lenbits},R=Ix(dz,r.lens,0,r.nlen,r.lencode,0,r.work,B),r.lenbits=B.bits,R){e.msg="invalid literal/lengths set",r.mode=va;break}if(r.distbits=6,r.distcode=r.distdyn,B={bits:r.distbits},R=Ix(fz,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,B),r.distbits=B.bits,R){e.msg="invalid distances set",r.mode=va;break}if(r.mode=Lb,t===Mb)break e;case Lb:r.mode=Rb;case Rb:if(l>=6&&c>=258){e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=u,r.bits=d,nme(e,h),o=e.next_out,i=e.output,c=e.avail_out,s=e.next_in,n=e.input,l=e.avail_in,u=r.hold,d=r.bits,r.mode===bd&&(r.back=-1);break}for(r.back=0;y=r.lencode[u&(1<<r.lenbits)-1],b=y>>>24,v=y>>>16&255,w=y&65535,!(b<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(v&&!(v&240)){for(S=b,j=v,k=w;y=r.lencode[k+((u&(1<<S+j)-1)>>S)],b=y>>>24,v=y>>>16&255,w=y&65535,!(S+b<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=S,d-=S,r.back+=S}if(u>>>=b,d-=b,r.back+=b,r.length=w,v===0){r.mode=zO;break}if(v&32){r.back=-1,r.mode=bd;break}if(v&64){e.msg="invalid literal/length code",r.mode=va;break}r.extra=v&15,r.mode=IO;case IO:if(r.extra){for(E=r.extra;d<E;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=DO;case DO:for(;y=r.distcode[u&(1<<r.distbits)-1],b=y>>>24,v=y>>>16&255,w=y&65535,!(b<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(!(v&240)){for(S=b,j=v,k=w;y=r.distcode[k+((u&(1<<S+j)-1)>>S)],b=y>>>24,v=y>>>16&255,w=y&65535,!(S+b<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=S,d-=S,r.back+=S}if(u>>>=b,d-=b,r.back+=b,v&64){e.msg="invalid distance code",r.mode=va;break}r.offset=w,r.extra=v&15,r.mode=$O;case $O:if(r.extra){for(E=r.extra;d<E;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=va;break}r.mode=UO;case UO:if(c===0)break e;if(p=h-c,r.offset>p){if(p=r.offset-p,p>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=va;break}p>r.wnext?(p-=r.wnext,m=r.wsize-p):m=r.wnext-p,p>r.length&&(p=r.length),g=r.window}else g=i,m=o-r.offset,p=r.length;p>c&&(p=c),c-=p,r.length-=p;do i[o++]=g[m++];while(--p);r.length===0&&(r.mode=Rb);break;case zO:if(c===0)break e;i[o++]=r.length,c--,r.mode=Rb;break;case gj:if(r.wrap){for(;d<32;){if(l===0)break e;l--,u|=n[s++]<<d,d+=8}if(h-=c,e.total_out+=h,r.total+=h,r.wrap&4&&h&&(e.adler=r.check=r.flags?Mu(r.check,i,h,o-h):eA(r.check,i,h,o-h)),h=c,r.wrap&4&&(r.flags?u:HO(u))!==r.check){e.msg="incorrect data check",r.mode=va;break}u=0,d=0}r.mode=WO;case WO:if(r.wrap&&r.flags){for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&4&&u!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=va;break}u=0,d=0}r.mode=qO;case qO:R=dme;break e;case va:R=hz;break e;case mz:return pz;case gz:default:return qc}return e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=u,r.bits=d,(r.wsize||h!==e.avail_out&&r.mode<va&&(r.mode<gj||t!==SO))&&wz(e,e.output,e.next_out,h-e.avail_out),f-=e.avail_in,h-=e.avail_out,e.total_in+=f,e.total_out+=h,r.total+=h,r.wrap&4&&h&&(e.adler=r.check=r.flags?Mu(r.check,i,h,e.next_out-h):eA(r.check,i,h,e.next_out-h)),e.data_type=r.bits+(r.last?64:0)+(r.mode===bd?128:0)+(r.mode===Lb||r.mode===mj?256:0),(f===0&&h===0||t===SO)&&R===T0&&(R=hme),R},Sme=e=>{if(np(e))return qc;let t=e.state;return t.window&&(t.window=null),e.state=null,T0},_me=(e,t)=>{if(np(e))return qc;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,T0):qc},jme=(e,t)=>{const r=t.length;let n,i,s;return np(e)||(n=e.state,n.wrap!==0&&n.mode!==Y2)?qc:n.mode===Y2&&(i=1,i=eA(i,t,r,0),i!==n.check)?hz:(s=wz(e,t,r,r),s?(n.mode=mz,pz):(n.havedict=1,T0))};var kme=yz,Ame=bz,Nme=xz,Cme=bme,Eme=vz,Tme=wme,Pme=Sme,Ome=_me,Mme=jme,Lme="pako inflate (from Nodeca project)",Cd={inflateReset:kme,inflateReset2:Ame,inflateResetKeep:Nme,inflateInit:Cme,inflateInit2:Eme,inflate:Tme,inflateEnd:Pme,inflateGetHeader:Ome,inflateSetDictionary:Mme,inflateInfo:Lme};function Rme(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Fme=Rme;const Sz=Object.prototype.toString,{Z_NO_FLUSH:Bme,Z_FINISH:Ime,Z_OK:j1,Z_STREAM_END:bj,Z_NEED_DICT:vj,Z_STREAM_ERROR:Dme,Z_DATA_ERROR:GO,Z_MEM_ERROR:$me}=lz;function dy(e){this.options=cz.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new tme,this.strm.avail_out=0;let r=Cd.inflateInit2(this.strm,t.windowBits);if(r!==j1)throw new Error(tA[r]);if(this.header=new Fme,Cd.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=rA.string2buf(t.dictionary):Sz.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Cd.inflateSetDictionary(this.strm,t.dictionary),r!==j1)))throw new Error(tA[r])}dy.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let s,o,l;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?Ime:Bme,Sz.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),s=Cd.inflate(r,o),s===vj&&i&&(s=Cd.inflateSetDictionary(r,i),s===j1?s=Cd.inflate(r,o):s===GO&&(s=vj));r.avail_in>0&&s===bj&&r.state.wrap>0&&e[r.next_in]!==0;)Cd.inflateReset(r),s=Cd.inflate(r,o);switch(s){case Dme:case GO:case vj:case $me:return this.onEnd(s),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||s===bj))if(this.options.to==="string"){let c=rA.utf8border(r.output,r.next_out),u=r.next_out-c,d=rA.buf2string(r.output,c);r.next_out=u,r.avail_out=n-u,u&&r.output.set(r.output.subarray(c,c+u),0),this.onData(d)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(s===j1&&l===0)){if(s===bj)return s=Cd.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};dy.prototype.onData=function(e){this.chunks.push(e)};dy.prototype.onEnd=function(e){e===j1&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=cz.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Ume(e,t){const r=new dy(t);if(r.push(e),r.err)throw r.msg||tA[r.err];return r.result}var zme=dy,Wme=Ume,qme={Inflate:zme,inflate:Wme};const{Inflate:Hme,inflate:Vme}=qme;var KO=Hme,Gme=Vme;const _z=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;_z[e]=t}const YO=4294967295;function Kme(e,t,r){let n=e;for(let i=0;i<r;i++)n=_z[(n^t[i])&255]^n>>>8;return n}function Yme(e,t){return(Kme(YO,e,t)^YO)>>>0}function XO(e,t,r){const n=e.readUint32(),i=Yme(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(i!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${i}`)}function jz(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function kz(e,t,r,n){let i=0;for(;i<n;i++)t[i]=e[i];for(;i<r;i++)t[i]=e[i]+t[i-n]&255}function Az(e,t,r,n){let i=0;if(r.length===0)for(;i<n;i++)t[i]=e[i];else for(;i<n;i++)t[i]=e[i]+r[i]&255}function Nz(e,t,r,n,i){let s=0;if(r.length===0){for(;s<i;s++)t[s]=e[s];for(;s<n;s++)t[s]=e[s]+(t[s-i]>>1)&255}else{for(;s<i;s++)t[s]=e[s]+(r[s]>>1)&255;for(;s<n;s++)t[s]=e[s]+(t[s-i]+r[s]>>1)&255}}function Cz(e,t,r,n,i){let s=0;if(r.length===0){for(;s<i;s++)t[s]=e[s];for(;s<n;s++)t[s]=e[s]+t[s-i]&255}else{for(;s<i;s++)t[s]=e[s]+r[s]&255;for(;s<n;s++)t[s]=e[s]+Xme(t[s-i],r[s],r[s-i])&255}}function Xme(e,t,r){const n=e+t-r,i=Math.abs(n-e),s=Math.abs(n-t),o=Math.abs(n-r);return i<=s&&i<=o?e:s<=o?t:r}function Qme(e,t,r,n,i,s){switch(e){case 0:jz(t,r,i);break;case 1:kz(t,r,i,s);break;case 2:Az(t,r,n,i);break;case 3:Nz(t,r,n,i,s);break;case 4:Cz(t,r,n,i,s);break;default:throw new Error(`Unsupported filter: ${e}`)}}const Jme=new Uint16Array([255]),Zme=new Uint8Array(Jme.buffer),ege=Zme[0]===255;function tge(e){const{data:t,width:r,height:n,channels:i,depth:s}=e,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(s/8)*i,c=new Uint8Array(n*r*l);let u=0;for(let d=0;d<7;d++){const f=o[d],h=Math.ceil((r-f.x)/f.xStep),p=Math.ceil((n-f.y)/f.yStep);if(h<=0||p<=0)continue;const m=h*l,g=new Uint8Array(m);for(let y=0;y<p;y++){const b=t[u++],v=t.subarray(u,u+m);u+=m;const w=new Uint8Array(m);Qme(b,v,w,g,m,l),g.set(w);for(let S=0;S<h;S++){const j=f.x+S*f.xStep,k=f.y+y*f.yStep;if(!(j>=r||k>=n))for(let A=0;A<l;A++)c[(k*r+j)*l+A]=w[S*l+A]}}}if(s===16){const d=new Uint16Array(c.buffer);if(ege)for(let f=0;f<d.length;f++)d[f]=rge(d[f]);return d}else return c}function rge(e){return(e&255)<<8|e>>8&255}const nge=new Uint16Array([255]),ige=new Uint8Array(nge.buffer),age=ige[0]===255,sge=new Uint8Array(0);function QO(e){const{data:t,width:r,height:n,channels:i,depth:s}=e,o=Math.ceil(s/8)*i,l=Math.ceil(s/8*i*r),c=new Uint8Array(n*l);let u=sge,d=0,f,h;for(let p=0;p<n;p++){switch(f=t.subarray(d+1,d+1+l),h=c.subarray(p*l,(p+1)*l),t[d]){case 0:jz(f,h,l);break;case 1:kz(f,h,l,o);break;case 2:Az(f,h,u,l);break;case 3:Nz(f,h,u,l,o);break;case 4:Cz(f,h,u,l,o);break;default:throw new Error(`Unsupported filter: ${t[d]}`)}u=h,d+=l+1}if(s===16){const p=new Uint16Array(c.buffer);if(age)for(let m=0;m<p.length;m++)p[m]=oge(p[m]);return p}else return c}function oge(e){return(e&255)<<8|e>>8&255}const zv=Uint8Array.of(137,80,78,71,13,10,26,10);function JO(e){if(!lge(e.readBytes(zv.length)))throw new Error("wrong PNG signature")}function lge(e){if(e.length<zv.length)return!1;for(let t=0;t<zv.length;t++)if(e[t]!==zv[t])return!1;return!0}const cge="tEXt",uge=0,Ez=new TextDecoder("latin1");function dge(e){if(hge(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const fge=/^[\u0000-\u00FF]*$/;function hge(e){if(!fge.test(e))throw new Error("invalid latin1 text")}function pge(e,t,r){const n=Tz(t);e[n]=mge(t,r-n.length-1)}function Tz(e){for(e.mark();e.readByte()!==uge;);const t=e.offset;e.reset();const r=Ez.decode(e.readBytes(t-e.offset-1));return e.skip(1),dge(r),r}function mge(e,t){return Ez.decode(e.readBytes(t))}const ql={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},wj={UNKNOWN:-1,DEFLATE:0},ZO={UNKNOWN:-1,ADAPTIVE:0},Sj={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Fb={NONE:0,BACKGROUND:1,PREVIOUS:2},_j={SOURCE:0,OVER:1};class gge extends bC{constructor(r,n={}){super(r);Mi(this,"_checkCrc");Mi(this,"_inflator");Mi(this,"_png");Mi(this,"_apng");Mi(this,"_end");Mi(this,"_hasPalette");Mi(this,"_palette");Mi(this,"_hasTransparency");Mi(this,"_transparency");Mi(this,"_compressionMethod");Mi(this,"_filterMethod");Mi(this,"_interlaceMethod");Mi(this,"_colorType");Mi(this,"_isAnimated");Mi(this,"_numberOfFrames");Mi(this,"_numberOfPlays");Mi(this,"_frames");Mi(this,"_writingDataChunks");const{checkCrc:i=!1}=n;this._checkCrc=i,this._inflator=new KO,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=wj.UNKNOWN,this._filterMethod=ZO.UNKNOWN,this._interlaceMethod=Sj.UNKNOWN,this._colorType=ql.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(JO(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(JO(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const i=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case cge:pge(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-i!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?XO(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const i=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=i+r;break}if(this.offset-i!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?XO(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=xge(this.readUint8());const n=this.readUint8();this._colorType=n;let i;switch(n){case ql.GREYSCALE:i=1;break;case ql.TRUECOLOUR:i=3;break;case ql.INDEXED_COLOUR:i=1;break;case ql.GREYSCALE_ALPHA:i=2;break;case ql.TRUECOLOUR_ALPHA:i=4;break;case ql.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=i,this._compressionMethod=this.readUint8(),this._compressionMethod!==wj.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const i=[];this._palette=i;for(let s=0;s<n;s++)i.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,i=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,i,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,i=this.offset+this.byteOffset;if(i+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,i,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case ql.GREYSCALE:case ql.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case ql.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const i=this.readByte();this._palette[n].push(i)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case ql.UNKNOWN:case ql.GREYSCALE_ALPHA:case ql.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=Tz(this),i=this.readUint8();if(i!==wj.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${i}`);const s=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:Gme(s)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),i=this.readByte();this._png.resolution={x:r,y:n,unit:i}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},i=this._frames.at(r);if(i){if(i.data=QO({data:i.data,width:i.width,height:i.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||i.xOffset===0&&i.yOffset===0&&i.width===this._png.width&&i.height===this._png.height)n.data=i.data;else{const s=this._apng.frames.at(r-1);this.disposeFrame(i,s,n),this.addFrameDataToCanvas(n,i)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,i){switch(r.disposeOp){case Fb.NONE:break;case Fb.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let o=0;o<this._png.width;o++){const l=(s*r.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)i.data[l+c]=0}break;case Fb.PREVIOUS:i.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const i=1<<this._png.depth,s=(o,l)=>{const c=((o+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,u=(o*n.width+l)*this._png.channels;return{index:c,frameIndex:u}};switch(n.blendOp){case _j.SOURCE:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let d=0;d<this._png.channels;d++)r.data[c+d]=n.data[u+d]}break;case _j.OVER:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let d=0;d<this._png.channels;d++){const f=n.data[u+this._png.channels-1]/i,h=d%(this._png.channels-1)===0?1:n.data[u+d],p=Math.floor(f*h+(1-f)*r.data[c+d]);r.data[c+d]+=p}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==ZO.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Sj.NO_INTERLACE)this._png.data=QO({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Sj.ADAM7)this._png.data=tge({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Fb.NONE,blendOp:_j.SOURCE,data:r}),this._inflator=new KO,this._writingDataChunks=!1}}function xge(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var eM;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(eM||(eM={}));function yge(e,t){return new gge(e,t).decode()}var Qn=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function jj(){Qn.console&&typeof Qn.console.log=="function"&&Qn.console.log.apply(Qn.console,arguments)}var na={log:jj,warn:function(e){Qn.console&&(typeof Qn.console.warn=="function"?Qn.console.warn.apply(Qn.console,arguments):jj.call(null,arguments))},error:function(e){Qn.console&&(typeof Qn.console.error=="function"?Qn.console.error.apply(Qn.console,arguments):jj(e))}};function kj(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){$h(n.response,t,r)},n.onerror=function(){na.error("could not download file")},n.send()}function tM(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function Bb(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var $h=Qn.saveAs||((typeof window>"u"?"undefined":Hi(window))!=="object"||window!==Qn?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=Qn.URL||Qn.webkitURL,i=document.createElement("a");t=t||e.name||"download",i.download=t,i.rel="noopener",typeof e=="string"?(i.href=e,i.origin!==location.origin?tM(i.href)?kj(e,t,r):Bb(i,i.target="_blank"):Bb(i)):(i.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){Bb(i)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(tM(e))kj(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){Bb(n)})}else navigator.msSaveOrOpenBlob(function(i,s){return s===void 0?s={autoBom:!1}:Hi(s)!=="object"&&(na.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return kj(e,t,r);var i=e.type==="application/octet-stream",s=/constructor/i.test(Qn.HTMLElement)||Qn.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||i&&s)&&(typeof FileReader>"u"?"undefined":Hi(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var d=l.result;d=o?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},l.readAsDataURL(e)}else{var c=Qn.URL||Qn.webkitURL,u=c.createObjectURL(e);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Pz(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,s=r[n].process,o=i.exec(e);o&&(t=s(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}var Wv=Qn.atob.bind(Qn),rM=Qn.btoa.bind(Qn);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Aj(e,t){var r=e[0],n=e[1],i=e[2],s=e[3];r=Co(r,n,i,s,t[0],7,-680876936),s=Co(s,r,n,i,t[1],12,-389564586),i=Co(i,s,r,n,t[2],17,606105819),n=Co(n,i,s,r,t[3],22,-1044525330),r=Co(r,n,i,s,t[4],7,-176418897),s=Co(s,r,n,i,t[5],12,1200080426),i=Co(i,s,r,n,t[6],17,-1473231341),n=Co(n,i,s,r,t[7],22,-45705983),r=Co(r,n,i,s,t[8],7,1770035416),s=Co(s,r,n,i,t[9],12,-1958414417),i=Co(i,s,r,n,t[10],17,-42063),n=Co(n,i,s,r,t[11],22,-1990404162),r=Co(r,n,i,s,t[12],7,1804603682),s=Co(s,r,n,i,t[13],12,-40341101),i=Co(i,s,r,n,t[14],17,-1502002290),r=Eo(r,n=Co(n,i,s,r,t[15],22,1236535329),i,s,t[1],5,-165796510),s=Eo(s,r,n,i,t[6],9,-1069501632),i=Eo(i,s,r,n,t[11],14,643717713),n=Eo(n,i,s,r,t[0],20,-373897302),r=Eo(r,n,i,s,t[5],5,-701558691),s=Eo(s,r,n,i,t[10],9,38016083),i=Eo(i,s,r,n,t[15],14,-660478335),n=Eo(n,i,s,r,t[4],20,-405537848),r=Eo(r,n,i,s,t[9],5,568446438),s=Eo(s,r,n,i,t[14],9,-1019803690),i=Eo(i,s,r,n,t[3],14,-187363961),n=Eo(n,i,s,r,t[8],20,1163531501),r=Eo(r,n,i,s,t[13],5,-1444681467),s=Eo(s,r,n,i,t[2],9,-51403784),i=Eo(i,s,r,n,t[7],14,1735328473),r=To(r,n=Eo(n,i,s,r,t[12],20,-1926607734),i,s,t[5],4,-378558),s=To(s,r,n,i,t[8],11,-2022574463),i=To(i,s,r,n,t[11],16,1839030562),n=To(n,i,s,r,t[14],23,-35309556),r=To(r,n,i,s,t[1],4,-1530992060),s=To(s,r,n,i,t[4],11,1272893353),i=To(i,s,r,n,t[7],16,-155497632),n=To(n,i,s,r,t[10],23,-1094730640),r=To(r,n,i,s,t[13],4,681279174),s=To(s,r,n,i,t[0],11,-358537222),i=To(i,s,r,n,t[3],16,-722521979),n=To(n,i,s,r,t[6],23,76029189),r=To(r,n,i,s,t[9],4,-640364487),s=To(s,r,n,i,t[12],11,-421815835),i=To(i,s,r,n,t[15],16,530742520),r=Po(r,n=To(n,i,s,r,t[2],23,-995338651),i,s,t[0],6,-198630844),s=Po(s,r,n,i,t[7],10,1126891415),i=Po(i,s,r,n,t[14],15,-1416354905),n=Po(n,i,s,r,t[5],21,-57434055),r=Po(r,n,i,s,t[12],6,1700485571),s=Po(s,r,n,i,t[3],10,-1894986606),i=Po(i,s,r,n,t[10],15,-1051523),n=Po(n,i,s,r,t[1],21,-2054922799),r=Po(r,n,i,s,t[8],6,1873313359),s=Po(s,r,n,i,t[15],10,-30611744),i=Po(i,s,r,n,t[6],15,-1560198380),n=Po(n,i,s,r,t[13],21,1309151649),r=Po(r,n,i,s,t[4],6,-145523070),s=Po(s,r,n,i,t[11],10,-1120210379),i=Po(i,s,r,n,t[2],15,718787259),n=Po(n,i,s,r,t[9],21,-343485551),e[0]=Kf(r,e[0]),e[1]=Kf(n,e[1]),e[2]=Kf(i,e[2]),e[3]=Kf(s,e[3])}function FS(e,t,r,n,i,s){return t=Kf(Kf(t,e),Kf(n,s)),Kf(t<<i|t>>>32-i,r)}function Co(e,t,r,n,i,s,o){return FS(t&r|~t&n,e,t,i,s,o)}function Eo(e,t,r,n,i,s,o){return FS(t&n|r&~n,e,t,i,s,o)}function To(e,t,r,n,i,s,o){return FS(t^r^n,e,t,i,s,o)}function Po(e,t,r,n,i,s,o){return FS(r^(t|~n),e,t,i,s,o)}function Oz(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Aj(n,bge(e.substring(t-64,t)));e=e.substring(t-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)i[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(i[t>>2]|=128<<(t%4<<3),t>55)for(Aj(n,i),t=0;t<16;t++)i[t]=0;return i[14]=8*r,Aj(n,i),n}function bge(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var nM="0123456789abcdef".split("");function vge(e){for(var t="",r=0;r<4;r++)t+=nM[e>>8*r+4&15]+nM[e>>8*r&15];return t}function wge(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function nA(e){return Oz(e).map(wge).join("")}var Sge=function(e){for(var t=0;t<e.length;t++)e[t]=vge(e[t]);return e.join("")}(Oz("hello"))!="5d41402abc4b2a76b9719d911017c592";function Kf(e,t){if(Sge){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function iA(e,t){var r,n,i,s;if(e!==r){for(var o=(i=e,s=1+(256/e.length|0),new Array(s+1).join(i)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var d=l[c];u=(u+d+o.charCodeAt(c))%256,l[c]=l[u],l[u]=d}r=e,n=l}else l=n;var f=t.length,h=0,p=0,m="";for(c=0;c<f;c++)p=(p+(d=l[h=(h+1)%256]))%256,l[h]=l[p],l[p]=d,o=l[(l[h]+l[p])%256],m+=String.fromCharCode(t.charCodeAt(c)^o);return m}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var iM={print:4,modify:8,copy:16,"annot-forms":32};function Bp(e,t,r,n){this.v=1,this.r=2;var i=192;e.forEach(function(l){if(iM.perm!==void 0)throw new Error("Invalid permission: "+l);i+=iM[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(t+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^i)),this.encryptionKey=nA(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=iA(this.encryptionKey,this.padding)}function Ip(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var i=e.charCodeAt(n);t+=i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?"#"+("0"+i.toString(16)).slice(-2):e[n]}return t}function aM(e){if(Hi(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var s=Math.random().toString(35);return t[r][s]=[n,!!i],s},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var s in t[r]){var o=t[r][s];try{o[0].apply(e,n)}catch(l){Qn.console&&na.error("jsPDF PubSub Error",l.message,l)}o[1]&&i.push(s)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function X2(e){if(!(this instanceof X2))return new X2(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function Mz(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Hh(e,t,r,n,i){if(!(this instanceof Hh))return new Hh(e,t,r,n,i);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,Mz.call(this,n,i)}function rm(e,t,r,n,i){if(!(this instanceof rm))return new rm(e,t,r,n,i);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,Mz.call(this,n,i)}function Un(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],s=arguments[3],o=[],l=1,c=16,u="S",d=null;Hi(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,i=e.format||i,s=e.compress||e.compressPdf||s,(d=e.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),l=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),u=e.defaultPathOperation||"S"),o=e.filters||(s===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var f=e.putOnlyUsedFonts||!1,h={},p={internal:{},__private__:{}};p.__private__.PubSub=aM;var m="1.3",g=p.__private__.getPdfVersion=function(){return m};p.__private__.setPdfVersion=function(L){m=L};var y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};p.__private__.getPageFormats=function(){return y};var b=p.__private__.getPageFormat=function(L){return y[L]};i=i||"a4";var v="compat",w="advanced",S=v;function j(){this.saveGraphicsState(),D(new qe(ce,0,0,-ce,0,Rn()*ce).toString()+" cm"),this.setFontSize(this.getFontSize()/ce),u="n",S=w}function k(){this.restoreGraphicsState(),u="S",S=v}var A=p.__private__.combineFontStyleAndFontWeight=function(L,le){if(L=="bold"&&le=="normal"||L=="bold"&&le==400||L=="normal"&&le=="italic"||L=="bold"&&le=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return le&&(L=le==400||le==="normal"?L==="italic"?"italic":"normal":le!=700&&le!=="bold"||L!=="normal"?(le==700?"bold":le)+""+L:"bold"),L};p.advancedAPI=function(L){var le=S===v;return le&&j.call(this),typeof L!="function"||(L(this),le&&k.call(this)),this},p.compatAPI=function(L){var le=S===w;return le&&k.call(this),typeof L!="function"||(L(this),le&&j.call(this)),this},p.isAdvancedAPI=function(){return S===w};var R,M=function(L){if(S!==w)throw new Error(L+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},B=p.roundToPrecision=p.__private__.roundToPrecision=function(L,le){var Oe=t||le;if(isNaN(L)||isNaN(Oe))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return L.toFixed(Oe).replace(/0+$/,"")};R=p.hpf=p.__private__.hpf=typeof c=="number"?function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.hpf");return B(L,c)}:c==="smart"?function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.hpf");return B(L,L>-1&&L<1?16:5)}:function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.hpf");return B(L,16)};var E=p.f2=p.__private__.f2=function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.f2");return B(L,2)},P=p.__private__.f3=function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.f3");return B(L,3)},U=p.scale=p.__private__.scale=function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.scale");return S===v?L*ce:S===w?L:void 0},G=function(L){return U(function(le){return S===v?Rn()-le:S===w?le:void 0}(L))};p.__private__.setPrecision=p.setPrecision=function(L){typeof parseInt(L,10)=="number"&&(t=parseInt(L,10))};var H,oe="00000000000000000000000000000000",de=p.__private__.getFileId=function(){return oe},W=p.__private__.setFileId=function(L){return oe=L!==void 0&&/^[a-fA-F0-9]{32}$/.test(L)?L.toUpperCase():oe.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(br=new Bp(d.userPermissions,d.userPassword,d.ownerPassword,oe)),oe};p.setFileId=function(L){return W(L),this},p.getFileId=function(){return de()};var V=p.__private__.convertDateToPDFDate=function(L){var le=L.getTimezoneOffset(),Oe=le<0?"+":"-",rt=Math.floor(Math.abs(le/60)),Et=Math.abs(le%60),hr=[Oe,q(rt),"'",q(Et),"'"].join("");return["D:",L.getFullYear(),q(L.getMonth()+1),q(L.getDate()),q(L.getHours()),q(L.getMinutes()),q(L.getSeconds()),hr].join("")},ae=p.__private__.convertPDFDateToDate=function(L){var le=parseInt(L.substr(2,4),10),Oe=parseInt(L.substr(6,2),10)-1,rt=parseInt(L.substr(8,2),10),Et=parseInt(L.substr(10,2),10),hr=parseInt(L.substr(12,2),10),ir=parseInt(L.substr(14,2),10);return new Date(le,Oe,rt,Et,hr,ir,0)},ee=p.__private__.setCreationDate=function(L){var le;if(L===void 0&&(L=new Date),L instanceof Date)le=V(L);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(L))throw new Error("Invalid argument passed to jsPDF.setCreationDate");le=L}return H=le},C=p.__private__.getCreationDate=function(L){var le=H;return L==="jsDate"&&(le=ae(H)),le};p.setCreationDate=function(L){return ee(L),this},p.getCreationDate=function(L){return C(L)};var Y,q=p.__private__.padd2=function(L){return("0"+parseInt(L)).slice(-2)},O=p.__private__.padd2Hex=function(L){return("00"+(L=L.toString())).substr(L.length)},X=0,F=[],Q=[],K=0,ne=[],re=[],T=!1,I=Q;p.__private__.setCustomOutputDestination=function(L){T=!0,I=L};var ie=function(L){T||(I=L)};p.__private__.resetCustomOutputDestination=function(){T=!1,I=Q};var D=p.__private__.out=function(L){return L=L.toString(),K+=L.length+1,I.push(L),I},Z=p.__private__.write=function(L){return D(arguments.length===1?L.toString():Array.prototype.join.call(arguments," "))},me=p.__private__.getArrayBuffer=function(L){for(var le=L.length,Oe=new ArrayBuffer(le),rt=new Uint8Array(Oe);le--;)rt[le]=L.charCodeAt(le);return Oe},Te=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];p.__private__.getStandardFonts=function(){return Te};var je=e.fontSize||16;p.__private__.setFontSize=p.setFontSize=function(L){return je=S===w?L/ce:L,this};var Le,_e=p.__private__.getFontSize=p.getFontSize=function(){return S===v?je:je*ce},He=e.R2L||!1;p.__private__.setR2L=p.setR2L=function(L){return He=L,this},p.__private__.getR2L=p.getR2L=function(){return He};var We,Pt=p.__private__.setZoomMode=function(L){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(L))Le=L;else if(isNaN(L)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(L)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+L+'" is not recognized.');Le=L}else Le=parseInt(L,10)};p.__private__.getZoomMode=function(){return Le};var dt,Ye=p.__private__.setPageMode=function(L){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(L)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+L+'" is not recognized.');We=L};p.__private__.getPageMode=function(){return We};var lt=p.__private__.setLayoutMode=function(L){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(L)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+L+'" is not recognized.');dt=L};p.__private__.getLayoutMode=function(){return dt},p.__private__.setDisplayMode=p.setDisplayMode=function(L,le,Oe){return Pt(L),lt(le),Ye(Oe),this};var be={title:"",subject:"",author:"",keywords:"",creator:""};p.__private__.getDocumentProperty=function(L){if(Object.keys(be).indexOf(L)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return be[L]},p.__private__.getDocumentProperties=function(){return be},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(L){for(var le in be)be.hasOwnProperty(le)&&L[le]&&(be[le]=L[le]);return this},p.__private__.setDocumentProperty=function(L,le){if(Object.keys(be).indexOf(L)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return be[L]=le};var ke,ce,we,ht,nt,Ie={},It={},ct=[],Mt={},xr={},Pr={},Nt={},Jr=null,Ur=0,qr=[],cn=new aM(p),Pn=e.hotfixes||[],Lr={},mn={},Me=[],qe=function L(le,Oe,rt,Et,hr,ir){if(!(this instanceof L))return new L(le,Oe,rt,Et,hr,ir);isNaN(le)&&(le=1),isNaN(Oe)&&(Oe=0),isNaN(rt)&&(rt=0),isNaN(Et)&&(Et=1),isNaN(hr)&&(hr=0),isNaN(ir)&&(ir=0),this._matrix=[le,Oe,rt,Et,hr,ir]};Object.defineProperty(qe.prototype,"sx",{get:function(){return this._matrix[0]},set:function(L){this._matrix[0]=L}}),Object.defineProperty(qe.prototype,"shy",{get:function(){return this._matrix[1]},set:function(L){this._matrix[1]=L}}),Object.defineProperty(qe.prototype,"shx",{get:function(){return this._matrix[2]},set:function(L){this._matrix[2]=L}}),Object.defineProperty(qe.prototype,"sy",{get:function(){return this._matrix[3]},set:function(L){this._matrix[3]=L}}),Object.defineProperty(qe.prototype,"tx",{get:function(){return this._matrix[4]},set:function(L){this._matrix[4]=L}}),Object.defineProperty(qe.prototype,"ty",{get:function(){return this._matrix[5]},set:function(L){this._matrix[5]=L}}),Object.defineProperty(qe.prototype,"a",{get:function(){return this._matrix[0]},set:function(L){this._matrix[0]=L}}),Object.defineProperty(qe.prototype,"b",{get:function(){return this._matrix[1]},set:function(L){this._matrix[1]=L}}),Object.defineProperty(qe.prototype,"c",{get:function(){return this._matrix[2]},set:function(L){this._matrix[2]=L}}),Object.defineProperty(qe.prototype,"d",{get:function(){return this._matrix[3]},set:function(L){this._matrix[3]=L}}),Object.defineProperty(qe.prototype,"e",{get:function(){return this._matrix[4]},set:function(L){this._matrix[4]=L}}),Object.defineProperty(qe.prototype,"f",{get:function(){return this._matrix[5]},set:function(L){this._matrix[5]=L}}),Object.defineProperty(qe.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(qe.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(qe.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(qe.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),qe.prototype.join=function(L){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(R).join(L)},qe.prototype.multiply=function(L){var le=L.sx*this.sx+L.shy*this.shx,Oe=L.sx*this.shy+L.shy*this.sy,rt=L.shx*this.sx+L.sy*this.shx,Et=L.shx*this.shy+L.sy*this.sy,hr=L.tx*this.sx+L.ty*this.shx+this.tx,ir=L.tx*this.shy+L.ty*this.sy+this.ty;return new qe(le,Oe,rt,Et,hr,ir)},qe.prototype.decompose=function(){var L=this.sx,le=this.shy,Oe=this.shx,rt=this.sy,Et=this.tx,hr=this.ty,ir=Math.sqrt(L*L+le*le),wr=(L/=ir)*Oe+(le/=ir)*rt;Oe-=L*wr,rt-=le*wr;var Wr=Math.sqrt(Oe*Oe+rt*rt);return wr/=Wr,L*(rt/=Wr)<le*(Oe/=Wr)&&(L=-L,le=-le,wr=-wr,ir=-ir),{scale:new qe(ir,0,0,Wr,0,0),translate:new qe(1,0,0,1,Et,hr),rotate:new qe(L,le,-le,L,0,0),skew:new qe(1,0,wr,1,0,0)}},qe.prototype.toString=function(L){return this.join(" ")},qe.prototype.inversed=function(){var L=this.sx,le=this.shy,Oe=this.shx,rt=this.sy,Et=this.tx,hr=this.ty,ir=1/(L*rt-le*Oe),wr=rt*ir,Wr=-le*ir,Xr=-Oe*ir,dn=L*ir;return new qe(wr,Wr,Xr,dn,-wr*Et-Xr*hr,-Wr*Et-dn*hr)},qe.prototype.applyToPoint=function(L){var le=L.x*this.sx+L.y*this.shx+this.tx,Oe=L.x*this.shy+L.y*this.sy+this.ty;return new an(le,Oe)},qe.prototype.applyToRectangle=function(L){var le=this.applyToPoint(L),Oe=this.applyToPoint(new an(L.x+L.w,L.y+L.h));return new bn(le.x,le.y,Oe.x-le.x,Oe.y-le.y)},qe.prototype.clone=function(){var L=this.sx,le=this.shy,Oe=this.shx,rt=this.sy,Et=this.tx,hr=this.ty;return new qe(L,le,Oe,rt,Et,hr)},p.Matrix=qe;var ut=p.matrixMult=function(L,le){return le.multiply(L)},wt=new qe(1,0,0,1,0,0);p.unitMatrix=p.identityMatrix=wt;var At=function(L,le){if(!xr[L]){var Oe=(le instanceof Hh?"Sh":"P")+(Object.keys(Mt).length+1).toString(10);le.id=Oe,xr[L]=Oe,Mt[Oe]=le,cn.publish("addPattern",le)}};p.ShadingPattern=Hh,p.TilingPattern=rm,p.addShadingPattern=function(L,le){return M("addShadingPattern()"),At(L,le),this},p.beginTilingPattern=function(L){M("beginTilingPattern()"),st(L.boundingBox[0],L.boundingBox[1],L.boundingBox[2]-L.boundingBox[0],L.boundingBox[3]-L.boundingBox[1],L.matrix)},p.endTilingPattern=function(L,le){M("endTilingPattern()"),le.stream=re[Y].join(`
`),At(L,le),cn.publish("endTilingPattern",le),Me.pop().restore()};var sr,Zt=p.__private__.newObject=function(){var L=Cr();return se(L,!0),L},Cr=p.__private__.newObjectDeferred=function(){return X++,F[X]=function(){return K},X},se=function(L,le){return le=typeof le=="boolean"&&le,F[L]=K,le&&D(L+" 0 obj"),L},ue=p.__private__.newAdditionalObject=function(){var L={objId:Cr(),content:""};return ne.push(L),L},J=Cr(),pe=Cr(),xe=p.__private__.decodeColorString=function(L){var le=L.split(" ");if(le.length!==2||le[1]!=="g"&&le[1]!=="G")le.length!==5||le[4]!=="k"&&le[4]!=="K"||(le=[(1-le[0])*(1-le[3]),(1-le[1])*(1-le[3]),(1-le[2])*(1-le[3]),"r"]);else{var Oe=parseFloat(le[0]);le=[Oe,Oe,Oe,"r"]}for(var rt="#",Et=0;Et<3;Et++)rt+=("0"+Math.floor(255*parseFloat(le[Et])).toString(16)).slice(-2);return rt},Ne=p.__private__.encodeColorString=function(L){var le;typeof L=="string"&&(L={ch1:L});var Oe=L.ch1,rt=L.ch2,Et=L.ch3,hr=L.ch4,ir=L.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Oe=="string"&&Oe.charAt(0)!=="#"){var wr=new Pz(Oe);if(wr.ok)Oe=wr.toHex();else if(!/^\d*\.?\d*$/.test(Oe))throw new Error('Invalid color "'+Oe+'" passed to jsPDF.encodeColorString.')}if(typeof Oe=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Oe)&&(Oe="#"+Oe[1]+Oe[1]+Oe[2]+Oe[2]+Oe[3]+Oe[3]),typeof Oe=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Oe)){var Wr=parseInt(Oe.substr(1),16);Oe=Wr>>16&255,rt=Wr>>8&255,Et=255&Wr}if(rt===void 0||hr===void 0&&Oe===rt&&rt===Et)le=typeof Oe=="string"?Oe+" "+ir[0]:L.precision===2?E(Oe/255)+" "+ir[0]:P(Oe/255)+" "+ir[0];else if(hr===void 0||Hi(hr)==="object"){if(hr&&!isNaN(hr.a)&&hr.a===0)return["1.","1.","1.",ir[1]].join(" ");le=typeof Oe=="string"?[Oe,rt,Et,ir[1]].join(" "):L.precision===2?[E(Oe/255),E(rt/255),E(Et/255),ir[1]].join(" "):[P(Oe/255),P(rt/255),P(Et/255),ir[1]].join(" ")}else le=typeof Oe=="string"?[Oe,rt,Et,hr,ir[2]].join(" "):L.precision===2?[E(Oe),E(rt),E(Et),E(hr),ir[2]].join(" "):[P(Oe),P(rt),P(Et),P(hr),ir[2]].join(" ");return le},St=p.__private__.getFilters=function(){return o},Ve=p.__private__.putStream=function(L){var le=(L=L||{}).data||"",Oe=L.filters||St(),rt=L.alreadyAppliedFilters||[],Et=L.addLength1||!1,hr=le.length,ir=L.objectId,wr=function(Ee){return Ee};if(d!==null&&ir===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(wr=br.encryptor(ir,0));var Wr={};Oe===!0&&(Oe=["FlateEncode"]);var Xr=L.additionalKeyValues||[],dn=(Wr=Un.API.processDataByFilters!==void 0?Un.API.processDataByFilters(le,Oe):{data:le,reverseChain:[]}).reverseChain+(Array.isArray(rt)?rt.join(" "):rt.toString());if(Wr.data.length!==0&&(Xr.push({key:"Length",value:Wr.data.length}),Et===!0&&Xr.push({key:"Length1",value:hr})),dn.length!=0)if(dn.split("/").length-1==1)Xr.push({key:"Filter",value:dn});else{Xr.push({key:"Filter",value:"["+dn+"]"});for(var Ln=0;Ln<Xr.length;Ln+=1)if(Xr[Ln].key==="DecodeParms"){for(var si=[],Ir=0;Ir<Wr.reverseChain.split("/").length-1;Ir+=1)si.push("null");si.push(Xr[Ln].value),Xr[Ln].value="["+si.join(" ")+"]"}}D("<<");for(var fe=0;fe<Xr.length;fe++)D("/"+Xr[fe].key+" "+Xr[fe].value);D(">>"),Wr.data.length!==0&&(D("stream"),D(wr(Wr.data)),D("endstream"))},De=p.__private__.putPage=function(L){var le=L.number,Oe=L.data,rt=L.objId,Et=L.contentsObjId;se(rt,!0),D("<</Type /Page"),D("/Parent "+L.rootDictionaryObjId+" 0 R"),D("/Resources "+L.resourceDictionaryObjId+" 0 R"),D("/MediaBox ["+parseFloat(R(L.mediaBox.bottomLeftX))+" "+parseFloat(R(L.mediaBox.bottomLeftY))+" "+R(L.mediaBox.topRightX)+" "+R(L.mediaBox.topRightY)+"]"),L.cropBox!==null&&D("/CropBox ["+R(L.cropBox.bottomLeftX)+" "+R(L.cropBox.bottomLeftY)+" "+R(L.cropBox.topRightX)+" "+R(L.cropBox.topRightY)+"]"),L.bleedBox!==null&&D("/BleedBox ["+R(L.bleedBox.bottomLeftX)+" "+R(L.bleedBox.bottomLeftY)+" "+R(L.bleedBox.topRightX)+" "+R(L.bleedBox.topRightY)+"]"),L.trimBox!==null&&D("/TrimBox ["+R(L.trimBox.bottomLeftX)+" "+R(L.trimBox.bottomLeftY)+" "+R(L.trimBox.topRightX)+" "+R(L.trimBox.topRightY)+"]"),L.artBox!==null&&D("/ArtBox ["+R(L.artBox.bottomLeftX)+" "+R(L.artBox.bottomLeftY)+" "+R(L.artBox.topRightX)+" "+R(L.artBox.topRightY)+"]"),typeof L.userUnit=="number"&&L.userUnit!==1&&D("/UserUnit "+L.userUnit),cn.publish("putPage",{objId:rt,pageContext:qr[le],pageNumber:le,page:Oe}),D("/Contents "+Et+" 0 R"),D(">>"),D("endobj");var hr=Oe.join(`
`);return S===w&&(hr+=`
Q`),se(Et,!0),Ve({data:hr,filters:St(),objectId:Et}),D("endobj"),rt},Re=p.__private__.putPages=function(){var L,le,Oe=[];for(L=1;L<=Ur;L++)qr[L].objId=Cr(),qr[L].contentsObjId=Cr();for(L=1;L<=Ur;L++)Oe.push(De({number:L,data:re[L],objId:qr[L].objId,contentsObjId:qr[L].contentsObjId,mediaBox:qr[L].mediaBox,cropBox:qr[L].cropBox,bleedBox:qr[L].bleedBox,trimBox:qr[L].trimBox,artBox:qr[L].artBox,userUnit:qr[L].userUnit,rootDictionaryObjId:J,resourceDictionaryObjId:pe}));se(J,!0),D("<</Type /Pages");var rt="/Kids [";for(le=0;le<Ur;le++)rt+=Oe[le]+" 0 R ";D(rt+"]"),D("/Count "+Ur),D(">>"),D("endobj"),cn.publish("postPutPages")},xt=function(L){cn.publish("putFont",{font:L,out:D,newObject:Zt,putStream:Ve}),L.isAlreadyPutted!==!0&&(L.objectNumber=Zt(),D("<<"),D("/Type /Font"),D("/BaseFont /"+Ip(L.postScriptName)),D("/Subtype /Type1"),typeof L.encoding=="string"&&D("/Encoding /"+L.encoding),D("/FirstChar 32"),D("/LastChar 255"),D(">>"),D("endobj"))},Vt=function(L){L.objectNumber=Zt();var le=[];le.push({key:"Type",value:"/XObject"}),le.push({key:"Subtype",value:"/Form"}),le.push({key:"BBox",value:"["+[R(L.x),R(L.y),R(L.x+L.width),R(L.y+L.height)].join(" ")+"]"}),le.push({key:"Matrix",value:"["+L.matrix.toString()+"]"});var Oe=L.pages[1].join(`
`);Ve({data:Oe,additionalKeyValues:le,objectId:L.objectNumber}),D("endobj")},qt=function(L,le){le||(le=21);var Oe=Zt(),rt=function(ir,wr){var Wr,Xr=[],dn=1/(wr-1);for(Wr=0;Wr<1;Wr+=dn)Xr.push(Wr);if(Xr.push(1),ir[0].offset!=0){var Ln={offset:0,color:ir[0].color};ir.unshift(Ln)}if(ir[ir.length-1].offset!=1){var si={offset:1,color:ir[ir.length-1].color};ir.push(si)}for(var Ir="",fe=0,Ee=0;Ee<Xr.length;Ee++){for(Wr=Xr[Ee];Wr>ir[fe+1].offset;)fe++;var et=ir[fe].offset,Be=(Wr-et)/(ir[fe+1].offset-et),kt=ir[fe].color,ar=ir[fe+1].color;Ir+=O(Math.round((1-Be)*kt[0]+Be*ar[0]).toString(16))+O(Math.round((1-Be)*kt[1]+Be*ar[1]).toString(16))+O(Math.round((1-Be)*kt[2]+Be*ar[2]).toString(16))}return Ir.trim()}(L.colors,le),Et=[];Et.push({key:"FunctionType",value:"0"}),Et.push({key:"Domain",value:"[0.0 1.0]"}),Et.push({key:"Size",value:"["+le+"]"}),Et.push({key:"BitsPerSample",value:"8"}),Et.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Et.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ve({data:rt,additionalKeyValues:Et,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Oe}),D("endobj"),L.objectNumber=Zt(),D("<< /ShadingType "+L.type),D("/ColorSpace /DeviceRGB");var hr="/Coords ["+R(parseFloat(L.coords[0]))+" "+R(parseFloat(L.coords[1]))+" ";L.type===2?hr+=R(parseFloat(L.coords[2]))+" "+R(parseFloat(L.coords[3])):hr+=R(parseFloat(L.coords[2]))+" "+R(parseFloat(L.coords[3]))+" "+R(parseFloat(L.coords[4]))+" "+R(parseFloat(L.coords[5])),D(hr+="]"),L.matrix&&D("/Matrix ["+L.matrix.toString()+"]"),D("/Function "+Oe+" 0 R"),D("/Extend [true true]"),D(">>"),D("endobj")},zt=function(L,le){var Oe=Cr(),rt=Zt();le.push({resourcesOid:Oe,objectOid:rt}),L.objectNumber=rt;var Et=[];Et.push({key:"Type",value:"/Pattern"}),Et.push({key:"PatternType",value:"1"}),Et.push({key:"PaintType",value:"1"}),Et.push({key:"TilingType",value:"1"}),Et.push({key:"BBox",value:"["+L.boundingBox.map(R).join(" ")+"]"}),Et.push({key:"XStep",value:R(L.xStep)}),Et.push({key:"YStep",value:R(L.yStep)}),Et.push({key:"Resources",value:Oe+" 0 R"}),L.matrix&&Et.push({key:"Matrix",value:"["+L.matrix.toString()+"]"}),Ve({data:L.stream,additionalKeyValues:Et,objectId:L.objectNumber}),D("endobj")},vt=function(L){for(var le in L.objectNumber=Zt(),D("<<"),L)switch(le){case"opacity":D("/ca "+E(L[le]));break;case"stroke-opacity":D("/CA "+E(L[le]))}D(">>"),D("endobj")},Lt=function(L){se(L.resourcesOid,!0),D("<<"),D("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var le in D("/Font <<"),Ie)Ie.hasOwnProperty(le)&&(f===!1||f===!0&&h.hasOwnProperty(le))&&D("/"+le+" "+Ie[le].objectNumber+" 0 R");D(">>")}(),function(){if(Object.keys(Mt).length>0){for(var le in D("/Shading <<"),Mt)Mt.hasOwnProperty(le)&&Mt[le]instanceof Hh&&Mt[le].objectNumber>=0&&D("/"+le+" "+Mt[le].objectNumber+" 0 R");cn.publish("putShadingPatternDict"),D(">>")}}(),function(le){if(Object.keys(Mt).length>0){for(var Oe in D("/Pattern <<"),Mt)Mt.hasOwnProperty(Oe)&&Mt[Oe]instanceof p.TilingPattern&&Mt[Oe].objectNumber>=0&&Mt[Oe].objectNumber<le&&D("/"+Oe+" "+Mt[Oe].objectNumber+" 0 R");cn.publish("putTilingPatternDict"),D(">>")}}(L.objectOid),function(){if(Object.keys(Pr).length>0){var le;for(le in D("/ExtGState <<"),Pr)Pr.hasOwnProperty(le)&&Pr[le].objectNumber>=0&&D("/"+le+" "+Pr[le].objectNumber+" 0 R");cn.publish("putGStateDict"),D(">>")}}(),function(){for(var le in D("/XObject <<"),Lr)Lr.hasOwnProperty(le)&&Lr[le].objectNumber>=0&&D("/"+le+" "+Lr[le].objectNumber+" 0 R");cn.publish("putXobjectDict"),D(">>")}(),D(">>"),D("endobj")},er=function(L){It[L.fontName]=It[L.fontName]||{},It[L.fontName][L.fontStyle]=L.id},yr=function(L,le,Oe,rt,Et){var hr={id:"F"+(Object.keys(Ie).length+1).toString(10),postScriptName:L,fontName:le,fontStyle:Oe,encoding:rt,isStandardFont:Et||!1,metadata:{}};return cn.publish("addFont",{font:hr,instance:this}),Ie[hr.id]=hr,er(hr),hr.id},Br=p.__private__.pdfEscape=p.pdfEscape=function(L,le){return function(Oe,rt){var Et,hr,ir,wr,Wr,Xr,dn,Ln,si;if(ir=(rt=rt||{}).sourceEncoding||"Unicode",Wr=rt.outputEncoding,(rt.autoencode||Wr)&&Ie[ke].metadata&&Ie[ke].metadata[ir]&&Ie[ke].metadata[ir].encoding&&(wr=Ie[ke].metadata[ir].encoding,!Wr&&Ie[ke].encoding&&(Wr=Ie[ke].encoding),!Wr&&wr.codePages&&(Wr=wr.codePages[0]),typeof Wr=="string"&&(Wr=wr[Wr]),Wr)){for(dn=!1,Xr=[],Et=0,hr=Oe.length;Et<hr;Et++)(Ln=Wr[Oe.charCodeAt(Et)])?Xr.push(String.fromCharCode(Ln)):Xr.push(Oe[Et]),Xr[Et].charCodeAt(0)>>8&&(dn=!0);Oe=Xr.join("")}for(Et=Oe.length;dn===void 0&&Et!==0;)Oe.charCodeAt(Et-1)>>8&&(dn=!0),Et--;if(!dn)return Oe;for(Xr=rt.noBOM?[]:[254,255],Et=0,hr=Oe.length;Et<hr;Et++){if((si=(Ln=Oe.charCodeAt(Et))>>8)>>8)throw new Error("Character at position "+Et+" of string '"+Oe+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Xr.push(si),Xr.push(Ln-(si<<8))}return String.fromCharCode.apply(void 0,Xr)}(L,le).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},cr=p.__private__.beginPage=function(L){re[++Ur]=[],qr[Ur]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(L[0]),topRightY:Number(L[1])}},nn(Ur),ie(re[Y])},ur=function(L,le){var Oe,rt,Et;switch(r=le||r,typeof L=="string"&&(Oe=b(L.toLowerCase()),Array.isArray(Oe)&&(rt=Oe[0],Et=Oe[1])),Array.isArray(L)&&(rt=L[0]*ce,Et=L[1]*ce),isNaN(rt)&&(rt=i[0],Et=i[1]),(rt>14400||Et>14400)&&(na.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),rt=Math.min(14400,rt),Et=Math.min(14400,Et)),i=[rt,Et],r.substr(0,1)){case"l":Et>rt&&(i=[Et,rt]);break;case"p":rt>Et&&(i=[Et,rt])}cr(i),ft(Ce),D(yt),Sn!==0&&D(Sn+" J"),Gr!==0&&D(Gr+" j"),cn.publish("addPage",{pageNumber:Ur})},en=function(L){L>0&&L<=Ur&&(re.splice(L,1),qr.splice(L,1),Ur--,Y>Ur&&(Y=Ur),this.setPage(Y))},nn=function(L){L>0&&L<=Ur&&(Y=L)},gn=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return re.length-1},nr=function(L,le,Oe){var rt,Et=void 0;return Oe=Oe||{},L=L!==void 0?L:Ie[ke].fontName,le=le!==void 0?le:Ie[ke].fontStyle,rt=L.toLowerCase(),It[rt]!==void 0&&It[rt][le]!==void 0?Et=It[rt][le]:It[L]!==void 0&&It[L][le]!==void 0?Et=It[L][le]:Oe.disableWarning===!1&&na.warn("Unable to look up font label for font '"+L+"', '"+le+"'. Refer to getFontList() for available fonts."),Et||Oe.noFallback||(Et=It.times[le])==null&&(Et=It.times.normal),Et},Tr=p.__private__.putInfo=function(){var L=Zt(),le=function(rt){return rt};for(var Oe in d!==null&&(le=br.encryptor(L,0)),D("<<"),D("/Producer ("+Br(le("jsPDF "+Un.version))+")"),be)be.hasOwnProperty(Oe)&&be[Oe]&&D("/"+Oe.substr(0,1).toUpperCase()+Oe.substr(1)+" ("+Br(le(be[Oe]))+")");D("/CreationDate ("+Br(le(H))+")"),D(">>"),D("endobj")},Dr=p.__private__.putCatalog=function(L){var le=(L=L||{}).rootDictionaryObjId||J;switch(Zt(),D("<<"),D("/Type /Catalog"),D("/Pages "+le+" 0 R"),Le||(Le="fullwidth"),Le){case"fullwidth":D("/OpenAction [3 0 R /FitH null]");break;case"fullheight":D("/OpenAction [3 0 R /FitV null]");break;case"fullpage":D("/OpenAction [3 0 R /Fit]");break;case"original":D("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Oe=""+Le;Oe.substr(Oe.length-1)==="%"&&(Le=parseInt(Le)/100),typeof Le=="number"&&D("/OpenAction [3 0 R /XYZ null null "+E(Le)+"]")}switch(dt||(dt="continuous"),dt){case"continuous":D("/PageLayout /OneColumn");break;case"single":D("/PageLayout /SinglePage");break;case"two":case"twoleft":D("/PageLayout /TwoColumnLeft");break;case"tworight":D("/PageLayout /TwoColumnRight")}We&&D("/PageMode /"+We),cn.publish("putCatalog"),D(">>"),D("endobj")},Rr=p.__private__.putTrailer=function(){D("trailer"),D("<<"),D("/Size "+(X+1)),D("/Root "+X+" 0 R"),D("/Info "+(X-1)+" 0 R"),d!==null&&D("/Encrypt "+br.oid+" 0 R"),D("/ID [ <"+oe+"> <"+oe+"> ]"),D(">>")},tt=p.__private__.putHeader=function(){D("%PDF-"+m),D("%")},Xe=p.__private__.putXRef=function(){var L="0000000000";D("xref"),D("0 "+(X+1)),D("0000000000 65535 f ");for(var le=1;le<=X;le++)typeof F[le]=="function"?D((L+F[le]()).slice(-10)+" 00000 n "):F[le]!==void 0?D((L+F[le]).slice(-10)+" 00000 n "):D("0000000000 00000 n ")},ot=p.__private__.buildDocument=function(){var L;X=0,K=0,Q=[],F=[],ne=[],J=Cr(),pe=Cr(),ie(Q),cn.publish("buildDocument"),tt(),Re(),function(){cn.publish("putAdditionalObjects");for(var Oe=0;Oe<ne.length;Oe++){var rt=ne[Oe];se(rt.objId,!0),D(rt.content),D("endobj")}cn.publish("postPutAdditionalObjects")}(),L=[],function(){for(var Oe in Ie)Ie.hasOwnProperty(Oe)&&(f===!1||f===!0&&h.hasOwnProperty(Oe))&&xt(Ie[Oe])}(),function(){var Oe;for(Oe in Pr)Pr.hasOwnProperty(Oe)&&vt(Pr[Oe])}(),function(){for(var Oe in Lr)Lr.hasOwnProperty(Oe)&&Vt(Lr[Oe])}(),function(Oe){var rt;for(rt in Mt)Mt.hasOwnProperty(rt)&&(Mt[rt]instanceof Hh?qt(Mt[rt]):Mt[rt]instanceof rm&&zt(Mt[rt],Oe))}(L),cn.publish("putResources"),L.forEach(Lt),Lt({resourcesOid:pe,objectOid:Number.MAX_SAFE_INTEGER}),cn.publish("postPutResources"),d!==null&&(br.oid=Zt(),D("<<"),D("/Filter /Standard"),D("/V "+br.v),D("/R "+br.r),D("/U <"+br.toHexString(br.U)+">"),D("/O <"+br.toHexString(br.O)+">"),D("/P "+br.P),D(">>"),D("endobj")),Tr(),Dr();var le=K;return Xe(),Rr(),D("startxref"),D(""+le),D("%%EOF"),ie(re[Y]),Q.join(`
`)},Wt=p.__private__.getBlob=function(L){return new Blob([me(L)],{type:"application/pdf"})},pr=p.output=p.__private__.output=(sr=function(L,le){switch(typeof(le=le||{})=="string"?le={filename:le}:le.filename=le.filename||"generated.pdf",L){case void 0:return ot();case"save":p.save(le.filename);break;case"arraybuffer":return me(ot());case"blob":return Wt(ot());case"bloburi":case"bloburl":if(Qn.URL!==void 0&&typeof Qn.URL.createObjectURL=="function")return Qn.URL&&Qn.URL.createObjectURL(Wt(ot()))||void 0;na.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Oe="",rt=ot();try{Oe=rM(rt)}catch{Oe=rM(unescape(encodeURIComponent(rt)))}return"data:application/pdf;filename="+le.filename+";base64,"+Oe;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Qn)==="[object Window]"){var Et="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",hr=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';le.pdfObjectUrl&&(Et=le.pdfObjectUrl,hr="");var ir='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Et+'"'+hr+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(le)+");<\/script></body></html>",wr=Qn.open();return wr!==null&&wr.document.write(ir),wr}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Qn)==="[object Window]"){var Wr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(le.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+le.filename+'" width="500px" height="400px" /></body></html>',Xr=Qn.open();if(Xr!==null){Xr.document.write(Wr);var dn=this;Xr.document.documentElement.querySelector("#pdfViewer").onload=function(){Xr.document.title=le.filename,Xr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(dn.output("bloburl"))}}return Xr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Qn)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Ln='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",le)+'"></iframe></body></html>',si=Qn.open();if(si!==null&&(si.document.write(Ln),si.document.title=le.filename),si||typeof safari>"u")return si;break;case"datauri":case"dataurl":return Qn.document.location.href=this.output("datauristring",le);default:return null}},sr.foo=function(){try{return sr.apply(this,arguments)}catch(Oe){var L=Oe.stack||"";~L.indexOf(" at ")&&(L=L.split(" at ")[1]);var le="Error in function "+L.split(`
`)[0].split("<")[0]+": "+Oe.message;if(!Qn.console)throw new Error(le);Qn.console.error(le,Oe),Qn.alert&&alert(le)}},sr.foo.bar=sr,sr.foo),Nr=function(L){return Array.isArray(Pn)===!0&&Pn.indexOf(L)>-1};switch(n){case"pt":ce=1;break;case"mm":ce=72/25.4;break;case"cm":ce=72/2.54;break;case"in":ce=72;break;case"px":ce=Nr("px_scaling")==1?.75:96/72;break;case"pc":case"em":ce=12;break;case"ex":ce=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);ce=n}var br=null;ee(),W();var Je=p.__private__.getPageInfo=p.getPageInfo=function(L){if(isNaN(L)||L%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:qr[L].objId,pageNumber:L,pageContext:qr[L]}},Ht=p.__private__.getPageInfoByObjId=function(L){if(isNaN(L)||L%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var le in qr)if(qr[le].objId===L)break;return Je(le)},it=p.__private__.getCurrentPageInfo=p.getCurrentPageInfo=function(){return{objId:qr[Y].objId,pageNumber:Y,pageContext:qr[Y]}};p.addPage=function(){return ur.apply(this,arguments),this},p.setPage=function(){return nn.apply(this,arguments),ie.call(this,re[Y]),this},p.insertPage=function(L){return this.addPage(),this.movePage(Y,L),this},p.movePage=function(L,le){var Oe,rt;if(L>le){Oe=re[L],rt=qr[L];for(var Et=L;Et>le;Et--)re[Et]=re[Et-1],qr[Et]=qr[Et-1];re[le]=Oe,qr[le]=rt,this.setPage(le)}else if(L<le){Oe=re[L],rt=qr[L];for(var hr=L;hr<le;hr++)re[hr]=re[hr+1],qr[hr]=qr[hr+1];re[le]=Oe,qr[le]=rt,this.setPage(le)}return this},p.deletePage=function(){return en.apply(this,arguments),this},p.__private__.text=p.text=function(L,le,Oe,rt,Et){var hr,ir,wr,Wr,Xr,dn,Ln,si,Ir,fe=(rt=rt||{}).scope||this;if(typeof L=="number"&&typeof le=="number"&&(typeof Oe=="string"||Array.isArray(Oe))){var Ee=Oe;Oe=le,le=L,L=Ee}if(arguments[3]instanceof qe==0?(wr=arguments[4],Wr=arguments[5],Hi(Ln=arguments[3])==="object"&&Ln!==null||(typeof wr=="string"&&(Wr=wr,wr=null),typeof Ln=="string"&&(Wr=Ln,Ln=null),typeof Ln=="number"&&(wr=Ln,Ln=null),rt={flags:Ln,angle:wr,align:Wr})):(M("The transform parameter of text() with a Matrix value"),Ir=Et),isNaN(le)||isNaN(Oe)||L==null)throw new Error("Invalid arguments passed to jsPDF.text");if(L.length===0)return fe;var et,Be="",kt=typeof rt.lineHeightFactor=="number"?rt.lineHeightFactor:ye,ar=fe.internal.scaleFactor;function Rt(Ii){return Ii=Ii.split("	").join(Array(rt.TabLen||9).join(" ")),Br(Ii,Ln)}function jr(Ii){for(var ea,Xa=Ii.concat(),js=[],pd=Xa.length;pd--;)typeof(ea=Xa.shift())=="string"?js.push(ea):Array.isArray(Ii)&&(ea.length===1||ea[1]===void 0&&ea[2]===void 0)?js.push(ea[0]):js.push([ea[0],ea[1],ea[2]]);return js}function _r(Ii,ea){var Xa;if(typeof Ii=="string")Xa=ea(Ii)[0];else if(Array.isArray(Ii)){for(var js,pd,Ng=Ii.concat(),fp=[],$y=Ng.length;$y--;)typeof(js=Ng.shift())=="string"?fp.push(ea(js)[0]):Array.isArray(js)&&typeof js[0]=="string"&&(pd=ea(js[0],js[1],js[2]),fp.push([pd[0],pd[1],pd[2]]));Xa=fp}return Xa}var Hr=!1,Mr=!0;if(typeof L=="string")Hr=!0;else if(Array.isArray(L)){var Qr=L.concat();ir=[];for(var Vr,Xt=Qr.length;Xt--;)(typeof(Vr=Qr.shift())!="string"||Array.isArray(Vr)&&typeof Vr[0]!="string")&&(Mr=!1);Hr=Mr}if(Hr===!1)throw new Error('Type of text must be string or Array. "'+L+'" is not recognized.');typeof L=="string"&&(L=L.match(/[\r?\n]/)?L.split(/\r\n|\r|\n/g):[L]);var vn=je/fe.internal.scaleFactor,hn=vn*(kt-1);switch(rt.baseline){case"bottom":Oe-=hn;break;case"top":Oe+=vn-hn;break;case"hanging":Oe+=vn-2*hn;break;case"middle":Oe+=vn/2-hn}if((dn=rt.maxWidth||0)>0&&(typeof L=="string"?L=fe.splitTextToSize(L,dn):Object.prototype.toString.call(L)==="[object Array]"&&(L=L.reduce(function(Ii,ea){return Ii.concat(fe.splitTextToSize(ea,dn))},[]))),hr={text:L,x:le,y:Oe,options:rt,mutex:{pdfEscape:Br,activeFontKey:ke,fonts:Ie,activeFontSize:je}},cn.publish("preProcessText",hr),L=hr.text,wr=(rt=hr.options).angle,Ir instanceof qe==0&&wr&&typeof wr=="number"){wr*=Math.PI/180,rt.rotationDirection===0&&(wr=-wr),S===w&&(wr=-wr);var kn=Math.cos(wr),_n=Math.sin(wr);Ir=new qe(kn,_n,-_n,kn,0,0)}else wr&&wr instanceof qe&&(Ir=wr);S!==w||Ir||(Ir=wt),(Xr=rt.charSpace||Fr)!==void 0&&(Be+=R(U(Xr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(si=rt.horizontalScale)!==void 0&&(Be+=R(100*si)+` Tz
`),rt.lang;var yn=-1,ci=rt.renderingMode!==void 0?rt.renderingMode:rt.stroke,Wn=fe.internal.getCurrentPageInfo().pageContext;switch(ci){case 0:case!1:case"fill":yn=0;break;case 1:case!0:case"stroke":yn=1;break;case 2:case"fillThenStroke":yn=2;break;case 3:case"invisible":yn=3;break;case 4:case"fillAndAddForClipping":yn=4;break;case 5:case"strokeAndAddPathForClipping":yn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":yn=6;break;case 7:case"addToPathForClipping":yn=7}var mi=Wn.usedRenderingMode!==void 0?Wn.usedRenderingMode:-1;yn!==-1?Be+=yn+` Tr
`:mi!==-1&&(Be+=`0 Tr
`),yn!==-1&&(Wn.usedRenderingMode=yn),Wr=rt.align||"left";var Jn,ca=je*kt,Rl=fe.internal.pageSize.getWidth(),Ko=Ie[ke];Xr=rt.charSpace||Fr,dn=rt.maxWidth||0,Ln=Object.assign({autoencode:!0,noBOM:!0},rt.flags);var So=[],_o=function(Ii){return fe.getStringUnitWidth(Ii,{font:Ko,charSpace:Xr,fontSize:je,doKerning:!1})*je/ar};if(Object.prototype.toString.call(L)==="[object Array]"){var Ss;ir=jr(L),Wr!=="left"&&(Jn=ir.map(_o));var ba,cs=0;if(Wr==="right"){le-=Jn[0],L=[],Xt=ir.length;for(var Bi=0;Bi<Xt;Bi++)Bi===0?(ba=Fe(le),Ss=Ue(Oe)):(ba=U(cs-Jn[Bi]),Ss=-ca),L.push([ir[Bi],ba,Ss]),cs=Jn[Bi]}else if(Wr==="center"){le-=Jn[0]/2,L=[],Xt=ir.length;for(var Aa=0;Aa<Xt;Aa++)Aa===0?(ba=Fe(le),Ss=Ue(Oe)):(ba=U((cs-Jn[Aa])/2),Ss=-ca),L.push([ir[Aa],ba,Ss]),cs=Jn[Aa]}else if(Wr==="left"){L=[],Xt=ir.length;for(var ro=0;ro<Xt;ro++)L.push(ir[ro])}else if(Wr==="justify"&&Ko.encoding==="Identity-H"){L=[],Xt=ir.length,dn=dn!==0?dn:Rl;for(var Au=0,Ci=0;Ci<Xt;Ci++)if(Ss=Ci===0?Ue(Oe):-ca,ba=Ci===0?Fe(le):Au,Ci<Xt-1){var Hn=U((dn-Jn[Ci])/(ir[Ci].split(" ").length-1)),Yi=ir[Ci].split(" ");L.push([Yi[0]+" ",ba,Ss]),Au=0;for(var _s=1;_s<Yi.length;_s++){var hd=(_o(Yi[_s-1]+" "+Yi[_s])-_o(Yi[_s]))*ar+Hn;_s==Yi.length-1?L.push([Yi[_s],hd,0]):L.push([Yi[_s]+" ",hd,0]),Au-=hd}}else L.push([ir[Ci],ba,Ss]);L.push(["",Au,0])}else{if(Wr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(L=[],Xt=ir.length,dn=dn!==0?dn:Rl,Ci=0;Ci<Xt;Ci++){Ss=Ci===0?Ue(Oe):-ca,ba=Ci===0?Fe(le):0;var Xc=ir[Ci].split(" ").length-1,gc=Xc>0?(dn-Jn[Ci])/Xc:0;Ci<Xt-1?So.push(R(U(gc))):So.push(0),L.push([ir[Ci],ba,Ss])}}}(typeof rt.R2L=="boolean"?rt.R2L:He)===!0&&(L=_r(L,function(Ii,ea,Xa){return[Ii.split("").reverse().join(""),ea,Xa]})),hr={text:L,x:le,y:Oe,options:rt,mutex:{pdfEscape:Br,activeFontKey:ke,fonts:Ie,activeFontSize:je}},cn.publish("postProcessText",hr),L=hr.text,et=hr.mutex.isHex||!1;var xc=Ie[ke].encoding;xc!=="WinAnsiEncoding"&&xc!=="StandardEncoding"||(L=_r(L,function(Ii,ea,Xa){return[Rt(Ii),ea,Xa]})),ir=jr(L),L=[];for(var Yo,no,pl,yc=Array.isArray(ir[0])?1:0,Fl="",Bl=function(Ii,ea,Xa){var js="";return Xa instanceof qe?(Xa=typeof rt.angle=="number"?ut(Xa,new qe(1,0,0,1,Ii,ea)):ut(new qe(1,0,0,1,Ii,ea),Xa),S===w&&(Xa=ut(new qe(1,0,0,-1,0,0),Xa)),js=Xa.join(" ")+` Tm
`):js=R(Ii)+" "+R(ea)+` Td
`,js},bc=0;bc<ir.length;bc++){switch(Fl="",yc){case 1:pl=(et?"<":"(")+ir[bc][0]+(et?">":")"),Yo=parseFloat(ir[bc][1]),no=parseFloat(ir[bc][2]);break;case 0:pl=(et?"<":"(")+ir[bc]+(et?">":")"),Yo=Fe(le),no=Ue(Oe)}So!==void 0&&So[bc]!==void 0&&(Fl=So[bc]+` Tw
`),bc===0?L.push(Fl+Bl(Yo,no,Ir)+pl):yc===0?L.push(Fl+pl):yc===1&&L.push(Fl+Bl(Yo,no,Ir)+pl)}L=yc===0?L.join(` Tj
T* `):L.join(` Tj
`),L+=` Tj
`;var Nu=`BT
/`;return Nu+=ke+" "+je+` Tf
`,Nu+=R(je*kt)+` TL
`,Nu+=tr+`
`,Nu+=Be,Nu+=L,D(Nu+="ET"),h[ke]=!0,fe};var bt=p.__private__.clip=p.clip=function(L){return D(L==="evenodd"?"W*":"W"),this};p.clipEvenOdd=function(){return bt("evenodd")},p.__private__.discardPath=p.discardPath=function(){return D("n"),this};var _t=p.__private__.isValidStyle=function(L){var le=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(L)!==-1&&(le=!0),le};p.__private__.setDefaultPathOperation=p.setDefaultPathOperation=function(L){return _t(L)&&(u=L),this};var Tt=p.__private__.getStyle=p.getStyle=function(L){var le=u;switch(L){case"D":case"S":le="S";break;case"F":le="f";break;case"FD":case"DF":le="B";break;case"f":case"f*":case"B":case"B*":le=L}return le},Dt=p.close=function(){return D("h"),this};p.stroke=function(){return D("S"),this},p.fill=function(L){return Gt("f",L),this},p.fillEvenOdd=function(L){return Gt("f*",L),this},p.fillStroke=function(L){return Gt("B",L),this},p.fillStrokeEvenOdd=function(L){return Gt("B*",L),this};var Gt=function(L,le){Hi(le)==="object"?Ze(le,L):D(L)},$t=function(L){L===null||S===w&&L===void 0||(L=Tt(L),D(L))};function ze(L,le,Oe,rt,Et){var hr=new rm(le||this.boundingBox,Oe||this.xStep,rt||this.yStep,this.gState,Et||this.matrix);hr.stream=this.stream;var ir=L+"$$"+this.cloneIndex+++"$$";return At(ir,hr),hr}var Ze=function(L,le){var Oe=xr[L.key],rt=Mt[Oe];if(rt instanceof Hh)D("q"),D(jt(le)),rt.gState&&p.setGState(rt.gState),D(L.matrix.toString()+" cm"),D("/"+Oe+" sh"),D("Q");else if(rt instanceof rm){var Et=new qe(1,0,0,-1,0,Rn());L.matrix&&(Et=Et.multiply(L.matrix||wt),Oe=ze.call(rt,L.key,L.boundingBox,L.xStep,L.yStep,Et).id),D("q"),D("/Pattern cs"),D("/"+Oe+" scn"),rt.gState&&p.setGState(rt.gState),D(le),D("Q")}},jt=function(L){switch(L){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Bt=p.moveTo=function(L,le){return D(R(U(L))+" "+R(G(le))+" m"),this},gr=p.lineTo=function(L,le){return D(R(U(L))+" "+R(G(le))+" l"),this},dr=p.curveTo=function(L,le,Oe,rt,Et,hr){return D([R(U(L)),R(G(le)),R(U(Oe)),R(G(rt)),R(U(Et)),R(G(hr)),"c"].join(" ")),this};p.__private__.line=p.line=function(L,le,Oe,rt,Et){if(isNaN(L)||isNaN(le)||isNaN(Oe)||isNaN(rt)||!_t(Et))throw new Error("Invalid arguments passed to jsPDF.line");return S===v?this.lines([[Oe-L,rt-le]],L,le,[1,1],Et||"S"):this.lines([[Oe-L,rt-le]],L,le,[1,1]).stroke()},p.__private__.lines=p.lines=function(L,le,Oe,rt,Et,hr){var ir,wr,Wr,Xr,dn,Ln,si,Ir,fe,Ee,et,Be;if(typeof L=="number"&&(Be=Oe,Oe=le,le=L,L=Be),rt=rt||[1,1],hr=hr||!1,isNaN(le)||isNaN(Oe)||!Array.isArray(L)||!Array.isArray(rt)||!_t(Et)||typeof hr!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Bt(le,Oe),ir=rt[0],wr=rt[1],Xr=L.length,Ee=le,et=Oe,Wr=0;Wr<Xr;Wr++)(dn=L[Wr]).length===2?(Ee=dn[0]*ir+Ee,et=dn[1]*wr+et,gr(Ee,et)):(Ln=dn[0]*ir+Ee,si=dn[1]*wr+et,Ir=dn[2]*ir+Ee,fe=dn[3]*wr+et,Ee=dn[4]*ir+Ee,et=dn[5]*wr+et,dr(Ln,si,Ir,fe,Ee,et));return hr&&Dt(),$t(Et),this},p.path=function(L){for(var le=0;le<L.length;le++){var Oe=L[le],rt=Oe.c;switch(Oe.op){case"m":Bt(rt[0],rt[1]);break;case"l":gr(rt[0],rt[1]);break;case"c":dr.apply(this,rt);break;case"h":Dt()}}return this},p.__private__.rect=p.rect=function(L,le,Oe,rt,Et){if(isNaN(L)||isNaN(le)||isNaN(Oe)||isNaN(rt)||!_t(Et))throw new Error("Invalid arguments passed to jsPDF.rect");return S===v&&(rt=-rt),D([R(U(L)),R(G(le)),R(U(Oe)),R(U(rt)),"re"].join(" ")),$t(Et),this},p.__private__.triangle=p.triangle=function(L,le,Oe,rt,Et,hr,ir){if(isNaN(L)||isNaN(le)||isNaN(Oe)||isNaN(rt)||isNaN(Et)||isNaN(hr)||!_t(ir))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Oe-L,rt-le],[Et-Oe,hr-rt],[L-Et,le-hr]],L,le,[1,1],ir,!0),this},p.__private__.roundedRect=p.roundedRect=function(L,le,Oe,rt,Et,hr,ir){if(isNaN(L)||isNaN(le)||isNaN(Oe)||isNaN(rt)||isNaN(Et)||isNaN(hr)||!_t(ir))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var wr=4/3*(Math.SQRT2-1);return Et=Math.min(Et,.5*Oe),hr=Math.min(hr,.5*rt),this.lines([[Oe-2*Et,0],[Et*wr,0,Et,hr-hr*wr,Et,hr],[0,rt-2*hr],[0,hr*wr,-Et*wr,hr,-Et,hr],[2*Et-Oe,0],[-Et*wr,0,-Et,-hr*wr,-Et,-hr],[0,2*hr-rt],[0,-hr*wr,Et*wr,-hr,Et,-hr]],L+Et,le,[1,1],ir,!0),this},p.__private__.ellipse=p.ellipse=function(L,le,Oe,rt,Et){if(isNaN(L)||isNaN(le)||isNaN(Oe)||isNaN(rt)||!_t(Et))throw new Error("Invalid arguments passed to jsPDF.ellipse");var hr=4/3*(Math.SQRT2-1)*Oe,ir=4/3*(Math.SQRT2-1)*rt;return Bt(L+Oe,le),dr(L+Oe,le-ir,L+hr,le-rt,L,le-rt),dr(L-hr,le-rt,L-Oe,le-ir,L-Oe,le),dr(L-Oe,le+ir,L-hr,le+rt,L,le+rt),dr(L+hr,le+rt,L+Oe,le+ir,L+Oe,le),$t(Et),this},p.__private__.circle=p.circle=function(L,le,Oe,rt){if(isNaN(L)||isNaN(le)||isNaN(Oe)||!_t(rt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(L,le,Oe,Oe,rt)},p.setFont=function(L,le,Oe){return Oe&&(le=A(le,Oe)),ke=nr(L,le,{disableWarning:!1}),this};var Kt=p.__private__.getFont=p.getFont=function(){return Ie[nr.apply(p,arguments)]};p.__private__.getFontList=p.getFontList=function(){var L,le,Oe={};for(L in It)if(It.hasOwnProperty(L))for(le in Oe[L]=[],It[L])It[L].hasOwnProperty(le)&&Oe[L].push(le);return Oe},p.addFont=function(L,le,Oe,rt,Et){var hr=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&hr.indexOf(arguments[3])!==-1?Et=arguments[3]:arguments[3]&&hr.indexOf(arguments[3])==-1&&(Oe=A(Oe,rt)),yr.call(this,L,le,Oe,Et=Et||"Identity-H")};var ye,Ce=e.lineWidth||.200025,$e=p.__private__.getLineWidth=p.getLineWidth=function(){return Ce},ft=p.__private__.setLineWidth=p.setLineWidth=function(L){return Ce=L,D(R(U(L))+" w"),this};p.__private__.setLineDash=Un.API.setLineDash=Un.API.setLineDashPattern=function(L,le){if(L=L||[],le=le||0,isNaN(le)||!Array.isArray(L))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return L=L.map(function(Oe){return R(U(Oe))}).join(" "),le=R(U(le)),D("["+L+"] "+le+" d"),this};var Sr=p.__private__.getLineHeight=p.getLineHeight=function(){return je*ye};p.__private__.getLineHeight=p.getLineHeight=function(){return je*ye};var at=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(L){return typeof(L=L||1.15)=="number"&&(ye=L),this},Ut=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return ye};at(e.lineHeight);var Fe=p.__private__.getHorizontalCoordinate=function(L){return U(L)},Ue=p.__private__.getVerticalCoordinate=function(L){return S===w?L:qr[Y].mediaBox.topRightY-qr[Y].mediaBox.bottomLeftY-U(L)},Ct=p.__private__.getHorizontalCoordinateString=p.getHorizontalCoordinateString=function(L){return R(Fe(L))},gt=p.__private__.getVerticalCoordinateString=p.getVerticalCoordinateString=function(L){return R(Ue(L))},yt=e.strokeColor||"0 G";p.__private__.getStrokeColor=p.getDrawColor=function(){return xe(yt)},p.__private__.setStrokeColor=p.setDrawColor=function(L,le,Oe,rt){return yt=Ne({ch1:L,ch2:le,ch3:Oe,ch4:rt,pdfColorType:"draw",precision:2}),D(yt),this};var mt=e.fillColor||"0 g";p.__private__.getFillColor=p.getFillColor=function(){return xe(mt)},p.__private__.setFillColor=p.setFillColor=function(L,le,Oe,rt){return mt=Ne({ch1:L,ch2:le,ch3:Oe,ch4:rt,pdfColorType:"fill",precision:2}),D(mt),this};var tr=e.textColor||"0 g",lr=p.__private__.getTextColor=p.getTextColor=function(){return xe(tr)};p.__private__.setTextColor=p.setTextColor=function(L,le,Oe,rt){return tr=Ne({ch1:L,ch2:le,ch3:Oe,ch4:rt,pdfColorType:"text",precision:3}),this};var Fr=e.charSpace,rn=p.__private__.getCharSpace=p.getCharSpace=function(){return parseFloat(Fr||0)};p.__private__.setCharSpace=p.setCharSpace=function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Fr=L,this};var Sn=0;p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},p.__private__.setLineCap=p.setLineCap=function(L){var le=p.CapJoinStyles[L];if(le===void 0)throw new Error("Line cap style of '"+L+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Sn=le,D(le+" J"),this};var Gr=0;p.__private__.setLineJoin=p.setLineJoin=function(L){var le=p.CapJoinStyles[L];if(le===void 0)throw new Error("Line join style of '"+L+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Gr=le,D(le+" j"),this},p.__private__.setLineMiterLimit=p.__private__.setMiterLimit=p.setLineMiterLimit=p.setMiterLimit=function(L){if(L=L||0,isNaN(L))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return D(R(U(L))+" M"),this},p.GState=X2,p.setGState=function(L){(L=typeof L=="string"?Pr[Nt[L]]:fn(null,L)).equals(Jr)||(D("/"+L.id+" gs"),Jr=L)};var fn=function(L,le){if(!L||!Nt[L]){var Oe=!1;for(var rt in Pr)if(Pr.hasOwnProperty(rt)&&Pr[rt].equals(le)){Oe=!0;break}if(Oe)le=Pr[rt];else{var Et="GS"+(Object.keys(Pr).length+1).toString(10);Pr[Et]=le,le.id=Et}return L&&(Nt[L]=le.id),cn.publish("addGState",le),le}};p.addGState=function(L,le){return fn(L,le),this},p.saveGraphicsState=function(){return D("q"),ct.push({key:ke,size:je,color:tr}),this},p.restoreGraphicsState=function(){D("Q");var L=ct.pop();return ke=L.key,je=L.size,tr=L.color,Jr=null,this},p.setCurrentTransformationMatrix=function(L){return D(L.toString()+" cm"),this},p.comment=function(L){return D("#"+L),this};var an=function(L,le){var Oe=L||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Oe},set:function(hr){isNaN(hr)||(Oe=parseFloat(hr))}});var rt=le||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return rt},set:function(hr){isNaN(hr)||(rt=parseFloat(hr))}});var Et="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Et},set:function(hr){Et=hr.toString()}}),this},bn=function(L,le,Oe,rt){an.call(this,L,le),this.type="rect";var Et=Oe||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Et},set:function(ir){isNaN(ir)||(Et=parseFloat(ir))}});var hr=rt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return hr},set:function(ir){isNaN(ir)||(hr=parseFloat(ir))}}),this},Se=function(){this.page=Ur,this.currentPage=Y,this.pages=re.slice(0),this.pagesContext=qr.slice(0),this.x=we,this.y=ht,this.matrix=nt,this.width=Qe(Y),this.height=tn(Y),this.outputDestination=I,this.id="",this.objectNumber=-1};Se.prototype.restore=function(){Ur=this.page,Y=this.currentPage,qr=this.pagesContext,re=this.pages,we=this.x,ht=this.y,nt=this.matrix,vr(Y,this.width),An(Y,this.height),I=this.outputDestination};var st=function(L,le,Oe,rt,Et){Me.push(new Se),Ur=Y=0,re=[],we=L,ht=le,nt=Et,cr([Oe,rt])};for(var pt in p.beginFormObject=function(L,le,Oe,rt,Et){return st(L,le,Oe,rt,Et),this},p.endFormObject=function(L){return function(le){if(mn[le])Me.pop().restore();else{var Oe=new Se,rt="Xo"+(Object.keys(Lr).length+1).toString(10);Oe.id=rt,mn[le]=rt,Lr[rt]=Oe,cn.publish("addFormObject",Oe),Me.pop().restore()}}(L),this},p.doFormObject=function(L,le){var Oe=Lr[mn[L]];return D("q"),D(le.toString()+" cm"),D("/"+Oe.id+" Do"),D("Q"),this},p.getFormObject=function(L){var le=Lr[mn[L]];return{x:le.x,y:le.y,width:le.width,height:le.height,matrix:le.matrix}},p.save=function(L,le){return L=L||"generated.pdf",(le=le||{}).returnPromise=le.returnPromise||!1,le.returnPromise===!1?($h(Wt(ot()),L),typeof $h.unload=="function"&&Qn.setTimeout&&setTimeout($h.unload,911),this):new Promise(function(Oe,rt){try{var Et=$h(Wt(ot()),L);typeof $h.unload=="function"&&Qn.setTimeout&&setTimeout($h.unload,911),Oe(Et)}catch(hr){rt(hr.message)}})},Un.API)Un.API.hasOwnProperty(pt)&&(pt==="events"&&Un.API.events.length?function(L,le){var Oe,rt,Et;for(Et=le.length-1;Et!==-1;Et--)Oe=le[Et][0],rt=le[Et][1],L.subscribe.apply(L,[Oe].concat(typeof rt=="function"?[rt]:rt))}(cn,Un.API.events):p[pt]=Un.API[pt]);function Qe(L){return qr[L].mediaBox.topRightX-qr[L].mediaBox.bottomLeftX}function vr(L,le){qr[L].mediaBox.topRightX=le+qr[L].mediaBox.bottomLeftX}function tn(L){return qr[L].mediaBox.topRightY-qr[L].mediaBox.bottomLeftY}function An(L,le){qr[L].mediaBox.topRightY=le+qr[L].mediaBox.bottomLeftY}var xn=p.getPageWidth=function(L){return Qe(L=L||Y)/ce},zn=p.setPageWidth=function(L,le){vr(L,le*ce)},Rn=p.getPageHeight=function(L){return tn(L=L||Y)/ce},xi=p.setPageHeight=function(L,le){An(L,le*ce)};return p.internal={pdfEscape:Br,getStyle:Tt,getFont:Kt,getFontSize:_e,getCharSpace:rn,getTextColor:lr,getLineHeight:Sr,getLineHeightFactor:Ut,getLineWidth:$e,write:Z,getHorizontalCoordinate:Fe,getVerticalCoordinate:Ue,getCoordinateString:Ct,getVerticalCoordinateString:gt,collections:{},newObject:Zt,newAdditionalObject:ue,newObjectDeferred:Cr,newObjectDeferredBegin:se,getFilters:St,putStream:Ve,events:cn,scaleFactor:ce,pageSize:{getWidth:function(){return xn(Y)},setWidth:function(L){zn(Y,L)},getHeight:function(){return Rn(Y)},setHeight:function(L){xi(Y,L)}},encryptionOptions:d,encryption:br,getEncryptor:function(L){return d!==null?br.encryptor(L,0):function(le){return le}},output:pr,getNumberOfPages:gn,get pages(){return re},out:D,f2:E,f3:P,getPageInfo:Je,getPageInfoByObjId:Ht,getCurrentPageInfo:it,getPDFVersion:g,Point:an,Rectangle:bn,Matrix:qe,hasHotfix:Nr},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return xn(Y)},set:function(L){zn(Y,L)},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return Rn(Y)},set:function(L){xi(Y,L)},enumerable:!0,configurable:!0}),(function(L){for(var le=0,Oe=Te.length;le<Oe;le++){var rt=yr.call(this,L[le][0],L[le][1],L[le][2],Te[le][3],!0);f===!1&&(h[rt]=!0);var Et=L[le][0].split("-");er({id:rt,fontName:Et[0],fontStyle:Et[1]||""})}cn.publish("addFonts",{fonts:Ie,dictionary:It})}).call(p,Te),ke="F1",ur(i,r),cn.publish("initialized"),p}Bp.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},Bp.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Bp.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},Bp.prototype.processOwnerPassword=function(e,t){return iA(nA(t).substr(0,5),e)},Bp.prototype.encryptor=function(e,t){var r=nA(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return iA(r,n)}},X2.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||Hi(e)!==Hi(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},Un.API={events:[]},Un.version="4.1.0";var $a=Un.API,vC=1,ip=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},bp=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Q2=function(e){return e.toString().replace(/#/g,"#23").replace(/[\s\n\r()<>[\]{}\/%]/g,function(t){var r=t.charCodeAt(0).toString(16).toUpperCase();return"#"+(r.length===1?"0"+r:r)})},ti=function(e){return e.toFixed(2)},Ef=function(e){return e.toFixed(5)};$a.__acroform__={};var Ml=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},sM=function(e){return e*vC},$u=function(e){var t=new Rz,r=Mn.internal.getHeight(e)||0,n=Mn.internal.getWidth(e)||0;return t.BBox=[0,0,Number(ti(n)),Number(ti(r))],t},_ge=$a.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},jge=$a.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},kge=$a.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},rs=$a.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return kge(e,t-1)},ns=$a.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return _ge(e,t-1)},is=$a.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return jge(e,t-1)},Age=$a.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,i=e[0],s=e[1],o=e[2],l=e[3],c={};return c.lowerLeft_X=r(i)||0,c.lowerLeft_Y=n(s+l)||0,c.upperRight_X=r(i+o)||0,c.upperRight_Y=n(s)||0,[Number(ti(c.lowerLeft_X)),Number(ti(c.lowerLeft_Y)),Number(ti(c.upperRight_X)),Number(ti(c.upperRight_Y))]},Nge=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=aA(e,r),i=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+i+" "+ti(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=$u(e);return s.scope=e.scope,s.stream=t.join(`
`),s}},aA=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},i=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");i=e.multiline?i.map(function(E){return E.split(`
`)}):i.map(function(E){return[E]});var s=r,o=Mn.internal.getHeight(e)||0;o=o<0?-o:o;var l=Mn.internal.getWidth(e)||0;l=l<0?-l:l;var c=function(E,P,U){if(E+1<i.length){var G=P+" "+i[E+1][0];return Ib(G,e,U).width<=l-4}return!1};s++;e:for(;s>0;){t="",s--;var u,d,f=Ib("3",e,s).height,h=e.multiline?o-s:(o-f)/2,p=h+=2,m=0,g=0,y=0;if(s<=0){t=`(...) Tj
`,t+="% Width of Text: "+Ib(t,e,s=12).width+", FieldWidth:"+l+`
`;break}for(var b="",v=0,w=0;w<i.length;w++)if(i.hasOwnProperty(w)){var S=!1;if(i[w].length!==1&&y!==i[w].length-1){if((f+2)*(v+2)+2>o)continue e;b+=i[w][y],S=!0,g=w,w--}else{b=(b+=i[w][y]+" ").substr(b.length-1)==" "?b.substr(0,b.length-1):b;var j=parseInt(w),k=c(j,b,s),A=w>=i.length-1;if(k&&!A){b+=" ",y=0;continue}if(k||A){if(A)g=j;else if(e.multiline&&(f+2)*(v+2)+2>o)continue e}else{if(!e.multiline||(f+2)*(v+2)+2>o)continue e;g=j}}for(var R="",M=m;M<=g;M++){var B=i[M];if(e.multiline){if(M===g){R+=B[y]+" ",y=(y+1)%B.length;continue}if(M===m){R+=B[B.length-1]+" ";continue}}R+=B[0]+" "}switch(R=R.substr(R.length-1)==" "?R.substr(0,R.length-1):R,d=Ib(R,e,s).width,e.textAlign){case"right":u=l-d-2;break;case"center":u=(l-d)/2;break;default:u=2}t+=ti(u)+" "+ti(p)+` Td
`,t+="("+ip(R)+`) Tj
`,t+=-ti(u)+` 0 Td
`,p=-(s+2),d=0,m=S?g:g+1,v++,b=""}break}return n.text=t,n.fontSize=s,n},Ib=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),i=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},Cge={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Ege=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},Tge=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(_u.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(Cge)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");vC=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new Fz,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var s=n[i];s.objId=void 0,s.hasAnnotation&&Ege(s,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,i){var s=!n;for(var o in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],u=l.Rect;if(l.Rect&&(l.Rect=Age(l.Rect,i)),i.internal.newObjectDeferredBegin(l.objId,!0),l.DA=Mn.createDefaultAppearanceStream(l),Hi(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var d=Nge(l);c.push({key:"AP",value:"<</N "+d+">>"}),i.internal.acroformPlugin.xForms.push(d)}if(l.appearanceStreamContent){var f="";for(var h in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(h)){var p=l.appearanceStreamContent[h];if(f+="/"+h+" ",f+="<<",Object.keys(p).length>=1||Array.isArray(p)){for(var o in p)if(p.hasOwnProperty(o)){var m=p[o];typeof m=="function"&&(m=m.call(i,l)),f+="/"+o+" "+m+" ",i.internal.acroformPlugin.xForms.indexOf(m)>=0||i.internal.acroformPlugin.xForms.push(m)}}else typeof(m=p)=="function"&&(m=m.call(i,l)),f+="/"+o+" "+m,i.internal.acroformPlugin.xForms.indexOf(m)>=0||i.internal.acroformPlugin.xForms.push(m);f+=">>"}c.push({key:"AP",value:`<<
`+f+">>"})}i.internal.putStream({additionalKeyValues:c,objectId:l.objId}),i.internal.out("endobj")}s&&function(g,y){for(var b in g)if(g.hasOwnProperty(b)){var v=b,w=g[b];y.internal.newObjectDeferredBegin(w.objId,!0),Hi(w)==="object"&&typeof w.putStream=="function"&&w.putStream(),delete g[v]}}(i.internal.acroformPlugin.xForms,i)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},Lz=$a.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(o){return o};if(Array.isArray(e)){for(var i="[",s=0;s<e.length;s++)switch(s!==0&&(i+=" "),Hi(e[s])){case"boolean":case"number":case"object":i+=e[s].toString();break;case"string":e[s].substr(0,1)==="/"?i+="/"+Q2(e[s].substr(1)):(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),i+="("+ip(n(e[s].toString()))+")")}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Nj=function(e,t,r){var n=function(i){return i};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+ip(n(e))+")"},Yu=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Yu.prototype.toString=function(){return this.objId+" 0 R"},Yu.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Yu.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],i=this[n];i&&(Array.isArray(i)?e.push({key:n,value:Lz(i,this.objId,this.scope)}):i instanceof Yu?(i.scope=this.scope,e.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&e.push({key:n,value:i}))}return e};var Rz=function(){Yu.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};Ml(Rz,Yu);var Fz=function(){Yu.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+ip(r(e))+")"}},set:function(r){e=r}})};Ml(Fz,Yu);var _u=function e(){Yu.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute F supplied.');t=b}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!rs(t,3)},set:function(b){b?this.F=ns(t,3):this.F=is(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute Ff supplied.');r=b}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(b){n=b!==void 0?b:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(b){n[0]=b}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(b){n[1]=b}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(b){n[2]=b}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(b){n[3]=b}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(b){switch(b){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=b;break;default:throw new Error('Invalid value "'+b+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof J2)return;s="FieldObject"+e.FieldNum++}var b=function(v){return v};return this.scope&&(b=this.scope.internal.getEncryptor(this.objId)),"("+ip(b(s))+")"},set:function(b){s=b.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(b){s=b}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(b){o=b}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(b){l=b}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(b){c=b}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/vC:u},set:function(b){u=b}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(b){d=b}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof J2||this instanceof u0))return Nj(f,this.objId,this.scope)},set:function(b){b=b.toString(),f=b}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof Gs==0?Nj(h,this.objId,this.scope):h},set:function(b){b=b.toString(),h=this instanceof Gs==0?b.substr(0,1)==="("?bp(b.substr(1,b.length-2)):bp(b):b}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Gs==1?bp(h.substr(1,h.length-1)):h},set:function(b){b=b.toString(),h=this instanceof Gs==1?"/"+Q2(b):b}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(b){this.V=b}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Gs==0?Nj(p,this.objId,this.scope):p},set:function(b){b=b.toString(),p=this instanceof Gs==0?b.substr(0,1)==="("?bp(b.substr(1,b.length-2)):bp(b):b}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Gs==1?bp(p.substr(1,p.length-1)):p},set:function(b){b=b.toString(),p=this instanceof Gs==1?"/"+Q2(b):b}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var m,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(b){b=!!b,g=b}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(m)return m},set:function(b){m=b}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,1)},set:function(b){b?this.Ff=ns(this.Ff,1):this.Ff=is(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,2)},set:function(b){b?this.Ff=ns(this.Ff,2):this.Ff=is(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,3)},set:function(b){b?this.Ff=ns(this.Ff,3):this.Ff=is(this.Ff,3)}});var y=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(y!==null)return y},set:function(b){if([0,1,2].indexOf(b)===-1)throw new Error('Invalid value "'+b+'" for attribute Q supplied.');y=b}}),Object.defineProperty(this,"textAlign",{get:function(){var b;switch(y){case 0:default:b="left";break;case 1:b="center";break;case 2:b="right"}return b},configurable:!0,enumerable:!0,set:function(b){switch(b){case"right":case 2:y=2;break;case"center":case 1:y=1;break;default:y=0}}})};Ml(_u,Yu);var bm=function(){_u.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Lz(t,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=function(s,o,l){l||(l=1);for(var c,u=[];c=o.exec(s);)u.push(c[l]);return u}(n,/\((.*?)\)/g)),t=i}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,18)},set:function(r){r?this.Ff=ns(this.Ff,18):this.Ff=is(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=ns(this.Ff,19):this.Ff=is(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,20)},set:function(r){r?(this.Ff=ns(this.Ff,20),t.sort()):this.Ff=is(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,22)},set:function(r){r?this.Ff=ns(this.Ff,22):this.Ff=is(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,23)},set:function(r){r?this.Ff=ns(this.Ff,23):this.Ff=is(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,27)},set:function(r){r?this.Ff=ns(this.Ff,27):this.Ff=is(this.Ff,27)}}),this.hasAppearanceStream=!1};Ml(bm,_u);var vm=function(){bm.call(this),this.fontName="helvetica",this.combo=!1};Ml(vm,bm);var wm=function(){vm.call(this),this.combo=!0};Ml(wm,vm);var qv=function(){wm.call(this),this.edit=!0};Ml(qv,wm);var Gs=function(){_u.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,15)},set:function(r){r?this.Ff=ns(this.Ff,15):this.Ff=is(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,16)},set:function(r){r?this.Ff=ns(this.Ff,16):this.Ff=is(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,17)},set:function(r){r?this.Ff=ns(this.Ff,17):this.Ff=is(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,26)},set:function(r){r?this.Ff=ns(this.Ff,26):this.Ff=is(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,i=[];for(n in i.push("<<"),t)i.push("/"+n+" ("+ip(r(t[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){Hi(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+Q2(r)}})};Ml(Gs,_u);var Hv=function(){Gs.call(this),this.pushButton=!0};Ml(Hv,Gs);var Sm=function(){Gs.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Ml(Sm,Gs);var J2=function(){var e,t;_u.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(i){e=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(i){t=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(l){return l};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),n)o.push("/"+s+" ("+ip(i(n[s]))+")");return o.push(">>"),o.join(`
`)},set:function(i){Hi(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Mn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ml(J2,_u),Sm.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},Sm.prototype.createOption=function(e){var t=new J2;return t.Parent=this,t.optionName=e,this.Kids.push(t),Pge.call(this.scope,t),t};var Vv=function(){Gs.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Mn.CheckBox.createAppearanceStream()};Ml(Vv,Gs);var u0=function(){_u.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,13)},set:function(t){t?this.Ff=ns(this.Ff,13):this.Ff=is(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,21)},set:function(t){t?this.Ff=ns(this.Ff,21):this.Ff=is(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,23)},set:function(t){t?this.Ff=ns(this.Ff,23):this.Ff=is(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,24)},set:function(t){t?this.Ff=ns(this.Ff,24):this.Ff=is(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,25)},set:function(t){t?this.Ff=ns(this.Ff,25):this.Ff=is(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,26)},set:function(t){t?this.Ff=ns(this.Ff,26):this.Ff=is(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ml(u0,_u);var Gv=function(){u0.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,14)},set:function(e){e?this.Ff=ns(this.Ff,14):this.Ff=is(this.Ff,14)}}),this.password=!0};Ml(Gv,u0);var Mn={CheckBox:{createAppearanceStream:function(){return{N:{On:Mn.CheckBox.YesNormal},D:{On:Mn.CheckBox.YesPushDown,Off:Mn.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=$u(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,i=e.scope.__private__.encodeColorString(e.color),s=aA(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+ti(Mn.internal.getWidth(e))+" "+ti(Mn.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+ti(s.fontSize)+" Tf "+i),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=$u(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),i=[],s=Mn.internal.getHeight(e),o=Mn.internal.getWidth(e),l=aA(e,e.caption);return i.push("1 g"),i.push("0 0 "+ti(o)+" "+ti(s)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+ti(o-1)+" "+ti(s-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+ti(l.fontSize)+" Tf "+n),i.push(l.text),i.push("ET"),i.push("Q"),t.stream=i.join(`
`),t},OffPushDown:function(e){var t=$u(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+ti(Mn.internal.getWidth(e))+" "+ti(Mn.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:Mn.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=Mn.RadioButton.Circle.YesNormal,t.D[e]=Mn.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=$u(e);t.scope=e.scope;var r=[],n=Mn.internal.getWidth(e)<=Mn.internal.getHeight(e)?Mn.internal.getWidth(e)/4:Mn.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Mn.internal.Bezier_C,s=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Ef(Mn.internal.getWidth(e)/2)+" "+Ef(Mn.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=$u(e);t.scope=e.scope;var r=[],n=Mn.internal.getWidth(e)<=Mn.internal.getHeight(e)?Mn.internal.getWidth(e)/4:Mn.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),s=Number((i*Mn.internal.Bezier_C).toFixed(5)),o=Number((n*Mn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Ef(Mn.internal.getWidth(e)/2)+" "+Ef(Mn.internal.getHeight(e)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),r.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),r.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),r.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Ef(Mn.internal.getWidth(e)/2)+" "+Ef(Mn.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=$u(e);t.scope=e.scope;var r=[],n=Mn.internal.getWidth(e)<=Mn.internal.getHeight(e)?Mn.internal.getWidth(e)/4:Mn.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),s=Number((i*Mn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Ef(Mn.internal.getWidth(e)/2)+" "+Ef(Mn.internal.getHeight(e)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),r.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),r.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),r.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:Mn.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=Mn.RadioButton.Cross.YesNormal,t.D[e]=Mn.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=$u(e);t.scope=e.scope;var r=[],n=Mn.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+ti(Mn.internal.getWidth(e)-2)+" "+ti(Mn.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(ti(n.x1.x)+" "+ti(n.x1.y)+" m"),r.push(ti(n.x2.x)+" "+ti(n.x2.y)+" l"),r.push(ti(n.x4.x)+" "+ti(n.x4.y)+" m"),r.push(ti(n.x3.x)+" "+ti(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=$u(e);t.scope=e.scope;var r=Mn.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+ti(Mn.internal.getWidth(e))+" "+ti(Mn.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+ti(Mn.internal.getWidth(e)-2)+" "+ti(Mn.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(ti(r.x1.x)+" "+ti(r.x1.y)+" m"),n.push(ti(r.x2.x)+" "+ti(r.x2.y)+" l"),n.push(ti(r.x4.x)+" "+ti(r.x4.y)+" m"),n.push(ti(r.x3.x)+" "+ti(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=$u(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+ti(Mn.internal.getWidth(e))+" "+ti(Mn.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};Mn.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=Mn.internal.getWidth(e),r=Mn.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},Mn.internal.getWidth=function(e){var t=0;return Hi(e)==="object"&&(t=sM(e.Rect[2])),t},Mn.internal.getHeight=function(e){var t=0;return Hi(e)==="object"&&(t=sM(e.Rect[3])),t};var Pge=$a.addField=function(e){if(Tge(this,e),!(e instanceof _u))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};$a.AcroFormChoiceField=bm,$a.AcroFormListBox=vm,$a.AcroFormComboBox=wm,$a.AcroFormEditBox=qv,$a.AcroFormButton=Gs,$a.AcroFormPushButton=Hv,$a.AcroFormRadioButton=Sm,$a.AcroFormCheckBox=Vv,$a.AcroFormTextField=u0,$a.AcroFormPasswordField=Gv,$a.AcroFormAppearance=Mn,$a.AcroForm={ChoiceField:bm,ListBox:vm,ComboBox:wm,EditBox:qv,Button:Gs,PushButton:Hv,RadioButton:Sm,CheckBox:Vv,TextField:u0,PasswordField:Gv,Appearance:Mn},Un.AcroForm={ChoiceField:bm,ListBox:vm,ComboBox:wm,EditBox:qv,Button:Gs,PushButton:Hv,RadioButton:Sm,CheckBox:Vv,TextField:u0,PasswordField:Gv,Appearance:Mn};Un.AcroForm;function Bz(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=e.__addimage__.getImageFileTypeByImageData=function(E,P){var U,G,H,oe,de,W=r;if((P=P||r)==="RGBA"||E.data!==void 0&&E.data instanceof Uint8ClampedArray&&"height"in E&&"width"in E)return"RGBA";if(k(E))for(de in n)for(H=n[de],U=0;U<H.length;U+=1){for(oe=!0,G=0;G<H[U].length;G+=1)if(H[U][G]!==void 0&&H[U][G]!==E[G]){oe=!1;break}if(oe===!0){W=de;break}}else for(de in n)for(H=n[de],U=0;U<H.length;U+=1){for(oe=!0,G=0;G<H[U].length;G+=1)if(H[U][G]!==void 0&&H[U][G]!==E.charCodeAt(G)){oe=!1;break}if(oe===!0){W=de;break}}return W===r&&P!==r&&(W=P),W},s=function E(P){for(var U=this.internal.write,G=this.internal.putStream,H=(0,this.internal.getFilters)();H.indexOf("FlateEncode")!==-1;)H.splice(H.indexOf("FlateEncode"),1);P.objectId=this.internal.newObject();var oe=[];if(oe.push({key:"Type",value:"/XObject"}),oe.push({key:"Subtype",value:"/Image"}),oe.push({key:"Width",value:P.width}),oe.push({key:"Height",value:P.height}),P.colorSpace===b.INDEXED?oe.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(P.palette.length/3-1)+" "+("sMask"in P&&P.sMask!==void 0?P.objectId+2:P.objectId+1)+" 0 R]"}):(oe.push({key:"ColorSpace",value:"/"+P.colorSpace}),P.colorSpace===b.DEVICE_CMYK&&oe.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),oe.push({key:"BitsPerComponent",value:P.bitsPerComponent}),"decodeParameters"in P&&P.decodeParameters!==void 0&&oe.push({key:"DecodeParms",value:"<<"+P.decodeParameters+">>"}),"transparency"in P&&Array.isArray(P.transparency)&&P.transparency.length>0){for(var de="",W=0,V=P.transparency.length;W<V;W++)de+=P.transparency[W]+" "+P.transparency[W]+" ";oe.push({key:"Mask",value:"["+de+"]"})}P.sMask!==void 0&&oe.push({key:"SMask",value:P.objectId+1+" 0 R"});var ae=P.filter!==void 0?["/"+P.filter]:void 0;if(G({data:P.data,additionalKeyValues:oe,alreadyAppliedFilters:ae,objectId:P.objectId}),U("endobj"),"sMask"in P&&P.sMask!==void 0){var ee,C=(ee=P.sMaskBitsPerComponent)!==null&&ee!==void 0?ee:P.bitsPerComponent,Y={width:P.width,height:P.height,colorSpace:"DeviceGray",bitsPerComponent:C,data:P.sMask};"filter"in P&&(Y.decodeParameters="/Predictor ".concat(P.predictor," /Colors 1 /BitsPerComponent ").concat(C," /Columns ").concat(P.width),Y.filter=P.filter),E.call(this,Y)}if(P.colorSpace===b.INDEXED){var q=this.internal.newObject();G({data:R(new Uint8Array(P.palette)),objectId:q}),U("endobj")}},o=function(){var E=this.internal.collections[t+"images"];for(var P in E)s.call(this,E[P])},l=function(){var E,P=this.internal.collections[t+"images"],U=this.internal.write;for(var G in P)U("/I"+(E=P[G]).index,E.objectId,"0","R")},c=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},u=function(){var E=this.internal.collections[t+"images"];return c.call(this),E},d=function(){return Object.keys(this.internal.collections[t+"images"]).length},f=function(E){return typeof e["process"+E.toUpperCase()]=="function"},h=function(E){return Hi(E)==="object"&&E.nodeType===1},p=function(E,P){if(E.nodeName==="IMG"&&E.hasAttribute("src")){var U=""+E.getAttribute("src");if(U.indexOf("data:image/")===0)return Wv(unescape(U).split("base64,").pop());var G=e.loadFile(U,!0);if(G!==void 0)return G}if(E.nodeName==="CANVAS"){if(E.width===0||E.height===0)throw new Error("Given canvas must have data. Canvas width: "+E.width+", height: "+E.height);var H;switch(P){case"PNG":H="image/png";break;case"WEBP":H="image/webp";break;default:H="image/jpeg"}return Wv(E.toDataURL(H,1).split("base64,").pop())}},m=function(E){var P=this.internal.collections[t+"images"];if(P){for(var U in P)if(E===P[U].alias)return P[U]}},g=function(E,P,U){return E||P||(E=-96,P=-96),E<0&&(E=-1*U.width*72/E/this.internal.scaleFactor),P<0&&(P=-1*U.height*72/P/this.internal.scaleFactor),E===0&&(E=P*U.width/U.height),P===0&&(P=E*U.height/U.width),[E,P]},y=function(E,P,U,G,H,oe){var de=g.call(this,U,G,H),W=this.internal.getCoordinateString,V=this.internal.getVerticalCoordinateString,ae=u.call(this);if(U=de[0],G=de[1],ae[H.index]=H,oe){oe*=Math.PI/180;var ee=Math.cos(oe),C=Math.sin(oe),Y=function(O){return O.toFixed(4)},q=[Y(ee),Y(C),Y(-1*C),Y(ee),0,0,"cm"]}this.internal.write("q"),oe?(this.internal.write([1,"0","0",1,W(E),V(P+G),"cm"].join(" ")),this.internal.write(q.join(" ")),this.internal.write([W(U),"0","0",W(G),"0","0","cm"].join(" "))):this.internal.write([W(U),"0","0",W(G),W(E),V(P+G),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+H.index+" Do"),this.internal.write("Q")},b=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var v=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=e.__addimage__.sHashCode=function(E){var P,U,G=0;if(typeof E=="string")for(U=E.length,P=0;P<U;P++)G=(G<<5)-G+E.charCodeAt(P),G|=0;else if(k(E))for(U=E.byteLength/2,P=0;P<U;P++)G=(G<<5)-G+E[P],G|=0;return G},S=e.__addimage__.validateStringAsBase64=function(E){(E=E||"").toString().trim();var P=!0;return E.length===0&&(P=!1),E.length%4!=0&&(P=!1),/^[A-Za-z0-9+/]+$/.test(E.substr(0,E.length-2))===!1&&(P=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(E.substr(-2))===!1&&(P=!1),P},j=e.__addimage__.extractImageFromDataUrl=function(E){if(E==null||!(E=E.trim()).startsWith("data:"))return null;var P=E.indexOf(",");return P<0?null:E.substring(0,P).trim().endsWith("base64")?E.substring(P+1):null};e.__addimage__.isArrayBuffer=function(E){return E instanceof ArrayBuffer};var k=e.__addimage__.isArrayBufferView=function(E){return E instanceof Int8Array||E instanceof Uint8Array||E instanceof Uint8ClampedArray||E instanceof Int16Array||E instanceof Uint16Array||E instanceof Int32Array||E instanceof Uint32Array||E instanceof Float32Array||E instanceof Float64Array},A=e.__addimage__.binaryStringToUint8Array=function(E){for(var P=E.length,U=new Uint8Array(P),G=0;G<P;G++)U[G]=E.charCodeAt(G);return U},R=e.__addimage__.arrayBufferToBinaryString=function(E){for(var P="",U=k(E)?E:new Uint8Array(E),G=0;G<U.length;G+=8192)P+=String.fromCharCode.apply(null,U.subarray(G,G+8192));return P};e.addImage=function(){var E,P,U,G,H,oe,de,W,V;if(typeof arguments[1]=="number"?(P=r,U=arguments[1],G=arguments[2],H=arguments[3],oe=arguments[4],de=arguments[5],W=arguments[6],V=arguments[7]):(P=arguments[1],U=arguments[2],G=arguments[3],H=arguments[4],oe=arguments[5],de=arguments[6],W=arguments[7],V=arguments[8]),Hi(E=arguments[0])==="object"&&!h(E)&&"imageData"in E){var ae=E;E=ae.imageData,P=ae.format||P||r,U=ae.x||U||0,G=ae.y||G||0,H=ae.w||ae.width||H,oe=ae.h||ae.height||oe,de=ae.alias||de,W=ae.compression||W,V=ae.rotation||ae.angle||V}var ee=this.internal.getFilters();if(W===void 0&&ee.indexOf("FlateEncode")!==-1&&(W="SLOW"),isNaN(U)||isNaN(G))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var C=M.call(this,E,P,de,W);return y.call(this,U,G,H,oe,C,V),this};var M=function(E,P,U,G){var H,oe,de;if(typeof E=="string"&&i(E)===r){E=unescape(E);var W=B(E,!1);(W!==""||(W=e.loadFile(E,!0))!==void 0)&&(E=W)}if(h(E)&&(E=p(E,P)),P=i(E,P),!f(P))throw new Error("addImage does not support files of type '"+P+"', please ensure that a plugin for '"+P+"' support is added.");if(((de=U)==null||de.length===0)&&(U=function(V){return typeof V=="string"||k(V)?w(V):k(V.data)?w(V.data):null}(E)),(H=m.call(this,U))||(E instanceof Uint8Array||P==="RGBA"||(oe=E,E=A(E)),H=this["process"+P.toUpperCase()](E,d.call(this),U,function(V){return V&&typeof V=="string"&&(V=V.toUpperCase()),V in e.image_compression?V:v.NONE}(G),oe)),!H)throw new Error("An unknown error occurred whilst processing the image.");return H},B=e.__addimage__.convertBase64ToBinaryString=function(E,P){P=typeof P!="boolean"||P;var U,G="";if(typeof E=="string"){var H;U=(H=j(E))!==null&&H!==void 0?H:E;try{G=Wv(U)}catch(oe){if(P)throw S(U)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+oe.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return G};e.getImageProperties=function(E){var P,U,G="";if(h(E)&&(E=p(E)),typeof E=="string"&&i(E)===r&&((G=B(E,!1))===""&&(G=e.loadFile(E)||""),E=G),U=i(E),!f(U))throw new Error("addImage does not support files of type '"+U+"', please ensure that a plugin for '"+U+"' support is added.");if(E instanceof Uint8Array||(E=A(E)),!(P=this["process"+U.toUpperCase()](E)))throw new Error("An unknown error occurred whilst processing the image");return P.fileType=U,P}})(Un.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};Un.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,i,s,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,d=!1,f=0;f<u.length&&!d;f++)switch((n=u[f]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var h=0;h<u.length;h++){n=u[h];var p=this.internal.pdfEscape,m=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),y=this.internal.newAdditionalObject(),b=this.internal.getEncryptor(g.objId),v=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(i="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+p(b(n.contents))+")",s+=" /Popup "+y.objId+" 0 R",s+=" /P "+c.objId+" 0 R",s+=" /T ("+p(b(v))+") >>",g.content=s;var w=g.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+w,n.open&&(s+=" /Open true"),s+=" >>",y.content=s,this.internal.write(g.objId,"0 R",y.objId,"0 R");break;case"freetext":i="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var S=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+p(m(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+S+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var j=this.annotations._nameMap[n.options.name];n.options.pageNumber=j.page,n.options.top=j.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+p(m(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;default:var k=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+k+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,i,s,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+i),h:u(n+s)},options:o,type:"link"})},e.textWithLink=function(r,n,i,s){var o,l,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){l=s.maxWidth;var d=this.splitTextToSize(r,l).length;o=Math.ceil(u*d)}else l=c,o=u;return this.text(r,n,i,s),i+=.2*u,s.align==="center"&&(n-=c/2),s.align==="right"&&(n-=c),this.link(n,i-u,l,o,s),c},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(Un.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];e.__arabicParser__={};var s=e.__arabicParser__.isInArabicSubstitutionA=function(g){return t[g.charCodeAt(0)]!==void 0},o=e.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},l=e.__arabicParser__.isArabicEndLetter=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(g){return o(g)&&i.indexOf(g.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length>=1};var u=e.__arabicParser__.arabicLetterHasFinalForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length>=3};var d=e.__arabicParser__.arabicLetterHasMedialForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length==4},f=e.__arabicParser__.resolveLigatures=function(g){var y=0,b=r,v="",w=0;for(y=0;y<g.length;y+=1)b[g.charCodeAt(y)]!==void 0?(w++,typeof(b=b[g.charCodeAt(y)])=="number"&&(v+=String.fromCharCode(b),b=r,w=0),y===g.length-1&&(b=r,v+=g.charAt(y-(w-1)),y-=w-1,w=0)):(b=r,v+=g.charAt(y-w),y-=w,w=0);return v};e.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&n[g.charCodeAt(0)]!==void 0};var h=e.__arabicParser__.getCorrectForm=function(g,y,b){return o(g)?s(g)===!1?-1:!u(g)||!o(y)&&!o(b)||!o(b)&&l(y)||l(g)&&!o(y)||l(g)&&c(y)||l(g)&&l(y)?0:d(g)&&o(y)&&!l(y)&&o(b)&&u(b)?3:l(g)||!o(b)?1:2:-1},p=function(g){var y=0,b=0,v=0,w="",S="",j="",k=(g=g||"").split("\\s+"),A=[];for(y=0;y<k.length;y+=1){for(A.push(""),b=0;b<k[y].length;b+=1)w=k[y][b],S=k[y][b-1],j=k[y][b+1],o(w)?(v=h(w,S,j),A[y]+=v!==-1?String.fromCharCode(t[w.charCodeAt(0)][v]):w):A[y]+=w;A[y]=f(A[y])}return A.join(" ")},m=e.__arabicParser__.processArabic=e.processArabic=function(){var g,y=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,b=[];if(Array.isArray(y)){var v=0;for(b=[],v=0;v<y.length;v+=1)Array.isArray(y[v])?b.push([p(y[v][0]),y[v][1],y[v][2]]):b.push([p(y[v])]);g=b}else g=p(y);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};e.events.push(["preProcessText",m])}(Un.API),Un.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(l){i=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(l){s=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Un.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(g){c=g}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var h=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var p=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return p},set:function(g){p=g}});var m=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return m},set:function(g){m=g}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,u){n.call(this);var d=(u=u||{}).fontSize||this.getFontSize(),f=u.font||this.getFont(),h=u.scaleFactor||this.internal.scaleFactor,p=0,m=0,g=0,y=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var b=u.maxWidth;b>0?typeof c=="string"?c=this.splitTextToSize(c,b):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(w,S){return w.concat(y.splitTextToSize(S,b))},[])):c=Array.isArray(c)?c:[c];for(var v=0;v<c.length;v++)p<(g=this.getStringUnitWidth(c[v],{font:f})*d)&&(p=g);return p!==0&&(m=c.length),{w:p/=h,h:Math.max((m*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/h,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var c;c=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var u=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,f=this.internal.__cell__.margins||t,h=this.internal.__cell__.tableHeaderRow,p=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=f.top,p&&h&&(this.printHeaderRow(c.lineNumber,!0),c.y+=h[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};e.table=function(c,u,d,f,h){if(n.call(this),!d)throw new Error("No data for PDF table.");var p,m,g,y,b=[],v=[],w=[],S={},j={},k=[],A=[],R=(h=h||{}).autoSize||!1,M=h.printHeaders!==!1,B=h.css&&h.css["font-size"]!==void 0?16*h.css["font-size"]:h.fontSize||12,E=h.margins||Object.assign({width:this.getPageWidth()},t),P=typeof h.padding=="number"?h.padding:3,U=h.headerBackgroundColor||"#c8c8c8",G=h.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=M,this.internal.__cell__.margins=E,this.internal.__cell__.table_font_size=B,this.internal.__cell__.padding=P,this.internal.__cell__.headerBackgroundColor=U,this.internal.__cell__.headerTextColor=G,this.setFontSize(B),f==null)v=b=Object.keys(d[0]),w=b.map(function(){return"left"});else if(Array.isArray(f)&&Hi(f[0])==="object")for(b=f.map(function(ae){return ae.name}),v=f.map(function(ae){return ae.prompt||ae.name||""}),w=f.map(function(ae){return ae.align||"left"}),p=0;p<f.length;p+=1)j[f[p].name]=.7499990551181103*f[p].width;else Array.isArray(f)&&typeof f[0]=="string"&&(v=b=f,w=b.map(function(){return"left"}));if(R||Array.isArray(f)&&typeof f[0]=="string")for(p=0;p<b.length;p+=1){for(S[y=b[p]]=d.map(function(ae){return ae[y]}),this.setFont(void 0,"bold"),k.push(this.getTextDimensions(v[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),m=S[y],this.setFont(void 0,"normal"),g=0;g<m.length;g+=1)k.push(this.getTextDimensions(m[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);j[y]=Math.max.apply(null,k)+P+P,k=[]}if(M){var H={};for(p=0;p<b.length;p+=1)H[b[p]]={},H[b[p]].text=v[p],H[b[p]].align=w[p];var oe=l.call(this,H,j);A=b.map(function(ae){return new s(c,u,j[ae],oe,H[ae].text,void 0,H[ae].align)}),this.setTableHeaderRow(A),this.printHeaderRow(1,!1)}var de=f.reduce(function(ae,ee){return ae[ee.name]=ee.align,ae},{});for(p=0;p<d.length;p+=1){"rowStart"in h&&h.rowStart instanceof Function&&h.rowStart({row:p,data:d[p]},this);var W=l.call(this,d[p],j);for(g=0;g<b.length;g+=1){var V=d[p][b[g]];"cellStart"in h&&h.cellStart instanceof Function&&h.cellStart({row:p,col:g,data:V},this),o.call(this,new s(c,u,j[b[g]],W,V,p+2,de[b[g]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var d=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,h=this.internal.scaleFactor;return Object.keys(c).map(function(p){var m=c[p];return this.splitTextToSize(m.hasOwnProperty("text")?m.text:m,u[p]-d-d)},this).map(function(p){return this.getLineHeightFactor()*p.length*f/h+d+d},this).reduce(function(p,m){return Math.max(p,m)},0)};e.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var h=[],p=0;p<this.internal.__cell__.tableHeaderRow.length;p+=1){d=this.internal.__cell__.tableHeaderRow[p].clone(),u&&(d.y=this.internal.__cell__.margins.top||0,h.push(d)),d.lineNumber=c;var m=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,d),this.setTextColor(m)}h.length>0&&this.setTableHeaderRow(h),this.setFont(void 0,"normal"),r=!1}}(Un.API);var Iz={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Dz=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],sA=Bz(Dz),$z=[100,200,300,400,500,600,700,800,900],Oge=Bz($z);function Cj(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(s){return Iz[s=s||"normal"]?s:"normal"}(e.style),n=function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400}(e.weight),i=function(s){return typeof sA[s=s||"normal"]=="number"?s:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:i,src:e.src||[],ref:e.ref||{name:t,style:[i,r,n].join(" ")}}}function oM(e,t,r,n){var i;for(i=r;i>=0&&i<t.length;i+=n)if(e[t[i]])return e[t[i]];for(i=r;i>=0&&i<t.length;i-=n)if(e[t[i]])return e[t[i]]}var Mge={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},lM={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function cM(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function uM(e){return e.trimLeft()}function Lge(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function Rge(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var vp,Db,dM,fM,hM,Ej=["times"];function pM(e,t,r,n,i){var s=4,o=gM;switch(i){case Un.API.image_compression.FAST:s=1,o=mM;break;case Un.API.image_compression.MEDIUM:s=6,o=xM;break;case Un.API.image_compression.SLOW:s=9,o=yM}e=function(c,u,d,f){for(var h,p=c.length/u,m=new Uint8Array(c.length+p),g=[Fge,mM,gM,xM,yM],y=0;y<p;y+=1){var b=y*u,v=c.subarray(b,b+u);if(f)m.set(f(v,d,h),b+y);else{for(var w=g.length,S=[],j=0;j<w;j+=1)S[j]=g[j](v,d,h);var k=Ige(S.concat());m.set(S[k],b+y)}h=v}return m}(e,t,Math.ceil(r*n/8),o);var l=Z4(e,{level:s});return Un.API.__addimage__.arrayBufferToBinaryString(l)}function Fge(e){var t=Array.apply([],e);return t.unshift(0),t}function mM(e,t){var r=e.length,n=[];n[0]=1;for(var i=0;i<r;i+=1){var s=e[i-t]||0;n[i+1]=e[i]-s+256&255}return n}function gM(e,t,r){var n=e.length,i=[];i[0]=2;for(var s=0;s<n;s+=1){var o=r&&r[s]||0;i[s+1]=e[s]-o+256&255}return i}function xM(e,t,r){var n=e.length,i=[];i[0]=3;for(var s=0;s<n;s+=1){var o=e[s-t]||0,l=r&&r[s]||0;i[s+1]=e[s]+256-(o+l>>>1)&255}return i}function yM(e,t,r){var n=e.length,i=[];i[0]=4;for(var s=0;s<n;s+=1){var o=Bge(e[s-t]||0,r&&r[s]||0,r&&r[s-t]||0);i[s+1]=e[s]-o+256&255}return i}function Bge(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),i=Math.abs(e-r),s=Math.abs(e+t-r-r);return n<=i&&n<=s?e:i<=s?t:r}function Ige(e){var t=e.map(function(r){return r.reduce(function(n,i){return n+Math.abs(i)},0)});return t.indexOf(Math.min.apply(null,t))}function Tj(e,t,r){var n=t*r,i=Math.floor(n/8),s=16-(n-8*i+r),o=(1<<r)-1;return Uz(e,i)>>s&o}function bM(e,t,r,n){var i=r*n,s=Math.floor(i/8),o=16-(i-8*s+n),l=(1<<n)-1,c=(t&l)<<o;(function(u,d,f){if(d+1<u.byteLength)u.setUint16(d,f,!1);else{var h=f>>8&255;u.setUint8(d,h)}})(e,s,Uz(e,s)&~(l<<o)&65535|c)}function Uz(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function Dge(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,i=e[t++],s=i>>7,o=1<<1+(7&i);e[t++],e[t++];var l=null,c=null;s&&(l=t,c=o,t+=3*o);var u=!0,d=[],f=0,h=null,p=0,m=null;for(this.width=r,this.height=n;u&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,m=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((E=e[t++])>=0))throw Error("Invalid block size");if(E===0)break;t+=E}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var g=e[t++];f=e[t++]|e[t++]<<8,h=e[t++],1&g||(h=null),p=g>>2&7,t++;break;case 254:for(;;){if(!((E=e[t++])>=0))throw Error("Invalid block size");if(E===0)break;t+=E}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var y=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,v=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,S=e[t++],j=S>>6&1,k=1<<1+(7&S),A=l,R=c,M=!1;S>>7&&(M=!0,A=t,R=k,t+=3*k);var B=t;for(t++;;){var E;if(!((E=e[t++])>=0))throw Error("Invalid block size");if(E===0)break;t+=E}d.push({x:y,y:b,width:v,height:w,has_local_palette:M,palette_offset:A,palette_size:R,data_offset:B,data_length:t-B,transparent_index:h,interlaced:!!j,delay:f,disposal:p});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return m},this.frameInfo=function(P){if(P<0||P>=d.length)throw new Error("Frame index out of range.");return d[P]},this.decodeAndBlitFrameBGRA=function(P,U){var G=this.frameInfo(P),H=G.width*G.height,oe=new Uint8Array(H);vM(e,G.data_offset,oe,H);var de=G.palette_offset,W=G.transparent_index;W===null&&(W=256);var V=G.width,ae=r-V,ee=V,C=4*(G.y*r+G.x),Y=4*((G.y+G.height)*r+G.x),q=C,O=4*ae;G.interlaced===!0&&(O+=4*r*7);for(var X=8,F=0,Q=oe.length;F<Q;++F){var K=oe[F];if(ee===0&&(ee=V,(q+=O)>=Y&&(O=4*ae+4*r*(X-1),q=C+(V+ae)*(X<<1),X>>=1)),K===W)q+=4;else{var ne=e[de+3*K],re=e[de+3*K+1],T=e[de+3*K+2];U[q++]=T,U[q++]=re,U[q++]=ne,U[q++]=255}--ee}},this.decodeAndBlitFrameRGBA=function(P,U){var G=this.frameInfo(P),H=G.width*G.height,oe=new Uint8Array(H);vM(e,G.data_offset,oe,H);var de=G.palette_offset,W=G.transparent_index;W===null&&(W=256);var V=G.width,ae=r-V,ee=V,C=4*(G.y*r+G.x),Y=4*((G.y+G.height)*r+G.x),q=C,O=4*ae;G.interlaced===!0&&(O+=4*r*7);for(var X=8,F=0,Q=oe.length;F<Q;++F){var K=oe[F];if(ee===0&&(ee=V,(q+=O)>=Y&&(O=4*ae+4*r*(X-1),q=C+(V+ae)*(X<<1),X>>=1)),K===W)q+=4;else{var ne=e[de+3*K],re=e[de+3*K+1],T=e[de+3*K+2];U[q++]=ne,U[q++]=re,U[q++]=T,U[q++]=255}--ee}}}function vM(e,t,r,n){for(var i=e[t++],s=1<<i,o=s+1,l=o+1,c=i+1,u=(1<<c)-1,d=0,f=0,h=0,p=e[t++],m=new Int32Array(4096),g=null;;){for(;d<16&&p!==0;)f|=e[t++]<<d,d+=8,p===1?p=e[t++]:--p;if(d<c)break;var y=f&u;if(f>>=c,d-=c,y!==s){if(y===o)break;for(var b=y<l?y:g,v=0,w=b;w>s;)w=m[w]>>8,++v;var S=w;if(h+v+(b!==y?1:0)>n)return void na.log("Warning, gif stream longer than expected.");r[h++]=S;var j=h+=v;for(b!==y&&(r[h++]=S),w=b;v--;)w=m[w],r[--j]=255&w,w>>=8;g!==null&&l<4096&&(m[l++]=g<<8|S,l>=u+1&&c<12&&(++c,u=u<<1|1)),g=y}else l=o+1,u=(1<<(c=i+1))-1,g=null}return h!==n&&na.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Pj(e){var t,r,n,i,s,o=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),d=new Array(64),f=new Array(65535),h=new Array(65535),p=new Array(64),m=new Array(64),g=[],y=0,b=7,v=new Array(64),w=new Array(64),S=new Array(64),j=new Array(256),k=new Array(2048),A=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],R=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],M=[0,1,2,3,4,5,6,7,8,9,10,11],B=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],E=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],P=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],U=[0,1,2,3,4,5,6,7,8,9,10,11],G=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],H=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function oe(C,Y){for(var q=0,O=0,X=new Array,F=1;F<=16;F++){for(var Q=1;Q<=C[F];Q++)X[Y[O]]=[],X[Y[O]][0]=q,X[Y[O]][1]=F,O++,q++;q*=2}return X}function de(C){for(var Y=C[0],q=C[1]-1;q>=0;)Y&1<<q&&(y|=1<<b),q--,--b<0&&(y==255?(W(255),W(0)):W(y),b=7,y=0)}function W(C){g.push(C)}function V(C){W(C>>8&255),W(255&C)}function ae(C,Y,q,O,X){for(var F,Q=X[0],K=X[240],ne=function(je,Le){var _e,He,We,Pt,dt,Ye,lt,be,ke,ce,we=0;for(ke=0;ke<8;++ke){_e=je[we],He=je[we+1],We=je[we+2],Pt=je[we+3],dt=je[we+4],Ye=je[we+5],lt=je[we+6];var ht=_e+(be=je[we+7]),nt=_e-be,Ie=He+lt,It=He-lt,ct=We+Ye,Mt=We-Ye,xr=Pt+dt,Pr=Pt-dt,Nt=ht+xr,Jr=ht-xr,Ur=Ie+ct,qr=Ie-ct;je[we]=Nt+Ur,je[we+4]=Nt-Ur;var cn=.707106781*(qr+Jr);je[we+2]=Jr+cn,je[we+6]=Jr-cn;var Pn=.382683433*((Nt=Pr+Mt)-(qr=It+nt)),Lr=.5411961*Nt+Pn,mn=1.306562965*qr+Pn,Me=.707106781*(Ur=Mt+It),qe=nt+Me,ut=nt-Me;je[we+5]=ut+Lr,je[we+3]=ut-Lr,je[we+1]=qe+mn,je[we+7]=qe-mn,we+=8}for(we=0,ke=0;ke<8;++ke){_e=je[we],He=je[we+8],We=je[we+16],Pt=je[we+24],dt=je[we+32],Ye=je[we+40],lt=je[we+48];var wt=_e+(be=je[we+56]),At=_e-be,sr=He+lt,Zt=He-lt,Cr=We+Ye,se=We-Ye,ue=Pt+dt,J=Pt-dt,pe=wt+ue,xe=wt-ue,Ne=sr+Cr,St=sr-Cr;je[we]=pe+Ne,je[we+32]=pe-Ne;var Ve=.707106781*(St+xe);je[we+16]=xe+Ve,je[we+48]=xe-Ve;var De=.382683433*((pe=J+se)-(St=Zt+At)),Re=.5411961*pe+De,xt=1.306562965*St+De,Vt=.707106781*(Ne=se+Zt),qt=At+Vt,zt=At-Vt;je[we+40]=zt+Re,je[we+24]=zt-Re,je[we+8]=qt+xt,je[we+56]=qt-xt,we++}for(ke=0;ke<64;++ke)ce=je[ke]*Le[ke],p[ke]=ce>0?ce+.5|0:ce-.5|0;return p}(C,Y),re=0;re<64;++re)m[A[re]]=ne[re];var T=m[0]-q;q=m[0],T==0?de(O[0]):(de(O[h[F=32767+T]]),de(f[F]));for(var I=63;I>0&&m[I]==0;)I--;if(I==0)return de(Q),q;for(var ie,D=1;D<=I;){for(var Z=D;m[D]==0&&D<=I;)++D;var me=D-Z;if(me>=16){ie=me>>4;for(var Te=1;Te<=ie;++Te)de(K);me&=15}F=32767+m[D],de(X[(me<<4)+h[F]]),de(f[F]),D++}return I!=63&&de(Q),q}function ee(C){C=Math.min(Math.max(C,1),100),s!=C&&(function(Y){for(var q=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],O=0;O<64;O++){var X=o((q[O]*Y+50)/100);X=Math.min(Math.max(X,1),255),l[A[O]]=X}for(var F=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Q=0;Q<64;Q++){var K=o((F[Q]*Y+50)/100);K=Math.min(Math.max(K,1),255),c[A[Q]]=K}for(var ne=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],re=0,T=0;T<8;T++)for(var I=0;I<8;I++)u[re]=1/(l[A[re]]*ne[T]*ne[I]*8),d[re]=1/(c[A[re]]*ne[T]*ne[I]*8),re++}(C<50?Math.floor(5e3/C):Math.floor(200-2*C)),s=C)}this.encode=function(C,Y){Y&&ee(Y),g=new Array,y=0,b=7,V(65496),V(65504),V(16),W(74),W(70),W(73),W(70),W(0),W(1),W(1),W(0),V(1),V(1),W(0),W(0),function(){V(65499),V(132),W(0);for(var He=0;He<64;He++)W(l[He]);W(1);for(var We=0;We<64;We++)W(c[We])}(),function(He,We){V(65472),V(17),W(8),V(We),V(He),W(3),W(1),W(17),W(0),W(2),W(17),W(1),W(3),W(17),W(1)}(C.width,C.height),function(){V(65476),V(418),W(0);for(var He=0;He<16;He++)W(R[He+1]);for(var We=0;We<=11;We++)W(M[We]);W(16);for(var Pt=0;Pt<16;Pt++)W(B[Pt+1]);for(var dt=0;dt<=161;dt++)W(E[dt]);W(1);for(var Ye=0;Ye<16;Ye++)W(P[Ye+1]);for(var lt=0;lt<=11;lt++)W(U[lt]);W(17);for(var be=0;be<16;be++)W(G[be+1]);for(var ke=0;ke<=161;ke++)W(H[ke])}(),V(65498),V(12),W(3),W(1),W(0),W(2),W(17),W(3),W(17),W(0),W(63),W(0);var q=0,O=0,X=0;y=0,b=7,this.encode.displayName="_encode_";for(var F,Q,K,ne,re,T,I,ie,D,Z=C.data,me=C.width,Te=C.height,je=4*me,Le=0;Le<Te;){for(F=0;F<je;){for(re=je*Le+F,I=-1,ie=0,D=0;D<64;D++)T=re+(ie=D>>3)*je+(I=4*(7&D)),Le+ie>=Te&&(T-=je*(Le+1+ie-Te)),F+I>=je&&(T-=F+I-je+4),Q=Z[T++],K=Z[T++],ne=Z[T++],v[D]=(k[Q]+k[K+256|0]+k[ne+512|0]>>16)-128,w[D]=(k[Q+768|0]+k[K+1024|0]+k[ne+1280|0]>>16)-128,S[D]=(k[Q+1280|0]+k[K+1536|0]+k[ne+1792|0]>>16)-128;q=ae(v,u,q,t,n),O=ae(w,d,O,r,i),X=ae(S,d,X,r,i),F+=32}Le+=8}if(b>=0){var _e=[];_e[1]=b+1,_e[0]=(1<<b+1)-1,de(_e)}return V(65497),new Uint8Array(g)},e=e||50,function(){for(var C=String.fromCharCode,Y=0;Y<256;Y++)j[Y]=C(Y)}(),t=oe(R,M),r=oe(P,U),n=oe(B,E),i=oe(G,H),function(){for(var C=1,Y=2,q=1;q<=15;q++){for(var O=C;O<Y;O++)h[32767+O]=q,f[32767+O]=[],f[32767+O][1]=q,f[32767+O][0]=O;for(var X=-(Y-1);X<=-C;X++)h[32767+X]=q,f[32767+X]=[],f[32767+X][1]=q,f[32767+X][0]=Y-1+X;C<<=1,Y<<=1}}(),function(){for(var C=0;C<256;C++)k[C]=19595*C,k[C+256|0]=38470*C,k[C+512|0]=7471*C+32768,k[C+768|0]=-11059*C,k[C+1024|0]=-21709*C,k[C+1280|0]=32768*C+8421375,k[C+1536|0]=-27439*C,k[C+1792|0]=-5329*C}(),ee(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function ru(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function wM(e){function t(M){if(!M)throw Error("assert :P")}function r(M,B,E){for(var P=0;4>P;P++)if(M[B+P]!=E.charCodeAt(P))return!0;return!1}function n(M,B,E,P,U){for(var G=0;G<U;G++)M[B+G]=E[P+G]}function i(M,B,E,P){for(var U=0;U<P;U++)M[B+U]=E}function s(M){return new Int32Array(M)}function o(M,B){for(var E=[],P=0;P<M;P++)E.push(new B);return E}function l(M,B){var E=[];return function P(U,G,H){for(var oe=H[G],de=0;de<oe&&(U.push(H.length>G+1?[]:new B),!(H.length<G+1));de++)P(U[de],G+1,H)}(E,0,M),E}var c=function(){var M=this;function B(_,N){for(var z=1<<N-1>>>0;_&z;)z>>>=1;return z?(_&z-1)+z:_}function E(_,N,z,te,he){t(!(te%z));do _[N+(te-=z)]=he;while(0<te)}function P(_,N,z,te,he){if(t(2328>=he),512>=he)var ge=s(512);else if((ge=s(he))==null)return 0;return function(ve,Ae,Pe,Ge,Ot,rr){var Ke,Ft,Yt=Ae,Ar=1<<Pe,Jt=s(16),Er=s(16);for(t(Ot!=0),t(Ge!=null),t(ve!=null),t(0<Pe),Ft=0;Ft<Ot;++Ft){if(15<Ge[Ft])return 0;++Jt[Ge[Ft]]}if(Jt[0]==Ot)return 0;for(Er[1]=0,Ke=1;15>Ke;++Ke){if(Jt[Ke]>1<<Ke)return 0;Er[Ke+1]=Er[Ke]+Jt[Ke]}for(Ft=0;Ft<Ot;++Ft)Ke=Ge[Ft],0<Ge[Ft]&&(rr[Er[Ke]++]=Ft);if(Er[15]==1)return(Ge=new U).g=0,Ge.value=rr[0],E(ve,Yt,1,Ar,Ge),Ar;var Or,Yr=-1,zr=Ar-1,$n=0,On=1,ui=1,Fn=1<<Pe;for(Ft=0,Ke=1,Ot=2;Ke<=Pe;++Ke,Ot<<=1){if(On+=ui<<=1,0>(ui-=Jt[Ke]))return 0;for(;0<Jt[Ke];--Jt[Ke])(Ge=new U).g=Ke,Ge.value=rr[Ft++],E(ve,Yt+$n,Ot,Fn,Ge),$n=B($n,Ke)}for(Ke=Pe+1,Ot=2;15>=Ke;++Ke,Ot<<=1){if(On+=ui<<=1,0>(ui-=Jt[Ke]))return 0;for(;0<Jt[Ke];--Jt[Ke]){if(Ge=new U,($n&zr)!=Yr){for(Yt+=Fn,Or=1<<(Yr=Ke)-Pe;15>Yr&&!(0>=(Or-=Jt[Yr]));)++Yr,Or<<=1;Ar+=Fn=1<<(Or=Yr-Pe),ve[Ae+(Yr=$n&zr)].g=Or+Pe,ve[Ae+Yr].value=Yt-Ae-Yr}Ge.g=Ke-Pe,Ge.value=rr[Ft++],E(ve,Yt+($n>>Pe),Ot,Fn,Ge),$n=B($n,Ke)}}return On!=2*Er[15]-1?0:Ar}(_,N,z,te,he,ge)}function U(){this.value=this.g=0}function G(){this.value=this.g=0}function H(){this.G=o(5,U),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(_o,G)}function oe(_,N,z,te){t(_!=null),t(N!=null),t(2147483648>te),_.Ca=254,_.I=0,_.b=-8,_.Ka=0,_.oa=N,_.pa=z,_.Jd=N,_.Yc=z+te,_.Zc=4<=te?z+te-4+1:z,Q(_)}function de(_,N){for(var z=0;0<N--;)z|=ne(_,128)<<N;return z}function W(_,N){var z=de(_,N);return K(_)?-z:z}function V(_,N,z,te){var he,ge=0;for(t(_!=null),t(N!=null),t(4294967288>te),_.Sb=te,_.Ra=0,_.u=0,_.h=0,4<te&&(te=4),he=0;he<te;++he)ge+=N[z+he]<<8*he;_.Ra=ge,_.bb=te,_.oa=N,_.pa=z}function ae(_){for(;8<=_.u&&_.bb<_.Sb;)_.Ra>>>=8,_.Ra+=_.oa[_.pa+_.bb]<<cs-8>>>0,++_.bb,_.u-=8;O(_)&&(_.h=1,_.u=0)}function ee(_,N){if(t(0<=N),!_.h&&N<=ba){var z=q(_)&Ss[N];return _.u+=N,ae(_),z}return _.h=1,_.u=0}function C(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function Y(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function q(_){return _.Ra>>>(_.u&cs-1)>>>0}function O(_){return t(_.bb<=_.Sb),_.h||_.bb==_.Sb&&_.u>cs}function X(_,N){_.u=N,_.h=O(_)}function F(_){_.u>=Bi&&(t(_.u>=Bi),ae(_))}function Q(_){t(_!=null&&_.oa!=null),_.pa<_.Zc?(_.I=(_.oa[_.pa++]|_.I<<8)>>>0,_.b+=8):(t(_!=null&&_.oa!=null),_.pa<_.Yc?(_.b+=8,_.I=_.oa[_.pa++]|_.I<<8):_.Ka?_.b=0:(_.I<<=8,_.b+=8,_.Ka=1))}function K(_){return de(_,1)}function ne(_,N){var z=_.Ca;0>_.b&&Q(_);var te=_.b,he=z*N>>>8,ge=(_.I>>>te>he)+0;for(ge?(z-=he,_.I-=he+1<<te>>>0):z=he+1,te=z,he=0;256<=te;)he+=8,te>>=8;return te=7^he+Aa[te],_.b-=te,_.Ca=(z<<te)-1,ge}function re(_,N,z){_[N+0]=z>>24&255,_[N+1]=z>>16&255,_[N+2]=z>>8&255,_[N+3]=255&z}function T(_,N){return _[N+0]|_[N+1]<<8}function I(_,N){return T(_,N)|_[N+2]<<16}function ie(_,N){return T(_,N)|T(_,N+2)<<16}function D(_,N){var z=1<<N;return t(_!=null),t(0<N),_.X=s(z),_.X==null?0:(_.Mb=32-N,_.Xa=N,1)}function Z(_,N){t(_!=null),t(N!=null),t(_.Xa==N.Xa),n(N.X,0,_.X,0,1<<N.Xa)}function me(){this.X=[],this.Xa=this.Mb=0}function Te(_,N,z,te){t(z!=null),t(te!=null);var he=z[0],ge=te[0];return he==0&&(he=(_*ge+N/2)/N),ge==0&&(ge=(N*he+_/2)/_),0>=he||0>=ge?0:(z[0]=he,te[0]=ge,1)}function je(_,N){return _+(1<<N)-1>>>N}function Le(_,N){return((4278255360&_)+(4278255360&N)>>>0&4278255360)+((16711935&_)+(16711935&N)>>>0&16711935)>>>0}function _e(_,N){M[N]=function(z,te,he,ge,ve,Ae,Pe){var Ge;for(Ge=0;Ge<ve;++Ge){var Ot=M[_](Ae[Pe+Ge-1],he,ge+Ge);Ae[Pe+Ge]=Le(z[te+Ge],Ot)}}}function He(){this.ud=this.hd=this.jd=0}function We(_,N){return((4278124286&(_^N))>>>1)+(_&N)>>>0}function Pt(_){return 0<=_&&256>_?_:0>_?0:255<_?255:void 0}function dt(_,N){return Pt(_+(_-N+.5>>1))}function Ye(_,N,z){return Math.abs(N-z)-Math.abs(_-z)}function lt(_,N,z,te,he,ge,ve){for(te=ge[ve-1],z=0;z<he;++z)ge[ve+z]=te=Le(_[N+z],te)}function be(_,N,z,te,he){var ge;for(ge=0;ge<z;++ge){var ve=_[N+ge],Ae=ve>>8&255,Pe=16711935&(Pe=(Pe=16711935&ve)+((Ae<<16)+Ae));te[he+ge]=(4278255360&ve)+Pe>>>0}}function ke(_,N){N.jd=255&_,N.hd=_>>8&255,N.ud=_>>16&255}function ce(_,N,z,te,he,ge){var ve;for(ve=0;ve<te;++ve){var Ae=N[z+ve],Pe=Ae>>>8,Ge=Ae,Ot=255&(Ot=(Ot=Ae>>>16)+((_.jd<<24>>24)*(Pe<<24>>24)>>>5));Ge=255&(Ge=(Ge+=(_.hd<<24>>24)*(Pe<<24>>24)>>>5)+((_.ud<<24>>24)*(Ot<<24>>24)>>>5)),he[ge+ve]=(4278255360&Ae)+(Ot<<16)+Ge}}function we(_,N,z,te,he){M[N]=function(ge,ve,Ae,Pe,Ge,Ot,rr,Ke,Ft){for(Pe=rr;Pe<Ke;++Pe)for(rr=0;rr<Ft;++rr)Ge[Ot++]=he(Ae[te(ge[ve++])])},M[_]=function(ge,ve,Ae,Pe,Ge,Ot,rr){var Ke=8>>ge.b,Ft=ge.Ea,Yt=ge.K[0],Ar=ge.w;if(8>Ke)for(ge=(1<<ge.b)-1,Ar=(1<<Ke)-1;ve<Ae;++ve){var Jt,Er=0;for(Jt=0;Jt<Ft;++Jt)Jt&ge||(Er=te(Pe[Ge++])),Ot[rr++]=he(Yt[Er&Ar]),Er>>=Ke}else M["VP8LMapColor"+z](Pe,Ge,Yt,Ar,Ot,rr,ve,Ae,Ft)}}function ht(_,N,z,te,he){for(z=N+z;N<z;){var ge=_[N++];te[he++]=ge>>16&255,te[he++]=ge>>8&255,te[he++]=255&ge}}function nt(_,N,z,te,he){for(z=N+z;N<z;){var ge=_[N++];te[he++]=ge>>16&255,te[he++]=ge>>8&255,te[he++]=255&ge,te[he++]=ge>>24&255}}function Ie(_,N,z,te,he){for(z=N+z;N<z;){var ge=(ve=_[N++])>>16&240|ve>>12&15,ve=240&ve|ve>>28&15;te[he++]=ge,te[he++]=ve}}function It(_,N,z,te,he){for(z=N+z;N<z;){var ge=(ve=_[N++])>>16&248|ve>>13&7,ve=ve>>5&224|ve>>3&31;te[he++]=ge,te[he++]=ve}}function ct(_,N,z,te,he){for(z=N+z;N<z;){var ge=_[N++];te[he++]=255&ge,te[he++]=ge>>8&255,te[he++]=ge>>16&255}}function Mt(_,N,z,te,he,ge){if(ge==0)for(z=N+z;N<z;)re(te,((ge=_[N++])[0]>>24|ge[1]>>8&65280|ge[2]<<8&16711680|ge[3]<<24)>>>0),he+=32;else n(te,he,_,N,z)}function xr(_,N){M[N][0]=M[_+"0"],M[N][1]=M[_+"1"],M[N][2]=M[_+"2"],M[N][3]=M[_+"3"],M[N][4]=M[_+"4"],M[N][5]=M[_+"5"],M[N][6]=M[_+"6"],M[N][7]=M[_+"7"],M[N][8]=M[_+"8"],M[N][9]=M[_+"9"],M[N][10]=M[_+"10"],M[N][11]=M[_+"11"],M[N][12]=M[_+"12"],M[N][13]=M[_+"13"],M[N][14]=M[_+"0"],M[N][15]=M[_+"0"]}function Pr(_){return _==t5||_==r5||_==Vy||_==n5}function Nt(){this.eb=[],this.size=this.A=this.fb=0}function Jr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Ur(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Nt,this.f.kb=new Jr,this.sd=null}function qr(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function cn(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Pn(_){return alert("todo:WebPSamplerProcessPlane"),_.T}function Lr(_,N){var z=_.T,te=N.ba.f.RGBA,he=te.eb,ge=te.fb+_.ka*te.A,ve=wc[N.ba.S],Ae=_.y,Pe=_.O,Ge=_.f,Ot=_.N,rr=_.ea,Ke=_.W,Ft=N.cc,Yt=N.dc,Ar=N.Mc,Jt=N.Nc,Er=_.ka,Or=_.ka+_.T,Yr=_.U,zr=Yr+1>>1;for(Er==0?ve(Ae,Pe,null,null,Ge,Ot,rr,Ke,Ge,Ot,rr,Ke,he,ge,null,null,Yr):(ve(N.ec,N.fc,Ae,Pe,Ft,Yt,Ar,Jt,Ge,Ot,rr,Ke,he,ge-te.A,he,ge,Yr),++z);Er+2<Or;Er+=2)Ft=Ge,Yt=Ot,Ar=rr,Jt=Ke,Ot+=_.Rc,Ke+=_.Rc,ge+=2*te.A,ve(Ae,(Pe+=2*_.fa)-_.fa,Ae,Pe,Ft,Yt,Ar,Jt,Ge,Ot,rr,Ke,he,ge-te.A,he,ge,Yr);return Pe+=_.fa,_.j+Or<_.o?(n(N.ec,N.fc,Ae,Pe,Yr),n(N.cc,N.dc,Ge,Ot,zr),n(N.Mc,N.Nc,rr,Ke,zr),z--):1&Or||ve(Ae,Pe,null,null,Ge,Ot,rr,Ke,Ge,Ot,rr,Ke,he,ge+te.A,null,null,Yr),z}function mn(_,N,z){var te=_.F,he=[_.J];if(te!=null){var ge=_.U,ve=N.ba.S,Ae=ve==Hy||ve==Vy;N=N.ba.f.RGBA;var Pe=[0],Ge=_.ka;Pe[0]=_.T,_.Kb&&(Ge==0?--Pe[0]:(--Ge,he[0]-=_.width),_.j+_.ka+_.T==_.o&&(Pe[0]=_.o-_.j-Ge));var Ot=N.eb;Ge=N.fb+Ge*N.A,_=F6(te,he[0],_.width,ge,Pe,Ot,Ge+(Ae?0:3),N.A),t(z==Pe),_&&Pr(ve)&&Cg(Ot,Ge,Ae,ge,Pe,N.A)}return 0}function Me(_){var N=_.ma,z=N.ba.S,te=11>z,he=z==Wy||z==qy||z==Hy||z==e5||z==12||Pr(z);if(N.memory=null,N.Ib=null,N.Jb=null,N.Nd=null,!Rl(N.Oa,_,he?11:12))return 0;if(he&&Pr(z)&&jr(),_.da)alert("todo:use_scaling");else{if(te){if(N.Ib=Pn,_.Kb){if(z=_.U+1>>1,N.memory=s(_.U+2*z),N.memory==null)return 0;N.ec=N.memory,N.fc=0,N.cc=N.ec,N.dc=N.fc+_.U,N.Mc=N.cc,N.Nc=N.dc+z,N.Ib=Lr,jr()}}else alert("todo:EmitYUV");he&&(N.Jb=mn,te&&ar())}if(te&&!J6){for(_=0;256>_;++_)eY[_]=89858*(_-128)+Ky>>Gy,nY[_]=-22014*(_-128)+Ky,rY[_]=-45773*(_-128),tY[_]=113618*(_-128)+Ky>>Gy;for(_=Tg;_<s5;++_)N=76283*(_-16)+Ky>>Gy,iY[_-Tg]=Tr(N,255),aY[_-Tg]=Tr(N+8>>4,15);J6=1}return 1}function qe(_){var N=_.ma,z=_.U,te=_.T;return t(!(1&_.ka)),0>=z||0>=te?0:(z=N.Ib(_,N),N.Jb!=null&&N.Jb(_,N,z),N.Dc+=z,1)}function ut(_){_.ma.memory=null}function wt(_,N,z,te){return ee(_,8)!=47?0:(N[0]=ee(_,14)+1,z[0]=ee(_,14)+1,te[0]=ee(_,1),ee(_,3)!=0?0:!_.h)}function At(_,N){if(4>_)return _+1;var z=_-2>>1;return(2+(1&_)<<z)+ee(N,z)+1}function sr(_,N){return 120<N?N-120:1<=(z=((z=$K[N-1])>>4)*_+(8-(15&z)))?z:1;var z}function Zt(_,N,z){var te=q(z),he=_[N+=255&te].g-8;return 0<he&&(X(z,z.u+8),te=q(z),N+=_[N].value,N+=te&(1<<he)-1),X(z,z.u+_[N].g),_[N].value}function Cr(_,N,z){return z.g+=_.g,z.value+=_.value<<N>>>0,t(8>=z.g),_.g}function se(_,N,z){var te=_.xc;return t((N=te==0?0:_.vc[_.md*(z>>te)+(N>>te)])<_.Wb),_.Ya[N]}function ue(_,N,z,te){var he=_.ab,ge=_.c*N,ve=_.C;N=ve+N;var Ae=z,Pe=te;for(te=_.Ta,z=_.Ua;0<he--;){var Ge=_.gc[he],Ot=ve,rr=N,Ke=Ae,Ft=Pe,Yt=(Pe=te,Ae=z,Ge.Ea);switch(t(Ot<rr),t(rr<=Ge.nc),Ge.hc){case 2:Ci(Ke,Ft,(rr-Ot)*Yt,Pe,Ae);break;case 0:var Ar=Ot,Jt=rr,Er=Pe,Or=Ae,Yr=(Fn=Ge).Ea;Ar==0&&(ro(Ke,Ft,null,null,1,Er,Or),lt(Ke,Ft+1,0,0,Yr-1,Er,Or+1),Ft+=Yr,Or+=Yr,++Ar);for(var zr=1<<Fn.b,$n=zr-1,On=je(Yr,Fn.b),ui=Fn.K,Fn=Fn.w+(Ar>>Fn.b)*On;Ar<Jt;){var wi=ui,ks=Fn,di=1;for(Au(Ke,Ft,Er,Or-Yr,1,Er,Or);di<Yr;){var Bn=(di&~$n)+zr;Bn>Yr&&(Bn=Yr),(0,Xc[wi[ks++]>>8&15])(Ke,Ft+ +di,Er,Or+di-Yr,Bn-di,Er,Or+di),di=Bn}Ft+=Yr,Or+=Yr,++Ar&$n||(Fn+=On)}rr!=Ge.nc&&n(Pe,Ae-Yt,Pe,Ae+(rr-Ot-1)*Yt,Yt);break;case 1:for(Yt=Ke,Jt=Ft,Yr=(Ke=Ge.Ea)-(Or=Ke&~(Er=(Ft=1<<Ge.b)-1)),Ar=je(Ke,Ge.b),zr=Ge.K,Ge=Ge.w+(Ot>>Ge.b)*Ar;Ot<rr;){for($n=zr,On=Ge,ui=new He,Fn=Jt+Or,wi=Jt+Ke;Jt<Fn;)ke($n[On++],ui),gc(ui,Yt,Jt,Ft,Pe,Ae),Jt+=Ft,Ae+=Ft;Jt<wi&&(ke($n[On++],ui),gc(ui,Yt,Jt,Yr,Pe,Ae),Jt+=Yr,Ae+=Yr),++Ot&Er||(Ge+=Ar)}break;case 3:if(Ke==Pe&&Ft==Ae&&0<Ge.b){for(Jt=Pe,Ke=Yt=Ae+(rr-Ot)*Yt-(Or=(rr-Ot)*je(Ge.Ea,Ge.b)),Ft=Pe,Er=Ae,Ar=[],Or=(Yr=Or)-1;0<=Or;--Or)Ar[Or]=Ft[Er+Or];for(Or=Yr-1;0<=Or;--Or)Jt[Ke+Or]=Ar[Or];Hn(Ge,Ot,rr,Pe,Yt,Pe,Ae)}else Hn(Ge,Ot,rr,Ke,Ft,Pe,Ae)}Ae=te,Pe=z}Pe!=z&&n(te,z,Ae,Pe,ge)}function J(_,N){var z=_.V,te=_.Ba+_.c*_.C,he=N-_.C;if(t(N<=_.l.o),t(16>=he),0<he){var ge=_.l,ve=_.Ta,Ae=_.Ua,Pe=ge.width;if(ue(_,he,z,te),he=Ae=[Ae],t((z=_.C)<(te=N)),t(ge.v<ge.va),te>ge.o&&(te=ge.o),z<ge.j){var Ge=ge.j-z;z=ge.j,he[0]+=Ge*Pe}if(z>=te?z=0:(he[0]+=4*ge.v,ge.ka=z-ge.j,ge.U=ge.va-ge.v,ge.T=te-z,z=1),z){if(Ae=Ae[0],11>(z=_.ca).S){var Ot=z.f.RGBA,rr=(te=z.S,he=ge.U,ge=ge.T,Ge=Ot.eb,Ot.A),Ke=ge;for(Ot=Ot.fb+_.Ma*Ot.A;0<Ke--;){var Ft=ve,Yt=Ae,Ar=he,Jt=Ge,Er=Ot;switch(te){case zy:xc(Ft,Yt,Ar,Jt,Er);break;case Wy:Yo(Ft,Yt,Ar,Jt,Er);break;case t5:Yo(Ft,Yt,Ar,Jt,Er),Cg(Jt,Er,0,Ar,1,0);break;case W6:yc(Ft,Yt,Ar,Jt,Er);break;case qy:Mt(Ft,Yt,Ar,Jt,Er,1);break;case r5:Mt(Ft,Yt,Ar,Jt,Er,1),Cg(Jt,Er,0,Ar,1,0);break;case Hy:Mt(Ft,Yt,Ar,Jt,Er,0);break;case Vy:Mt(Ft,Yt,Ar,Jt,Er,0),Cg(Jt,Er,1,Ar,1,0);break;case e5:no(Ft,Yt,Ar,Jt,Er);break;case n5:no(Ft,Yt,Ar,Jt,Er),R6(Jt,Er,Ar,1,0);break;case q6:pl(Ft,Yt,Ar,Jt,Er);break;default:t(0)}Ae+=Pe,Ot+=rr}_.Ma+=ge}else alert("todo:EmitRescaledRowsYUVA");t(_.Ma<=z.height)}}_.C=N,t(_.C<=_.i)}function pe(_){var N;if(0<_.ua)return 0;for(N=0;N<_.Wb;++N){var z=_.Ya[N].G,te=_.Ya[N].H;if(0<z[1][te[1]+0].g||0<z[2][te[2]+0].g||0<z[3][te[3]+0].g)return 0}return 1}function xe(_,N,z,te,he,ge){if(_.Z!=0){var ve=_.qd,Ae=_.rd;for(t(vf[_.Z]!=null);N<z;++N)vf[_.Z](ve,Ae,te,he,te,he,ge),ve=te,Ae=he,he+=ge;_.qd=ve,_.rd=Ae}}function Ne(_,N){var z=_.l.ma,te=z.Z==0||z.Z==1?_.l.j:_.C;if(te=_.C<te?te:_.C,t(N<=_.l.o),N>te){var he=_.l.width,ge=z.ca,ve=z.tb+he*te,Ae=_.V,Pe=_.Ba+_.c*te,Ge=_.gc;t(_.ab==1),t(Ge[0].hc==3),_s(Ge[0],te,N,Ae,Pe,ge,ve),xe(z,te,N,ge,ve,he)}_.C=_.Ma=N}function St(_,N,z,te,he,ge,ve){var Ae=_.$/te,Pe=_.$%te,Ge=_.m,Ot=_.s,rr=z+_.$,Ke=rr;he=z+te*he;var Ft=z+te*ge,Yt=280+Ot.ua,Ar=_.Pb?Ae:16777216,Jt=0<Ot.ua?Ot.Wa:null,Er=Ot.wc,Or=rr<Ft?se(Ot,Pe,Ae):null;t(_.C<ge),t(Ft<=he);var Yr=!1;e:for(;;){for(;Yr||rr<Ft;){var zr=0;if(Ae>=Ar){var $n=rr-z;t((Ar=_).Pb),Ar.wd=Ar.m,Ar.xd=$n,0<Ar.s.ua&&Z(Ar.s.Wa,Ar.s.vb),Ar=Ae+zK}if(Pe&Er||(Or=se(Ot,Pe,Ae)),t(Or!=null),Or.Qb&&(N[rr]=Or.qb,Yr=!0),!Yr)if(F(Ge),Or.jc){zr=Ge,$n=N;var On=rr,ui=Or.pd[q(zr)&_o-1];t(Or.jc),256>ui.g?(X(zr,zr.u+ui.g),$n[On]=ui.value,zr=0):(X(zr,zr.u+ui.g-256),t(256<=ui.value),zr=ui.value),zr==0&&(Yr=!0)}else zr=Zt(Or.G[0],Or.H[0],Ge);if(Ge.h)break;if(Yr||256>zr){if(!Yr)if(Or.nd)N[rr]=(Or.qb|zr<<8)>>>0;else{if(F(Ge),Yr=Zt(Or.G[1],Or.H[1],Ge),F(Ge),$n=Zt(Or.G[2],Or.H[2],Ge),On=Zt(Or.G[3],Or.H[3],Ge),Ge.h)break;N[rr]=(On<<24|Yr<<16|zr<<8|$n)>>>0}if(Yr=!1,++rr,++Pe>=te&&(Pe=0,++Ae,ve!=null&&Ae<=ge&&!(Ae%16)&&ve(_,Ae),Jt!=null))for(;Ke<rr;)zr=N[Ke++],Jt.X[(506832829*zr&4294967295)>>>Jt.Mb]=zr}else if(280>zr){if(zr=At(zr-256,Ge),$n=Zt(Or.G[4],Or.H[4],Ge),F(Ge),$n=sr(te,$n=At($n,Ge)),Ge.h)break;if(rr-z<$n||he-rr<zr)break e;for(On=0;On<zr;++On)N[rr+On]=N[rr+On-$n];for(rr+=zr,Pe+=zr;Pe>=te;)Pe-=te,++Ae,ve!=null&&Ae<=ge&&!(Ae%16)&&ve(_,Ae);if(t(rr<=he),Pe&Er&&(Or=se(Ot,Pe,Ae)),Jt!=null)for(;Ke<rr;)zr=N[Ke++],Jt.X[(506832829*zr&4294967295)>>>Jt.Mb]=zr}else{if(!(zr<Yt))break e;for(Yr=zr-280,t(Jt!=null);Ke<rr;)zr=N[Ke++],Jt.X[(506832829*zr&4294967295)>>>Jt.Mb]=zr;zr=rr,t(!(Yr>>>($n=Jt).Xa)),N[zr]=$n.X[Yr],Yr=!0}Yr||t(Ge.h==O(Ge))}if(_.Pb&&Ge.h&&rr<he)t(_.m.h),_.a=5,_.m=_.wd,_.$=_.xd,0<_.s.ua&&Z(_.s.vb,_.s.Wa);else{if(Ge.h)break e;ve!=null&&ve(_,Ae>ge?ge:Ae),_.a=0,_.$=rr-z}return 1}return _.a=3,0}function Ve(_){t(_!=null),_.vc=null,_.yc=null,_.Ya=null;var N=_.Wa;N!=null&&(N.X=null),_.vb=null,t(_!=null)}function De(){var _=new Xr;return _==null?null:(_.a=0,_.xb=G6,xr("Predictor","VP8LPredictors"),xr("Predictor","VP8LPredictors_C"),xr("PredictorAdd","VP8LPredictorsAdd"),xr("PredictorAdd","VP8LPredictorsAdd_C"),Ci=be,gc=ce,xc=ht,Yo=nt,no=Ie,pl=It,yc=ct,M.VP8LMapColor32b=Yi,M.VP8LMapColor8b=hd,_)}function Re(_,N,z,te,he){var ge=1,ve=[_],Ae=[N],Pe=te.m,Ge=te.s,Ot=null,rr=0;e:for(;;){if(z)for(;ge&&ee(Pe,1);){var Ke=ve,Ft=Ae,Yt=te,Ar=1,Jt=Yt.m,Er=Yt.gc[Yt.ab],Or=ee(Jt,2);if(Yt.Oc&1<<Or)ge=0;else{switch(Yt.Oc|=1<<Or,Er.hc=Or,Er.Ea=Ke[0],Er.nc=Ft[0],Er.K=[null],++Yt.ab,t(4>=Yt.ab),Or){case 0:case 1:Er.b=ee(Jt,3)+2,Ar=Re(je(Er.Ea,Er.b),je(Er.nc,Er.b),0,Yt,Er.K),Er.K=Er.K[0];break;case 3:var Yr,zr=ee(Jt,8)+1,$n=16<zr?0:4<zr?1:2<zr?2:3;if(Ke[0]=je(Er.Ea,$n),Er.b=$n,Yr=Ar=Re(zr,1,0,Yt,Er.K)){var On,ui=zr,Fn=Er,wi=1<<(8>>Fn.b),ks=s(wi);if(ks==null)Yr=0;else{var di=Fn.K[0],Bn=Fn.w;for(ks[0]=Fn.K[0][0],On=1;On<1*ui;++On)ks[On]=Le(di[Bn+On],ks[On-1]);for(;On<4*wi;++On)ks[On]=0;Fn.K[0]=null,Fn.K[0]=ks,Yr=1}}Ar=Yr;break;case 2:break;default:t(0)}ge=Ar}}if(ve=ve[0],Ae=Ae[0],ge&&ee(Pe,1)&&!(ge=1<=(rr=ee(Pe,4))&&11>=rr)){te.a=3;break e}var pn;if(pn=ge)t:{var Qa,ii,Si,ua=te,io=ve,Xo=Ae,Ba=rr,jo=z,Qo=ua.m,As=ua.s,ji=[null],$i=1,Ia=0,Ui=UK[Ba];r:for(;;){if(jo&&ee(Qo,1)){var ao=ee(Qo,3)+2,Jc=je(io,ao),Ja=je(Xo,ao),ml=Jc*Ja;if(!Re(Jc,Ja,0,ua,ji))break r;for(ji=ji[0],As.xc=ao,Qa=0;Qa<ml;++Qa){var ta=ji[Qa]>>8&65535;ji[Qa]=ta,ta>=$i&&($i=ta+1)}}if(Qo.h)break r;for(ii=0;5>ii;++ii){var Ns=H6[ii];!ii&&0<Ba&&(Ns+=1<<Ba),Ia<Ns&&(Ia=Ns)}var Dl=o($i*Ui,U),Jo=$i,$l=o(Jo,H);if($l==null)var Ul=null;else t(65536>=Jo),Ul=$l;var gl=s(Ia);if(Ul==null||gl==null||Dl==null){ua.a=1;break r}var zl=Dl;for(Qa=Si=0;Qa<$i;++Qa){var aa=Ul[Qa],Wl=aa.G,Zc=aa.H,Oh=0,gd=1,so=0;for(ii=0;5>ii;++ii){Ns=H6[ii],Wl[ii]=zl,Zc[ii]=Si,!ii&&0<Ba&&(Ns+=1<<Ba);i:{var Xy,o5=Ns,Qy=ua,Pg=gl,lY=zl,cY=Si,l5=0,wf=Qy.m,uY=ee(wf,1);if(i(Pg,0,0,o5),uY){var dY=ee(wf,1)+1,fY=ee(wf,1),tT=ee(wf,fY==0?1:8);Pg[tT]=1,dY==2&&(Pg[tT=ee(wf,8)]=1);var Jy=1}else{var rT=s(19),nT=ee(wf,4)+4;if(19<nT){Qy.a=3;var Zy=0;break i}for(Xy=0;Xy<nT;++Xy)rT[DK[Xy]]=ee(wf,3);var c5=void 0,Og=void 0,iT=Qy,hY=rT,eb=o5,aT=Pg,u5=0,Sf=iT.m,sT=8,oT=o(128,U);n:for(;P(oT,0,7,hY,19);){if(ee(Sf,1)){var pY=2+2*ee(Sf,3);if((c5=2+ee(Sf,pY))>eb)break n}else c5=eb;for(Og=0;Og<eb&&c5--;){F(Sf);var lT=oT[0+(127&q(Sf))];X(Sf,Sf.u+lT.g);var hp=lT.value;if(16>hp)aT[Og++]=hp,hp!=0&&(sT=hp);else{var mY=hp==16,cT=hp-16,gY=BK[cT],uT=ee(Sf,FK[cT])+gY;if(Og+uT>eb)break n;for(var xY=mY?sT:0;0<uT--;)aT[Og++]=xY}}u5=1;break n}u5||(iT.a=3),Jy=u5}(Jy=Jy&&!wf.h)&&(l5=P(lY,cY,8,Pg,o5)),Jy&&l5!=0?Zy=l5:(Qy.a=3,Zy=0)}if(Zy==0)break r;if(gd&&IK[ii]==1&&(gd=zl[Si].g==0),Oh+=zl[Si].g,Si+=Zy,3>=ii){var Mg,d5=gl[0];for(Mg=1;Mg<Ns;++Mg)gl[Mg]>d5&&(d5=gl[Mg]);so+=d5}}if(aa.nd=gd,aa.Qb=0,gd&&(aa.qb=(Wl[3][Zc[3]+0].value<<24|Wl[1][Zc[1]+0].value<<16|Wl[2][Zc[2]+0].value)>>>0,Oh==0&&256>Wl[0][Zc[0]+0].value&&(aa.Qb=1,aa.qb+=Wl[0][Zc[0]+0].value<<8)),aa.jc=!aa.Qb&&6>so,aa.jc){var tb,xd=aa;for(tb=0;tb<_o;++tb){var _f=tb,jf=xd.pd[_f],rb=xd.G[0][xd.H[0]+_f];256<=rb.value?(jf.g=rb.g+256,jf.value=rb.value):(jf.g=0,jf.value=0,_f>>=Cr(rb,8,jf),_f>>=Cr(xd.G[1][xd.H[1]+_f],16,jf),_f>>=Cr(xd.G[2][xd.H[2]+_f],0,jf),Cr(xd.G[3][xd.H[3]+_f],24,jf))}}}As.vc=ji,As.Wb=$i,As.Ya=Ul,As.yc=Dl,pn=1;break t}pn=0}if(!(ge=pn)){te.a=3;break e}if(0<rr){if(Ge.ua=1<<rr,!D(Ge.Wa,rr)){te.a=1,ge=0;break e}}else Ge.ua=0;var f5=te,dT=ve,yY=Ae,h5=f5.s,p5=h5.xc;if(f5.c=dT,f5.i=yY,h5.md=je(dT,p5),h5.wc=p5==0?-1:(1<<p5)-1,z){te.xb=YK;break e}if((Ot=s(ve*Ae))==null){te.a=1,ge=0;break e}ge=(ge=St(te,Ot,0,ve,Ae,Ae,null))&&!Pe.h;break e}return ge?(he!=null?he[0]=Ot:(t(Ot==null),t(z)),te.$=0,z||Ve(Ge)):Ve(Ge),ge}function xt(_,N){var z=_.c*_.i,te=z+N+16*N;return t(_.c<=N),_.V=s(te),_.V==null?(_.Ta=null,_.Ua=0,_.a=1,0):(_.Ta=_.V,_.Ua=_.Ba+z+N,1)}function Vt(_,N){var z=_.C,te=N-z,he=_.V,ge=_.Ba+_.c*z;for(t(N<=_.l.o);0<te;){var ve=16<te?16:te,Ae=_.l.ma,Pe=_.l.width,Ge=Pe*ve,Ot=Ae.ca,rr=Ae.tb+Pe*z,Ke=_.Ta,Ft=_.Ua;ue(_,ve,he,ge),B6(Ke,Ft,Ot,rr,Ge),xe(Ae,z,z+ve,Ot,rr,Pe),te-=ve,he+=ve*_.c,z+=ve}t(z==N),_.C=_.Ma=N}function qt(){this.ub=this.yd=this.td=this.Rb=0}function zt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function vt(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Lt(){this.Yb=function(){var _=[];return function N(z,te,he){for(var ge=he[te],ve=0;ve<ge&&(z.push(he.length>te+1?[]:0),!(he.length<te+1));ve++)N(z[ve],te+1,he)}(_,0,[3,11]),_}()}function er(){this.jb=s(3),this.Wc=l([4,8],Lt),this.Xc=l([4,17],Lt)}function yr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Br(){this.ld=this.La=this.dd=this.tc=0}function cr(){this.Na=this.la=0}function ur(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function en(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function nn(){this.uc=this.M=this.Nb=0,this.wa=Array(new Br),this.Y=0,this.ya=Array(new en),this.aa=0,this.l=new Dr}function gn(){this.y=s(16),this.f=s(8),this.ea=s(8)}function nr(){this.cb=this.a=0,this.sc="",this.m=new C,this.Od=new qt,this.Kc=new zt,this.ed=new yr,this.Qa=new vt,this.Ic=this.$c=this.Aa=0,this.D=new nn,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,C),this.ia=0,this.pb=o(4,ur),this.Pa=new er,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new gn),this.Hd=0,this.rb=Array(new cr),this.sb=0,this.wa=Array(new Br),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new en),this.L=this.aa=0,this.gd=l([4,2],Br),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Tr(_,N){return 0>_?0:_>N?N:_}function Dr(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Rr(){var _=new nr;return _!=null&&(_.a=0,_.sc="OK",_.cb=0,_.Xb=0,Eg||(Eg=Wt)),_}function tt(_,N,z){return _.a==0&&(_.a=N,_.sc=z,_.cb=0),0}function Xe(_,N,z){return 3<=z&&_[N+0]==157&&_[N+1]==1&&_[N+2]==42}function ot(_,N){if(_==null)return 0;if(_.a=0,_.sc="OK",N==null)return tt(_,2,"null VP8Io passed to VP8GetHeaders()");var z=N.data,te=N.w,he=N.ha;if(4>he)return tt(_,7,"Truncated header.");var ge=z[te+0]|z[te+1]<<8|z[te+2]<<16,ve=_.Od;if(ve.Rb=!(1&ge),ve.td=ge>>1&7,ve.yd=ge>>4&1,ve.ub=ge>>5,3<ve.td)return tt(_,3,"Incorrect keyframe parameters.");if(!ve.yd)return tt(_,4,"Frame not displayable.");te+=3,he-=3;var Ae=_.Kc;if(ve.Rb){if(7>he)return tt(_,7,"cannot parse picture header");if(!Xe(z,te,he))return tt(_,3,"Bad code word");Ae.c=16383&(z[te+4]<<8|z[te+3]),Ae.Td=z[te+4]>>6,Ae.i=16383&(z[te+6]<<8|z[te+5]),Ae.Ud=z[te+6]>>6,te+=7,he-=7,_.za=Ae.c+15>>4,_.Ub=Ae.i+15>>4,N.width=Ae.c,N.height=Ae.i,N.Da=0,N.j=0,N.v=0,N.va=N.width,N.o=N.height,N.da=0,N.ib=N.width,N.hb=N.height,N.U=N.width,N.T=N.height,i((ge=_.Pa).jb,0,255,ge.jb.length),t((ge=_.Qa)!=null),ge.Cb=0,ge.Bb=0,ge.Fb=1,i(ge.Zb,0,0,ge.Zb.length),i(ge.Lb,0,0,ge.Lb)}if(ve.ub>he)return tt(_,7,"bad partition length");oe(ge=_.m,z,te,ve.ub),te+=ve.ub,he-=ve.ub,ve.Rb&&(Ae.Ld=K(ge),Ae.Kd=K(ge)),Ae=_.Qa;var Pe,Ge=_.Pa;if(t(ge!=null),t(Ae!=null),Ae.Cb=K(ge),Ae.Cb){if(Ae.Bb=K(ge),K(ge)){for(Ae.Fb=K(ge),Pe=0;4>Pe;++Pe)Ae.Zb[Pe]=K(ge)?W(ge,7):0;for(Pe=0;4>Pe;++Pe)Ae.Lb[Pe]=K(ge)?W(ge,6):0}if(Ae.Bb)for(Pe=0;3>Pe;++Pe)Ge.jb[Pe]=K(ge)?de(ge,8):255}else Ae.Bb=0;if(ge.Ka)return tt(_,3,"cannot parse segment header");if((Ae=_.ed).zd=K(ge),Ae.Tb=de(ge,6),Ae.wb=de(ge,3),Ae.Pc=K(ge),Ae.Pc&&K(ge)){for(Ge=0;4>Ge;++Ge)K(ge)&&(Ae.vd[Ge]=W(ge,6));for(Ge=0;4>Ge;++Ge)K(ge)&&(Ae.od[Ge]=W(ge,6))}if(_.L=Ae.Tb==0?0:Ae.zd?1:2,ge.Ka)return tt(_,3,"cannot parse filter header");var Ot=he;if(he=Pe=te,te=Pe+Ot,Ae=Ot,_.Xb=(1<<de(_.m,2))-1,Ot<3*(Ge=_.Xb))z=7;else{for(Pe+=3*Ge,Ae-=3*Ge,Ot=0;Ot<Ge;++Ot){var rr=z[he+0]|z[he+1]<<8|z[he+2]<<16;rr>Ae&&(rr=Ae),oe(_.Jc[+Ot],z,Pe,rr),Pe+=rr,Ae-=rr,he+=3}oe(_.Jc[+Ge],z,Pe,Ae),z=Pe<te?0:5}if(z!=0)return tt(_,z,"cannot parse partitions");for(z=de(Pe=_.m,7),he=K(Pe)?W(Pe,4):0,te=K(Pe)?W(Pe,4):0,Ae=K(Pe)?W(Pe,4):0,Ge=K(Pe)?W(Pe,4):0,Pe=K(Pe)?W(Pe,4):0,Ot=_.Qa,rr=0;4>rr;++rr){if(Ot.Cb){var Ke=Ot.Zb[rr];Ot.Fb||(Ke+=z)}else{if(0<rr){_.pb[rr]=_.pb[0];continue}Ke=z}var Ft=_.pb[rr];Ft.Sc[0]=i5[Tr(Ke+he,127)],Ft.Sc[1]=a5[Tr(Ke+0,127)],Ft.Eb[0]=2*i5[Tr(Ke+te,127)],Ft.Eb[1]=101581*a5[Tr(Ke+Ae,127)]>>16,8>Ft.Eb[1]&&(Ft.Eb[1]=8),Ft.Qc[0]=i5[Tr(Ke+Ge,117)],Ft.Qc[1]=a5[Tr(Ke+Pe,127)],Ft.lc=Ke+Pe}if(!ve.Rb)return tt(_,4,"Not a key frame.");for(K(ge),ve=_.Pa,z=0;4>z;++z){for(he=0;8>he;++he)for(te=0;3>te;++te)for(Ae=0;11>Ae;++Ae)Ge=ne(ge,GK[z][he][te][Ae])?de(ge,8):HK[z][he][te][Ae],ve.Wc[z][he].Yb[te][Ae]=Ge;for(he=0;17>he;++he)ve.Xc[z][he]=ve.Wc[z][KK[he]]}return _.kc=K(ge),_.kc&&(_.Bd=de(ge,8)),_.cb=1}function Wt(_,N,z,te,he,ge,ve){var Ae=N[he].Yb[z];for(z=0;16>he;++he){if(!ne(_,Ae[z+0]))return he;for(;!ne(_,Ae[z+1]);)if(Ae=N[++he].Yb[0],z=0,he==16)return 16;var Pe=N[he+1].Yb;if(ne(_,Ae[z+2])){var Ge=_,Ot=0;if(ne(Ge,(Ke=Ae)[(rr=z)+3]))if(ne(Ge,Ke[rr+6])){for(Ae=0,rr=2*(Ot=ne(Ge,Ke[rr+8]))+(Ke=ne(Ge,Ke[rr+9+Ot])),Ot=0,Ke=WK[rr];Ke[Ae];++Ae)Ot+=Ot+ne(Ge,Ke[Ae]);Ot+=3+(8<<rr)}else ne(Ge,Ke[rr+7])?(Ot=7+2*ne(Ge,165),Ot+=ne(Ge,145)):Ot=5+ne(Ge,159);else Ot=ne(Ge,Ke[rr+4])?3+ne(Ge,Ke[rr+5]):2;Ae=Pe[2]}else Ot=1,Ae=Pe[1];Pe=ve+qK[he],0>(Ge=_).b&&Q(Ge);var rr,Ke=Ge.b,Ft=(rr=Ge.Ca>>1)-(Ge.I>>Ke)>>31;--Ge.b,Ge.Ca+=Ft,Ge.Ca|=1,Ge.I-=(rr+1&Ft)<<Ke,ge[Pe]=((Ot^Ft)-Ft)*te[(0<he)+0]}return 16}function pr(_){var N=_.rb[_.sb-1];N.la=0,N.Na=0,i(_.zc,0,0,_.zc.length),_.ja=0}function Nr(_,N,z,te,he){he=_[N+z+32*te]+(he>>3),_[N+z+32*te]=-256&he?0>he?0:255:he}function br(_,N,z,te,he,ge){Nr(_,N,0,z,te+he),Nr(_,N,1,z,te+ge),Nr(_,N,2,z,te-ge),Nr(_,N,3,z,te-he)}function Je(_){return(20091*_>>16)+_}function Ht(_,N,z,te){var he,ge=0,ve=s(16);for(he=0;4>he;++he){var Ae=_[N+0]+_[N+8],Pe=_[N+0]-_[N+8],Ge=(35468*_[N+4]>>16)-Je(_[N+12]),Ot=Je(_[N+4])+(35468*_[N+12]>>16);ve[ge+0]=Ae+Ot,ve[ge+1]=Pe+Ge,ve[ge+2]=Pe-Ge,ve[ge+3]=Ae-Ot,ge+=4,N++}for(he=ge=0;4>he;++he)Ae=(_=ve[ge+0]+4)+ve[ge+8],Pe=_-ve[ge+8],Ge=(35468*ve[ge+4]>>16)-Je(ve[ge+12]),Nr(z,te,0,0,Ae+(Ot=Je(ve[ge+4])+(35468*ve[ge+12]>>16))),Nr(z,te,1,0,Pe+Ge),Nr(z,te,2,0,Pe-Ge),Nr(z,te,3,0,Ae-Ot),ge++,te+=32}function it(_,N,z,te){var he=_[N+0]+4,ge=35468*_[N+4]>>16,ve=Je(_[N+4]),Ae=35468*_[N+1]>>16;br(z,te,0,he+ve,_=Je(_[N+1]),Ae),br(z,te,1,he+ge,_,Ae),br(z,te,2,he-ge,_,Ae),br(z,te,3,he-ve,_,Ae)}function bt(_,N,z,te,he){Ht(_,N,z,te),he&&Ht(_,N+16,z,te+4)}function _t(_,N,z,te){Bl(_,N+0,z,te,1),Bl(_,N+32,z,te+128,1)}function Tt(_,N,z,te){var he;for(_=_[N+0]+4,he=0;4>he;++he)for(N=0;4>N;++N)Nr(z,te,N,he,_)}function Dt(_,N,z,te){_[N+0]&&Ii(_,N+0,z,te),_[N+16]&&Ii(_,N+16,z,te+4),_[N+32]&&Ii(_,N+32,z,te+128),_[N+48]&&Ii(_,N+48,z,te+128+4)}function Gt(_,N,z,te){var he,ge=s(16);for(he=0;4>he;++he){var ve=_[N+0+he]+_[N+12+he],Ae=_[N+4+he]+_[N+8+he],Pe=_[N+4+he]-_[N+8+he],Ge=_[N+0+he]-_[N+12+he];ge[0+he]=ve+Ae,ge[8+he]=ve-Ae,ge[4+he]=Ge+Pe,ge[12+he]=Ge-Pe}for(he=0;4>he;++he)ve=(_=ge[0+4*he]+3)+ge[3+4*he],Ae=ge[1+4*he]+ge[2+4*he],Pe=ge[1+4*he]-ge[2+4*he],Ge=_-ge[3+4*he],z[te+0]=ve+Ae>>3,z[te+16]=Ge+Pe>>3,z[te+32]=ve-Ae>>3,z[te+48]=Ge-Pe>>3,te+=64}function $t(_,N,z){var te,he=N-32,ge=Il,ve=255-_[he-1];for(te=0;te<z;++te){var Ae,Pe=ge,Ge=ve+_[N-1];for(Ae=0;Ae<z;++Ae)_[N+Ae]=Pe[Ge+_[he+Ae]];N+=32}}function ze(_,N){$t(_,N,4)}function Ze(_,N){$t(_,N,8)}function jt(_,N){$t(_,N,16)}function Bt(_,N){var z;for(z=0;16>z;++z)n(_,N+32*z,_,N-32,16)}function gr(_,N){var z;for(z=16;0<z;--z)i(_,N,_[N-1],16),N+=32}function dr(_,N,z){var te;for(te=0;16>te;++te)i(N,z+32*te,_,16)}function Kt(_,N){var z,te=16;for(z=0;16>z;++z)te+=_[N-1+32*z]+_[N+z-32];dr(te>>5,_,N)}function ye(_,N){var z,te=8;for(z=0;16>z;++z)te+=_[N-1+32*z];dr(te>>4,_,N)}function Ce(_,N){var z,te=8;for(z=0;16>z;++z)te+=_[N+z-32];dr(te>>4,_,N)}function $e(_,N){dr(128,_,N)}function ft(_,N,z){return _+2*N+z+2>>2}function Sr(_,N){var z,te=N-32;for(te=new Uint8Array([ft(_[te-1],_[te+0],_[te+1]),ft(_[te+0],_[te+1],_[te+2]),ft(_[te+1],_[te+2],_[te+3]),ft(_[te+2],_[te+3],_[te+4])]),z=0;4>z;++z)n(_,N+32*z,te,0,te.length)}function at(_,N){var z=_[N-1],te=_[N-1+32],he=_[N-1+64],ge=_[N-1+96];re(_,N+0,16843009*ft(_[N-1-32],z,te)),re(_,N+32,16843009*ft(z,te,he)),re(_,N+64,16843009*ft(te,he,ge)),re(_,N+96,16843009*ft(he,ge,ge))}function Ut(_,N){var z,te=4;for(z=0;4>z;++z)te+=_[N+z-32]+_[N-1+32*z];for(te>>=3,z=0;4>z;++z)i(_,N+32*z,te,4)}function Fe(_,N){var z=_[N-1+0],te=_[N-1+32],he=_[N-1+64],ge=_[N-1-32],ve=_[N+0-32],Ae=_[N+1-32],Pe=_[N+2-32],Ge=_[N+3-32];_[N+0+96]=ft(te,he,_[N-1+96]),_[N+1+96]=_[N+0+64]=ft(z,te,he),_[N+2+96]=_[N+1+64]=_[N+0+32]=ft(ge,z,te),_[N+3+96]=_[N+2+64]=_[N+1+32]=_[N+0+0]=ft(ve,ge,z),_[N+3+64]=_[N+2+32]=_[N+1+0]=ft(Ae,ve,ge),_[N+3+32]=_[N+2+0]=ft(Pe,Ae,ve),_[N+3+0]=ft(Ge,Pe,Ae)}function Ue(_,N){var z=_[N+1-32],te=_[N+2-32],he=_[N+3-32],ge=_[N+4-32],ve=_[N+5-32],Ae=_[N+6-32],Pe=_[N+7-32];_[N+0+0]=ft(_[N+0-32],z,te),_[N+1+0]=_[N+0+32]=ft(z,te,he),_[N+2+0]=_[N+1+32]=_[N+0+64]=ft(te,he,ge),_[N+3+0]=_[N+2+32]=_[N+1+64]=_[N+0+96]=ft(he,ge,ve),_[N+3+32]=_[N+2+64]=_[N+1+96]=ft(ge,ve,Ae),_[N+3+64]=_[N+2+96]=ft(ve,Ae,Pe),_[N+3+96]=ft(Ae,Pe,Pe)}function Ct(_,N){var z=_[N-1+0],te=_[N-1+32],he=_[N-1+64],ge=_[N-1-32],ve=_[N+0-32],Ae=_[N+1-32],Pe=_[N+2-32],Ge=_[N+3-32];_[N+0+0]=_[N+1+64]=ge+ve+1>>1,_[N+1+0]=_[N+2+64]=ve+Ae+1>>1,_[N+2+0]=_[N+3+64]=Ae+Pe+1>>1,_[N+3+0]=Pe+Ge+1>>1,_[N+0+96]=ft(he,te,z),_[N+0+64]=ft(te,z,ge),_[N+0+32]=_[N+1+96]=ft(z,ge,ve),_[N+1+32]=_[N+2+96]=ft(ge,ve,Ae),_[N+2+32]=_[N+3+96]=ft(ve,Ae,Pe),_[N+3+32]=ft(Ae,Pe,Ge)}function gt(_,N){var z=_[N+0-32],te=_[N+1-32],he=_[N+2-32],ge=_[N+3-32],ve=_[N+4-32],Ae=_[N+5-32],Pe=_[N+6-32],Ge=_[N+7-32];_[N+0+0]=z+te+1>>1,_[N+1+0]=_[N+0+64]=te+he+1>>1,_[N+2+0]=_[N+1+64]=he+ge+1>>1,_[N+3+0]=_[N+2+64]=ge+ve+1>>1,_[N+0+32]=ft(z,te,he),_[N+1+32]=_[N+0+96]=ft(te,he,ge),_[N+2+32]=_[N+1+96]=ft(he,ge,ve),_[N+3+32]=_[N+2+96]=ft(ge,ve,Ae),_[N+3+64]=ft(ve,Ae,Pe),_[N+3+96]=ft(Ae,Pe,Ge)}function yt(_,N){var z=_[N-1+0],te=_[N-1+32],he=_[N-1+64],ge=_[N-1+96];_[N+0+0]=z+te+1>>1,_[N+2+0]=_[N+0+32]=te+he+1>>1,_[N+2+32]=_[N+0+64]=he+ge+1>>1,_[N+1+0]=ft(z,te,he),_[N+3+0]=_[N+1+32]=ft(te,he,ge),_[N+3+32]=_[N+1+64]=ft(he,ge,ge),_[N+3+64]=_[N+2+64]=_[N+0+96]=_[N+1+96]=_[N+2+96]=_[N+3+96]=ge}function mt(_,N){var z=_[N-1+0],te=_[N-1+32],he=_[N-1+64],ge=_[N-1+96],ve=_[N-1-32],Ae=_[N+0-32],Pe=_[N+1-32],Ge=_[N+2-32];_[N+0+0]=_[N+2+32]=z+ve+1>>1,_[N+0+32]=_[N+2+64]=te+z+1>>1,_[N+0+64]=_[N+2+96]=he+te+1>>1,_[N+0+96]=ge+he+1>>1,_[N+3+0]=ft(Ae,Pe,Ge),_[N+2+0]=ft(ve,Ae,Pe),_[N+1+0]=_[N+3+32]=ft(z,ve,Ae),_[N+1+32]=_[N+3+64]=ft(te,z,ve),_[N+1+64]=_[N+3+96]=ft(he,te,z),_[N+1+96]=ft(ge,he,te)}function tr(_,N){var z;for(z=0;8>z;++z)n(_,N+32*z,_,N-32,8)}function lr(_,N){var z;for(z=0;8>z;++z)i(_,N,_[N-1],8),N+=32}function Fr(_,N,z){var te;for(te=0;8>te;++te)i(N,z+32*te,_,8)}function rn(_,N){var z,te=8;for(z=0;8>z;++z)te+=_[N+z-32]+_[N-1+32*z];Fr(te>>4,_,N)}function Sn(_,N){var z,te=4;for(z=0;8>z;++z)te+=_[N+z-32];Fr(te>>3,_,N)}function Gr(_,N){var z,te=4;for(z=0;8>z;++z)te+=_[N-1+32*z];Fr(te>>3,_,N)}function fn(_,N){Fr(128,_,N)}function an(_,N,z){var te=_[N-z],he=_[N+0],ge=3*(he-te)+Z_[1020+_[N-2*z]-_[N+z]],ve=Uy[112+(ge+4>>3)];_[N-z]=Il[255+te+Uy[112+(ge+3>>3)]],_[N+0]=Il[255+he-ve]}function bn(_,N,z,te){var he=_[N+0],ge=_[N+z];return vc[255+_[N-2*z]-_[N-z]]>te||vc[255+ge-he]>te}function Se(_,N,z,te){return 4*vc[255+_[N-z]-_[N+0]]+vc[255+_[N-2*z]-_[N+z]]<=te}function st(_,N,z,te,he){var ge=_[N-3*z],ve=_[N-2*z],Ae=_[N-z],Pe=_[N+0],Ge=_[N+z],Ot=_[N+2*z],rr=_[N+3*z];return 4*vc[255+Ae-Pe]+vc[255+ve-Ge]>te?0:vc[255+_[N-4*z]-ge]<=he&&vc[255+ge-ve]<=he&&vc[255+ve-Ae]<=he&&vc[255+rr-Ot]<=he&&vc[255+Ot-Ge]<=he&&vc[255+Ge-Pe]<=he}function pt(_,N,z,te){var he=2*te+1;for(te=0;16>te;++te)Se(_,N+te,z,he)&&an(_,N+te,z)}function Qe(_,N,z,te){var he=2*te+1;for(te=0;16>te;++te)Se(_,N+te*z,1,he)&&an(_,N+te*z,1)}function vr(_,N,z,te){var he;for(he=3;0<he;--he)pt(_,N+=4*z,z,te)}function tn(_,N,z,te){var he;for(he=3;0<he;--he)Qe(_,N+=4,z,te)}function An(_,N,z,te,he,ge,ve,Ae){for(ge=2*ge+1;0<he--;){if(st(_,N,z,ge,ve))if(bn(_,N,z,Ae))an(_,N,z);else{var Pe=_,Ge=N,Ot=z,rr=Pe[Ge-2*Ot],Ke=Pe[Ge-Ot],Ft=Pe[Ge+0],Yt=Pe[Ge+Ot],Ar=Pe[Ge+2*Ot],Jt=27*(Or=Z_[1020+3*(Ft-Ke)+Z_[1020+rr-Yt]])+63>>7,Er=18*Or+63>>7,Or=9*Or+63>>7;Pe[Ge-3*Ot]=Il[255+Pe[Ge-3*Ot]+Or],Pe[Ge-2*Ot]=Il[255+rr+Er],Pe[Ge-Ot]=Il[255+Ke+Jt],Pe[Ge+0]=Il[255+Ft-Jt],Pe[Ge+Ot]=Il[255+Yt-Er],Pe[Ge+2*Ot]=Il[255+Ar-Or]}N+=te}}function xn(_,N,z,te,he,ge,ve,Ae){for(ge=2*ge+1;0<he--;){if(st(_,N,z,ge,ve))if(bn(_,N,z,Ae))an(_,N,z);else{var Pe=_,Ge=N,Ot=z,rr=Pe[Ge-Ot],Ke=Pe[Ge+0],Ft=Pe[Ge+Ot],Yt=Uy[112+(4+(Ar=3*(Ke-rr))>>3)],Ar=Uy[112+(Ar+3>>3)],Jt=Yt+1>>1;Pe[Ge-2*Ot]=Il[255+Pe[Ge-2*Ot]+Jt],Pe[Ge-Ot]=Il[255+rr+Ar],Pe[Ge+0]=Il[255+Ke-Yt],Pe[Ge+Ot]=Il[255+Ft-Jt]}N+=te}}function zn(_,N,z,te,he,ge){An(_,N,z,1,16,te,he,ge)}function Rn(_,N,z,te,he,ge){An(_,N,1,z,16,te,he,ge)}function xi(_,N,z,te,he,ge){var ve;for(ve=3;0<ve;--ve)xn(_,N+=4*z,z,1,16,te,he,ge)}function L(_,N,z,te,he,ge){var ve;for(ve=3;0<ve;--ve)xn(_,N+=4,1,z,16,te,he,ge)}function le(_,N,z,te,he,ge,ve,Ae){An(_,N,he,1,8,ge,ve,Ae),An(z,te,he,1,8,ge,ve,Ae)}function Oe(_,N,z,te,he,ge,ve,Ae){An(_,N,1,he,8,ge,ve,Ae),An(z,te,1,he,8,ge,ve,Ae)}function rt(_,N,z,te,he,ge,ve,Ae){xn(_,N+4*he,he,1,8,ge,ve,Ae),xn(z,te+4*he,he,1,8,ge,ve,Ae)}function Et(_,N,z,te,he,ge,ve,Ae){xn(_,N+4,1,he,8,ge,ve,Ae),xn(z,te+4,1,he,8,ge,ve,Ae)}function hr(){this.ba=new Ur,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new cn,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function ir(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function wr(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Wr(){this.ua=0,this.Wa=new me,this.vb=new me,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new H,this.yc=new U}function Xr(){this.xb=this.a=0,this.l=new Dr,this.ca=new Ur,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new Y,this.Pb=0,this.wd=new Y,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Wr,this.ab=0,this.gc=o(4,wr),this.Oc=0}function dn(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Dr,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Ln(_,N,z,te,he,ge,ve){for(_=_==null?0:_[N+0],N=0;N<ve;++N)he[ge+N]=_+z[te+N]&255,_=he[ge+N]}function si(_,N,z,te,he,ge,ve){var Ae;if(_==null)Ln(null,null,z,te,he,ge,ve);else for(Ae=0;Ae<ve;++Ae)he[ge+Ae]=_[N+Ae]+z[te+Ae]&255}function Ir(_,N,z,te,he,ge,ve){if(_==null)Ln(null,null,z,te,he,ge,ve);else{var Ae,Pe=_[N+0],Ge=Pe,Ot=Pe;for(Ae=0;Ae<ve;++Ae)Ge=Ot+(Pe=_[N+Ae])-Ge,Ot=z[te+Ae]+(-256&Ge?0>Ge?0:255:Ge)&255,Ge=Pe,he[ge+Ae]=Ot}}function fe(_,N,z,te){var he=N.width,ge=N.o;if(t(_!=null&&N!=null),0>z||0>=te||z+te>ge)return null;if(!_.Cc){if(_.ga==null){var ve;if(_.ga=new dn,(ve=_.ga==null)||(ve=N.width*N.o,t(_.Gb.length==0),_.Gb=s(ve),_.Uc=0,_.Gb==null?ve=0:(_.mb=_.Gb,_.nb=_.Uc,_.rc=null,ve=1),ve=!ve),!ve){ve=_.ga;var Ae=_.Fa,Pe=_.P,Ge=_.qc,Ot=_.mb,rr=_.nb,Ke=Pe+1,Ft=Ge-1,Yt=ve.l;if(t(Ae!=null&&Ot!=null&&N!=null),vf[0]=null,vf[1]=Ln,vf[2]=si,vf[3]=Ir,ve.ca=Ot,ve.tb=rr,ve.c=N.width,ve.i=N.height,t(0<ve.c&&0<ve.i),1>=Ge)N=0;else if(ve.$a=3&Ae[Pe+0],ve.Z=Ae[Pe+0]>>2&3,ve.Lc=Ae[Pe+0]>>4&3,Pe=Ae[Pe+0]>>6&3,0>ve.$a||1<ve.$a||4<=ve.Z||1<ve.Lc||Pe)N=0;else if(Yt.put=qe,Yt.ac=Me,Yt.bc=ut,Yt.ma=ve,Yt.width=N.width,Yt.height=N.height,Yt.Da=N.Da,Yt.v=N.v,Yt.va=N.va,Yt.j=N.j,Yt.o=N.o,ve.$a)e:{t(ve.$a==1),N=De();t:for(;;){if(N==null){N=0;break e}if(t(ve!=null),ve.mc=N,N.c=ve.c,N.i=ve.i,N.l=ve.l,N.l.ma=ve,N.l.width=ve.c,N.l.height=ve.i,N.a=0,V(N.m,Ae,Ke,Ft),!Re(ve.c,ve.i,1,N,null)||(N.ab==1&&N.gc[0].hc==3&&pe(N.s)?(ve.ic=1,Ae=N.c*N.i,N.Ta=null,N.Ua=0,N.V=s(Ae),N.Ba=0,N.V==null?(N.a=1,N=0):N=1):(ve.ic=0,N=xt(N,ve.c)),!N))break t;N=1;break e}ve.mc=null,N=0}else N=Ft>=ve.c*ve.i;ve=!N}if(ve)return null;_.ga.Lc!=1?_.Ga=0:te=ge-z}t(_.ga!=null),t(z+te<=ge);e:{if(N=(Ae=_.ga).c,ge=Ae.l.o,Ae.$a==0){if(Ke=_.rc,Ft=_.Vc,Yt=_.Fa,Pe=_.P+1+z*N,Ge=_.mb,Ot=_.nb+z*N,t(Pe<=_.P+_.qc),Ae.Z!=0)for(t(vf[Ae.Z]!=null),ve=0;ve<te;++ve)vf[Ae.Z](Ke,Ft,Yt,Pe,Ge,Ot,N),Ke=Ge,Ft=Ot,Ot+=N,Pe+=N;else for(ve=0;ve<te;++ve)n(Ge,Ot,Yt,Pe,N),Ke=Ge,Ft=Ot,Ot+=N,Pe+=N;_.rc=Ke,_.Vc=Ft}else{if(t(Ae.mc!=null),N=z+te,t((ve=Ae.mc)!=null),t(N<=ve.i),ve.C>=N)N=1;else if(Ae.ic||ar(),Ae.ic){Ae=ve.V,Ke=ve.Ba,Ft=ve.c;var Ar=ve.i,Jt=(Yt=1,Pe=ve.$/Ft,Ge=ve.$%Ft,Ot=ve.m,rr=ve.s,ve.$),Er=Ft*Ar,Or=Ft*N,Yr=rr.wc,zr=Jt<Or?se(rr,Ge,Pe):null;t(Jt<=Er),t(N<=Ar),t(pe(rr));t:for(;;){for(;!Ot.h&&Jt<Or;){if(Ge&Yr||(zr=se(rr,Ge,Pe)),t(zr!=null),F(Ot),256>(Ar=Zt(zr.G[0],zr.H[0],Ot)))Ae[Ke+Jt]=Ar,++Jt,++Ge>=Ft&&(Ge=0,++Pe<=N&&!(Pe%16)&&Ne(ve,Pe));else{if(!(280>Ar)){Yt=0;break t}Ar=At(Ar-256,Ot);var $n,On=Zt(zr.G[4],zr.H[4],Ot);if(F(Ot),!(Jt>=(On=sr(Ft,On=At(On,Ot)))&&Er-Jt>=Ar)){Yt=0;break t}for($n=0;$n<Ar;++$n)Ae[Ke+Jt+$n]=Ae[Ke+Jt+$n-On];for(Jt+=Ar,Ge+=Ar;Ge>=Ft;)Ge-=Ft,++Pe<=N&&!(Pe%16)&&Ne(ve,Pe);Jt<Or&&Ge&Yr&&(zr=se(rr,Ge,Pe))}t(Ot.h==O(Ot))}Ne(ve,Pe>N?N:Pe);break t}!Yt||Ot.h&&Jt<Er?(Yt=0,ve.a=Ot.h?5:3):ve.$=Jt,N=Yt}else N=St(ve,ve.V,ve.Ba,ve.c,ve.i,N,Vt);if(!N){te=0;break e}}z+te>=ge&&(_.Cc=1),te=1}if(!te)return null;if(_.Cc&&((te=_.ga)!=null&&(te.mc=null),_.ga=null,0<_.Ga))return alert("todo:WebPDequantizeLevels"),null}return _.nb+z*he}function Ee(_,N,z,te,he,ge){for(;0<he--;){var ve,Ae=_,Pe=N+(z?1:0),Ge=_,Ot=N+(z?0:3);for(ve=0;ve<te;++ve){var rr=Ge[Ot+4*ve];rr!=255&&(rr*=32897,Ae[Pe+4*ve+0]=Ae[Pe+4*ve+0]*rr>>23,Ae[Pe+4*ve+1]=Ae[Pe+4*ve+1]*rr>>23,Ae[Pe+4*ve+2]=Ae[Pe+4*ve+2]*rr>>23)}N+=ge}}function et(_,N,z,te,he){for(;0<te--;){var ge;for(ge=0;ge<z;++ge){var ve=_[N+2*ge+0],Ae=15&(Ge=_[N+2*ge+1]),Pe=4369*Ae,Ge=(240&Ge|Ge>>4)*Pe>>16;_[N+2*ge+0]=(240&ve|ve>>4)*Pe>>16&240|(15&ve|ve<<4)*Pe>>16>>4&15,_[N+2*ge+1]=240&Ge|Ae}N+=he}}function Be(_,N,z,te,he,ge,ve,Ae){var Pe,Ge,Ot=255;for(Ge=0;Ge<he;++Ge){for(Pe=0;Pe<te;++Pe){var rr=_[N+Pe];ge[ve+4*Pe]=rr,Ot&=rr}N+=z,ve+=Ae}return Ot!=255}function kt(_,N,z,te,he){var ge;for(ge=0;ge<he;++ge)z[te+ge]=_[N+ge]>>8}function ar(){Cg=Ee,R6=et,F6=Be,B6=kt}function Rt(_,N,z){M[_]=function(te,he,ge,ve,Ae,Pe,Ge,Ot,rr,Ke,Ft,Yt,Ar,Jt,Er,Or,Yr){var zr,$n=Yr-1>>1,On=Ae[Pe+0]|Ge[Ot+0]<<16,ui=rr[Ke+0]|Ft[Yt+0]<<16;t(te!=null);var Fn=3*On+ui+131074>>2;for(N(te[he+0],255&Fn,Fn>>16,Ar,Jt),ge!=null&&(Fn=3*ui+On+131074>>2,N(ge[ve+0],255&Fn,Fn>>16,Er,Or)),zr=1;zr<=$n;++zr){var wi=Ae[Pe+zr]|Ge[Ot+zr]<<16,ks=rr[Ke+zr]|Ft[Yt+zr]<<16,di=On+wi+ui+ks+524296,Bn=di+2*(wi+ui)>>3;Fn=Bn+On>>1,On=(di=di+2*(On+ks)>>3)+wi>>1,N(te[he+2*zr-1],255&Fn,Fn>>16,Ar,Jt+(2*zr-1)*z),N(te[he+2*zr-0],255&On,On>>16,Ar,Jt+(2*zr-0)*z),ge!=null&&(Fn=di+ui>>1,On=Bn+ks>>1,N(ge[ve+2*zr-1],255&Fn,Fn>>16,Er,Or+(2*zr-1)*z),N(ge[ve+2*zr+0],255&On,On>>16,Er,Or+(2*zr+0)*z)),On=wi,ui=ks}1&Yr||(Fn=3*On+ui+131074>>2,N(te[he+Yr-1],255&Fn,Fn>>16,Ar,Jt+(Yr-1)*z),ge!=null&&(Fn=3*ui+On+131074>>2,N(ge[ve+Yr-1],255&Fn,Fn>>16,Er,Or+(Yr-1)*z)))}}function jr(){wc[zy]=XK,wc[Wy]=K6,wc[W6]=QK,wc[qy]=Y6,wc[Hy]=X6,wc[e5]=Q6,wc[q6]=JK,wc[t5]=K6,wc[r5]=Y6,wc[Vy]=X6,wc[n5]=Q6}function _r(_){return _&-16384?0>_?0:255:_>>ZK}function Hr(_,N){return _r((19077*_>>8)+(26149*N>>8)-14234)}function Mr(_,N,z){return _r((19077*_>>8)-(6419*N>>8)-(13320*z>>8)+8708)}function Qr(_,N){return _r((19077*_>>8)+(33050*N>>8)-17685)}function Vr(_,N,z,te,he){te[he+0]=Hr(_,z),te[he+1]=Mr(_,N,z),te[he+2]=Qr(_,N)}function Xt(_,N,z,te,he){te[he+0]=Qr(_,N),te[he+1]=Mr(_,N,z),te[he+2]=Hr(_,z)}function vn(_,N,z,te,he){var ge=Mr(_,N,z);N=ge<<3&224|Qr(_,N)>>3,te[he+0]=248&Hr(_,z)|ge>>5,te[he+1]=N}function hn(_,N,z,te,he){var ge=240&Qr(_,N)|15;te[he+0]=240&Hr(_,z)|Mr(_,N,z)>>4,te[he+1]=ge}function kn(_,N,z,te,he){te[he+0]=255,Vr(_,N,z,te,he+1)}function _n(_,N,z,te,he){Xt(_,N,z,te,he),te[he+3]=255}function yn(_,N,z,te,he){Vr(_,N,z,te,he),te[he+3]=255}function ci(_,N,z){M[_]=function(te,he,ge,ve,Ae,Pe,Ge,Ot,rr){for(var Ke=Ot+(-2&rr)*z;Ot!=Ke;)N(te[he+0],ge[ve+0],Ae[Pe+0],Ge,Ot),N(te[he+1],ge[ve+0],Ae[Pe+0],Ge,Ot+z),he+=2,++ve,++Pe,Ot+=2*z;1&rr&&N(te[he+0],ge[ve+0],Ae[Pe+0],Ge,Ot)}}function Wn(_,N,z){return z==0?_==0?N==0?6:5:N==0?4:0:z}function mi(_,N,z,te,he){switch(_>>>30){case 3:Bl(N,z,te,he,0);break;case 2:bc(N,z,te,he);break;case 1:Ii(N,z,te,he)}}function Jn(_,N){var z,te,he=N.M,ge=N.Nb,ve=_.oc,Ae=_.pc+40,Pe=_.oc,Ge=_.pc+584,Ot=_.oc,rr=_.pc+600;for(z=0;16>z;++z)ve[Ae+32*z-1]=129;for(z=0;8>z;++z)Pe[Ge+32*z-1]=129,Ot[rr+32*z-1]=129;for(0<he?ve[Ae-1-32]=Pe[Ge-1-32]=Ot[rr-1-32]=129:(i(ve,Ae-32-1,127,21),i(Pe,Ge-32-1,127,9),i(Ot,rr-32-1,127,9)),te=0;te<_.za;++te){var Ke=N.ya[N.aa+te];if(0<te){for(z=-1;16>z;++z)n(ve,Ae+32*z-4,ve,Ae+32*z+12,4);for(z=-1;8>z;++z)n(Pe,Ge+32*z-4,Pe,Ge+32*z+4,4),n(Ot,rr+32*z-4,Ot,rr+32*z+4,4)}var Ft=_.Gd,Yt=_.Hd+te,Ar=Ke.ad,Jt=Ke.Hc;if(0<he&&(n(ve,Ae-32,Ft[Yt].y,0,16),n(Pe,Ge-32,Ft[Yt].f,0,8),n(Ot,rr-32,Ft[Yt].ea,0,8)),Ke.Za){var Er=ve,Or=Ae-32+16;for(0<he&&(te>=_.za-1?i(Er,Or,Ft[Yt].y[15],4):n(Er,Or,Ft[Yt+1].y,0,4)),z=0;4>z;z++)Er[Or+128+z]=Er[Or+256+z]=Er[Or+384+z]=Er[Or+0+z];for(z=0;16>z;++z,Jt<<=2)Er=ve,Or=Ae+Z6[z],Qc[Ke.Ob[z]](Er,Or),mi(Jt,Ar,16*+z,Er,Or)}else if(Er=Wn(te,he,Ke.Ob[0]),bf[Er](ve,Ae),Jt!=0)for(z=0;16>z;++z,Jt<<=2)mi(Jt,Ar,16*+z,ve,Ae+Z6[z]);for(z=Ke.Gc,Er=Wn(te,he,Ke.Dd),md[Er](Pe,Ge),md[Er](Ot,rr),Jt=Ar,Er=Pe,Or=Ge,255&(Ke=0|z)&&(170&Ke?Nu(Jt,256,Er,Or):ea(Jt,256,Er,Or)),Ke=Ot,Jt=rr,255&(z>>=8)&&(170&z?Nu(Ar,320,Ke,Jt):ea(Ar,320,Ke,Jt)),he<_.Ub-1&&(n(Ft[Yt].y,0,ve,Ae+480,16),n(Ft[Yt].f,0,Pe,Ge+224,8),n(Ft[Yt].ea,0,Ot,rr+224,8)),z=8*ge*_.B,Ft=_.sa,Yt=_.ta+16*te+16*ge*_.R,Ar=_.qa,Ke=_.ra+8*te+z,Jt=_.Ha,Er=_.Ia+8*te+z,z=0;16>z;++z)n(Ft,Yt+z*_.R,ve,Ae+32*z,16);for(z=0;8>z;++z)n(Ar,Ke+z*_.B,Pe,Ge+32*z,8),n(Jt,Er+z*_.B,Ot,rr+32*z,8)}}function ca(_,N,z,te,he,ge,ve,Ae,Pe){var Ge=[0],Ot=[0],rr=0,Ke=Pe!=null?Pe.kd:0,Ft=Pe??new ir;if(_==null||12>z)return 7;Ft.data=_,Ft.w=N,Ft.ha=z,N=[N],z=[z],Ft.gb=[Ft.gb];e:{var Yt=N,Ar=z,Jt=Ft.gb;if(t(_!=null),t(Ar!=null),t(Jt!=null),Jt[0]=0,12<=Ar[0]&&!r(_,Yt[0],"RIFF")){if(r(_,Yt[0]+8,"WEBP")){Jt=3;break e}var Er=ie(_,Yt[0]+4);if(12>Er||4294967286<Er){Jt=3;break e}if(Ke&&Er>Ar[0]-8){Jt=7;break e}Jt[0]=Er,Yt[0]+=12,Ar[0]-=12}Jt=0}if(Jt!=0)return Jt;for(Er=0<Ft.gb[0],z=z[0];;){e:{var Or=_;Ar=N,Jt=z;var Yr=Ge,zr=Ot,$n=Yt=[0];if((Fn=rr=[rr])[0]=0,8>Jt[0])Jt=7;else{if(!r(Or,Ar[0],"VP8X")){if(ie(Or,Ar[0]+4)!=10){Jt=3;break e}if(18>Jt[0]){Jt=7;break e}var On=ie(Or,Ar[0]+8),ui=1+I(Or,Ar[0]+12);if(2147483648<=ui*(Or=1+I(Or,Ar[0]+15))){Jt=3;break e}$n!=null&&($n[0]=On),Yr!=null&&(Yr[0]=ui),zr!=null&&(zr[0]=Or),Ar[0]+=18,Jt[0]-=18,Fn[0]=1}Jt=0}}if(rr=rr[0],Yt=Yt[0],Jt!=0)return Jt;if(Ar=!!(2&Yt),!Er&&rr)return 3;if(ge!=null&&(ge[0]=!!(16&Yt)),ve!=null&&(ve[0]=Ar),Ae!=null&&(Ae[0]=0),ve=Ge[0],Yt=Ot[0],rr&&Ar&&Pe==null){Jt=0;break}if(4>z){Jt=7;break}if(Er&&rr||!Er&&!rr&&!r(_,N[0],"ALPH")){z=[z],Ft.na=[Ft.na],Ft.P=[Ft.P],Ft.Sa=[Ft.Sa];e:{On=_,Jt=N,Er=z;var Fn=Ft.gb;Yr=Ft.na,zr=Ft.P,$n=Ft.Sa,ui=22,t(On!=null),t(Er!=null),Or=Jt[0];var wi=Er[0];for(t(Yr!=null),t($n!=null),Yr[0]=null,zr[0]=null,$n[0]=0;;){if(Jt[0]=Or,Er[0]=wi,8>wi){Jt=7;break e}var ks=ie(On,Or+4);if(4294967286<ks){Jt=3;break e}var di=8+ks+1&-2;if(ui+=di,0<Fn&&ui>Fn){Jt=3;break e}if(!r(On,Or,"VP8 ")||!r(On,Or,"VP8L")){Jt=0;break e}if(wi[0]<di){Jt=7;break e}r(On,Or,"ALPH")||(Yr[0]=On,zr[0]=Or+8,$n[0]=ks),Or+=di,wi-=di}}if(z=z[0],Ft.na=Ft.na[0],Ft.P=Ft.P[0],Ft.Sa=Ft.Sa[0],Jt!=0)break}z=[z],Ft.Ja=[Ft.Ja],Ft.xa=[Ft.xa];e:if(Fn=_,Jt=N,Er=z,Yr=Ft.gb[0],zr=Ft.Ja,$n=Ft.xa,On=Jt[0],Or=!r(Fn,On,"VP8 "),ui=!r(Fn,On,"VP8L"),t(Fn!=null),t(Er!=null),t(zr!=null),t($n!=null),8>Er[0])Jt=7;else{if(Or||ui){if(Fn=ie(Fn,On+4),12<=Yr&&Fn>Yr-12){Jt=3;break e}if(Ke&&Fn>Er[0]-8){Jt=7;break e}zr[0]=Fn,Jt[0]+=8,Er[0]-=8,$n[0]=ui}else $n[0]=5<=Er[0]&&Fn[On+0]==47&&!(Fn[On+4]>>5),zr[0]=Er[0];Jt=0}if(z=z[0],Ft.Ja=Ft.Ja[0],Ft.xa=Ft.xa[0],N=N[0],Jt!=0)break;if(4294967286<Ft.Ja)return 3;if(Ae==null||Ar||(Ae[0]=Ft.xa?2:1),ve=[ve],Yt=[Yt],Ft.xa){if(5>z){Jt=7;break}Ae=ve,Ke=Yt,Ar=ge,_==null||5>z?_=0:5<=z&&_[N+0]==47&&!(_[N+4]>>5)?(Er=[0],Fn=[0],Yr=[0],V(zr=new Y,_,N,z),wt(zr,Er,Fn,Yr)?(Ae!=null&&(Ae[0]=Er[0]),Ke!=null&&(Ke[0]=Fn[0]),Ar!=null&&(Ar[0]=Yr[0]),_=1):_=0):_=0}else{if(10>z){Jt=7;break}Ae=Yt,_==null||10>z||!Xe(_,N+3,z-3)?_=0:(Ke=_[N+0]|_[N+1]<<8|_[N+2]<<16,Ar=16383&(_[N+7]<<8|_[N+6]),_=16383&(_[N+9]<<8|_[N+8]),1&Ke||3<(Ke>>1&7)||!(Ke>>4&1)||Ke>>5>=Ft.Ja||!Ar||!_?_=0:(ve&&(ve[0]=Ar),Ae&&(Ae[0]=_),_=1))}if(!_||(ve=ve[0],Yt=Yt[0],rr&&(Ge[0]!=ve||Ot[0]!=Yt)))return 3;Pe!=null&&(Pe[0]=Ft,Pe.offset=N-Pe.w,t(4294967286>N-Pe.w),t(Pe.offset==Pe.ha-z));break}return Jt==0||Jt==7&&rr&&Pe==null?(ge!=null&&(ge[0]|=Ft.na!=null&&0<Ft.na.length),te!=null&&(te[0]=ve),he!=null&&(he[0]=Yt),0):Jt}function Rl(_,N,z){var te=N.width,he=N.height,ge=0,ve=0,Ae=te,Pe=he;if(N.Da=_!=null&&0<_.Da,N.Da&&(Ae=_.cd,Pe=_.bd,ge=_.v,ve=_.j,11>z||(ge&=-2,ve&=-2),0>ge||0>ve||0>=Ae||0>=Pe||ge+Ae>te||ve+Pe>he))return 0;if(N.v=ge,N.j=ve,N.va=ge+Ae,N.o=ve+Pe,N.U=Ae,N.T=Pe,N.da=_!=null&&0<_.da,N.da){if(!Te(Ae,Pe,z=[_.ib],ge=[_.hb]))return 0;N.ib=z[0],N.hb=ge[0]}return N.ob=_!=null&&_.ob,N.Kb=_==null||!_.Sd,N.da&&(N.ob=N.ib<3*te/4&&N.hb<3*he/4,N.Kb=0),1}function Ko(_){if(_==null)return 2;if(11>_.S){var N=_.f.RGBA;N.fb+=(_.height-1)*N.A,N.A=-N.A}else N=_.f.kb,_=_.height,N.O+=(_-1)*N.fa,N.fa=-N.fa,N.N+=(_-1>>1)*N.Ab,N.Ab=-N.Ab,N.W+=(_-1>>1)*N.Db,N.Db=-N.Db,N.F!=null&&(N.J+=(_-1)*N.lb,N.lb=-N.lb);return 0}function So(_,N,z,te){if(te==null||0>=_||0>=N)return 2;if(z!=null){if(z.Da){var he=z.cd,ge=z.bd,ve=-2&z.v,Ae=-2&z.j;if(0>ve||0>Ae||0>=he||0>=ge||ve+he>_||Ae+ge>N)return 2;_=he,N=ge}if(z.da){if(!Te(_,N,he=[z.ib],ge=[z.hb]))return 2;_=he[0],N=ge[0]}}te.width=_,te.height=N;e:{var Pe=te.width,Ge=te.height;if(_=te.S,0>=Pe||0>=Ge||!(_>=zy&&13>_))_=2;else{if(0>=te.Rd&&te.sd==null){ve=ge=he=N=0;var Ot=(Ae=Pe*eT[_])*Ge;if(11>_||(ge=(Ge+1)/2*(N=(Pe+1)/2),_==12&&(ve=(he=Pe)*Ge)),(Ge=s(Ot+2*ge+ve))==null){_=1;break e}te.sd=Ge,11>_?((Pe=te.f.RGBA).eb=Ge,Pe.fb=0,Pe.A=Ae,Pe.size=Ot):((Pe=te.f.kb).y=Ge,Pe.O=0,Pe.fa=Ae,Pe.Fd=Ot,Pe.f=Ge,Pe.N=0+Ot,Pe.Ab=N,Pe.Cd=ge,Pe.ea=Ge,Pe.W=0+Ot+ge,Pe.Db=N,Pe.Ed=ge,_==12&&(Pe.F=Ge,Pe.J=0+Ot+2*ge),Pe.Tc=ve,Pe.lb=he)}if(N=1,he=te.S,ge=te.width,ve=te.height,he>=zy&&13>he)if(11>he)_=te.f.RGBA,N&=(Ae=Math.abs(_.A))*(ve-1)+ge<=_.size,N&=Ae>=ge*eT[he],N&=_.eb!=null;else{_=te.f.kb,Ae=(ge+1)/2,Ot=(ve+1)/2,Pe=Math.abs(_.fa),Ge=Math.abs(_.Ab);var rr=Math.abs(_.Db),Ke=Math.abs(_.lb),Ft=Ke*(ve-1)+ge;N&=Pe*(ve-1)+ge<=_.Fd,N&=Ge*(Ot-1)+Ae<=_.Cd,N=(N&=rr*(Ot-1)+Ae<=_.Ed)&Pe>=ge&Ge>=Ae&rr>=Ae,N&=_.y!=null,N&=_.f!=null,N&=_.ea!=null,he==12&&(N&=Ke>=ge,N&=Ft<=_.Tc,N&=_.F!=null)}else N=0;_=N?0:2}}return _!=0||z!=null&&z.fd&&(_=Ko(te)),_}var _o=64,Ss=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ba=24,cs=32,Bi=8,Aa=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];_e("Predictor0","PredictorAdd0"),M.Predictor0=function(){return 4278190080},M.Predictor1=function(_){return _},M.Predictor2=function(_,N,z){return N[z+0]},M.Predictor3=function(_,N,z){return N[z+1]},M.Predictor4=function(_,N,z){return N[z-1]},M.Predictor5=function(_,N,z){return We(We(_,N[z+1]),N[z+0])},M.Predictor6=function(_,N,z){return We(_,N[z-1])},M.Predictor7=function(_,N,z){return We(_,N[z+0])},M.Predictor8=function(_,N,z){return We(N[z-1],N[z+0])},M.Predictor9=function(_,N,z){return We(N[z+0],N[z+1])},M.Predictor10=function(_,N,z){return We(We(_,N[z-1]),We(N[z+0],N[z+1]))},M.Predictor11=function(_,N,z){var te=N[z+0];return 0>=Ye(te>>24&255,_>>24&255,(N=N[z-1])>>24&255)+Ye(te>>16&255,_>>16&255,N>>16&255)+Ye(te>>8&255,_>>8&255,N>>8&255)+Ye(255&te,255&_,255&N)?te:_},M.Predictor12=function(_,N,z){var te=N[z+0];return(Pt((_>>24&255)+(te>>24&255)-((N=N[z-1])>>24&255))<<24|Pt((_>>16&255)+(te>>16&255)-(N>>16&255))<<16|Pt((_>>8&255)+(te>>8&255)-(N>>8&255))<<8|Pt((255&_)+(255&te)-(255&N)))>>>0},M.Predictor13=function(_,N,z){var te=N[z-1];return(dt((_=We(_,N[z+0]))>>24&255,te>>24&255)<<24|dt(_>>16&255,te>>16&255)<<16|dt(_>>8&255,te>>8&255)<<8|dt(255&_,255&te))>>>0};var ro=M.PredictorAdd0;M.PredictorAdd1=lt,_e("Predictor2","PredictorAdd2"),_e("Predictor3","PredictorAdd3"),_e("Predictor4","PredictorAdd4"),_e("Predictor5","PredictorAdd5"),_e("Predictor6","PredictorAdd6"),_e("Predictor7","PredictorAdd7"),_e("Predictor8","PredictorAdd8"),_e("Predictor9","PredictorAdd9"),_e("Predictor10","PredictorAdd10"),_e("Predictor11","PredictorAdd11"),_e("Predictor12","PredictorAdd12"),_e("Predictor13","PredictorAdd13");var Au=M.PredictorAdd2;we("ColorIndexInverseTransform","MapARGB","32b",function(_){return _>>8&255},function(_){return _}),we("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(_){return _},function(_){return _>>8&255});var Ci,Hn=M.ColorIndexInverseTransform,Yi=M.MapARGB,_s=M.VP8LColorIndexInverseTransformAlpha,hd=M.MapAlpha,Xc=M.VP8LPredictorsAdd=[];Xc.length=16,(M.VP8LPredictors=[]).length=16,(M.VP8LPredictorsAdd_C=[]).length=16,(M.VP8LPredictors_C=[]).length=16;var gc,xc,Yo,no,pl,yc,Fl,Bl,bc,Nu,Ii,ea,Xa,js,pd,Ng,fp,$y,E6,T6,P6,O6,M6,L6,Cg,R6,F6,B6,I6=s(511),D6=s(2041),$6=s(225),U6=s(767),z6=0,Z_=D6,Uy=$6,Il=U6,vc=I6,zy=0,Wy=1,W6=2,qy=3,Hy=4,e5=5,q6=6,t5=7,r5=8,Vy=9,n5=10,FK=[2,3,7],BK=[3,3,11],H6=[280,256,256,256,40],IK=[0,1,1,1,0],DK=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],$K=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],UK=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],zK=8,i5=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],a5=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Eg=null,WK=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],qK=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],V6=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],HK=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],VK=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],GK=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],KK=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],bf=[],Qc=[],md=[],YK=1,G6=2,vf=[],wc=[];Rt("UpsampleRgbLinePair",Vr,3),Rt("UpsampleBgrLinePair",Xt,3),Rt("UpsampleRgbaLinePair",yn,4),Rt("UpsampleBgraLinePair",_n,4),Rt("UpsampleArgbLinePair",kn,4),Rt("UpsampleRgba4444LinePair",hn,2),Rt("UpsampleRgb565LinePair",vn,2);var XK=M.UpsampleRgbLinePair,QK=M.UpsampleBgrLinePair,K6=M.UpsampleRgbaLinePair,Y6=M.UpsampleBgraLinePair,X6=M.UpsampleArgbLinePair,Q6=M.UpsampleRgba4444LinePair,JK=M.UpsampleRgb565LinePair,Gy=16,Ky=1<<Gy-1,Tg=-227,s5=482,ZK=6,J6=0,eY=s(256),tY=s(256),rY=s(256),nY=s(256),iY=s(s5-Tg),aY=s(s5-Tg);ci("YuvToRgbRow",Vr,3),ci("YuvToBgrRow",Xt,3),ci("YuvToRgbaRow",yn,4),ci("YuvToBgraRow",_n,4),ci("YuvToArgbRow",kn,4),ci("YuvToRgba4444Row",hn,2),ci("YuvToRgb565Row",vn,2);var Z6=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Yy=[0,2,8],sY=[8,7,6,4,4,2,2,2,1,1,1,1],oY=1;this.WebPDecodeRGBA=function(_,N,z,te,he){var ge=Wy,ve=new hr,Ae=new Ur;ve.ba=Ae,Ae.S=ge,Ae.width=[Ae.width],Ae.height=[Ae.height];var Pe=Ae.width,Ge=Ae.height,Ot=new qr;if(Ot==null||_==null)var rr=2;else t(Ot!=null),rr=ca(_,N,z,Ot.width,Ot.height,Ot.Pd,Ot.Qd,Ot.format,null);if(rr!=0?Pe=0:(Pe!=null&&(Pe[0]=Ot.width[0]),Ge!=null&&(Ge[0]=Ot.height[0]),Pe=1),Pe){Ae.width=Ae.width[0],Ae.height=Ae.height[0],te!=null&&(te[0]=Ae.width),he!=null&&(he[0]=Ae.height);e:{if(te=new Dr,(he=new ir).data=_,he.w=N,he.ha=z,he.kd=1,N=[0],t(he!=null),((_=ca(he.data,he.w,he.ha,null,null,null,N,null,he))==0||_==7)&&N[0]&&(_=4),(N=_)==0){if(t(ve!=null),te.data=he.data,te.w=he.w+he.offset,te.ha=he.ha-he.offset,te.put=qe,te.ac=Me,te.bc=ut,te.ma=ve,he.xa){if((_=De())==null){ve=1;break e}if(function(Ke,Ft){var Yt=[0],Ar=[0],Jt=[0];t:for(;;){if(Ke==null)return 0;if(Ft==null)return Ke.a=2,0;if(Ke.l=Ft,Ke.a=0,V(Ke.m,Ft.data,Ft.w,Ft.ha),!wt(Ke.m,Yt,Ar,Jt)){Ke.a=3;break t}if(Ke.xb=G6,Ft.width=Yt[0],Ft.height=Ar[0],!Re(Yt[0],Ar[0],1,Ke,null))break t;return 1}return t(Ke.a!=0),0}(_,te)){if(te=(N=So(te.width,te.height,ve.Oa,ve.ba))==0){t:{te=_;r:for(;;){if(te==null){te=0;break t}if(t(te.s.yc!=null),t(te.s.Ya!=null),t(0<te.s.Wb),t((z=te.l)!=null),t((he=z.ma)!=null),te.xb!=0){if(te.ca=he.ba,te.tb=he.tb,t(te.ca!=null),!Rl(he.Oa,z,qy)){te.a=2;break r}if(!xt(te,z.width)||z.da)break r;if((z.da||Pr(te.ca.S))&&ar(),11>te.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),te.ca.f.kb.F!=null&&ar()),te.Pb&&0<te.s.ua&&te.s.vb.X==null&&!D(te.s.vb,te.s.Wa.Xa)){te.a=1;break r}te.xb=0}if(!St(te,te.V,te.Ba,te.c,te.i,z.o,J))break r;he.Dc=te.Ma,te=1;break t}t(te.a!=0),te=0}te=!te}te&&(N=_.a)}else N=_.a}else{if((_=new Rr)==null){ve=1;break e}if(_.Fa=he.na,_.P=he.P,_.qc=he.Sa,ot(_,te)){if((N=So(te.width,te.height,ve.Oa,ve.ba))==0){if(_.Aa=0,z=ve.Oa,t((he=_)!=null),z!=null){if(0<(Pe=0>(Pe=z.Md)?0:100<Pe?255:255*Pe/100)){for(Ge=Ot=0;4>Ge;++Ge)12>(rr=he.pb[Ge]).lc&&(rr.ia=Pe*sY[0>rr.lc?0:rr.lc]>>3),Ot|=rr.ia;Ot&&(alert("todo:VP8InitRandom"),he.ia=1)}he.Ga=z.Id,100<he.Ga?he.Ga=100:0>he.Ga&&(he.Ga=0)}(function(Ke,Ft){if(Ke==null)return 0;if(Ft==null)return tt(Ke,2,"NULL VP8Io parameter in VP8Decode().");if(!Ke.cb&&!ot(Ke,Ft))return 0;if(t(Ke.cb),Ft.ac==null||Ft.ac(Ft)){Ft.ob&&(Ke.L=0);var Yt=Yy[Ke.L];if(Ke.L==2?(Ke.yb=0,Ke.zb=0):(Ke.yb=Ft.v-Yt>>4,Ke.zb=Ft.j-Yt>>4,0>Ke.yb&&(Ke.yb=0),0>Ke.zb&&(Ke.zb=0)),Ke.Va=Ft.o+15+Yt>>4,Ke.Hb=Ft.va+15+Yt>>4,Ke.Hb>Ke.za&&(Ke.Hb=Ke.za),Ke.Va>Ke.Ub&&(Ke.Va=Ke.Ub),0<Ke.L){var Ar=Ke.ed;for(Yt=0;4>Yt;++Yt){var Jt;if(Ke.Qa.Cb){var Er=Ke.Qa.Lb[Yt];Ke.Qa.Fb||(Er+=Ar.Tb)}else Er=Ar.Tb;for(Jt=0;1>=Jt;++Jt){var Or=Ke.gd[Yt][Jt],Yr=Er;if(Ar.Pc&&(Yr+=Ar.vd[0],Jt&&(Yr+=Ar.od[0])),0<(Yr=0>Yr?0:63<Yr?63:Yr)){var zr=Yr;0<Ar.wb&&(zr=4<Ar.wb?zr>>2:zr>>1)>9-Ar.wb&&(zr=9-Ar.wb),1>zr&&(zr=1),Or.dd=zr,Or.tc=2*Yr+zr,Or.ld=40<=Yr?2:15<=Yr?1:0}else Or.tc=0;Or.La=Jt}}}Yt=0}else tt(Ke,6,"Frame setup failed"),Yt=Ke.a;if(Yt=Yt==0){if(Yt){Ke.$c=0,0<Ke.Aa||(Ke.Ic=oY);t:{Yt=Ke.Ic,Ar=4*(zr=Ke.za);var $n=32*zr,On=zr+1,ui=0<Ke.L?zr*(0<Ke.Aa?2:1):0,Fn=(Ke.Aa==2?2:1)*zr;if((Or=Ar+832+(Jt=3*(16*Yt+Yy[Ke.L])/2*$n)+(Er=Ke.Fa!=null&&0<Ke.Fa.length?Ke.Kc.c*Ke.Kc.i:0))!=Or)Yt=0;else{if(Or>Ke.Vb){if(Ke.Vb=0,Ke.Ec=s(Or),Ke.Fc=0,Ke.Ec==null){Yt=tt(Ke,1,"no memory during frame initialization.");break t}Ke.Vb=Or}Or=Ke.Ec,Yr=Ke.Fc,Ke.Ac=Or,Ke.Bc=Yr,Yr+=Ar,Ke.Gd=o($n,gn),Ke.Hd=0,Ke.rb=o(On+1,cr),Ke.sb=1,Ke.wa=ui?o(ui,Br):null,Ke.Y=0,Ke.D.Nb=0,Ke.D.wa=Ke.wa,Ke.D.Y=Ke.Y,0<Ke.Aa&&(Ke.D.Y+=zr),t(!0),Ke.oc=Or,Ke.pc=Yr,Yr+=832,Ke.ya=o(Fn,en),Ke.aa=0,Ke.D.ya=Ke.ya,Ke.D.aa=Ke.aa,Ke.Aa==2&&(Ke.D.aa+=zr),Ke.R=16*zr,Ke.B=8*zr,zr=($n=Yy[Ke.L])*Ke.R,$n=$n/2*Ke.B,Ke.sa=Or,Ke.ta=Yr+zr,Ke.qa=Ke.sa,Ke.ra=Ke.ta+16*Yt*Ke.R+$n,Ke.Ha=Ke.qa,Ke.Ia=Ke.ra+8*Yt*Ke.B+$n,Ke.$c=0,Yr+=Jt,Ke.mb=Er?Or:null,Ke.nb=Er?Yr:null,t(Yr+Er<=Ke.Fc+Ke.Vb),pr(Ke),i(Ke.Ac,Ke.Bc,0,Ar),Yt=1}}if(Yt){if(Ft.ka=0,Ft.y=Ke.sa,Ft.O=Ke.ta,Ft.f=Ke.qa,Ft.N=Ke.ra,Ft.ea=Ke.Ha,Ft.Vd=Ke.Ia,Ft.fa=Ke.R,Ft.Rc=Ke.B,Ft.F=null,Ft.J=0,!z6){for(Yt=-255;255>=Yt;++Yt)I6[255+Yt]=0>Yt?-Yt:Yt;for(Yt=-1020;1020>=Yt;++Yt)D6[1020+Yt]=-128>Yt?-128:127<Yt?127:Yt;for(Yt=-112;112>=Yt;++Yt)$6[112+Yt]=-16>Yt?-16:15<Yt?15:Yt;for(Yt=-255;510>=Yt;++Yt)U6[255+Yt]=0>Yt?0:255<Yt?255:Yt;z6=1}Fl=Gt,Bl=bt,Nu=_t,Ii=Tt,ea=Dt,bc=it,Xa=zn,js=Rn,pd=le,Ng=Oe,fp=xi,$y=L,E6=rt,T6=Et,P6=pt,O6=Qe,M6=vr,L6=tn,Qc[0]=Ut,Qc[1]=ze,Qc[2]=Sr,Qc[3]=at,Qc[4]=Fe,Qc[5]=Ct,Qc[6]=Ue,Qc[7]=gt,Qc[8]=mt,Qc[9]=yt,bf[0]=Kt,bf[1]=jt,bf[2]=Bt,bf[3]=gr,bf[4]=ye,bf[5]=Ce,bf[6]=$e,md[0]=rn,md[1]=Ze,md[2]=tr,md[3]=lr,md[4]=Gr,md[5]=Sn,md[6]=fn,Yt=1}else Yt=0}Yt&&(Yt=function(wi,ks){for(wi.M=0;wi.M<wi.Va;++wi.M){var di,Bn=wi.Jc[wi.M&wi.Xb],pn=wi.m,Qa=wi;for(di=0;di<Qa.za;++di){var ii=pn,Si=Qa,ua=Si.Ac,io=Si.Bc+4*di,Xo=Si.zc,Ba=Si.ya[Si.aa+di];if(Si.Qa.Bb?Ba.$b=ne(ii,Si.Pa.jb[0])?2+ne(ii,Si.Pa.jb[2]):ne(ii,Si.Pa.jb[1]):Ba.$b=0,Si.kc&&(Ba.Ad=ne(ii,Si.Bd)),Ba.Za=!ne(ii,145)+0,Ba.Za){var jo=Ba.Ob,Qo=0;for(Si=0;4>Si;++Si){var As,ji=Xo[0+Si];for(As=0;4>As;++As){ji=VK[ua[io+As]][ji];for(var $i=V6[ne(ii,ji[0])];0<$i;)$i=V6[2*$i+ne(ii,ji[$i])];ji=-$i,ua[io+As]=ji}n(jo,Qo,ua,io,4),Qo+=4,Xo[0+Si]=ji}}else ji=ne(ii,156)?ne(ii,128)?1:3:ne(ii,163)?2:0,Ba.Ob[0]=ji,i(ua,io,ji,4),i(Xo,0,ji,4);Ba.Dd=ne(ii,142)?ne(ii,114)?ne(ii,183)?1:3:2:0}if(Qa.m.Ka)return tt(wi,7,"Premature end-of-partition0 encountered.");for(;wi.ja<wi.za;++wi.ja){if(Qa=Bn,ii=(pn=wi).rb[pn.sb-1],ua=pn.rb[pn.sb+pn.ja],di=pn.ya[pn.aa+pn.ja],io=pn.kc?di.Ad:0)ii.la=ua.la=0,di.Za||(ii.Na=ua.Na=0),di.Hc=0,di.Gc=0,di.ia=0;else{var Ia,Ui;if(ii=ua,ua=Qa,io=pn.Pa.Xc,Xo=pn.ya[pn.aa+pn.ja],Ba=pn.pb[Xo.$b],Si=Xo.ad,jo=0,Qo=pn.rb[pn.sb-1],ji=As=0,i(Si,jo,0,384),Xo.Za)var ao=0,Jc=io[3];else{$i=s(16);var Ja=ii.Na+Qo.Na;if(Ja=Eg(ua,io[1],Ja,Ba.Eb,0,$i,0),ii.Na=Qo.Na=(0<Ja)+0,1<Ja)Fl($i,0,Si,jo);else{var ml=$i[0]+3>>3;for($i=0;256>$i;$i+=16)Si[jo+$i]=ml}ao=1,Jc=io[0]}var ta=15&ii.la,Ns=15&Qo.la;for($i=0;4>$i;++$i){var Dl=1&Ns;for(ml=Ui=0;4>ml;++ml)ta=ta>>1|(Dl=(Ja=Eg(ua,Jc,Ja=Dl+(1&ta),Ba.Sc,ao,Si,jo))>ao)<<7,Ui=Ui<<2|(3<Ja?3:1<Ja?2:Si[jo+0]!=0),jo+=16;ta>>=4,Ns=Ns>>1|Dl<<7,As=(As<<8|Ui)>>>0}for(Jc=ta,ao=Ns>>4,Ia=0;4>Ia;Ia+=2){for(Ui=0,ta=ii.la>>4+Ia,Ns=Qo.la>>4+Ia,$i=0;2>$i;++$i){for(Dl=1&Ns,ml=0;2>ml;++ml)Ja=Dl+(1&ta),ta=ta>>1|(Dl=0<(Ja=Eg(ua,io[2],Ja,Ba.Qc,0,Si,jo)))<<3,Ui=Ui<<2|(3<Ja?3:1<Ja?2:Si[jo+0]!=0),jo+=16;ta>>=2,Ns=Ns>>1|Dl<<5}ji|=Ui<<4*Ia,Jc|=ta<<4<<Ia,ao|=(240&Ns)<<Ia}ii.la=Jc,Qo.la=ao,Xo.Hc=As,Xo.Gc=ji,Xo.ia=43690&ji?0:Ba.ia,io=!(As|ji)}if(0<pn.L&&(pn.wa[pn.Y+pn.ja]=pn.gd[di.$b][di.Za],pn.wa[pn.Y+pn.ja].La|=!io),Qa.Ka)return tt(wi,7,"Premature end-of-file encountered.")}if(pr(wi),pn=ks,Qa=1,di=(Bn=wi).D,ii=0<Bn.L&&Bn.M>=Bn.zb&&Bn.M<=Bn.Va,Bn.Aa==0)t:{if(di.M=Bn.M,di.uc=ii,Jn(Bn,di),Qa=1,di=(Ui=Bn.D).Nb,ii=(ji=Yy[Bn.L])*Bn.R,ua=ji/2*Bn.B,$i=16*di*Bn.R,ml=8*di*Bn.B,io=Bn.sa,Xo=Bn.ta-ii+$i,Ba=Bn.qa,Si=Bn.ra-ua+ml,jo=Bn.Ha,Qo=Bn.Ia-ua+ml,Ns=(ta=Ui.M)==0,As=ta>=Bn.Va-1,Bn.Aa==2&&Jn(Bn,Ui),Ui.uc)for(Dl=(Ja=Bn).D.M,t(Ja.D.uc),Ui=Ja.yb;Ui<Ja.Hb;++Ui){ao=Ui,Jc=Dl;var Jo=($l=(so=Ja).D).Nb;Ia=so.R;var $l=$l.wa[$l.Y+ao],Ul=so.sa,gl=so.ta+16*Jo*Ia+16*ao,zl=$l.dd,aa=$l.tc;if(aa!=0)if(t(3<=aa),so.L==1)0<ao&&O6(Ul,gl,Ia,aa+4),$l.La&&L6(Ul,gl,Ia,aa),0<Jc&&P6(Ul,gl,Ia,aa+4),$l.La&&M6(Ul,gl,Ia,aa);else{var Wl=so.B,Zc=so.qa,Oh=so.ra+8*Jo*Wl+8*ao,gd=so.Ha,so=so.Ia+8*Jo*Wl+8*ao;Jo=$l.ld,0<ao&&(js(Ul,gl,Ia,aa+4,zl,Jo),Ng(Zc,Oh,gd,so,Wl,aa+4,zl,Jo)),$l.La&&($y(Ul,gl,Ia,aa,zl,Jo),T6(Zc,Oh,gd,so,Wl,aa,zl,Jo)),0<Jc&&(Xa(Ul,gl,Ia,aa+4,zl,Jo),pd(Zc,Oh,gd,so,Wl,aa+4,zl,Jo)),$l.La&&(fp(Ul,gl,Ia,aa,zl,Jo),E6(Zc,Oh,gd,so,Wl,aa,zl,Jo))}}if(Bn.ia&&alert("todo:DitherRow"),pn.put!=null){if(Ui=16*ta,ta=16*(ta+1),Ns?(pn.y=Bn.sa,pn.O=Bn.ta+$i,pn.f=Bn.qa,pn.N=Bn.ra+ml,pn.ea=Bn.Ha,pn.W=Bn.Ia+ml):(Ui-=ji,pn.y=io,pn.O=Xo,pn.f=Ba,pn.N=Si,pn.ea=jo,pn.W=Qo),As||(ta-=ji),ta>pn.o&&(ta=pn.o),pn.F=null,pn.J=null,Bn.Fa!=null&&0<Bn.Fa.length&&Ui<ta&&(pn.J=fe(Bn,pn,Ui,ta-Ui),pn.F=Bn.mb,pn.F==null&&pn.F.length==0)){Qa=tt(Bn,3,"Could not decode alpha data.");break t}Ui<pn.j&&(ji=pn.j-Ui,Ui=pn.j,t(!(1&ji)),pn.O+=Bn.R*ji,pn.N+=Bn.B*(ji>>1),pn.W+=Bn.B*(ji>>1),pn.F!=null&&(pn.J+=pn.width*ji)),Ui<ta&&(pn.O+=pn.v,pn.N+=pn.v>>1,pn.W+=pn.v>>1,pn.F!=null&&(pn.J+=pn.v),pn.ka=Ui-pn.j,pn.U=pn.va-pn.v,pn.T=ta-Ui,Qa=pn.put(pn))}di+1!=Bn.Ic||As||(n(Bn.sa,Bn.ta-ii,io,Xo+16*Bn.R,ii),n(Bn.qa,Bn.ra-ua,Ba,Si+8*Bn.B,ua),n(Bn.Ha,Bn.Ia-ua,jo,Qo+8*Bn.B,ua))}if(!Qa)return tt(wi,6,"Output aborted.")}return 1}(Ke,Ft)),Ft.bc!=null&&Ft.bc(Ft),Yt&=1}return Yt?(Ke.cb=0,Yt):0})(_,te)||(N=_.a)}}else N=_.a}N==0&&ve.Oa!=null&&ve.Oa.fd&&(N=Ko(ve.ba))}ve=N}ge=ve!=0?null:11>ge?Ae.f.RGBA.eb:Ae.f.kb.y}else ge=null;return ge};var eT=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(M,B){for(var E="",P=0;P<4;P++)E+=String.fromCharCode(M[B++]);return E}function d(M,B){return M[B+0]|M[B+1]<<8}function f(M,B){return(M[B+0]|M[B+1]<<8|M[B+2]<<16)>>>0}function h(M,B){return(M[B+0]|M[B+1]<<8|M[B+2]<<16|M[B+3]<<24)>>>0}new c;var p=[0],m=[0],g=[],y=new c,b=e,v=function(M,B){var E={},P=0,U=!1,G=0,H=0;if(E.frames=[],!function(C,Y){for(var q=0;q<4;q++)if(C[Y+q]!="RIFF".charCodeAt(q))return!0;return!1}(M,B)){for(h(M,B+=4),B+=8;B<M.length;){var oe=u(M,B),de=h(M,B+=4);B+=4;var W=de+(1&de);switch(oe){case"VP8 ":case"VP8L":E.frames[P]===void 0&&(E.frames[P]={}),(ee=E.frames[P]).src_off=U?H:B-8,ee.src_size=G+de+8,P++,U&&(U=!1,G=0,H=0);break;case"VP8X":(ee=E.header={}).feature_flags=M[B];var V=B+4;ee.canvas_width=1+f(M,V),V+=3,ee.canvas_height=1+f(M,V),V+=3;break;case"ALPH":U=!0,G=W+8,H=B-8;break;case"ANIM":(ee=E.header).bgcolor=h(M,B),V=B+4,ee.loop_count=d(M,V),V+=2;break;case"ANMF":var ae,ee;(ee=E.frames[P]={}).offset_x=2*f(M,B),B+=3,ee.offset_y=2*f(M,B),B+=3,ee.width=1+f(M,B),B+=3,ee.height=1+f(M,B),B+=3,ee.duration=f(M,B),B+=3,ae=M[B++],ee.dispose=1&ae,ee.blend=ae>>1&1}oe!="ANMF"&&(B+=W)}return E}}(b,0);v.response=b,v.rgbaoutput=!0,v.dataurl=!1;var w=v.header?v.header:null,S=v.frames?v.frames:null;if(w){w.loop_counter=w.loop_count,p=[w.canvas_height],m=[w.canvas_width];for(var j=0;j<S.length&&S[j].blend!=0;j++);}var k=S[0],A=y.WebPDecodeRGBA(b,k.src_off,k.src_size,m,p);k.rgba=A,k.imgwidth=m[0],k.imgheight=p[0];for(var R=0;R<m[0]*p[0]*4;R++)g[R]=A[R];return this.width=m,this.height=p,this.data=g,this}/** ====================================================================
 * @license
 * jsPDF XMP metadata plugin
 * Copyright (c) 2016 Jussi Utunen, u-jussi@suomi24.fi
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 */function $ge(){var e,t=this.internal.__metadata__.metadata,r=unescape(encodeURIComponent(t));e=this.internal.__metadata__.rawXml?r:'<x:xmpmeta xmlns:x="adobe:ns:meta/"><rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceUri+'"><jspdf:metadata>'+r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")+"</jspdf:metadata></rdf:Description></rdf:RDF></x:xmpmeta>",this.internal.__metadata__.metadataObjectNumber=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+e.length+" >>"),this.internal.write("stream"),this.internal.write(e),this.internal.write("endstream"),this.internal.write("endobj")}function Uge(){this.internal.__metadata__.metadataObjectNumber&&this.internal.write("/Metadata "+this.internal.__metadata__.metadataObjectNumber+" 0 R")}(function(e){var t,r,n,i,s,o,l,c,u,d=function(C){return C=C||{},this.isStrokeTransparent=C.isStrokeTransparent||!1,this.strokeOpacity=C.strokeOpacity||1,this.strokeStyle=C.strokeStyle||"#000000",this.fillStyle=C.fillStyle||"#000000",this.isFillTransparent=C.isFillTransparent||!1,this.fillOpacity=C.fillOpacity||1,this.font=C.font||"10px sans-serif",this.textBaseline=C.textBaseline||"alphabetic",this.textAlign=C.textAlign||"left",this.lineWidth=C.lineWidth||1,this.lineJoin=C.lineJoin||"miter",this.lineCap=C.lineCap||"butt",this.path=C.path||[],this.transform=C.transform!==void 0?C.transform.clone():new c,this.globalCompositeOperation=C.globalCompositeOperation||"normal",this.globalAlpha=C.globalAlpha||1,this.clip_path=C.clip_path||[],this.currentPoint=C.currentPoint||new o,this.miterLimit=C.miterLimit||10,this.lastPoint=C.lastPoint||new o,this.lineDashOffset=C.lineDashOffset||0,this.lineDash=C.lineDash||[],this.margin=C.margin||[0,0,0,0],this.prevPageLastElemOffset=C.prevPageLastElemOffset||0,this.ignoreClearRect=typeof C.ignoreClearRect!="boolean"||C.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new f(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new d}]);var f=function(C){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var Y=C;Object.defineProperty(this,"pdf",{get:function(){return Y}});var q=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return q},set:function(D){q=!!D}});var O=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return O},set:function(D){O=!!D}});var X=0;Object.defineProperty(this,"posX",{get:function(){return X},set:function(D){isNaN(D)||(X=D)}});var F=0;Object.defineProperty(this,"posY",{get:function(){return F},set:function(D){isNaN(D)||(F=D)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(D){var Z;typeof D=="number"?Z=[D,D,D,D]:((Z=new Array(4))[0]=D[0],Z[1]=D.length>=2?D[1]:Z[0],Z[2]=D.length>=3?D[2]:Z[0],Z[3]=D.length>=4?D[3]:Z[1]),u.margin=Z}});var Q=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Q},set:function(D){Q=D}});var K=0;Object.defineProperty(this,"lastBreak",{get:function(){return K},set:function(D){K=D}});var ne=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ne},set:function(D){ne=D}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(D){D instanceof d&&(u=D)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(D){u.path=D}});var re=[];Object.defineProperty(this,"ctxStack",{get:function(){return re},set:function(D){re=D}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(D){var Z;Z=h(D),this.ctx.fillStyle=Z.style,this.ctx.isFillTransparent=Z.a===0,this.ctx.fillOpacity=Z.a,this.pdf.setFillColor(Z.r,Z.g,Z.b,{a:Z.a}),this.pdf.setTextColor(Z.r,Z.g,Z.b,{a:Z.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(D){var Z=h(D);this.ctx.strokeStyle=Z.style,this.ctx.isStrokeTransparent=Z.a===0,this.ctx.strokeOpacity=Z.a,Z.a===0?this.pdf.setDrawColor(255,255,255):(Z.a,this.pdf.setDrawColor(Z.r,Z.g,Z.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(D){["butt","round","square"].indexOf(D)!==-1&&(this.ctx.lineCap=D,this.pdf.setLineCap(D))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(D){isNaN(D)||(this.ctx.lineWidth=D,this.pdf.setLineWidth(D))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(D){["bevel","round","miter"].indexOf(D)!==-1&&(this.ctx.lineJoin=D,this.pdf.setLineJoin(D))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(D){isNaN(D)||(this.ctx.miterLimit=D,this.pdf.setMiterLimit(D))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(D){this.ctx.textBaseline=D}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(D){["right","end","center","left","start"].indexOf(D)!==-1&&(this.ctx.textAlign=D)}});var T=null,I=null,ie=null;Object.defineProperty(this,"fontFaces",{get:function(){return ie},set:function(D){T=null,I=null,ie=D}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(D){var Z;if(this.ctx.font=D,(Z=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(D))!==null){var me=Z[1];Z[2];var Te=Z[3],je=Z[4];Z[5];var Le=Z[6],_e=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(je)[2];je=Math.floor(_e==="px"?parseFloat(je)*this.pdf.internal.scaleFactor:_e==="em"?parseFloat(je)*this.pdf.getFontSize():parseFloat(je)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(je);var He=function(we){var ht,nt,Ie=[],It=we.trim();if(It==="")return Ej;if(It in lM)return[lM[It]];for(;It!=="";){switch(nt=null,ht=(It=uM(It)).charAt(0)){case'"':case"'":nt=Lge(It.substring(1),ht);break;default:nt=Rge(It)}if(nt===null||(Ie.push(nt[0]),(It=uM(nt[1]))!==""&&It.charAt(0)!==","))return Ej;It=It.replace(/^,/,"")}return Ie}(Le);if(this.fontFaces){var We=function(we,ht){var nt=we.getFontList(),Ie=JSON.stringify(nt);if(T===null||I!==Ie){var It=function(ct){var Mt=[];return Object.keys(ct).forEach(function(xr){ct[xr].forEach(function(Pr){var Nt=null;switch(Pr){case"bold":Nt={family:xr,weight:"bold"};break;case"italic":Nt={family:xr,style:"italic"};break;case"bolditalic":Nt={family:xr,weight:"bold",style:"italic"};break;case"":case"normal":Nt={family:xr}}Nt!==null&&(Nt.ref={name:xr,style:Pr},Mt.push(Nt))})}),Mt}(nt);T=function(ct){for(var Mt={},xr=0;xr<ct.length;++xr){var Pr=Cj(ct[xr]),Nt=Pr.family,Jr=Pr.stretch,Ur=Pr.style,qr=Pr.weight;Mt[Nt]=Mt[Nt]||{},Mt[Nt][Jr]=Mt[Nt][Jr]||{},Mt[Nt][Jr][Ur]=Mt[Nt][Jr][Ur]||{},Mt[Nt][Jr][Ur][qr]=Pr}return Mt}(It.concat(ht)),I=Ie}return T}(this.pdf,this.fontFaces),Pt=He.map(function(we){return{family:we,stretch:"normal",weight:Te,style:me}}),dt=function(we,ht,nt){for(var Ie=(nt=nt||{}).defaultFontFamily||"times",It=Object.assign({},Mge,nt.genericFontFamilies||{}),ct=null,Mt=null,xr=0;xr<ht.length;++xr)if(It[(ct=Cj(ht[xr])).family]&&(ct.family=It[ct.family]),we.hasOwnProperty(ct.family)){Mt=we[ct.family];break}if(!(Mt=Mt||we[Ie]))throw new Error("Could not find a font-family for the rule '"+cM(ct)+"' and default family '"+Ie+"'.");if(Mt=function(Pr,Nt){if(Nt[Pr])return Nt[Pr];var Jr=sA[Pr],Ur=Jr<=sA.normal?-1:1,qr=oM(Nt,Dz,Jr,Ur);if(!qr)throw new Error("Could not find a matching font-stretch value for "+Pr);return qr}(ct.stretch,Mt),Mt=function(Pr,Nt){if(Nt[Pr])return Nt[Pr];for(var Jr=Iz[Pr],Ur=0;Ur<Jr.length;++Ur)if(Nt[Jr[Ur]])return Nt[Jr[Ur]];throw new Error("Could not find a matching font-style for "+Pr)}(ct.style,Mt),!(Mt=function(Pr,Nt){if(Nt[Pr])return Nt[Pr];if(Pr===400&&Nt[500])return Nt[500];if(Pr===500&&Nt[400])return Nt[400];var Jr=Oge[Pr],Ur=oM(Nt,$z,Jr,Pr<400?-1:1);if(!Ur)throw new Error("Could not find a matching font-weight for value "+Pr);return Ur}(ct.weight,Mt)))throw new Error("Failed to resolve a font for the rule '"+cM(ct)+"'.");return Mt}(We,Pt);this.pdf.setFont(dt.ref.name,dt.ref.style)}else{var Ye="";(Te==="bold"||parseInt(Te,10)>=700||me==="bold")&&(Ye="bold"),me==="italic"&&(Ye+="italic"),Ye.length===0&&(Ye="normal");for(var lt="",be={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},ke=0;ke<He.length;ke++){if(this.pdf.internal.getFont(He[ke],Ye,{noFallback:!0,disableWarning:!0})!==void 0){lt=He[ke];break}if(Ye==="bolditalic"&&this.pdf.internal.getFont(He[ke],"bold",{noFallback:!0,disableWarning:!0})!==void 0)lt=He[ke],Ye="bold";else if(this.pdf.internal.getFont(He[ke],"normal",{noFallback:!0,disableWarning:!0})!==void 0){lt=He[ke],Ye="normal";break}}if(lt===""){for(var ce=0;ce<He.length;ce++)if(be[He[ce]]){lt=be[He[ce]];break}}lt=lt===""?"Times":lt,this.pdf.setFont(lt,Ye)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(D){this.ctx.globalCompositeOperation=D}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(D){this.ctx.globalAlpha=D}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(D){this.ctx.lineDashOffset=D,ee.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(D){this.ctx.lineDash=D,ee.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(D){this.ctx.ignoreClearRect=!!D}})};f.prototype.setLineDash=function(C){this.lineDash=C},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){S.call(this,"fill",!1)},f.prototype.stroke=function(){S.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(C,Y){if(isNaN(C)||isNaN(Y))throw na.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var q=this.ctx.transform.applyToPoint(new o(C,Y));this.path.push({type:"mt",x:q.x,y:q.y}),this.ctx.lastPoint=new o(C,Y)},f.prototype.closePath=function(){var C=new o(0,0),Y=0;for(Y=this.path.length-1;Y!==-1;Y--)if(this.path[Y].type==="begin"&&Hi(this.path[Y+1])==="object"&&typeof this.path[Y+1].x=="number"){C=new o(this.path[Y+1].x,this.path[Y+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(C.x,C.y)},f.prototype.lineTo=function(C,Y){if(isNaN(C)||isNaN(Y))throw na.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var q=this.ctx.transform.applyToPoint(new o(C,Y));this.path.push({type:"lt",x:q.x,y:q.y}),this.ctx.lastPoint=new o(q.x,q.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),S.call(this,null,!0)},f.prototype.quadraticCurveTo=function(C,Y,q,O){if(isNaN(q)||isNaN(O)||isNaN(C)||isNaN(Y))throw na.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var X=this.ctx.transform.applyToPoint(new o(q,O)),F=this.ctx.transform.applyToPoint(new o(C,Y));this.path.push({type:"qct",x1:F.x,y1:F.y,x:X.x,y:X.y}),this.ctx.lastPoint=new o(X.x,X.y)},f.prototype.bezierCurveTo=function(C,Y,q,O,X,F){if(isNaN(X)||isNaN(F)||isNaN(C)||isNaN(Y)||isNaN(q)||isNaN(O))throw na.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Q=this.ctx.transform.applyToPoint(new o(X,F)),K=this.ctx.transform.applyToPoint(new o(C,Y)),ne=this.ctx.transform.applyToPoint(new o(q,O));this.path.push({type:"bct",x1:K.x,y1:K.y,x2:ne.x,y2:ne.y,x:Q.x,y:Q.y}),this.ctx.lastPoint=new o(Q.x,Q.y)},f.prototype.arc=function(C,Y,q,O,X,F){if(isNaN(C)||isNaN(Y)||isNaN(q)||isNaN(O)||isNaN(X))throw na.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(F=!!F,!this.ctx.transform.isIdentity){var Q=this.ctx.transform.applyToPoint(new o(C,Y));C=Q.x,Y=Q.y;var K=this.ctx.transform.applyToPoint(new o(0,q)),ne=this.ctx.transform.applyToPoint(new o(0,0));q=Math.sqrt(Math.pow(K.x-ne.x,2)+Math.pow(K.y-ne.y,2))}Math.abs(X-O)>=2*Math.PI&&(O=0,X=2*Math.PI),this.path.push({type:"arc",x:C,y:Y,radius:q,startAngle:O,endAngle:X,counterclockwise:F})},f.prototype.arcTo=function(C,Y,q,O,X){throw new Error("arcTo not implemented.")},f.prototype.rect=function(C,Y,q,O){if(isNaN(C)||isNaN(Y)||isNaN(q)||isNaN(O))throw na.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(C,Y),this.lineTo(C+q,Y),this.lineTo(C+q,Y+O),this.lineTo(C,Y+O),this.lineTo(C,Y),this.lineTo(C+q,Y),this.lineTo(C,Y)},f.prototype.fillRect=function(C,Y,q,O){if(isNaN(C)||isNaN(Y)||isNaN(q)||isNaN(O))throw na.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!p.call(this)){var X={};this.lineCap!=="butt"&&(X.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(X.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(C,Y,q,O),this.fill(),X.hasOwnProperty("lineCap")&&(this.lineCap=X.lineCap),X.hasOwnProperty("lineJoin")&&(this.lineJoin=X.lineJoin)}},f.prototype.strokeRect=function(C,Y,q,O){if(isNaN(C)||isNaN(Y)||isNaN(q)||isNaN(O))throw na.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(C,Y,q,O),this.stroke())},f.prototype.clearRect=function(C,Y,q,O){if(isNaN(C)||isNaN(Y)||isNaN(q)||isNaN(O))throw na.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(C,Y,q,O))},f.prototype.save=function(C){C=typeof C!="boolean"||C;for(var Y=this.pdf.internal.getCurrentPageInfo().pageNumber,q=0;q<this.pdf.internal.getNumberOfPages();q++)this.pdf.setPage(q+1),this.pdf.internal.out("q");if(this.pdf.setPage(Y),C){this.ctx.fontSize=this.pdf.internal.getFontSize();var O=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=O}},f.prototype.restore=function(C){C=typeof C!="boolean"||C;for(var Y=this.pdf.internal.getCurrentPageInfo().pageNumber,q=0;q<this.pdf.internal.getNumberOfPages();q++)this.pdf.setPage(q+1),this.pdf.internal.out("Q");this.pdf.setPage(Y),C&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var h=function(C){var Y,q,O,X;if(C.isCanvasGradient===!0&&(C=C.getColor()),!C)return{r:0,g:0,b:0,a:0,style:C};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(C))Y=0,q=0,O=0,X=0;else{var F=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(C);if(F!==null)Y=parseInt(F[1]),q=parseInt(F[2]),O=parseInt(F[3]),X=1;else if((F=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(C))!==null)Y=parseInt(F[1]),q=parseInt(F[2]),O=parseInt(F[3]),X=parseFloat(F[4]);else{if(X=1,typeof C=="string"&&C.charAt(0)!=="#"){var Q=new Pz(C);C=Q.ok?Q.toHex():"#000000"}C.length===4?(Y=C.substring(1,2),Y+=Y,q=C.substring(2,3),q+=q,O=C.substring(3,4),O+=O):(Y=C.substring(1,3),q=C.substring(3,5),O=C.substring(5,7)),Y=parseInt(Y,16),q=parseInt(q,16),O=parseInt(O,16)}}return{r:Y,g:q,b:O,a:X,style:C}},p=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},m=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(C,Y,q,O){if(isNaN(Y)||isNaN(q)||typeof C!="string")throw na.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(O=isNaN(O)?void 0:O,!p.call(this)){var X=W(this.ctx.transform.rotation),F=this.ctx.transform.scaleX;P.call(this,{text:C,x:Y,y:q,scale:F,angle:X,align:this.textAlign,maxWidth:O})}},f.prototype.strokeText=function(C,Y,q,O){if(isNaN(Y)||isNaN(q)||typeof C!="string")throw na.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){O=isNaN(O)?void 0:O;var X=W(this.ctx.transform.rotation),F=this.ctx.transform.scaleX;P.call(this,{text:C,x:Y,y:q,scale:F,renderingMode:"stroke",angle:X,align:this.textAlign,maxWidth:O})}},f.prototype.measureText=function(C){if(typeof C!="string")throw na.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var Y=this.pdf,q=this.pdf.internal.scaleFactor,O=Y.internal.getFontSize(),X=Y.getStringUnitWidth(C)*O/Y.internal.scaleFactor;return new function(F){var Q=(F=F||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Q}}),this}({width:X*=Math.round(96*q/72*1e4)/1e4})},f.prototype.scale=function(C,Y){if(isNaN(C)||isNaN(Y))throw na.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var q=new c(C,0,0,Y,0,0);this.ctx.transform=this.ctx.transform.multiply(q)},f.prototype.rotate=function(C){if(isNaN(C))throw na.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var Y=new c(Math.cos(C),Math.sin(C),-Math.sin(C),Math.cos(C),0,0);this.ctx.transform=this.ctx.transform.multiply(Y)},f.prototype.translate=function(C,Y){if(isNaN(C)||isNaN(Y))throw na.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var q=new c(1,0,0,1,C,Y);this.ctx.transform=this.ctx.transform.multiply(q)},f.prototype.transform=function(C,Y,q,O,X,F){if(isNaN(C)||isNaN(Y)||isNaN(q)||isNaN(O)||isNaN(X)||isNaN(F))throw na.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Q=new c(C,Y,q,O,X,F);this.ctx.transform=this.ctx.transform.multiply(Q)},f.prototype.setTransform=function(C,Y,q,O,X,F){C=isNaN(C)?1:C,Y=isNaN(Y)?0:Y,q=isNaN(q)?0:q,O=isNaN(O)?1:O,X=isNaN(X)?0:X,F=isNaN(F)?0:F,this.ctx.transform=new c(C,Y,q,O,X,F)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(C,Y,q,O,X,F,Q,K,ne){var re=this.pdf.getImageProperties(C),T=1,I=1,ie=1,D=1;O!==void 0&&K!==void 0&&(ie=K/O,D=ne/X,T=re.width/O*K/O,I=re.height/X*ne/X),F===void 0&&(F=Y,Q=q,Y=0,q=0),O!==void 0&&K===void 0&&(K=O,ne=X),O===void 0&&K===void 0&&(K=re.width,ne=re.height);var Z=this.ctx.transform.decompose(),me=W(Z.rotate.shx),Te=new c,je=(Te=(Te=(Te=Te.multiply(Z.translate)).multiply(Z.skew)).multiply(Z.scale)).applyToRectangle(new l(F-Y*ie,Q-q*D,O*T,X*I));if(this.autoPaging){for(var Le,_e=y.call(this,je),He=[],We=0;We<_e.length;We+=1)He.indexOf(_e[We])===-1&&He.push(_e[We]);w(He);for(var Pt=He[0],dt=He[He.length-1],Ye=Pt;Ye<dt+1;Ye++){this.pdf.setPage(Ye);var lt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],be=Ye===1?this.posY+this.margin[0]:this.margin[0],ke=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ce=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],we=Ye===1?0:ke+(Ye-2)*ce;if(this.ctx.clip_path.length!==0){var ht=this.path;Le=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(Le,this.posX+this.margin[3],-we+be+this.ctx.prevPageLastElemOffset),j.call(this,"fill",!0),this.path=ht}var nt=JSON.parse(JSON.stringify(je));nt=v([nt],this.posX+this.margin[3],-we+be+this.ctx.prevPageLastElemOffset)[0];var Ie=(Ye>Pt||Ye<dt)&&g.call(this);Ie&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],lt,ce,null).clip().discardPath()),this.pdf.addImage(C,"JPEG",nt.x,nt.y,nt.w,nt.h,null,null,me),Ie&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(C,"JPEG",je.x,je.y,je.w,je.h,null,null,me)};var y=function(C,Y,q){var O=[];Y=Y||this.pdf.internal.pageSize.width,q=q||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var X=this.posY+this.ctx.prevPageLastElemOffset;switch(C.type){default:case"mt":case"lt":O.push(Math.floor((C.y+X)/q)+1);break;case"arc":O.push(Math.floor((C.y+X-C.radius)/q)+1),O.push(Math.floor((C.y+X+C.radius)/q)+1);break;case"qct":var F=V(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x,C.y);O.push(Math.floor((F.y+X)/q)+1),O.push(Math.floor((F.y+F.h+X)/q)+1);break;case"bct":var Q=ae(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x2,C.y2,C.x,C.y);O.push(Math.floor((Q.y+X)/q)+1),O.push(Math.floor((Q.y+Q.h+X)/q)+1);break;case"rect":O.push(Math.floor((C.y+X)/q)+1),O.push(Math.floor((C.y+C.h+X)/q)+1)}for(var K=0;K<O.length;K+=1)for(;this.pdf.internal.getNumberOfPages()<O[K];)b.call(this);return O},b=function(){var C=this.fillStyle,Y=this.strokeStyle,q=this.font,O=this.lineCap,X=this.lineWidth,F=this.lineJoin;this.pdf.addPage(),this.fillStyle=C,this.strokeStyle=Y,this.font=q,this.lineCap=O,this.lineWidth=X,this.lineJoin=F},v=function(C,Y,q){for(var O=0;O<C.length;O++)switch(C[O].type){case"bct":C[O].x2+=Y,C[O].y2+=q;case"qct":C[O].x1+=Y,C[O].y1+=q;default:C[O].x+=Y,C[O].y+=q}return C},w=function(C){return C.sort(function(Y,q){return Y-q})},S=function(C,Y){var q=this.fillStyle,O=this.strokeStyle,X=this.lineCap,F=this.lineWidth,Q=Math.abs(F*this.ctx.transform.scaleX),K=this.lineJoin;if(this.autoPaging){for(var ne,re,T=JSON.parse(JSON.stringify(this.path)),I=JSON.parse(JSON.stringify(this.path)),ie=[],D=0;D<I.length;D++)if(I[D].x!==void 0)for(var Z=y.call(this,I[D]),me=0;me<Z.length;me+=1)ie.indexOf(Z[me])===-1&&ie.push(Z[me]);for(var Te=0;Te<ie.length;Te++)for(;this.pdf.internal.getNumberOfPages()<ie[Te];)b.call(this);w(ie);for(var je=ie[0],Le=ie[ie.length-1],_e=je;_e<Le+1;_e++){this.pdf.setPage(_e),this.fillStyle=q,this.strokeStyle=O,this.lineCap=X,this.lineWidth=Q,this.lineJoin=K;var He=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],We=_e===1?this.posY+this.margin[0]:this.margin[0],Pt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],dt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ye=_e===1?0:Pt+(_e-2)*dt;if(this.ctx.clip_path.length!==0){var lt=this.path;ne=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(ne,this.posX+this.margin[3],-Ye+We+this.ctx.prevPageLastElemOffset),j.call(this,C,!0),this.path=lt}if(re=JSON.parse(JSON.stringify(T)),this.path=v(re,this.posX+this.margin[3],-Ye+We+this.ctx.prevPageLastElemOffset),Y===!1||_e===0){var be=(_e>je||_e<Le)&&g.call(this);be&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],He,dt,null).clip().discardPath()),j.call(this,C,Y),be&&this.pdf.restoreGraphicsState()}this.lineWidth=F}this.path=T}else this.lineWidth=Q,j.call(this,C,Y),this.lineWidth=F},j=function(C,Y){if((C!=="stroke"||Y||!m.call(this))&&(C==="stroke"||Y||!p.call(this))){for(var q,O,X=[],F=this.path,Q=0;Q<F.length;Q++){var K=F[Q];switch(K.type){case"begin":X.push({begin:!0});break;case"close":X.push({close:!0});break;case"mt":X.push({start:K,deltas:[],abs:[]});break;case"lt":var ne=X.length;if(F[Q-1]&&!isNaN(F[Q-1].x)&&(q=[K.x-F[Q-1].x,K.y-F[Q-1].y],ne>0)){for(;ne>=0;ne--)if(X[ne-1].close!==!0&&X[ne-1].begin!==!0){X[ne-1].deltas.push(q),X[ne-1].abs.push(K);break}}break;case"bct":q=[K.x1-F[Q-1].x,K.y1-F[Q-1].y,K.x2-F[Q-1].x,K.y2-F[Q-1].y,K.x-F[Q-1].x,K.y-F[Q-1].y],X[X.length-1].deltas.push(q);break;case"qct":var re=F[Q-1].x+2/3*(K.x1-F[Q-1].x),T=F[Q-1].y+2/3*(K.y1-F[Q-1].y),I=K.x+2/3*(K.x1-K.x),ie=K.y+2/3*(K.y1-K.y),D=K.x,Z=K.y;q=[re-F[Q-1].x,T-F[Q-1].y,I-F[Q-1].x,ie-F[Q-1].y,D-F[Q-1].x,Z-F[Q-1].y],X[X.length-1].deltas.push(q);break;case"arc":X.push({deltas:[],abs:[],arc:!0}),Array.isArray(X[X.length-1].abs)&&X[X.length-1].abs.push(K)}}O=Y?null:C==="stroke"?"stroke":"fill";for(var me=!1,Te=0;Te<X.length;Te++)if(X[Te].arc)for(var je=X[Te].abs,Le=0;Le<je.length;Le++){var _e=je[Le];_e.type==="arc"?R.call(this,_e.x,_e.y,_e.radius,_e.startAngle,_e.endAngle,_e.counterclockwise,void 0,Y,!me):U.call(this,_e.x,_e.y),me=!0}else if(X[Te].close===!0)this.pdf.internal.out("h"),me=!1;else if(X[Te].begin!==!0){var He=X[Te].start.x,We=X[Te].start.y;G.call(this,X[Te].deltas,He,We),me=!0}O&&M.call(this,O),Y&&B.call(this)}},k=function(C){var Y=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,q=Y*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return C-q;case"top":return C+Y-q;case"hanging":return C+Y-2*q;case"middle":return C+Y/2-q;default:return C}},A=function(C){return C+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var C=function(){};return C.colorStops=[],C.addColorStop=function(Y,q){this.colorStops.push([Y,q])},C.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},C.isCanvasGradient=!0,C},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var R=function(C,Y,q,O,X,F,Q,K,ne){for(var re=oe.call(this,q,O,X,F),T=0;T<re.length;T++){var I=re[T];T===0&&(ne?E.call(this,I.x1+C,I.y1+Y):U.call(this,I.x1+C,I.y1+Y)),H.call(this,C,Y,I.x2,I.y2,I.x3,I.y3,I.x4,I.y4)}K?B.call(this):M.call(this,Q)},M=function(C){switch(C){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},B=function(){this.pdf.clip(),this.pdf.discardPath()},E=function(C,Y){this.pdf.internal.out(r(C)+" "+n(Y)+" m")},P=function(C){var Y;switch(C.align){case"right":case"end":Y="right";break;case"center":Y="center";break;default:Y="left"}var q,O,X,F=this.pdf.getTextDimensions(C.text),Q=k.call(this,C.y),K=A.call(this,Q)-F.h,ne=this.ctx.transform.applyToPoint(new o(C.x,Q));if(this.autoPaging){var re=this.ctx.transform.decompose(),T=new c;T=(T=(T=T.multiply(re.translate)).multiply(re.skew)).multiply(re.scale);for(var I=this.ctx.transform.applyToRectangle(new l(C.x,Q,F.w,F.h)),ie=T.applyToRectangle(new l(C.x,K,F.w,F.h)),D=y.call(this,ie),Z=[],me=0;me<D.length;me+=1)Z.indexOf(D[me])===-1&&Z.push(D[me]);w(Z);for(var Te=Z[0],je=Z[Z.length-1],Le=Te;Le<je+1;Le++){this.pdf.setPage(Le);var _e=Le===1?this.posY+this.margin[0]:this.margin[0],He=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],We=this.pdf.internal.pageSize.height-this.margin[2],Pt=We-this.margin[0],dt=this.pdf.internal.pageSize.width-this.margin[1],Ye=dt-this.margin[3],lt=Le===1?0:He+(Le-2)*Pt;if(this.ctx.clip_path.length!==0){var be=this.path;q=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(q,this.posX+this.margin[3],-1*lt+_e),j.call(this,"fill",!0),this.path=be}var ke=v([JSON.parse(JSON.stringify(ie))],this.posX+this.margin[3],-lt+_e+this.ctx.prevPageLastElemOffset)[0];C.scale>=.01&&(O=this.pdf.internal.getFontSize(),this.pdf.setFontSize(O*C.scale),X=this.lineWidth,this.lineWidth=X*C.scale);var ce=this.autoPaging!=="text";if(ce||ke.y+ke.h<=We){if(ce||ke.y>=_e&&ke.x<=dt){var we=ce?C.text:this.pdf.splitTextToSize(C.text,C.maxWidth||dt-ke.x)[0],ht=v([JSON.parse(JSON.stringify(I))],this.posX+this.margin[3],-lt+_e+this.ctx.prevPageLastElemOffset)[0],nt=ce&&(Le>Te||Le<je)&&g.call(this);nt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ye,Pt,null).clip().discardPath()),this.pdf.text(we,ht.x,ht.y,{angle:C.angle,align:Y,renderingMode:C.renderingMode}),nt&&this.pdf.restoreGraphicsState()}}else ke.y<We&&(this.ctx.prevPageLastElemOffset+=We-ke.y);C.scale>=.01&&(this.pdf.setFontSize(O),this.lineWidth=X)}}else C.scale>=.01&&(O=this.pdf.internal.getFontSize(),this.pdf.setFontSize(O*C.scale),X=this.lineWidth,this.lineWidth=X*C.scale),this.pdf.text(C.text,ne.x+this.posX,ne.y+this.posY,{angle:C.angle,align:Y,renderingMode:C.renderingMode,maxWidth:C.maxWidth}),C.scale>=.01&&(this.pdf.setFontSize(O),this.lineWidth=X)},U=function(C,Y,q,O){q=q||0,O=O||0,this.pdf.internal.out(r(C+q)+" "+n(Y+O)+" l")},G=function(C,Y,q){return this.pdf.lines(C,Y,q,null,null)},H=function(C,Y,q,O,X,F,Q,K){this.pdf.internal.out([t(i(q+C)),t(s(O+Y)),t(i(X+C)),t(s(F+Y)),t(i(Q+C)),t(s(K+Y)),"c"].join(" "))},oe=function(C,Y,q,O){for(var X=2*Math.PI,F=Math.PI/2;Y>q;)Y-=X;var Q=Math.abs(q-Y);Q<X&&O&&(Q=X-Q);for(var K=[],ne=O?-1:1,re=Y;Q>1e-5;){var T=re+ne*Math.min(Q,F);K.push(de.call(this,C,re,T)),Q-=Math.abs(T-re),re=T}return K},de=function(C,Y,q){var O=(q-Y)/2,X=C*Math.cos(O),F=C*Math.sin(O),Q=X,K=-F,ne=Q*Q+K*K,re=ne+Q*X+K*F,T=4/3*(Math.sqrt(2*ne*re)-re)/(Q*F-K*X),I=Q-T*K,ie=K+T*Q,D=I,Z=-ie,me=O+Y,Te=Math.cos(me),je=Math.sin(me);return{x1:C*Math.cos(Y),y1:C*Math.sin(Y),x2:I*Te-ie*je,y2:I*je+ie*Te,x3:D*Te-Z*je,y3:D*je+Z*Te,x4:C*Math.cos(q),y4:C*Math.sin(q)}},W=function(C){return 180*C/Math.PI},V=function(C,Y,q,O,X,F){var Q=C+.5*(q-C),K=Y+.5*(O-Y),ne=X+.5*(q-X),re=F+.5*(O-F),T=Math.min(C,X,Q,ne),I=Math.max(C,X,Q,ne),ie=Math.min(Y,F,K,re),D=Math.max(Y,F,K,re);return new l(T,ie,I-T,D-ie)},ae=function(C,Y,q,O,X,F,Q,K){var ne,re,T,I,ie,D,Z,me,Te,je,Le,_e,He,We,Pt=q-C,dt=O-Y,Ye=X-q,lt=F-O,be=Q-X,ke=K-F;for(re=0;re<41;re++)Te=(Z=(T=C+(ne=re/40)*Pt)+ne*((ie=q+ne*Ye)-T))+ne*(ie+ne*(X+ne*be-ie)-Z),je=(me=(I=Y+ne*dt)+ne*((D=O+ne*lt)-I))+ne*(D+ne*(F+ne*ke-D)-me),re==0?(Le=Te,_e=je,He=Te,We=je):(Le=Math.min(Le,Te),_e=Math.min(_e,je),He=Math.max(He,Te),We=Math.max(We,je));return new l(Math.round(Le),Math.round(_e),Math.round(He-Le),Math.round(We-_e))},ee=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var C,Y,q=(C=this.ctx.lineDash,Y=this.ctx.lineDashOffset,JSON.stringify({lineDash:C,lineDashOffset:Y}));this.prevLineDash!==q&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=q)}}})(Un.API),function(e){var t=function(o){var l,c,u,d,f,h,p,m,g,y;for(c=[],u=0,d=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;d>u;u+=4)(f=(o.charCodeAt(u)<<24)+(o.charCodeAt(u+1)<<16)+(o.charCodeAt(u+2)<<8)+o.charCodeAt(u+3))!==0?(h=(f=((f=((f=((f=(f-(y=f%85))/85)-(g=f%85))/85)-(m=f%85))/85)-(p=f%85))/85)%85,c.push(h+33,p+33,m+33,g+33,y+33)):c.push(122);return function(b,v){for(var w=v;w>0;w--)b.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(o){var l,c,u,d,f,h=String,p="length",m=255,g="charCodeAt",y="slice",b="replace";for(o[y](-2),o=o[y](0,-2)[b](/\s/g,"")[b]("z","!!!!!"),u=[],d=0,f=(o+=l="uuuuu"[y](o[p]%5||5))[p];f>d;d+=5)c=52200625*(o[g](d)-33)+614125*(o[g](d+1)-33)+7225*(o[g](d+2)-33)+85*(o[g](d+3)-33)+(o[g](d+4)-33),u.push(m&c>>24,m&c>>16,m&c>>8,m&c);return function(v,w){for(var S=w;S>0;S--)v.pop()}(u,l[p]),h.fromCharCode.apply(h,u)},n=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},i=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",u=0;u<o.length;u+=2)c+=String.fromCharCode("0x"+(o[u]+o[u+1]));return c},s=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=Z4(l)).reduce(function(u,d){return u+String.fromCharCode(d)},"")};e.processDataByFilters=function(o,l){var c=0,u=o||"",d=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":u=r(u),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=t(u),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=i(u),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=n(u),d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=s(u),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:u,reverseChain:d.reverse().join(" ")}}}(Un.API),function(e){e.loadFile=function(t,r,n){return function(i,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,u,d){var f=new XMLHttpRequest,h=0,p=function(m){var g=m.length,y=[],b=String.fromCharCode;for(h=0;h<g;h+=1)y.push(b(255&m.charCodeAt(h)));return y.join("")};if(f.open("GET",c,!u),f.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(f.onload=function(){f.status===200?d(p(this.responseText)):d(void 0)}),f.send(null),u&&f.status===200)return p(f.responseText)}(i,s,o)}catch{}return l}(t,r,n)},e.allowFsRead=void 0,e.loadImageFile=e.loadFile}(Un.API),function(e){function t(){return(Qn.html2canvas?Promise.resolve(Qn.html2canvas):fm(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(Qn.DOMPurify?Promise.resolve(Qn.DOMPurify):fm(()=>import("./purify.es-B9ZVCkUG.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=Hi(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},i=function(l,c){var u=document.createElement(l);for(var d in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[d]=c.style[d];return u},s=function l(c,u){for(var d=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),f=c.firstChild;f;f=f.nextSibling)u!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||d.appendChild(l(f,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(d.value=c.value),d.addEventListener("load",function(){d.scrollTop=c.scrollTop,d.scrollLeft=c.scrollLeft},!0)),d},o=function l(c){var u=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),d=l.convert(Promise.resolve(),u);return(d=d.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(u){switch(n(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(u){return this.set({src:i("div",{innerHTML:l,dompurify:u})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var u=this.opt.jsPDF,d=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,h=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete h.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=d,d)for(var p=0;p<d.length;++p){var m=d[p],g=m.src.find(function(y){return y.format==="truetype"});g&&u.addFont(g.url,m.ref.name,m.ref.style)}return h.windowHeight=h.windowHeight||0,h.windowHeight=h.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):h.windowHeight,u.context2d.save(!0),c(this.prop.container,h)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(u){if(u in o.template.prop)return function(){this.prop[u]=l[u]};switch(u){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[u]=l[u]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var u=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(u):u})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(u,d){return Math.floor(u*d/72*96)}return this.then(function(){(l=l||Un.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,u,d){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,u,d){return this.setProgress(l?this.progress.val+l:null,c||null,u?this.progress.n+u:null,d?this.progress.stack.concat(d):null)},o.prototype.then=function(l,c){var u=this;return this.thenCore(l,c,function(d,f){return u.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(h){return u.updateProgress(null,d),h}).then(d,f).then(function(h){return u.updateProgress(1),h})})},o.prototype.thenCore=function(l,c,u){u=u||Promise.prototype.then;var d=this;l&&(l=l.bind(d)),c&&(c=c.bind(d));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?d:o.convert(Object.assign({},d),Promise.prototype),h=u.call(f,l,c);return o.convert(h,d.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(u){c=c.thenCore(u)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,Un.getPageSize=function(l,c,u){if(Hi(l)==="object"){var d=l;l=d.orientation,c=d.unit||c,u=d.format||u}c=c||"mm",u=u||"a4",l=(""+(l||"P")).toLowerCase();var f,h=(""+u).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+c}var m,g=0,y=0;if(p.hasOwnProperty(h))g=p[h][1]/f,y=p[h][0]/f;else try{g=u[1],y=u[0]}catch{throw new Error("Invalid format: "+u)}if(l==="p"||l==="portrait")l="p",y>g&&(m=y,y=g,g=m);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",g>y&&(m=y,y=g,g=m)}return{width:y,height:g,unit:c,k:f,orientation:l}},e.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(Cj):null;var u=new o(c);return c.worker?u:u.from(l).doCallback()}}(Un.API),Un.API.addJS=function(e){var t,r,n=e;return this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(t+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),r=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+n+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){t!==void 0&&r!==void 0&&this.internal.out("/Names <</JavaScript "+t+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),s=0;s<i.length;s++){var o=i[s],l=n.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,d=[];for(s=0;s<u;s++){var f=r.internal.newObject();d.push(f);var h=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+h.objId+" 0 R /XYZ null null null]>> endobj")}var p=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<d.length;s++)r.internal.write("(page_"+(s+1)+")"+d[s]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+p+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,s){var o={title:i,options:s,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var o=n.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var s=0;s<i.children.length;s++)n.count++,this.count_r(n,i.children[s]);return n.count}}])}(Un.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,i,s,o,l){var c,u=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(f){for(var h,p=256*f.charCodeAt(4)+f.charCodeAt(5),m=f.length,g={width:0,height:0,numcomponents:1},y=4;y<m;y+=2){if(y+=p,t.indexOf(f.charCodeAt(y+1))!==-1){h=256*f.charCodeAt(y+5)+f.charCodeAt(y+6),g={width:256*f.charCodeAt(y+7)+f.charCodeAt(y+8),height:h,numcomponents:f.charCodeAt(y+9)};break}p=256*f.charCodeAt(y+2)+f.charCodeAt(y+3)}return g}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}d={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:n,alias:i}}return d}}(Un.API),Un.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var i,s=yge(e,{checkCrc:!0}),o=s.width,l=s.height,c=s.channels,u=s.palette,d=s.depth;i=u&&c===1?function(R){for(var M=R.width,B=R.height,E=R.data,P=R.palette,U=R.depth,G=!1,H=[],oe=[],de=void 0,W=!1,V=0,ae=0;ae<P.length;ae++){var ee=gO(P[ae],4),C=ee[0],Y=ee[1],q=ee[2],O=ee[3];H.push(C,Y,q),O!=null&&(O===0?(V++,oe.length<1&&oe.push(ae)):O<255&&(W=!0))}if(W||V>1){G=!0,oe=void 0;var X=M*B;de=new Uint8Array(X);for(var F=new DataView(E.buffer),Q=0;Q<X;Q++){var K=Tj(F,Q,U),ne=gO(P[K],4)[3];de[Q]=ne}}else V===0&&(oe=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:G?8:void 0,colorBytes:E,alphaBytes:de,needSMask:G,palette:H,mask:oe}}(s):c===2||c===4?function(R){for(var M=R.data,B=R.width,E=R.height,P=R.channels,U=R.depth,G=P===2?"DeviceGray":"DeviceRGB",H=P-1,oe=B*E,de=H,W=oe*de,V=1*oe,ae=Math.ceil(W*U/8),ee=Math.ceil(V*U/8),C=new Uint8Array(ae),Y=new Uint8Array(ee),q=new DataView(M.buffer),O=new DataView(C.buffer),X=new DataView(Y.buffer),F=!1,Q=0;Q<oe;Q++){for(var K=Q*P,ne=0;ne<de;ne++)bM(O,Tj(q,K+ne,U),Q*de+ne,U);var re=Tj(q,K+de,U);re<(1<<U)-1&&(F=!0),bM(X,re,1*Q,U)}return{colorSpace:G,colorsPerPixel:H,sMaskBitsPerComponent:F?U:void 0,colorBytes:C,alphaBytes:Y,needSMask:F}}(s):function(R){var M=R.data,B=R.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:B,colorsPerPixel:B==="DeviceGray"?1:3,colorBytes:M instanceof Uint16Array?function(E){for(var P=E.length,U=new Uint8Array(2*P),G=new DataView(U.buffer,U.byteOffset,U.byteLength),H=0;H<P;H++)G.setUint16(2*H,E[H],!1);return U}(M):M,needSMask:!1}}(s);var f,h,p,m=i,g=m.colorSpace,y=m.colorsPerPixel,b=m.sMaskBitsPerComponent,v=m.colorBytes,w=m.alphaBytes,S=m.needSMask,j=m.palette,k=m.mask,A=null;return n!==Un.API.image_compression.NONE&&typeof Z4=="function"?(A=function(R){var M;switch(R){case Un.API.image_compression.FAST:M=11;break;case Un.API.image_compression.MEDIUM:M=13;break;case Un.API.image_compression.SLOW:M=14;break;default:M=12}return M}(n),f=this.decode.FLATE_DECODE,h="/Predictor ".concat(A," /Colors ").concat(y," /BitsPerComponent ").concat(d," /Columns ").concat(o),e=pM(v,Math.ceil(o*y*d/8),y,d,n),S&&(p=pM(w,Math.ceil(o*b/8),1,b,n))):(f=void 0,h=void 0,e=v,S&&(p=w)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(p&&this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),{alias:r,data:e,index:t,filter:f,decodeParameters:h,transparency:k,palette:j,sMask:p,predictor:A,width:o,height:l,bitsPerComponent:d,sMaskBitsPerComponent:b,colorSpace:g}}},function(e){e.processGIF89A=function(t,r,n,i){var s=new Dge(t),o=s.width,l=s.height,c=[];s.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:o,height:l},d=new Pj(100).encode(u,100);return e.processJPEG.call(this,d,r,n,i)},e.processGIF87A=e.processGIF89A}(Un.API),ru.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:i,green:n,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},ru.prototype.parseBGR=function(){this.pos=this.offset;var e="bit"+this.bitPP,t=this.width*this.height*4;if(t>536870912)throw new Error("Image dimensions exceed 512MB, which is too large.");this.data=new Uint8Array(t);try{this[e]()}catch(r){na.log("bit decode error:"+r)}},ru.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,i=0;i<t;i++)for(var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*i*4,l=0;l<8&&8*i+l<this.width;l++){var c=this.palette[s>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},ru.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<e;i++){var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*i*4,l=s>>4,c=15&s,u=this.palette[l];if(this.data[o]=u.blue,this.data[o+1]=u.green,this.data[o+2]=u.red,this.data[o+3]=255,2*i+1>=this.width)break;u=this.palette[c],this.data[o+4]=u.blue,this.data[o+4+1]=u.green,this.data[o+4+2]=u.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},ru.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*n;if(i<this.palette.length){var o=this.palette[i];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}e!==0&&(this.pos+=4-e)}},ru.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,l=(s>>5&t)/t*255|0,c=(s>>10&t)/t*255|0,u=s>>15?255:0,d=n*this.width*4+4*i;this.data[d]=c,this.data[d+1]=l,this.data[d+2]=o,this.data[d+3]=u}this.pos+=e}},ru.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&t)/t*255|0,c=(o>>5&r)/r*255|0,u=(o>>11)/t*255|0,d=i*this.width*4+4*s;this.data[d]=u,this.data[d+1]=c,this.data[d+2]=l,this.data[d+3]=255}this.pos+=e}},ru.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=s,this.data[o+1]=i,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},ru.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=s,this.data[l+1]=i,this.data[l+2]=n,this.data[l+3]=o}},ru.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,i){var s=new ru(t,!1),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new Pj(100).encode(c,100);return e.processJPEG.call(this,u,r,n,i)}}(Un.API),wM.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,i){var s=new wM(t),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new Pj(100).encode(c,100);return e.processJPEG.call(this,u,r,n,i)}}(Un.API),Un.API.processRGBA=function(e,t,r){for(var n=e.data,i=n.length,s=new Uint8Array(i/4*3),o=new Uint8Array(i/4),l=0,c=0,u=0;u<i;u+=4){var d=n[u],f=n[u+1],h=n[u+2],p=n[u+3];s[l++]=d,s[l++]=f,s[l++]=h,o[c++]=p}var m=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:m,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Un.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},vp=Un.API,Db=vp.getCharWidthsArray=function(e,t){var r,n,i=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:i.metadata.Unicode.widths,c=l.fof?l.fof:1,u=t.kerning?t.kerning:i.metadata.Unicode.kerning,d=u.fof?u.fof:1,f=t.doKerning!==!1,h=0,p=e.length,m=0,g=l[0]||c,y=[];for(r=0;r<p;r++)n=e.charCodeAt(r),typeof i.metadata.widthOfString=="function"?y.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+o*(1e3/s)||0)/1e3):(h=f&&Hi(u[n])==="object"&&!isNaN(parseInt(u[n][m],10))?u[n][m]/d:0,y.push((l[n]||g)/c+h)),m=n;return y},dM=vp.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),i=t.charSpace||this.internal.getCharSpace();return vp.processArabic&&(e=vp.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,i)/r:Db.apply(this,arguments).reduce(function(s,o){return s+o},0)},fM=function(e,t,r,n){for(var i=[],s=0,o=e.length,l=0;s!==o&&l+t[s]<r;)l+=t[s],s++;i.push(e.slice(0,s));var c=s;for(l=0;s!==o;)l+t[s]>n&&(i.push(e.slice(c,s)),l=0,c=s),l+=t[s],s++;return c!==s&&i.push(e.slice(c,s)),i},hM=function(e,t,r){r||(r={});var n,i,s,o,l,c,u,d=[],f=[d],h=r.textIndent||0,p=0,m=0,g=e.split(" "),y=Db.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var b=Array(c).join(" "),v=[];g.map(function(S){(S=S.split(/\s*\n/)).length>1?v=v.concat(S.map(function(j,k){return(k&&j.length?`
`:"")+j})):v.push(S[0])}),g=v,c=dM.apply(this,[b,r])}for(s=0,o=g.length;s<o;s++){var w=0;if(n=g[s],c&&n[0]==`
`&&(n=n.substr(1),w=1),h+p+(m=(i=Db.apply(this,[n,r])).reduce(function(S,j){return S+j},0))>t||w){if(m>t){for(l=fM.apply(this,[n,i,t-(h+p),t]),d.push(l.shift()),d=[l.pop()];l.length;)f.push([l.shift()]);m=i.slice(n.length-(d[0]?d[0].length:0)).reduce(function(S,j){return S+j},0)}else d=[n];f.push(d),h=m+c,p=y}else d.push(n),h+=p+m,p=y}return u=c?function(S,j){return(j?b:"")+S.join(" ")}:function(S){return S.join(" ")},f.map(u)},vp.splitTextToSize=function(e,t,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var f=this.internal.getFont(d.fontName,d.fontStyle),h="Unicode";return f.metadata[h]?{widths:f.metadata[h].widths||{0:1},kerning:f.metadata[h].kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/i;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,s.lineIndent=r.lineIndent;var l,c,u=[];for(l=0,c=n.length;l<c;l++)u=u.concat(hM.apply(this,[n[l],o,s]));return u},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},i={},s=0;s<16;s++)n[r[s]]=t[s],i[t[s]]=r[s];var o=function(h){return"0x"+parseInt(h,10).toString(16)},l=e.__fontmetrics__.compress=function(h){var p,m,g,y,b=["{"];for(var v in h){if(p=h[v],isNaN(parseInt(v,10))?m="'"+v+"'":(v=parseInt(v,10),m=(m=o(v).slice(2)).slice(0,-1)+i[m.slice(-1)]),typeof p=="number")p<0?(g=o(p).slice(3),y="-"):(g=o(p).slice(2),y=""),g=y+g.slice(0,-1)+i[g.slice(-1)];else{if(Hi(p)!=="object")throw new Error("Don't know what to do with value type "+Hi(p)+".");g=l(p)}b.push(m+g)}return b.push("}"),b.join("")},c=e.__fontmetrics__.uncompress=function(h){if(typeof h!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,m,g,y,b={},v=1,w=b,S=[],j="",k="",A=h.length-1,R=1;R<A;R+=1)(y=h[R])=="'"?p?(g=p.join(""),p=void 0):p=[]:p?p.push(y):y=="{"?(S.push([w,g]),w={},g=void 0):y=="}"?((m=S.pop())[0][m[1]]=w,g=void 0,w=m[0]):y=="-"?v=-1:g===void 0?n.hasOwnProperty(y)?(j+=n[y],g=parseInt(j,16)*v,v=1,j=""):j+=y:n.hasOwnProperty(y)?(k+=n[y],w[g]=parseInt(k,16)*v,v=1,g=void 0,k=""):k+=y;return b},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},f={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(h){var p=h.font,m=f.Unicode[p.postScriptName];m&&(p.metadata.Unicode={},p.metadata.Unicode.widths=m.widths,p.metadata.Unicode.kerning=m.kerning);var g=d.Unicode[p.postScriptName];g&&(p.metadata.Unicode.encoding=g,p.encoding=g.codePages[0])}])}(Un.API),function(e){var t=function(r){for(var n=r.length,i=new Uint8Array(n),s=0;s<n;s++)i[s]=r.charCodeAt(s);return i};e.API.events.push(["addFont",function(r){var n=void 0,i=r.font,s=r.instance;if(!i.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=s.existsFileInVFS(i.postScriptName)===!1?s.loadFile(i.postScriptName):s.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?t(l):t(Wv(l)),o.metadata=e.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(i,n)}}])}(Un),Un.API.addSvgAsImage=function(e,t,r,n,i,s,o,l){if(isNaN(t)||isNaN(r))throw na.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(i))throw na.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=i;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var d={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return(Qn.canvg?Promise.resolve(Qn.canvg):fm(()=>import("./index.es-D7YiTXDR.js"),[])).catch(function(h){return Promise.reject(new Error("Could not load canvg: "+h))}).then(function(h){return h.default?h.default:h}).then(function(h){return h.fromString(u,e,d)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(h){return h.render(d)}).then(function(){f.addImage(c.toDataURL("image/jpeg",1),t,r,n,i,o,l)})},Un.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(t,r);return this},Un.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,i,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],u=0,d=0,f=0;function h(m,g){var y,b=!1;for(y=0;y<m.length;y+=1)m[y]===g&&(b=!0);return b}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var p=l.length;for(f=0;f<p;f+=1)r[l[f]].value=r[l[f]].defaultValue,r[l[f]].explicitSet=!1}if(Hi(e)==="object"){for(i in e)if(s=e[i],h(l,i)&&s!==void 0){if(r[i].type==="boolean"&&typeof s=="boolean")r[i].value=s;else if(r[i].type==="name"&&h(r[i].valueSet,s))r[i].value=s;else if(r[i].type==="integer"&&Number.isInteger(s))r[i].value=s;else if(r[i].type==="array"){for(u=0;u<s.length;u+=1)if(n=!0,s[u].length===1&&typeof s[u][0]=="number")c.push(String(s[u]-1));else if(s[u].length>1){for(d=0;d<s[u].length;d+=1)typeof s[u][d]!="number"&&(n=!1);n===!0&&c.push([s[u][0]-1,s[u][1]-1].join(" "))}r[i].value="["+c.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var m,g=[];for(m in r)r[m].explicitSet===!0&&(r[m].type==="name"?g.push("/"+m+" /"+r[m].value):g.push("/"+m+" "+r[m].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},Un.API.addMetadata=function(e,t){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:e,namespaceUri:t??"http://jspdf.default.namespaceuri/",rawXml:typeof t=="boolean"&&t},this.internal.events.subscribe("putCatalog",Uge),this.internal.events.subscribe("postPutResources",$ge)),this},function(e){var t=e.API,r=t.pdfEscape16=function(s,o){for(var l,c=o.metadata.Unicode.widths,u=["","0","00","000","0000"],d=[""],f=0,h=s.length;f<h;++f){if(l=o.metadata.characterToGlyph(s.charCodeAt(f)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=s.charCodeAt(f),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return d.join("");l=l.toString(16),d.push(u[4-l.length],l)}return d.join("")},n=function(s){var o,l,c,u,d,f,h;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],f=0,h=(l=Object.keys(s).sort(function(p,m){return p-m})).length;f<h;f++)o=l[f],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(u=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+u+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="Identity-H"){for(var f=l.metadata.Unicode.widths,h=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),p="",m=0;m<h.length;m++)p+=String.fromCharCode(h[m]);var g=u();d({data:p,addLength1:!0,objectId:g}),c("endobj");var y=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:y}),c("endobj");var b=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Ip(l.fontName)),c("/FontFile2 "+g+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var v=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+Ip(l.fontName)),c("/FontDescriptor "+b+" 0 R"),c("/W "+e.API.PDFObject.convert(f)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+y+" 0 R"),c("/BaseFont /"+Ip(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+v+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]),t.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var f=l.metadata.rawData,h="",p=0;p<f.length;p++)h+=String.fromCharCode(f[p]);var m=u();d({data:h,addLength1:!0,objectId:m}),c("endobj");var g=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:g}),c("endobj");var y=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+m+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Ip(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var b=0;b<l.metadata.hmtx.widths.length;b++)l.metadata.hmtx.widths[b]=parseInt(l.metadata.hmtx.widths[b]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+Ip(l.fontName)+"/FontDescriptor "+y+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]);var i=function(s){var o,l=s.text||"",c=s.x,u=s.y,d=s.options||{},f=s.mutex||{},h=f.pdfEscape,p=f.activeFontKey,m=f.fonts,g=p,y="",b=0,v="",w=m[g].encoding;if(m[g].encoding!=="Identity-H")return{text:l,x:c,y:u,options:d,mutex:f};for(v=l,g=p,Array.isArray(l)&&(v=l[0]),b=0;b<v.length;b+=1)m[g].metadata.hasOwnProperty("cmap")&&(o=m[g].metadata.cmap.unicode.codeMap[v[b].charCodeAt(0)]),o||v[b].charCodeAt(0)<256&&m[g].metadata.hasOwnProperty("Unicode")?y+=v[b]:y+="";var S="";return parseInt(g.slice(1))<14||w==="WinAnsiEncoding"?S=h(y,g).split("").map(function(j){return j.charCodeAt(0).toString(16)}).join(""):w==="Identity-H"&&(S=r(y,m[g])),f.isHex=!0,{text:S,x:c,y:u,options:d,mutex:f}};t.events.push(["postProcessText",function(s){var o=s.text||"",l=[],c={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var u=0;for(u=0;u<o.length;u+=1)Array.isArray(o[u])&&o[u].length===3?l.push([i(Object.assign({},c,{text:o[u][0]})).text,o[u][1],o[u][2]]):l.push(i(Object.assign({},c,{text:o[u]})).text);s.text=l}else s.text=i(Object.assign({},c,{text:o})).text}])}(Un),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(Un.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var i,s,o,l,c,u,d,f=t,h=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],p=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],m={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},y=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],b=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),v=!1,w=0;this.__bidiEngine__={};var S=function(E){var P=E.charCodeAt(),U=P>>8,G=g[U];return G!==void 0?f[256*G+(255&P)]:U===252||U===253?"AL":b.test(U)?"L":U===8?"R":"N"},j=function(E){for(var P,U=0;U<E.length;U++){if((P=S(E.charAt(U)))==="L")return!1;if(P==="R")return!0}return!1},k=function(E,P,U,G){var H,oe,de,W,V=P[G];switch(V){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":v=!1;break;case"N":case"AN":break;case"EN":v&&(V="AN");break;case"AL":v=!0,V="R";break;case"WS":case"BN":V="N";break;case"CS":G<1||G+1>=P.length||(H=U[G-1])!=="EN"&&H!=="AN"||(oe=P[G+1])!=="EN"&&oe!=="AN"?V="N":v&&(oe="AN"),V=oe===H?oe:"N";break;case"ES":V=(H=G>0?U[G-1]:"B")==="EN"&&G+1<P.length&&P[G+1]==="EN"?"EN":"N";break;case"ET":if(G>0&&U[G-1]==="EN"){V="EN";break}if(v){V="N";break}for(de=G+1,W=P.length;de<W&&P[de]==="ET";)de++;V=de<W&&P[de]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(W=P.length,de=G+1;de<W&&P[de]==="NSM";)de++;if(de<W){var ae=E[G],ee=ae>=1425&&ae<=2303||ae===64286;if(H=P[de],ee&&(H==="R"||H==="AL")){V="R";break}}}V=G<1||(H=P[G-1])==="B"?"N":U[G-1];break;case"B":v=!1,i=!0,V=w;break;case"S":s=!0,V="N"}return V},A=function(E,P,U){var G=E.split("");return U&&R(G,U,{hiLevel:w}),G.reverse(),P&&P.reverse(),G.join("")},R=function(E,P,U){var G,H,oe,de,W,V=-1,ae=E.length,ee=0,C=[],Y=w?p:h,q=[];for(v=!1,i=!1,s=!1,H=0;H<ae;H++)q[H]=S(E[H]);for(oe=0;oe<ae;oe++){if(W=ee,C[oe]=k(E,q,C,oe),G=240&(ee=Y[W][m[C[oe]]]),ee&=15,P[oe]=de=Y[ee][5],G>0)if(G===16){for(H=V;H<oe;H++)P[H]=1;V=-1}else V=-1;if(Y[ee][6])V===-1&&(V=oe);else if(V>-1){for(H=V;H<oe;H++)P[H]=de;V=-1}q[oe]==="B"&&(P[oe]=0),U.hiLevel|=de}s&&function(O,X,F){for(var Q=0;Q<F;Q++)if(O[Q]==="S"){X[Q]=w;for(var K=Q-1;K>=0&&O[K]==="WS";K--)X[K]=w}}(q,P,ae)},M=function(E,P,U,G,H){if(!(H.hiLevel<E)){if(E===1&&w===1&&!i)return P.reverse(),void(U&&U.reverse());for(var oe,de,W,V,ae=P.length,ee=0;ee<ae;){if(G[ee]>=E){for(W=ee+1;W<ae&&G[W]>=E;)W++;for(V=ee,de=W-1;V<de;V++,de--)oe=P[V],P[V]=P[de],P[de]=oe,U&&(oe=U[V],U[V]=U[de],U[de]=oe);ee=W}ee++}}},B=function(E,P,U){var G=E.split(""),H={hiLevel:w};return U||(U=[]),R(G,U,H),function(oe,de,W){if(W.hiLevel!==0&&d)for(var V,ae=0;ae<oe.length;ae++)de[ae]===1&&(V=y.indexOf(oe[ae]))>=0&&(oe[ae]=y[V+1])}(G,U,H),M(2,G,P,U,H),M(1,G,P,U,H),G.join("")};return this.__bidiEngine__.doBidiReorder=function(E,P,U){if(function(H,oe){if(oe)for(var de=0;de<H.length;de++)oe[de]=de;l===void 0&&(l=j(H)),u===void 0&&(u=j(H))}(E,P),o||!c||u)if(o&&c&&l^u)w=l?1:0,E=A(E,P,U);else if(!o&&c&&u)w=l?1:0,E=B(E,P,U),E=A(E,P);else if(!o||l||c||u){if(o&&!c&&l^u)E=A(E,P),l?(w=0,E=B(E,P,U)):(w=1,E=B(E,P,U),E=A(E,P));else if(o&&l&&!c&&u)w=1,E=B(E,P,U),E=A(E,P);else if(!o&&!c&&l^u){var G=d;l?(w=1,E=B(E,P,U),w=0,d=!1,E=B(E,P,U),d=G):(w=0,E=B(E,P,U),E=A(E,P),w=1,d=!1,E=B(E,P,U),d=G,E=A(E,P))}}else w=0,E=B(E,P,U);else w=l?1:0,E=B(E,P,U);return E},this.__bidiEngine__.setOptions=function(E){E&&(o=E.isInputVisual,c=E.isOutputVisual,l=E.isInputRtl,u=E.isOutputRtl,d=E.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var i=n.text;n.x,n.y;var s=n.options||{};n.mutex,s.lang;var o=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(i)==="[object Array]"){var l=0;for(o=[],l=0;l<i.length;l+=1)Object.prototype.toString.call(i[l])==="[object Array]"?o.push([r.doBidiReorder(i[l][0]),i[l][1],i[l][2]]):o.push([r.doBidiReorder(i[l])]);n.text=o}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])}(Un),Un.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new xh(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new rxe(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new zge(this.contents),this.head=new qge(this),this.name=new Yge(this),this.cmap=new zz(this),this.toUnicode={},this.hhea=new Hge(this),this.maxp=new Xge(this),this.hmtx=new Qge(this),this.post=new Gge(this),this.os2=new Vge(this),this.loca=new txe(this),this.glyf=new Jge(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,i,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,u;for(u=[],o=0,l=(c=this.bbox).length;o<l;o++)t=c[o],u.push(Math.round(t*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),32768&(r=i>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var i,s,o,l;for(o=0,s=0,l=(t=""+t).length;0<=l?s<l:s>l;s=0<=l?++s:--s)i=t.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return o*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var ju,xh=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,i;for(i=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(t.charCodeAt(r)));return i},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,i,s,o,l,c;return t=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^s)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*i+16777216*s+65536*o+256*l+c},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,i,s;for(s=[],n=0,i=t.length;n<i;n++)r=t[n],s.push(this.writeByte(r));return s},e}(),zge=function(){var e;function t(r){var n,i,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,s=this.tableCount;0<=s?i<s:i>s;i=0<=s?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,i,s,o,l,c,u,d,f,h,p,m,g;for(g in p=Object.keys(r).length,c=Math.log(2),f=16*Math.floor(Math.log(p)/c),o=Math.floor(f/c),d=16*p-f,(i=new xh).writeInt(this.scalarType),i.writeShort(p),i.writeShort(f),i.writeShort(o),i.writeShort(d),s=16*p,u=i.pos+s,l=null,m=[],r)for(h=r[g],i.writeString(g),i.writeInt(e(h)),i.writeInt(u),i.writeInt(h.length),m=m.concat(h),g==="head"&&(l=u),u+=h.length;u%4;)m.push(0),u++;return i.write(m),n=2981146554-e(i.data),i.pos=l+8,i.writeUInt32(n),i.data},e=function(r){var n,i,s,o;for(r=Wz.call(r);r.length%4;)r.push(0);for(s=new xh(r),i=0,n=0,o=r.length;n<o;n=n+=4)i+=s.readUInt32();return 4294967295&i},t}(),Wge={}.hasOwnProperty,ud=function(e,t){for(var r in t)Wge.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};ju=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var qge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ud(e,ju),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new xh).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),SM=function(){function e(t,r){var n,i,s,o,l,c,u,d,f,h,p,m,g,y,b,v,w;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),f=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(p=t.readUInt16(),h=p/2,t.pos+=6,s=function(){var S,j;for(j=[],c=S=0;0<=h?S<h:S>h;c=0<=h?++S:--S)j.push(t.readUInt16());return j}(),t.pos+=2,g=function(){var S,j;for(j=[],c=S=0;0<=h?S<h:S>h;c=0<=h?++S:--S)j.push(t.readUInt16());return j}(),u=function(){var S,j;for(j=[],c=S=0;0<=h?S<h:S>h;c=0<=h?++S:--S)j.push(t.readUInt16());return j}(),d=function(){var S,j;for(j=[],c=S=0;0<=h?S<h:S>h;c=0<=h?++S:--S)j.push(t.readUInt16());return j}(),i=(this.length-t.pos+this.offset)/2,l=function(){var S,j;for(j=[],c=S=0;0<=i?S<i:S>i;c=0<=i?++S:--S)j.push(t.readUInt16());return j}(),c=b=0,w=s.length;b<w;c=++b)for(y=s[c],n=v=m=g[c];m<=y?v<=y:v>=y;n=m<=y?++v:--v)d[c]===0?o=n+u[c]:(o=l[d[c]/2+(n-m)-(h-c)]||0)!==0&&(o+=u[c]),this.codeMap[n]=65535&o}t.pos=f}return e.encode=function(t,r){var n,i,s,o,l,c,u,d,f,h,p,m,g,y,b,v,w,S,j,k,A,R,M,B,E,P,U,G,H,oe,de,W,V,ae,ee,C,Y,q,O,X,F,Q,K,ne,re,T;switch(G=new xh,o=Object.keys(t).sort(function(I,ie){return I-ie}),r){case"macroman":for(g=0,y=function(){var I=[];for(m=0;m<256;++m)I.push(0);return I}(),v={0:0},s={},H=0,V=o.length;H<V;H++)v[K=t[i=o[H]]]==null&&(v[K]=++g),s[i]={old:t[i],new:v[t[i]]},y[i]=v[t[i]];return G.writeUInt16(1),G.writeUInt16(0),G.writeUInt32(12),G.writeUInt16(0),G.writeUInt16(262),G.writeUInt16(0),G.write(y),{charMap:s,subtable:G.data,maxGlyphID:g+1};case"unicode":for(P=[],f=[],w=0,v={},n={},b=u=null,oe=0,ae=o.length;oe<ae;oe++)v[j=t[i=o[oe]]]==null&&(v[j]=++w),n[i]={old:j,new:v[j]},l=v[j]-i,b!=null&&l===u||(b&&f.push(b),P.push(i),u=l),b=i;for(b&&f.push(b),f.push(65535),P.push(65535),B=2*(M=P.length),R=2*Math.pow(Math.log(M)/Math.LN2,2),h=Math.log(R/2)/Math.LN2,A=2*M-R,c=[],k=[],p=[],m=de=0,ee=P.length;de<ee;m=++de){if(E=P[m],d=f[m],E===65535){c.push(0),k.push(0);break}if(E-(U=n[E].new)>=32768)for(c.push(0),k.push(2*(p.length+M-m)),i=W=E;E<=d?W<=d:W>=d;i=E<=d?++W:--W)p.push(n[i].new);else c.push(U-E),k.push(0)}for(G.writeUInt16(3),G.writeUInt16(1),G.writeUInt32(12),G.writeUInt16(4),G.writeUInt16(16+8*M+2*p.length),G.writeUInt16(0),G.writeUInt16(B),G.writeUInt16(R),G.writeUInt16(h),G.writeUInt16(A),F=0,C=f.length;F<C;F++)i=f[F],G.writeUInt16(i);for(G.writeUInt16(0),Q=0,Y=P.length;Q<Y;Q++)i=P[Q],G.writeUInt16(i);for(ne=0,q=c.length;ne<q;ne++)l=c[ne],G.writeUInt16(l);for(re=0,O=k.length;re<O;re++)S=k[re],G.writeUInt16(S);for(T=0,X=p.length;T<X;T++)g=p[T],G.writeUInt16(g);return{charMap:n,subtable:G.data,maxGlyphID:w+1}}},e}(),zz=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ud(e,ju),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,i;for(t.pos=this.offset,this.version=t.readUInt16(),i=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=i?n<i:n>i;n=0<=i?++n:--n)r=new SM(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,i;return r==null&&(r="macroman"),n=SM.encode(t,r),(i=new xh).writeUInt16(0),i.writeUInt16(1),n.table=i.data.concat(n.subtable),n},e}(),Hge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ud(e,ju),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),Vge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ud(e,ju),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),Gge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ud(e,ju),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,i;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(n=t.readUInt16(),this.glyphNameIndex=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],i=[];t.pos<this.offset+this.length;)r=t.readByte(),i.push(this.names.push(t.readString(r)));return i;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=(function(){var o,l,c;for(c=[],s=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;s=0<=l?++o:--o)c.push(t.readUInt32());return c}).call(this)}},e}(),Kge=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},Yge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ud(e,ju),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,i,s,o,l,c,u,d,f,h;for(t.pos=this.offset,t.readShort(),r=t.readShort(),l=t.readShort(),n=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+l+t.readShort()});for(c={},s=d=0,f=n.length;d<f;s=++d)i=n[s],t.pos=i.offset,u=t.readString(i.length),o=new Kge(u,i),c[h=i.nameID]==null&&(c[h]=[]),c[i.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e}(),Xge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ud(e,ju),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),Qge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ud(e,ju),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,i,s,o,l,c;for(t.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,d;for(d=[],r=u=0;0<=i?u<i:u>i;r=0<=i?++u:--u)d.push(t.readInt16());return d}(),this.widths=(function(){var u,d,f,h;for(h=[],u=0,d=(f=this.metrics).length;u<d;u++)s=f[u],h.push(s.advance);return h}).call(this),n=this.widths[this.widths.length-1],c=[],r=o=0;0<=i?o<i:o>i;r=0<=i?++o:--o)c.push(this.widths.push(n));return c},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),Wz=[].slice,Jge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ud(e,ju),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,i,s,o,l,c,u,d,f;return t in this.cache?this.cache[t]:(s=this.file.loca,r=this.file.contents,n=s.indexOf(t),(i=s.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,o=(l=new xh(r.read(i))).readShort(),u=l.readShort(),f=l.readShort(),c=l.readShort(),d=l.readShort(),this.cache[t]=o===-1?new exe(l,u,f,c,d):new Zge(l,o,u,f,c,d),this.cache[t]))},e.prototype.encode=function(t,r,n){var i,s,o,l,c;for(o=[],s=[],l=0,c=r.length;l<c;l++)i=t[r[l]],s.push(o.length),i&&(o=o.concat(i.encode(n)));return s.push(o.length),{table:o,offsets:s}},e}(),Zge=function(){function e(t,r,n,i,s,o){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=s,this.yMax=o,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),exe=function(){function e(t,r,n,i,s){var o,l;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new xh(Wz.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),txe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ud(e,ju),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var i,s;for(s=[],n=0,i=this.length;n<i;n+=2)s.push(2*t.readUInt16());return s}).call(this):(function(){var i,s;for(s=[],n=0,i=this.length;n<i;n+=4)s.push(t.readUInt32());return s}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),i=0,s=0,o=0;o<n.length;++o)if(n[o]=i,s<r.length&&r[s]==o){++s,n[o]=i;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(i+=c)}for(var u=new Array(4*n.length),d=0;d<n.length;++d)u[4*d+3]=255&n[d],u[4*d+2]=(65280&n[d])>>8,u[4*d+1]=(16711680&n[d])>>16,u[4*d]=(4278190080&n[d])>>24;return u},e}(),rxe=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,i,s;for(r in i=this.font.cmap.tables[0].codeMap,t={},s=this.subset)n=s[r],t[r]=i[n];return t},e.prototype.glyphsFor=function(t){var r,n,i,s,o,l,c;for(i={},o=0,l=t.length;o<l;o++)i[s=t[o]]=this.font.glyf.glyphFor(s);for(s in r=[],i)(n=i[s])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(s in c=this.glyphsFor(r))n=c[s],i[s]=n;return i},e.prototype.encode=function(t,r){var n,i,s,o,l,c,u,d,f,h,p,m,g,y,b;for(i in n=zz.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),p={0:0},b=n.charMap)p[(c=b[i]).old]=c.new;for(m in h=n.maxGlyphID,o)m in p||(p[m]=h++);return d=function(v){var w,S;for(w in S={},v)S[v[w]]=w;return S}(p),f=Object.keys(d).sort(function(v,w){return v-w}),g=function(){var v,w,S;for(S=[],v=0,w=f.length;v<w;v++)l=f[v],S.push(d[l]);return S}(),s=this.font.glyf.encode(o,g,p),u=this.font.loca.encode(s.offsets,g),y={cmap:this.font.cmap.raw(),glyf:s.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(y["OS/2"]=this.font.os2.raw()),this.font.directory.encode(y)},e}();Un.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,i,s,o;if(Array.isArray(r))return"["+function(){var l,c,u;for(u=[],l=0,c=r.length;l<c;l++)n=r[l],u.push(t.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in s=["<<"],r)o=r[i],s.push("/"+i+" "+t.convert(o));return s.push(">>"),s.join(`
`)}return""+r},t}();const nxe="/assets/logo-BRcnjZP7.jpg",ixe="K RAMAKRISHNAN COLLEGE OF TECHNOLOGY, Autonomous";function qz(e){return String(e||"").trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_-]/g,"").slice(0,64)}function $b(e,t,r){const n=String(t??"");if(!n)return"";if(e.getTextWidth(n)<=r)return n;const i="",s=e.getTextWidth(i);if(s>=r)return"";let o=0,l=n.length;for(;o<l;){const c=Math.ceil((o+l)/2),u=n.slice(0,c);e.getTextWidth(u)+s<=r?o=c:l=c-1}return n.slice(0,Math.max(0,o))+i}function _M(e,t){const r=URL.createObjectURL(t),n=document.createElement("a");n.href=r,n.download=e,n.click(),setTimeout(()=>URL.revokeObjectURL(r),500)}async function axe(){var e;try{const t=await mr("/api/accounts/me/",{method:"GET"});if(!t.ok)return"";const r=await t.json(),n=String((r==null?void 0:r.username)||"").trim(),i=String(((e=r==null?void 0:r.profile)==null?void 0:e.staff_id)||"").trim();return n||i||""}catch{return""}}function Hz(e){const t=String(e.collegeName||ixe).trim(),r=String(e.courseName||"").trim(),n=String(e.courseCode||"").trim(),i=String(e.staffName||"").trim(),s=String(e.className||"").trim();return[t,`Course Name: ${r||"-"}`,`Course Code: ${n||"-"}`,`Staff Name: ${i||"-"}`,`Class Name: ${s||"-"}`]}function sxe(e,t){const r=Hz(e),n=["S.No","Reg No","Name","Total"],i=t.map(s=>[s.sno,s.regNo,s.name,s.total]);return[...r.map(s=>[s,"","",""]),[""],[n[0],n[1],n[2],n[3]],...i]}function oxe(e,t,r){const i=bs.book_new(),s=[];for(let l=0;l<r.length;l+=45)s.push(r.slice(l,l+45));s.length===0&&s.push([]),s.forEach((l,c)=>{const u=bs.aoa_to_sheet(sxe(t,l));u["!freeze"]={xSplit:0,ySplit:7},u["!cols"]=[{wch:6},{wch:16},{wch:34},{wch:12}],bs.book_append_sheet(i,u,s.length>1?`Page_${c+1}`:"Sheet1")});const o=`${qz(e)||"marks"}_totals.xlsx`;uy(i,o)}function lxe(e,t){if(e.availableH=Math.max(60,e.bottomY-e.tableTopY),t.length<=1){e.colsNeeded=1,e.rowsPerCol=Math.max(1,t.length),e.colW=e.availableW;return}e.colsNeeded=2,e.colW=(e.availableW-e.colGap)/2;const r=Math.max(1,Math.ceil(t.length/2)),n=()=>e.headerRowH+r*e.rowH<=e.availableH;let i=0;for(;i++<30&&!n()&&e.rowH>6;)e.tableFont=Math.max(5,e.tableFont-.25),e.rowH=Math.max(6,e.rowH-1),e.headerRowH=Math.max(9,e.headerRowH-1);e.rowsPerCol=r}function jM(e,t,r){const n=new Un({orientation:e,unit:"pt",format:"a4"}),i=n.internal.pageSize.getWidth(),s=n.internal.pageSize.getHeight(),o=32,l=34,c=s-28,u=i-o*2,d=12,f=l,h=Math.max(60,c-f);let p=8,m=12,g=14;const y=10,b=()=>{const A=Math.max(1,Math.floor((h-g)/m)),R=Math.max(1,Math.ceil(r.length/A)),M=(u-y*(R-1))/R;return{rowsPerCol:A,colsNeeded:R,colW:M}};let{rowsPerCol:v,colsNeeded:w,colW:S}=b();const j=150;let k=0;for(;k++<12&&S<j&&w>1;)p=Math.max(6,p-.5),m=Math.max(9,m-1),g=Math.max(11,g-1),{rowsPerCol:v,colsNeeded:w,colW:S}=b();return{doc:n,marginX:o,topY:l,bottomY:c,tableTopY:f,availableW:u,availableH:h,tableFont:p,headerFont:d,rowH:m,headerRowH:g,colGap:y,colsNeeded:w,rowsPerCol:v,colW:S}}function cxe(e,t,r,n){const i=t.tableTopY,s={sno:.12,reg:.3,name:.43,total:.15},o=t.colW*s.sno,l=t.colW*s.reg,c=t.colW*s.name,u=t.colW*s.total,d=3;e.setFontSize(t.tableFont);const f=[17,24,39],h=[255,255,255],p=[180,180,180];for(let m=0;m<t.colsNeeded;m++){const g=t.marginX+m*(t.colW+t.colGap);let y=i;e.setFillColor(f[0],f[1],f[2]),e.rect(g,y,t.colW,t.headerRowH,"F"),e.setTextColor(h[0],h[1],h[2]);const b=y+t.headerRowH-4;e.text("S.No",g+d,b),e.text("Reg No",g+o+d,b),e.text("Name",g+o+l+d,b),e.text("Total",g+o+l+c+d,b),e.setDrawColor(p[0],p[1],p[2]),e.rect(g,y,t.colW,t.headerRowH),e.line(g+o,y,g+o,y+t.headerRowH),e.line(g+o+l,y,g+o+l,y+t.headerRowH),e.line(g+o+l+c,y,g+o+l+c,y+t.headerRowH),y+=t.headerRowH,e.setTextColor(0,0,0);const v=m*t.rowsPerCol,w=Math.min(n.length,v+t.rowsPerCol);for(let S=v;S<w;S++){const j=n[S],k=y+(S-v)*t.rowH;e.rect(g,k,t.colW,t.rowH),e.line(g+o,k,g+o,k+t.rowH),e.line(g+o+l,k,g+o+l,k+t.rowH),e.line(g+o+l+c,k,g+o+l+c,k+t.rowH);const A=k+t.rowH-3,R=$b(e,String((j==null?void 0:j.sno)??""),Math.max(0,o-d*2)),M=$b(e,String((j==null?void 0:j.regNo)??""),Math.max(0,l-d*2)),B=$b(e,String((j==null?void 0:j.name)??""),Math.max(0,c-d*2)),E=$b(e,String((j==null?void 0:j.total)??""),Math.max(0,u-d*2));e.text(R,g+d,A),e.text(M,g+o+d,A),e.text(B,g+o+l+d,A),e.text(E,g+o+l+c+d,A)}}}async function uxe(e){try{const t=await fetch(e,{cache:"no-cache"});if(!t.ok)return null;const r=await t.blob();return await new Promise(n=>{const i=new FileReader;i.onload=()=>n(String(i.result||"")),i.onerror=()=>n(null),i.readAsDataURL(r)})}catch{return null}}async function dxe(e,t,r,n){const i=String((r==null?void 0:r.bannerUrl)||nxe),s=(r==null?void 0:r.bannerUrl)||i,o=await uxe(s),l=n.length>=55;let c=0;if(o)try{const h=new Image;h.src=o,await new Promise(A=>{h.onload=()=>A(!0),h.onerror=()=>A(!0)});const p=h.naturalWidth||h.width||1,m=h.naturalHeight||h.height||1,g=t.doc.internal.pageSize.getWidth(),y=l?135:170,b=g-2*t.marginX,v=p/m;let w=b,S=w/v;S>y&&(S=y,w=S*v);const j=(g-w)/2,k=12;t.doc.addImage(o,"PNG",j,k,w,S),c=S,t.tableTopY=k+S+(l?10:14)}catch{}else t.tableTopY=t.topY;const u=t.tableTopY;e.setFontSize(l?8:9),e.setTextColor(0,0,0);const d=[];r.courseName&&d.push(`Course Name: ${r.courseName}`),r.courseCode&&d.push(`Course Code: ${r.courseCode}`),r.staffName&&d.push(`Staff Name: ${r.staffName}`),r.className&&d.push(`Class Name: ${r.className}`);const f=l?10:11;for(let h=0;h<d.length;h++)e.text(d[h],t.marginX,u+h*f);return t.tableTopY=u+d.length*f+(l?6:10),lxe(t,n),cxe(e,t,r,n)}async function Oj(e,t,r){const n=jM("portrait",t,r),s=n.colsNeeded>=4?jM("landscape",t,r):n;await dxe(s.doc,s,t,r);const o=s.doc.output("blob"),l=`${qz(e)||"marks"}_totals.pdf`;return{blob:o,filename:l}}function fxe(e,t,r){e.innerHTML="";const n=Hz(t),i=document.createElement("div");i.style.display="flex",i.style.flexDirection="column",i.style.gap="2px",i.style.marginBottom="10px",n.forEach(d=>{const f=document.createElement("div");f.textContent=d,f.style.fontWeight=d===n[0]?"900":"700",f.style.fontSize=d===n[0]?"14px":"12px",i.appendChild(f)}),e.appendChild(i);const s=document.createElement("div");s.className="obe-table-wrapper",s.style.maxHeight="420px",s.style.overflow="auto";const o=document.createElement("table");o.className="obe-table",o.style.minWidth="unset";const l=document.createElement("thead"),c=document.createElement("tr");["S.No","Reg No","Name","Total"].forEach(d=>{const f=document.createElement("th");f.textContent=d,c.appendChild(f)}),l.appendChild(c),o.appendChild(l);const u=document.createElement("tbody");r.forEach(d=>{const f=document.createElement("tr");[d.sno,d.regNo,d.name,d.total].forEach(h=>{const p=document.createElement("td");p.textContent=String(h??""),f.appendChild(p)}),u.appendChild(f)}),o.appendChild(u),s.appendChild(o),e.appendChild(s)}function hxe(e,t){e.innerHTML="";const r=URL.createObjectURL(t),n=document.createElement("iframe");return n.src=r,n.style.width="100%",n.style.height="520px",n.style.border="1px solid rgba(226,232,240,0.9)",n.style.borderRadius="10px",e.appendChild(n),()=>URL.revokeObjectURL(r)}async function pxe(e){if(typeof document>"u"||typeof window>"u"){const{blob:S,filename:j}=await Oj(e.filenameBase,e.meta,e.rows);_M(j,S);return}const t=document.createElement("div");t.setAttribute("role","dialog"),t.setAttribute("aria-modal","true"),t.style.position="fixed",t.style.inset="0",t.style.background="rgba(0,0,0,0.35)",t.style.display="grid",t.style.placeItems="center",t.style.padding="16px",t.style.zIndex="9999";const r=document.createElement("div");r.className="obe-card",r.style.width="min(980px, 100%)",r.style.maxHeight="min(92vh, 900px)",r.style.overflow="auto";const n=document.createElement("div");n.textContent="Preview totals before download",n.style.fontWeight="950",n.style.fontSize="14px",n.style.marginBottom="10px";const i=document.createElement("div");i.style.display="flex",i.style.gap="8px",i.style.flexWrap="wrap",i.style.alignItems="center",i.style.justifyContent="space-between",i.style.marginBottom="10px";const s=document.createElement("div");s.style.display="flex",s.style.gap="8px",s.style.flexWrap="wrap";const o=document.createElement("button");o.className="obe-btn obe-btn-secondary",o.textContent="Excel preview";const l=document.createElement("button");l.className="obe-btn obe-btn-primary",l.textContent="PDF preview",s.appendChild(o),s.appendChild(l);const c=document.createElement("div");c.style.display="flex",c.style.gap="8px",c.style.flexWrap="wrap";const u=document.createElement("button");u.className="obe-btn",u.textContent="Close";const d=document.createElement("button");d.className="obe-btn obe-btn-success",d.textContent="Download",c.appendChild(u),c.appendChild(d),i.appendChild(s),i.appendChild(c);const f=document.createElement("div");r.appendChild(n),r.appendChild(i),r.appendChild(f),t.appendChild(r);let h="pdf",p=null,m=null;const g=()=>{o.className=h==="excel"?"obe-btn obe-btn-primary":"obe-btn obe-btn-secondary",l.className=h==="pdf"?"obe-btn obe-btn-primary":"obe-btn obe-btn-secondary"},y=async()=>{if(p&&(p(),p=null),f.innerHTML="",g(),h==="excel"){m=null,fxe(f,e.meta,e.rows);return}m=await Oj(e.filenameBase,e.meta,e.rows),p=hxe(f,m.blob)};let b=!1;const v=()=>{if(!b){b=!0,p&&p();try{window.removeEventListener("keydown",w),t.remove()}catch{}}},w=S=>{S.key==="Escape"&&v()};t.addEventListener("click",S=>{S.target===t&&v()}),u.addEventListener("click",v),o.addEventListener("click",()=>{h="excel",y()}),l.addEventListener("click",()=>{h="pdf",y()}),d.addEventListener("click",async()=>{if(h==="excel"){oxe(e.filenameBase,e.meta,e.rows);return}const S=m||await Oj(e.filenameBase,e.meta,e.rows);_M(S.filename,S.blob)}),window.addEventListener("keydown",w),document.body.appendChild(t),y()}async function fy(e){const t={...e.meta};t.staffName||(t.staffName=await axe());const r=(e.rows||[]).filter(n=>n&&n.regNo);await pxe({filenameBase:e.filenameBase,meta:t,rows:r})}const Mj={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},kM=[{key:"q1",label:"Q1",max:2,co:1,btl:1},{key:"q2",label:"Q2",max:2,co:1,btl:3},{key:"q3",label:"Q3",max:2,co:1,btl:4},{key:"q4",label:"Q4",max:2,co:2,btl:1},{key:"q5",label:"Q5",max:2,co:2,btl:1},{key:"q6",label:"Q6",max:2,co:2,btl:2},{key:"q7",label:"Q7",max:16,co:1,btl:2},{key:"q8",label:"Q8",max:16,co:2,btl:3},{key:"q9",label:"Q9",max:16,co:"1&2",btl:5}];function AM(e){if(e==="both")return"both";if(e==="1&2"||e==="3&4")return e;if(typeof e=="string"){const r=e.trim();if(r==="1&2"||r==="1,2"||r==="1/2"||r==="2/1")return"1&2";if(r==="3&4"||r==="3,4"||r==="3/4"||r==="4/3")return"3&4";if(r==="5")return 5;if(r==="4")return 4;if(r==="3")return 3;if(r==="2")return 2;if(r==="1")return 1}if(Array.isArray(e)){const r=e.map(n=>Number(n)).filter(n=>Number.isFinite(n));if(r.includes(3)&&r.includes(4))return"3&4";if(r.includes(1)&&r.includes(2))return"1&2";if(r.includes(4))return 4;if(r.includes(3))return 3;if(r.includes(2))return 2;if(r.includes(1))return 1}const t=Number(e);return t===5?5:t===4?4:t===3?3:t===2?2:t===34?"3&4":t===12?"1&2":1}function mxe(e){return e==="cia2"?{a:3,b:4}:{a:1,b:2}}function oA(e){return e==="both"||e==="1&2"||e==="3&4"}function gxe(e,t){if(oA(e))return{a:.5,b:.5};const r=t.a===3,n=e===t.a||r&&e===1,i=e===t.b||r&&e===2;return n?{a:1,b:0}:i?{a:0,b:1}:{a:0,b:0}}function Ub(e,t,r){const n=e[t];if(!n)return{a:0,b:0};if(oA(n.co))return{a:.5,b:.5};const i=e.some(l=>oA(l.co)),s=t===e.length-1,o=String(n.key||"").toLowerCase()==="q9"||String(n.label||"").toLowerCase().includes("q9");return!i&&s&&o?{a:.5,b:.5}:gxe(n.co,r)}function Mh(e){return Object.fromEntries((e||[]).map(t=>[t.key,t.btl]))}function vd(e,t,r){return Math.max(t,Math.min(r,e))}function wd(e,t){if(!t)return"-";const r=e/t*100;if(!Number.isFinite(r))return"-";const n=r.toFixed(1);return n.endsWith(".0")?n.slice(0,-2):n}function zb(e,t){return`${e}_sheet_${t}`}function xxe(e,t){if(!t.length)return;const r=Object.keys(t[0]),n=[r.join(",")].concat(t.map(l=>r.map(c=>{const u=l[c],d=String(u??"").replace(/\n/g," ");return d.includes(",")||d.includes('"')?`"${d.replace(/"/g,'""')}"`:d}).join(","))).join(`
`),i=new Blob([n],{type:"text/csv"}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function Vz({subjectId:e,teachingAssignmentId:t,assessmentKey:r,classType:n,questionPaperType:i}){const s=r||"cia1",o=s==="cia2"?"CIA 2":"CIA 1",l=x.useMemo(()=>mxe(s),[s]),[c,u]=x.useState(null),[d,f]=x.useState(null),[h,p]=x.useState(null),[m,g]=x.useState(null),y=x.useMemo(()=>{const ye=String(ni(n)||"").trim().toUpperCase();return ye?ye==="THEORY"?"THEORY":ye:""},[n]),b=x.useMemo(()=>{const ye=String(i??"").trim().toUpperCase();return ye==="QP2"?"QP2":ye==="QP1"?"QP1":""},[i]);x.useEffect(()=>{let ye=!0;return(async()=>{var Ut,Fe;if(!y){p(null);return}const $e=y==="THEORY"&&b||null,ft=s==="cia2"?"CIA2":"CIA1";let Sr=null,at=[];try{Sr=await sh({class_type:y,question_paper_type:$e,exam:ft}),at=Array.isArray((Ut=Sr==null?void 0:Sr.pattern)==null?void 0:Ut.marks)?Sr.pattern.marks:[]}catch{}if(!at.length)try{Sr=await sh({class_type:y,question_paper_type:$e,exam:"CIA"}),at=Array.isArray((Fe=Sr==null?void 0:Sr.pattern)==null?void 0:Fe.marks)?Sr.pattern.marks:[]}catch{}ye&&p(at.length?Sr.pattern:null)})(),()=>{ye=!1}},[y,b,s]);const v=x.useMemo(()=>{var Sr,at,Ut,Fe;const ye=((at=(Sr=c==null?void 0:c.assessments)==null?void 0:Sr[s])==null?void 0:at.questions)??((Fe=(Ut=c==null?void 0:c.assessments)==null?void 0:Ut.cia1)==null?void 0:Fe.questions),Ce=Array.isArray(ye)&&ye.length?ye.map(Ue=>({key:String((Ue==null?void 0:Ue.key)||""),label:String((Ue==null?void 0:Ue.label)||(Ue==null?void 0:Ue.key)||""),max:Number((Ue==null?void 0:Ue.max)||0),co:AM(Ue==null?void 0:Ue.co),btl:Math.min(6,Math.max(1,Number((Ue==null?void 0:Ue.btl)||1)))})).filter(Ue=>Ue.key):kM,$e=Array.isArray(h==null?void 0:h.marks)?h.marks:null,ft=Array.isArray(h==null?void 0:h.cos)?h.cos:null;return Array.isArray($e)&&$e.length?$e.map((Ue,Ct)=>{const gt=Ce[Ct],yt=ft?ft[Ct]:void 0;return{key:`q${Ct+1}`,label:`Q${Ct+1}`,max:Number(Ue)||0,co:yt!=null?AM(yt):(gt==null?void 0:gt.co)??l.a,btl:(gt==null?void 0:gt.btl)??1}}).filter(Ue=>!!Ue.key):Ce},[c,s,h,l.a]),[w,S]=x.useState(!1),[j,k]=x.useState(!1),[A,R]=x.useState(!1),[M,B]=x.useState(null),[E,P]=x.useState([]),[U,G]=x.useState({}),[H,oe]=x.useState(null),de=x.useRef(!1),[W,V]=x.useState(null),[ae,ee]=x.useState(!1),[C,Y]=x.useState(!1),[q,O]=x.useState(null),[X,F]=x.useState(null),Q=x.useRef(null),[K,ne]=x.useState(!1),[re,T]=x.useState(""),[I,ie]=x.useState(!1),[D,Z]=x.useState(null),[me,Te]=x.useState(!1),[je,Le]=x.useState(null),[_e,He]=x.useState(null),{data:We,loading:Pt,error:dt,remainingSeconds:Ye,publishAllowed:lt,refresh:be}=V0({assessment:s,subjectCode:e,teachingAssignmentId:t}),ke=!!(We!=null&&We.global_override_active&&(We==null?void 0:We.global_is_open)===!1),{data:ce,refresh:we}=G0({assessment:s,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:ht}=lc({assessment:s,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!1}}),{data:nt}=lc({assessment:s,subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:t,options:{poll:!1}}),[Ie,It]=x.useState(""),[ct,Mt]=x.useState(!1),[xr,Pr]=x.useState(null),[Nt,Jr]=x.useState({termLabel:"KRCT AY25-26",batchLabel:e,questionBtl:Mh(kM),rowsByStudentId:{},markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null}),Ur=x.useRef(null),[qr,cn]=x.useState(!1),[Pn,Lr]=x.useState(null),[mn,Me]=x.useState(!1),[qe,ut]=x.useState(null),[wt,At]=x.useState([]),[sr,Zt]=x.useState([]),[Cr,se]=x.useState([]),[ue,J]=x.useState(null);x.useEffect(()=>{J(null),Z(null)},[e]);const pe=!!W||!!(ce!=null&&ce.exists&&(ce!=null&&ce.is_published)),xe=!!Nt.markManagerLocked;Nt.markManagerSnapshot!=null,x.useEffect(()=>{if(ce!=null&&ce.is_published&&(ce!=null&&ce.updated_at)&&!W)try{V(new Date(String(ce.updated_at)).toLocaleString())}catch{V(String(ce.updated_at))}},[ce==null?void 0:ce.is_published,ce==null?void 0:ce.updated_at]);const Ne=nt!=null&&nt.approval_until?String(nt.approval_until):null,St=ht!=null&&ht.approval_until?String(ht.approval_until):null,Ve=!!(nt!=null&&nt.allowed_by_approval)&&!!Ne&&Ne!==((ue==null?void 0:ue.markEntryApprovalUntil)??null),De=!!(ht!=null&&ht.allowed_by_approval)&&!!St&&St!==((ue==null?void 0:ue.markManagerApprovalUntil)??null),Re=pe?!!(ce!=null&&ce.entry_open)||Ve||De:!0,xt=!!(pe&&!Re),Vt=!!(ke||(pe?!Re:!xe)),qt=!!(pe&&xt),{pending:zt,pendingUntilMs:vt,setPendingUntilMs:Lt,refresh:er}=K0({enabled:!!qt&&!!e,assessment:s,subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:t});Y0(!!K||!!ae||!!Pn);function yr(ye,Ce){return JSON.stringify({assessmentKey:s,totalsMax:nr,questions:(v||[]).map($e=>({key:$e.key,label:$e.label,max:$e.max})),questionBtl:ye,mark_manager:{questions:(Ce==null?void 0:Ce.questions)??[],marks:(Ce==null?void 0:Ce.marks)??[],btls:(Ce==null?void 0:Ce.btls)??[]}})}async function Br(){if(e){Me(!0),ut(null);try{const ye=await sl({assessment:s,subject_code:String(e),scope:"MARK_MANAGER",reason:`Edit request: Mark Manager changes for ${o} ${e}`,teaching_assignment_id:t});alert(ol(ye))}catch(ye){const Ce=ll(ye,"Request failed");ut(Ce),alert(`Edit request failed: ${Ce}`)}finally{Me(!1)}}}async function cr(){if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}if(zt){Z("Edit request is pending. Please wait for approval.");return}const Ce=String(re||"").trim();if(!Ce){Z("Reason is required.");return}ie(!0);try{const $e=await sl({assessment:s,subject_code:String(e),scope:"MARK_ENTRY",reason:Ce,teaching_assignment_id:t});Z(ol($e).replace(/\n/g,"  ")),ne(!1),T(""),Lt(Date.now()+24*60*60*1e3);try{er({silent:!0})}catch{}we({silent:!0})}catch($e){const ft=ll($e,"Request failed");alert(`Edit request failed: ${ft}`)}finally{ie(!1)}}async function ur(){if(I)return;if(zt){Z("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}B(null),Z(null),T(""),ne(!0)}x.useEffect(()=>{if(!e||!pe||Re)return;const ye=window.setInterval(()=>{we({silent:!0})},3e4);return()=>window.clearInterval(ye)},[Re,pe,e,we]);const en=x.useRef(null);x.useEffect(()=>{if(!e||!pe)return;if(!Re){en.current=!1;return}const ye=en.current;if(en.current=!0,ye===!0)return;let Ce=!0;return(async()=>{try{const $e=await ri(s,e);if(!Ce)return;const ft=$e==null?void 0:$e.draft;if(ft&&typeof ft=="object"){const Sr=ft.rowsByStudentId;if(Sr&&typeof Sr=="object"&&Object.values(Sr).some(Ut=>{if(!Ut||typeof Ut!="object")return!1;const Fe=Ut.marks||Ut.questionMarks;return Array.isArray(Fe)?Fe.some(Ue=>Ue!==""&&Ue!=null):Object.keys(Ut).some(Ue=>Ue.startsWith("q")&&Ut[Ue]!==""&&Ut[Ue]!=null)})){Jr(Ut=>({...Ut,termLabel:String(ft.termLabel||Ut.termLabel),batchLabel:e,questionBtl:ft.questionBtl&&typeof ft.questionBtl=="object"?ft.questionBtl:Ut.questionBtl,rowsByStudentId:ft.rowsByStudentId,markManagerLocked:ft.markManagerLocked??Ut.markManagerLocked,markManagerSnapshot:ft.markManagerSnapshot??Ut.markManagerSnapshot,markManagerApprovalUntil:ft.markManagerApprovalUntil??Ut.markManagerApprovalUntil})),de.current=!0;return}}nn(!0)}catch{try{nn(!0)}catch{}}})(),()=>{Ce=!1}},[Re,pe,e,s]);const nn=async ye=>{if(e){ye||(O(null),Y(!0));try{const Ce=await w0(s,e,t),$e=Ce&&Ce.data!=null?Ce.data:null;F($e)}catch(Ce){ye||O((Ce==null?void 0:Ce.message)||"Failed to load published sheet")}finally{ye||Y(!1)}}};x.useEffect(()=>{ae&&(F(null),nn(!1))},[ae,e,s]);async function gn(){if(e){Me(!0),ut(null);try{const ye=yr(Nt.questionBtl,{questions:wt,marks:sr,btls:Cr}),Ce=ht!=null&&ht.approval_until?String(ht.approval_until):Nt.markManagerApprovalUntil||null,$e={...Nt,markManagerLocked:!0,markManagerSnapshot:ye,markManagerApprovalUntil:Ce},ft={termLabel:$e.termLabel,batchLabel:e,questionBtl:$e.questionBtl,rowsByStudentId:$e.rowsByStudentId,markManagerLocked:$e.markManagerLocked,markManagerSnapshot:$e.markManagerSnapshot,markManagerApprovalUntil:$e.markManagerApprovalUntil};Jr($e),Lr(null),await Fi(s,e,ft),oe(new Date().toLocaleString());try{await fh(s,String(e),t),we({silent:!0})}catch(Sr){console.warn("confirmMarkManagerLock failed",Sr)}}catch(ye){ut((ye==null?void 0:ye.message)||"Save failed")}finally{Me(!1)}}}x.useEffect(()=>{if(!(!Pn||Pn.mode!=="confirm"))try{if(Nt.markManagerSnapshot){const ye=JSON.parse(String(Nt.markManagerSnapshot)),Ce=ye&&ye.mark_manager||{};At(Array.isArray(Ce.questions)?Ce.questions.map($e=>Number($e)).filter($e=>Number.isFinite($e)):[]),Zt(Array.isArray(Ce.marks)?Ce.marks.map($e=>Number($e)).filter($e=>Number.isFinite($e)):[]),se(Array.isArray(Ce.btls)?Ce.btls.map($e=>Number($e)).filter($e=>Number.isFinite($e)):[])}else At([]),Zt([]),se([])}catch{At([]),Zt([]),se([])}},[Pn]),x.useEffect(()=>{let ye=!0;return(async()=>{try{const Ce=await oc();if(!ye)return;u(Ce||null),f(null),Jr($e=>({...$e,termLabel:String((Ce==null?void 0:Ce.termLabel)||$e.termLabel||"KRCT AY25-26"),batchLabel:e}))}catch(Ce){if(!ye)return;u(null),f((Ce==null?void 0:Ce.message)||"Failed to load OBE Master config; using derived maxima from questions.")}})(),()=>{ye=!1}},[e]),x.useEffect(()=>{let ye=!0;return(async()=>{if(e){S(!0),B(null);try{let $e=null,ft=null;try{ft=(await hc()||[]).find(mt=>{const tr=String(mt.subject_code||"").trim().toUpperCase()===String(e||"").trim().toUpperCase();return(t?mt.id===t:!1)||tr})}catch{}if(ft&&ft.elective_subject_id&&!ft.section_id)try{const yt=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(ft.elective_subject_id))}`);if(yt.ok){const mt=await yt.json();$e={students:((Array.isArray(mt.results)?mt.results:Array.isArray(mt)?mt:mt.items||[])||[]).map(lr=>({id:Number(lr.student_id??lr.id),reg_no:String(lr.reg_no??lr.regno??""),name:String(lr.name??lr.full_name??lr.username??""),section:lr.section_name??lr.section??null})),marks:{}}}}catch(yt){console.warn("Elective-choices fetch failed, falling back:",yt)}if(!$e)try{$e=await B9(s,e,t)}catch(yt){if(console.warn("CIA marks fetch failed:",yt),ft&&ft.id)try{$e={students:(await pc(ft.id)).students||[],marks:{}}}catch{console.warn("TA roster fallback failed")}if(!$e)throw yt}if(!ye)return;let Sr=($e.students||[]).slice().sort((yt,mt)=>{const tr=String((yt==null?void 0:yt.name)||"").trim().toLowerCase(),lr=String((mt==null?void 0:mt.name)||"").trim().toLowerCase();if(tr&&lr){const Fr=tr.localeCompare(lr);if(Fr)return Fr}else if(tr||lr)return tr?-1:1;return String((yt==null?void 0:yt.reg_no)||"").localeCompare(String((mt==null?void 0:mt.reg_no)||""),void 0,{numeric:!0,sensitivity:"base"})});P(Sr),g(($e==null?void 0:$e.subject)||null);const at=$e.marks||{},Ut={};for(const[yt,mt]of Object.entries(at)){const tr=Number(yt);if(!Number.isFinite(tr))continue;if(mt==null||mt===""){Ut[tr]=null;continue}const lr=Number(mt);Ut[tr]=Number.isFinite(lr)?lr:null}G(Ut);try{let yt=null;if(s==="cia1"?yt=await ty(e):yt=await w0("cia2",e),yt&&yt.data&&typeof yt.data=="object"){const mt=yt.data,tr=mt.rowsByStudentId||mt.rows||mt.sheet&&mt.sheet.rowsByStudentId||{},lr={};for(const[Sn,Gr]of Object.entries(tr||{})){const fn=String(Sn),an=Gr,bn={},Se=an.q||an.answers||an.questions||an;if(Se&&typeof Se=="object")for(const[st,pt]of Object.entries(Se)){const Qe=Number(pt);bn[st]=Number.isFinite(Qe)?Qe:""}lr[fn]={studentId:Number(fn)||0,absent:!!an.absent,absentKind:an.absentKind||void 0,reg_no:String(an.reg_no||an.reg_no_text||""),q:bn}}const Fr=Array.isArray(mt.questions)?Object.fromEntries(mt.questions.map(Sn=>[String(Sn.key||Sn.label||""),Number(Sn.btl||Sn.btl_level||1)])):Mh(v),rn=Object.fromEntries(Object.entries(Fr).map(([Sn,Gr])=>{const fn=Number(Gr);return Number.isFinite(fn)&&fn>=1&&fn<=6?[Sn,fn]:[Sn,""]}));Jr({termLabel:String(mt.termLabel||(c==null?void 0:c.termLabel)||"KRCT AY25-26"),batchLabel:e,questionBtl:rn,rowsByStudentId:lr}),V(new Date().toLocaleString());try{Kn(zb(s,e),{termLabel:String(mt.termLabel||(c==null?void 0:c.termLabel)||"KRCT AY25-26"),batchLabel:e,questionBtl:rn,rowsByStudentId:lr})}catch{}}}catch{}const Fe=Zn(zb(s,e)),Ue=Fe&&typeof Fe=="object"?{termLabel:c!=null&&c.termLabel?String(c.termLabel):String(Fe.termLabel||"KRCT AY25-26"),batchLabel:e,questionBtl:Fe.questionBtl&&typeof Fe.questionBtl=="object"?Fe.questionBtl:Mh(v),rowsByStudentId:Fe.rowsByStudentId&&typeof Fe.rowsByStudentId=="object"?Fe.rowsByStudentId:{}}:{termLabel:String((c==null?void 0:c.termLabel)||"KRCT AY25-26"),batchLabel:e,questionBtl:Mh(v),rowsByStudentId:{}},Ct={...Mh(v),...Ue.questionBtl||{}};for(const yt of v){const mt=Ct[yt.key];mt===""||mt===1||mt===2||mt===3||mt===4||mt===5||mt===6||(Ct[yt.key]="")}const gt={...Ue.rowsByStudentId};for(const yt of $e.students||[]){const mt=String(yt.id);if(gt[mt]){const tr=!!gt[mt].absent,lr=String(gt[mt].absentKind||"").toUpperCase(),Fr=tr?lr==="ML"||lr==="SKL"||lr==="AL"?lr:"AL":void 0;gt[mt]={studentId:yt.id,absent:tr,absentKind:Fr,reg_no:yt.reg_no||"",q:{...gt[mt].q}}}else gt[mt]={studentId:yt.id,absent:!1,absentKind:void 0,reg_no:yt.reg_no||"",q:Object.fromEntries(v.map(tr=>[tr.key,""]))};for(const tr of v)tr.key in(gt[mt].q||{})||(gt[mt].q[tr.key]="")}Jr({...Ue,questionBtl:Ct,termLabel:Ue.termLabel||String((c==null?void 0:c.termLabel)||"KRCT AY25-26"),batchLabel:e,rowsByStudentId:gt})}catch($e){if(!ye)return;B(($e==null?void 0:$e.message)||`Failed to load ${o} roster`)}finally{ye&&S(!1)}}})(),()=>{ye=!1}},[e,t,c,v,s,o]),x.useEffect(()=>{let ye=!0;return de.current=!1,(async()=>{if(e){try{const Ce=await ri(s,e);if(!ye)return;const $e=Ce==null?void 0:Ce.draft;if($e&&typeof $e=="object"){Jr(ft=>({...ft,termLabel:String($e.termLabel||ft.termLabel),batchLabel:e,questionBtl:$e.questionBtl&&typeof $e.questionBtl=="object"?$e.questionBtl:ft.questionBtl,rowsByStudentId:$e.rowsByStudentId&&typeof $e.rowsByStudentId=="object"?$e.rowsByStudentId:ft.rowsByStudentId}));try{const ft=zb(s,e);Kn(ft,{termLabel:String($e.termLabel||"KRCT AY25-26"),batchLabel:String(e),questionBtl:$e.questionBtl&&typeof $e.questionBtl=="object"?$e.questionBtl:Mh(v),rowsByStudentId:$e.rowsByStudentId&&typeof $e.rowsByStudentId=="object"?$e.rowsByStudentId:{}})}catch{}}}catch{if(!ye)return}ye&&(de.current=!0)}})(),()=>{ye=!1}},[e,s,v]);const nr=x.useMemo(()=>v.reduce((ye,Ce)=>ye+Ce.max,0),[v]),Tr=x.useMemo(()=>{let ye=0,Ce=0;for(let $e=0;$e<v.length;$e++){const ft=v[$e],Sr=Ub(v,$e,l);ye+=ft.max*Sr.a,Ce+=ft.max*Sr.b}return{a:ye,b:Ce}},[v,l]),Dr=x.useMemo(()=>{var ft,Sr,at,Ut;const ye=((Sr=(ft=c==null?void 0:c.assessments)==null?void 0:ft[s])==null?void 0:Sr.coMax)??((Ut=(at=c==null?void 0:c.assessments)==null?void 0:at.cia1)==null?void 0:Ut.coMax),Ce=Number((ye==null?void 0:ye[`co${l.a}`])??(ye==null?void 0:ye.co1)),$e=Number((ye==null?void 0:ye[`co${l.b}`])??(ye==null?void 0:ye.co2));return{a:Number.isFinite(Ce)?Math.max(0,Ce):Tr.a,b:Number.isFinite($e)?Math.max(0,$e):Tr.b}},[c,Tr,s,l]),Rr=x.useMemo(()=>{const ye=new Set;for(const Ce of v){const $e=(Nt.questionBtl||{})[Ce.key];($e===1||$e===2||$e===3||$e===4||$e===5||$e===6)&&ye.add($e)}return[1,2,3,4,5,6].filter(Ce=>ye.has(Ce))},[Nt.questionBtl,v]),tt=x.useMemo(()=>{const ye={1:0,2:0,3:0,4:0,5:0,6:0};for(const Ce of v){const $e=(Nt.questionBtl||{})[Ce.key];($e===1||$e===2||$e===3||$e===4||$e===5||$e===6)&&(ye[$e]+=Ce.max)}return ye},[Nt.questionBtl,v]),Xe=x.useMemo(()=>{var $e,ft,Sr,at;const ye=((ft=($e=c==null?void 0:c.assessments)==null?void 0:$e[s])==null?void 0:ft.btlMax)??((at=(Sr=c==null?void 0:c.assessments)==null?void 0:Sr.cia1)==null?void 0:at.btlMax),Ce=(Ut,Fe)=>{const Ue=Number(ye==null?void 0:ye[Ut]);return Number.isFinite(Ue)?Math.max(0,Ue):Fe};return{1:Ce("1",tt[1]),2:Ce("2",tt[2]),3:Ce("3",tt[3]),4:Ce("4",tt[4]),5:Ce("5",tt[5]),6:Ce("6",tt[6])}},[c,tt,s]),ot=(ye,Ce)=>{A||Vt||Jr($e=>{const ft=String(ye),Sr=$e.rowsByStudentId[ft]||{studentId:ye,absent:!1,absentKind:void 0,reg_no:"",q:Object.fromEntries(v.map(Ut=>[Ut.key,""]))},at=Ce?{...Sr,absent:!0,absentKind:Sr.absentKind||"AL",q:Object.fromEntries(v.map(Ut=>[Ut.key,""]))}:{...Sr,absent:!1,absentKind:void 0};return{...$e,rowsByStudentId:{...$e.rowsByStudentId,[ft]:at}}})},Wt=(ye,Ce)=>{A||Vt||Jr($e=>{const ft=String(ye),Sr=$e.rowsByStudentId[ft]||{studentId:ye,absent:!0,absentKind:"AL",reg_no:"",q:Object.fromEntries(v.map(at=>[at.key,""]))};return{...$e,rowsByStudentId:{...$e.rowsByStudentId,[ft]:{...Sr,absent:!0,absentKind:Ce}}}})},pr=(ye,Ce)=>{if(A||ke)return;const $e=Nt.markManagerSnapshot!=null;xe&&$e||xt||Jr(ft=>({...ft,questionBtl:{...ft.questionBtl||Mh(v),[ye]:Ce}}))};x.useEffect(()=>{if(!e||!de.current)return;let ye=!1;const Ce=setTimeout(async()=>{try{const $e={termLabel:Nt.termLabel,batchLabel:e,questionBtl:Nt.questionBtl,rowsByStudentId:Nt.rowsByStudentId};await Fi(s,e,$e);try{const ft=zb(s,e);Kn(ft,{termLabel:Nt.termLabel,batchLabel:e,questionBtl:Nt.questionBtl,rowsByStudentId:Nt.rowsByStudentId})}catch{}ye||oe(new Date().toLocaleString())}catch{}},700);return()=>{ye=!0,clearTimeout(Ce)}},[Nt.questionBtl,e,Nt.rowsByStudentId,s]);const Nr=(ye,Ce,$e)=>{A||Vt||Jr(ft=>{const Sr=String(ye),at=ft.rowsByStudentId[Sr]||{studentId:ye,absent:!1,absentKind:void 0,reg_no:"",q:Object.fromEntries(v.map(lr=>[lr.key,""]))},Ut=!!at.absent,Fe=Ut?String(at.absentKind||"AL").toUpperCase():"";if(Ut&&!!!(me&&Ut))return ft;const Ct=v.find(lr=>lr.key===Ce),gt=(Ct==null?void 0:Ct.max)??nr,yt=$e===""?"":vd(Number($e||0),0,gt),mt=at.absent?at.absentKind||"AL":null,tr=mt==="ML"?60:mt==="SKL"?75:null;return tr!=null&&v.reduce((Fr,rn)=>{const Sn=rn.key===Ce?yt:(at.q||{})[rn.key];return Fr+vd(Number(Sn||0),0,rn.max)},0)>tr?(He({title:"Mark limit exceeded",message:Fe==="ML"?"For malpractice the total mark assigned is 60":"For Sick leave the Total mark assigned is 75"}),ft):{...ft,rowsByStudentId:{...ft.rowsByStudentId,[Sr]:{...at,q:{...at.q||{},[Ce]:yt}}}}})},br=ye=>!ye||!ye.q?!1:v.some(Ce=>{const $e=ye.q[Ce.key];return $e!==""&&$e!==null&&$e!==void 0});x.useMemo(()=>{const ye={};for(const Ce of E){const $e=Nt.rowsByStudentId[String(Ce.id)];if(!$e){ye[Ce.id]=null;continue}if($e.absent&&String($e.absentKind||"AL").toUpperCase()==="AL"){ye[Ce.id]=0;continue}const ft=v.reduce((Sr,at)=>{var Ut;return Sr+vd(Number(((Ut=$e.q)==null?void 0:Ut[at.key])||0),0,at.max)},0);ye[Ce.id]=ft}return ye},[E,Nt.rowsByStudentId,v]);const Je=x.useRef(Nt);Je.current=Nt,x.useEffect(()=>{const ye=()=>{if(!e||E.length===0||Vt||ke)return;const Ce=Je.current,$e={termLabel:Ce.termLabel,batchLabel:e,questionBtl:Ce.questionBtl,rowsByStudentId:Ce.rowsByStudentId};Fi(s,e,$e).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",ye),()=>window.removeEventListener("obe:before-tab-switch",ye)},[e,s,E.length,Vt,ke]);const Ht=async()=>{k(!0),B(null);try{const ye={termLabel:Nt.termLabel,batchLabel:e,questionBtl:Nt.questionBtl,rowsByStudentId:Nt.rowsByStudentId};await Fi(s,e,ye),oe(new Date().toLocaleString())}catch(ye){B((ye==null?void 0:ye.message)||`Failed to save ${o} draft`)}finally{k(!1)}},it=async()=>{var ye;if(e){if(ke){B("Publishing is locked by IQAC.");return}if(!lt){B("Publish window is closed. Please request IQAC approval.");return}if(pe&&xt){if(zt){B("Edit request is pending. Please wait for approval.");return}await ur();return}R(!0),B(null),Z(null);try{const Ce={};for(const[ft,Sr]of Object.entries(Nt.rowsByStudentId||{})){const at=Sr||{},Ut=br(at);at.absent&&Ut?Ce[ft]={...at,absent:!1,absentKind:void 0}:Ce[ft]=at}const $e={...Nt,batchLabel:e,questions:v,rowsByStudentId:Ce};await F9(s,e,$e,t),V(new Date().toLocaleString()),J({markEntryApprovalUntil:Ne,markManagerApprovalUntil:St}),Jr(ft=>({...ft,markManagerLocked:!0})),be(),we({silent:!0}),nn(!0);try{console.debug("obe:published dispatch",{assessment:s,subjectId:e}),window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:s}}))}catch{}setTimeout(()=>{try{if(ae&&Q.current){const ft=Q.current;ft.scrollTop=ft.scrollHeight}}catch{}},50)}catch(Ce){const $e=Ce==null?void 0:Ce.status;if(String(((ye=Ce==null?void 0:Ce.body)==null?void 0:ye.detail)||(Ce==null?void 0:Ce.message)||""),$e===423){V(ft=>ft||new Date().toLocaleString()),be(),we({silent:!0}),B(null),await ur();return}B((Ce==null?void 0:Ce.message)||`Failed to publish ${o}`)}finally{R(!1)}}},bt=async()=>{Mt(!0),Pr(null),B(null);try{await jh({assessment:s,subject_code:e,reason:Ie,teaching_assignment_id:t}),Pr("Request sent to IQAC for approval.")}catch(ye){B((ye==null?void 0:ye.message)||"Failed to request approval")}finally{Mt(!1),be()}},_t=()=>{const ye=E.map((Ce,$e)=>{const ft=Nt.rowsByStudentId[String(Ce.id)]||{studentId:Ce.id,absent:!1,absentKind:void 0,q:Object.fromEntries(v.map(lr=>[lr.key,""]))},Sr=br(ft),at=!!(ft.absent&&!Sr),Ut=at?String(ft.absentKind||"AL"):"";if(at){const lr=Object.fromEntries(v.map(Fr=>[Fr.key,""]));return{sno:$e+1,registerNo:Ce.reg_no,name:Ce.name,absent:1,absentKind:Ut,...lr,total:"ABSENT",[`co${l.a}_mark`]:"",[`co${l.a}_pct`]:"",[`co${l.b}_mark`]:"",[`co${l.b}_pct`]:"",...Object.fromEntries(Rr.flatMap(Fr=>[[`btl${Fr}_mark`,""],[`btl${Fr}_pct`,""]]))}}const Fe=0,Ue="",Ct=Object.fromEntries(v.map(lr=>{var Fr;return[lr.key,vd(Number(((Fr=ft.q)==null?void 0:Fr[lr.key])||0),0,lr.max)]})),gt=v.reduce((lr,Fr)=>lr+Number(Ct[Fr.key]||0),0);let yt=0,mt=0;for(let lr=0;lr<v.length;lr++){const Fr=v[lr],rn=Ub(v,lr,l),Sn=Number(Ct[Fr.key]||0);yt+=Sn*rn.a,mt+=Sn*rn.b}const tr={1:0,2:0,3:0,4:0,5:0,6:0};for(const lr of v){const Fr=(Nt.questionBtl||{})[lr.key];(Fr===1||Fr===2||Fr===3||Fr===4||Fr===5||Fr===6)&&(tr[Fr]+=Number(Ct[lr.key]||0))}return{sno:$e+1,registerNo:Ce.reg_no,name:Ce.name,absent:Fe,absentKind:Ue,...Ct,total:gt,[`co${l.a}_mark`]:yt,[`co${l.a}_pct`]:wd(yt,Dr.a),[`co${l.b}_mark`]:mt,[`co${l.b}_pct`]:wd(mt,Dr.b),...Object.fromEntries(Rr.flatMap(lr=>[[`btl${lr}_mark`,tr[lr]],[`btl${lr}_pct`,wd(tr[lr],Xe[lr])]]))}});xxe(`${e}_${s.toUpperCase()}_sheet.csv`,ye)},Tt=async()=>{try{const ye=new URLSearchParams;t&&ye.set("teaching_assignment_id",String(t)),b&&ye.set("question_paper_type",String(b));const ft=`${(Mj==null?void 0:Mj.VITE_API_BASE)||(typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":"https://db.krgi.co.in")}/api/obe/cia-export-template/${encodeURIComponent(s)}/${encodeURIComponent(e)}${ye.toString()?`?${ye.toString()}`:""}`,Sr=await mr(ft,{method:"GET"});if(!Sr.ok){const Ue=await Sr.text();throw new Error(Ue||`Export failed (${Sr.status})`)}const at=await Sr.blob(),Ut=window.URL.createObjectURL(at),Fe=document.createElement("a");Fe.href=Ut,Fe.download=`${e}_${s.toUpperCase()}_template.xlsx`,document.body.appendChild(Fe),Fe.click(),window.URL.revokeObjectURL(Ut),document.body.removeChild(Fe)}catch(ye){alert((ye==null?void 0:ye.message)||"Failed to export Excel")}},Dt=async()=>{const ye=E.map((ft,Sr)=>{const at=Nt.rowsByStudentId[String(ft.id)]||{studentId:ft.id,absent:!1,q:Object.fromEntries(v.map(gt=>[gt.key,""]))},Ut=br(at);if(!!(at.absent&&!Ut))return{sno:Sr+1,regNo:String(ft.reg_no||""),name:String(ft.name||""),total:"ABSENT"};const Ue=Object.fromEntries(v.map(gt=>{var yt;return[gt.key,vd(Number(((yt=at.q)==null?void 0:yt[gt.key])||0),0,gt.max)]})),Ct=v.reduce((gt,yt)=>gt+Number(Ue[yt.key]||0),0);return{sno:Sr+1,regNo:String(ft.reg_no||""),name:String(ft.name||""),total:Ct}}),Ce=String((m==null?void 0:m.name)||"").trim(),$e=String((m==null?void 0:m.code)||e||"").trim();await fy({filenameBase:`${e}_${o}`,meta:{courseName:Ce,courseCode:$e,className:String((m==null?void 0:m.className)||"")},rows:ye})},Gt=async ye=>{if(!(A||Vt||qr)){cn(!0);try{const Ce=await ye.arrayBuffer(),$e=C0(Ce,{type:"array"}),ft=$e.Sheets[$e.SheetNames[0]],Sr=bs.sheet_to_json(ft,{header:1});if(Sr.length<2)throw new Error("Excel file is empty or has no data rows");const at=Sr[0],Ut=at.findIndex(Fr=>String(Fr||"").toLowerCase().includes("register")),Fe=at.findIndex(Fr=>String(Fr||"").toLowerCase().includes("status"));if(Ut===-1)throw new Error('Could not find "Register No" column in Excel file');const Ue=2,Ct=Fe!==-1?Fe:at.length,gt=[];for(let Fr=Ue;Fr<Ct;Fr++){const rn=String(at[Fr]||"").trim();if(!rn)continue;const Sn=rn.match(/^([QqOo]\d+|[A-Za-z]\d*)/);if(!Sn)continue;const Gr=Sn[1].toUpperCase();if(b==="QP2"&&Gr==="Q10"){gt.push({colIdx:Fr,qKey:"q9",mode:"sum"});continue}if(b==="QP2"&&Gr==="Q9"){gt.push({colIdx:Fr,qKey:"q9",mode:"set"});continue}const fn=v.find(an=>an.label.toUpperCase()===Gr||an.key.toUpperCase()===Gr.toUpperCase());fn&&gt.push({colIdx:Fr,qKey:fn.key,mode:"set"})}if(gt.length===0)throw new Error("No matching question columns found in Excel file");const yt=new Map;E.forEach(Fr=>{const rn=String(Fr.reg_no||"").trim().toUpperCase();rn&&yt.set(rn,Fr)});let mt=0,tr=0;const lr={...Nt.rowsByStudentId};for(let Fr=1;Fr<Sr.length;Fr++){const rn=Sr[Fr];if(!rn||rn.length===0)continue;const Sn=String(rn[Ut]||"").trim().toUpperCase();if(!Sn)continue;const Gr=yt.get(Sn);if(!Gr){tr++;continue}const fn=String(Gr.id),an=lr[fn]||{studentId:Gr.id,absent:!1,absentKind:void 0,reg_no:Gr.reg_no,q:Object.fromEntries(v.map(Qe=>[Qe.key,""]))},bn={...an.q};let Se=!1;const st={};for(const{colIdx:Qe,qKey:vr,mode:tn}of gt){const An=rn[Qe];if(An==null||An===""){tn==="set"&&(bn[vr]="");continue}const xn=Number(An);if(!Number.isFinite(xn)){tn==="set"&&(bn[vr]="");continue}if(tn==="sum"){st[vr]=(st[vr]??0)+xn;continue}const zn=v.find(xi=>xi.key===vr),Rn=(zn==null?void 0:zn.max)??nr;bn[vr]=vd(xn,0,Rn),Se=!0}for(const[Qe,vr]of Object.entries(st)){const tn=Number(bn[Qe]===""?0:bn[Qe]||0),An=v.find(Rn=>Rn.key===Qe),xn=(An==null?void 0:An.max)??nr,zn=vd(tn+vr,0,xn);bn[Qe]=zn,Se=!0}let pt=an.absent;Fe!==-1&&(pt=String(rn[Fe]||"").trim().toLowerCase()==="absent"),lr[fn]={...an,q:bn,absent:pt},(Se||pt!==an.absent)&&mt++}Jr(Fr=>({...Fr,rowsByStudentId:lr})),alert(`Import successful!
Imported: ${mt} students
Skipped: ${tr} rows (no matching register number)`)}catch(Ce){alert(`Failed to import Excel: ${(Ce==null?void 0:Ce.message)||"Unknown error"}`),console.error("Import error:",Ce)}finally{cn(!1),Ur.current&&(Ur.current.value="")}}},$t=ye=>{var $e;const Ce=($e=ye.target.files)==null?void 0:$e[0];Ce&&Gt(Ce)},ze=()=>{Ur.current&&Ur.current.click()};if(w)return a.jsxs("div",{style:{color:"#6b7280"},children:["Loading ",o," roster"]});const Ze=E.some(ye=>{var Ce;return!!((Ce=Nt.rowsByStudentId[String(ye.id)])!=null&&Ce.absent)}),jt=me?E.filter(ye=>{var Ce;return je&&je.length?je.includes(ye.id):!!((Ce=Nt.rowsByStudentId[String(ye.id)])!=null&&Ce.absent)}):E,Bt={border:"1px solid #111",padding:"4px 4px",background:"#ecfdf5",color:"#065f46",textAlign:"center",fontWeight:700,fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},gr={border:"1px solid #111",padding:"4px 4px",fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},dr={width:"100%",border:"none",outline:"none",background:"transparent",fontSize:11},Kt=32;return a.jsxs(X0,{children:[_e?a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(15,23,42,0.45)",display:"flex",alignItems:"center",justifyContent:"center",padding:16,zIndex:50},onClick:()=>He(null),children:a.jsxs("div",{style:{width:"min(520px, 100%)",background:"#fff",borderRadius:14,border:"1px solid rgba(15,23,42,0.10)",boxShadow:"0 20px 60px rgba(2,6,23,0.25)",padding:14},onClick:ye=>ye.stopPropagation(),children:[a.jsx("div",{style:{fontWeight:900,marginBottom:6},children:_e.title}),a.jsx("div",{style:{fontSize:13,color:"#334155",marginBottom:12},children:_e.message}),a.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:a.jsx("button",{className:"obe-btn",onClick:()=>He(null),children:"Close"})})]})}):null,M&&a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:M}),d&&a.jsx("div",{style:{background:"#fffbeb",border:"1px solid #f59e0b55",color:"#92400e",padding:10,borderRadius:10,marginBottom:10},children:d}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",marginBottom:10},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsxs("button",{className:"obe-btn obe-btn-secondary",disabled:!Ze,onClick:()=>{if(me)return;const ye=E.filter(Ce=>{var $e;return!!(($e=Nt.rowsByStudentId[String(Ce.id)])!=null&&$e.absent)}).map(Ce=>Ce.id);Le(ye),Te(!0)},title:Ze?"Filter the table to show only absentees":"No absentees marked yet",style:me?{background:"linear-gradient(180deg, #111827, #334155)",color:"#fff",borderColor:"rgba(2,6,23,0.12)"}:void 0,children:["Show absentees list",me?a.jsx("span",{onClick:ye=>{ye.stopPropagation(),Te(!1),Le(null)},role:"button","aria-label":"Close absentees list",title:"Close absentees list",style:{marginLeft:10,display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:999,background:"rgba(255,255,255,0.18)",border:"1px solid rgba(255,255,255,0.25)",fontWeight:900,lineHeight:1,cursor:"pointer",userSelect:"none"},children:""}):null]}),a.jsx("button",{onClick:_t,className:"obe-btn obe-btn-secondary",disabled:E.length===0,children:"Export CSV"}),a.jsx("button",{onClick:Tt,className:"obe-btn obe-btn-secondary",disabled:E.length===0,children:"Export Excel"}),a.jsx("button",{onClick:ze,className:"obe-btn obe-btn-secondary",disabled:qr||E.length===0||Vt||ke,children:qr?"Importing":"Import Excel"}),a.jsx("input",{ref:Ur,type:"file",accept:".xlsx,.xls",onChange:$t,style:{display:"none"}})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:Dt,className:"obe-btn obe-btn-secondary",disabled:E.length===0,children:"Download"}),a.jsx("button",{onClick:Ht,className:"obe-btn obe-btn-success",disabled:j||E.length===0||Vt||ke,children:j?"Saving":"Save Draft"}),a.jsx("button",{onClick:it,disabled:qt?zt:A||E.length===0||!lt||Vt||ke,className:"obe-btn obe-btn-primary",children:qt?zt?"Request Pending":"Request Edit":A?"Publishing":"Publish"}),H&&a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Saved: ",H]}),W&&a.jsxs("div",{style:{fontSize:12,color:"#16a34a",alignSelf:"center"},children:["Published: ",W]})]})]}),a.jsx("div",{style:{marginBottom:10,fontSize:12,color:lt?"#065f46":"#b91c1c"},children:Pt?"Checking publish due time":dt||(We!=null&&We.due_at?a.jsxs(a.Fragment,{children:["Due: ",new Date(We.due_at).toLocaleString(),"  Remaining: ",sg(Ye),We.allowed_by_approval&&We.approval_until?a.jsxs(a.Fragment,{children:["  Approved until ",new Date(We.approval_until).toLocaleString()]}):null]}):"Due time not set by IQAC.")}),ke?a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),a.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:a.jsx("button",{className:"obe-btn",onClick:()=>be(),disabled:Pt,children:"Refresh"})})]}):lt?null:a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fecaca",background:"#fff7ed",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publish time is over"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:"Send a request to IQAC to approve publishing."}),a.jsx("textarea",{value:Ie,onChange:ye=>It(ye.target.value),placeholder:"Reason (optional)",rows:3,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:[a.jsx("button",{className:"obe-btn",onClick:()=>be(),disabled:ct||Pt,children:"Refresh"}),a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:bt,disabled:ct,children:ct?"Requesting":"Request Approval"})]}),xr?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:xr}):null]}),a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff",marginBottom:10},children:a.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[a.jsxs("label",{style:{fontSize:12,color:"#374151"},children:["Term",a.jsx("div",{style:{marginLeft:8,padding:6,border:"1px solid #d1d5db",borderRadius:8,minWidth:160},children:Nt.termLabel})]}),a.jsxs("label",{style:{fontSize:12,color:"#374151"},children:["Sheet Label",a.jsx("div",{style:{marginLeft:8,padding:6,border:"1px solid #d1d5db",borderRadius:8,minWidth:160},children:Nt.batchLabel})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Total max: ",nr," | Questions: ",v.length," | COs: ",l.a,"",l.b," | BTLs: 16"]})]})}),E.length===0?a.jsx("div",{style:{color:"#6b7280",fontSize:14,padding:"12px 0"},children:"No students found for this subject."}):a.jsxs("div",{style:{position:"relative"},children:[a.jsxs(og,{locked:ke,children:[a.jsxs("div",{style:{marginBottom:10,width:"100%",maxWidth:1200,marginLeft:"auto",marginRight:"auto"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"Mark Manager"}),a.jsxs("div",{style:{border:"1px solid #fcd34d",background:xe?"#f3f4f6":"#fff7ed",padding:12,borderRadius:12,width:"100%",display:"flex",justifyContent:"space-between",gap:10,alignItems:"center",flexWrap:"wrap"},children:[a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"baseline",flexWrap:"wrap",minWidth:0},children:[a.jsx("div",{style:{fontWeight:950,color:"#111827"},children:"BTL configuration"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Set BTL per question in the BTL row, then confirm."})]}),a.jsx("div",{style:{display:"flex",gap:8},children:a.jsx("button",{className:"obe-btn obe-btn-success",disabled:!e||mn,onClick:()=>Lr({mode:xe?"request":"confirm"}),children:xe?"Edit":"Save"})})]}),qe?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#991b1b"},children:qe}):null]}),a.jsx("div",{className:"obe-table-wrapper",style:{width:"100%",maxWidth:"100%",overflowX:"scroll",overflowY:"hidden",WebkitOverflowScrolling:"touch",overscrollBehaviorX:"contain",scrollbarGutter:"stable",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{className:"obe-table",style:{width:"max-content",minWidth:"100%",tableLayout:"auto",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:Bt,colSpan:4+v.length+1+4+Rr.length*2,children:[Nt.termLabel," | ",Nt.batchLabel," | ",o]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...Bt,width:Kt,minWidth:Kt},rowSpan:3,children:"S.No"}),a.jsx("th",{style:{...Bt,minWidth:70,overflow:"visible",textOverflow:"clip"},rowSpan:3,children:"R.No"}),a.jsx("th",{style:{...Bt,minWidth:240,overflow:"visible",textOverflow:"clip"},rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:{...Bt,minWidth:88},rowSpan:3,children:"AB"}),a.jsx("th",{style:Bt,colSpan:v.length,children:"QUESTIONS"}),a.jsx("th",{style:Bt,rowSpan:3,children:"Total"}),a.jsx("th",{style:Bt,colSpan:4,children:"CO ATTAINMENT"}),Rr.length?a.jsx("th",{style:Bt,colSpan:Rr.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[v.map(ye=>a.jsx("th",{style:{...Bt,width:46,minWidth:46},children:ye.label},ye.key)),a.jsxs("th",{style:Bt,colSpan:2,children:["CO-",l.a]}),a.jsxs("th",{style:Bt,colSpan:2,children:["CO-",l.b]}),Rr.map(ye=>a.jsxs("th",{style:Bt,colSpan:2,children:["BTL-",ye]},`btl-head-${ye}`))]}),a.jsxs("tr",{children:[v.map(ye=>a.jsx("th",{style:{...Bt,width:46,minWidth:46},children:ye.max},ye.key)),Array.from({length:2+Rr.length}).flatMap((ye,Ce)=>a.jsxs(sn.Fragment,{children:[a.jsx("th",{style:Bt,children:a.jsx("div",{style:{whiteSpace:"pre-line",lineHeight:"0.9",fontSize:"0.7em"},children:`M
A
R
K`})}),a.jsx("th",{style:Bt,children:"%"})]},Ce))]})]}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...gr,fontWeight:700,textAlign:"center"},colSpan:3}),a.jsx("td",{style:{...gr,fontWeight:700,textAlign:"center"},children:"BTL"}),v.map(ye=>a.jsx("td",{style:{...gr,textAlign:"center"},children:(()=>{const Ce=(Nt.questionBtl||{})[ye.key]??"",$e=Ce===""?"-":String(Ce);return a.jsxs("div",{style:{position:"relative",minWidth:44},children:[a.jsx("div",{style:{width:"100%",fontSize:12,padding:"2px 4px",border:"1px solid #d1d5db",borderRadius:8,background:"#fff",textAlign:"center",userSelect:"none"},title:`BTL: ${$e}`,children:$e}),a.jsxs("select",{"aria-label":`BTL for ${ye.label}`,value:Ce,onChange:ft=>pr(ye.key,ft.target.value===""?"":Number(ft.target.value)),style:{position:"absolute",inset:0,width:"100%",height:"100%",opacity:0,cursor:"pointer",appearance:"none",WebkitAppearance:"none",MozAppearance:"none"},children:[a.jsx("option",{value:"",children:"-"}),[1,2,3,4,5,6].map(ft=>a.jsx("option",{value:ft,children:ft},ft))]})]})})()},`btl-select-${ye.key}`)),a.jsx("td",{style:{...gr,fontWeight:700,textAlign:"center"}}),a.jsx("td",{style:{...gr,fontWeight:700,textAlign:"center"},colSpan:4}),Rr.map(ye=>a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...gr,fontWeight:700,textAlign:"center"}}),a.jsx("td",{style:{...gr,fontWeight:700,textAlign:"center"}})]},`btl-pad-${ye}`))]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...gr,fontWeight:700,textAlign:"center"},colSpan:3,children:"Name / Max Marks"}),a.jsx("td",{style:{...gr,fontWeight:700,textAlign:"center"},children:"-"}),v.map(ye=>a.jsx("td",{style:{...gr,fontWeight:700,textAlign:"center"},children:ye.max},ye.key)),a.jsx("td",{style:{...gr,fontWeight:700,textAlign:"center"},children:nr}),a.jsx("td",{style:{...gr,fontWeight:700,textAlign:"center"},children:Dr.a}),a.jsx("td",{style:{...gr,fontWeight:700,textAlign:"center"},children:"%"}),a.jsx("td",{style:{...gr,fontWeight:700,textAlign:"center"},children:Dr.b}),a.jsx("td",{style:{...gr,fontWeight:700,textAlign:"center"},children:"%"}),Rr.map(ye=>a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...gr,fontWeight:700,textAlign:"center"},children:Xe[ye]}),a.jsx("td",{style:{...gr,fontWeight:700,textAlign:"center"},children:"%"})]},`btl-max-${ye}`))]}),jt.map((ye,Ce)=>{const $e=Nt.rowsByStudentId[String(ye.id)]||{studentId:ye.id,reg_no:ye.reg_no??"",absent:!1,absentKind:void 0,q:Object.fromEntries(v.map(mt=>[mt.key,""]))},ft=Object.fromEntries(v.map(mt=>{var tr;return[mt.key,vd(Number(((tr=$e.q)==null?void 0:tr[mt.key])||0),0,mt.max)]})),Sr=v.reduce((mt,tr)=>mt+Number(ft[tr.key]||0),0);let at=0,Ut=0;for(let mt=0;mt<v.length;mt++){const tr=v[mt],lr=Ub(v,mt,l),Fr=Number(ft[tr.key]||0);at+=Fr*lr.a,Ut+=Fr*lr.b}const Fe={1:0,2:0,3:0,4:0,5:0,6:0};for(const mt of v){const tr=(Nt.questionBtl||{})[mt.key];(tr===1||tr===2||tr===3||tr===4||tr===5||tr===6)&&(Fe[tr]+=Number(ft[mt.key]||0))}const Ue=$e.absent?{background:"#f1f5f9"}:void 0;$e.absent&&String($e.absentKind||"AL").toUpperCase();const Ct=!!(me&&$e.absent),gt=!!(A||Vt||ke||xt),yt=U[ye.id];return a.jsxs("tr",{style:Ue,children:[a.jsx("td",{style:{...gr,textAlign:"center",width:Kt,minWidth:Kt,paddingLeft:2,paddingRight:2},children:Ce+1}),a.jsx("td",{style:{...gr,minWidth:70,overflow:"visible",textOverflow:"clip"},children:NM($e.reg_no)}),a.jsx("td",{style:{...gr,minWidth:240,overflow:"visible",textOverflow:"clip"},children:ye.name}),a.jsx("td",{style:{...gr,textAlign:"center",minWidth:88},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[a.jsx("input",{type:"checkbox",checked:$e.absent,disabled:gt,onChange:mt=>ot(ye.id,mt.target.checked)}),$e.absent?a.jsxs("div",{className:"obe-ios-select",title:"Absent type",children:[a.jsx("span",{className:"obe-ios-select-value",children:String($e.absentKind||"AL")}),a.jsxs("select",{"aria-label":"Absent type",value:$e.absentKind||"AL",disabled:gt,onChange:mt=>Wt(ye.id,mt.target.value),children:[a.jsx("option",{value:"AL",children:"AL"}),a.jsx("option",{value:"ML",children:"ML"}),a.jsx("option",{value:"SKL",children:"SKL"})]})]}):null]})}),v.map(mt=>{var tr,lr,Fr;return a.jsx("td",{style:{...gr,textAlign:"center",width:46,minWidth:46},children:a.jsx("input",{style:{...dr,textAlign:"center"},type:"number",min:0,max:mt.max,disabled:gt||$e.absent&&!Ct,value:((tr=$e.q)==null?void 0:tr[mt.key])===""||((lr=$e.q)==null?void 0:lr[mt.key])==null?"":Number(((Fr=$e.q)==null?void 0:Fr[mt.key])||0),onChange:rn=>{const Sn=rn.target.value;if(Sn==="")return rn.currentTarget.setCustomValidity(""),Nr(ye.id,mt.key,"");const Gr=Number(Sn);if(Number.isFinite(Gr)){if(Gr>mt.max){rn.currentTarget.setCustomValidity(`Max mark is ${mt.max}`),rn.currentTarget.reportValidity(),window.setTimeout(()=>rn.currentTarget.setCustomValidity(""),0);return}rn.currentTarget.setCustomValidity(""),Nr(ye.id,mt.key,Gr)}}})},mt.key)}),a.jsx("td",{style:{...gr,textAlign:"center",fontWeight:700},title:yt!=null?`Server total: ${yt}`:void 0,children:Sr}),a.jsx("td",{style:{...gr,textAlign:"center"},children:at}),a.jsx("td",{style:{...gr,textAlign:"center"},children:a.jsx("span",{className:"obe-pct-badge",children:wd(at,Dr.a)})}),a.jsx("td",{style:{...gr,textAlign:"center"},children:Ut}),a.jsx("td",{style:{...gr,textAlign:"center"},children:a.jsx("span",{className:"obe-pct-badge",children:wd(Ut,Dr.b)})}),Rr.map(mt=>a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...gr,textAlign:"center"},children:Fe[mt]}),a.jsx("td",{style:{...gr,textAlign:"center"},children:a.jsx("span",{className:"obe-pct-badge",children:wd(Fe[mt],Xe[mt])})})]},`btl-row-${ye.id}-${mt}`))]},ye.id)})]})]})})]}),Vt&&!ke?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{position:"absolute",inset:0,background:pe?"rgba(240,253,244,0.55)":"rgba(239,246,255,0.65)",border:`1px solid ${pe?"rgba(22,163,74,0.25)":"rgba(59,130,246,0.25)"}`,borderRadius:12,pointerEvents:"none"}}),a.jsxs("div",{style:{position:"absolute",left:"50%",top:16,transform:"translateX(-50%)",zIndex:40,width:320,background:"#fff",border:"1px solid #e5e7eb",padding:12,borderRadius:12,boxShadow:"0 6px 18px rgba(17,24,39,0.06)",display:"flex",flexDirection:"column",gap:10,alignItems:"stretch"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:950,color:"#111827"},children:pe?"Published  Locked":"Table Locked"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:4},children:pe?"Marks are published. Use View to inspect or Request Edit to ask IQAC for access.":"Confirm the Mark Manager to unlock student entry."}),pe&&D?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:D}):null]}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",flexWrap:"wrap"},children:pe?a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn",onClick:()=>ee(!0),children:"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",onClick:async()=>{await ur()},disabled:I||zt,children:zt?"Request Pending":"Request Edit"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>Lr({mode:"confirm"}),disabled:!e||mn,children:"Save Mark Manager"}),a.jsx("button",{className:"obe-btn",onClick:()=>Br(),disabled:mn,children:"Request Access"})]})})]})]}):null]}),Pn?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:9999},onClick:()=>{mn||Lr(null)},children:a.jsxs("div",{style:{width:"min(760px,96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:ye=>ye.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:Pn.mode==="confirm"?`Confirmation - ${o}`:`Request Edit - ${o}`}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:String(e||"")})]}),Pn.mode==="confirm"?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"Confirm the selected BTL settings. After confirming, Mark Manager will be locked and the table will be editable."}),a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Question"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Max"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"BTL"})]})}),a.jsx("tbody",{children:v.map(ye=>a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:ye.label}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:ye.max}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:a.jsxs("select",{value:(Nt.questionBtl||{})[ye.key]===""?"":String((Nt.questionBtl||{})[ye.key]),onChange:Ce=>{const $e=Ce.target.value===""?"":Number(Ce.target.value);pr(ye.key,$e)},style:{padding:"6px 8px",borderRadius:6,border:"1px solid #e5e7eb",background:"#fff"},disabled:mn||ke,children:[a.jsx("option",{value:"",children:"-"}),[1,2,3,4,5,6].map(Ce=>a.jsx("option",{value:String(Ce),children:Ce},Ce))]})})]},ye.key))})]})})]}):a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. Mark Manager will remain locked until IQAC approves."}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[a.jsx("button",{className:"obe-btn",disabled:mn,onClick:()=>Lr(null),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:mn||!e,onClick:async()=>{if(e){if(Pn.mode==="request"){Lr(null),await Br();return}await gn()}},children:Pn.mode==="confirm"?"Confirm":"Send Request"})]})]})})}):null,ae?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>ee(!1),children:a.jsxs("div",{style:{width:"min(1100px, 96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:0,display:"flex",flexDirection:"column"},onClick:ye=>ye.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"12px 14px",borderBottom:"1px solid #eef2f7"},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Only"}),a.jsx("button",{onClick:ye=>{ye.stopPropagation(),ee(!1)},"aria-label":"Close",style:{marginLeft:"auto",border:"none",background:"transparent",fontSize:20,lineHeight:1,cursor:"pointer"},children:""})]}),a.jsxs("div",{style:{padding:14},children:[C?a.jsx("div",{style:{color:"#6b7280"},children:"Loading published sheet"}):null,q?a.jsx("div",{style:{color:"#991b1b",fontSize:12,marginBottom:8},children:q}):null]}),X&&(X.rowsByStudentId||X.rows_by_student_id)?a.jsx("div",{ref:Q,style:{overflow:"auto",border:"1px solid #e5e7eb",borderRadius:12,maxHeight:"60vh"},children:a.jsxs("table",{className:"obe-table",style:{width:"max-content",minWidth:"100%",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:Bt,colSpan:6+Rr.length*2,children:[Nt.termLabel," | ",Nt.batchLabel," | ",o," (PUBLISHED)"]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...Bt,width:Kt,minWidth:Kt},children:"S.No"}),a.jsx("th",{style:{...Bt,minWidth:70,overflow:"visible",textOverflow:"clip"},children:"R.No"}),a.jsx("th",{style:{...Bt,minWidth:240,overflow:"visible",textOverflow:"clip"},children:"Name of the Students"}),a.jsx("th",{style:Bt,children:"Total"}),a.jsxs("th",{style:Bt,colSpan:2,children:["CO-",l.a]}),a.jsxs("th",{style:Bt,colSpan:2,children:["CO-",l.b]}),Rr.map(ye=>a.jsxs("th",{style:Bt,colSpan:2,children:["BTL-",ye]},`pv_btl_${ye}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:Bt}),a.jsx("th",{style:Bt}),a.jsx("th",{style:Bt}),a.jsx("th",{style:Bt}),Array.from({length:2+Rr.length}).flatMap((ye,Ce)=>a.jsxs(sn.Fragment,{children:[a.jsx("th",{style:Bt,children:"Mark"}),a.jsx("th",{style:Bt,children:"%"})]},`pv_hdr_${Ce}`))]})]}),a.jsx("tbody",{children:E.map((ye,Ce)=>{var gt;const $e=X.rowsByStudentId||X.rows_by_student_id||{},ft=$e[String(ye.id)]||$e[ye.id]||{},Sr=ft.q||{},at=Object.fromEntries(v.map(yt=>[yt.key,vd(Number((Sr==null?void 0:Sr[yt.key])||0),0,yt.max)])),Ut=v.reduce((yt,mt)=>yt+Number(at[mt.key]||0),0);let Fe=0,Ue=0;for(let yt=0;yt<v.length;yt++){const mt=v[yt],tr=Ub(v,yt,l),lr=Number(at[mt.key]||0);Fe+=lr*tr.a,Ue+=lr*tr.b}const Ct={1:0,2:0,3:0,4:0,5:0,6:0};for(const yt of v){const mt=(X.questionBtl||X.question_btl||Nt.questionBtl||{})[yt.key];if(mt===1||mt===2||mt===3||mt===4||mt===5||mt===6){const tr=mt;Ct[tr]+=Number(at[yt.key]||0)}}return a.jsxs("tr",{children:[a.jsx("td",{style:{...gr,textAlign:"center",width:Kt,minWidth:Kt,paddingLeft:2,paddingRight:2},children:Ce+1}),a.jsx("td",{style:{...gr,minWidth:70,overflow:"visible",textOverflow:"clip"},children:NM(ft.reg_no||((gt=Nt.rowsByStudentId[String(ye.id)])==null?void 0:gt.reg_no)||"")}),a.jsx("td",{style:{...gr,minWidth:240,overflow:"visible",textOverflow:"clip"},children:ye.name}),a.jsx("td",{style:{...gr,textAlign:"center",fontWeight:900},children:Ut}),a.jsx("td",{style:{...gr,textAlign:"center"},children:Math.round(Fe)}),a.jsx("td",{style:{...gr,textAlign:"center"},children:a.jsx("span",{className:"obe-pct-badge",children:wd(Fe,Dr.a)})}),a.jsx("td",{style:{...gr,textAlign:"center"},children:Math.round(Ue)}),a.jsx("td",{style:{...gr,textAlign:"center"},children:a.jsx("span",{className:"obe-pct-badge",children:wd(Ue,Dr.b)})}),Rr.map(yt=>a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...gr,textAlign:"center"},children:Math.round(Ct[yt])}),a.jsx("td",{style:{...gr,textAlign:"center"},children:a.jsx("span",{className:"obe-pct-badge",children:wd(Ct[yt],Xe[yt])})})]},`pv_btl_${ye.id}_${yt}`))]},`pv_${ye.id}`)})})]})}):C?null:a.jsx("div",{style:{color:"#6b7280"},children:"No published sheet found."}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{className:"obe-btn",onClick:()=>ee(!1),children:"Close"})})]})})}):null,K?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>{I||ne(!1)},children:a.jsxs("div",{style:{width:"min(560px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:ye=>ye.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[o,"  ",String(e||"")]})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",vt?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:re,onChange:ye=>T(ye.target.value),placeholder:"Explain why you need to edit (required)",rows:4,className:"obe-input",style:{resize:"vertical"}})]}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:12},children:[a.jsx("button",{className:"obe-btn",disabled:I,onClick:()=>ne(!1),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:I||zt||!e||!String(re||"").trim(),onClick:cr,children:I?"Requesting":zt?"Request Pending":"Send Request"})]})]})})}):null]})}function NM(e){return e.slice(-8)}function yxe(e){return a.jsx(Vz,{...e,assessmentKey:"cia2"})}const bxe=5,vxe=20,wxe=10;function Dn(e,t,r){return Math.max(t,Math.min(r,e))}function _c(e){return Math.round(e*10)/10}function ds(e){if(e===""||e==null)return"";const t=Number(e);return Number.isFinite(t)?t:""}function Wb(e){if(e===""||e==null||typeof e=="string"&&e.trim()==="")return null;const t=Number(e);return Number.isFinite(t)?t:null}function Na(e,t){if(!t)return"-";const r=e/t*100;return`${Number.isFinite(r)?r.toFixed(0):0}`}function Sxe(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const l=r.localeCompare(n);if(l)return l}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim(),o=i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"});return o||0}function _xe(e,t){return`${e}_sheet_${t}`}function jxe(e,t){if(!t.length)return;const r=Object.keys(t[0]),n=[r.join(",")].concat(t.map(l=>r.map(c=>{const u=l[c],d=String(u??"").replace(/\n/g," ");return d.includes(",")||d.includes('"')?`"${d.replace(/"/g,'""')}"`:d}).join(","))).join(`
`),i=new Blob([n],{type:"text/csv"}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function wp(e){return e.slice(-8)}function Gz({subjectId:e,teachingAssignmentId:t,assessmentKey:r,skipMarkManager:n=!1}){var pr,Nr,br;const i=r||"formative1",s=i==="formative2"?"Formative 2":"Formative 1",o=i==="formative2"?3:1,l=i==="formative2"?4:2,[c,u]=x.useState(!1),[d,f]=x.useState(null),[h,p]=x.useState([]),[m,g]=x.useState(null),[y,b]=x.useState({skill1:3,skill2:4,att1:3,att2:4}),[v,w]=x.useState(!1),[S,j]=x.useState(!1),[k,A]=x.useState(null),R=x.useRef(!1),[M,B]=x.useState(null),[E,P]=x.useState(!1),U=x.useRef(null),[G,H]=x.useState(!1),{data:oe,loading:de,error:W,remainingSeconds:V,publishAllowed:ae,refresh:ee}=V0({assessment:i,subjectCode:String(e||""),teachingAssignmentId:t}),C=!!(oe!=null&&oe.global_override_active&&(oe==null?void 0:oe.global_is_open)===!1),[Y,q]=x.useState(""),[O,X]=x.useState(!1),[F,Q]=x.useState(null),[K,ne]=x.useState(null),[re,T]=x.useState({termLabel:"KRCT AY25-26",batchLabel:e||"",rowsByStudentId:{},markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null}),{data:I,refresh:ie}=G0({assessment:i,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:D,refresh:Z}=lc({assessment:i,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!0}}),{data:me,refresh:Te}=lc({assessment:i,subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:t,options:{poll:!0}}),[je,Le]=x.useState(null),_e=!!M||!!(I!=null&&I.exists&&(I!=null&&I.is_published)),He=n?!0:!!re.markManagerLocked;x.useEffect(()=>{if(I!=null&&I.is_published&&(I!=null&&I.updated_at)&&!M)try{B(new Date(String(I.updated_at)).toLocaleString())}catch{B(String(I.updated_at))}},[I==null?void 0:I.is_published,I==null?void 0:I.updated_at]);const We=me!=null&&me.approval_until?String(me.approval_until):null,Pt=D!=null&&D.approval_until?String(D.approval_until):null,dt=!!(me!=null&&me.allowed_by_approval)&&!!We&&We!==((je==null?void 0:je.markEntryApprovalUntil)??null),Ye=!!(D!=null&&D.allowed_by_approval)&&!!Pt&&Pt!==((je==null?void 0:je.markManagerApprovalUntil)??null),lt=_e?!!(I!=null&&I.entry_open)||dt||Ye:!0,be=!!(_e&&!lt),ke=!!(_e&&be),ce=!!(_e&&be),we=n?!!(C||_e&&!lt):!!(C||(_e?!lt:!He)),ht=n?!0:re.markManagerSnapshot!=null||!!_e,[nt,Ie]=x.useState(null),[It,ct]=x.useState(!1),Mt=_e,[xr,Pr]=x.useState(!1),[Nt,Jr]=x.useState(null),[Ur,qr]=x.useState(!1),[cn,Pn]=x.useState(null),[Lr,mn]=x.useState(!1),[Me,qe]=x.useState(""),[ut,wt]=x.useState(!1),{pending:At,pendingUntilMs:sr,setPendingUntilMs:Zt,refresh:Cr}=K0({enabled:!!ce&&!!e,assessment:i,subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:t});Y0(!!Lr||!!xr||!!nt);const se=String((K==null?void 0:K.termLabel)||"KRCT AY25-26"),ue=((pr=K==null?void 0:K.assessments)==null?void 0:pr[i])??((Nr=K==null?void 0:K.assessments)==null?void 0:Nr.formative1)??{},J=Number.isFinite(Number(ue==null?void 0:ue.maxPart))?Number(ue.maxPart):bxe,pe=Number.isFinite(Number(ue==null?void 0:ue.maxTotal))?Number(ue.maxTotal):vxe,xe=Number.isFinite(Number(ue==null?void 0:ue.maxCo))?Number(ue.maxCo):wxe,Ne=x.useMemo(()=>{const Je=re.markManagerSnapshot;if(!Je)return null;try{const Ht=JSON.parse(String(Je)),it=Ht==null?void 0:Ht.partBtl;if(!it||typeof it!="object")return null;const bt={};for(const _t of["skill1","skill2","att1","att2"]){const Tt=it[_t];bt[_t]=Tt===""||Tt==null?"":Number(Tt),bt[_t]===""||Number.isFinite(bt[_t])&&bt[_t]>=1&&bt[_t]<=6||(bt[_t]="")}return bt}catch{return null}},[re.markManagerSnapshot]);x.useEffect(()=>{Le(null)},[e]);const St=Ne||y,Ve=async Je=>{if(e){Je||(Pn(null),qr(!0));try{const Ht=await v0(i,e),it=Ht&&Ht.marks&&typeof Ht.marks=="object"?Ht.marks:null;it&&Object.keys(it).length?Jr(it):Jr(null)}catch(Ht){Je||Pn((Ht==null?void 0:Ht.message)||"Failed to load published marks")}finally{Je||qr(!1)}}};x.useEffect(()=>{xr&&(Jr(null),Ve(!1))},[xr,e,i]);const De=x.useRef(null);x.useEffect(()=>{if(!e||!_e)return;if(!lt){De.current=!1;return}const Je=De.current;if(De.current=!0,Je===!0)return;let Ht=!0;return(async()=>{try{const it=await ri(i,String(e));if(!Ht)return;const bt=it==null?void 0:it.draft,_t=bt==null?void 0:bt.sheet,Tt=bt==null?void 0:bt.partBtl;if(_t&&typeof _t=="object"&&typeof _t.rowsByStudentId=="object"){const Dt=_t.rowsByStudentId;if(Dt&&Object.values(Dt).some($t=>!$t||typeof $t!="object"?!1:["skill1","skill2","att1","att2"].some(ze=>$t[ze]!==""&&$t[ze]!=null))){if(T($t=>({...$t,termLabel:String(_t.termLabel||se||"KRCT AY25-26"),batchLabel:String(e),rowsByStudentId:_t.rowsByStudentId||{},markManagerLocked:typeof _t.markManagerLocked=="boolean"?_t.markManagerLocked:!!(_t.markManagerSnapshot??$t.markManagerSnapshot),markManagerSnapshot:_t.markManagerSnapshot??$t.markManagerSnapshot??null,markManagerApprovalUntil:_t.markManagerApprovalUntil??$t.markManagerApprovalUntil??null})),Tt&&typeof Tt=="object"){const $t={};for(const ze of["skill1","skill2","att1","att2"]){const Ze=Tt[ze];$t[ze]=Ze===""||Ze==null?"":Number(Ze),$t[ze]===""||Number.isFinite($t[ze])&&$t[ze]>=1&&$t[ze]<=6||($t[ze]="")}b($t)}R.current=!0;return}}if(!Ht)return;Ve(!1)}catch{if(!Ht)return;Ve(!1)}})(),()=>{Ht=!1}},[lt,_e,e,i,se]),x.useEffect(()=>{if(!e||!_e||lt)return;const Je=window.setInterval(()=>{ie({silent:!0});try{Te==null||Te({silent:!0}),Z==null||Z({silent:!0})}catch{}},3e4);return()=>window.clearInterval(Je)},[lt,_e,e,ie,Te,Z]);async function Re(){if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}if(At){alert("Edit request is pending. Please wait for approval.");return}const Ht=String(Me||"").trim();if(!Ht){alert("Reason is required.");return}wt(!0);const it=new Date,bt=me!=null&&me.approval_until?String(me.approval_until):null;try{const _t=await sl({assessment:i,subject_code:String(e),scope:"MARK_ENTRY",reason:Ht,teaching_assignment_id:t});alert(ol(_t)),mn(!1),qe(""),Zt(Date.now()+24*60*60*1e3);try{Cr({silent:!0})}catch{}const Tt=Number(_t==null?void 0:_t.id),Gt=it.getTime()-2e3;(async()=>{if(!e)return;const $t=36,ze=5e3;for(let Ze=0;Ze<$t;Ze++){try{const jt=await Bm({assessment:i,subject_code:String(e),scope:"MARK_ENTRY",teaching_assignment_id:t}),Bt=jt==null?void 0:jt.result;if(!(Bt&&Number.isFinite(Tt)&&Bt.id!==Tt)){if((Bt==null?void 0:Bt.status)==="APPROVED"&&(Bt!=null&&Bt.is_active)){const gr=Bt.reviewed_at?new Date(Bt.reviewed_at).getTime():NaN;if(!(!Number.isFinite(gr)||gr<Gt)){try{Te==null||Te({silent:!0}),ie({silent:!0})}catch{}alert("IQAC approved the edit request. You can now edit marks.");return}}else if((Bt==null?void 0:Bt.status)==="REJECTED"){const gr=Bt.reviewed_at?new Date(Bt.reviewed_at).getTime():NaN;if(!(!Number.isFinite(gr)||gr<Gt)){alert("IQAC rejected the edit request.");return}}}}catch{try{const Bt=await l1(i,String(e),"MARK_ENTRY",t),gr=Bt!=null&&Bt.approval_until?String(Bt.approval_until):null;if(Bt!=null&&Bt.allowed_by_approval&&gr&&gr!==bt){try{Te==null||Te({silent:!0}),ie({silent:!0})}catch{}alert("IQAC approved the edit request. You can now edit marks.");return}}catch{}}await new Promise(jt=>setTimeout(jt,ze))}alert("Edit request still pending. Please try again later.")})()}catch(_t){const Tt=ll(_t,"Request failed");alert(`Edit request failed: ${Tt}`)}finally{wt(!1)}}x.useEffect(()=>{let Je=!0;return(async()=>{try{const Ht=await oc();if(!Je)return;ne(Ht||null),T(it=>({...it,termLabel:String((Ht==null?void 0:Ht.termLabel)||it.termLabel||"KRCT AY25-26"),batchLabel:e||it.batchLabel}))}catch{}})(),()=>{Je=!1}},[e]);const xt=x.useMemo(()=>e?_xe(i,e):"",[i,e]),Vt=x.useMemo(()=>[{key:"skill1",label:"Skill 1",max:J},{key:"skill2",label:"Skill 2",max:J},{key:"att1",label:"Attitude 1",max:J},{key:"att2",label:"Attitude 2",max:J}],[J]);(br=Vt[Vt.length-1])==null||br.key;const qt=x.useMemo(()=>{const Je=new Set;for(const Ht of Object.keys(y)){const it=y[Ht];(it===1||it===2||it===3||it===4||it===5||it===6)&&Je.add(it)}return[1,2,3,4,5,6].filter(Ht=>Je.has(Ht))},[y]),zt=x.useMemo(()=>12+qt.length*2,[qt.length]);x.useEffect(()=>{if(e){const Je=`${i}_part_btl_${e}`,Ht=Zn(Je);if(Ht&&typeof Ht=="object")try{const it={};for(const bt of Object.keys(y)){const _t=Ht[bt];it[bt]=_t===""||_t==null?"":Number(_t),it[bt]===""||Number.isFinite(it[bt])&&it[bt]>=1&&it[bt]<=6||(it[bt]="")}b(it)}catch{}}},[e,i]),x.useEffect(()=>{if(!e)return;const Je=`${i}_part_btl_${e}`;try{Kn(Je,y)}catch{}},[y,e,i]);const vt=Je=>JSON.stringify({assessmentKey:i,partBtl:Je,maxPart:J,maxTotal:pe});async function Lt(){if(e){ct(!0);try{const Je=vt(y),Ht=D!=null&&D.approval_until?String(D.approval_until):re.markManagerApprovalUntil||null,it={...re,markManagerLocked:!0,markManagerSnapshot:Je,markManagerApprovalUntil:Ht},bt={sheet:it,partBtl:y,markManagerLocked:it.markManagerLocked,markManagerSnapshot:it.markManagerSnapshot,markManagerApprovalUntil:it.markManagerApprovalUntil};T(it),Ie(null),await Fi(i,String(e),bt),A(new Date().toLocaleString());try{await fh(i,String(e),t),ie({silent:!0})}catch{}}catch{}finally{ct(!1)}}}async function er(){if(!e)return;ct(!0);const Je=new Date,Ht=D!=null&&D.approval_until?String(D.approval_until):null;try{const it=await sl({assessment:i,subject_code:String(e),scope:"MARK_MANAGER",reason:`Request mark-manager edit for ${e}`,teaching_assignment_id:t});alert(ol(it));const bt=Number(it==null?void 0:it.id),Tt=Je.getTime()-2e3;(async()=>{if(!e)return;const Dt=36,Gt=5e3;for(let $t=0;$t<Dt;$t++){try{const ze=await Bm({assessment:i,subject_code:String(e),scope:"MARK_MANAGER",teaching_assignment_id:t}),Ze=ze==null?void 0:ze.result;if(!(Ze&&Number.isFinite(bt)&&Ze.id!==bt)){if((Ze==null?void 0:Ze.status)==="APPROVED"&&(Ze!=null&&Ze.is_active)){const jt=Ze.reviewed_at?new Date(Ze.reviewed_at).getTime():NaN;if(!(!Number.isFinite(jt)||jt<Tt)){try{Z==null||Z({silent:!0}),ie({silent:!0})}catch{}alert("IQAC approved the mark-manager edit request. You can now edit mark-manager settings.");return}}else if((Ze==null?void 0:Ze.status)==="REJECTED"){const jt=Ze.reviewed_at?new Date(Ze.reviewed_at).getTime():NaN;if(!(!Number.isFinite(jt)||jt<Tt)){alert("IQAC rejected the mark-manager edit request.");return}}}}catch{try{const Ze=await l1(i,String(e),"MARK_MANAGER",t),jt=Ze!=null&&Ze.approval_until?String(Ze.approval_until):null;if(Ze!=null&&Ze.allowed_by_approval&&jt&&jt!==Ht){try{Z==null||Z({silent:!0}),ie({silent:!0})}catch{}alert("IQAC approved the mark-manager edit request. You can now edit mark-manager settings.");return}}catch{}}await new Promise(ze=>setTimeout(ze,Gt))}alert("Edit request still pending. Please try again later.")})()}catch(it){const bt=ll(it,"Request failed");alert(`Edit request failed: ${bt}`)}finally{ct(!1)}}x.useEffect(()=>{if(!e||!R.current)return;let Je=!1;const Ht=setTimeout(async()=>{try{await Fi(i,e,{sheet:re,partBtl:y});try{xt&&Kn(xt,{termLabel:re.termLabel,batchLabel:re.batchLabel,rowsByStudentId:re.rowsByStudentId})}catch{}Je||A(new Date().toLocaleString())}catch{}},700);return()=>{Je=!0,clearTimeout(Ht)}},[y,e,i,re,xt]),x.useEffect(()=>{let Je=!0;return R.current=!1,(async()=>{if(e){try{const Ht=await ri(i,e);if(!Je)return;const it=Ht==null?void 0:Ht.draft,bt=it==null?void 0:it.sheet,_t=it==null?void 0:it.partBtl,Tt=it==null?void 0:it.selectedBtls;if(bt&&typeof bt=="object"&&typeof bt.rowsByStudentId=="object"){T({termLabel:String(bt.termLabel||se||"KRCT AY25-26"),batchLabel:String(e),rowsByStudentId:bt.rowsByStudentId||{},markManagerLocked:typeof bt.markManagerLocked=="boolean"?bt.markManagerLocked:!!bt.markManagerSnapshot,markManagerSnapshot:bt.markManagerSnapshot??null,markManagerApprovalUntil:bt.markManagerApprovalUntil??null});try{xt&&Kn(xt,{termLabel:String(bt.termLabel||se||"KRCT AY25-26"),batchLabel:String(e),rowsByStudentId:bt.rowsByStudentId||{}})}catch{}}if(_t&&typeof _t=="object"){const Dt={};for(const Gt of Object.keys(y)){const $t=_t[Gt];Dt[Gt]=$t===""||$t==null?"":Number($t),Dt[Gt]===""||Number.isFinite(Dt[Gt])&&Dt[Gt]>=1&&Dt[Gt]<=6||(Dt[Gt]="")}b(Dt);try{const Gt=`${i}_part_btl_${e}`;Kn(Gt,Dt)}catch{}}else if(Array.isArray(Tt)){const Dt=$t=>Number.isFinite($t)&&$t>=1&&$t<=6,Gt=Tt.map($t=>Number($t)).filter(Dt);if(Gt.length===1){const $t={skill1:Gt[0],skill2:Gt[0],att1:Gt[0],att2:Gt[0]};b($t);try{const ze=`${i}_part_btl_${e}`;Kn(ze,$t)}catch{}}else if(Gt.length>=2){const $t={skill1:Gt[0],skill2:Gt[1],att1:Gt[0],att2:Gt[1]};b($t);try{const ze=`${i}_part_btl_${e}`;Kn(ze,$t)}catch{}}}}catch{}Je&&(R.current=!0)}})(),()=>{Je=!1}},[e,se,i,xt]),x.useEffect(()=>{let Je=!0;return(async()=>{if(e){u(!0),f(null);try{let it=[],bt=null;try{const $t=await hc();console.log("[Formative] My TAs:",$t==null?void 0:$t.length,"for subject:",e,"teachingAssignmentId:",t),bt=($t||[]).find(ze=>{const Ze=String(ze.subject_code||"").trim().toUpperCase()===String(e||"").trim().toUpperCase();return(t?ze.id===t:!1)||Ze}),bt?console.log("[Formative] Found TA match:",bt.id,"elective_subject_id:",bt.elective_subject_id,"section_id:",bt.section_id):console.log("[Formative] No TA match found in user TAs")}catch($t){console.warn("[Formative] My TAs fetch failed:",$t)}if(bt&&bt.elective_subject_id&&!bt.section_id){console.log("[Formative] Detected elective, fetching elective-choices for elective_subject_id:",bt.elective_subject_id);try{const $t=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(bt.elective_subject_id))}`);if($t.ok){const ze=await $t.json(),Ze=Array.isArray(ze.results)?ze.results:Array.isArray(ze)?ze:ze.items||[];console.log("[Formative] Elective choices returned:",Ze==null?void 0:Ze.length,"students"),it=(Ze||[]).map(jt=>({id:Number(jt.student_id??jt.id),reg_no:String(jt.reg_no??jt.regno??""),name:String(jt.name??jt.full_name??jt.username??""),section:jt.section_name??jt.section??null})).filter(jt=>Number.isFinite(jt.id)),Je&&g({subject_name:bt.subject_name,section:bt.section_name||"Elective"})}else console.warn("[Formative] Elective-choices API returned error:",$t.status)}catch($t){console.warn("[Formative] Elective-choices fetch failed:",$t)}}if(!it.length&&bt&&bt.id){console.log("[Formative] Fetching regular TA roster for TA ID:",bt.id);try{it=((await pc(bt.id)).students||[]).map(ze=>({id:Number(ze.id),reg_no:String(ze.reg_no??""),name:String(ze.name??""),section:ze.section??null})).filter(ze=>Number.isFinite(ze.id)),console.log("[Formative] Regular roster returned:",it.length,"students"),Je&&g({subject_name:bt.subject_name,section:bt.section_name})}catch($t){console.warn("[Formative] TA roster fetch failed:",$t)}}console.log("[Formative] Final roster count:",it.length),it.sort(Sxe),Je&&p(it);let _t=null;try{const $t=await v0(i,e);$t&&$t.marks&&typeof $t.marks=="object"&&Object.keys($t.marks||{}).length&&(_t=$t.marks,B(new Date().toLocaleString()))}catch{}const Tt=xt?Zn(xt):null,Dt=_t?{termLabel:K!=null&&K.termLabel?String(K.termLabel):se||"KRCT AY25-26",batchLabel:String(e||""),rowsByStudentId:Object.fromEntries(Object.entries(_t).map(([$t,ze])=>[$t,{studentId:Number($t),skill1:ds(ze==null?void 0:ze.skill1),skill2:ds(ze==null?void 0:ze.skill2),att1:ds(ze==null?void 0:ze.att1),att2:ds(ze==null?void 0:ze.att2)}]))}:Tt&&typeof Tt=="object"?{termLabel:K!=null&&K.termLabel?String(K.termLabel):String(Tt.termLabel||"KRCT AY25-26"),batchLabel:String(e||Tt.batchLabel||""),rowsByStudentId:Tt.rowsByStudentId&&typeof Tt.rowsByStudentId=="object"?Tt.rowsByStudentId:{}}:{termLabel:se||"KRCT AY25-26",batchLabel:String(e||""),rowsByStudentId:{}},Gt={...Dt.rowsByStudentId};for(const $t of it){const ze=String($t.id),Ze=Gt[ze];Gt[ze]={studentId:$t.id,skill1:typeof(Ze==null?void 0:Ze.skill1)=="number"?Dn(Number(Ze==null?void 0:Ze.skill1),0,J):"",skill2:typeof(Ze==null?void 0:Ze.skill2)=="number"?Dn(Number(Ze==null?void 0:Ze.skill2),0,J):"",att1:typeof(Ze==null?void 0:Ze.att1)=="number"?Dn(Number(Ze==null?void 0:Ze.att1),0,J):"",att2:typeof(Ze==null?void 0:Ze.att2)=="number"?Dn(Number(Ze==null?void 0:Ze.att2),0,J):""}}T({...Dt,termLabel:Dt.termLabel||se,batchLabel:String(e||Dt.batchLabel||""),rowsByStudentId:Gt})}catch(it){if(!Je)return;f((it==null?void 0:it.message)||`Failed to load ${s} roster`),p([])}finally{Je&&u(!1)}}})(),()=>{Je=!1}},[e,xt,K,se,J,s]);const yr=(Je,Ht)=>{we||be||T(it=>{const bt=String(Je),Tt={...it.rowsByStudentId[bt]||{studentId:Je,skill1:"",skill2:"",att1:"",att2:""},...Ht,studentId:Je},Dt=Gt=>{if(Gt===""||Gt==null)return"";const $t=Number(Gt),ze=Number.isFinite($t)?Math.round($t):NaN,Ze=Dn(ze,0,J);return Number.isFinite(Ze)?Ze:""};return{...it,rowsByStudentId:{...it.rowsByStudentId,[bt]:{...Tt,skill1:Dt(Tt.skill1),skill2:Dt(Tt.skill2),att1:Dt(Tt.att1),att2:Dt(Tt.att2)}}}})},Br=async()=>{if(e){w(!0),f(null);try{await Fi(i,e,{sheet:re,partBtl:y}),A(new Date().toLocaleString())}catch(Je){f((Je==null?void 0:Je.message)||`Failed to save ${s} draft`)}finally{w(!1)}}},cr=x.useRef(re);cr.current=re;const ur=x.useRef(y);ur.current=y,x.useEffect(()=>{const Je=()=>{if(!e||h.length===0)return;const Ht={sheet:cr.current,partBtl:ur.current};Fi(i,e,Ht).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",Je),()=>window.removeEventListener("obe:before-tab-switch",Je)},[e,i,h.length]);const en=async()=>{if(!e)return;if(C){f("Publishing is locked by IQAC.");return}if(!ae){f("Publish window is closed. Please request IQAC approval.");return}if(_e&&be){if(At){f("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}mn(!0);return}j(!0),f(null);const Je=M,Ht=re.markManagerLocked,it=je,bt={markEntryApprovalUntil:We,markManagerApprovalUntil:Pt};try{B(new Date().toLocaleString()),Le(bt),T(_t=>({..._t,markManagerLocked:!0})),await L9(i,e,re,t),ee(),ie({silent:!0}),Ve(!0);try{window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:i}}))}catch{}}catch(_t){const Tt=String((_t==null?void 0:_t.message)||"");Tt.includes("locked after publish")||Tt.includes("Marks entry is locked")?(B(new Date().toLocaleString()),Le(bt),T(Dt=>({...Dt,markManagerLocked:!0})),f(null)):(B(Je??null),T(Dt=>({...Dt,markManagerLocked:Ht})),Le(it??null),f(Tt||`Failed to publish ${s}`))}finally{try{if(e){const _t=await bS(i,String(e),t);_t!=null&&_t.exists&&(_t!=null&&_t.is_published)&&(B(new Date().toLocaleString()),T(Tt=>({...Tt,markManagerLocked:!0})),Le(Tt=>Tt??bt),Ve(!0),ie({silent:!0}),ee(),f(null))}}catch{}j(!1)}},nn=()=>{if(!e)return;const Je=h.map((Ht,it)=>{const bt=re.rowsByStudentId[String(Ht.id)]||{studentId:Ht.id,skill1:"",skill2:"",att1:"",att2:""},_t=typeof bt.skill1=="number"?Dn(Number(bt.skill1),0,J):null,Tt=typeof bt.skill2=="number"?Dn(Number(bt.skill2),0,J):null,Dt=typeof bt.att1=="number"?Dn(Number(bt.att1),0,J):null,Gt=typeof bt.att2=="number"?Dn(Number(bt.att2),0,J):null,$t=_t!=null&&Tt!=null&&Dt!=null&&Gt!=null?Dn(_t+Tt+Dt+Gt,0,pe):"",ze=_t!=null&&Dt!=null?Dn(_t+Dt,0,xe):"",Ze=Tt!=null&&Gt!=null?Dn(Tt+Gt,0,xe):"",jt=[0,0,0,0,0,0];for(const Kt of Vt){const ye=y[Kt.key];(ye===1||ye===2||ye===3||ye===4||ye===5||ye===6)&&(jt[ye-1]+=Kt.max)}const Bt=qt.map(Kt=>Kt-1),gr=typeof $t=="number"&&Bt.length?_c($t/Bt.length):"",dr=jt.map((Kt,ye)=>gr===""||!Bt.includes(ye)?"":Kt>0?Dn(gr,0,Kt):_c(gr));return{sno:it+1,registerNo:Ht.reg_no,name:Ht.name,skill1:_t??"",skill2:Tt??"",att1:Dt??"",att2:Gt??"",total:$t===""?"":$t,[`co${o}_mark`]:ze===""?"":ze,[`co${o}_pct`]:ze===""?"":Na(ze,xe),[`co${l}_mark`]:Ze===""?"":Ze,[`co${l}_pct`]:Ze===""?"":Na(Ze,xe),btl1_mark:dr[0]??"",btl1_pct:dr[0]===""?"":Na(Number(dr[0]),jt[0]),btl2_mark:dr[1]??"",btl2_pct:dr[1]===""?"":Na(Number(dr[1]),jt[1]),btl3_mark:dr[2]??"",btl3_pct:dr[2]===""?"":Na(Number(dr[2]),jt[2]),btl4_mark:dr[3]??"",btl4_pct:dr[3]===""?"":Na(Number(dr[3]),jt[3]),btl5_mark:dr[4]??"",btl5_pct:dr[4]===""?"":Na(Number(dr[4]),jt[4]),btl6_mark:dr[5]??"",btl6_pct:dr[5]===""?"":Na(Number(dr[5]),jt[5])}});jxe(`${e}_${i.toUpperCase()}_sheet.csv`,Je)},gn=async()=>{if(!e)return;const Je=h.map((Ht,it)=>{const bt=re.rowsByStudentId[String(Ht.id)]||{studentId:Ht.id,skill1:"",skill2:"",att1:"",att2:""},_t=typeof bt.skill1=="number"?Dn(Number(bt.skill1),0,J):null,Tt=typeof bt.skill2=="number"?Dn(Number(bt.skill2),0,J):null,Dt=typeof bt.att1=="number"?Dn(Number(bt.att1),0,J):null,Gt=typeof bt.att2=="number"?Dn(Number(bt.att2),0,J):null,$t=_t!=null&&Tt!=null&&Dt!=null&&Gt!=null?Dn(_t+Tt+Dt+Gt,0,pe):"";return{sno:it+1,regNo:String(Ht.reg_no||""),name:String(Ht.name||""),total:$t===""?"":$t}});await fy({filenameBase:`${e}_${s}`,meta:{courseName:String((m==null?void 0:m.subject_name)||""),courseCode:String(e||""),className:String((m==null?void 0:m.section)||"")},rows:Je})};function nr(Je){return String(Je??"").trim().toLowerCase().replace(/\s+/g," ")}const Tr=()=>{if(!e||!h.length)return;const Je=Tt=>`${Tt} (${Number(J).toFixed(2)})`,Ht=["Register No","Student Name",Je("Skill 1"),Je("Skill 2"),Je("Attitude 1"),Je("Attitude 2"),"Status"],it=h.map(Tt=>{const Dt=re.rowsByStudentId[String(Tt.id)];return[Tt.reg_no,Tt.name,(Dt==null?void 0:Dt.skill1)??"",(Dt==null?void 0:Dt.skill2)??"",(Dt==null?void 0:Dt.att1)??"",(Dt==null?void 0:Dt.att2)??"","present"]}),bt=bs.aoa_to_sheet([Ht,...it]);bt["!freeze"]={xSplit:0,ySplit:1};const _t=bs.book_new();bs.book_append_sheet(_t,bt,s),uy(_t,`${e}_${i.toUpperCase()}_template.xlsx`)},Dr=()=>{var Je;we||be||(Je=U.current)==null||Je.click()},Rr=async Je=>{var Ht;if(e&&!(we||be)){H(!0);try{const it=await Je.arrayBuffer(),bt=C0(it,{type:"array"}),_t=(Ht=bt.SheetNames)==null?void 0:Ht[0];if(!_t)throw new Error("No sheet found in the Excel file.");const Tt=bt.Sheets[_t],Dt=bs.sheet_to_json(Tt,{header:1});if(!Dt.length)throw new Error("Excel sheet is empty.");const Gt=(Dt[0]||[]).map(nr),$t=Ce=>Gt.findIndex($e=>Ce($e)),ze=$t(Ce=>Ce==="register no"||Ce==="reg no"||Ce.includes("register")),Ze=$t(Ce=>Ce.startsWith("skill 1")||Ce.startsWith("skill1")),jt=$t(Ce=>Ce.startsWith("skill 2")||Ce.startsWith("skill2")),Bt=$t(Ce=>Ce.startsWith("attitude 1")||Ce.startsWith("att1")||Ce.startsWith("attitude1")),gr=$t(Ce=>Ce.startsWith("attitude 2")||Ce.startsWith("att2")||Ce.startsWith("attitude2")),dr=$t(Ce=>Ce==="status"||Ce.includes("status"));if(ze<0)throw new Error("Could not find Register No column.");const Kt=new Map;for(const Ce of h){const $e=String(Ce.reg_no||"").trim();$e&&Kt.set($e,Ce.id);const ft=wp($e);ft&&Kt.set(ft,Ce.id)}const ye=Ce=>Ce==null||!Number.isFinite(Ce)||Ce<=0?"":Dn(Number(Ce),1,J);T(Ce=>{const $e={...Ce.rowsByStudentId};for(let ft=1;ft<Dt.length;ft++){const Sr=Dt[ft]||[],at=String(Sr[ze]??"").trim();if(!at)continue;const Ut=Kt.get(at);if(!Ut)continue;const Ue=(dr>=0?String(Sr[dr]??""):"").trim().toLowerCase(),Ct=Ue==="absent"||Ue==="ab"||Ue==="a",gt=$e[String(Ut)]||{studentId:Ut,skill1:"",skill2:"",att1:"",att2:""};if(Ct){$e[String(Ut)]={...gt,skill1:"",skill2:"",att1:"",att2:""};continue}const yt=Ze>=0?ye(Wb(Sr[Ze])):gt.skill1,mt=jt>=0?ye(Wb(Sr[jt])):gt.skill2,tr=Bt>=0?ye(Wb(Sr[Bt])):gt.att1,lr=gr>=0?ye(Wb(Sr[gr])):gt.att2;$e[String(Ut)]={...gt,studentId:Ut,skill1:yt,skill2:mt,att1:tr,att2:lr}}return{...Ce,rowsByStudentId:$e}})}finally{H(!1)}}},tt=async Je=>{var it;const Ht=(it=Je.target.files)==null?void 0:it[0];if(Je.target.value="",!!Ht)try{await Rr(Ht)}catch(bt){f((bt==null?void 0:bt.message)||"Failed to import Excel")}};if(!e)return a.jsxs("div",{style:{color:"#6b7280"},children:["Select a course to start ",s," entry."]});if(c)return a.jsxs("div",{style:{color:"#6b7280"},children:["Loading ",s," roster"]});const Xe={border:"1px solid #111",padding:"6px 6px",background:"#ecfdf5",color:"#065f46",textAlign:"center",fontWeight:700,fontSize:12,whiteSpace:"nowrap"},ot={border:"1px solid #111",padding:"6px 6px",fontSize:12,whiteSpace:"nowrap"},Wt={width:"100%",border:"none",outline:"none",background:"transparent",fontSize:12,textAlign:"center"};return a.jsxs(X0,{children:[d&&a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10},children:d}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",marginBottom:10},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{onClick:nn,className:"obe-btn obe-btn-secondary",disabled:h.length===0,children:"Export CSV"}),a.jsx("button",{onClick:Tr,className:"obe-btn obe-btn-secondary",disabled:h.length===0,children:"Export Excel"}),a.jsx("button",{onClick:Dr,className:"obe-btn obe-btn-secondary",disabled:h.length===0||we||be||G,children:G?"Importing":"Import Excel"}),a.jsx("input",{ref:U,type:"file",accept:".xlsx,.xls",style:{display:"none"},onChange:tt})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:gn,className:"obe-btn obe-btn-secondary",disabled:h.length===0,children:"Download"}),a.jsx("button",{onClick:Br,className:"obe-btn obe-btn-success",disabled:v||h.length===0,children:v?"Saving":"Save Draft"}),a.jsx("button",{onClick:en,disabled:ce?At:S||h.length===0||!ae||C,className:"obe-btn obe-btn-primary",children:ce?At?"Request Pending":"Request Edit":S?"Publishing":"Publish"}),k&&a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Draft: ",k]}),M&&a.jsxs("div",{style:{fontSize:12,color:"#16a34a",alignSelf:"center"},children:["Published: ",M]})]})]}),a.jsx("div",{style:{marginBottom:10,fontSize:12,color:ae?"#065f46":"#b91c1c"},children:de?"Checking publish due time":W||(oe!=null&&oe.due_at?a.jsxs(a.Fragment,{children:["Due: ",new Date(oe.due_at).toLocaleString(),"  Remaining: ",sg(V),oe.allowed_by_approval&&oe.approval_until?a.jsxs(a.Fragment,{children:["  Approved until ",new Date(oe.approval_until).toLocaleString()]}):null]}):"Due time not set by IQAC.")}),C?a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),a.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:a.jsx("button",{className:"obe-btn",onClick:()=>ee(),disabled:de,children:"Refresh"})})]}):null,a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff",marginBottom:10},children:a.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[a.jsxs("label",{style:{fontSize:12,color:"#374151",display:"flex",alignItems:"center"},children:["Term",a.jsx("div",{style:{marginLeft:8,padding:6,border:"1px solid #d1d5db",borderRadius:8,minWidth:160},children:re.termLabel})]}),a.jsxs("label",{style:{fontSize:12,color:"#374151",display:"flex",alignItems:"center"},children:["Sheet Label",a.jsx("div",{style:{marginLeft:8,padding:6,border:"1px solid #d1d5db",borderRadius:8,minWidth:160},children:re.batchLabel})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Skill/Attitude max: ",J," each | Total: ",pe," | CO-",o,": ",xe," | CO-",l,": ",xe]})]})}),h.length===0?a.jsx("div",{style:{color:"#6b7280",fontSize:14,padding:"12px 0"},children:"No students found for this subject."}):a.jsx(og,{locked:C,children:ht?E&&_e?a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10,position:"relative"},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Only"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280",marginRight:36},children:[s,"  ",String(e||"")]}),a.jsx("button",{className:"obe-btn",onClick:()=>P(!1),style:{position:"absolute",right:0,top:0},children:"Close"})]}),Ur?a.jsx("div",{style:{color:"#6b7280"},children:"Loading published marks"}):null,cn?a.jsx("div",{style:{color:"#991b1b",fontSize:12,marginBottom:8},children:cn}):null,Nt&&Object.keys(Nt).length||h.length?a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{className:"obe-table",style:{width:"max-content",minWidth:"100%",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:Xe,colSpan:zt,children:[re.termLabel," | ",re.batchLabel," | ",s.toUpperCase()," (PUBLISHED)"]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...Xe,width:42,minWidth:42},children:"S.No"}),a.jsx("th",{style:Xe,children:"Register No."}),a.jsx("th",{style:Xe,children:"Name of the Students"}),a.jsx("th",{style:Xe,children:"Skill 1"}),a.jsx("th",{style:Xe,children:"Skill 2"}),a.jsx("th",{style:Xe,children:"Att 1"}),a.jsx("th",{style:Xe,children:"Att 2"}),a.jsx("th",{style:Xe,children:"Total"}),a.jsxs("th",{style:Xe,colSpan:2,children:["CO-",o]}),a.jsxs("th",{style:Xe,colSpan:2,children:["CO-",l]}),qt.map(Je=>a.jsxs("th",{style:Xe,colSpan:2,children:["BTL-",Je]},`pv_btl_${Je}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:Xe}),a.jsx("th",{style:Xe}),a.jsx("th",{style:Xe}),a.jsx("th",{style:Xe}),a.jsx("th",{style:Xe}),a.jsx("th",{style:Xe}),a.jsx("th",{style:Xe}),a.jsx("th",{style:Xe}),a.jsx("th",{style:Xe,children:"Mark"}),a.jsx("th",{style:Xe,children:"%"}),a.jsx("th",{style:Xe,children:"Mark"}),a.jsx("th",{style:Xe,children:"%"}),qt.map(Je=>a.jsxs(sn.Fragment,{children:[a.jsx("th",{style:Xe,children:"Mark"}),a.jsx("th",{style:Xe,children:"%"})]},`pv_btl_sub_${Je}`))]})]}),a.jsx("tbody",{children:h.length?h.map((Je,Ht)=>{const it=Nt&&Nt[String(Je.id)]||{},bt=typeof it.skill1=="number"?Dn(Number(it.skill1),1,J):ds(it.skill1),_t=typeof it.skill2=="number"?Dn(Number(it.skill2),1,J):ds(it.skill2),Tt=typeof it.att1=="number"?Dn(Number(it.att1),1,J):ds(it.att1),Dt=typeof it.att2=="number"?Dn(Number(it.att2),1,J):ds(it.att2),Gt=bt!==""&&_t!==""&&Tt!==""&&Dt!==""?Dn(bt+_t+Tt+Dt,0,pe):"",$t=bt!==""&&Tt!==""?Dn(bt+Tt,0,xe):"",ze=_t!==""&&Dt!==""?Dn(_t+Dt,0,xe):"",Ze=[0,0,0,0,0,0];for(const dr of Vt){const Kt=St[dr.key];(Kt===1||Kt===2||Kt===3||Kt===4||Kt===5||Kt===6)&&(Ze[Kt-1]+=dr.max)}const jt=qt.map(dr=>dr-1),Bt=typeof Gt=="number"&&jt.length?_c(Gt/jt.length):"",gr=Ze.map((dr,Kt)=>Bt===""||!jt.includes(Kt)?"":dr>0?Dn(Bt,0,dr):_c(Bt));return a.jsxs("tr",{children:[a.jsx("td",{style:{...ot,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Ht+1}),a.jsx("td",{style:ot,children:wp(Je.reg_no)}),a.jsx("td",{style:ot,children:Je.name||""}),a.jsx("td",{style:{...ot,textAlign:"center"},children:bt}),a.jsx("td",{style:{...ot,textAlign:"center"},children:_t}),a.jsx("td",{style:{...ot,textAlign:"center"},children:Tt}),a.jsx("td",{style:{...ot,textAlign:"center"},children:Dt}),a.jsx("td",{style:{...ot,textAlign:"center",fontWeight:700},children:Gt}),a.jsx("td",{style:{...ot,textAlign:"center"},children:$t}),a.jsx("td",{style:{...ot,textAlign:"center"},children:$t===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na($t,xe)})}),a.jsx("td",{style:{...ot,textAlign:"center"},children:ze}),a.jsx("td",{style:{...ot,textAlign:"center"},children:ze===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(ze,xe)})}),qt.map(dr=>{const Kt=dr-1,ye=gr[Kt],Ce=Ze[Kt]??0;return a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...ot,textAlign:"center"},children:ye}),a.jsx("td",{style:{...ot,textAlign:"center"},children:ye===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(Number(ye),Ce)})})]},`pv_btl_cells_${Je.id}_${dr}`)})]},`pv_${Je.id}`)}):Object.keys(Nt||{}).map((Je,Ht)=>{const it=Nt[Je]||{},bt=typeof it.skill1=="number"?Dn(Number(it.skill1),1,J):ds(it.skill1),_t=typeof it.skill2=="number"?Dn(Number(it.skill2),1,J):ds(it.skill2),Tt=typeof it.att1=="number"?Dn(Number(it.att1),1,J):ds(it.att1),Dt=typeof it.att2=="number"?Dn(Number(it.att2),1,J):ds(it.att2),Gt=bt!==""&&_t!==""&&Tt!==""&&Dt!==""?Dn(bt+_t+Tt+Dt,0,pe):"",$t=bt!==""&&Tt!==""?Dn(bt+Tt,0,xe):"",ze=_t!==""&&Dt!==""?Dn(_t+Dt,0,xe):"",Ze=[0,0,0,0,0,0];for(const dr of Vt){const Kt=St[dr.key];(Kt===1||Kt===2||Kt===3||Kt===4||Kt===5||Kt===6)&&(Ze[Kt-1]+=dr.max)}const jt=qt.map(dr=>dr-1),Bt=typeof Gt=="number"&&jt.length?_c(Gt/jt.length):"",gr=Ze.map((dr,Kt)=>Bt===""||!jt.includes(Kt)?"":dr>0?Dn(Bt,0,dr):_c(Bt));return a.jsxs("tr",{children:[a.jsx("td",{style:{...ot,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Ht+1}),a.jsx("td",{style:ot,children:wp(String(it.reg_no??Je))}),a.jsx("td",{style:ot,children:it.name||""}),a.jsx("td",{style:{...ot,textAlign:"center"},children:bt}),a.jsx("td",{style:{...ot,textAlign:"center"},children:_t}),a.jsx("td",{style:{...ot,textAlign:"center"},children:Tt}),a.jsx("td",{style:{...ot,textAlign:"center"},children:Dt}),a.jsx("td",{style:{...ot,textAlign:"center",fontWeight:700},children:Gt}),a.jsx("td",{style:{...ot,textAlign:"center"},children:$t}),a.jsx("td",{style:{...ot,textAlign:"center"},children:$t===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na($t,xe)})}),a.jsx("td",{style:{...ot,textAlign:"center"},children:ze}),a.jsx("td",{style:{...ot,textAlign:"center"},children:ze===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(ze,xe)})}),qt.map(dr=>{const Kt=dr-1,ye=gr[Kt],Ce=Ze[Kt]??0;return a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...ot,textAlign:"center"},children:ye}),a.jsx("td",{style:{...ot,textAlign:"center"},children:ye===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(Number(ye),Ce)})})]},`pv_btl_cells_${Je}_${dr}`)})]},`pv_${Je}`)})})]})}):Ur?null:a.jsx("div",{style:{color:"#6b7280"},children:"No published marks found."}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{className:"obe-btn",onClick:()=>P(!1),children:"Close"})})]}):a.jsxs("div",{className:"obe-table-wrapper",style:{position:"relative"},children:[a.jsxs("table",{className:"obe-table",style:{minWidth:1200,pointerEvents:ke?"none":"auto"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:Xe,colSpan:zt,children:[re.termLabel," | ",re.batchLabel," | ",s.toUpperCase()]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...Xe,width:42,minWidth:42},rowSpan:3,children:"S.No"}),a.jsx("th",{style:Xe,rowSpan:3,children:"Register No."}),a.jsx("th",{style:Xe,rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:Xe,colSpan:2,children:"Skill"}),a.jsx("th",{style:Xe,colSpan:2,children:"Attitude"}),a.jsx("th",{style:Xe,rowSpan:3,children:"Total"}),a.jsx("th",{style:Xe,colSpan:4,children:"CIA 1"}),qt.length?a.jsx("th",{style:Xe,colSpan:qt.length*2,children:"BTL"}):null]}),a.jsxs("tr",{children:[a.jsx("th",{style:Xe,children:"1"}),a.jsx("th",{style:Xe,children:"2"}),a.jsx("th",{style:Xe,children:"1"}),a.jsx("th",{style:Xe,children:"2"}),a.jsxs("th",{style:Xe,colSpan:2,children:["CO-",o]}),a.jsxs("th",{style:Xe,colSpan:2,children:["CO-",l]}),qt.map(Je=>a.jsxs("th",{style:Xe,colSpan:2,children:["BTL-",Je]},`btlhead-${Je}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:Xe}),a.jsx("th",{style:Xe}),a.jsx("th",{style:Xe}),a.jsx("th",{style:Xe}),a.jsx("th",{style:Xe,children:"Mark"}),a.jsx("th",{style:Xe,children:"%"}),a.jsx("th",{style:Xe,children:"Mark"}),a.jsx("th",{style:Xe,children:"%"}),qt.map(Je=>a.jsxs(sn.Fragment,{children:[a.jsx("th",{style:Xe,children:"Mark"}),a.jsx("th",{style:Xe,children:"%"})]},`btl-sub-${Je}`))]})]}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...ot,fontWeight:700,textAlign:"center"}}),a.jsx("td",{style:{...ot,fontWeight:700,textAlign:"center"}}),a.jsx("td",{style:{...ot,fontWeight:700,textAlign:"center"},children:"BTL"}),Vt.map(Je=>a.jsx("td",{style:{...ot,textAlign:"center"},children:(()=>{const Ht=y[Je.key]??"",it=Ht===""?"-":String(Ht);return a.jsxs("div",{style:{position:"relative",minWidth:44},children:[a.jsx("div",{style:{width:"100%",fontSize:12,padding:"2px 4px",border:"1px solid #d1d5db",borderRadius:8,background:"#fff",textAlign:"center",userSelect:"none"},title:`BTL: ${it}`,children:it}),a.jsxs("select",{"aria-label":`BTL for ${Je.label}`,value:Ht,onChange:bt=>{if(C)return;const _t=re.markManagerSnapshot!=null;He&&_t||be||b(Tt=>({...Tt||{},[Je.key]:bt.target.value===""?"":Number(bt.target.value)}))},style:{position:"absolute",inset:0,width:"100%",height:"100%",opacity:0,cursor:"pointer",appearance:"none",WebkitAppearance:"none",MozAppearance:"none"},children:[a.jsx("option",{value:"",children:"-"}),[1,2,3,4,5,6].map(bt=>a.jsx("option",{value:bt,children:bt},bt))]})]})})()},`btl-select-${Je.key}`)),a.jsx("td",{style:{...ot,fontWeight:700,textAlign:"center"}}),a.jsx("td",{style:{...ot,fontWeight:700,textAlign:"center"},colSpan:4}),qt.map(Je=>a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...ot,fontWeight:700,textAlign:"center"}}),a.jsx("td",{style:{...ot,fontWeight:700,textAlign:"center"}})]},`btl-pad-${Je}`))]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...ot,fontWeight:700,textAlign:"center"},colSpan:3,children:"Name / Max Marks"}),a.jsx("td",{style:{...ot,fontWeight:700,textAlign:"center"},children:J}),a.jsx("td",{style:{...ot,fontWeight:700,textAlign:"center"},children:J}),a.jsx("td",{style:{...ot,fontWeight:700,textAlign:"center"},children:J}),a.jsx("td",{style:{...ot,fontWeight:700,textAlign:"center"},children:J}),a.jsx("td",{style:{...ot,fontWeight:700,textAlign:"center"},children:pe}),a.jsx("td",{style:{...ot,fontWeight:700,textAlign:"center"},children:xe}),a.jsx("td",{style:{...ot,fontWeight:700,textAlign:"center"},children:"%"}),a.jsx("td",{style:{...ot,fontWeight:700,textAlign:"center"},children:xe}),a.jsx("td",{style:{...ot,fontWeight:700,textAlign:"center"},children:"%"})]}),h.map((Je,Ht)=>{const it=re.rowsByStudentId[String(Je.id)]||{studentId:Je.id,skill1:"",skill2:"",att1:"",att2:""},bt=typeof it.skill1=="number"?Dn(Number(it.skill1),0,J):"",_t=typeof it.skill2=="number"?Dn(Number(it.skill2),0,J):"",Tt=typeof it.att1=="number"?Dn(Number(it.att1),0,J):"",Dt=typeof it.att2=="number"?Dn(Number(it.att2),0,J):"",Gt=bt!==""&&_t!==""&&Tt!==""&&Dt!==""?Dn(bt+_t+Tt+Dt,0,pe):"",$t=bt!==""&&Tt!==""?Dn(bt+Tt,0,xe):"",ze=_t!==""&&Dt!==""?Dn(_t+Dt,0,xe):"",Ze=[0,0,0,0,0,0];for(const ye of Vt){const Ce=y[ye.key];(Ce===1||Ce===2||Ce===3||Ce===4||Ce===5||Ce===6)&&(Ze[Ce-1]+=ye.max)}const jt=qt.map(ye=>ye-1),Bt=typeof Gt=="number"&&jt.length?_c(Gt/jt.length):"",gr=Ze.map((ye,Ce)=>Bt===""||!jt.includes(Ce)?"":ye>0?Dn(Bt,0,ye):_c(Bt)),Kt=qt.length===0||we||be||C;return a.jsxs("tr",{children:[a.jsx("td",{style:{...ot,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Ht+1}),a.jsx("td",{style:ot,children:wp(Je.reg_no)}),a.jsx("td",{style:ot,children:Je.name||""}),a.jsx("td",{style:ot,children:a.jsx("input",{style:Wt,type:"number",min:0,max:J,value:it.skill1===""?"":it.skill1,disabled:Kt,onChange:ye=>{const Ce=ye.target.value;if(Ce==="")return ye.currentTarget.setCustomValidity(""),yr(Je.id,{skill1:""});const $e=Number(Ce);if(Number.isFinite($e)){if($e>J){ye.currentTarget.setCustomValidity(`Max mark is ${J}`),ye.currentTarget.reportValidity(),window.setTimeout(()=>ye.currentTarget.setCustomValidity(""),0);return}ye.currentTarget.setCustomValidity(""),yr(Je.id,{skill1:$e})}}})}),a.jsx("td",{style:ot,children:a.jsx("input",{style:Wt,type:"number",min:0,max:J,value:it.skill2===""?"":it.skill2,disabled:Kt,onChange:ye=>{const Ce=ye.target.value;if(Ce==="")return ye.currentTarget.setCustomValidity(""),yr(Je.id,{skill2:""});const $e=Number(Ce);if(Number.isFinite($e)){if($e>J){ye.currentTarget.setCustomValidity(`Max mark is ${J}`),ye.currentTarget.reportValidity(),window.setTimeout(()=>ye.currentTarget.setCustomValidity(""),0);return}ye.currentTarget.setCustomValidity(""),yr(Je.id,{skill2:$e})}}})}),a.jsx("td",{style:ot,children:a.jsx("input",{style:Wt,type:"number",min:0,max:J,value:it.att1===""?"":it.att1,disabled:Kt,onChange:ye=>{const Ce=ye.target.value;if(Ce==="")return ye.currentTarget.setCustomValidity(""),yr(Je.id,{att1:""});const $e=Number(Ce);if(Number.isFinite($e)){if($e>J){ye.currentTarget.setCustomValidity(`Max mark is ${J}`),ye.currentTarget.reportValidity(),window.setTimeout(()=>ye.currentTarget.setCustomValidity(""),0);return}ye.currentTarget.setCustomValidity(""),yr(Je.id,{att1:$e})}}})}),a.jsx("td",{style:ot,children:a.jsx("input",{style:Wt,type:"number",min:0,max:J,value:it.att2===""?"":it.att2,disabled:Kt,onChange:ye=>{const Ce=ye.target.value;if(Ce==="")return ye.currentTarget.setCustomValidity(""),yr(Je.id,{att2:""});const $e=Number(Ce);if(Number.isFinite($e)){if($e>J){ye.currentTarget.setCustomValidity(`Max mark is ${J}`),ye.currentTarget.reportValidity(),window.setTimeout(()=>ye.currentTarget.setCustomValidity(""),0);return}ye.currentTarget.setCustomValidity(""),yr(Je.id,{att2:$e})}}})}),a.jsx("td",{style:{...ot,textAlign:"center",fontWeight:700},children:Gt}),a.jsx("td",{style:{...ot,textAlign:"center"},children:$t}),a.jsx("td",{style:{...ot,textAlign:"center"},children:$t===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na($t,xe)})}),a.jsx("td",{style:{...ot,textAlign:"center"},children:ze}),a.jsx("td",{style:{...ot,textAlign:"center"},children:ze===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(ze,xe)})}),qt.map(ye=>{const Ce=ye-1,$e=gr[Ce],ft=Ze[Ce]??0;return a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...ot,textAlign:"center"},children:$e}),a.jsx("td",{style:{...ot,textAlign:"center"},children:$e===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(Number($e),ft)})})]},`btl-cells-${ye}`)})]},Je.id)})]})]}),qt.length===0&&a.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(255,255,255,0.85)",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:10,padding:20,borderRadius:6},children:[a.jsx("div",{style:{fontSize:16,fontWeight:700},children:"BTL values not selected"}),a.jsx("div",{style:{color:"#6b7280"},children:"Assign BTL values in the BTL row below Skill/Attitude to enable entry."}),a.jsx("div",{style:{display:"flex",gap:8},children:a.jsx("button",{onClick:()=>{if(C)return;const Je=re.markManagerSnapshot!=null;He&&Je||be||b({skill1:3,skill2:4,att1:3,att2:4})},style:{padding:"6px 10px"},children:"Quick: BTL-3/4"})})]}),we&&!C&&!ke?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(239,246,255,0.65)",border:"1px solid rgba(59,130,246,0.25)",borderRadius:6,pointerEvents:"none"}}),a.jsxs("div",{style:{position:"absolute",left:"50%",top:16,transform:"translateX(-50%)",zIndex:40,width:280,background:"#fff",border:"1px solid #e5e7eb",padding:12,borderRadius:12,boxShadow:"0 6px 18px rgba(17,24,39,0.06)",display:"flex",flexDirection:"column",gap:10,alignItems:"stretch"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:950,color:"#111827"},children:"Table Locked"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:4},children:"Confirm the Mark Manager to unlock the student list."})]}),a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",flexWrap:"wrap"},children:[a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>Ie({mode:"confirm"}),disabled:!e||It,children:"Save Mark Manager"}),a.jsx("button",{className:"obe-btn",onClick:()=>er(),disabled:It,children:"Request Access"})]})]})]}):null,ke&&!C?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{position:"absolute",inset:0,background:"linear-gradient(180deg, rgba(34,197,94,0.18) 0%, rgba(16,185,129,0.26) 100%)",border:"1px solid rgba(22,163,74,0.25)",borderRadius:6,pointerEvents:"none"}}),a.jsxs("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:40,width:320,background:"#fff",border:"1px solid #e5e7eb",padding:12,borderRadius:12,boxShadow:"0 6px 18px rgba(17,24,39,0.06)",display:"flex",flexDirection:"column",gap:10,alignItems:"stretch"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:950,color:"#065f46"},children:"Published  Locked"}),a.jsx("div",{style:{fontSize:12,color:"#065f46",marginTop:4},children:"Marks are published. Use View or Request Edit to ask IQAC for access."})]}),a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",flexWrap:"wrap"},children:[a.jsx("button",{className:"obe-btn",onClick:()=>{P(!0),Jr(null);try{Ve(!1)}catch{}},children:"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:At,onClick:async()=>{if(At){alert("Edit request is pending. Please wait.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}mn(!0)},children:At?"Request Pending":"Request Edit"})]})]})]}):null]}):a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:20,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:900,fontSize:16},children:Mt?"Published  Locked":"Table Locked"}),a.jsx("div",{style:{color:"#6b7280",marginTop:8},children:Mt?"Marks published. Use View or Request Edit to ask IQAC for access.":"Confirm the Mark Manager to unlock the student list."}),a.jsx("div",{style:{display:"flex",gap:8,marginTop:12,justifyContent:"flex-end"},children:Mt?a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn",onClick:()=>{P(!0),Jr(null);try{Ve(!1)}catch{}},children:"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:At,onClick:async()=>{if(At){alert("Edit request is pending. Please wait.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}mn(!0)},children:At?"Request Pending":"Request Edit"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>Ie({mode:"confirm"}),disabled:!e||It,children:"Save Mark Manager"}),a.jsx("button",{className:"obe-btn",onClick:()=>er(),disabled:It,children:"Request Access"})]})})]})}),nt&&!n?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:9999},onClick:()=>{It||Ie(null)},children:a.jsxs("div",{style:{width:"min(640px,96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Je=>Je.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:nt.mode==="confirm"?`Confirmation - ${s}`:`Request Edit - ${s}`}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:String(e||"")})]}),nt.mode==="confirm"?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"Confirm the selected BTL settings. After confirming, Mark Manager will be locked and the table will be editable."}),a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Item"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Value"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"Skill/Attitude max"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:J})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"Total max"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:pe})]}),a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:["CO-",o," max"]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:xe})]}),a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:["CO-",l," max"]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:xe})]}),Vt.map(Je=>a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:[Je.label," BTL"]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:a.jsxs("select",{className:"obe-input","aria-label":`BTL for ${Je.label}`,value:y[Je.key]??"",disabled:It||C||be,onChange:Ht=>{if(C||be)return;const it=Ht.target.value;b(bt=>({...bt||{},[Je.key]:it===""?"":Number(it)}))},style:{minWidth:110},children:[a.jsx("option",{value:"",children:"-"}),[1,2,3,4,5,6].map(Ht=>a.jsx("option",{value:Ht,children:Ht},Ht))]})})]},`mm_${Je.key}`))]})]})})]}):a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. Mark Manager will remain locked until IQAC approves."}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[a.jsx("button",{className:"obe-btn",disabled:It,onClick:()=>Ie(null),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:It||!e,onClick:async()=>{if(e){if(nt.mode==="request"){Ie(null),await er();return}await Lt()}},children:nt.mode==="confirm"?"Confirm":"Send Request"})]})]})})}):null,xr?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>Pr(!1),children:a.jsxs("div",{style:{width:"min(1100px, 96vw)",maxHeight:"90vh",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Je=>Je.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10,position:"relative"},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Only"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280",marginRight:36},children:[s,"  ",String(e||"")]}),a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>Pr(!1),style:{position:"absolute",right:0,top:0},children:"Close"})]}),Ur?a.jsx("div",{style:{color:"#6b7280"},children:"Loading published marks"}):null,cn?a.jsx("div",{style:{color:"#991b1b",fontSize:12,marginBottom:8},children:cn}):null,Nt&&Object.keys(Nt).length||h.length?a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{className:"obe-table",style:{width:"max-content",minWidth:"100%",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:Xe,colSpan:zt,children:[re.termLabel," | ",re.batchLabel," | ",s.toUpperCase()," (PUBLISHED)"]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...Xe,width:42,minWidth:42},children:"S.No"}),a.jsx("th",{style:Xe,children:"Register No."}),a.jsx("th",{style:Xe,children:"Name of the Students"}),a.jsx("th",{style:Xe,children:"Skill 1"}),a.jsx("th",{style:Xe,children:"Skill 2"}),a.jsx("th",{style:Xe,children:"Att 1"}),a.jsx("th",{style:Xe,children:"Att 2"}),a.jsx("th",{style:Xe,children:"Total"}),a.jsxs("th",{style:Xe,colSpan:2,children:["CO-",o]}),a.jsxs("th",{style:Xe,colSpan:2,children:["CO-",l]}),qt.map(Je=>a.jsxs("th",{style:Xe,colSpan:2,children:["BTL-",Je]},`pv_btl_${Je}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:Xe}),a.jsx("th",{style:Xe}),a.jsx("th",{style:Xe}),a.jsx("th",{style:Xe}),a.jsx("th",{style:Xe}),a.jsx("th",{style:Xe}),a.jsx("th",{style:Xe}),a.jsx("th",{style:Xe}),a.jsx("th",{style:Xe,children:"Mark"}),a.jsx("th",{style:Xe,children:"%"}),a.jsx("th",{style:Xe,children:"Mark"}),a.jsx("th",{style:Xe,children:"%"}),qt.map(Je=>a.jsxs(sn.Fragment,{children:[a.jsx("th",{style:Xe,children:"Mark"}),a.jsx("th",{style:Xe,children:"%"})]},`pv_btl_sub_${Je}`))]})]}),a.jsx("tbody",{children:h.length?h.map((Je,Ht)=>{const it=Nt&&Nt[String(Je.id)]||{},bt=typeof it.skill1=="number"?Dn(Number(it.skill1),1,J):ds(it.skill1),_t=typeof it.skill2=="number"?Dn(Number(it.skill2),1,J):ds(it.skill2),Tt=typeof it.att1=="number"?Dn(Number(it.att1),1,J):ds(it.att1),Dt=typeof it.att2=="number"?Dn(Number(it.att2),1,J):ds(it.att2),Gt=bt!==""&&_t!==""&&Tt!==""&&Dt!==""?Dn(bt+_t+Tt+Dt,0,pe):"",$t=bt!==""&&Tt!==""?Dn(bt+Tt,0,xe):"",ze=_t!==""&&Dt!==""?Dn(_t+Dt,0,xe):"",Ze=[0,0,0,0,0,0];for(const dr of Vt){const Kt=St[dr.key];(Kt===1||Kt===2||Kt===3||Kt===4||Kt===5||Kt===6)&&(Ze[Kt-1]+=dr.max)}const jt=qt.map(dr=>dr-1),Bt=typeof Gt=="number"&&jt.length?_c(Gt/jt.length):"",gr=Ze.map((dr,Kt)=>Bt===""||!jt.includes(Kt)?"":dr>0?Dn(Bt,0,dr):_c(Bt));return a.jsxs("tr",{children:[a.jsx("td",{style:{...ot,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Ht+1}),a.jsx("td",{style:ot,children:wp(Je.reg_no)}),a.jsx("td",{style:ot,children:Je.name||""}),a.jsx("td",{style:{...ot,textAlign:"center"},children:bt}),a.jsx("td",{style:{...ot,textAlign:"center"},children:_t}),a.jsx("td",{style:{...ot,textAlign:"center"},children:Tt}),a.jsx("td",{style:{...ot,textAlign:"center"},children:Dt}),a.jsx("td",{style:{...ot,textAlign:"center",fontWeight:700},children:Gt}),a.jsx("td",{style:{...ot,textAlign:"center"},children:$t}),a.jsx("td",{style:{...ot,textAlign:"center"},children:$t===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na($t,xe)})}),a.jsx("td",{style:{...ot,textAlign:"center"},children:ze}),a.jsx("td",{style:{...ot,textAlign:"center"},children:ze===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(ze,xe)})}),qt.map(dr=>{const Kt=dr-1,ye=gr[Kt],Ce=Ze[Kt]??0;return a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...ot,textAlign:"center"},children:ye}),a.jsx("td",{style:{...ot,textAlign:"center"},children:ye===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(Number(ye),Ce)})})]},`pv_btl_cells_${Je.id}_${dr}`)})]},`pv_${Je.id}`)}):Object.keys(Nt||{}).map((Je,Ht)=>{const it=Nt[Je]||{},bt=typeof it.skill1=="number"?Dn(Number(it.skill1),1,J):ds(it.skill1),_t=typeof it.skill2=="number"?Dn(Number(it.skill2),1,J):ds(it.skill2),Tt=typeof it.att1=="number"?Dn(Number(it.att1),1,J):ds(it.att1),Dt=typeof it.att2=="number"?Dn(Number(it.att2),1,J):ds(it.att2),Gt=bt!==""&&_t!==""&&Tt!==""&&Dt!==""?Dn(bt+_t+Tt+Dt,0,pe):"",$t=bt!==""&&Tt!==""?Dn(bt+Tt,0,xe):"",ze=_t!==""&&Dt!==""?Dn(_t+Dt,0,xe):"",Ze=[0,0,0,0,0,0];for(const dr of Vt){const Kt=St[dr.key];(Kt===1||Kt===2||Kt===3||Kt===4||Kt===5||Kt===6)&&(Ze[Kt-1]+=dr.max)}const jt=qt.map(dr=>dr-1),Bt=typeof Gt=="number"&&jt.length?_c(Gt/jt.length):"",gr=Ze.map((dr,Kt)=>Bt===""||!jt.includes(Kt)?"":dr>0?Dn(Bt,0,dr):_c(Bt));return a.jsxs("tr",{children:[a.jsx("td",{style:{...ot,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Ht+1}),a.jsx("td",{style:ot,children:wp(String(it.reg_no??Je))}),a.jsx("td",{style:ot,children:it.name||""}),a.jsx("td",{style:{...ot,textAlign:"center"},children:bt}),a.jsx("td",{style:{...ot,textAlign:"center"},children:_t}),a.jsx("td",{style:{...ot,textAlign:"center"},children:Tt}),a.jsx("td",{style:{...ot,textAlign:"center"},children:Dt}),a.jsx("td",{style:{...ot,textAlign:"center",fontWeight:700},children:Gt}),a.jsx("td",{style:{...ot,textAlign:"center"},children:$t}),a.jsx("td",{style:{...ot,textAlign:"center"},children:$t===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na($t,xe)})}),a.jsx("td",{style:{...ot,textAlign:"center"},children:ze}),a.jsx("td",{style:{...ot,textAlign:"center"},children:ze===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(ze,xe)})}),qt.map(dr=>{const Kt=dr-1,ye=gr[Kt],Ce=Ze[Kt]??0;return a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...ot,textAlign:"center"},children:ye}),a.jsx("td",{style:{...ot,textAlign:"center"},children:ye===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(Number(ye),Ce)})})]},`pv_btl_cells_${Je}_${dr}`)})]},`pv_${Je}`)})})]})}):Ur?null:a.jsx("div",{style:{color:"#6b7280"},children:"No published marks found."}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>Pr(!1),children:"Close"})})]})})}):null,Lr?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>{ut||mn(!1)},children:a.jsxs("div",{style:{width:"min(560px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Je=>Je.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[s,"  ",String(e||"")]})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",sr?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:Me,onChange:Je=>qe(Je.target.value),placeholder:"Explain why you need to edit (required)",rows:4,className:"obe-input",style:{resize:"vertical"}})]}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:12},children:[a.jsx("button",{className:"obe-btn",disabled:ut,onClick:()=>mn(!1),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:ut||At||!e||!String(Me||"").trim(),onClick:Re,title:At?"Request pending (up to 24 hours)":void 0,children:ut?"Requesting":At?"Request Pending":"Send Request"})]})]})})}):null,xt&&a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Saved key: ",a.jsx("span",{style:{fontFamily:"monospace"},children:xt})]})]})}function kxe(e){return a.jsx(Gz,{...e,assessmentKey:"formative2"})}const zs=5,su=25,Sd=30;function Axe(e,t){const r=String(e??"").trim(),n=String(t??"").trim(),i=r.replace(/[^0-9]/g,""),s=n.replace(/[^0-9]/g,"");if(i&&s)try{const o=BigInt(i),l=BigInt(s);if(o<l)return-1;if(o>l)return 1}catch{if(i.length!==s.length)return i.length-s.length;if(i<s)return-1;if(i>s)return 1}else{if(i&&!s)return-1;if(!i&&s)return 1}return r<n?-1:r>n?1:0}function Nxe(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const i=r.localeCompare(n);if(i)return i}else if(r||n)return r?-1:1;return Axe(e==null?void 0:e.reg_no,t==null?void 0:t.reg_no)}function Ws(e,t,r){return Number.isFinite(e)?Math.max(t,Math.min(r,Math.trunc(e))):t}function Cxe(e,t){return`${e}_sheet_${t}`}function Ed(e,t){const r=Array.isArray(e)?e:[],n=[];for(let i=0;i<t;i++){const s=r[i];if(s===""||s==null){n.push("");continue}const o=typeof s=="number"?s:Number(s);n.push(Number.isFinite(o)?o:"")}return n}function $f(e,t){const r=Array.isArray(e)?e:[],n=[];for(let i=0;i<t;i++){const s=r[i],o=typeof s=="number"?s:Number(s);o===1||o===2||o===3||o===4||o===5||o===6?n.push(o):n.push(1)}return n}function qb(e){const t=e.filter(r=>typeof r=="number"&&Number.isFinite(r));return t.length?t.reduce((r,n)=>r+n,0)/t.length:null}function CM(e){const t=e&&typeof e=="object"?e:{},r={};for(const n of Object.keys(t)){const i=t[n];if(i===""||i==null){r[n]="";continue}const s=typeof i=="number"?i:Number(i);r[n]=Number.isFinite(s)?s:""}return r}function Hb(e,t){if(e==null)return"";if(!Number.isFinite(t)||t<=0)return"0";const r=e/t*100;return`${Number.isFinite(r)?r.toFixed(0):0}`}function Tf(e,t,r,n){const i=e.coConfigs&&typeof e.coConfigs=="object"?e.coConfigs:{},s={};for(const o of t){const l=String(o),c=i[l];if(c&&typeof c=="object"&&"enabled"in c){const u=Ws(Number(c.expCount??zs),0,12);s[l]={enabled:!!c.enabled,expCount:u,expMax:Ws(Number(c.expMax??su),0,100),btl:$f(c.btl,u)}}else if(o===r){const u=Ws(Number(e.expCountA??zs),0,12);s[l]={enabled:!!(e.coAEnabled??!0),expCount:u,expMax:Ws(Number(e.expMaxA??su),0,100),btl:$f(e.btlsA,u)}}else if(o===n){const u=Ws(Number(e.expCountB??zs),0,12);s[l]={enabled:!!(e.coBEnabled??!0),expCount:u,expMax:Ws(Number(e.expMaxB??su),0,100),btl:$f(e.btlsB,u)}}else s[l]={enabled:!1,expCount:zs,expMax:su,btl:Array.from({length:zs},()=>1)}}return s}function Lj(e,t,r,n,i){const s=e==null?void 0:e.marksByCo;if(s&&typeof s=="object"){const o=s[String(t)];if(Array.isArray(o))return Ed(o,r)}return t===n?Ed(e==null?void 0:e.marksA,r):t===i?Ed(e==null?void 0:e.marksB,r):Array.from({length:r},()=>"")}function Z2({subjectId:e,teachingAssignmentId:t,assessmentKey:r,label:n,coA:i,coB:s,allCos:o,showCia1Embed:l,cia1Embed:c}){const u=r==="review1"||r==="review2",d=x.useMemo(()=>o&&o.length>0?o:[i,s],[o,i,s]),f=x.useMemo(()=>u?[i,s]:d,[u,d,i,s]),[h,p]=x.useState(!1),[m,g]=x.useState(null),[y,b]=x.useState([]),[v,w]=x.useState(null),[S,j]=x.useState(!1),[k,A]=x.useState(null),[R,M]=x.useState(null),B=sn.useRef(!1),[E,P]=x.useState(!1),[U,G]=x.useState(null),[H,oe]=x.useState(!1),[de,W]=x.useState(""),[V,ae]=x.useState(!1),[ee,C]=x.useState(null),[Y,q]=x.useState(!1),[O,X]=x.useState(null),[F,Q]=x.useState(!1),[K,ne]=x.useState(null),[re,T]=x.useState(null),[I,ie]=x.useState(!1),[D,Z]=x.useState(""),[me,Te]=x.useState(!1),[je,Le]=x.useState(null),[_e,He]=x.useState(null),[We,Pt]=x.useState(!1),[dt,Ye]=x.useState({sheet:{termLabel:"KRCT AY25-26",batchLabel:e||"",coAEnabled:!0,coBEnabled:!0,ciaExamEnabled:!0,expCountA:zs,expCountB:zs,btlsA:Array.from({length:zs},()=>1),btlsB:Array.from({length:zs},()=>1),rowsByStudentId:{},expMaxA:su,expMaxB:su,markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null}}),lt=x.useMemo(()=>e?Cxe(r,e):"",[r,e]),{data:be,publishAllowed:ke,remainingSeconds:ce,loading:we,error:ht,refresh:nt}=V0({assessment:r,subjectCode:String(e||""),teachingAssignmentId:t}),{data:Ie,refresh:It}=G0({assessment:r,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:ct}=lc({assessment:r,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!1}}),Mt=!!U||!!(Ie!=null&&Ie.exists&&(Ie!=null&&Ie.is_published)),xr=Ie!=null&&Ie.exists?!!(Ie!=null&&Ie.entry_open):!0,Pr=!!(Mt&&!xr);x.useEffect(()=>{if(Ie!=null&&Ie.is_published&&(Ie!=null&&Ie.updated_at)&&!U)try{G(new Date(String(Ie.updated_at)).toLocaleString())}catch{G(String(Ie.updated_at))}},[Ie==null?void 0:Ie.is_published,Ie==null?void 0:Ie.updated_at]);const{pending:Nt,pendingUntilMs:Jr,setPendingUntilMs:Ur,refresh:qr}=K0({enabled:!!(Mt&&Pr)&&!!e,assessment:r,subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:t});Y0(!!H||!!re||!!Y);const cn=!!(be!=null&&be.global_override_active&&(be==null?void 0:be.global_is_open)===!1);x.useEffect(()=>{let tt=!0;return(async()=>{try{const Xe=await oc();if(!tt)return;w(Xe||null),Ye(ot=>({...ot,sheet:{...ot.sheet,termLabel:String((Xe==null?void 0:Xe.termLabel)||ot.sheet.termLabel||"KRCT AY25-26"),batchLabel:e||ot.sheet.batchLabel}}))}catch{}})(),()=>{tt=!1}},[e]),x.useEffect(()=>{let tt=!0;return B.current=!1,(async()=>{if(e){try{const Xe=await ri(r,e);if(!tt)return;const ot=Xe==null?void 0:Xe.draft;if(ot&&typeof ot=="object"&&ot.sheet&&typeof ot.sheet=="object"){const Wt=!!(ot.sheet.coAEnabled??!0),pr=!!(ot.sheet.coBEnabled??!0),Nr=!!(ot.sheet.ciaExamEnabled??!0),br=Ws(Number(ot.sheet.expCountA??zs),0,12),Je=Ws(Number(ot.sheet.expCountB??zs),0,12),Ht=$f(ot.sheet.btlsA,br),it=$f(ot.sheet.btlsB,Je),bt={},_t=ot.sheet.rowsByStudentId&&typeof ot.sheet.rowsByStudentId=="object"?ot.sheet.rowsByStudentId:{};for(const[Bt,gr]of Object.entries(_t)){const dr=gr&&typeof gr=="object"?gr:{},Kt=Ed(dr.marksA,br),ye=Ed(dr.marksB,Je),Ce=dr.ciaExam,$e=Ce===""||Ce==null?"":Number(Ce),ft=$e===""?"":Number.isFinite($e)?$e:"";bt[String(Bt)]={...dr,studentId:Number.isFinite(Number(dr.studentId))?Number(dr.studentId):Number(Bt),marksA:Kt,marksB:ye,ciaExam:ft,caaExamByCo:CM(dr.caaExamByCo)}}const Tt=ot.sheet.markManagerSnapshot??null,Dt=ot.sheet.markManagerApprovalUntil??null,Gt=ot.sheet.markManagerLocked,$t=typeof Gt=="boolean"?Gt:!!Tt;Ye({sheet:{termLabel:String(ot.sheet.termLabel||(v==null?void 0:v.termLabel)||"KRCT AY25-26"),batchLabel:String(e),coAEnabled:Wt,coBEnabled:pr,ciaExamEnabled:Nr,expCountA:br,expCountB:Je,btlsA:Ht,btlsB:it,rowsByStudentId:bt,markManagerLocked:$t,markManagerSnapshot:Tt,markManagerApprovalUntil:Dt}});try{lt&&Kn(lt,{rowsByStudentId:ot.sheet.rowsByStudentId||{}})}catch{}const ze=(Xe==null?void 0:Xe.updated_at)??null,Ze=(Xe==null?void 0:Xe.updated_by)??null;if(ze)try{A(new Date(String(ze)).toLocaleString())}catch{A(String(ze))}if(Ze&&M(String(Ze.name||Ze.username||Ze.id||"")),!Object.values(bt).some(Bt=>{var Kt,ye;const gr=(Kt=Bt.marksA)==null?void 0:Kt.some(Ce=>Ce!==""&&Ce!=null),dr=(ye=Bt.marksB)==null?void 0:ye.some(Ce=>Ce!==""&&Ce!=null);return gr||dr||Bt.ciaExam!==""&&Bt.ciaExam!=null})&&Object.keys(bt).length>0)try{const Bt=await Ys(r,String(e),t),gr=(Bt==null?void 0:Bt.data)??null;if(tt&&gr&&typeof gr=="object"&&gr.sheet){const dr=gr.sheet,Kt=dr.rowsByStudentId&&typeof dr.rowsByStudentId=="object"?dr.rowsByStudentId:{};Object.values(Kt).some(Ce=>{var $e,ft;return(($e=Ce==null?void 0:Ce.marksA)==null?void 0:$e.some(Sr=>Sr!==""&&Sr!=null))||((ft=Ce==null?void 0:Ce.marksB)==null?void 0:ft.some(Sr=>Sr!==""&&Sr!=null))||(Ce==null?void 0:Ce.ciaExam)!==""&&(Ce==null?void 0:Ce.ciaExam)!=null})&&Ye(gr)}}catch{}}else{const Wt=lt?Zn(lt):null,pr=Wt!=null&&Wt.rowsByStudentId&&typeof Wt.rowsByStudentId=="object"?Wt.rowsByStudentId:{};Ye(Nr=>({...Nr,sheet:{...Nr.sheet,batchLabel:String(e),rowsByStudentId:pr}}))}}catch{}tt&&(B.current=!0)}})(),()=>{tt=!1}},[r,e,lt,v]),x.useEffect(()=>{let tt=!0;return(async()=>{if(!t){b([]);return}p(!0),g(null);try{const Xe=await pc(t);if(!tt)return;const Wt=[...(Xe==null?void 0:Xe.students)||[]].sort((pr,Nr)=>Nxe(pr,Nr));b(Wt)}catch(Xe){if(!tt)return;b([]),g((Xe==null?void 0:Xe.message)||"Failed to load roster")}finally{tt&&p(!1)}})(),()=>{tt=!1}},[t]),x.useEffect(()=>{e&&y.length!==0&&Ye(tt=>{const Xe=Ws(Number(tt.sheet.expCountA??zs),0,12),ot=Ws(Number(tt.sheet.expCountB??zs),0,12),Wt=$f(tt.sheet.btlsA,Xe),pr=$f(tt.sheet.btlsB,ot),Nr={...tt.sheet.rowsByStudentId||{}};for(const br of y){const Je=String(br.id),Ht=Nr[Je];if(!Ht)Nr[Je]={studentId:br.id,marksA:Array.from({length:Xe},()=>""),marksB:Array.from({length:ot},()=>""),caaExamByCo:{},ciaExam:""};else{const it=Ed(Ht.marksA,Xe),bt=Ed(Ht.marksB,ot),_t=Ht.ciaExam,Tt=_t===""||_t==null?"":Number(_t),Dt=Tt===""?"":Number.isFinite(Tt)?Tt:"",Gt=CM(Ht.caaExamByCo);Nr[Je]={...Ht,marksA:it,marksB:bt,ciaExam:Dt,caaExamByCo:Gt}}}return{...tt,sheet:{...tt.sheet,batchLabel:String(e),expCountA:Xe,expCountB:ot,btlsA:Wt,btlsB:pr,rowsByStudentId:Nr}}})},[y,e]),x.useEffect(()=>{if(lt)try{Kn(lt,{rowsByStudentId:dt.sheet.rowsByStudentId})}catch{}},[dt.sheet.rowsByStudentId,lt]),x.useEffect(()=>{if(!e)return;if(Ie!=null&&Ie.exists){const ot=!!(Ie!=null&&Ie.mark_manager_locked);!!dt.sheet.markManagerLocked!==ot&&Ye(Wt=>({...Wt,sheet:{...Wt.sheet,markManagerLocked:ot}}));return}const tt=!!(ct!=null&&ct.allowed_by_approval),Xe=ct!=null&&ct.approval_until?String(ct.approval_until):null;if(tt&&Xe){(dt.sheet.markManagerApprovalUntil?String(dt.sheet.markManagerApprovalUntil):null)!==Xe&&Ye(Wt=>({...Wt,sheet:{...Wt.sheet,markManagerLocked:!1,markManagerApprovalUntil:Xe}}));return}},[e,Ie==null?void 0:Ie.exists,Ie==null?void 0:Ie.mark_manager_locked,ct==null?void 0:ct.allowed_by_approval,ct==null?void 0:ct.approval_until,dt.sheet.markManagerLocked,dt.sheet.markManagerApprovalUntil]),x.useEffect(()=>{if(!e||!B.current)return;let tt=!1;const Xe=setTimeout(async()=>{try{await Fi(r,e,dt),tt||A(new Date().toLocaleString())}catch{}},900);return()=>{tt=!0,clearTimeout(Xe)}},[r,e,dt]);const Pn=x.useMemo(()=>Tf(dt.sheet,d,i,s),[dt.sheet,d,i,s]),Lr=x.useMemo(()=>f.filter(tt=>{var Xe;return(Xe=Pn[String(tt)])==null?void 0:Xe.enabled}).map(tt=>{const Xe=Pn[String(tt)];return{coNumber:tt,expCount:Xe.expCount,expMax:Xe.expMax,btl:Xe.btl}}),[Pn,f]),mn=x.useMemo(()=>Lr.reduce((tt,Xe)=>tt+Xe.expCount,0),[Lr]),Me=Lr.length>0,qe=dt.sheet.ciaExamEnabled!==!1,ut=x.useMemo(()=>{if(mn===0)return[];const tt=new Set;for(const Xe of Lr)for(const ot of Xe.btl.slice(0,Xe.expCount))tt.add(ot);return[1,2,3,4,5,6].filter(Xe=>tt.has(Xe))},[Lr,mn]),wt=Me?Lr.length*2:2,At=x.useMemo(()=>Lr.reduce((tt,Xe)=>Math.max(tt,Xe.expMax),su),[Lr]),sr=Pn[String(i)],Zt=Pn[String(s)];sr!=null&&sr.enabled,Zt!=null&&Zt.enabled,Ws(Number((sr==null?void 0:sr.expCount)??zs),0,12),Ws(Number((Zt==null?void 0:Zt.expCount)??zs),0,12),Ws(Number((sr==null?void 0:sr.expMax)??su),0,100),Ws(Number((Zt==null?void 0:Zt.expMax)??su),0,100);const Cr=!!dt.sheet.markManagerLocked,se=Cr,ue=!!(cn||Ie!=null&&Ie.exists&&!(Ie!=null&&Ie.entry_open));function J(tt,Xe){Ye(ot=>{if(ot.sheet.markManagerLocked)return ot;const Wt=Tf(ot.sheet,d,i,s);return Wt[String(tt)]={...Wt[String(tt)],enabled:Xe},{...ot,sheet:{...ot.sheet,coConfigs:Wt}}})}function pe(tt,Xe){const ot=Ws(Number(Xe),0,100);Ye(Wt=>{if(Wt.sheet.markManagerLocked)return Wt;const pr=Tf(Wt.sheet,d,i,s);return pr[String(tt)]={...pr[String(tt)],expMax:ot},{...Wt,sheet:{...Wt.sheet,coConfigs:pr}}})}function xe(tt,Xe){const ot=Ws(Xe,0,12);Ye(Wt=>{if(Wt.sheet.markManagerLocked)return Wt;const pr=Tf(Wt.sheet,d,i,s),Nr=pr[String(tt)];pr[String(tt)]={...Nr,expCount:ot,btl:$f(Nr.btl,ot)};const br={...Wt.sheet.rowsByStudentId||{}};for(const Je of Object.keys(br)){const Ht=br[Je],it=Ht.marksByCo&&typeof Ht.marksByCo=="object"?{...Ht.marksByCo}:{};it[String(tt)]=Ed(it[String(tt)],ot),br[Je]={...Ht,marksByCo:it}}return{...Wt,sheet:{...Wt.sheet,coConfigs:pr,rowsByStudentId:br}}})}function Ne(tt,Xe,ot){Ye(Wt=>{if(Pr||cn)return Wt;const pr=Tf(Wt.sheet,d,i,s),Nr=pr[String(tt)],br=[...Nr.btl];return br[Xe]=ot,pr[String(tt)]={...Nr,btl:br},{...Wt,sheet:{...Wt.sheet,coConfigs:pr}}})}function St(tt){Ye(Xe=>Xe.sheet.markManagerLocked?Xe:{...Xe,sheet:{...Xe.sheet,ciaExamEnabled:!!tt}})}function Ve(tt){const Xe=Tf(tt,d,i,s),ot=d.filter(Wt=>{var pr;return(pr=Xe[String(Wt)])==null?void 0:pr.enabled}).map(Wt=>{const pr=Xe[String(Wt)];return{co:Wt,expCount:pr.expCount,expMax:pr.expMax}});return JSON.stringify({enabled:ot,ciaExamEnabled:!!(tt.ciaExamEnabled??!0)})}async function De(){if(e){ie(!0),He(null);try{const tt=await sl({assessment:r,subject_code:String(e),scope:"MARK_MANAGER",reason:`Edit request: Mark Manager changes for ${n}`,teaching_assignment_id:t});alert(ol(tt))}catch(tt){const Xe=ll(tt,"Request failed");He(Xe),alert(`Edit request failed: ${Xe}`)}finally{ie(!1)}}}function Re(tt,Xe,ot,Wt){Ye(pr=>{var Dt;const Nr=String(tt),Je=Tf(pr.sheet,d,i,s)[String(Xe)],Ht=Je?Je.expMax:su,it=Je?Je.expCount:zs,bt=(Dt=pr.sheet.rowsByStudentId)==null?void 0:Dt[Nr],_t=bt!=null&&bt.marksByCo&&typeof bt.marksByCo=="object"?{...bt.marksByCo}:{},Tt=[...Ed(_t[String(Xe)]??Lj(bt,Xe,it,i,s),it)];if(Wt===""||Wt==null)Tt[ot]="";else{const Gt=Number(Wt);Tt[ot]=Number.isFinite(Gt)?Math.max(0,Math.min(Ht,Math.trunc(Gt))):""}return _t[String(Xe)]=Tt,{...pr,sheet:{...pr.sheet,rowsByStudentId:{...pr.sheet.rowsByStudentId,[Nr]:{...bt||{studentId:tt,marksA:[],marksB:[]},marksByCo:_t}}}}})}function xt(tt,Xe){Ye(ot=>{var br;const Wt=String(tt),pr=(br=ot.sheet.rowsByStudentId)==null?void 0:br[Wt];let Nr="";if(Xe===""||Xe==null)Nr="";else{const Je=Number(Xe),Ht=Sd;Nr=Number.isFinite(Je)?Math.max(0,Math.min(Ht,Math.trunc(Je))):""}return{...ot,sheet:{...ot.sheet,rowsByStudentId:{...ot.sheet.rowsByStudentId,[Wt]:{...pr||{studentId:tt,marksA:[],marksB:[]},ciaExam:Nr}}}}})}async function Vt(){if(e){j(!0);try{await Fi(r,e,dt),A(new Date().toLocaleString())}catch(tt){alert((tt==null?void 0:tt.message)||"Draft save failed")}finally{j(!1)}}}const qt=sn.useRef(dt);qt.current=dt,x.useEffect(()=>{const tt=()=>{!e||ue||Fi(r,e,qt.current).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",tt),()=>window.removeEventListener("obe:before-tab-switch",tt)},[e,r,ue]);async function zt(){if(!e||!window.confirm("Reset all lab marks for this sheet? This clears the draft (students + experiments + CIA Exam)."))return;const Xe=Ws(Number(dt.sheet.expCountA??zs),0,12),ot=Ws(Number(dt.sheet.expCountB??zs),0,12),Wt={};for(const Nr of y)Wt[String(Nr.id)]={studentId:Nr.id,marksA:Array.from({length:Xe},()=>""),marksB:Array.from({length:ot},()=>""),caaExamByCo:{},ciaExam:""};const pr={sheet:{...dt.sheet,rowsByStudentId:Wt}};Ye(pr);try{lt&&Kn(lt,{rowsByStudentId:{}})}catch{}try{await Fi(r,e,pr),A(new Date().toLocaleString())}catch{}}async function vt(){if(e){if(cn){alert("Publishing is locked by IQAC.");return}if(!ke){alert("Publish window is closed. Please request IQAC approval.");return}if(Mt&&Pr){if(Nt){alert("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}oe(!0);return}P(!0);try{await j3(r,e,dt,t),G(new Date().toLocaleString()),await er(!1),nt(),It({silent:!0});try{console.debug("obe:published dispatch",{assessment:r,subjectId:e}),window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:r}}))}catch{}}catch(tt){alert((tt==null?void 0:tt.message)||"Publish failed")}finally{P(!1)}}}async function Lt(){if(e){Te(!0),Le(null);try{await jh({assessment:r,subject_code:e,reason:D,teaching_assignment_id:t}),Le("Request sent to IQAC successfully."),Z(""),nt()}catch(tt){Le((tt==null?void 0:tt.message)||"Failed to send request.")}finally{Te(!1)}}}async function er(tt){if(e){tt&&Q(!0),ne(null);try{const Xe=await Ys(r,String(e),t),ot=(Xe==null?void 0:Xe.data)??null;ot&&typeof ot=="object"&&X(ot)}catch(Xe){tt&&ne((Xe==null?void 0:Xe.message)||"Failed to load published marks")}finally{tt&&Q(!1)}}}x.useEffect(()=>{e&&er(!1)},[e,r]);const yr=sn.useRef(null);x.useEffect(()=>{if(!e||!Mt)return;if(!xr){yr.current=!1;return}const tt=yr.current;if(yr.current=!0,tt===!0)return;let Xe=!0;return(async()=>{var ot;try{const Wt=await ri(r,String(e),t),pr=(Wt==null?void 0:Wt.draft)??null;if(!Xe)return;if(pr&&typeof pr=="object"&&pr.sheet){const Nr=(ot=pr.sheet)==null?void 0:ot.rowsByStudentId;if(Nr&&Object.values(Nr).some(Je=>{var Ht,it;return((Ht=Je==null?void 0:Je.marksA)==null?void 0:Ht.some(bt=>bt!==""&&bt!=null))||((it=Je==null?void 0:Je.marksB)==null?void 0:it.some(bt=>bt!==""&&bt!=null))||(Je==null?void 0:Je.ciaExam)!==""&&(Je==null?void 0:Je.ciaExam)!=null})){Ye(pr),B.current=!0;return}}}catch{}Xe&&O&&O.sheet&&(Ye(O),B.current=!0)})(),()=>{Xe=!1}},[xr,Mt,e,r,O,t]),x.useEffect(()=>{if(!e||!Mt||xr)return;const tt=window.setInterval(()=>{It({silent:!0})},3e4);return()=>window.clearInterval(tt)},[xr,Mt,e,It]),x.useEffect(()=>{Y&&e&&(X(null),er(!0))},[Y,e,r]);const Br=3+Math.max(mn,1)+1+wt+ut.length*2,cr={border:"1px solid #111",padding:"4px 4px",background:"#ecfdf5",color:"#065f46",textAlign:"center",fontWeight:700,fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},ur={border:"1px solid #111",padding:"4px 4px",fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},en={width:"100%",border:"none",outline:"none",background:"transparent",fontSize:11,textAlign:"center"},nn={position:"relative",border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},gn="100%",nr={display:"flex",width:"100%",maxWidth:1200,margin:"0 auto",gap:10,flexWrap:"wrap",alignItems:"center",marginBottom:8},Tr={width:20,height:20,transform:"scale(1.5)",accentColor:"#9a3412"},Dr=We?"markManagerGlitch 2s ease-in-out":void 0,Rr={position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:40,width:360,background:"#fff",border:"1px solid #e5e7eb",padding:10,borderRadius:12,display:"flex",flexDirection:"column",gap:8,alignItems:"center",boxShadow:"0 6px 18px rgba(17,24,39,0.06)",filter:"none"};return a.jsxs(X0,{children:[a.jsx("style",{children:`
        @keyframes markManagerGlitch {
          0%, 100% { transform: translate(0,0); filter: none; }
          10% { transform: translate(-2px, 1px); }
          20% { transform: translate(2px, -1px); }
          30% { transform: translate(-1px, -2px); }
          40% { transform: translate(1px, 2px); }
          50% { transform: translate(-2px, -1px); }
          60% { transform: translate(2px, 1px); }
          70% { transform: translate(-1px, 1px); }
          80% { transform: translate(1px, -1px); }
          90% { transform: translate(-1px, 0); }
        }
        @keyframes markManagerDust {
          0% { opacity: 0.9; transform: translate(0,0) scale(1); }
          100% { opacity: 0; transform: translate(80px, -40px) scale(0.6); }
        }
        .markManagerDustParticle {
          position: absolute;
          width: 4px;
          height: 4px;
          background: #d1d5db;
          border-radius: 50%;
          animation: markManagerDust 2s ease-out forwards;
        }
      `}),a.jsxs("div",{style:{margin:"0 0 10px 0",maxWidth:"100%",width:"100%",boxSizing:"border-box",overflow:"hidden"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"COs enabled"}),a.jsxs("div",{style:{...nr,border:"1px solid #fcd34d",background:Cr?"#f3f4f6":"#fff7ed",padding:12,borderRadius:12,alignItems:"stretch",animation:Dr,position:"relative",overflow:"hidden"},children:[We?a.jsx(a.Fragment,{children:Array.from({length:20},(tt,Xe)=>a.jsx("div",{className:"markManagerDustParticle",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*1}s`}},Xe))}):null,a.jsxs("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",gap:10,flexWrap:"wrap"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[a.jsx(C2,{size:20,color:Cr?"#6b7280":"#9a3412"}),a.jsx("div",{style:{fontWeight:950,color:"#111827",fontSize:14},children:"Mark Manager"}),Cr&&a.jsx("span",{style:{fontSize:11,color:"#fff",background:"#dc2626",padding:"2px 8px",borderRadius:6,fontWeight:700},children:"LOCKED"}),!Cr&&a.jsx("span",{style:{fontSize:11,color:"#fff",background:"#16a34a",padding:"2px 8px",borderRadius:6,fontWeight:700},children:"EDITABLE"})]}),a.jsx("button",{onClick:()=>T({mode:Cr?"request":"confirm"}),className:"obe-btn obe-btn-success",disabled:!e||I,style:{minWidth:100},children:I?"Saving...":Cr?"Request Edit":"Save & Lock"})]}),a.jsxs("div",{style:{width:"100%",display:"flex",gap:10,flexWrap:"wrap",marginTop:8},children:[d.map(tt=>{const Xe=Pn[String(tt)],ot=Cr||u&&tt!==i&&tt!==s;return a.jsxs("label",{style:{display:"flex",gap:6,alignItems:"center",fontWeight:800,fontSize:12,color:"#111827"},children:[a.jsx("input",{type:"checkbox",checked:(Xe==null?void 0:Xe.enabled)||!1,disabled:ot,onChange:Wt=>J(tt,Wt.target.checked),style:Tr}),"CO-",tt]},tt)}),a.jsxs("label",{style:{display:"flex",gap:6,alignItems:"center",fontWeight:800,fontSize:12,color:"#111827"},children:[a.jsx("input",{type:"checkbox",checked:qe,disabled:Cr,onChange:tt=>St(tt.target.checked),style:Tr}),"CIA Exam"]})]}),a.jsx("div",{style:{width:"100%",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:10,marginTop:8},children:Lr.map(tt=>a.jsxs("div",{style:{minWidth:0},children:[a.jsxs("div",{style:{fontSize:11,color:"#6b7280"},children:["No. of experiments (CO-",tt.coNumber,")"]}),a.jsx("input",{type:"number",className:"obe-input",value:tt.expCount,onChange:Xe=>xe(tt.coNumber,Number(Xe.target.value)),min:0,max:12,disabled:Cr}),a.jsx("div",{style:{fontSize:11,color:"#6b7280",marginTop:6},children:"Max marks (per experiment)"}),a.jsx("input",{type:"number",className:"obe-input",value:tt.expMax,onChange:Xe=>pe(tt.coNumber,Number(Xe.target.value)),min:0,max:100,disabled:Cr})]},tt.coNumber))})]}),_e?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#991b1b"},children:_e}):null]}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",marginBottom:12},children:[a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:a.jsx("button",{onClick:zt,className:"obe-btn obe-btn-danger",disabled:!e||!se||ue,title:se?ue?"Table locked after publish":"Clear all marks":"Save & Lock Mark Manager first to enable table",children:"Reset All"})}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:Vt,className:"obe-btn obe-btn-success",disabled:S||!e||!se||ue,title:se?ue?"Table locked after publish":"Save current draft":"Save & Lock Mark Manager first to enable table",children:S?"Saving":"Save Draft"}),a.jsx("button",{onClick:vt,className:"obe-btn obe-btn-primary",disabled:Pr?Nt:!e||E||!se||ue||cn||!ke,title:se?ue?"Table locked after publish":ke?cn?"Publishing locked by IQAC":"Publish marks":"Publish window closed":"Save & Lock Mark Manager first",children:Pr?Nt?"Request Pending":"Request Edit":E?"Publishing":"Publish"}),k&&a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Saved: ",k]}),U&&a.jsxs("div",{style:{fontSize:12,color:"#16a34a",alignSelf:"center"},children:["Published: ",U]})]})]}),m&&a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:m}),a.jsx("div",{style:{marginBottom:10,fontSize:12,color:ke?"#065f46":"#b91c1c"},children:we?"Checking publish due time":ht||(be!=null&&be.due_at?a.jsxs(a.Fragment,{children:["Due: ",new Date(be.due_at).toLocaleString(),"  Remaining: ",sg(ce),be.allowed_by_approval&&be.approval_until?a.jsxs(a.Fragment,{children:["  Approved until ",new Date(be.approval_until).toLocaleString()]}):null]}):"Due time not set by IQAC.")}),cn?a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),a.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:a.jsx("button",{className:"obe-btn",onClick:()=>nt(),disabled:we,children:"Refresh"})})]}):ke?null:a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fecaca",background:"#fff7ed",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publish time is over"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:"Send a request to IQAC to approve publishing."}),a.jsx("textarea",{value:D,onChange:tt=>Z(tt.target.value),placeholder:"Reason (optional)",rows:3,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:[a.jsx("button",{className:"obe-btn",onClick:()=>nt(),disabled:me||we,children:"Refresh"}),a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:Lt,disabled:me,children:me?"Requesting":"Request Approval"})]}),je?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:je}):null]}),h?a.jsx("div",{style:{color:"#6b7280"},children:"Loading roster"}):y.length===0?a.jsx("div",{style:{color:"#6b7280"},children:"Select a Teaching Assignment to load students."}):se?a.jsx("div",{style:nn,children:a.jsxs(og,{locked:cn,children:[a.jsx("div",{className:"obe-table-wrapper",style:{width:"100%",maxWidth:"100%",overflowX:"scroll",overflowY:"hidden",WebkitOverflowScrolling:"touch",overscrollBehaviorX:"contain",scrollbarGutter:"stable"},children:a.jsxs("table",{className:"obe-table",style:{minWidth:gn,width:"100%",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:cr,colSpan:Br,children:[dt.sheet.termLabel," | ",dt.sheet.batchLabel," | ",n]})}),a.jsxs("tr",{children:[a.jsx("th",{style:cr,rowSpan:5,children:"S.No"}),a.jsx("th",{style:cr,rowSpan:5,children:"Register No."}),a.jsx("th",{style:cr,rowSpan:5,children:"Name of the Students"}),a.jsx("th",{style:cr,colSpan:Math.max(1,mn),children:"Experiments"}),a.jsxs("th",{style:cr,rowSpan:5,children:[a.jsx("div",{children:"Total"}),a.jsx("div",{style:{fontSize:11,color:"#6b7280",fontWeight:900},children:qe?"CIA exam":"Avg"}),qe&&a.jsx("div",{style:{fontSize:11,color:"#6b7280",fontWeight:900},children:Sd})]}),a.jsx("th",{style:cr,colSpan:wt,children:"CO ATTAINMENT"}),ut.length?a.jsx("th",{style:cr,colSpan:ut.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[mn===0?a.jsx("th",{style:cr,children:""}):a.jsx(a.Fragment,{children:Lr.map(tt=>Array.from({length:tt.expCount},(Xe,ot)=>a.jsx("th",{style:cr,children:tt.coNumber},`co${tt.coNumber}_${ot}`)))}),Lr.map(tt=>a.jsxs("th",{style:cr,colSpan:2,children:["CO-",tt.coNumber]},`coatt_hdr_${tt.coNumber}`)),ut.map(tt=>a.jsxs("th",{style:cr,colSpan:2,children:["BTL-",tt]},`btl_${tt}`))]}),a.jsxs("tr",{children:[mn===0?a.jsx("th",{style:cr,children:""}):a.jsx(a.Fragment,{children:Lr.map(tt=>Array.from({length:tt.expCount},(Xe,ot)=>a.jsx("th",{style:cr,children:tt.expMax},`max_${tt.coNumber}_${ot}`)))}),Lr.map(tt=>a.jsxs(sn.Fragment,{children:[a.jsx("th",{style:cr,children:(tt.expMax+(qe&&Lr.length?Sd/Lr.length:0)).toFixed(0)}),a.jsx("th",{style:cr,children:"%"})]},`comax_${tt.coNumber}`)),ut.map(tt=>a.jsxs(sn.Fragment,{children:[a.jsx("th",{style:cr,children:At}),a.jsx("th",{style:cr,children:"%"})]},`btlmax_${tt}`))]}),a.jsxs("tr",{children:[mn===0?a.jsx("th",{style:cr,children:"No experiments"}):a.jsx(a.Fragment,{children:Lr.map(tt=>Array.from({length:tt.expCount},(Xe,ot)=>a.jsxs("th",{style:cr,children:["E",ot+1]},`e_${tt.coNumber}_${ot}`)))}),a.jsx("th",{style:cr,colSpan:wt+ut.length*2})]}),a.jsxs("tr",{children:[mn===0?a.jsx("th",{style:cr,children:""}):a.jsx(a.Fragment,{children:Lr.map(tt=>Array.from({length:tt.expCount},(Xe,ot)=>{const Wt=tt.btl[ot]??1,pr=!(Pr||cn);return a.jsx("th",{style:cr,children:pr?a.jsx("select",{"aria-label":`BTL for CO${tt.coNumber} E${ot+1}`,value:Wt,onChange:Nr=>Ne(tt.coNumber,ot,Number(Nr.target.value)),style:{width:"100%",minWidth:38,padding:"2px 2px",fontWeight:800,fontSize:11,textAlign:"center",border:"1px solid #d1d5db",borderRadius:4,background:"#fff",cursor:"pointer"},children:[1,2,3,4,5,6].map(Nr=>a.jsx("option",{value:Nr,children:Nr},Nr))}):a.jsx("span",{style:{fontWeight:800},children:Wt})},`btl_${tt.coNumber}_${ot}`)}))}),a.jsx("th",{style:cr,colSpan:wt+ut.length*2})]})]}),a.jsx("tbody",{children:Pr?a.jsx("tr",{children:a.jsx("td",{colSpan:Br,style:{padding:14,textAlign:"center",color:"#065f46",fontWeight:900},children:"Published  students hidden"})}):a.jsxs(a.Fragment,{children:[y.map((tt,Xe)=>{var _t;const ot=(_t=dt.sheet.rowsByStudentId)==null?void 0:_t[String(tt.id)],Wt=ot==null?void 0:ot.ciaExam,pr=Wt===""||Wt==null?0:Number(Wt),Nr=Wt===""||Wt==null?"":Number.isFinite(pr)?pr:"",br=qe&&Lr.length?(Number.isFinite(pr)?pr:0)/Lr.length:0,Je=Lr.map(Tt=>{const Dt=Lj(ot,Tt.coNumber,Tt.expCount,i,s),Gt=Dt.slice(0,Tt.expCount),$t=Tt.btl.slice(0,Tt.expCount),ze=qb(Gt),jt=ze!=null&&ze>0||qe&&pr>0?Number(ze??0)+br:null,Bt=Tt.expMax+(qe&&Lr.length?Sd/Lr.length:0);return{coNumber:Tt.coNumber,marks:Dt,visibleMarks:Gt,btls:$t,coMark:jt,coMax:Bt}}),Ht=Je.flatMap(Tt=>Tt.visibleMarks),it=qb(Ht),bt={};for(const Tt of ut){const Dt=[];for(const Gt of Je)for(let $t=0;$t<Gt.visibleMarks.length;$t++)if(Gt.btls[$t]===Tt){const ze=Gt.visibleMarks[$t];typeof ze=="number"&&Number.isFinite(ze)&&Dt.push(ze)}bt[Tt]=Dt.length?Dt.reduce((Gt,$t)=>Gt+$t,0)/Dt.length:null}return a.jsxs("tr",{children:[a.jsx("td",{style:{...ur,width:"30px",minWidth:"30px",fontWeight:700},children:Xe+1}),a.jsx("td",{style:{...ur,width:"70px",minWidth:"70px",fontWeight:600},children:String(tt.reg_no||"").slice(-8)}),a.jsx("td",{style:{...ur,fontWeight:600,whiteSpace:"nowrap"},children:String(tt.name||"")}),Je.map(Tt=>Array.from({length:Tt.visibleMarks.length},(Dt,Gt)=>{const $t=Lr.find(ze=>ze.coNumber===Tt.coNumber);return a.jsx("td",{style:{...ur,padding:"2px"},children:a.jsx("input",{type:"number",value:Tt.marks[Gt],onChange:ze=>{const Ze=ze.target.value;if(Ze==="")return ze.currentTarget.setCustomValidity(""),Re(tt.id,Tt.coNumber,Gt,"");const jt=Number(Ze);if(Number.isFinite(jt)){if(jt>$t.expMax){ze.currentTarget.setCustomValidity(`Max mark is ${$t.expMax}`),ze.currentTarget.reportValidity(),window.setTimeout(()=>ze.currentTarget.setCustomValidity(""),0);return}ze.currentTarget.setCustomValidity(""),Re(tt.id,Tt.coNumber,Gt,jt)}},style:en,min:0,max:$t.expMax,disabled:!se||ue})},`m${tt.id}_co${Tt.coNumber}_${Gt}`)})),a.jsx("td",{style:{...ur,padding:qe?"2px":void 0,fontWeight:qe?600:700,fontSize:"clamp(10px, 0.9vw, 11px)"},children:qe?a.jsx("input",{type:"number",value:Nr,onChange:Tt=>{const Dt=Tt.target.value;if(Dt==="")return Tt.currentTarget.setCustomValidity(""),xt(tt.id,"");const Gt=Number(Dt);if(Number.isFinite(Gt)){if(Gt>Sd){Tt.currentTarget.setCustomValidity(`Max mark is ${Sd}`),Tt.currentTarget.reportValidity(),window.setTimeout(()=>Tt.currentTarget.setCustomValidity(""),0);return}Tt.currentTarget.setCustomValidity(""),xt(tt.id,Gt)}},style:en,min:0,max:Sd,disabled:!se||ue}):it==null?"":it.toFixed(1)}),Je.map(Tt=>a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...ur,width:"28px",fontSize:"10px",padding:"2px",fontWeight:600,color:"#5f6368"},children:Tt.coMark==null?"":Tt.coMark.toFixed(1)}),a.jsx("td",{style:{...ur,width:"25px",fontSize:"10px",padding:"2px",fontWeight:600,color:"#5f6368"},children:Hb(Tt.coMark,Tt.coMax)})]},`coatt_${tt.id}_${Tt.coNumber}`)),ut.map(Tt=>{const Dt=bt[Tt]??null;return a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...ur,width:"28px",fontSize:"10px",padding:"2px",fontWeight:600,color:"#5f6368"},children:Dt==null?"":Dt.toFixed(1)}),a.jsx("td",{style:{...ur,width:"25px",fontSize:"10px",padding:"2px",fontWeight:600,color:"#5f6368"},children:Hb(Dt,At)})]},`btlcell_${tt.id}_${Tt}`)})]},tt.id)}),y.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:Br,style:{padding:10,color:"#6b7280"},children:"No students."})}):null]})})]})}),Pr?a.jsx("div",{style:{position:"absolute",inset:0,zIndex:30,pointerEvents:"auto",background:"linear-gradient(180deg, rgba(34,197,94,0.28) 0%, rgba(16,185,129,0.36) 100%)"}}):null,!Cr&&!Pr?a.jsxs("div",{style:Rr,children:[a.jsx("div",{style:{width:100,height:72,display:"grid",placeItems:"center",background:"#fff",borderRadius:8},children:a.jsx("img",{src:"https://media.lordicon.com/icons/wired/flat/94-lock-unlock.gif",alt:"locked",style:{maxWidth:72,maxHeight:72,display:"block"}})}),a.jsxs("div",{style:{textAlign:"center"},children:[a.jsx("div",{style:{fontWeight:800,color:"#111827"},children:"Table Locked"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Confirm the Mark Manager"})]})]}):null,Pr?a.jsxs("div",{style:Rr,children:[a.jsxs("div",{style:{textAlign:"center"},children:[a.jsx("div",{style:{fontWeight:900,color:"#065f46"},children:"Published"}),a.jsx("div",{style:{fontSize:13,color:"#065f46"},children:"Marks are locked. Request IQAC approval to edit."})]}),a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center"},children:[a.jsx("button",{type:"button",className:"obe-btn",onClick:()=>q(!0),children:"View Marks"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-success",disabled:Nt,onClick:async()=>{if(Nt){alert("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}oe(!0)},children:Nt?"Request Pending":"Request Edit"})]}),a.jsx("div",{style:{width:64,height:64,display:"grid",placeItems:"center"},children:a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#065f46",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",fill:"#d1fae5"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})})]}):null]})}):a.jsxs("div",{style:{padding:"20px",textAlign:"center",background:"#fff7ed",borderRadius:12,border:"1px solid #fcd34d"},children:[a.jsx("div",{style:{fontSize:14,fontWeight:700,color:"#92400e",marginBottom:8},children:" Mark Manager Configuration Required"}),a.jsx("div",{style:{fontSize:12,color:"#78350f"},children:"Please configure and lock the Mark Manager above to enable the table."})]}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280",display:"flex",gap:18,flexWrap:"wrap"},children:[k?a.jsxs("div",{children:["Draft saved: ",k,R?a.jsxs("span",{style:{marginLeft:8,color:"#374151"},children:["by ",a.jsx("strong",{children:R})]}):null]}):null,U?a.jsxs("div",{children:["Last published: ",U]}):null]}),H?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>{V||oe(!1)},children:a.jsxs("div",{style:{width:"min(560px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:tt=>tt.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[String(r).toUpperCase()," LAB"]})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",Jr?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{fontSize:13,color:"#374151",marginBottom:10,lineHeight:1.35},children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Subject:"})," ",n]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Code:"})," ",String(e||"")]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Published:"})," ",U||""]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Saved:"})," ",k||""]})]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:de,onChange:tt=>W(tt.target.value),placeholder:"Explain why you need to edit (required)",rows:4,className:"obe-input",style:{resize:"vertical"}})]}),ee?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#b91c1c"},children:ee}):null,a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[a.jsx("button",{type:"button",className:"obe-btn",disabled:V,onClick:()=>oe(!1),children:"Cancel"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-primary",disabled:V||Nt||!e||!String(de||"").trim(),onClick:async()=>{if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}if(Nt){alert("Edit request is pending. Please wait.");return}const Xe=String(de||"").trim();if(!Xe){C("Reason is required.");return}ae(!0),C(null);try{const ot=await sl({assessment:r,subject_code:String(e),scope:"MARK_ENTRY",reason:Xe,teaching_assignment_id:t});alert(ol(ot)),oe(!1),W(""),Ur(Date.now()+24*60*60*1e3);try{qr({silent:!0})}catch{}It({silent:!0})}catch(ot){const Wt=ll(ot,"Request failed");C(Wt),alert(`Edit request failed: ${Wt}`)}finally{ae(!1)}},children:V?"Requesting":Nt?"Request Pending":"Send Request"})]})]})})}):null,re?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:9999},onClick:()=>{I||T(null)},children:a.jsxs("div",{style:{width:"min(760px, 96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:tt=>tt.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:re.mode==="confirm"?`Confirmation - ${n}`:`Request Edit - ${n}`}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:String(r).toUpperCase()})]}),re.mode==="confirm"?a.jsxs(a.Fragment,{children:[a.jsxs("div",{style:{background:"#fffbeb",border:"1px solid #fbbf24",borderRadius:8,padding:12,marginBottom:12},children:[a.jsx("div",{style:{fontWeight:700,color:"#92400e",marginBottom:4},children:" Important"}),a.jsxs("div",{style:{fontSize:12,color:"#78350f",lineHeight:1.5},children:["After confirming, Mark Manager will be ",a.jsx("strong",{children:"locked"}),". You'll need IQAC approval to change CO selection, experiment count, or max marks."]})]}),a.jsx("div",{style:{fontSize:13,color:"#374151",marginBottom:8,fontWeight:600},children:"Review your settings:"}),a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb",fontWeight:700},children:"Item"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb",fontWeight:700},children:"Experiments"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb",fontWeight:700},children:"Max marks"})]})}),a.jsxs("tbody",{children:[Lr.length>0?Lr.map(tt=>a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:800},children:["CO-",tt.coNumber]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right",fontWeight:600},children:tt.expCount}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right",fontWeight:600},children:tt.expMax})]},tt.coNumber)):a.jsx("tr",{children:a.jsx("td",{colSpan:3,style:{padding:10,color:"#dc2626",fontWeight:600},children:" No COs selected"})}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:800},children:"CIA Exam"}),a.jsx("td",{colSpan:2,style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right",fontWeight:600},children:qe?" Enabled":" Disabled"})]})]})]})})]}):a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. Mark Manager will remain locked until IQAC approves."}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[a.jsx("button",{className:"obe-btn",disabled:I,onClick:()=>T(null),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:I||!e,onClick:async()=>{if(e){if(re.mode==="request"){T(null),await De();return}ie(!0),He(null),Pt(!0);try{const tt=Ve(dt.sheet),Xe=ct!=null&&ct.approval_until?String(ct.approval_until):dt.sheet.markManagerApprovalUntil||null,ot={...dt,sheet:{...dt.sheet,markManagerLocked:!0,markManagerSnapshot:tt,markManagerApprovalUntil:Xe}};await Fi(r,String(e),ot),A(new Date().toLocaleString()),await fh(r,String(e),t),await It({silent:!1}),Ye(ot),T(null),alert(" Mark Manager saved and locked successfully! You can now proceed with mark entry."),setTimeout(()=>Pt(!1),1500)}catch(tt){He((tt==null?void 0:tt.message)||"Save failed"),Pt(!1),Ye(Xe=>({...Xe,sheet:{...Xe.sheet,markManagerLocked:!1}}))}finally{ie(!1)}}},children:I?"Saving...":re.mode==="confirm"?" Confirm & Lock":" Send Request"})]})]})})}):null,Y?a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:70},onClick:()=>q(!1),children:a.jsxs("div",{style:{width:"min(1100px, 96vw)",maxHeight:"min(80vh, 900px)",overflow:"auto",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:tt=>tt.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Marks"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[String(r).toUpperCase()," LAB"]})]}),F?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading published marks"}):null,K?a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:K}):null,(()=>{const tt=O&&O.sheet?O.sheet:dt.sheet,Xe=tt.ciaExamEnabled!==!1,ot=Tf(tt,d,i,s),Wt=d.filter(_t=>{var Tt;return(Tt=ot[String(_t)])==null?void 0:Tt.enabled}).map(_t=>{const Tt=ot[String(_t)];return{coNumber:_t,expCount:Tt.expCount,expMax:Tt.expMax,btl:Tt.btl}}),pr=Wt.reduce((_t,Tt)=>_t+Tt.expCount,0),Nr=new Set;for(const _t of Wt)for(const Tt of _t.btl.slice(0,_t.expCount))Nr.add(Tt);const br=[1,2,3,4,5,6].filter(_t=>Nr.has(_t)),Je=Wt.reduce((_t,Tt)=>Math.max(_t,Tt.expMax),su),Ht=Wt.length*2,it=3+Math.max(pr,1)+1+Ht+br.length*2,bt=Math.max(920,360+(pr+br.length*2)*80);return a.jsx("div",{className:"obe-table-wrapper",style:{width:"100%",maxWidth:"100%",overflowX:"scroll",overflowY:"hidden",WebkitOverflowScrolling:"touch",overscrollBehaviorX:"contain",scrollbarGutter:"stable",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{className:"obe-table",style:{width:"max-content",minWidth:bt,tableLayout:"auto",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsx("th",{style:cr,colSpan:it,children:n})}),a.jsxs("tr",{children:[a.jsx("th",{style:cr,rowSpan:5,children:"S.No"}),a.jsx("th",{style:cr,rowSpan:5,children:"Register No."}),a.jsx("th",{style:cr,rowSpan:5,children:"Name of the Students"}),a.jsx("th",{style:cr,colSpan:Math.max(1,pr),children:"Experiments"}),a.jsxs("th",{style:cr,rowSpan:5,children:[a.jsx("div",{children:"Total"}),a.jsx("div",{style:{fontSize:11,color:"#6b7280",fontWeight:900},children:Xe?"CIA exam":"Avg"})]}),a.jsx("th",{style:cr,colSpan:Ht,children:"CO ATTAINMENT"}),br.length?a.jsx("th",{style:cr,colSpan:br.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[pr===0?a.jsx("th",{style:cr,children:""}):a.jsx(a.Fragment,{children:Wt.map(_t=>Array.from({length:_t.expCount},(Tt,Dt)=>a.jsx("th",{style:cr,children:_t.coNumber},`v_co${_t.coNumber}_${Dt}`)))}),Wt.map(_t=>a.jsxs("th",{style:cr,colSpan:2,children:["CO-",_t.coNumber]},`v_coatt_hdr_${_t.coNumber}`)),br.map(_t=>a.jsxs("th",{style:cr,colSpan:2,children:["BTL-",_t]},`v_btl_${_t}`))]}),a.jsxs("tr",{children:[pr===0?a.jsx("th",{style:cr,children:""}):a.jsx(a.Fragment,{children:Wt.map(_t=>Array.from({length:_t.expCount},(Tt,Dt)=>a.jsx("th",{style:cr,children:_t.expMax},`v_max_${_t.coNumber}_${Dt}`)))}),Wt.map(_t=>a.jsxs(sn.Fragment,{children:[a.jsx("th",{style:cr,children:(_t.expMax+(Xe&&Wt.length?Sd/Wt.length:0)).toFixed(0)}),a.jsx("th",{style:cr,children:"%"})]},`v_comax_${_t.coNumber}`)),br.map(_t=>a.jsxs(sn.Fragment,{children:[a.jsx("th",{style:cr,children:Je}),a.jsx("th",{style:cr,children:"%"})]},`v_btlmax_${_t}`))]}),a.jsxs("tr",{children:[pr===0?a.jsx("th",{style:cr,children:"No experiments"}):a.jsx(a.Fragment,{children:Wt.map(_t=>Array.from({length:_t.expCount},(Tt,Dt)=>a.jsxs("th",{style:cr,children:["E",Dt+1]},`v_e_${_t.coNumber}_${Dt}`)))}),a.jsx("th",{style:cr,colSpan:Ht+br.length*2})]}),a.jsxs("tr",{children:[pr===0?a.jsx("th",{style:cr,children:"BTL"}):a.jsx(a.Fragment,{children:Wt.map(_t=>Array.from({length:_t.expCount},(Tt,Dt)=>a.jsx("th",{style:cr,children:_t.btl[Dt]??1},`v_btl_${_t.coNumber}_${Dt}`)))}),a.jsx("th",{style:cr,colSpan:Ht+br.length*2})]})]}),a.jsxs("tbody",{children:[y.map((_t,Tt)=>{var dr;const Dt=(dr=tt==null?void 0:tt.rowsByStudentId)==null?void 0:dr[String(_t.id)],Gt=Dt==null?void 0:Dt.ciaExam,$t=Gt===""||Gt==null?0:Number(Gt),ze=Xe&&Wt.length?(Number.isFinite($t)?$t:0)/Wt.length:0,Ze=Wt.map(Kt=>{const ye=Lj(Dt,Kt.coNumber,Kt.expCount,i,s),Ce=ye.slice(0,Kt.expCount),$e=Kt.btl.slice(0,Kt.expCount),ft=qb(Ce),at=ft!=null&&ft>0||Xe&&$t>0?Number(ft??0)+ze:null,Ut=Kt.expMax+(Xe&&Wt.length?Sd/Wt.length:0);return{coNumber:Kt.coNumber,marks:ye,visibleMarks:Ce,btls:$e,coMark:at,coMax:Ut}}),jt=Ze.flatMap(Kt=>Kt.visibleMarks),Bt=qb(jt),gr={};for(const Kt of br){const ye=[];for(const Ce of Ze)for(let $e=0;$e<Ce.visibleMarks.length;$e++)if(Ce.btls[$e]===Kt){const ft=Ce.visibleMarks[$e];typeof ft=="number"&&Number.isFinite(ft)&&ye.push(ft)}gr[Kt]=ye.length?ye.reduce((Ce,$e)=>Ce+$e,0)/ye.length:null}return a.jsxs("tr",{children:[a.jsx("td",{style:{...ur,textAlign:"center",width:42,minWidth:42},children:Tt+1}),a.jsx("td",{style:ur,children:String(_t.reg_no||"")}),a.jsx("td",{style:ur,children:String(_t.name||"")}),pr===0?a.jsx("td",{style:{...ur,textAlign:"center",color:"#6b7280"},children:""}):a.jsx(a.Fragment,{children:Ze.map(Kt=>Kt.visibleMarks.map((ye,Ce)=>a.jsx("td",{style:{...ur,width:78,minWidth:78,background:"#fff7ed",textAlign:"center",fontWeight:800},children:ye??""},`v_m_${_t.id}_co${Kt.coNumber}_${Ce}`)))}),a.jsx("td",{style:{...ur,textAlign:Xe?"center":"right",fontWeight:800,background:Xe?"#fff7ed":void 0},children:Xe?Number.isFinite($t)?$t:"":Bt==null?"":Bt.toFixed(1)}),Ze.map(Kt=>a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...ur,textAlign:"right"},children:Kt.coMark==null?"":Kt.coMark.toFixed(1)}),a.jsx("td",{style:{...ur,textAlign:"right"},children:Hb(Kt.coMark,Kt.coMax)})]},`v_coatt_${_t.id}_${Kt.coNumber}`)),br.map(Kt=>{const ye=gr[Kt]??null;return a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...ur,textAlign:"right"},children:ye==null?"":ye.toFixed(1)}),a.jsx("td",{style:{...ur,textAlign:"right"},children:Hb(ye,Je)})]},`v_btl_${_t.id}_${Kt}`)})]},`v_${_t.id}`)}),y.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:it,style:{padding:10,color:"#6b7280"},children:"No students."})}):null]})]})})})(),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{type:"button",className:"obe-btn",onClick:()=>q(!1),children:"Close"})})]})}):null]})}const EM={co1:42,co2:42,co3:58,co4:42,co5:42},Exe={1:9,2:9,3:4.5},Txe={1:3,2:3,3:1.5},Sp={1:20,2:20,3:10},Rj={1:12,2:12,3:6},Fj={1:9,2:9,3:4.5,4:9,5:9},_d={1:0,2:0,3:0,4:20,5:20},Li=5,ra=25,Lh=30;function Kr(e,t,r){return Number.isFinite(e)?Math.max(t,Math.min(r,Math.trunc(e))):t}function Vb(e,t,r){return Number.isFinite(e)?Math.max(t,Math.min(r,e)):t}function Rh(e){return Math.round(e*10)/10}function Pxe(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const o=r.localeCompare(n);if(o)return o}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim();return i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}function Cs(e,t){const r=Array.isArray(e)?e:[],n=[];for(let i=0;i<t;i++){const s=r[i];if(s===""||s==null){n.push("");continue}const o=typeof s=="number"?s:Number(s);n.push(Number.isFinite(o)?o:"")}return n}function Lu(e,t,r=1){const n=Array.isArray(e)?e:[],i=[];for(let s=0;s<t;s++){const o=n[s];if(o===""||o==null){i.push(r);continue}const l=typeof o=="number"?o:Number(o);i.push(Number.isFinite(l)&&l>=1&&l<=6?Math.trunc(l):r)}return i}function Gb(e){const t=e.filter(r=>typeof r=="number"&&Number.isFinite(r));return t.length?t.reduce((r,n)=>r+n,0)/t.length:null}function Kb(e,t){if(e==null)return"";if(!Number.isFinite(t)||t<=0)return"0";const r=e/t*100;return`${Number.isFinite(r)?r.toFixed(0):0}`}function TM(e){return e.reduce((t,r)=>t+(typeof r=="number"&&Number.isFinite(r)?r:0),0)}function Yb(e){const t=e&&typeof e=="object"?e:{},r={};for(const n of Object.keys(t)){const i=t[n];if(i===""||i==null){r[n]="";continue}const s=typeof i=="number"?i:Number(i);r[n]=Number.isFinite(s)?s:""}return r}function Bj(e){const t=e&&typeof e=="object"?e:{},r={};for(const n of Object.keys(t)){const i=t[n];if(i===""||i==null){r[n]="";continue}const s=typeof i=="number"?i:Number(i);r[n]=Number.isFinite(s)?s:""}return r}function Ij(e,t,r){return!Number.isFinite(e)||!Number.isFinite(t)||!Number.isFinite(r)||t<=0||r<=0?0:Math.max(0,e)/t*r}function Oxe(e,t,r){const n=Number(r[t]??0);if(n<=0)return 0;const i=e[String(t)];return typeof i!="number"||!Number.isFinite(i)?0:Math.max(0,Math.min(i,n))}function PM(e,t=7){const r=String(e??"").trim();return r?r.length<=t?r:r.slice(-t):""}function Mxe(e,t){return`${e}_sheet_${t}`}function Dx({subjectId:e,teachingAssignmentId:t,assessmentKey:r,label:n,coA:i,coB:s,skipMarkManager:o=!1,initialEnabledCos:l,itemLabel:c,itemLabelPlural:u,itemAbbrev:d,ciaExamAvailable:f,absentEnabled:h,autoSaveDraft:p,autoSaveDelayMs:m,viewerMode:g,floatPanelOnTable:y}){const[b,v]=x.useState([]),[w,S]=x.useState(!1),[j,k]=x.useState(null),[A,R]=x.useState(null),[M,B]=x.useState(!1),[E,P]=x.useState(null),[U,G]=x.useState(null),H=sn.useRef(!1),[oe,de]=x.useState(!1),[W,V]=x.useState(null),[ae,ee]=x.useState(!1),[C,Y]=x.useState(!1),[q,O]=x.useState(""),[X,F]=x.useState(!1),[Q,K]=x.useState(""),[ne,re]=x.useState(!1),[T,I]=x.useState(null),[ie,D]=x.useState(null),[Z,me]=x.useState(!1),[Te,je]=x.useState(null),[Le,_e]=x.useState(!1),[He,We]=x.useState(null),[Pt,dt]=x.useState(!1),[Ye,lt]=x.useState(null),[be,ke]=x.useState(!1),[ce,we]=x.useState(null),[ht,nt]=x.useState(null),Ie=String(c||"Experiment"),It=String(u||"Experiments"),ct=String(d||"E"),Mt=f!==!1,xr=!!(h??r==="model"),Pr=!!p,Nt=Kr(Number(m??900),250,5e3),Jr=x.useMemo(()=>{const Ee=(Array.isArray(l)&&l.length?l:[i,s].filter(et=>typeof et=="number"&&Number.isFinite(et))).map(et=>Kr(Number(et),1,5));return Array.from(new Set(Ee)).sort((et,Be)=>et-Be)},[i,s,l]),Ur=x.useMemo(()=>new Set(Jr.map(fe=>String(fe))),[Jr]),qr=x.useRef(null),cn=x.useRef(null),Pn=x.useMemo(()=>e?Mxe(r,String(e)):"",[r,e]),{data:Lr,publishAllowed:mn,remainingSeconds:Me,refresh:qe}=V0({assessment:r,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:ut,refresh:wt}=G0({assessment:r,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:At}=lc({assessment:r,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!0}}),{data:sr,refresh:Zt}=lc({assessment:r,subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:t,options:{poll:!0}}),[Cr,se]=x.useState(null),ue=!!W||!!(ut!=null&&ut.exists&&(ut!=null&&ut.is_published));x.useEffect(()=>{if(ut!=null&&ut.is_published&&(ut!=null&&ut.updated_at)&&!W)try{V(new Date(String(ut.updated_at)).toLocaleString())}catch{V(String(ut.updated_at))}},[ut==null?void 0:ut.is_published,ut==null?void 0:ut.updated_at]);const J=ut!=null&&ut.mark_entry_unblocked_until?String(ut.mark_entry_unblocked_until):null,pe=ut!=null&&ut.mark_manager_unlocked_until?String(ut.mark_manager_unlocked_until):null,xe=!!J&&!!(ut!=null&&ut.entry_open)&&(Cr==null||J!==(Cr.markEntryUnblockedUntil??null)),Ne=!!pe&&(Cr==null||pe!==(Cr.markManagerUnlockedUntil??null)),St=ue?!!(ut!=null&&ut.entry_open)&&(Cr==null||xe||Ne):!0,Ve=!!(ue&&!St),De=!!(ue&&Ve&&!g),{pending:Re,pendingUntilMs:xt,setPendingUntilMs:Vt,refresh:qt}=K0({enabled:!!De&&!!e,assessment:r,subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:t});Y0(!!He||ae||C||ce&&ce.visible||ht&&ht.visible);const zt=!!(Lr!=null&&Lr.global_override_active&&(Lr==null?void 0:Lr.global_is_open)===!1),[vt,Lt]=x.useState(()=>({sheet:{termLabel:"KRCT AY25-26",batchLabel:String(e||""),coANum:Kr(Number(i??1),1,5),coBNum:s==null?null:Kr(Number(s),1,5),coAEnabled:!0,coBEnabled:!!s,ciaExamEnabled:!!Mt,ciaExamMax:Lh,expCountA:Li,expCountB:s?Li:0,expMaxA:ra,expMaxB:s?ra:0,btlA:Array.from({length:Li},()=>1),btlB:s?Array.from({length:Li},()=>1):[],coConfigs:Object.fromEntries((Array.isArray(l)&&l.length?l:[i,s].filter(fe=>typeof fe=="number"&&Number.isFinite(fe))).map(fe=>Kr(Number(fe),1,5)).filter((fe,Ee,et)=>et.indexOf(fe)===Ee).map(fe=>[String(fe),{enabled:!0,expCount:Li,expMax:ra,btl:Array.from({length:Li},()=>1)}])),rowsByStudentId:{},markManagerLocked:!1,markManagerSnapshot:null}}));x.useEffect(()=>{if(!Jr.length||vt.sheet.markManagerSnapshot)return;const fe=vt.sheet.coConfigs&&typeof vt.sheet.coConfigs=="object"?vt.sheet.coConfigs:{},Ee=Jr.filter(et=>!fe[String(et)]);Ee.length&&Lt(et=>{const kt={...et.sheet.coConfigs&&typeof et.sheet.coConfigs=="object"?et.sheet.coConfigs:{}};for(const ar of Ee)kt[String(ar)]={enabled:!0,expCount:Li,expMax:ra,btl:Array.from({length:Li},()=>1)};return{...et,sheet:{...et.sheet,coConfigs:kt}}})},[vt.sheet.coConfigs,vt.sheet.markManagerSnapshot,Jr]);const[er,yr]=x.useState(null),Br=x.useMemo(()=>ni(er),[er]),cr=x.useMemo(()=>C3(er),[er]),ur=Br==="TCPR",en=x.useMemo(()=>Br==="LAB"||Br==="TCPL"||Br==="TCPR"||Br==="PRACTICAL"||Br==="PROJECT",[Br]),nn=Br==="LAB",gn=en&&!nn&&!ur;x.useEffect(()=>{let fe=!0;return(async()=>{try{const Ee=await oc();if(!fe)return;Lt(et=>({...et,sheet:{...et.sheet,termLabel:String((Ee==null?void 0:Ee.termLabel)||et.sheet.termLabel||"KRCT AY25-26"),batchLabel:String(e||et.sheet.batchLabel||"")}}))}catch{}})(),()=>{fe=!1}},[e]),x.useEffect(()=>{let fe=!0;return(async()=>{if(e)try{const Ee=String(e).trim().toUpperCase(),et=await Sl();if(!fe)return;const Be=(et||[]).find(Rt=>String(Rt.course_code||"").trim().toUpperCase()===Ee);if(Be&&(Be!=null&&Be.class_type)){yr((Be==null?void 0:Be.class_type)??null);return}const kt=await Yd();if(!fe)return;const ar=(kt||[]).find(Rt=>String(Rt.course_code||"").trim().toUpperCase()===Ee);yr((ar==null?void 0:ar.class_type)??null)}catch{fe&&yr(null)}})(),()=>{fe=!1}},[e]),x.useEffect(()=>{let fe=!0;return H.current=!1,(async()=>{var Ee,et;if(e){try{const Be=await ri(r,String(e));if(!fe)return;const kt=Be==null?void 0:Be.draft;if(kt&&typeof kt=="object"&&kt.sheet&&typeof kt.sheet=="object"){const ar=Kr(Number(i??1),1,5),Rt=s==null?null:Kr(Number(s),1,5),jr=ar,_r=Rt,Hr=!!(kt.sheet.coAEnabled??!0),Mr=!!(kt.sheet.coBEnabled??!!_r),Qr=Mt?!!(kt.sheet.ciaExamEnabled??!0):!1,Vr=Kr(Number(kt.sheet.ciaExamMax??Lh),0,100),Xt=Kr(Number(kt.sheet.expCountA??Li),0,12),vn=Kr(Number(kt.sheet.expCountB??(Mr?Li:0)),0,12),hn=Number.isFinite(Number(kt.sheet.expMaxA))?Number(kt.sheet.expMaxA):ra,kn=Number.isFinite(Number(kt.sheet.expMaxB))?Number(kt.sheet.expMaxB):Mr?ra:0,_n=Lu(kt.sheet.btlA,Xt,1),yn=Lu(kt.sheet.btlB,vn,1),ci=kt.sheet.coConfigs,Wn={};if(ci&&typeof ci=="object")for(const Bi of Object.keys(ci)){const Aa=ci[Bi]||{},ro=Kr(Number(Aa.expCount??Li),0,12);Wn[Bi]={enabled:!!Aa.enabled,expCount:ro,expMax:Number.isFinite(Number(Aa.expMax))?Number(Aa.expMax):ra,btl:Lu(Aa.btl,ro,1)}}const mi=String(jr);if(Wn[mi]||(Wn[mi]={enabled:Hr,expCount:Xt,expMax:hn,btl:_n}),_r!=null){const Bi=String(_r);Wn[Bi]||(Wn[Bi]={enabled:Mr,expCount:vn,expMax:kn,btl:yn})}const Jn=!!(((Ee=Wn[String(jr)])==null?void 0:Ee.enabled)??Hr),ca=!!(_r!=null&&(((et=Wn[String(_r)])==null?void 0:et.enabled)??Mr)),Rl=Bi=>{const Aa=Bi&&typeof Bi=="object"?Bi:{},ro={};for(const[Au,Ci]of Object.entries(Aa)){const Hn=Ci&&typeof Ci=="object"?Ci:{},Yi=Hn!=null&&Hn.marksByCo&&typeof Hn.marksByCo=="object"?{...Hn.marksByCo}:{},_s=Hn==null?void 0:Hn.ciaExam,hd=_s===""||_s==null?"":Number.isFinite(Number(_s))?Vb(Number(_s),0,Vr):"",Xc=Cs(Hn==null?void 0:Hn.marksA,Xt),gc=Cs(Hn==null?void 0:Hn.marksB,vn),xc=Cs(Yi[mi],Xt),Yo=_r!=null?Cs(Yi[String(_r)],vn):[],no=Fl=>Fl.some(Bl=>Bl!==""&&Bl!=null),pl=no(Xc)?Xc:no(xc)?xc:Xc,yc=vn?no(gc)?gc:no(Yo)?Yo:gc:gc;Yi[mi]=xc,_r!=null&&(Yi[String(_r)]=Yo),ro[String(Au)]={...Hn,studentId:Number.isFinite(Number(Hn==null?void 0:Hn.studentId))?Number(Hn.studentId):Number(Au),marksA:pl,marksB:yc,marksByCo:Yi,ciaExam:hd,caaExamByCo:Yb(Hn==null?void 0:Hn.caaExamByCo),ciaExamByCo:Bj(Hn==null?void 0:Hn.ciaExamByCo)}}return ro},Ko=kt.sheet.markManagerSnapshot??null,So=kt.sheet.markManagerApprovalUntil??null,_o=kt.sheet.markManagerLocked,Ss=typeof _o=="boolean"?_o:!!Ko;Lt({sheet:{termLabel:String(kt.sheet.termLabel||"KRCT AY25-26"),batchLabel:String(e),coANum:jr,coBNum:_r,coAEnabled:Jn,coBEnabled:ca,ciaExamEnabled:Qr,ciaExamMax:Vr,expCountA:Xt,expCountB:vn,expMaxA:hn,expMaxB:kn,btlA:_n,btlB:yn,coConfigs:Wn,rowsByStudentId:Rl(kt.sheet.rowsByStudentId),markManagerLocked:Ss,markManagerSnapshot:Ko,markManagerApprovalUntil:So}});const ba=(Be==null?void 0:Be.updated_at)??null,cs=(Be==null?void 0:Be.updated_by)??null;if(ba)try{P(new Date(String(ba)).toLocaleString())}catch{P(String(ba))}cs&&G(String(cs.name||cs.username||cs.id||""));try{Pn&&Kn(Pn,{rowsByStudentId:kt.sheet.rowsByStudentId||{}})}catch{}}else{const ar=Pn?Zn(Pn):null,Rt=ar!=null&&ar.rowsByStudentId&&typeof ar.rowsByStudentId=="object"?ar.rowsByStudentId:{},jr=Kr(Number(i??1),1,5),_r=s==null?null:Kr(Number(s),1,5),Hr=Li,Mr=_r!=null?Li:0,Qr=ra,Vr=_r!=null?ra:0,Xt=Array.from({length:Hr},()=>1),vn=_r!=null?Array.from({length:Mr},()=>1):[],hn={[String(jr)]:{enabled:!0,expCount:Hr,expMax:Qr,btl:Xt},..._r==null?{}:{[String(_r)]:{enabled:!0,expCount:Mr,expMax:Vr,btl:vn}}};Lt({sheet:{termLabel:"KRCT AY25-26",batchLabel:String(e||""),coANum:jr,coBNum:_r,coAEnabled:!0,coBEnabled:!!_r,ciaExamEnabled:!!Mt,ciaExamMax:Lh,expCountA:Hr,expCountB:Mr,expMaxA:Qr,expMaxB:Vr,btlA:Xt,btlB:vn,coConfigs:hn,rowsByStudentId:Rt,markManagerLocked:!1,markManagerSnapshot:null}})}}catch{}fe&&(H.current=!0)}})(),()=>{fe=!1}},[r,e,Pn,i,s]),x.useEffect(()=>{let fe=!0;return(async()=>{var Ee,et,Be;if(!t){v([]);return}S(!0),k(null);try{let kt=null;try{const Rt=await mr(`/api/academics/teaching-assignments/${t}/`);if(Rt.ok){const jr=await Rt.json();if(jr&&jr.elective_subject_id&&!jr.section_id){const _r=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(jr.elective_subject_id))}`);if(_r.ok){const Hr=await _r.json();kt=(Array.isArray(Hr.results)?Hr.results:Array.isArray(Hr)?Hr:Hr.items||[]).map(Qr=>({id:Number(Qr.student_id??Qr.id),reg_no:String(Qr.reg_no??Qr.regno??""),name:String(Qr.name??Qr.full_name??Qr.username??""),section:Qr.section_name??Qr.section??null}))}}}}catch{}if(!kt){const Rt=await pc(t);R({courseName:String(((Ee=Rt==null?void 0:Rt.teaching_assignment)==null?void 0:Ee.subject_name)||""),courseCode:String(((et=Rt==null?void 0:Rt.teaching_assignment)==null?void 0:et.subject_code)||e||""),className:String(((Be=Rt==null?void 0:Rt.teaching_assignment)==null?void 0:Be.section_name)||"")}),kt=((Rt==null?void 0:Rt.students)||[]).map(_r=>({id:Number(_r.id),reg_no:String(_r.reg_no??""),name:String(_r.name??""),section:_r.section??null}))}if(!fe)return;const ar=(kt||[]).filter(Rt=>Number.isFinite(Rt.id)).sort(Pxe);v(ar),Lt(Rt=>{const jr=Kr(Number(Rt.sheet.expCountA??Li),0,12),_r=Kr(Number(Rt.sheet.expCountB??0),0,12),Hr={...Rt.sheet.rowsByStudentId||{}};for(const Mr of ar){const Qr=String(Mr.id);Hr[Qr]||(Hr[Qr]={studentId:Mr.id,absent:!1,absentKind:void 0,marksA:Array.from({length:jr},()=>""),marksB:Array.from({length:_r},()=>""),marksByCo:{},caaExamByCo:{},ciaExamByCo:{},ciaExam:""})}return{...Rt,sheet:{...Rt.sheet,rowsByStudentId:Hr}}})}catch(kt){if(!fe)return;v([]),k((kt==null?void 0:kt.message)||"Failed to load roster")}finally{fe&&S(!1)}})(),()=>{fe=!1}},[t]),x.useEffect(()=>{if(Pn)try{Kn(Pn,{rowsByStudentId:vt.sheet.rowsByStudentId})}catch{}},[vt.sheet.rowsByStudentId,Pn]),x.useEffect(()=>{if(!e||!!!vt.sheet.markManagerSnapshot)return;if(ue&&(ut!=null&&ut.exists)){const Be=!!(ut!=null&&ut.mark_manager_locked);!!vt.sheet.markManagerLocked!==Be&&Lt(kt=>({...kt,sheet:{...kt.sheet,markManagerLocked:Be}}));return}const Ee=!!(At!=null&&At.allowed_by_approval),et=At!=null&&At.approval_until?String(At.approval_until):null;if(Ee&&et){const Be=vt.sheet.markManagerApprovalUntil?String(vt.sheet.markManagerApprovalUntil):null;vt.sheet.markManagerLocked&&Be!==et&&Lt(kt=>({...kt,sheet:{...kt.sheet,markManagerLocked:!1,markManagerApprovalUntil:et}}));return}vt.sheet.markManagerLocked||Lt(Be=>({...Be,sheet:{...Be.sheet,markManagerLocked:!0}}))},[e,ue,ut==null?void 0:ut.exists,ut==null?void 0:ut.mark_manager_locked,At==null?void 0:At.allowed_by_approval,At==null?void 0:At.approval_until,vt.sheet.markManagerLocked,vt.sheet.markManagerSnapshot,vt.sheet.markManagerApprovalUntil]);const nr=Kr(Number(vt.sheet.coANum??i??1),1,5),Tr=vt.sheet.coBNum??s??null,Dr=Tr==null?null:Kr(Number(Tr),1,5),Rr=x.useMemo(()=>[1,2,3,4,5],[]),tt=x.useMemo(()=>new Set(Rr.map(fe=>String(fe))),[Rr]);Kr(Number(vt.sheet.expCountA??Li),0,12),Kr(Number(vt.sheet.expCountB??0),0,12),vt.sheet.coAEnabled,vt.sheet.coBEnabled&&Dr!=null;const Xe=x.useMemo(()=>jt(vt.sheet),[vt.sheet]),ot=!!vt.sheet.markManagerLocked,Wt=Mt?vt.sheet.ciaExamEnabled!==!1:!1,pr=x.useMemo(()=>ur?Kr(Number(vt.sheet.ciaExamMax??Lh),0,100):Lh,[ur,vt.sheet.ciaExamMax]);x.useMemo(()=>Bt(Xe,Wt),[Xe,Wt]);const Nr=!St,br=x.useMemo(()=>Object.entries(Xe||{}).filter(([fe,Ee])=>tt.has(String(fe))&&!!(Ee&&Ee.enabled)).map(([fe,Ee])=>({coNumber:Number(fe),expCount:Kr(Number(Ee.expCount??0),0,12),expMax:Kr(Number(Ee.expMax??0),0,100),btl:Ee.btl??[]})),[Xe,tt]),Je=x.useMemo(()=>br.reduce((fe,Ee)=>fe+Ee.expCount,0),[br]),Ht=Math.max(Je,1),it=br.length>0,bt=x.useMemo(()=>br.filter(fe=>Number.isFinite(Number(Sp[fe.coNumber]))),[br]),_t=bt.length,Tt=x.useMemo(()=>nn&&Wt?br.filter(fe=>Number(_d[fe.coNumber]||0)>0):[],[br,nn,Wt]),Dt=nn?Wt?Tt.length:0:Wt?gn?Math.max(_t,1):1:0,Gt=it?br.length*2:2,$t=x.useMemo(()=>br.reduce((fe,Ee)=>Math.max(fe,Ee.expMax),0),[br]);x.useMemo(()=>{if(!xr)return!1;const fe=vt.sheet.rowsByStudentId||{};return Object.values(fe).some(Ee=>!!(Ee!=null&&Ee.absent))},[xr,vt.sheet.rowsByStudentId]);function ze(fe,Ee){const et=fe==null?void 0:fe.marksByCo;return Ee.map(Be=>{const kt=et&&typeof et=="object"?et[String(Be.coNumber)]:void 0,ar=Be.coNumber===nr?fe==null?void 0:fe.marksA:Be.coNumber===Dr?fe==null?void 0:fe.marksB:void 0,Rt=Cs(kt??ar,Be.expCount);return{coNumber:Be.coNumber,expCount:Be.expCount,expMax:Be.expMax,marks:Rt}})}function Ze(fe,Ee){const et=Yb(fe==null?void 0:fe.caaExamByCo),Be=Bj(fe==null?void 0:fe.ciaExamByCo),kt=Wt&&typeof(fe==null?void 0:fe.ciaExam)=="number"&&Number.isFinite(fe==null?void 0:fe.ciaExam)?Number(fe==null?void 0:fe.ciaExam):null;if(nn){const Hr=Ee.map(Vr=>{const Xt=TM(Vr.marks),vn=Math.max(0,Vr.expCount)*Math.max(0,Vr.expMax),hn=Number(Fj[Vr.coNumber]||0),kn=Wt?Oxe(Be,Vr.coNumber,_d):0,_n=Ij(Xt,vn,hn),ci=Xt>0||kn>0?Rh(_n+kn):null,Wn=Rh(hn+(Wt?Number(_d[Vr.coNumber]||0):0));return{coNumber:Vr.coNumber,mark:ci,coMax:Wn}}),Mr=Hr.reduce((Vr,Xt)=>Vr+(typeof Xt.mark=="number"&&Number.isFinite(Xt.mark)?Xt.mark:0),0),Qr=Hr.some(Vr=>typeof Vr.mark=="number"&&Number.isFinite(Vr.mark));return{caaByCo:et,ciaByCo:Be,ciaExamNumLegacy:kt,coAttainmentValues:Hr,hasAnyMarks:Qr,finalTotal:Qr?Rh(Mr):""}}if(gn){let Hr=0,Mr=!1;const Qr=Ee.map(Vr=>{const Xt=TM(Vr.marks),vn=Math.max(0,Vr.expCount)*Math.max(0,Vr.expMax),hn=Number(Exe[Vr.coNumber]||0),kn=Number(Txe[Vr.coNumber]||0),_n=Number(Sp[Vr.coNumber]||0),yn=Number(Rj[Vr.coNumber]||0),ci=Ij(Xt,vn,hn),Wn=et[String(Vr.coNumber)],mi=typeof Wn=="number"&&Number.isFinite(Wn)?Wn:0,Jn=Ij(mi,_n,kn),ca=ci+Jn;return(Xt>0||mi>0)&&(Mr=!0),Hr+=ca,{coNumber:Vr.coNumber,mark:Mr?ca:null,coMax:yn}});return{caaByCo:et,ciaByCo:Be,ciaExamNumLegacy:kt,coAttainmentValues:Qr.map(Vr=>({...Vr,mark:Mr?Vr.mark:null})),hasAnyMarks:Mr,finalTotal:Mr?Rh(Hr):""}}const ar=Ee.flatMap(Hr=>Hr.marks),Rt=Gb(ar),jr=Rt!=null||Wt&&kt!=null,_r=Ee.map(Hr=>{const Mr=Gb(Hr.marks),Qr=jr?(Mr??0)+(Wt?(kt??0)/2:0):null,Vr=EM[`co${Hr.coNumber}`],Xt=Array.from({length:Kr(Number(Hr.expCount??0),0,12)}).map(()=>Kr(Number(Hr.expMax??ra),0,100)),vn=Xt.length?Xt.reduce((_n,yn)=>_n+yn,0)/Xt.length:0,hn=cr&&Number.isFinite(Number(Vr))?Number(Vr):vn,kn=Math.round(hn+(Wt?pr/2:0)||0);return{coNumber:Hr.coNumber,mark:Qr,coMax:kn}});return{caaByCo:et,ciaByCo:Be,ciaExamNumLegacy:kt,coAttainmentValues:_r,hasAnyMarks:jr,finalTotal:Rt==null&&kt==null?"":Rh((Rt??0)+(kt??0))}}x.useMemo(()=>!g&&ue&&!St?[]:!xr||!Le?b:b.filter(fe=>{var Ee,et;return!!((et=(Ee=vt.sheet.rowsByStudentId)==null?void 0:Ee[String(fe.id)])!=null&&et.absent)}),[g,ue,St,xr,b,Le,vt.sheet.rowsByStudentId]),x.useEffect(()=>{if(!Pr||!e||!H.current||Nr||Ve)return;cn.current!=null&&(window.clearTimeout(cn.current),cn.current=null);const fe=JSON.stringify(vt);if(fe!==qr.current)return cn.current=window.setTimeout(async()=>{if(e)try{B(!0),await Fi(r,String(e),vt),qr.current=fe,P(new Date().toLocaleString())}catch{}finally{B(!1)}},Nt),()=>{cn.current!=null&&(window.clearTimeout(cn.current),cn.current=null)}},[Pr,Nt,r,vt,Ve,e,Nr]);function jt(fe){const et={...fe.coConfigs&&typeof fe.coConfigs=="object"?fe.coConfigs:{}};for(const Be of[1,2,3,4,5]){const kt=String(Be),ar=et[kt];if(!ar)et[kt]={enabled:Ur.has(kt),expCount:Li,expMax:ra,btl:Array.from({length:Li},()=>1)};else{const Rt=Kr(Number(ar.expCount??Li),0,12);et[kt]={enabled:!!ar.enabled,expCount:Rt,expMax:Kr(Number(ar.expMax??ra),0,100),btl:Lu(ar.btl,Rt,1)}}}return et}function Bt(fe,Ee){const et=Object.entries(fe).filter(([Be,kt])=>tt.has(String(Be))&&!!(kt!=null&&kt.enabled)).map(([Be,kt])=>({co:Kr(Number(Be),1,5),expCount:Kr(Number((kt==null?void 0:kt.expCount)??0),0,12),expMax:Kr(Number((kt==null?void 0:kt.expMax)??0),0,100)})).sort((Be,kt)=>Be.co-kt.co);return JSON.stringify({enabled:et,ciaExamEnabled:!!Ee})}function gr(fe){if(!fe)return null;try{const Ee=JSON.parse(String(fe)),et=Array.isArray(Ee==null?void 0:Ee.enabled)?Ee.enabled:[],Be={};for(const kt of[1,2,3,4,5])Be[String(kt)]={enabled:!1,expCount:Li,expMax:ra,btl:Array.from({length:Li},()=>1)};for(const kt of et){const ar=Kr(Number(kt==null?void 0:kt.co),1,5);Be[String(ar)]={...Be[String(ar)],enabled:!0,expCount:Kr(Number((kt==null?void 0:kt.expCount)??Li),0,12),expMax:Kr(Number((kt==null?void 0:kt.expMax)??ra),0,100)}}return Be}catch{return null}}function dr(fe,Ee,et,Be){if(!fe)return 0;const kt=new Set(Ee.map(Rt=>String(Rt)));let ar=0;for(const Rt of Object.values(fe)){if(!Rt||typeof Rt!="object")continue;const jr=Rt.marksByCo&&typeof Rt.marksByCo=="object"?Rt.marksByCo:{};let _r=!1;for(const Hr of Ee){const Mr=String(Hr);if(!kt.has(Mr))continue;const Qr=jr[Mr];if(Array.isArray(Qr)&&Qr.some(Vr=>Vr!==""&&Vr!=null)){_r=!0;break}if(!_r&&Hr===et&&Array.isArray(Rt.marksA)&&Rt.marksA.some(Vr=>Vr!==""&&Vr!=null)&&(_r=!0),!_r&&Be!=null&&Hr===Be&&Array.isArray(Rt.marksB)&&Rt.marksB.some(Vr=>Vr!==""&&Vr!=null)&&(_r=!0),_r)break}_r&&ar++}return ar}function Kt(fe){return Object.entries(fe).filter(([Ee,et])=>tt.has(String(Ee))&&!!(et!=null&&et.enabled)).map(([Ee])=>Kr(Number(Ee),1,5)).sort((Ee,et)=>Ee-et)}function ye(fe,Ee){const et=[],Be=[],kt=[];for(const ar of[1,2,3,4,5]){const Rt=String(ar),jr=fe[Rt],_r=Ee[Rt],Hr=!!(jr!=null&&jr.enabled),Mr=!!(_r!=null&&_r.enabled);if(!jr&&_r){Mr&&et.push(ar);continue}if(jr&&!_r){Hr&&Be.push(ar);continue}if(jr&&_r){const Qr=Kr(Number(jr.expCount??0),0,12),Vr=Kr(Number(_r.expCount??0),0,12),Xt=Kr(Number(jr.expMax??0),0,100),vn=Kr(Number(_r.expMax??0),0,100);(Hr!==Mr||Qr!==Vr||Xt!==vn)&&kt.push(ar)}}return{added:et,removed:Be,changed:kt}}function Ce(fe,Ee){if(!fe)return 0;let et=0;for(const Be of Object.values(fe)){if(!Be||typeof Be!="object")continue;if(Array.isArray(Be.marksA)&&Be.marksA.some(jr=>jr!==""&&jr!=null)||Array.isArray(Be.marksB)&&Be.marksB.some(jr=>jr!==""&&jr!=null)||Be.ciaExam!==""&&Be.ciaExam!=null){et++;continue}const ar=Be.marksByCo&&typeof Be.marksByCo=="object"?Be.marksByCo:{};let Rt=!1;for(const jr of Ee){const _r=ar[String(jr)];if(Array.isArray(_r)&&_r.some(Hr=>Hr!==""&&Hr!=null)){Rt=!0;break}}Rt&&et++}return et}function $e(fe){Lt(Ee=>!Mt||Ee.sheet.markManagerLocked?Ee:{...Ee,sheet:{...Ee.sheet,ciaExamEnabled:!!fe}})}function ft(fe){ur&&Lt(Ee=>{if(!Mt||Ee.sheet.markManagerLocked)return Ee;const et=Kr(Number(fe),0,100),Be={...Ee.sheet.rowsByStudentId||{}};for(const[kt,ar]of Object.entries(Be)){const Rt=ar&&typeof ar=="object"?ar:{},jr=Rt==null?void 0:Rt.ciaExam;typeof jr=="number"&&Number.isFinite(jr)&&(Be[kt]={...Rt,ciaExam:Vb(jr,0,et)})}return{...Ee,sheet:{...Ee.sheet,ciaExamMax:et,rowsByStudentId:Be}}})}function Sr(fe,Ee){Lt(et=>{var jr;const Be=String(fe),kt=(jr=et.sheet.rowsByStudentId)==null?void 0:jr[Be];if(!kt)return et;const ar=Kr(Number(et.sheet.expCountA??Li),0,12),Rt=Kr(Number(et.sheet.expCountB??0),0,12);return Ee?{...et,sheet:{...et.sheet,rowsByStudentId:{...et.sheet.rowsByStudentId,[Be]:{...kt,absent:!0,absentKind:kt.absentKind||"AL",marksA:Array.from({length:ar},()=>""),marksB:Array.from({length:Rt},()=>""),caaExamByCo:{},ciaExamByCo:{},ciaExam:""}}}}:{...et,sheet:{...et.sheet,rowsByStudentId:{...et.sheet.rowsByStudentId,[Be]:{...kt,absent:!1,absentKind:void 0}}}}})}function at(fe,Ee){Lt(et=>{var ar;const Be=String(fe),kt=(ar=et.sheet.rowsByStudentId)==null?void 0:ar[Be];return kt?{...et,sheet:{...et.sheet,rowsByStudentId:{...et.sheet.rowsByStudentId,[Be]:{...kt,absent:!0,absentKind:Ee}}}}:et})}function Ut(fe,Ee){const et=Kr(Number(fe),1,5);Lt(Be=>{if(Be.sheet.markManagerLocked)return Be;const kt=jt(Be.sheet),ar=String(et),Rt=kt[ar],jr=Kr(Number((Rt==null?void 0:Rt.expCount)??Li),0,12),_r=Kr(Number((Rt==null?void 0:Rt.expMax)??ra),0,100),Hr=Lu((Rt==null?void 0:Rt.btl)??[],jr,1);kt[ar]={enabled:!!Ee,expCount:jr,expMax:_r,btl:Hr};const Mr=Kr(Number(Be.sheet.coANum??i??1),1,5),Qr=Be.sheet.coBNum??s??null,Vr=Qr==null?null:Kr(Number(Qr),1,5),Xt={...Be.sheet,coConfigs:kt};return et===Mr&&(Xt.coAEnabled=!!Ee),Vr!=null&&et===Vr&&(Xt.coBEnabled=!!Ee),{...Be,sheet:Xt}})}async function Fe(){if(!e)return;dt(!0),lt(null);const fe=new Date,Ee=ut!=null&&ut.mark_manager_unlocked_until?String(ut.mark_manager_unlocked_until):null;try{const et=await sl({assessment:r,subject_code:String(e),scope:"MARK_MANAGER",reason:`Edit request: Mark Manager changes for ${n}`,teaching_assignment_id:t});alert(ol(et));const Be=Number(et==null?void 0:et.id),kt=fe.getTime()-2e3;(async()=>{for(let jr=0;jr<36;jr++){try{const _r=await Bm({assessment:r,subject_code:String(e),scope:"MARK_MANAGER",teaching_assignment_id:t}),Hr=_r==null?void 0:_r.result;if(!Hr)throw new Error("No status");if(Number.isFinite(Be)&&Be>0&&Number(Hr.id)!==Be)throw new Error("Different request");const Mr=Hr.reviewed_at?new Date(String(Hr.reviewed_at)).getTime():0,Qr=String(Hr.status||"").toUpperCase();if(Qr==="APPROVED"&&Mr>=kt){try{wt({silent:!0})}catch{}alert("IQAC approved the mark-manager edit request. You can now edit mark-manager settings.");return}if(Qr==="REJECTED"&&Mr>=kt){alert("IQAC rejected the mark-manager edit request.");return}}catch{try{const _r=ut!=null&&ut.mark_manager_unlocked_until?String(ut.mark_manager_unlocked_until):null;if(_r&&Ee&&_r!==Ee){try{wt({silent:!0})}catch{}alert("IQAC approved the mark-manager edit request. You can now edit mark-manager settings.");return}}catch{}}await new Promise(_r=>setTimeout(_r,5e3))}alert("Edit request still pending. Please try again later.")})()}catch(et){const Be=ll(et,"Request failed");lt(Be),alert(`Edit request failed: ${Be}`)}finally{dt(!1)}}async function Ue(fe,Ee=[]){if(e){dt(!0),lt(null);try{const et=Kr(Number(i??1),1,5),Be=s==null?null:Kr(Number(s),1,5),kt=Bt(Xe,Wt),ar=At!=null&&At.approval_until?String(At.approval_until):vt.sheet.markManagerApprovalUntil||null,Rt=Xe[String(et)],jr=Be==null?null:Xe[String(Be)],_r=!!(Rt!=null&&Rt.enabled),Hr=!!(Be!=null&&(jr!=null&&jr.enabled)),Mr=Kr(Number((Rt==null?void 0:Rt.expCount)??vt.sheet.expCountA??Li),0,12),Qr=Kr(Number((Rt==null?void 0:Rt.expMax)??vt.sheet.expMaxA??ra),0,100),Vr=Lu((Rt==null?void 0:Rt.btl)??vt.sheet.btlA,Mr,1),Xt=Be==null?0:Kr(Number((jr==null?void 0:jr.expCount)??vt.sheet.expCountB??Li),0,12),vn=Be==null?0:Kr(Number((jr==null?void 0:jr.expMax)??vt.sheet.expMaxB??ra),0,100),hn=Be==null?[]:Lu((jr==null?void 0:jr.btl)??vt.sheet.btlB,Xt,1),kn=new Set(fe==="full"?[1,2,3,4,5].map(String):fe==="partial"?Ee.map(Wn=>String(Kr(Number(Wn),1,5))):[]),_n=(Wn,mi,Jn)=>{const ca=Wn!=null&&Wn.marksByCo&&typeof Wn.marksByCo=="object"?Wn.marksByCo:{};return Cs(ca[mi],Jn)},yn=Wn=>Wn.some(mi=>mi!==""&&mi!=null),ci={...vt,sheet:{...vt.sheet,coANum:et,coBNum:Be,coAEnabled:_r,coBEnabled:Hr,expCountA:Mr,expCountB:Xt,expMaxA:Qr,expMaxB:vn,btlA:Vr,btlB:hn,coConfigs:Xe,markManagerLocked:!0,markManagerSnapshot:kt,markManagerApprovalUntil:ar,rowsByStudentId:Object.fromEntries(Object.entries(vt.sheet.rowsByStudentId||{}).map(([Wn,mi])=>{const Jn=mi&&typeof mi=="object"?mi:{};let ca=Jn!=null&&Jn.marksByCo&&typeof Jn.marksByCo=="object"?{...Jn.marksByCo}:{};if(fe==="full")ca={},Jn.marksA=Array.from({length:Mr},()=>""),Jn.marksB=Array.from({length:Xt},()=>""),Jn.caaExamByCo={},Jn.ciaExamByCo={},Jn.ciaExam="";else if(fe==="partial"&&kn.size){const cs=Yb(Jn.caaExamByCo);for(const Bi of Array.from(kn)){const Aa=Xe[String(Bi)],ro=Kr(Number((Aa==null?void 0:Aa.expCount)??0),0,12);ro>0?ca[String(Bi)]=Array.from({length:ro},()=>""):delete ca[String(Bi)],Object.prototype.hasOwnProperty.call(cs,String(Bi))&&(cs[String(Bi)]=""),Number(Bi)===et&&(Jn.marksA=Array.from({length:Mr},()=>"")),Be!=null&&Number(Bi)===Be&&(Jn.marksB=Array.from({length:Xt},()=>""))}Jn.caaExamByCo=cs}const Rl=Cs(Jn==null?void 0:Jn.marksA,Mr),Ko=Cs(Jn==null?void 0:Jn.marksB,Xt),So=Cs(ca[String(et)]??_n(Jn,String(et),Mr),Mr),_o=Be==null?[]:Cs(ca[String(Be)]??_n(Jn,String(Be),Xt),Xt),Ss=yn(Rl)?Rl:yn(So)?So:Rl,ba=Xt?yn(Ko)?Ko:yn(_o)?_o:Ko:Ko;return ca[String(et)]=So,Be!=null&&(ca[String(Be)]=_o),[Wn,{...Jn,marksA:Ss,marksB:ba,marksByCo:ca}]}))}};Lt(ci),We(null),nt(null),ke(!0),await Fi(r,String(e),ci),P(new Date().toLocaleString());try{await fh(r,String(e),t),wt({silent:!0})}catch(Wn){console.warn("confirmMarkManagerLock failed",Wn)}}catch(et){lt((et==null?void 0:et.message)||"Save failed")}finally{dt(!1),setTimeout(()=>ke(!1),2e3)}}}function Ct(fe,Ee){const et=Kr(Number(Ee),0,12);Lt(Be=>{if(Be.sheet.markManagerLocked)return Be;const kt=jt(Be.sheet),ar=String(fe),Rt=kt[ar],jr=Kr(Number((Rt==null?void 0:Rt.expMax)??ra),0,100);kt[ar]={enabled:!!((Rt==null?void 0:Rt.enabled)??!0),expCount:et,expMax:jr,btl:Lu((Rt==null?void 0:Rt.btl)??[],et,1)};const _r=Kr(Number(Be.sheet.coANum??i??1),1,5),Hr=Be.sheet.coBNum??s??null,Mr=Hr==null?null:Kr(Number(Hr),1,5),Qr={...Be.sheet.rowsByStudentId||{}};for(const Vr of Object.keys(Qr)){const Xt=Qr[Vr],vn=Xt!=null&&Xt.marksByCo&&typeof Xt.marksByCo=="object"?{...Xt.marksByCo}:{};vn[ar]=Cs(vn[ar],et);const hn={...Xt,marksByCo:vn};fe===_r&&(hn.marksA=Cs(Xt.marksA,et)),Mr!=null&&fe===Mr&&(hn.marksB=Cs(Xt.marksB,et)),Qr[Vr]=hn}return{...Be,sheet:{...Be.sheet,coConfigs:kt,expCountA:fe===_r?et:Be.sheet.expCountA,expCountB:fe===Mr?et:Be.sheet.expCountB,btlA:fe===_r?kt[ar].btl:Be.sheet.btlA,btlB:fe===Mr?kt[ar].btl:Be.sheet.btlB,rowsByStudentId:Qr}}})}function gt(fe,Ee){const et=Kr(Number(Ee),0,100);Lt(Be=>{if(Be.sheet.markManagerLocked)return Be;const kt=jt(Be.sheet),ar=String(fe),Rt=kt[ar],jr=Kr(Number((Rt==null?void 0:Rt.expCount)??Li),0,12);kt[ar]={enabled:!!((Rt==null?void 0:Rt.enabled)??!0),expCount:jr,expMax:et,btl:Lu((Rt==null?void 0:Rt.btl)??[],jr,1)};const _r=Kr(Number(Be.sheet.coANum??i??1),1,5),Hr=Be.sheet.coBNum??s??null,Mr=Hr==null?null:Kr(Number(Hr),1,5),Qr=fe===_r?et:Kr(Number(Be.sheet.expMaxA??ra),0,100),Vr=fe===Mr?et:Kr(Number(Be.sheet.expMaxB??0),0,100),Xt=Kr(Number(Be.sheet.expCountA??Li),0,12),vn=Kr(Number(Be.sheet.expCountB??0),0,12),hn={};for(const[kn,_n]of Object.entries(Be.sheet.rowsByStudentId||{})){const yn=Cs(_n.marksA,Xt).map(mi=>typeof mi=="number"?Kr(mi,0,Qr):""),ci=Cs(_n.marksB,vn).map(mi=>typeof mi=="number"?Kr(mi,0,Vr):""),Wn=_n!=null&&_n.marksByCo&&typeof _n.marksByCo=="object"?{..._n.marksByCo}:{};Wn[ar]=Cs(Wn[ar],jr).map(mi=>typeof mi=="number"?Kr(mi,0,et):""),hn[kn]={..._n,marksA:yn,marksB:ci,marksByCo:Wn}}return{...Be,sheet:{...Be.sheet,coConfigs:kt,expMaxA:Qr,expMaxB:Vr,rowsByStudentId:hn}}})}function yt(fe,Ee,et){Lt(Be=>{if(Be.sheet.markManagerLocked)return Be;const kt=jt(Be.sheet),ar=String(Kr(Number(fe),1,5)),Rt=kt[ar],jr=Kr(Number((Rt==null?void 0:Rt.expCount)??Li),0,12),_r=Lu((Rt==null?void 0:Rt.btl)??[],jr,1);Ee>=0&&Ee<_r.length&&(_r[Ee]=et),kt[ar]={enabled:!!((Rt==null?void 0:Rt.enabled)??!1),expCount:jr,expMax:Kr(Number((Rt==null?void 0:Rt.expMax)??ra),0,100),btl:_r};const Hr=Kr(Number(Be.sheet.coANum??i??1),1,5),Mr=Be.sheet.coBNum??s??null,Qr=Mr==null?null:Kr(Number(Mr),1,5);return{...Be,sheet:{...Be.sheet,coConfigs:kt,btlA:fe===Hr?_r:Be.sheet.btlA,btlB:fe===Qr?_r:Be.sheet.btlB}}})}function mt(fe,Ee,et,Be){Lt(kt=>{var ci;const ar=String(fe),Rt=(ci=kt.sheet.rowsByStudentId)==null?void 0:ci[ar];if(!Rt||xr&&r!=="model"&&Rt.absent)return kt;if(r==="model"){const Wn=!!Rt.absent,mi=Wn?String(Rt.absentKind||"AL").toUpperCase():"";if(Wn&&!!!(Le&&Wn&&(mi==="ML"||mi==="SKL")))return kt}const jr=jt(kt.sheet),_r=String(Kr(Number(Ee),1,5)),Hr=jr[_r],Mr=Kr(Number((Hr==null?void 0:Hr.expCount)??0),0,12),Qr=Kr(Number((Hr==null?void 0:Hr.expMax)??ra),0,100),Vr=Rt!=null&&Rt.marksByCo&&typeof Rt.marksByCo=="object"?{...Rt.marksByCo}:{},Xt=Cs(Vr[_r],Mr),vn=Be===""?"":Kr(Number(Be),0,Qr);et>=0&&et<Xt.length&&(Xt[et]=vn),Vr[_r]=Xt;const hn=Kr(Number(kt.sheet.coANum??i??1),1,5),kn=kt.sheet.coBNum??s??null,_n=kn==null?null:Kr(Number(kn),1,5),yn={...Rt,marksByCo:Vr};return Ee===hn&&(yn.marksA=Cs(Rt.marksA,Mr).map((Wn,mi)=>mi===et?vn:Wn)),_n!=null&&Ee===_n&&(yn.marksB=Cs(Rt.marksB,Mr).map((Wn,mi)=>mi===et?vn:Wn)),{...kt,sheet:{...kt.sheet,rowsByStudentId:{...kt.sheet.rowsByStudentId,[ar]:yn}}}})}function tr(fe,Ee){Lt(et=>{var jr;const Be=String(fe),kt=(jr=et.sheet.rowsByStudentId)==null?void 0:jr[Be];if(!kt||!Mt||xr&&r!=="model"&&kt.absent)return et;if(r==="model"){const _r=!!kt.absent,Hr=_r?String(kt.absentKind||"AL").toUpperCase():"";if(_r&&!!!(Le&&_r&&(Hr==="ML"||Hr==="SKL")))return et}if(nn)return et;const ar=ur?Kr(Number(et.sheet.ciaExamMax??Lh),0,100):Lh,Rt=Ee===""?"":Kr(Number(Ee),0,ar);return{...et,sheet:{...et.sheet,rowsByStudentId:{...et.sheet.rowsByStudentId,[Be]:{...kt,ciaExam:Rt}}}}})}function lr(fe,Ee,et){Lt(Be=>{var Mr;if(nn)return Be;const kt=String(fe),ar=(Mr=Be.sheet.rowsByStudentId)==null?void 0:Mr[kt];if(!ar||xr&&r!=="model"&&ar.absent)return Be;if(r==="model"){const Qr=!!ar.absent,Vr=Qr?String(ar.absentKind||"AL").toUpperCase():"";if(Qr&&!!!(Le&&Qr&&(Vr==="ML"||Vr==="SKL")))return Be}const Rt=String(Kr(Number(Ee),1,5)),jr=Number(Sp[Number(Rt)]||0),_r=et===""?"":Vb(Number(et),0,jr>0?jr:0),Hr={...Yb(ar==null?void 0:ar.caaExamByCo),[Rt]:_r};return{...Be,sheet:{...Be.sheet,rowsByStudentId:{...Be.sheet.rowsByStudentId,[kt]:{...ar,caaExamByCo:Hr}}}}})}function Fr(fe,Ee,et){Lt(Be=>{var Mr;if(!nn)return Be;const kt=String(fe),ar=(Mr=Be.sheet.rowsByStudentId)==null?void 0:Mr[kt];if(!ar||!Mt||!Wt||xr&&r!=="model"&&ar.absent)return Be;if(r==="model"){const Qr=!!ar.absent,Vr=Qr?String(ar.absentKind||"AL").toUpperCase():"";if(Qr&&!!!(Le&&Qr&&(Vr==="ML"||Vr==="SKL")))return Be}const Rt=String(Kr(Number(Ee),1,5)),jr=Number(_d[Number(Rt)]||0);if(jr<=0)return Be;const _r=et===""?"":Vb(Number(et),0,jr),Hr={...Bj(ar==null?void 0:ar.ciaExamByCo),[Rt]:_r};return{...Be,sheet:{...Be.sheet,rowsByStudentId:{...Be.sheet.rowsByStudentId,[kt]:{...ar,ciaExamByCo:Hr}}}}})}async function rn(){if(e){B(!0);try{await Fi(r,String(e),vt),P(new Date().toLocaleString())}catch(fe){alert((fe==null?void 0:fe.message)||"Draft save failed")}finally{B(!1)}}}const Sn=sn.useRef(vt);Sn.current=vt,x.useEffect(()=>{const fe=()=>{!e||Nr||Fi(r,String(e),Sn.current).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",fe),()=>window.removeEventListener("obe:before-tab-switch",fe)},[e,r,Nr]);async function Gr(){if(!e||!window.confirm(`Reset all marks for ${n}? This clears the draft for all students.`))return;const Ee=Kr(Number(vt.sheet.expCountA??Li),0,12),et=Kr(Number(vt.sheet.expCountB??0),0,12),Be={};for(const ar of b)Be[String(ar.id)]={studentId:ar.id,absent:!1,absentKind:void 0,marksA:Array.from({length:Ee},()=>""),marksB:Array.from({length:et},()=>""),marksByCo:{},caaExamByCo:{},ciaExamByCo:{},ciaExam:""};const kt={sheet:{...vt.sheet,btlA:Array.from({length:Ee},()=>1),btlB:Array.from({length:et},()=>1),rowsByStudentId:Be}};Lt(kt);try{Pn&&Kn(Pn,{rowsByStudentId:{}})}catch{}try{await Fi(r,String(e),kt),P(new Date().toLocaleString())}catch{}}async function fn(){if(!e)return;if(zt){alert("Publishing is locked by IQAC.");return}if(!mn){alert("Publish window is closed. Please request IQAC approval.");return}if(ue&&Ve&&!g){if(Re){alert("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}ee(!0);return}de(!0);const fe=W,Ee=Cr,et={markEntryUnblockedUntil:J,markManagerUnlockedUntil:pe};try{console.debug("publish called",{assessment:r,subjectId:e,entryOpen:St,publishAllowed:mn,globalLocked:zt}),V(new Date().toLocaleString()),se(et),await j3(r,String(e),vt,t),console.debug("publish succeeded",{assessment:r,subjectId:e}),await an(!1),qe(),wt({silent:!0});try{console.debug("obe:published dispatch",{assessment:r,subjectId:e}),window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:r}}))}catch{}}catch(Be){V(fe),se(Ee),alert((Be==null?void 0:Be.message)||"Publish failed")}finally{de(!1)}}async function an(fe){if(e){fe&&me(!0),je(null);try{const Ee=await Ys(r,String(e),t),et=(Ee==null?void 0:Ee.data)??null;et&&typeof et=="object"&&D(et)}catch(Ee){fe&&je((Ee==null?void 0:Ee.message)||"Failed to load published marks")}finally{fe&&me(!1)}}}x.useEffect(()=>{if(e){if(!(ut!=null&&ut.exists)||!(ut!=null&&ut.is_published)){D(null);return}an(!1)}},[e,r,ut==null?void 0:ut.exists,ut==null?void 0:ut.is_published]);const bn=sn.useRef(null);x.useEffect(()=>{if(!e||!ue)return;if(!St){bn.current=!1;return}const fe=bn.current;if(bn.current=!0,fe===!0)return;let Ee=!0;return(async()=>{var et;try{const Be=await ri(r,String(e),t),kt=(Be==null?void 0:Be.draft)??null;if(!Ee)return;if(kt&&typeof kt=="object"&&kt.sheet){const ar=(et=kt.sheet)==null?void 0:et.rowsByStudentId;if(ar&&Object.values(ar).some(jr=>{var _r,Hr;return((_r=jr==null?void 0:jr.marksA)==null?void 0:_r.some(Mr=>Mr!==""&&Mr!=null))||((Hr=jr==null?void 0:jr.marksB)==null?void 0:Hr.some(Mr=>Mr!==""&&Mr!=null))||(jr==null?void 0:jr.ciaExam)!==""&&(jr==null?void 0:jr.ciaExam)!=null})){Lt(kt),H.current=!0;return}}}catch{}Ee&&ie&&ie.sheet&&(Lt(ie),H.current=!0)})(),()=>{Ee=!1}},[St,ue,e,r,ie,t]),x.useEffect(()=>{if(!e||!ue||St)return;const fe=window.setInterval(()=>{wt({silent:!0});try{Zt==null||Zt({silent:!0})}catch{}},3e4);return()=>window.clearInterval(fe)},[St,ue,e,wt,Zt]),x.useEffect(()=>{se(null)},[e]);async function Se(){if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}const Ee=String(q||"").trim();if(!Ee){alert("Reason is required.");return}if(Re){alert("Edit request is already pending. Please wait.");return}F(!0);const et=new Date,Be=sr!=null&&sr.approval_until?String(sr.approval_until):null;try{const kt=await sl({assessment:r,subject_code:String(e),scope:"MARK_ENTRY",reason:Ee,teaching_assignment_id:t});alert(ol(kt)),ee(!1),O(""),Vt(Date.now()+24*60*60*1e3);try{qt({silent:!0})}catch{}const ar=Number(kt==null?void 0:kt.id),Rt=et.getTime()-2e3;(async()=>{for(let Hr=0;Hr<36;Hr++){try{const Mr=await Bm({assessment:r,subject_code:String(e),scope:"MARK_ENTRY",teaching_assignment_id:t}),Qr=Mr==null?void 0:Mr.result;if(!Qr)throw new Error("No status");if(Number.isFinite(ar)&&ar>0&&Number(Qr.id)!==ar)throw new Error("Different request");const Vr=Qr.reviewed_at?new Date(String(Qr.reviewed_at)).getTime():0,Xt=String(Qr.status||"").toUpperCase();if(Xt==="APPROVED"&&Vr>=Rt){try{wt({silent:!0}),Zt==null||Zt({silent:!0})}catch{}alert("IQAC approved the edit request. You can now edit marks.");return}if(Xt==="REJECTED"&&Vr>=Rt){alert("IQAC rejected the edit request.");return}}catch{try{const Mr=await l1(r,String(e),"MARK_ENTRY",t),Qr=Mr!=null&&Mr.approval_until?String(Mr.approval_until):null;if(Mr!=null&&Mr.allowed_by_approval&&Qr&&Qr!==Be){try{wt({silent:!0}),Zt==null||Zt({silent:!0})}catch{}alert("IQAC approved the edit request. You can now edit marks.");return}}catch{}}await new Promise(Mr=>setTimeout(Mr,5e3))}alert("Edit request still pending. Please try again later.")})()}catch(kt){const ar=ll(kt,"Request failed");alert(`Edit request failed: ${ar}`)}finally{F(!1)}}x.useEffect(()=>{C&&e&&(D(null),an(!0))},[C,e,r]);const st=x.useMemo(()=>{if(Je===0)return[];const fe=new Set;for(const Ee of br)for(let et=0;et<Ee.expCount;et++){const Be=Ee.btl[et];(Be===1||Be===2||Be===3||Be===4||Be===5||Be===6)&&fe.add(Be)}return[1,2,3,4,5,6].filter(Ee=>fe.has(Ee))},[br,Je]),pt=3+(xr?1:0)+Ht+1+Dt+Gt+st.length*2,Qe={border:"1px solid #111",padding:"4px 4px",background:"#ecfdf5",color:"#065f46",textAlign:"center",fontWeight:700,fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},vr={border:"1px solid #111",padding:"4px 4px",fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},tn={width:"100%",border:"none",outline:"none",background:"transparent",fontSize:11,textAlign:"center"},An={border:"1px solid #e5e7eb",borderRadius:12,background:"#fff",padding:12},xn=40,zn=90,Rn=180,xi=56,L=52,le=72,Oe=80,rt=x.useMemo(()=>[...Array.from({length:Ht},()=>Oe),L,...Dt>0?Array.from({length:Dt},()=>Oe):[],...Array.from({length:Gt+st.length*2},()=>Oe)],[Ht,Dt,Gt,st.length]),Et=x.useMemo(()=>{const fe=xn+zn+Rn+(xr?xi:0),Ee=rt.reduce((et,Be)=>et+Be,0);return Math.max(900,fe+Ee)},[xr,rt]),hr=x.useMemo(()=>{const fe=xn+zn+Rn,Ee=rt.reduce((et,Be)=>et+Be,0);return Math.max(900,fe+Ee)},[rt]),ir=(fe,Ee)=>({position:"sticky",left:fe,zIndex:40,...Ee!=null?{width:Ee,minWidth:Ee,maxWidth:Ee}:null,background:Qe.background}),wr=(fe,Ee)=>({position:"sticky",left:fe,zIndex:25,...Ee!=null?{width:Ee,minWidth:Ee,maxWidth:Ee}:null,background:"#fff"});function Wr(fe,Ee,et){const Be=3+(Ee?1:0),kt=Math.max(0,fe-Be);return a.jsxs("colgroup",{children:[a.jsx("col",{style:{width:xn}}),a.jsx("col",{style:{width:zn}}),a.jsx("col",{style:{width:Rn}}),Ee?a.jsx("col",{style:{width:xi}}):null,Array.from({length:kt}).map((ar,Rt)=>{const jr=(et==null?void 0:et[Rt])??Oe;return a.jsx("col",{style:{width:jr,minWidth:jr,maxWidth:jr}},`rest_${Rt}`)})]})}const Xr={display:"flex",width:"100%",maxWidth:1200,margin:"0 auto",gap:10,flexWrap:"wrap",alignItems:"center",marginBottom:8},dn={width:20,height:20,transform:"scale(1.5)",accentColor:"#9a3412"},Ln=be?"markManagerGlitch 2s ease-in-out":void 0,si={position:"absolute",left:"50%",top:6,transform:"translateX(-50%)",zIndex:40,width:160,background:"#fff",border:"1px solid #e5e7eb",padding:10,borderRadius:12,display:"flex",flexDirection:"column",gap:8,alignItems:"center",boxShadow:"0 6px 18px rgba(17,24,39,0.06)",filter:"none"},Ir=async()=>{if(!e)return;const fe=b.map((Ee,et)=>{var _r;const Be=(_r=vt.sheet.rowsByStudentId)==null?void 0:_r[String(Ee.id)],kt=ze(Be,br),ar=Ze(Be,kt),jr=!!(xr&&(Be!=null&&Be.absent)&&!ar.hasAnyMarks)?"ABSENT":ar.finalTotal;return{sno:et+1,regNo:String(Ee.reg_no||""),name:String(Ee.name||""),total:jr}});await fy({filenameBase:`${String(e)}_${n}`,meta:{courseName:(A==null?void 0:A.courseName)||"",courseCode:(A==null?void 0:A.courseCode)||String(e),className:(A==null?void 0:A.className)||""},rows:fe})};return a.jsxs(X0,{children:[a.jsx("style",{children:`
        @keyframes markManagerGlitch {
          0% { background: #fff7ed; transform: translateX(0); }
          10% { background: #f3f4f6; transform: translateX(-2px); }
          20% { background: #fff7ed; transform: translateX(2px); }
          30% { background: #f3f4f6; transform: translateX(-1px); }
          40% { background: #fff7ed; transform: translateX(1px); }
          50% { background: #f3f4f6; transform: translateX(0); }
          60% { background: #fff7ed; transform: translateX(-1px); }
          70% { background: #f3f4f6; transform: translateX(1px); }
          80% { background: #fff7ed; transform: translateX(0); }
          90% { background: #f3f4f6; transform: translateX(-1px); }
          100% { background: #f3f4f6; transform: translateX(0); }
        }
        @keyframes markManagerDust {
          0% { opacity: 1; transform: scale(1) rotate(0deg); }
          50% { opacity: 0.8; transform: scale(1.1) rotate(180deg); }
          100% { opacity: 0; transform: scale(0.5) rotate(360deg); }
        }
        .markManagerDustParticle {
          position: absolute;
          width: 4px;
          height: 4px;
          background: #d1d5db;
          border-radius: 50%;
          animation: markManagerDust 2s ease-out forwards;
        }
      `}),a.jsxs("div",{style:{margin:"0 0 10px 0",maxWidth:"100%",width:"100%",boxSizing:"border-box",overflow:"hidden"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"COs enabled"}),a.jsxs("div",{style:{...Xr,border:"1px solid #fcd34d",background:ot?"#f3f4f6":"#fff7ed",padding:12,borderRadius:12,alignItems:"stretch",animation:Ln,position:"relative",overflow:"hidden"},children:[be&&a.jsx(a.Fragment,{children:Array.from({length:20},(fe,Ee)=>a.jsx("div",{className:"markManagerDustParticle",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*1}s`}},Ee))}),a.jsxs("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",gap:10,flexWrap:"wrap"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,minWidth:0},children:[a.jsx(C2,{size:18,color:ot?"#6b7280":"#9a3412"}),a.jsx("div",{style:{fontWeight:950,color:"#111827"},children:"Mark Manager"})]}),a.jsx("div",{style:{display:"flex",gap:8,alignItems:"center"},children:a.jsx("button",{onClick:()=>{if(ot){We({mode:"request"});return}const fe=gr(vt.sheet.markManagerSnapshot??null);if(fe){const Ee=Kt(fe),et=Kt(Xe),Be=Ee.filter(kt=>!et.includes(kt));if(Be.length){const kt=Kr(Number(i??1),1,5),ar=s==null?null:Kr(Number(s),1,5),Rt=dr(vt.sheet.rowsByStudentId,Be,kt,ar);nt({visible:!0,removed:Be,affected:Rt});return}}We({mode:"confirm"})},className:"obe-btn obe-btn-success",disabled:!e||Pt,style:Pt?{opacity:.6,cursor:"not-allowed"}:void 0,children:ot?"Edit":"Save"})})]}),a.jsxs("div",{style:{width:"100%",display:"flex",gap:10,flexWrap:"wrap",marginTop:8},children:[Rr.map(fe=>{const Ee=Xe[String(fe)],et=!!(Ee!=null&&Ee.enabled);return a.jsxs("label",{style:{display:"flex",gap:6,alignItems:"center",fontWeight:800,fontSize:12,color:"#111827"},children:[a.jsx("input",{type:"checkbox",checked:et,disabled:ot,onChange:Be=>Ut(fe,Be.target.checked),style:dn}),"CO-",fe]},fe)}),a.jsx("label",{style:{display:"flex",gap:6,alignItems:"center",fontWeight:800,fontSize:12,color:"#111827"},children:Mt?a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"checkbox",checked:Wt,disabled:ot,onChange:fe=>$e(fe.target.checked),style:dn}),"CIA Exam"]}):null})]}),a.jsxs("div",{style:{width:"100%",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:10,marginTop:8},children:[ur&&Mt&&Wt?a.jsxs("div",{style:{width:"100%",minWidth:0,display:"flex",flexDirection:"column",gap:6,padding:"10px 10px",border:"1px solid #e5e7eb",borderRadius:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,fontWeight:950},children:"CIA Exam"}),a.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:"Max marks"}),a.jsx("input",{type:"number",className:"obe-input",value:pr,onChange:fe=>ft(Number(fe.target.value)),min:0,max:100,disabled:ot})]},"cfg_cia_exam"):null,Rr.map(fe=>{const Ee=Xe[String(fe)];if(!!!(Ee!=null&&Ee.enabled))return null;const Be=Kr(Number((Ee==null?void 0:Ee.expCount)??Li),0,12),kt=Kr(Number((Ee==null?void 0:Ee.expMax)??ra),0,100);return a.jsxs("div",{style:{width:"100%",minWidth:0,display:"flex",flexDirection:"column",gap:6,padding:"10px 10px",border:"1px solid #e5e7eb",borderRadius:12,background:"#fff"},children:[a.jsxs("div",{style:{fontSize:12,fontWeight:950},children:["CO-",fe]}),a.jsxs("div",{style:{fontSize:11,color:"#6b7280"},children:["No. of ",It.toLowerCase()]}),a.jsx("input",{type:"number",className:"obe-input",value:Be,onChange:ar=>Ct(fe,Number(ar.target.value)),min:0,max:12,disabled:ot}),a.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:"Max marks"}),a.jsx("input",{type:"number",className:"obe-input",value:kt,onChange:ar=>gt(fe,Number(ar.target.value)),min:0,max:100,disabled:ot})]},`cfg_${fe}`)})]})]}),Ye?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#991b1b"},children:Ye}):null]}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{onClick:Ir,className:"obe-btn obe-btn-secondary",disabled:!e||b.length===0,children:"Download"}),a.jsx("button",{onClick:Gr,className:"obe-btn obe-btn-danger",disabled:!e||Nr,title:Nr?"Table locked  confirm Mark Manager to enable actions":void 0,children:"Reset"})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:rn,className:"obe-btn obe-btn-success",disabled:M||!e||Nr,title:Nr?"Table locked  confirm Mark Manager to enable actions":void 0,children:M?"Saving":"Save Draft"}),a.jsx("button",{onClick:fn,className:"obe-btn obe-btn-primary",disabled:De?!1:!e||oe||Nr||zt||!mn,title:Nr?"Table locked  confirm Mark Manager to enable actions":mn?zt?"Publishing locked":"Publish":"Publish window closed",children:De?"Request Edit":oe?"Publishing":"Publish"}),E&&a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Saved: ",E]}),W&&a.jsxs("div",{style:{fontSize:12,color:"#16a34a",alignSelf:"center"},children:["Published: ",W]})]})]}),Lr&&!zt&&mn&&a.jsxs("div",{style:{fontSize:13,color:"#6b7280",marginBottom:6},children:["Publish window open  due by"," ",a.jsx("strong",{children:Lr.due_at?new Date(Lr.due_at).toLocaleString():""}),Me!=null&&Me>0&&a.jsxs("span",{children:[" (",Math.ceil(Me/60)," min remaining)"]})]}),zt&&a.jsx("div",{style:{background:"#fffbeb",border:"1px solid #fde68a",color:"#92400e",padding:"10px 14px",borderRadius:10,marginBottom:10,fontWeight:600},children:a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("span",{children:"Publishing disabled by IQAC"}),a.jsx("button",{className:"obe-btn obe-btn-secondary",style:{padding:"2px 10px",fontSize:12},onClick:()=>qe(),children:"Refresh"})]})}),!zt&&!mn&&Lr&&a.jsxs("div",{style:{background:"#fff7ed",border:"1px solid #fecaca",color:"#9a3412",padding:"10px 14px",borderRadius:10,marginBottom:10},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[a.jsx("strong",{children:"Publish time is over"}),a.jsxs("div",{style:{display:"flex",gap:6},children:[a.jsx("button",{className:"obe-btn obe-btn-secondary",style:{padding:"2px 10px",fontSize:12},onClick:()=>qe(),children:"Refresh"}),a.jsx("button",{className:"obe-btn obe-btn-primary",style:{padding:"2px 10px",fontSize:12},disabled:ne,onClick:async()=>{if(Q.trim()){re(!0),I(null);try{await jh({assessment:r,subject_code:String(e),reason:Q,teaching_assignment_id:t}),I("Request sent successfully."),K("")}catch(fe){I((fe==null?void 0:fe.message)||"Request failed")}re(!1)}},children:ne?"Sending":"Request Approval"})]})]}),a.jsx("input",{type:"text",placeholder:"Reason for approval",value:Q,onChange:fe=>K(fe.target.value),style:{width:"100%",padding:"4px 8px",borderRadius:6,border:"1px solid #d1d5db",fontSize:13}}),T&&a.jsx("div",{style:{marginTop:4,fontSize:12,color:T.includes("success")?"#065f46":"#991b1b"},children:T})]}),w?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading roster"}):null,j?a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:j}):null,a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Term"}),a.jsx("div",{style:{fontWeight:700},children:vt.sheet.termLabel||""})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Batch"}),a.jsx("div",{style:{fontWeight:700},children:vt.sheet.batchLabel||""})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Saved"}),a.jsx("div",{style:{fontWeight:700},children:E||""}),U?a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["by ",a.jsx("span",{style:{color:"#0369a1",fontWeight:700},children:U})]}):null]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Published"}),a.jsx("div",{style:{fontWeight:700},children:W||""})]})]}),a.jsx("div",{style:An,children:a.jsx(og,{locked:zt,children:a.jsxs("div",{className:"obe-table-wrapper",style:{overflowX:"auto",position:"relative",filter:Nr?"grayscale(5%)":void 0,opacity:Nr?.78:1},children:[a.jsxs("table",{className:"obe-table",style:{width:"100%",minWidth:Et,tableLayout:"fixed",borderCollapse:"collapse"},children:[Wr(pt,xr,rt),a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsx("th",{style:Qe,colSpan:pt,children:n})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...Qe,...ir(0,xn)},rowSpan:5,children:"S.No"}),a.jsx("th",{style:{...Qe,...ir(xn,zn)},rowSpan:5,children:"R.No"}),a.jsx("th",{style:{...Qe,...ir(xn+zn,Rn),textAlign:"left"},rowSpan:5,children:"Name of the Students"}),xr?a.jsx("th",{style:{...Qe,...ir(xn+zn+Rn,xi)},rowSpan:5,children:"AB"}):null,a.jsx("th",{style:Qe,colSpan:Ht,children:It}),a.jsx("th",{style:{...Qe,width:L,minWidth:L,maxWidth:L},rowSpan:5,children:"AVG"}),nn?a.jsx(a.Fragment,{children:Wt&&Tt.length>0?a.jsx("th",{style:Qe,colSpan:Tt.length,children:"CIA EXAM"}):null}):Wt?gn?a.jsx("th",{style:Qe,colSpan:Math.max(_t,1),children:"CIA EXAM"}):a.jsx("th",{style:{...Qe,width:le,minWidth:le,maxWidth:le,overflow:"visible",textOverflow:"clip"},rowSpan:5,title:"CIA Exam",children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:2,lineHeight:1.05},children:[a.jsx("div",{style:{whiteSpace:"pre-line"},children:`CIA
EXAM`}),a.jsx("div",{style:{fontSize:12,fontWeight:900},children:pr})]})}):null,a.jsx("th",{style:Qe,colSpan:Gt,children:"CO ATTAINMENT"}),st.length?a.jsx("th",{style:Qe,colSpan:st.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[Je===0?a.jsx("th",{style:Qe,children:""}):a.jsx(a.Fragment,{children:br.map(fe=>Array.from({length:fe.expCount},(Ee,et)=>a.jsx("th",{style:Qe,children:fe.coNumber},`co_${fe.coNumber}_${et}`)))}),nn?a.jsx(a.Fragment,{children:Wt?Tt.map(fe=>a.jsxs("th",{style:Qe,children:["CO-",fe.coNumber]},`lab_cia_co_${fe.coNumber}`)):null}):Wt&&gn?_t>0?bt.map(fe=>a.jsxs("th",{style:Qe,children:["CO-",fe.coNumber]},`caa_co_${fe.coNumber}`)):a.jsx("th",{style:Qe,children:""}):null,it?br.map(fe=>a.jsxs("th",{style:Qe,colSpan:2,children:["CO-",fe.coNumber]},`coatt_${fe.coNumber}`)):a.jsx("th",{style:Qe,colSpan:2,children:""}),st.map(fe=>a.jsxs("th",{style:Qe,colSpan:2,children:["BTL-",fe]},`btl_${fe}`))]}),a.jsxs("tr",{children:[Je===0?a.jsx("th",{style:Qe,children:""}):a.jsx(a.Fragment,{children:br.map(fe=>Array.from({length:fe.expCount},(Ee,et)=>a.jsx("th",{style:Qe,children:fe.expMax},`max_${fe.coNumber}_${et}`)))}),nn?a.jsx(a.Fragment,{children:Wt?Tt.map(fe=>a.jsx("th",{style:Qe,children:_d[fe.coNumber]??0},`lab_cia_max_${fe.coNumber}`)):null}):Wt&&gn?_t>0?bt.map(fe=>a.jsx("th",{style:Qe,children:Sp[fe.coNumber]??0},`caa_max_${fe.coNumber}`)):a.jsx("th",{style:Qe,children:""}):null,it?br.map(fe=>{const Ee=nn?Rh(Number(Fj[fe.coNumber]||0)+(Wt?Number(_d[fe.coNumber]||0):0)):(()=>{const et=Number(Rj[fe.coNumber]||0),Be=EM[`co${fe.coNumber}`],kt=Array.from({length:Kr(Number(fe.expCount??0),0,12)}).map(()=>Kr(Number(fe.expMax??ra),0,100)),ar=kt.length?kt.reduce((jr,_r)=>jr+_r,0)/kt.length:0,Rt=cr&&Number.isFinite(Number(Be))?Number(Be):ar;return gn&&et>0?et:Math.round(Rt+(Wt?pr/2:0)||0)})();return a.jsxs(sn.Fragment,{children:[a.jsx("th",{style:Qe,children:Ee}),a.jsx("th",{style:Qe,children:"%"})]},`comax_${fe.coNumber}`)}):a.jsxs(a.Fragment,{children:[a.jsx("th",{style:Qe,children:""}),a.jsx("th",{style:Qe,children:"%"})]}),st.map(fe=>a.jsxs(sn.Fragment,{children:[a.jsx("th",{style:Qe,children:$t||ra}),a.jsx("th",{style:Qe,children:"%"})]},`btlmax_${fe}`))]}),a.jsxs("tr",{children:[Je===0?a.jsxs("th",{style:Qe,children:["No ",It.toLowerCase()]}):a.jsx(a.Fragment,{children:br.map(fe=>Array.from({length:fe.expCount},(Ee,et)=>a.jsxs("th",{style:Qe,children:[ct,et+1]},`e_${fe.coNumber}_${et}`)))}),a.jsx("th",{style:Qe,colSpan:Gt+st.length*2+Dt})]}),a.jsxs("tr",{children:[Je===0?a.jsx("th",{style:Qe,children:"BTL"}):a.jsx(a.Fragment,{children:br.map(fe=>Array.from({length:fe.expCount},(Ee,et)=>a.jsx("th",{style:Qe,children:(()=>{var Rt;const Be=((Rt=fe.btl)==null?void 0:Rt[et])??1,kt=Be===""?"-":String(Be);return!g&&!Nr&&!Ve&&!zt?a.jsxs("select",{"aria-label":`BTL for ${Ie} ${et+1} (CO-${fe.coNumber})`,value:Be,onChange:jr=>{const _r=jr.target.value,Hr=_r===""?"":Number(_r);yt(fe.coNumber,et,Hr)},style:{width:"100%",minWidth:44,padding:"4px 2px",fontWeight:800,fontSize:11,textAlign:"center",border:"1px solid #d1d5db",borderRadius:4,background:"#fff",cursor:"pointer"},children:[a.jsx("option",{value:"",children:"-"}),[1,2,3,4,5,6].map(jr=>a.jsx("option",{value:jr,children:jr},jr))]}):a.jsx("span",{style:{fontWeight:800},children:kt})})()},`btl_${fe.coNumber}_${et}`)))}),a.jsx("th",{style:Qe,colSpan:Gt+st.length*2+Dt})]})]}),a.jsxs("tbody",{children:[(!Nr&&!Ve?b:[]).map((fe,Ee)=>{var Qr,Vr;const et=(Qr=vt.sheet.rowsByStudentId)==null?void 0:Qr[String(fe.id)],Be=ze(et,br),kt=Be.flatMap(Xt=>Xt.marks),ar=Gb(kt),Rt=Ze(et,Be),jr=it?Rt.coAttainmentValues:[],_r=Rt.caaByCo,Hr=Rt.ciaByCo,Mr={};for(const Xt of st){const vn=[];for(const hn of br){const kn=((Vr=Be.find(_n=>_n.coNumber===hn.coNumber))==null?void 0:Vr.marks)??[];for(let _n=0;_n<Math.min(hn.expCount,kn.length);_n++)if(hn.btl[_n]===Xt){const yn=kn[_n];typeof yn=="number"&&Number.isFinite(yn)&&vn.push(yn)}}Mr[Xt]=vn.length?vn.reduce((hn,kn)=>hn+kn,0)/vn.length:null}return a.jsxs("tr",{style:Nr&&Ee<3?{position:"relative",zIndex:35,background:"#fff"}:void 0,children:[a.jsx("td",{style:{...vr,...wr(0,xn),textAlign:"center"},children:Ee+1}),a.jsx("td",{style:{...vr,...wr(xn,zn),textAlign:"center"},title:String(fe.reg_no||""),children:PM(fe.reg_no,7)}),a.jsx("td",{style:{...vr,...wr(xn+zn,Rn)},title:String(fe.name||""),children:a.jsx("span",{style:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:String(fe.name||"")})}),xr?a.jsx("td",{style:{...vr,...wr(xn+zn+Rn,xi),textAlign:"center"},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[a.jsx("input",{type:"checkbox",checked:!!(et!=null&&et.absent),onChange:Xt=>Sr(fe.id,Xt.target.checked),disabled:Nr}),et!=null&&et.absent?a.jsxs("div",{className:"obe-ios-select",title:"Absent type",children:[a.jsx("span",{className:"obe-ios-select-value",children:String(et.absentKind||"AL")}),a.jsxs("select",{"aria-label":"Absent type",value:et.absentKind||"AL",onChange:Xt=>at(fe.id,Xt.target.value),disabled:Nr,children:[a.jsx("option",{value:"AL",children:"AL"}),a.jsx("option",{value:"ML",children:"ML"}),a.jsx("option",{value:"SKL",children:"SKL"})]})]}):null]})}):null,Je===0?a.jsx("td",{style:{...vr,textAlign:"center",color:"#6b7280"},children:""}):br.map(Xt=>{var hn;const vn=((hn=Be.find(kn=>kn.coNumber===Xt.coNumber))==null?void 0:hn.marks)??[];return Array.from({length:Xt.expCount},(kn,_n)=>a.jsx("td",{style:{...vr,width:38,minWidth:0,padding:"2px 2px",background:"#fff7ed"},children:a.jsx("input",{type:"number",value:vn[_n]??"",onChange:yn=>{const ci=yn.target.value;if(ci==="")return yn.currentTarget.setCustomValidity(""),mt(fe.id,Xt.coNumber,_n,"");const Wn=Number(ci);if(Number.isFinite(Wn)){if(Wn>Xt.expMax){yn.currentTarget.setCustomValidity(`Max mark is ${Xt.expMax}`),yn.currentTarget.reportValidity(),window.setTimeout(()=>yn.currentTarget.setCustomValidity(""),0);return}yn.currentTarget.setCustomValidity(""),mt(fe.id,Xt.coNumber,_n,Wn)}},style:tn,min:0,max:Xt.expMax,disabled:Nr})},`m_${fe.id}_${Xt.coNumber}_${_n}`))}),a.jsx("td",{style:{...vr,width:L,minWidth:0,textAlign:"right",fontWeight:800},children:ar==null?"":ar.toFixed(1)}),nn?a.jsx(a.Fragment,{children:Wt?Tt.map(Xt=>{const vn=Number(_d[Xt.coNumber]||0),hn=Hr[String(Xt.coNumber)]??"";return a.jsx("td",{style:{...vr,width:66,minWidth:0,padding:"2px 2px",background:"#fff7ed"},children:a.jsx("input",{type:"number",value:hn,onChange:kn=>{const _n=kn.target.value;if(_n==="")return kn.currentTarget.setCustomValidity(""),Fr(fe.id,Xt.coNumber,"");const yn=Number(_n);if(Number.isFinite(yn)){if(yn>vn){kn.currentTarget.setCustomValidity(`Max mark is ${vn}`),kn.currentTarget.reportValidity(),window.setTimeout(()=>kn.currentTarget.setCustomValidity(""),0);return}kn.currentTarget.setCustomValidity(""),Fr(fe.id,Xt.coNumber,yn)}},style:tn,min:0,max:vn,step:.1,disabled:Nr})},`lab_cia_${fe.id}_${Xt.coNumber}`)}):null}):Wt?gn?_t>0?bt.map(Xt=>{const vn=Number(Sp[Xt.coNumber]||0),hn=_r[String(Xt.coNumber)]??"";return a.jsx("td",{style:{...vr,width:66,minWidth:0,padding:"2px 2px",background:"#fff7ed"},children:a.jsx("input",{type:"number",value:hn,onChange:kn=>{const _n=kn.target.value;if(_n==="")return kn.currentTarget.setCustomValidity(""),lr(fe.id,Xt.coNumber,"");const yn=Number(_n);if(Number.isFinite(yn)){if(yn>vn){kn.currentTarget.setCustomValidity(`Max mark is ${vn}`),kn.currentTarget.reportValidity(),window.setTimeout(()=>kn.currentTarget.setCustomValidity(""),0);return}kn.currentTarget.setCustomValidity(""),lr(fe.id,Xt.coNumber,yn)}},style:tn,min:0,max:vn,disabled:Nr})},`caa_${fe.id}_${Xt.coNumber}`)}):a.jsx("td",{style:{...vr,textAlign:"center",color:"#6b7280"},children:""}):a.jsx("td",{style:{...vr,width:le,minWidth:0,padding:"2px 2px",background:"#fff7ed"},children:a.jsx("input",{type:"number",value:(et==null?void 0:et.ciaExam)??"",onChange:Xt=>{const vn=Xt.target.value;if(vn==="")return Xt.currentTarget.setCustomValidity(""),tr(fe.id,"");const hn=Number(vn);if(Number.isFinite(hn)){if(hn>pr){Xt.currentTarget.setCustomValidity(`Max mark is ${pr}`),Xt.currentTarget.reportValidity(),window.setTimeout(()=>Xt.currentTarget.setCustomValidity(""),0);return}Xt.currentTarget.setCustomValidity(""),tr(fe.id,hn)}},style:tn,min:0,max:pr,disabled:Nr})}):null,it?jr.map(Xt=>a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...vr,textAlign:"right"},children:Xt.mark==null?"":Xt.mark.toFixed(1)}),a.jsx("td",{style:{...vr,textAlign:"right"},children:Kb(Xt.mark,Xt.coMax)})]},`coattrow_${fe.id}_${Xt.coNumber}`)):a.jsxs(a.Fragment,{children:[a.jsx("td",{style:{...vr,textAlign:"right"}}),a.jsx("td",{style:{...vr,textAlign:"right"}})]}),st.map(Xt=>{const vn=Mr[Xt]??null;return a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...vr,textAlign:"right"},children:vn==null?"":vn.toFixed(1)}),a.jsx("td",{style:{...vr,textAlign:"right"},children:Kb(vn,$t||ra)})]},`btlcell_${fe.id}_${Xt}`)})]},fe.id)}),b.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:pt,style:{padding:10,color:"#6b7280"},children:"No students."})})]})]}),Nr&&!Ve&&!g?a.jsx("div",{style:{position:"absolute",inset:0,zIndex:30,pointerEvents:"auto",background:"linear-gradient(180deg, rgba(72, 113, 195, 0.92) 0%, rgba(51, 55, 64, 0.96) 100%)"}}):null,Ve&&!g?a.jsx("div",{style:{position:"absolute",inset:0,zIndex:30,pointerEvents:"auto",background:"linear-gradient(180deg, rgba(34,197,94,0.28) 0%, rgba(16,185,129,0.36) 100%)"}}):null,Nr&&!Ve&&!g&&!y?a.jsxs("div",{style:si,children:[a.jsx("div",{style:{width:100,height:72,display:"grid",placeItems:"center",background:"#fff",borderRadius:8},children:a.jsx("img",{id:"mark-manager-float-gif",src:"https://media.lordicon.com/icons/wired/flat/94-lock-unlock.gif",alt:"gif",style:{maxWidth:72,maxHeight:72,display:"block"},onError:fe=>{console.warn("Failed to load lock GIF:",fe.currentTarget.src),fe.currentTarget.onerror=null,fe.currentTarget.src="data:image/svg+xml;utf8,"+encodeURIComponent('<svg xmlns="https://media.lordicon.com/icons/wired/flat/94-lock-unlock.gif" width="72" height="72" viewBox="0 0 24 24" fill="none" stroke="#0f172a" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="10" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>')}})}),a.jsxs("div",{style:{textAlign:"center"},children:[a.jsx("div",{style:{fontWeight:800,color:"#111827"},children:"Table Locked"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Confirm the Mark Manager"})]}),a.jsx("div",{style:{display:"flex",gap:8,marginTop:4}})]}):null,Ve&&!g&&!y?a.jsxs("div",{style:si,children:[a.jsxs("div",{style:{textAlign:"center"},children:[a.jsx("div",{style:{fontWeight:950,color:"#065f46"},children:"Published  Locked"}),a.jsx("div",{style:{fontSize:13,color:"#065f46"},children:"Table is locked. Request IQAC approval to edit."})]}),a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center"},children:[a.jsx("button",{type:"button",className:"obe-btn",onClick:()=>Y(!0),children:"View"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-success",disabled:Re,onClick:async()=>{if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}ee(!0)},children:Re?"Request Pending":"Request Edit"})]}),a.jsx("div",{style:{width:64,height:64,display:"grid",placeItems:"center"},children:a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#065f46",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",fill:"#d1fae5"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})})]}):null]})})}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280",display:"flex",gap:18,flexWrap:"wrap"},children:[E?a.jsxs("div",{children:["Draft saved: ",E,U?a.jsxs("span",{style:{marginLeft:8,color:"#374151"},children:["by ",a.jsx("strong",{children:U})]}):null]}):null,W?a.jsxs("div",{children:["Last published: ",W]}):null]}),He?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:50},onClick:()=>{Pt||We(null)},children:a.jsxs("div",{style:{width:"min(760px, 96vw)",maxHeight:"90vh",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:fe=>fe.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:He.mode==="confirm"?`Confirmation - ${n}`:`Request Edit - ${n}`}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:r.toUpperCase()})]}),He.mode==="confirm"?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"Confirm the selected COs and their settings. After confirming, the Mark Manager box will be locked."}),a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"CO"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:It}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Max marks"})]})}),a.jsxs("tbody",{children:[Object.entries(Xe).filter(([fe,Ee])=>tt.has(String(fe))&&!!(Ee!=null&&Ee.enabled)).map(([fe,Ee])=>({co:Kr(Number(fe),1,5),expCount:Kr(Number((Ee==null?void 0:Ee.expCount)??0),0,12),expMax:Kr(Number((Ee==null?void 0:Ee.expMax)??0),0,100)})).sort((fe,Ee)=>fe.co-Ee.co).map(fe=>a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:["CO-",fe.co]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:fe.expCount}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:fe.expMax})]},fe.co)),Object.entries(Xe).filter(([fe,Ee])=>tt.has(String(fe))&&!!(Ee!=null&&Ee.enabled)).length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:3,style:{padding:10,color:"#6b7280"},children:"No COs selected."})}):null,Mt?a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"CIA Exam"}),a.jsx("td",{colSpan:2,style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:Wt?"Enabled":"Disabled"})]}):null]})]})})]}):a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. The Mark Manager will remain locked until IQAC approves."}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[a.jsx("button",{className:"obe-btn",disabled:Pt,onClick:()=>We(null),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:De?Re:!e||oe||Nr||zt||!mn,onClick:async()=>{if(!e)return;if(He.mode==="request"){dt(!0),lt(null);try{const Ee=ie,et=Xe;if(Ee&&Ee.sheet&&Ee.sheet.coConfigs){const Be=ye(jt(Ee.sheet),et),kt=Ce(Ee.sheet.rowsByStudentId,[...Be.removed,...Be.changed]);if((Be.removed.length||Be.changed.length||Be.added.length)&&kt>0){we({visible:!0,diff:Be,affected:kt,mode:"request"}),dt(!1);return}}We(null),await Fe()}finally{dt(!1)}return}const fe=gr(vt.sheet.markManagerSnapshot??null);if(fe){const Ee=Kt(fe),et=Kt(Xe),Be=Ee.filter(kt=>!et.includes(kt));if(Be.length){const kt=Kr(Number(i??1),1,5),ar=s==null?null:Kr(Number(s),1,5),Rt=dr(vt.sheet.rowsByStudentId,Be,kt,ar);nt({visible:!0,removed:Be,affected:Rt});return}}await Ue("none")},children:He.mode==="confirm"?"Confirm":"Send Request"})]})]})})}):null,ce&&ce.visible?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:90},onClick:()=>{Pt||we(null)},children:a.jsxs("div",{style:{width:"min(640px, 96vw)",background:"#fff",borderRadius:12,padding:14,border:"1px solid #e5e7eb"},onClick:fe=>fe.stopPropagation(),children:[a.jsx("div",{style:{fontWeight:900,marginBottom:8},children:"Mark Manager conflict with published marks"}),a.jsxs("div",{style:{color:"#374151",marginBottom:12},children:["The selected CO settings differ from the published mark sheet. ",ce.affected," student rows contain marks that may be lost."]}),a.jsxs("div",{style:{fontSize:13,color:"#374151",marginBottom:12},children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Added COs:"})," ",ce.diff.added.join(", ")||""]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Removed COs:"})," ",ce.diff.removed.join(", ")||""]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Changed COs:"})," ",ce.diff.changed.join(", ")||""]})]}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[a.jsx("button",{className:"obe-btn",onClick:()=>we(null),disabled:Pt,children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-danger",disabled:Pt,onClick:async()=>{if(e){dt(!0);try{const fe=vt,Ee=Object.fromEntries(Object.entries(fe.sheet.rowsByStudentId||{}).map(([Be,kt])=>{var Mr;const ar=kt&&typeof kt=="object"?kt:{},Rt=Kr(Number(fe.sheet.expCountA??Li),0,12),jr=Kr(Number(fe.sheet.expCountB??0),0,12),_r={...ar};_r.marksA=Array.from({length:Rt},()=>""),_r.marksB=Array.from({length:jr},()=>""),_r.caaExamByCo={},_r.ciaExamByCo={},_r.ciaExam="";const Hr=_r.marksByCo&&typeof _r.marksByCo=="object"?{..._r.marksByCo}:{};for(const Qr of[...ce.diff.removed.map(String),...ce.diff.changed.map(String)])Hr[Qr]&&(Hr[Qr]=Array.from({length:((Mr=Xe[Qr])==null?void 0:Mr.expCount)??0},()=>""));return _r.marksByCo=Hr,[Be,_r]})),et={sheet:{...fe.sheet,rowsByStudentId:Ee}};if(Lt(et),await Fi(r,String(e),et),P(new Date().toLocaleString()),ce.mode==="request")we(null),We(null),await Fe();else{try{await fh(r,String(e),t),wt({silent:!0})}catch(Be){console.warn("confirmMarkManagerLock failed after reset",Be)}we(null)}}catch(fe){alert((fe==null?void 0:fe.message)||"Failed to reset marks")}finally{dt(!1)}}},children:"Reset & Continue"})]})]})})}):null,ht&&ht.visible?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:95},onClick:()=>{Pt||nt(null)},children:a.jsxs("div",{style:{width:"min(660px, 96vw)",background:"#fff",borderRadius:12,padding:14,border:"1px solid #e5e7eb"},onClick:fe=>fe.stopPropagation(),children:[a.jsx("div",{style:{fontWeight:900,marginBottom:8},children:ht.removed.length===1?`Shall I reset the CO${ht.removed[0]} column?`:"Shall I reset the removed CO columns?"}),a.jsxs("div",{style:{color:"#374151",marginBottom:10},children:["The new Mark Manager selection removed old COs.",ht.affected>0?` ${ht.affected} student rows contain marks in these columns.`:" No marks were found in these columns."]}),a.jsx("div",{style:{fontSize:13,color:"#374151",marginBottom:12},children:a.jsxs("div",{children:[a.jsx("strong",{children:"Removed COs:"})," ",ht.removed.join(", ")||""]})}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[a.jsx("button",{className:"obe-btn",onClick:()=>nt(null),disabled:Pt,children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-primary",disabled:Pt,onClick:async()=>{const fe=ht.removed;nt(null),await Ue("partial",fe)},children:ht.removed.length===1?`Reset CO${ht.removed[0]} column`:"Reset removed CO columns"}),a.jsx("button",{className:"obe-btn obe-btn-danger",disabled:Pt,onClick:async()=>{nt(null),await Ue("full")},children:"Reset full data"})]})]})})}):null,ae?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>{X||ee(!1)},children:a.jsxs("div",{style:{width:"min(560px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:fe=>fe.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[String(r).toUpperCase()," LAB"]})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",xt?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{fontSize:13,color:"#374151",marginBottom:10,lineHeight:1.35},children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Subject:"})," ",n]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Code:"})," ",String(e||"")]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Published:"})," ",W||""]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Saved:"})," ",E||""]})]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:q,onChange:fe=>O(fe.target.value),placeholder:"Explain why you need to edit (required)",rows:4,className:"obe-input",style:{resize:"vertical"}})]}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:12},children:[a.jsx("button",{type:"button",className:"obe-btn",disabled:X,onClick:()=>ee(!1),children:"Cancel"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-success",disabled:X||Re||!e||!String(q||"").trim(),onClick:Se,title:Re?"Request pending (up to 24 hours)":void 0,children:X?"Requesting":Re?"Request Pending":"Send Request"})]})]})})}):null,C?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:70},onClick:()=>Y(!1),children:a.jsxs("div",{style:{width:"min(1100px, 96vw)",maxHeight:"min(80vh, 900px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:fe=>fe.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10,position:"relative"},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Only"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280",marginRight:36},children:[n,"  ",String(e||"")]}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-success",onClick:()=>Y(!1),style:{position:"absolute",right:0,top:0},children:"Close"})]}),Z?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading published marks"}):null,Te?a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:Te}):null,a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12,position:"relative"},children:(()=>{const fe=3+Ht+1+Dt+Gt+st.length*2;return a.jsxs("table",{className:"obe-table",style:{width:"100%",minWidth:hr,tableLayout:"fixed",borderCollapse:"collapse"},children:[Wr(fe,!1,rt),a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsx("th",{style:Qe,colSpan:fe,children:n})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...Qe,...ir(0,xn)},rowSpan:5,children:"S.No"}),a.jsx("th",{style:{...Qe,...ir(xn,zn)},rowSpan:5,children:"R.No"}),a.jsx("th",{style:{...Qe,...ir(xn+zn,Rn),textAlign:"left"},rowSpan:5,children:"Name of the Students"}),a.jsx("th",{style:Qe,colSpan:Ht,children:"Experiments"}),a.jsx("th",{style:{...Qe,width:L,minWidth:L,maxWidth:L},rowSpan:5,children:"AVG"}),nn?a.jsx(a.Fragment,{children:Wt&&Tt.length>0?a.jsx("th",{style:Qe,colSpan:Tt.length,children:"CIA EXAM"}):null}):Wt?gn?a.jsx("th",{style:Qe,colSpan:Math.max(_t,1),children:"CIA EXAM"}):a.jsx("th",{style:{...Qe,width:le,minWidth:le,maxWidth:le,overflow:"visible",textOverflow:"clip"},rowSpan:5,title:"CIA Exam",children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:2,lineHeight:1.05},children:[a.jsx("div",{style:{whiteSpace:"pre-line"},children:`CIA
EXAM`}),ur?a.jsx("div",{style:{fontSize:12,fontWeight:900},children:pr}):null]})}):null,a.jsx("th",{style:Qe,colSpan:Gt,children:"CO ATTAINMENT"}),st.length?a.jsx("th",{style:Qe,colSpan:st.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[Je===0?a.jsx("th",{style:Qe,children:""}):a.jsx(a.Fragment,{children:br.map(Ee=>Array.from({length:Ee.expCount},(et,Be)=>a.jsx("th",{style:Qe,children:Ee.coNumber},`co_view_${Ee.coNumber}_${Be}`)))}),nn?a.jsx(a.Fragment,{children:Wt?Tt.map(Ee=>a.jsxs("th",{style:Qe,children:["CO-",Ee.coNumber]},`lab_cia_co_view_${Ee.coNumber}`)):null}):Wt&&gn?_t>0?bt.map(Ee=>a.jsxs("th",{style:Qe,children:["CO-",Ee.coNumber]},`caa_co_view_${Ee.coNumber}`)):a.jsx("th",{style:Qe,children:""}):null,it?br.map(Ee=>a.jsxs("th",{style:Qe,colSpan:2,children:["CO-",Ee.coNumber]},`coatt_view_${Ee.coNumber}`)):a.jsx("th",{style:Qe,colSpan:2,children:""}),st.map(Ee=>a.jsxs("th",{style:Qe,colSpan:2,children:["BTL-",Ee]},`btl_view_${Ee}`))]}),a.jsxs("tr",{children:[Je===0?a.jsx("th",{style:Qe,children:""}):a.jsx(a.Fragment,{children:br.map(Ee=>Array.from({length:Ee.expCount},(et,Be)=>a.jsx("th",{style:Qe,children:Ee.expMax},`max_view_${Ee.coNumber}_${Be}`)))}),nn?a.jsx(a.Fragment,{children:Wt?Tt.map(Ee=>a.jsx("th",{style:Qe,children:_d[Ee.coNumber]??0},`lab_cia_max_view_${Ee.coNumber}`)):null}):Wt&&gn?_t>0?bt.map(Ee=>a.jsx("th",{style:Qe,children:Sp[Ee.coNumber]??0},`caa_max_view_${Ee.coNumber}`)):a.jsx("th",{style:Qe,children:""}):null,it?br.map(Ee=>{const et=nn?Rh(Number(Fj[Ee.coNumber]||0)+(Wt?Number(_d[Ee.coNumber]||0):0)):(()=>{const Be=Number(Rj[Ee.coNumber]||0);return gn&&Be>0?Be:Ee.expMax+(Wt?pr/2:0)})();return a.jsxs(sn.Fragment,{children:[a.jsx("th",{style:Qe,children:et}),a.jsx("th",{style:Qe,children:"%"})]},`comax_view_${Ee.coNumber}`)}):a.jsxs(a.Fragment,{children:[a.jsx("th",{style:Qe,children:""}),a.jsx("th",{style:Qe,children:"%"})]}),st.map(Ee=>a.jsxs(sn.Fragment,{children:[a.jsx("th",{style:Qe,children:$t||ra}),a.jsx("th",{style:Qe,children:"%"})]},`btlmax_view_${Ee}`))]}),a.jsxs("tr",{children:[Je===0?a.jsx("th",{style:Qe,children:"No experiments"}):a.jsx(a.Fragment,{children:br.map(Ee=>Array.from({length:Ee.expCount},(et,Be)=>a.jsxs("th",{style:Qe,children:["E",Be+1]},`e_view_${Ee.coNumber}_${Be}`)))}),a.jsx("th",{style:Qe,colSpan:Gt+st.length*2+Dt})]}),a.jsxs("tr",{children:[Je===0?a.jsx("th",{style:Qe,children:"BTL"}):a.jsx(a.Fragment,{children:br.map(Ee=>Array.from({length:Ee.expCount},(et,Be)=>a.jsx("th",{style:Qe,children:Ee.btl[Be]||1},`btlhdr_view_${Ee.coNumber}_${Be}`)))}),a.jsx("th",{style:Qe,colSpan:Gt+st.length*2+Dt})]})]}),a.jsxs("tbody",{children:[b.map((Ee,et)=>{var Xt,vn;const Be=ie&&ie.sheet?ie.sheet:vt.sheet,kt=(Xt=Be==null?void 0:Be.rowsByStudentId)==null?void 0:Xt[String(Ee.id)],ar=ze(kt,br),Rt=ar.flatMap(hn=>hn.marks),jr=Gb(Rt),_r=Ze(kt,ar),Hr=it?_r.coAttainmentValues:[],Mr=_r.caaByCo,Qr=_r.ciaByCo,Vr={};for(const hn of st){const kn=[];for(const _n of br){const yn=((vn=ar.find(ci=>ci.coNumber===_n.coNumber))==null?void 0:vn.marks)??[];for(let ci=0;ci<Math.min(_n.expCount,yn.length);ci++)if(_n.btl[ci]===hn){const Wn=yn[ci];typeof Wn=="number"&&Number.isFinite(Wn)&&kn.push(Wn)}}Vr[hn]=kn.length?kn.reduce((_n,yn)=>_n+yn,0)/kn.length:null}return a.jsxs("tr",{children:[a.jsx("td",{style:{...vr,...wr(0,xn),textAlign:"center"},children:et+1}),a.jsx("td",{style:{...vr,...wr(xn,zn)},title:String(Ee.reg_no||""),children:PM(Ee.reg_no,7)}),a.jsx("td",{style:{...vr,...wr(xn+zn,Rn)},title:String(Ee.name||""),children:a.jsx("span",{style:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:String(Ee.name||"")})}),Je===0?a.jsx("td",{style:{...vr,textAlign:"center",color:"#6b7280"},children:""}):br.map(hn=>{var _n;const kn=((_n=ar.find(yn=>yn.coNumber===hn.coNumber))==null?void 0:_n.marks)??[];return Array.from({length:hn.expCount},(yn,ci)=>a.jsx("td",{style:{...vr,width:38,minWidth:0,padding:"2px 2px",background:"#fff7ed",textAlign:"center",fontWeight:800},children:kn[ci]??""},`view_m_${Ee.id}_${hn.coNumber}_${ci}`))}),a.jsx("td",{style:{...vr,width:L,minWidth:0,textAlign:"right",fontWeight:800},children:jr==null?"":jr.toFixed(1)}),nn?a.jsx(a.Fragment,{children:Wt?Tt.map(hn=>a.jsx("td",{style:{...vr,width:66,minWidth:0,padding:"2px 2px",background:"#fff7ed",textAlign:"center",fontWeight:800},children:Qr[String(hn.coNumber)]??""},`view_lab_cia_${Ee.id}_${hn.coNumber}`)):null}):Wt?gn?_t>0?bt.map(hn=>a.jsx("td",{style:{...vr,width:66,minWidth:0,padding:"2px 2px",background:"#fff7ed",textAlign:"center",fontWeight:800},children:Mr[String(hn.coNumber)]??""},`view_caa_${Ee.id}_${hn.coNumber}`)):a.jsx("td",{style:{...vr,textAlign:"center",color:"#6b7280"},children:""}):a.jsx("td",{style:{...vr,width:le,minWidth:0,padding:"2px 2px",background:"#fff7ed",textAlign:"center",fontWeight:800},children:(kt==null?void 0:kt.ciaExam)??""}):null,it?Hr.map(hn=>a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...vr,textAlign:"right"},children:hn.mark==null?"":hn.mark.toFixed(1)}),a.jsx("td",{style:{...vr,textAlign:"right"},children:Kb(hn.mark,hn.coMax)})]},`view_coatt_${Ee.id}_${hn.coNumber}`)):a.jsxs(a.Fragment,{children:[a.jsx("td",{style:{...vr,textAlign:"right"}}),a.jsx("td",{style:{...vr,textAlign:"right"}})]}),st.map(hn=>{const kn=Vr[hn]??null;return a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...vr,textAlign:"right"},children:kn==null?"":kn.toFixed(1)}),a.jsx("td",{style:{...vr,textAlign:"right"},children:Kb(kn,$t||ra)})]},`view_btl_${Ee.id}_${hn}`)})]},`view_${Ee.id}`)}),b.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:pt,style:{padding:10,color:"#6b7280"},children:"No students."})}):null]})]})})()}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{type:"button",className:"obe-btn",onClick:()=>Y(!1),children:"Close"})})]})})}):null]})}const Lxe=[{key:"q1",label:"Q1",max:2},{key:"q2",label:"Q2",max:2},{key:"q3",label:"Q3",max:2},{key:"q4",label:"Q4",max:2},{key:"q5",label:"Q5",max:2},{key:"q6",label:"Q6",max:2},{key:"q7",label:"Q7",max:16},{key:"q8",label:"Q8",max:16},{key:"q9",label:"Q9",max:16}];function Xb(e){return String(e||"").trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_-]/g,"").slice(0,48)}function Rxe(e,t){if(!t.length)return;const r=Object.keys(t[0]),n=[r.join(",")].concat(t.map(l=>r.map(c=>{const u=l[c],d=String(u??"").replace(/\n/g," ");return d.includes(",")||d.includes('"')?`"${d.replace(/"/g,'""')}"`:d}).join(","))).join(`
`),i=new Blob([n],{type:"text/csv"}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function Fxe(e){return String(e??"").trim().toLowerCase().replace(/\s+/g," ")}function Bxe({subjectId:e,classType:t,teachingAssignmentId:r,questionPaperType:n}){const i=x.useMemo(()=>[1,2,3,4,5,6],[]),s=Se=>{const st=String(Se??"AL").trim().toUpperCase();return st==="ML"||st==="MALPRACTICE"?"ML":st==="SKL"||st==="SICK"||st==="SICKLEAVE"||st==="SL"?"SKL":"AL"},o={border:"1px solid #111",padding:"4px 4px",background:"#ecfdf5",color:"#065f46",textAlign:"center",fontWeight:700,fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},l={border:"1px solid #111",padding:"4px 4px",fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},c=32,[u,d]=x.useState([]),[f,h]=x.useState(!1),[p,m]=x.useState(null),[g,y]=x.useState(null),[b,v]=x.useState(!1),[w,S]=x.useState(!1),[j,k]=x.useState(!1),[A,R]=x.useState(null),[M,B]=x.useState(null),[E,P]=x.useState(null),[U,G]=x.useState(null),[H,oe]=x.useState(!1),[de,W]=x.useState(null),V=x.useRef(!1),[ae,ee]=x.useState(!1),C=x.useRef(!1),[Y,q]=x.useState(!1),[O,X]=x.useState(null),[F,Q]=x.useState(null),[K,ne]=x.useState({}),[re,T]=x.useState({}),[I,ie]=x.useState(null),[D,Z]=x.useState(""),[me,Te]=x.useState(!1),[je,Le]=x.useState(null),[_e,He]=x.useState(!1),[We,Pt]=x.useState(""),[dt,Ye]=x.useState(!1),[lt,be]=x.useState(!1),ke=x.useRef(null),[ce,we]=x.useState(!1),ht=x.useMemo(()=>ni(t),[t]),nt=ht==="THEORY",Ie=ht==="TCPL"||ht==="TCPR",It=ht==="TCPR"?"TCPR":"TCPL",{data:ct,loading:Mt,error:xr,remainingSeconds:Pr,publishAllowed:Nt,refresh:Jr}=V0({assessment:"model",subjectCode:e,teachingAssignmentId:r}),{data:Ur,refresh:qr}=G0({assessment:"model",subjectCode:String(e||""),teachingAssignmentId:r,options:{poll:!1}}),{data:cn,refresh:Pn}=lc({assessment:"model",subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:r,options:{poll:!1}}),Lr=!!E||!!(Ur!=null&&Ur.exists&&(Ur!=null&&Ur.is_published))||!!U,mn=!!(cn!=null&&cn.allowed_by_approval),Me=Lr?mn:!0,qe=!!(Lr&&!mn),ut=!!(Lr&&qe),{pending:wt,pendingUntilMs:At,setPendingUntilMs:sr,refresh:Zt}=K0({enabled:!!ut&&!!e,assessment:"model",subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:r});Y0(!!_e);const Cr=!!(ct!=null&&ct.global_override_active&&(ct==null?void 0:ct.global_is_open)===!1),se=!!(Cr||Lr&&!Me);x.useEffect(()=>{be(!1)},[e,r,qe]);const ue=x.useMemo(()=>`model_qp_type_${e}_${String(r??"none")}`,[e,r]),[J,pe]=x.useState("");x.useEffect(()=>{const Se=vr=>{const tn=String(vr??"").trim().toUpperCase();return tn==="QP2"?"QP2":tn==="QP1"?"QP1":""},st=Se(n);if(st){pe(st);try{Kn(ue,st)}catch{}return}const pt=Zn(ue),Qe=Se(pt);pe(Qe||"QP1")},[ue,n]);const xe=String(J??"").trim().toUpperCase();x.useEffect(()=>{let Se=!0;return(async()=>{var tn;let pt=String(ht||"").trim().toUpperCase();if(pt.startsWith("THEORY")&&(pt="THEORY"),!pt){ie(null);return}const Qe=xe==="QP2"?"QP2":xe==="QP1"?"QP1":"",vr=pt==="THEORY"&&Qe||null;try{const An=await sh({class_type:pt,question_paper_type:vr,exam:"MODEL"}),xn=Array.isArray((tn=An==null?void 0:An.pattern)==null?void 0:tn.marks)?An.pattern.marks:[];if(!Se)return;ie(xn.length?An.pattern:null)}catch{if(!Se)return;ie(null)}})(),()=>{Se=!1}},[ht,xe]);const Ne=x.useMemo(()=>{const Se=Array.isArray(I==null?void 0:I.marks)?I.marks:null;return Array.isArray(Se)&&Se.length?Se.map((st,pt)=>({key:`q${pt+1}`,label:`Q${pt+1}`,max:Number(st)||0})):Lxe},[I]),St=4+Ne.length+1+4+i.length*2,Ve=Ie?K||{}:re||{},De={width:"100%",border:"none",outline:"none",background:"transparent",padding:0,margin:0,fontSize:11,textAlign:"center"},Re=async Se=>{const st=!!(Se!=null&&Se.silent);if(!r){d([]),st||m(null);return}st||h(!0),st||m(null);try{try{const tn=await mr(`/api/academics/teaching-assignments/${r}/`);if(tn.ok){const An=await tn.json();if(An&&An.elective_subject_id&&!An.section_id){const xn=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(An.elective_subject_id))}`);if(!xn.ok)throw new Error(`Elective-choices fetch failed: ${xn.status}`);const zn=await xn.json(),L=((Array.isArray(zn.results)?zn.results:Array.isArray(zn)?zn:zn.items||[])||[]).map(le=>({id:Number(le.student_id??le.id),reg_no:String(le.reg_no??le.registration_no??le.regno??""),name:String(le.name??le.full_name??le.username??""),section:le.section_name??le.section??null})).filter(le=>Number.isFinite(le.id)).sort((le,Oe)=>String(le.name||"").localeCompare(String(Oe.name||"")));d(L);return}}}catch{}const pt=await pc(r),vr=[...(pt==null?void 0:pt.students)||[]].sort((tn,An)=>String(tn.name||"").localeCompare(String(An.name||"")));d(vr)}catch(pt){d([]),st||m((pt==null?void 0:pt.message)||"Failed to load roster")}finally{st||h(!1)}};x.useEffect(()=>{Re()},[r]);const xt=()=>({version:1,qpType:String(J??""),classType:String(ht??""),tcplLikeKind:It,theoryQuestionBtl:Ht||{},tcplQuestionBtl:Ze||{},theorySheet:re||{},tcplSheet:K||{}}),Vt=Se=>{if(!Se||typeof Se!="object")return;C.current=!0;const st=typeof Se.qpType=="string"?Se.qpType:null;if(st!=null){const Qe=String(st||"").trim().toUpperCase()==="QP2"?"QP2":"QP1";pe(Qe);try{Kn(ue,Qe)}catch{}}if(Se.theoryQuestionBtl&&typeof Se.theoryQuestionBtl=="object"){it({...Je,...Se.theoryQuestionBtl});try{Kn(br,{...Je,...Se.theoryQuestionBtl})}catch{}}if(Se.tcplQuestionBtl&&typeof Se.tcplQuestionBtl=="object"){jt({...ze,...Se.tcplQuestionBtl});try{Kn($t,{...ze,...Se.tcplQuestionBtl})}catch{}}if(Se.tcplSheet&&typeof Se.tcplSheet=="object"){ne(Se.tcplSheet);try{Kn(gr,Se.tcplSheet)}catch{}}if(Se.theorySheet&&typeof Se.theorySheet=="object"){T(Se.theorySheet);try{Kn(dr,Se.theorySheet)}catch{}}window.setTimeout(()=>{C.current=!1},0)},qt=async Se=>{if(!e)return;const st=!!(Se!=null&&Se.silent);st||k(!0),st||y(null);try{const pt=await ri("model",e,r);pt!=null&&pt.draft&&Vt(pt.draft),R(pt!=null&&pt.updated_at?new Date(pt.updated_at).toLocaleString():null);const Qe=pt==null?void 0:pt.updated_by;B(typeof(Qe==null?void 0:Qe.name)=="string"?Qe.name:typeof(Qe==null?void 0:Qe.username)=="string"?Qe.username:null)}catch(pt){st||y((pt==null?void 0:pt.message)||"Failed to refresh draft")}finally{st||k(!1)}};x.useEffect(()=>{ee(!1);let Se=!0;return(async()=>{try{await qt({silent:!0})}finally{Se&&ee(!0)}})(),()=>{Se=!1}},[e,r]);const zt=async()=>{if(e){v(!0),y(null);try{await Fi("model",e,xt()),R(new Date().toLocaleString())}catch(Se){y((Se==null?void 0:Se.message)||"Draft save failed")}finally{v(!1)}}};x.useEffect(()=>{const Se=()=>{!e||qe||Fi("model",e,xt()).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",Se),()=>window.removeEventListener("obe:before-tab-switch",Se)},[e,qe]);const vt=async()=>{if(e){if(Lr){if(qe){if(wt){y("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}He(!0);return}y("Editing is already open for this published sheet.");return}if(Cr){y("Publishing is locked by IQAC.");return}if(!Nt){y("Publish window is closed. Please request IQAC approval.");return}S(!0),y(null);try{await R9(e,xt(),r),P(new Date().toLocaleString()),await yr(!1),Jr({silent:!0}),qr({silent:!0});try{window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:"model"}}))}catch{}}catch(Se){y((Se==null?void 0:Se.message)||"Publish failed")}finally{S(!1)}}},Lt=async()=>{if(e){Te(!0),Le(null),y(null);try{await jh({assessment:"model",subject_code:e,reason:D,teaching_assignment_id:r}),Le("Request sent to IQAC for approval.")}catch(Se){y((Se==null?void 0:Se.message)||"Failed to request approval")}finally{Te(!1),Jr({silent:!0})}}},er=async()=>{if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}if(wt){y("Edit request is pending. Please wait for approval.");return}const st=String(We||"").trim();if(!st){y("Reason is required.");return}Ye(!0),y(null);try{const pt=await sl({assessment:"model",subject_code:String(e),scope:"MARK_ENTRY",reason:st,teaching_assignment_id:r});alert(ol(pt)),He(!1),Pt(""),sr(Date.now()+24*60*60*1e3);try{Zt({silent:!0})}catch{}qr({silent:!0}),Pn({silent:!0})}catch(pt){const Qe=ll(pt,"Failed to request edit");y(Qe),alert(`Edit request failed: ${Qe}`)}finally{Ye(!1)}};async function yr(Se,st){if(e){Se&&oe(!0),W(null);try{const pt=await Im(String(e),r),Qe=(pt==null?void 0:pt.data)??null;!!(Qe&&typeof Qe=="object"&&Number(Qe.version)===1&&(typeof Qe.classType=="string"||typeof Qe.qpType=="string")&&("theorySheet"in Qe||"tcplSheet"in Qe))?(G(Qe),(st!=null&&st.applyToMain||qe)&&Vt(Qe)):(G(null),(Se||st!=null&&st.applyToMain)&&W("No published snapshot found."))}catch(pt){(Se||st!=null&&st.applyToMain)&&W((pt==null?void 0:pt.message)||"Failed to load published sheet")}finally{Se&&oe(!1)}}}x.useEffect(()=>{e&&yr(!1)},[e,r]),x.useEffect(()=>{if(e){if(!qe){V.current=!1;return}if(!V.current){if(V.current=!0,U&&typeof U=="object"){Vt(U);return}yr(!0,{applyToMain:!0})}}},[qe,e,r]),x.useEffect(()=>{if(!e||!Lr||Me)return;const Se=window.setInterval(()=>{qr({silent:!0})},3e4);return()=>window.clearInterval(Se)},[Me,Lr,e,qr]);const Br=x.useMemo(()=>u.length?u:Array.from({length:5},(Se,st)=>({id:-(st+1),reg_no:"",name:"",section:null})),[u]),cr=x.useMemo(()=>Object.values(Ve||{}).some(st=>!!(st!=null&&st.absent)),[Ve]),ur=x.useMemo(()=>{const Se=Array.isArray(I==null?void 0:I.marks)?I.marks:null;if(Array.isArray(Se)&&Se.length&&Ie)return Se.map((Qe,vr)=>({key:`q${vr+1}`,label:`Q${vr+1}`,max:Number(Qe)||0}));const st=It==="TCPR"?12:15,pt=It==="TCPR"?8:10;return Array.from({length:st},(Qe,vr)=>{const tn=vr+1;return{key:`q${tn}`,label:`Q${tn}`,max:tn<=pt?2:16}})},[It,I,Ie]),en=x.useMemo(()=>ur.reduce((Se,st)=>Se+st.max,0),[ur]),nn=30,gn=It==="TCPR",nr=5,Tr=gn?0:nn/nr,Dr=It==="TCPR"?"REVIEW":"LAB",Rr=x.useMemo(()=>{const Se=Array.isArray(I==null?void 0:I.marks)?I.marks:null;return Array.isArray(Se)&&Se.length&&nt?Se.map((st,pt)=>({key:`q${pt+1}`,label:`Q${pt+1}`,max:Number(st)||0})):[{key:"q1",label:"Q1",max:2},{key:"q2",label:"Q2",max:2},{key:"q3",label:"Q3",max:2},{key:"q4",label:"Q4",max:2},{key:"q5",label:"Q5",max:2},{key:"q6",label:"Q6",max:2},{key:"q7",label:"Q7",max:2},{key:"q8",label:"Q8",max:2},{key:"q9",label:"Q9",max:2},{key:"q10",label:"Q10",max:2},{key:"q11",label:"Q11",max:14},{key:"q12",label:"Q12",max:14},{key:"q13",label:"Q13",max:14},{key:"q14",label:"Q14",max:14},{key:"q15",label:"Q15",max:14},{key:"q16",label:"Q16",max:10}]},[I,nt]),tt=5,Xe=x.useMemo(()=>Rr.reduce((Se,st)=>Se+st.max,0),[Rr]),ot=x.useMemo(()=>{const Se=[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5,5],st=Array.isArray(I==null?void 0:I.cos)?I.cos:null;return nt&&Array.isArray(st)&&st.length===Rr.length?st.map(pt=>{const Qe=Number(pt);return Number.isFinite(Qe)?Math.max(1,Math.min(5,Math.trunc(Qe))):1}):Rr.length===Se.length?Se:Array.from({length:Rr.length},(pt,Qe)=>Se[Qe%Se.length])},[I,nt,Rr.length]),Wt=x.useMemo(()=>{const Se=[2,2,3,3,3,2,2,3,3,3,4,4,3,3,3,5];return Rr.length===Se.length?Se:Array.from({length:Rr.length},(st,pt)=>Se[pt%Se.length])},[Rr.length]),pr=x.useMemo(()=>{const Se=Array.from({length:tt},()=>0);return Rr.forEach((st,pt)=>{const Qe=ot[pt]??1;Qe>=1&&Qe<=tt&&(Se[Qe-1]+=st.max)}),Se},[Rr,ot]),Nr=x.useMemo(()=>pr,[pr]),br=x.useMemo(()=>`model_theory_questionBtl_${e}`,[e]),Je=x.useMemo(()=>Object.fromEntries(Rr.map((Se,st)=>{const pt=Wt[st];return[Se.key,typeof pt=="number"?pt:""]})),[Rr,Wt]),[Ht,it]=x.useState(Je);x.useEffect(()=>{if(!nt)return;const Se=Zn(br);it(Se&&typeof Se=="object"?{...Je,...Se}:Je)},[nt,br,Je]);const bt=(Se,st)=>{it(pt=>{const Qe={...pt||{},[Se]:st};return Kn(br,Qe),Qe})},_t=x.useMemo(()=>Rr.map((Se,st)=>{const pt=(Ht||{})[Se.key];if(pt===""||pt===1||pt===2||pt===3||pt===4||pt===5||pt===6)return pt;const Qe=Wt[st];return typeof Qe=="number"?Qe:""}),[Rr,Ht,Wt]),Tt=x.useMemo(()=>{const Se=[0,0,0,0,0,0];return Rr.forEach((st,pt)=>{const Qe=_t[pt];typeof Qe=="number"&&Qe>=1&&Qe<=6&&(Se[Qe-1]+=st.max)}),Se},[Rr,_t]),Dt=x.useMemo(()=>{const Se=It==="TCPR"?[1,1,2,2,3,3,4,4,1,2,3,4]:[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5],st=Array.isArray(I==null?void 0:I.cos)?I.cos:null;return Ie&&Array.isArray(st)&&st.length===ur.length?st.map(pt=>{const Qe=Number(pt);return Number.isFinite(Qe)?Math.max(1,Math.min(5,Math.trunc(Qe))):1}):ur.length===Se.length?Se:Array.from({length:ur.length},(pt,Qe)=>Se[Qe%Se.length])},[I,Ie,It,ur.length]),Gt=It==="TCPR"?"tcpr":"tcpl",$t=x.useMemo(()=>`model_${Gt}_questionBtl_${e}`,[e,Gt]),ze=x.useMemo(()=>Object.fromEntries(ur.map(Se=>[Se.key,""])),[ur]),[Ze,jt]=x.useState(ze);x.useEffect(()=>{if(!Ie)return;const Se=Zn($t);jt(Se&&typeof Se=="object"?{...ze,...Se}:ze)},[Ie,$t,ze]);const Bt=(Se,st)=>{jt(pt=>{const Qe={...pt||{},[Se]:st};return Kn($t,Qe),Qe})},gr=x.useMemo(()=>`model_${Gt}_sheet_${e}_${String(r??"none")}`,[e,r,Gt]);x.useEffect(()=>{if(!Ie)return;const Se=Zn(gr);ne(Se&&typeof Se=="object"?Se:{})},[Ie,gr]);const dr=x.useMemo(()=>`model_theory_sheet_${e}_${String(r??"none")}`,[e,r]);x.useEffect(()=>{if(Ie)return;const Se=Zn(dr);T(Se&&typeof Se=="object"?Se:{})},[Ie,dr]);const Kt=(Se,st)=>{ne(pt=>{const Qe={...pt||{},[Se]:st};return Kn(gr,Qe),Qe})},ye=(Se,st)=>{T(pt=>{const Qe={...pt||{},[Se]:st};return Kn(dr,Qe),Qe})},Ce=Se=>{if(Ie){ne(Se),Kn(gr,Se);return}T(Se),Kn(dr,Se)};x.useEffect(()=>{if(!ae||!e||qe||C.current)return;let Se=!1;const st=window.setTimeout(async()=>{try{await Fi("model",e,xt()),Se||R(new Date().toLocaleString())}catch{}},700);return()=>{Se=!0,window.clearTimeout(st)}},[ae,e,r,qe,J,ht,Ht,Ze,re,K]);const $e=(Se,st)=>{const pt=String(Se??"");if(pt.trim()==="")return"";const Qe=Number(pt);return Number.isFinite(Qe)?Math.max(0,Math.min(st,Qe)):""},ft=Se=>{const pt=(Math.round((Se+Number.EPSILON)*10)/10).toFixed(1);return pt.endsWith(".0")?pt.slice(0,-2):pt},Sr=()=>Ie?ur:Rr,at=()=>{const Se=Sr(),st=(u||[]).map((Qe,vr)=>{const tn=lr(Qe,vr),An=(Ve||{})[tn]||{},xn=An.q&&typeof An.q=="object"?An.q:{},zn={sno:vr+1,registerNo:String(Qe.reg_no||""),name:String(Qe.name||""),absent:An.absent?"YES":"",absentKind:An.absent?s(An.absentKind):""};if(Se.forEach(Rn=>{const xi=xn[Rn.key],L=Number(xi);zn[Rn.label]=Number.isFinite(L)?Math.max(0,Math.min(Rn.max,L)):""}),Ie){const Rn=Number(An.lab);zn[Dr]=Number.isFinite(Rn)?Math.max(0,Math.min(nn,Rn)):""}return zn}),pt=Ie?String(ht||"TCPL"):"THEORY";Rxe(`${Xb(e)}_MODEL_${Xb(pt)}.csv`,st)},Ut=()=>{const Se=Sr();if(!u.length)return;const st=["Register No","Student Name",...Se.map(xn=>`${xn.label} (${xn.max})`)];Ie&&st.push(`${Dr} (${nn})`),st.push("Status","Absence Kind");const pt=u.map(xn=>{const zn=[String(xn.reg_no||""),String(xn.name||"")],Rn=Se.map(()=>"");return Ie?[...zn,...Rn,"","present","AL"]:[...zn,...Rn,"present","AL"]}),Qe=bs.aoa_to_sheet([st,...pt]);Qe["!freeze"]={xSplit:0,ySplit:1};const vr=bs.book_new();bs.book_append_sheet(vr,Qe,"MODEL");const tn=Ie?String(ht||"TCPL"):"THEORY",An=`${Xb(e)}_MODEL_${Xb(tn)}_template.xlsx`;uy(vr,An)},Fe=()=>{var Se;qe||(Se=ke.current)==null||Se.click()},Ue=async Se=>{var st;if(Se){we(!0);try{const pt=Sr(),Qe=await Se.arrayBuffer(),vr=C0(Qe,{type:"array"}),tn=(st=vr.SheetNames)==null?void 0:st[0];if(!tn)throw new Error("No sheet found in the Excel file.");const An=vr.Sheets[tn],xn=bs.sheet_to_json(An,{header:1});if(!xn.length)throw new Error("Excel sheet is empty.");const zn=(xn[0]||[]).map(Fxe),Rn=ir=>zn.findIndex(wr=>ir(wr)),xi=Rn(ir=>ir==="register no"||ir==="reg no"||ir.includes("register")),L=Rn(ir=>ir==="status"||ir.includes("status")),le=Rn(ir=>ir==="absence kind"||ir==="absent kind"||ir==="kind");if(xi<0)throw new Error("Could not find Register No column.");const Oe=pt.map(ir=>{const wr=String(ir.label||"").toLowerCase(),Wr=Rn(Xr=>Xr===wr||Xr.startsWith(wr));return{q:ir,col:Wr}}),rt=Ie?Rn(ir=>ir===String(Dr||"").toLowerCase()||ir.startsWith(String(Dr||"").toLowerCase())):-1,Et=new Map;u.forEach((ir,wr)=>{const Wr=String(ir.reg_no||"").trim();Wr&&Et.set(Wr,lr(ir,wr))});const hr={...Ve||{}};for(let ir=1;ir<xn.length;ir++){const wr=xn[ir]||[],Wr=String(wr[xi]??"").trim();if(!Wr)continue;const Xr=Et.get(Wr);if(!Xr)continue;const dn=hr[Xr]||{},Ln={...dn.q||{}};Oe.forEach(({q:Be,col:kt})=>{if(kt<0)return;const ar=wr[kt],Rt=Number(ar);Ln[Be.key]=Number.isFinite(Rt)?Math.max(0,Math.min(Be.max,Rt)):""});const si=L>=0?String(wr[L]??"").trim().toLowerCase():"",Ir=si==="absent"||si==="ab"||si==="a",fe=le>=0?wr[le]:"AL",Ee=s(fe),et={...dn,q:Ln,absent:Ir,absentKind:Ee};if(Ie&&rt>=0){const Be=Number(wr[rt]);et.lab=Number.isFinite(Be)?Math.max(0,Math.min(nn,Be)):""}hr[Xr]=et}Ce(hr)}finally{we(!1)}}},Ct=async Se=>{var pt;const st=(pt=Se.target.files)==null?void 0:pt[0];if(Se.target.value="",!!st)try{await Ue(st)}catch(Qe){alert((Qe==null?void 0:Qe.message)||"Failed to import Excel")}},gt=x.useMemo(()=>{const Se=Array.from({length:nr},()=>0);return ur.forEach((st,pt)=>{const Qe=Dt[pt]??1;Qe>=1&&Qe<=nr&&(Se[Qe-1]+=st.max)}),Se},[ur,Dt,nr]),yt=x.useMemo(()=>gn?gt.map((Se,st)=>st===4?nn:Se):gt.map(Se=>Se+Tr),[gt,Tr,gn,nn]),mt=x.useMemo(()=>{const Se=[0,0,0,0,0,0];return ur.forEach(st=>{const pt=(Ze||{})[st.key]??"";typeof pt=="number"&&pt>=1&&pt<=6&&(Se[pt-1]+=st.max)}),Se},[ur,Ze]),tr=x.useMemo(()=>{const Se=new Set;return ur.forEach(st=>{const pt=(Ze||{})[st.key]??"";(pt===1||pt===2||pt===3||pt===4||pt===5||pt===6)&&Se.add(pt)}),Se.size===0?[1,2,3,4,5,6]:[1,2,3,4,5,6].filter(st=>Se.has(st))},[ur,Ze]),lr=(Se,st)=>{const pt=Se==null?void 0:Se.id;if(typeof pt=="number"&&pt>0)return`id:${pt}`;const Qe=String((Se==null?void 0:Se.reg_no)||"").trim();return Qe?`reg:${Qe}`:`idx:${st}`},Fr=x.useRef({}),rn=Se=>st=>{Fr.current[Se]=st},Sn=Se=>{const st=Fr.current[Se];if(st){st.focus();try{st.select()}catch{}}},Gr=4+ur.length+1+1+nr*2+tr.length*2,fn=x.useMemo(()=>{const Se=new Set;return Rr.forEach(st=>{const pt=(Ht||{})[st.key]??"";(pt===1||pt===2||pt===3||pt===4||pt===5||pt===6)&&Se.add(pt)}),Se.size===0?[1,2,3,4,5,6]:[1,2,3,4,5,6].filter(st=>Se.has(st))},[Rr,Ht]),an=4+Rr.length+1+tt*2+fn.length*2,bn=x.useMemo(()=>Y?Br.filter((Se,st)=>{var Qe;const pt=lr(Se,st);return O&&O.length?O.includes(pt):!!((Qe=(Ve||{})[pt])!=null&&Qe.absent)}):Br,[Br,Y,Ve,O]);return a.jsxs(X0,{children:[F?a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(15,23,42,0.45)",display:"flex",alignItems:"center",justifyContent:"center",padding:16,zIndex:50},onClick:()=>Q(null),children:a.jsxs("div",{style:{width:"min(520px, 100%)",background:"#fff",borderRadius:14,border:"1px solid rgba(15,23,42,0.10)",boxShadow:"0 20px 60px rgba(2,6,23,0.25)",padding:14},onClick:Se=>Se.stopPropagation(),children:[a.jsx("div",{style:{fontWeight:900,marginBottom:6},children:F.title}),a.jsx("div",{style:{fontSize:13,color:"#334155",marginBottom:12},children:F.message}),a.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:a.jsx("button",{className:"obe-btn",onClick:()=>Q(null),children:"Close"})})]})}):null,a.jsxs("div",{style:{marginBottom:10,color:"#6b7280",fontSize:12},children:["Subject: ",a.jsx("b",{children:e})," | Assessment: ",a.jsx("b",{children:"MODEL"}),ht?a.jsxs(a.Fragment,{children:[" ","| Class: ",a.jsx("b",{children:ht})]}):null," ","| QP: ",a.jsx("b",{children:xe||"QP1"})]}),f?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading roster"}):null,p?a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:p}):null,g?a.jsx("div",{style:{background:"#fff7ed",border:"1px solid #fed7aa",color:"#9a3412",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:g}):null,a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",marginBottom:10},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{onClick:at,className:"obe-btn obe-btn-secondary",disabled:!u.length,children:"Export CSV"}),a.jsx("button",{onClick:Ut,className:"obe-btn obe-btn-secondary",disabled:!u.length,children:"Export Excel"}),a.jsx("button",{onClick:Fe,className:"obe-btn obe-btn-secondary",disabled:!u.length||qe||ce,children:ce?"Importing":"Import Excel"}),a.jsx("input",{ref:ke,type:"file",accept:".xlsx,.xls",style:{display:"none"},onChange:Ct})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:zt,className:"obe-btn obe-btn-success",disabled:b||!e||qe,title:qe?"Published sheets are locked (IQAC must open editing).":void 0,children:b?"Saving":"Save Draft"}),a.jsx("button",{onClick:vt,className:"obe-btn obe-btn-primary",disabled:ut?wt:w||u.length===0||!Nt||se||Cr,title:u.length===0?"No students in roster":Nt?Cr?"Publishing locked by IQAC":void 0:"Publish window is closed.",children:ut?wt?"Request Pending":"Request Edit":w?"Publishing":"Publish"}),A&&a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Saved: ",A]}),E&&a.jsxs("div",{style:{fontSize:12,color:"#16a34a",alignSelf:"center"},children:["Published: ",E]})]})]}),a.jsx("div",{style:{marginBottom:10,fontSize:12,color:Nt?"#065f46":"#b91c1c"},children:Mt?"Checking publish due time":xr||(ct!=null&&ct.due_at?a.jsxs(a.Fragment,{children:["Due: ",new Date(ct.due_at).toLocaleString(),"  Remaining: ",sg(Pr)]}):"Due time not set by IQAC.")}),Cr?a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),a.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:a.jsx("button",{className:"obe-btn",onClick:()=>Jr(),disabled:Mt,children:"Refresh"})})]}):Nt?null:a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fecaca",background:"#fff7ed",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publish time is over"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:"Send a request to IQAC to approve publishing."}),a.jsx("textarea",{value:D,onChange:Se=>Z(Se.target.value),placeholder:"Reason (optional)",rows:3,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:[a.jsx("button",{className:"obe-btn",onClick:()=>Jr(),disabled:me||Mt,children:"Refresh"}),a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:Lt,disabled:me||!e,children:me?"Requesting":"Request Approval"})]}),je?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:je}):null]}),a.jsxs("div",{style:{marginBottom:10,display:"flex",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Saved"}),a.jsx("div",{style:{fontWeight:700},children:A||""}),M?a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["by ",a.jsx("span",{style:{color:"#0369a1",fontWeight:700},children:M})]}):null]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Published"}),a.jsx("div",{style:{fontWeight:700},children:E||""}),a.jsxs("div",{style:{marginTop:8,display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{className:"obe-btn",disabled:!Lr||!e,onClick:()=>yr(!0,{applyToMain:!0}),title:Lr?void 0:"Publish first to view the published snapshot.",children:H?"Loading":"View Published"}),a.jsx("button",{className:"obe-btn",onClick:()=>qr(),disabled:!e,children:"Refresh Lock"})]}),de?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#b91c1c"},children:de}):null]})]}),qe?a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Published & locked"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Editing and auto-save are disabled until IQAC opens the edit window."})]}):null,_e?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:80},onClick:()=>He(!1),children:a.jsxs("div",{style:{width:"min(520px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:16,border:"1px solid #e5e7eb",padding:14,boxShadow:"0 12px 30px rgba(0,0,0,0.18)"},onClick:Se=>Se.stopPropagation(),children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginTop:6,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",At?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:We,onChange:Se=>Pt(Se.target.value),placeholder:"Explain why you need to edit (required)",rows:3,className:"obe-input",style:{resize:"vertical"}})]}),a.jsxs("div",{style:{marginTop:10,display:"flex",gap:8,justifyContent:"flex-end"},children:[a.jsx("button",{className:"obe-btn",disabled:dt,onClick:()=>He(!1),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:dt||wt||!e||!String(We||"").trim(),onClick:er,children:dt?"Sending":wt?"Request Pending":"Send Request"})]})]})})}):null,a.jsx(a.Fragment,{children:a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:10},children:a.jsxs("button",{className:"obe-btn",disabled:!cr,onClick:()=>{if(Y)return;const Se=(Br||[]).map((st,pt)=>{var Qe;return{key:lr(st,pt),isAbsent:!!((Qe=(Ve||{})[lr(st,pt)])!=null&&Qe.absent)}}).filter(st=>st.isAbsent).map(st=>st.key);X(Se),q(!0)},title:cr?"Filter the table to show only absentees":"No absentees marked yet",style:Y?{background:"linear-gradient(180deg, #111827, #334155)",color:"#fff",borderColor:"rgba(2,6,23,0.12)"}:void 0,children:["Show absentees list",Y?a.jsx("span",{onClick:Se=>{Se.stopPropagation(),q(!1),X(null)},role:"button","aria-label":"Close absentees list",title:"Close absentees list",style:{marginLeft:10,display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:999,background:"rgba(255,255,255,0.18)",border:"1px solid rgba(255,255,255,0.25)",fontWeight:900,lineHeight:1,cursor:"pointer",userSelect:"none"},children:""}):null]})})}),a.jsxs("div",{style:{position:"relative",minHeight:qe&&!lt?220:void 0},children:[Lr&&qe?a.jsx("div",{style:{position:"absolute",inset:0,zIndex:30,pointerEvents:"none",background:"linear-gradient(180deg, rgba(34,197,94,0.18) 0%, rgba(16,185,129,0.24) 100%)"}}):null,Lr&&qe?a.jsxs("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:40,background:"#fff",border:"1px solid #e5e7eb",padding:"10px 14px",borderRadius:999,display:"flex",alignItems:"center",gap:12,boxShadow:"0 6px 18px rgba(17,24,39,0.06)",pointerEvents:"auto",maxWidth:"min(720px, 96vw)"},children:[a.jsx("div",{style:{width:34,height:34,borderRadius:999,display:"grid",placeItems:"center",background:"#fef3c7",border:"1px solid #f59e0b33",color:"#92400e"},"aria-hidden":"true",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M7 11V8a5 5 0 0 1 10 0v3",stroke:"#92400e",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M6 11h12a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2Z",stroke:"#92400e",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),a.jsxs("div",{style:{minWidth:0},children:[a.jsx("div",{style:{fontWeight:900,fontSize:18,color:"#111827",lineHeight:1.1},children:"Published  Locked"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280",marginTop:2},children:H?"Loading published marks":de||"Marks are published. IQAC approval is required to edit."})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{className:"obe-btn",disabled:!Lr||!e,onClick:async()=>{be(Se=>!Se);try{await yr(!0,{applyToMain:!0})}catch{}},title:Lr?void 0:"Publish first to view the published snapshot.",children:H?"Loading":"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:!e||wt,onClick:async()=>{if(wt){alert("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}He(!0)},title:"Ask IQAC to open editing for published marks",children:wt?"Request Pending":"Request Edit"})]})]}):null,a.jsx("div",{className:"obe-table-wrapper",style:{overflowX:"auto"},children:a.jsx("table",{className:"obe-table",style:{width:"max-content",minWidth:"100%",tableLayout:"auto",pointerEvents:qe?"none":void 0,opacity:qe?.78:1,display:qe&&!lt?"none":void 0},children:Ie?a.jsxs(a.Fragment,{children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:o,colSpan:Gr,children:["MODEL (",ht||"TCPL"," Header Template)"]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,width:c,minWidth:c},rowSpan:5,children:"S.No"}),a.jsx("th",{style:{...o,minWidth:110,overflow:"visible",textOverflow:"clip"},rowSpan:5,children:"Register No."}),a.jsx("th",{style:{...o,minWidth:240,overflow:"visible",textOverflow:"clip"},rowSpan:5,children:"Name of the Students"}),a.jsx("th",{style:{...o,minWidth:92},rowSpan:5,children:"AB"}),ur.map(Se=>a.jsx("th",{style:{...o,width:40,minWidth:40},children:Se.label},Se.key)),a.jsx("th",{style:{...o,minWidth:56},rowSpan:3,children:"Total"}),a.jsx("th",{style:{...o,minWidth:56},rowSpan:3,children:Dr}),a.jsx("th",{style:o,colSpan:nr*2,children:"CO ATTAINMENT"}),a.jsx("th",{style:o,colSpan:tr.length*2,children:"BTL ATTAINMENT"})]}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,fontWeight:800},colSpan:ur.length,children:"COS"}),a.jsx("th",{style:o,colSpan:nr*2,children:""}),a.jsx("th",{style:o,colSpan:tr.length*2,children:""})]}),a.jsxs("tr",{children:[Dt.map((Se,st)=>a.jsx("th",{style:{...o,width:40,minWidth:40},children:Se},`co-map-${st}`)),Array.from({length:nr}).map((Se,st)=>a.jsxs("th",{style:o,colSpan:2,children:["CO-",st+1]},`co-head-${st}`)),tr.map(Se=>a.jsxs("th",{style:o,colSpan:2,children:["BTL-",Se]},`btl-head-${Se}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,fontWeight:800},colSpan:ur.length,children:"BTL"}),a.jsx("th",{style:o,children:""}),a.jsx("th",{style:o,children:""}),Array.from({length:nr+tr.length}).flatMap((Se,st)=>a.jsxs(sn.Fragment,{children:[a.jsx("th",{style:{...o,minWidth:52},children:a.jsx("div",{style:{whiteSpace:"pre-line",lineHeight:"0.9",fontSize:"0.7em"},children:`M
A
R
K`})}),a.jsx("th",{style:{...o,minWidth:34},children:"%"})]},`mkpct-${st}`))]}),a.jsxs("tr",{children:[ur.map(Se=>{const st=(Ze||{})[Se.key]??"",pt=st===""?"-":String(st);return a.jsx("th",{style:{...o,width:40,minWidth:40,padding:0},children:a.jsxs("div",{style:{position:"relative",minWidth:40},children:[a.jsx("div",{style:{width:"100%",fontSize:11,padding:"4px 4px",border:"1px solid #d1d5db",borderRadius:8,background:"#fff",textAlign:"center",userSelect:"none",margin:2},title:`BTL: ${pt}`,children:pt}),a.jsxs("select",{"aria-label":`BTL for ${Se.label}`,value:st,onChange:Qe=>Bt(Se.key,Qe.target.value===""?"":Number(Qe.target.value)),style:{position:"absolute",inset:0,width:"100%",height:"100%",opacity:0,cursor:"pointer",appearance:"none"},children:[a.jsx("option",{value:"",children:"-"}),a.jsx("option",{value:"1",children:"1"}),a.jsx("option",{value:"2",children:"2"}),a.jsx("option",{value:"3",children:"3"}),a.jsx("option",{value:"4",children:"4"}),a.jsx("option",{value:"5",children:"5"}),a.jsx("option",{value:"6",children:"6"})]})]})},`btl-map-${Se.key}`)}),a.jsx("th",{style:o,children:""}),a.jsx("th",{style:o,children:""}),Array.from({length:nr*2+tr.length*2}).map((Se,st)=>a.jsx("th",{style:o,children:""},`tailblank-${st}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:o,children:"S.No"}),a.jsx("th",{style:o,children:"Register No."}),a.jsx("th",{style:o,children:"Name / Max Marks"}),a.jsx("th",{style:o,children:""}),ur.map(Se=>a.jsx("th",{style:{...o,width:40,minWidth:40},children:Se.max},`qmax-${Se.key}`)),a.jsx("th",{style:o,children:en}),a.jsx("th",{style:o,children:"30"}),yt.flatMap((Se,st)=>a.jsxs(sn.Fragment,{children:[a.jsx("th",{style:o,children:ft(Se)}),a.jsx("th",{style:o,children:"%"})]},`co-max-mm-${st}`)),tr.flatMap(Se=>a.jsxs(sn.Fragment,{children:[a.jsx("th",{style:o,children:ft(mt[Se-1]||0)}),a.jsx("th",{style:o,children:"%"})]},`btl-max-mm-${Se}`))]})]}),a.jsx("tbody",{children:bn.map((Se,st)=>a.jsx("tr",{children:(()=>{const pt=lr(Se,st),Qe=(K||{})[pt]||{},vr=!!Qe.absent,tn=Qe.lab??"",An=vr?s(Qe.absentKind):null,xn=!!(Y&&vr&&(An==="ML"||An==="SKL")),zn=vr&&An==="AL"?0:null,Rn=vr&&An==="ML"?60:vr&&An==="SKL"?75:null,xi={};ur.forEach(Ir=>{const fe=(Qe.q||{})[Ir.key]??"",Ee=typeof fe=="number"&&Number.isFinite(fe)?fe:0;xi[Ir.key]=Math.max(0,Math.min(Ir.max,Ee))});const L=typeof tn=="number"&&Number.isFinite(tn)?Math.max(0,Math.min(nn,tn)):0,le=Object.values(xi).reduce((Ir,fe)=>Ir+fe,0),Oe=Array.from({length:nr},()=>0);if(ur.forEach((Ir,fe)=>{const Ee=Dt[fe]??1;Ee>=1&&Ee<=nr&&(Oe[Ee-1]+=xi[Ir.key]||0)}),gn)Oe[4]+=L;else for(let Ir=0;Ir<nr;Ir++)Oe[Ir]+=L/nr;const rt=Oe.map((Ir,fe)=>{const Ee=yt[fe]||0;return Ee?Ir/Ee*100:0}),Et=[0,0,0,0,0,0];ur.forEach(Ir=>{const fe=(Ze||{})[Ir.key]??"";typeof fe=="number"&&fe>=1&&fe<=6&&(Et[fe-1]+=xi[Ir.key]||0)});const hr=Et.map((Ir,fe)=>{const Ee=mt[fe]||0;return Ee?Ir/Ee*100:0}),ir=Ir=>{if(Ir){Kt(pt,{...Qe,absent:!0,absentKind:s(Qe.absentKind),q:Object.fromEntries(ur.map(fe=>[fe.key,""])),lab:""});return}Kt(pt,{...Qe,absent:!1,absentKind:void 0})},wr=Ir=>{Kt(pt,{...Qe,absent:!0,absentKind:s(Ir)})},Wr=Ir=>{vr&&!xn||Kt(pt,{...Qe,lab:$e(Ir,nn)})},Xr=(Ir,fe,Ee)=>{if(vr&&!xn)return;const et=$e(fe,Ee),Be={...Qe.q||{},[Ir]:et};if(Rn!=null&&ur.reduce((ar,Rt)=>{const jr=Be[Rt.key]??"",_r=typeof jr=="number"&&Number.isFinite(jr)?jr:0;return ar+Math.max(0,Math.min(Rt.max,_r))},0)>Rn){Q({title:"Mark limit exceeded",message:An==="ML"?"For malpractice the total mark assigned is 60":"For Sick leave the Total mark assigned is 75"});return}Kt(pt,{...Qe,q:Be})},dn=[...ur.map(Ir=>Ir.key),"lab"],Ln=(Ir,fe)=>{const Ee=dn.indexOf(Ir),et=fe==="left"?Math.max(0,Ee-1):fe==="right"?Math.min(dn.length-1,Ee+1):Ee,Be=fe==="up"?Math.max(0,st-1):fe==="down"?Math.min(bn.length-1,st+1):st,ar=`${lr(bn[Be],Be)}|${dn[et]}`;Sn(ar)},si=Ir=>fe=>{fe.key==="Tab"?(fe.preventDefault(),Ln(Ir,fe.shiftKey?"left":"right")):fe.key==="ArrowLeft"?(fe.preventDefault(),Ln(Ir,"left")):fe.key==="ArrowRight"?(fe.preventDefault(),Ln(Ir,"right")):fe.key==="ArrowUp"||fe.key==="Enter"&&fe.shiftKey?(fe.preventDefault(),Ln(Ir,"up")):(fe.key==="ArrowDown"||fe.key==="Enter")&&(fe.preventDefault(),Ln(Ir,"down"))};return a.jsxs(a.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:st+1}),a.jsx("td",{style:l,children:Se.reg_no||""}),a.jsx("td",{style:l,children:Se.name||""}),a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[a.jsx("input",{type:"checkbox",checked:vr,onChange:Ir=>ir(Ir.target.checked)}),vr?a.jsxs("div",{className:"obe-ios-select",title:"Absent type",children:[a.jsx("span",{className:"obe-ios-select-value",children:An||"AL"}),a.jsxs("select",{"aria-label":"Absent type",value:An||"AL",onChange:Ir=>wr(s(Ir.target.value)),children:[a.jsx("option",{value:"AL",children:"AL"}),a.jsx("option",{value:"ML",children:"ML"}),a.jsx("option",{value:"SKL",children:"SKL"})]})]}):null]})}),ur.map(Ir=>{const fe=(Qe.q||{})[Ir.key]??"",Ee=`${pt}|${Ir.key}`;return a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsx("input",{ref:rn(Ee),type:"text",inputMode:"decimal",disabled:vr&&!xn,value:fe===""?"":String(fe),onChange:et=>Xr(Ir.key,et.target.value,Ir.max),onFocus:et=>et.currentTarget.select(),onKeyDown:si(Ir.key),style:De})},`${st}-${Ir.key}`)}),a.jsx("td",{style:{...l,textAlign:"center",fontWeight:700},children:ft(zn??le)}),a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsx("input",{ref:rn(`${pt}|lab`),type:"text",inputMode:"decimal",disabled:vr&&!xn,value:tn===""?"":String(tn),onChange:Ir=>Wr(Ir.target.value),onFocus:Ir=>Ir.currentTarget.select(),onKeyDown:si("lab"),style:De})}),Oe.flatMap((Ir,fe)=>a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:ft(Ir)}),a.jsx("td",{style:{...l,textAlign:"center"},children:ft(rt[fe])})]},`co-${st}-${fe}`)),tr.flatMap(Ir=>a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:ft(Et[Ir-1]||0)}),a.jsx("td",{style:{...l,textAlign:"center"},children:ft(hr[Ir-1]||0)})]},`btl-${st}-${Ir}`))]})})()},String(Se.id??st)))})]}):a.jsx(a.Fragment,{children:nt?a.jsxs(a.Fragment,{children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsx("th",{style:o,colSpan:an,children:"MODEL (THEORY Header Template)"})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,width:c,minWidth:c},rowSpan:5,children:"S.No"}),a.jsx("th",{style:{...o,minWidth:110,overflow:"visible",textOverflow:"clip"},rowSpan:5,children:"Register No."}),a.jsx("th",{style:{...o,minWidth:240,overflow:"visible",textOverflow:"clip"},rowSpan:5,children:"Name of the Students"}),a.jsx("th",{style:{...o,minWidth:92},rowSpan:5,children:"ABSENT"}),Rr.map(Se=>a.jsx("th",{style:{...o,width:40,minWidth:40},children:Se.label},Se.key)),a.jsx("th",{style:{...o,minWidth:56},rowSpan:3,children:"Total"}),a.jsx("th",{style:o,colSpan:tt*2,children:"CO ATTAINMENT"}),a.jsx("th",{style:o,colSpan:fn.length*2,children:"BTL ATTAINMENT"})]}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,fontWeight:800},colSpan:Rr.length,children:"COs"}),a.jsx("th",{style:o,colSpan:tt*2,children:""}),a.jsx("th",{style:o,colSpan:fn.length*2,children:""})]}),a.jsxs("tr",{children:[ot.map((Se,st)=>a.jsx("th",{style:{...o,width:40,minWidth:40},children:Se},`theory-co-map-${st}`)),Array.from({length:tt}).map((Se,st)=>a.jsxs("th",{style:o,colSpan:2,children:["CO-",st+1]},`theory-co-head-${st}`)),fn.map(Se=>a.jsxs("th",{style:o,colSpan:2,children:["BTL-",Se]},`theory-btl-head-${Se}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,fontWeight:800},colSpan:Rr.length,children:"BTL"}),a.jsx("th",{style:o,children:""}),Array.from({length:tt+fn.length}).flatMap((Se,st)=>a.jsxs(sn.Fragment,{children:[a.jsx("th",{style:{...o,minWidth:52},children:a.jsx("div",{style:{whiteSpace:"pre-line",lineHeight:"0.9",fontSize:"0.7em"},children:`M
A
R
K`})}),a.jsx("th",{style:{...o,minWidth:34},children:"%"})]},`theory-mkpct-${st}`))]}),a.jsxs("tr",{children:[Rr.map((Se,st)=>{const pt=(Ht||{})[Se.key]??"",Qe=pt===""?"-":String(pt);return a.jsx("th",{style:{...o,width:40,minWidth:40,padding:0},children:a.jsxs("div",{style:{position:"relative",minWidth:40},children:[a.jsx("div",{style:{width:"100%",fontSize:11,padding:"4px 4px",border:"1px solid #d1d5db",borderRadius:8,background:"#fff",textAlign:"center",userSelect:"none",margin:2},title:`BTL: ${Qe}`,children:Qe}),a.jsxs("select",{"aria-label":`BTL for ${Se.label}`,value:pt,onChange:vr=>bt(Se.key,vr.target.value===""?"":Number(vr.target.value)),style:{position:"absolute",inset:0,width:"100%",height:"100%",opacity:0,cursor:"pointer",appearance:"none"},children:[a.jsx("option",{value:"",children:"-"}),a.jsx("option",{value:"1",children:"1"}),a.jsx("option",{value:"2",children:"2"}),a.jsx("option",{value:"3",children:"3"}),a.jsx("option",{value:"4",children:"4"}),a.jsx("option",{value:"5",children:"5"}),a.jsx("option",{value:"6",children:"6"})]})]})},`theory-btl-map-${Se.key}`)}),a.jsx("th",{style:o,children:""}),Array.from({length:tt*2+fn.length*2}).map((Se,st)=>a.jsx("th",{style:o,children:""},`theory-tailblank-${st}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:o,children:"S.No"}),a.jsx("th",{style:o,children:"Register No."}),a.jsx("th",{style:o,children:"Name / Max Marks"}),a.jsx("th",{style:o,children:""}),Rr.map(Se=>a.jsx("th",{style:{...o,width:40,minWidth:40},children:Se.max},`theory-qmax-${Se.key}`)),a.jsx("th",{style:o,children:Xe}),Nr.flatMap((Se,st)=>a.jsxs(sn.Fragment,{children:[a.jsx("th",{style:o,children:ft(Se)}),a.jsx("th",{style:o,children:"%"})]},`theory-co-max-mm-${st}`)),fn.flatMap(Se=>a.jsxs(sn.Fragment,{children:[a.jsx("th",{style:o,children:ft(Tt[Se-1]||0)}),a.jsx("th",{style:o,children:"%"})]},`theory-btl-max-mm-${Se}`))]})]}),a.jsx("tbody",{children:bn.map((Se,st)=>a.jsx("tr",{children:(()=>{const pt=lr(Se,st),Qe=(Ve||{})[pt]||{},vr=!!Qe.absent,tn=vr?s(Qe.absentKind):null,An=!!(Y&&vr&&(tn==="ML"||tn==="SKL")),xn=vr&&tn==="AL"?0:null,zn=vr&&tn==="ML"?60:vr&&tn==="SKL"?75:null,Rn={};Rr.forEach(wr=>{const Wr=(Qe.q||{})[wr.key]??"",Xr=typeof Wr=="number"&&Number.isFinite(Wr)?Wr:0;Rn[wr.key]=Math.max(0,Math.min(wr.max,Xr))});const xi=Object.values(Rn).reduce((wr,Wr)=>wr+Wr,0),L=Array.from({length:tt},()=>0);Rr.forEach((wr,Wr)=>{const Xr=ot[Wr]??1;Xr>=1&&Xr<=tt&&(L[Xr-1]+=Rn[wr.key]||0)});const le=L.map((wr,Wr)=>{const Xr=Nr[Wr]||0;return Xr?wr/Xr*100:0}),Oe=[0,0,0,0,0,0];Rr.forEach((wr,Wr)=>{const Xr=_t[Wr];typeof Xr=="number"&&Xr>=1&&Xr<=6&&(Oe[Xr-1]+=Rn[wr.key]||0)});const rt=Oe.map((wr,Wr)=>{const Xr=Tt[Wr]||0;return Xr?wr/Xr*100:0}),Et=wr=>{if(wr){ye(pt,{...Qe,absent:!0,absentKind:s(Qe.absentKind),q:Object.fromEntries(Rr.map(Wr=>[Wr.key,""]))});return}ye(pt,{...Qe,absent:!1,absentKind:void 0})},hr=wr=>{ye(pt,{...Qe,absent:!0,absentKind:s(wr)})},ir=(wr,Wr,Xr)=>{if(vr&&!An)return;const dn=$e(Wr,Xr),Ln={...Qe.q||{},[wr]:dn};if(zn!=null&&Rr.reduce((Ir,fe)=>{const Ee=Ln[fe.key]??"",et=typeof Ee=="number"&&Number.isFinite(Ee)?Ee:0;return Ir+Math.max(0,Math.min(fe.max,et))},0)>zn){Q({title:"Mark limit exceeded",message:tn==="ML"?"For malpractice the total mark assigned is 60":"For Sick leave the Total mark assigned is 75"});return}ye(pt,{...Qe,q:Ln})};return a.jsxs(a.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:st+1}),a.jsx("td",{style:l,children:Se.reg_no||""}),a.jsx("td",{style:l,children:Se.name||""}),a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[a.jsx("input",{type:"checkbox",checked:vr,onChange:wr=>Et(wr.target.checked)}),vr?a.jsxs("div",{className:"obe-ios-select",title:"Absent type",children:[a.jsx("span",{className:"obe-ios-select-value",children:tn||"AL"}),a.jsxs("select",{"aria-label":"Absent type",value:tn||"AL",onChange:wr=>hr(s(wr.target.value)),children:[a.jsx("option",{value:"AL",children:"AL"}),a.jsx("option",{value:"ML",children:"ML"}),a.jsx("option",{value:"SKL",children:"SKL"})]})]}):null]})}),Rr.map(wr=>{const Wr=(Qe.q||{})[wr.key]??"",Xr=`${pt}|${wr.key}`,dn=Rr.map(Ir=>Ir.key),Ln=(Ir,fe)=>{const Ee=Math.max(0,dn.indexOf(Ir)),et=fe==="left"?Math.max(0,Ee-1):fe==="right"?Math.min(dn.length-1,Ee+1):Ee,Be=fe==="up"?Math.max(0,st-1):fe==="down"?Math.min(bn.length-1,st+1):st,kt=lr(bn[Be],Be);Sn(`${kt}|${dn[et]}`)},si=Ir=>fe=>{fe.key==="Tab"?(fe.preventDefault(),Ln(Ir,fe.shiftKey?"left":"right")):fe.key==="ArrowLeft"?(fe.preventDefault(),Ln(Ir,"left")):fe.key==="ArrowRight"?(fe.preventDefault(),Ln(Ir,"right")):fe.key==="ArrowUp"||fe.key==="Enter"&&fe.shiftKey?(fe.preventDefault(),Ln(Ir,"up")):(fe.key==="ArrowDown"||fe.key==="Enter")&&(fe.preventDefault(),Ln(Ir,"down"))};return a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsx("input",{ref:rn(Xr),type:"text",inputMode:"decimal",disabled:vr&&!An,value:Wr===""?"":String(Wr),onChange:Ir=>ir(wr.key,Ir.target.value,wr.max),onFocus:Ir=>Ir.currentTarget.select(),onKeyDown:si(wr.key),style:De})},`${st}-${wr.key}`)}),a.jsx("td",{style:{...l,textAlign:"center",fontWeight:700},children:ft(xn??xi)}),L.flatMap((wr,Wr)=>a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:ft(wr)}),a.jsx("td",{style:{...l,textAlign:"center"},children:ft(le[Wr])})]},`theory-co-${st}-${Wr}`)),fn.flatMap(wr=>a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:ft(Oe[wr-1]||0)}),a.jsx("td",{style:{...l,textAlign:"center"},children:ft(rt[wr-1]||0)})]},`theory-btl-${st}-${wr}`))]})})()},String(Se.id??st)))})]}):a.jsxs(a.Fragment,{children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsx("th",{style:o,colSpan:St,children:"MODEL (Blank Template)"})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,width:c,minWidth:c},rowSpan:3,children:"S.No"}),a.jsx("th",{style:{...o,minWidth:70,overflow:"visible",textOverflow:"clip"},rowSpan:3,children:"R.No"}),a.jsx("th",{style:{...o,minWidth:240,overflow:"visible",textOverflow:"clip"},rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:{...o,minWidth:32},rowSpan:3,children:"AB"}),a.jsx("th",{style:o,colSpan:Ne.length,children:"QUESTIONS"}),a.jsx("th",{style:o,rowSpan:3,children:"Total"}),a.jsx("th",{style:o,colSpan:4,children:"CO ATTAINMENT"}),a.jsx("th",{style:o,colSpan:i.length*2,children:"BTL ATTAINMENT"})]}),a.jsxs("tr",{children:[Ne.map(Se=>a.jsx("th",{style:{...o,width:46,minWidth:46},children:Se.label},Se.key)),a.jsx("th",{style:o,colSpan:2,children:"CO-1"}),a.jsx("th",{style:o,colSpan:2,children:"CO-2"}),i.map(Se=>a.jsxs("th",{style:o,colSpan:2,children:["BTL-",Se]},`btl-head-${Se}`))]}),a.jsxs("tr",{children:[Ne.map(Se=>a.jsx("th",{style:{...o,width:46,minWidth:46},children:Se.max},Se.key)),Array.from({length:2+i.length}).flatMap((Se,st)=>a.jsxs(sn.Fragment,{children:[a.jsx("th",{style:{...o,minWidth:52},children:a.jsx("div",{style:{whiteSpace:"pre-line",lineHeight:"0.9",fontSize:"0.7em"},children:`M
A
R
K`})}),a.jsx("th",{style:{...o,minWidth:34},children:"%"})]},st))]})]}),a.jsx("tbody",{children:bn.map((Se,st)=>a.jsxs("tr",{children:[(()=>{const pt=lr(Se,st),Qe=(Ve||{})[pt]||{},vr=!!Qe.absent,tn=vr?s(Qe.absentKind):null,An=!!(Y&&vr&&(tn==="ML"||tn==="SKL")),xn=vr&&tn==="AL"?0:null,zn=vr&&tn==="ML"?60:vr&&tn==="SKL"?75:null,Rn={};Ne.forEach(rt=>{const Et=(Qe.q||{})[rt.key]??"",hr=typeof Et=="number"&&Number.isFinite(Et)?Et:0;Rn[rt.key]=Math.max(0,Math.min(rt.max,hr))});const xi=Object.values(Rn).reduce((rt,Et)=>rt+Et,0),L=rt=>{if(rt){ye(pt,{...Qe,absent:!0,absentKind:s(Qe.absentKind),q:Object.fromEntries(Ne.map(Et=>[Et.key,""]))});return}ye(pt,{...Qe,absent:!1,absentKind:void 0})},le=rt=>{ye(pt,{...Qe,absent:!0,absentKind:s(rt)})},Oe=(rt,Et,hr)=>{if(vr&&!An)return;const ir=$e(Et,hr),wr={...Qe.q||{},[rt]:ir};if(zn!=null&&Ne.reduce((Xr,dn)=>{const Ln=wr[dn.key]??"",si=typeof Ln=="number"&&Number.isFinite(Ln)?Ln:0;return Xr+Math.max(0,Math.min(dn.max,si))},0)>zn){Q({title:"Mark limit exceeded",message:tn==="ML"?"For malpractice the total mark assigned is 60":"For Sick leave the Total mark assigned is 75"});return}ye(pt,{...Qe,q:wr})};return a.jsxs(a.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:st+1}),a.jsx("td",{style:l,children:Se.reg_no||""}),a.jsx("td",{style:l,children:Se.name||""}),a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[a.jsx("input",{type:"checkbox",checked:vr,onChange:rt=>L(rt.target.checked)}),vr?a.jsxs("div",{className:"obe-ios-select",title:"Absent type",children:[a.jsx("span",{className:"obe-ios-select-value",children:tn||"AL"}),a.jsxs("select",{"aria-label":"Absent type",value:tn||"AL",onChange:rt=>le(s(rt.target.value)),children:[a.jsx("option",{value:"AL",children:"AL"}),a.jsx("option",{value:"ML",children:"ML"}),a.jsx("option",{value:"SKL",children:"SKL"})]})]}):null]})}),Ne.map(rt=>{const Et=(Qe.q||{})[rt.key]??"",hr=`${pt}|${rt.key}`,ir=Ne.map(Xr=>Xr.key),wr=(Xr,dn)=>{const Ln=Math.max(0,ir.indexOf(Xr)),si=dn==="left"?Math.max(0,Ln-1):dn==="right"?Math.min(ir.length-1,Ln+1):Ln,Ir=dn==="up"?Math.max(0,st-1):dn==="down"?Math.min(bn.length-1,st+1):st,fe=lr(bn[Ir],Ir);Sn(`${fe}|${ir[si]}`)},Wr=Xr=>dn=>{dn.key==="Tab"?(dn.preventDefault(),wr(Xr,dn.shiftKey?"left":"right")):dn.key==="ArrowLeft"?(dn.preventDefault(),wr(Xr,"left")):dn.key==="ArrowRight"?(dn.preventDefault(),wr(Xr,"right")):dn.key==="ArrowUp"||dn.key==="Enter"&&dn.shiftKey?(dn.preventDefault(),wr(Xr,"up")):(dn.key==="ArrowDown"||dn.key==="Enter")&&(dn.preventDefault(),wr(Xr,"down"))};return a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsx("input",{ref:rn(hr),type:"text",inputMode:"decimal",disabled:vr&&!An,value:Et===""?"":String(Et),onChange:Xr=>Oe(rt.key,Xr.target.value,rt.max),onFocus:Xr=>Xr.currentTarget.select(),onKeyDown:Wr(rt.key),style:De})},`${st}-${rt.key}`)}),a.jsx("td",{style:{...l,textAlign:"center",fontWeight:700},children:ft(xn??xi)})]})})(),a.jsx("td",{style:{...l,textAlign:"center"},children:""}),a.jsx("td",{style:{...l,textAlign:"center"},children:""}),a.jsx("td",{style:{...l,textAlign:"center"},children:""}),a.jsx("td",{style:{...l,textAlign:"center"},children:""}),i.flatMap(pt=>a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:""}),a.jsx("td",{style:{...l,textAlign:"center"},children:""})]},`${st}-btl-${pt}`))]},String(Se.id??st)))})]})})})})]})]})}function Dj({subjectId:e,teachingAssignmentId:t,assessmentKey:r,viewerMode:n}){const i=r==="cia1"?{label:"CIA 1 Review",coA:1,coB:2}:r==="cia2"?{label:"CIA 2 Review",coA:3,coB:4}:{label:"MODEL Review",coA:5,coB:null};return a.jsx(Dx,{subjectId:e,teachingAssignmentId:t,assessmentKey:r,skipMarkManager:!0,floatPanelOnTable:!0,label:i.label,coA:i.coA,coB:i.coB,initialEnabledCos:[1,2,3,4,5],viewerMode:!!n,itemLabel:"Content",itemLabelPlural:"Content",itemAbbrev:"Con",ciaExamAvailable:!0,absentEnabled:!0,autoSaveDraft:!0})}function $j({subjectId:e,teachingAssignmentId:t,assessmentKey:r,viewerMode:n,classType:i}){const s=ni(i||"");if(s&&s!=="PROJECT")return a.jsx("div",{style:{color:"#6b7280"},children:"Review mark entry is available only for PROJECT class type courses."});const o=r==="cia1"?{label:"CIA 1 Review",coA:1,coB:2}:r==="cia2"?{label:"CIA 2 Review",coA:3,coB:4}:{label:"MODEL Review",coA:5,coB:null};return a.jsx(Dx,{subjectId:e,teachingAssignmentId:t,assessmentKey:r,skipMarkManager:!0,floatPanelOnTable:!0,label:o.label,coA:o.coA,coB:o.coB,initialEnabledCos:[1,2,3,4,5],viewerMode:!!n,itemLabel:"Content",itemLabelPlural:"Content",itemAbbrev:"Con",ciaExamAvailable:!0,absentEnabled:!0,autoSaveDraft:!0})}function Ixe({subjectId:e,teachingAssignmentId:t,label:r}){return a.jsx(Z2,{subjectId:e,teachingAssignmentId:t,assessmentKey:"review1",label:r||"Review 1",coA:1,coB:2,allCos:[1,2,3,4,5]})}function Dxe({subjectId:e,teachingAssignmentId:t,label:r}){return a.jsx(Z2,{subjectId:e,teachingAssignmentId:t,assessmentKey:"review2",label:r||"Review 2",coA:3,coB:4,allCos:[1,2,3,4,5]})}const $xe=20,OM={co1:10,co2:10},_p={btl1:0,btl2:0,btl3:10,btl4:10,btl5:0,btl6:0},Dp=10;function oo(e,t,r){return Math.max(t,Math.min(r,e))}function Hl(e){return Math.round(e*10)/10}function xl(e,t){if(e==null)return"";if(!Number.isFinite(t)||t<=0)return"0";const r=e/t*100;return`${Number.isFinite(r)?r.toFixed(0):0}`}function Kv(e){if(e===""||e==null||typeof e=="string"&&e.trim()==="")return null;const t=Number(e);return Number.isFinite(t)?t:null}function jp(e,t,r){const n=e==null?void 0:e.btlMax,i=(n==null?void 0:n[String(t)])??(n==null?void 0:n[`btl${t}`])??(n==null?void 0:n[t]),s=Kv(i);return s??r}function Uxe(e){const t=Number(e);return Number.isFinite(t)&&t>0?t:Dp}function zxe(e,t){return`${t}_sheet_${e}`}function MM(e){return String(e||"").trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_-]/g,"").slice(0,48)}function Wxe(e,t){if(!t.length)return;const r=Object.keys(t[0]),n=[r.join(",")].concat(t.map(l=>r.map(c=>{const u=l[c],d=String(u??"").replace(/\n/g," ");return d.includes(",")||d.includes('"')?`"${d.replace(/"/g,'""')}"`:d}).join(","))).join(`
`),i=new Blob([n],{type:"text/csv"}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function qxe(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const l=r.localeCompare(n);if(l)return l}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim(),o=i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"});return o||0}function Uj(e){return e.slice(-8)}function Kz({subjectId:e,teachingAssignmentId:t,label:r,assessmentKey:n="ssa1"}){var Sr,at,Ut;const i=String(r||"SSA1"),s=n==="review1",o=!1,l=x.useMemo(()=>zxe(e,n),[e,n]),c=n==="review1"?_S:ag,u=n==="review1"?P9:T9,[d,f]=x.useState(null),[h,p]=x.useState(null),[m,g]=x.useState({termLabel:"KRCT AY25-26",batchLabel:e,rows:[],markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null}),y=String((d==null?void 0:d.termLabel)||"KRCT AY25-26"),b=((Sr=d==null?void 0:d.assessments)==null?void 0:Sr.ssa1)||{},v=Number.isFinite(Number(b==null?void 0:b.maxTotal))?Number(b.maxTotal):$xe,w=s?30:v,S={co1:Number.isFinite(Number((at=b==null?void 0:b.coMax)==null?void 0:at.co1))?Number(b.coMax.co1):OM.co1,co2:Number.isFinite(Number((Ut=b==null?void 0:b.coMax)==null?void 0:Ut.co2))?Number(b.coMax.co2):OM.co2},j=s?{co1:15,co2:15}:S,k={btl1:jp(b,1,_p.btl1),btl2:jp(b,2,_p.btl2),btl3:jp(b,3,_p.btl3),btl4:jp(b,4,_p.btl4),btl5:jp(b,5,_p.btl5),btl6:jp(b,6,_p.btl6)},A=s?30:Dp,R=x.useRef(null),[M,B]=x.useState(!1);x.useEffect(()=>{let Fe=!0;return(async()=>{try{const Ue=await oc();if(!Fe)return;f(Ue||null),g(Ct=>({...Ct,termLabel:String((Ue==null?void 0:Ue.termLabel)||Ct.termLabel||"KRCT AY25-26"),batchLabel:e}))}catch{}})(),()=>{Fe=!1}},[e]);const[E,P]=x.useState(!1),[U,G]=x.useState(null),[H,oe]=x.useState(()=>s?[3,4]:[]),[de,W]=x.useState(!1),[V,ae]=x.useState(!1),[ee,C]=x.useState(null),[Y,q]=x.useState(null),[O,X]=x.useState(null),F=x.useRef(!1),[Q,K]=x.useState(null),[ne,re]=x.useState(!1),[T,I]=x.useState(!1),[ie,D]=x.useState(""),[Z,me]=x.useState(!1),[Te,je]=x.useState(null),[Le,_e]=x.useState(null),[He,We]=x.useState(!1),[Pt,dt]=x.useState(null),[Ye,lt]=x.useState(!1),[be,ke]=x.useState(null),{data:ce,loading:we,error:ht,remainingSeconds:nt,publishAllowed:Ie,refresh:It}=V0({assessment:n,subjectCode:e,teachingAssignmentId:t}),{data:ct,loading:Mt,error:xr,refresh:Pr}=G0({assessment:n,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:Nt}=lc({assessment:n,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!1}}),{data:Jr}=lc({assessment:n,subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:t,options:{poll:!1}}),Ur=!!(ce!=null&&ce.global_override_active&&(ce==null?void 0:ce.global_is_open)===!1),[qr,cn]=x.useState(""),[Pn,Lr]=x.useState(!1),[mn,Me]=x.useState(null),[qe,ut]=x.useState(null),[wt,At]=x.useState(!1),[sr,Zt]=x.useState(null),[Cr,se]=x.useState(!1),ue=!!Q||!!(ct!=null&&ct.exists&&(ct!=null&&ct.is_published))||!!Le;x.useEffect(()=>{if(ct!=null&&ct.is_published&&(ct!=null&&ct.updated_at)&&!Q)try{K(new Date(String(ct.updated_at)).toLocaleString())}catch{K(String(ct.updated_at))}},[ct==null?void 0:ct.is_published,ct==null?void 0:ct.updated_at]);const[J,pe]=x.useState(null);x.useEffect(()=>{pe(null),K(null),_e(null),dt(null),I(!1),D(""),je(null)},[e,n,t]);const xe=!!m.markManagerLocked,Ne=Jr!=null&&Jr.approval_until?String(Jr.approval_until):null,St=Nt!=null&&Nt.approval_until?String(Nt.approval_until):null,Ve=!!(Jr!=null&&Jr.allowed_by_approval)&&!!Ne&&Ne!==((J==null?void 0:J.markEntryApprovalUntil)??null),De=!!(Nt!=null&&Nt.allowed_by_approval)&&!!St&&St!==((J==null?void 0:J.markManagerApprovalUntil)??null),Re=ue?!!(ct!=null&&ct.entry_open)||Ve||De:!0,xt=!!(ue&&!Re),{pending:Vt,pendingUntilMs:qt,setPendingUntilMs:zt,refresh:vt}=K0({enabled:!!(ue&&xt)&&!!e,assessment:n,subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:t});Y0(!!T||!!qe||!!ne);const Lt=!!e&&(Mt||!!xr||ct==null),er=!!(Ur||Lt||(ct?!ct.entry_open:ue?!Re:!xe)),yr=!!(Ur||xt||er),Br=m.markManagerSnapshot!=null,cr=x.useMemo(()=>{const Fe=new Set(H);return[1,2,3,4,5,6].filter(Ue=>Fe.has(Ue))},[H]),ur=x.useMemo(()=>8+cr.length*2,[cr.length,o]),en=x.useMemo(()=>{try{return m.rows.some(Fe=>!!Fe.absent||Object.values(Fe).some(Ue=>typeof Ue=="string"&&String(Ue).toLowerCase().includes("absent")))}catch{return!1}},[m.rows]),nn=x.useMemo(()=>Ye?be&&be.length?m.rows.filter(Fe=>be.includes(Number(Fe.studentId))):m.rows.filter(Fe=>!!Fe.absent||Object.values(Fe).some(Ue=>typeof Ue=="string"&&String(Ue).toLowerCase().includes("absent"))):m.rows,[m.rows,Ye,be]);x.useEffect(()=>{if(!e||!F.current)return;try{const Ct=`${n}_selected_btls_${e}`;Kn(Ct,H)}catch{}let Fe=!1;const Ue=setTimeout(async()=>{try{await Fi(n,e,{sheet:m,selectedBtls:H});try{l&&Kn(l,{termLabel:m.termLabel,batchLabel:m.batchLabel,rows:m.rows})}catch{}Fe||q(new Date().toLocaleString())}catch{}},700);return()=>{Fe=!0,clearTimeout(Ue)}},[H,e,m,n,l]),x.useEffect(()=>{if(!e)return;const Fe=Zn(l);Fe&&typeof Fe=="object"&&Array.isArray(Fe.rows)?g({termLabel:d!=null&&d.termLabel?String(d.termLabel):String(Fe.termLabel||"KRCT AY25-26"),batchLabel:e,rows:Fe.rows}):g({termLabel:y||"KRCT AY25-26",batchLabel:e,rows:[]})},[l,e,d,y]),x.useEffect(()=>{let Fe=!0;return F.current=!1,(async()=>{if(e){try{const Ue=await ri(n,e);if(!Fe)return;const Ct=Ue==null?void 0:Ue.draft,gt=Ct==null?void 0:Ct.sheet,yt=Ct==null?void 0:Ct.selectedBtls;if(gt&&typeof gt=="object"&&Array.isArray(gt.rows)){g(lr=>({...lr,termLabel:String(gt.termLabel||y||"KRCT AY25-26"),batchLabel:e,rows:gt.rows,markManagerSnapshot:(gt==null?void 0:gt.markManagerSnapshot)??lr.markManagerSnapshot??null,markManagerApprovalUntil:(gt==null?void 0:gt.markManagerApprovalUntil)??lr.markManagerApprovalUntil??null,markManagerLocked:typeof(gt==null?void 0:gt.markManagerLocked)=="boolean"?gt.markManagerLocked:!!((gt==null?void 0:gt.markManagerSnapshot)??lr.markManagerSnapshot)}));const mt=(Ue==null?void 0:Ue.updated_at)??null,tr=(Ue==null?void 0:Ue.updated_by)??null;if(mt)try{q(new Date(String(mt)).toLocaleString())}catch{q(String(mt))}tr&&X(String(tr.name||tr.username||tr.id||""));try{l&&Kn(l,{termLabel:String(gt.termLabel||y||"KRCT AY25-26"),batchLabel:e,rows:gt.rows})}catch{}}if(Array.isArray(yt)){oe(yt.map(mt=>Number(mt)).filter(mt=>Number.isFinite(mt)));try{const mt=`${n}_selected_btls_${e}`;Kn(mt,yt.map(tr=>Number(tr)).filter(tr=>Number.isFinite(tr)))}catch{}}}catch{}Fe&&(F.current=!0)}})(),()=>{Fe=!1}},[e,y,n,l]),x.useEffect(()=>{if(!e)return;if((!!(ct!=null&&ct.exists&&(ct!=null&&ct.is_published))||!!Q)&&(ct!=null&&ct.exists)){const gt=!!(ct!=null&&ct.mark_manager_locked);!!m.markManagerLocked!==gt&&g(yt=>({...yt,markManagerLocked:gt}));return}const Ue=!!(Nt!=null&&Nt.allowed_by_approval),Ct=Nt!=null&&Nt.approval_until?String(Nt.approval_until):null;if(Ue&&Ct){if(Ct===((J==null?void 0:J.markManagerApprovalUntil)??null))return;const gt=m.markManagerApprovalUntil?String(m.markManagerApprovalUntil):null;m.markManagerLocked&&gt!==Ct&&g(yt=>({...yt,markManagerLocked:!1,markManagerApprovalUntil:Ct}));return}},[e,ct==null?void 0:ct.exists,ct==null?void 0:ct.mark_manager_locked,Nt==null?void 0:Nt.allowed_by_approval,Nt==null?void 0:Nt.approval_until,m.markManagerLocked,Q,J==null?void 0:J.markManagerApprovalUntil,m.markManagerApprovalUntil]);const gn=Fe=>{g(Ue=>{const Ct=new Map,gt=new Map;for(const mt of Ue.rows||[])typeof mt.studentId=="number"&&Ct.set(mt.studentId,mt),mt.registerNo&&gt.set(String(mt.registerNo),mt);const yt=(Fe||[]).slice().sort(qxe).map(mt=>{const tr=Ct.get(mt.id)||gt.get(String(mt.reg_no||""));return{studentId:mt.id,section:String(mt.section||""),registerNo:String(mt.reg_no||""),name:String(mt.name||""),total:typeof(tr==null?void 0:tr.total)=="number"?oo(Number(tr.total),0,w):((tr==null?void 0:tr.total)==="","")}});return{...Ue,rows:yt}})},nr=async()=>{var Fe,Ue,Ct;if(!e){G("Subject ID is required.");return}P(!0),G(null);try{let gt=[],yt=null;try{const mt=await hc();console.log("[SSA1] My TAs:",mt==null?void 0:mt.length,"for subject:",e,"teachingAssignmentId:",t),yt=(mt||[]).find(tr=>{const lr=String(tr.subject_code||"").trim().toUpperCase()===String(e||"").trim().toUpperCase();return(t?tr.id===t:!1)||lr}),yt?console.log("[SSA1] Found TA match:",yt.id,"elective_subject_id:",yt.elective_subject_id,"section_id:",yt.section_id):console.log("[SSA1] No TA match found in user TAs")}catch(mt){console.warn("[SSA1] My TAs fetch failed:",mt)}if(yt&&yt.elective_subject_id&&!yt.section_id){console.log("[SSA1] Detected elective, fetching elective-choices for elective_subject_id:",yt.elective_subject_id);try{const mt=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(yt.elective_subject_id))}`);if(mt.ok){const tr=await mt.json(),lr=Array.isArray(tr.results)?tr.results:Array.isArray(tr)?tr:tr.items||[];console.log("[SSA1] Elective choices returned:",lr==null?void 0:lr.length,"students"),gt=(lr||[]).map(Fr=>({id:Number(Fr.student_id??Fr.id),reg_no:String(Fr.reg_no??Fr.regno??""),name:String(Fr.name??Fr.full_name??Fr.username??""),section:Fr.section_name??Fr.section??null}))}else console.warn("[SSA1] Elective-choices API returned error:",mt.status)}catch(mt){console.warn("[SSA1] Elective-choices fetch failed:",mt)}}if(!gt.length&&yt&&yt.id){console.log("[SSA1] Fetching regular TA roster for TA ID:",yt.id);try{const mt=await pc(yt.id);gt=mt.students||[],p({courseName:String(((Fe=mt==null?void 0:mt.teaching_assignment)==null?void 0:Fe.subject_name)||(yt==null?void 0:yt.subject_name)||""),courseCode:String(((Ue=mt==null?void 0:mt.teaching_assignment)==null?void 0:Ue.subject_code)||(yt==null?void 0:yt.subject_code)||e||""),className:String(((Ct=mt==null?void 0:mt.teaching_assignment)==null?void 0:Ct.section_name)||(yt==null?void 0:yt.section_name)||"")}),console.log("[SSA1] Regular roster returned:",gt.length,"students")}catch(mt){console.warn("[SSA1] TA roster fetch failed:",mt)}}console.log("[SSA1] Final roster count:",gt.length),gn(gt)}catch(gt){G((gt==null?void 0:gt.message)||"Failed to load roster")}finally{P(!1)}};x.useEffect(()=>{e&&nr()},[t,e]);async function Tr(Fe){if(e){Fe&&We(!0),dt(null);try{const Ue=await c(String(e));_e(Ue||null)}catch(Ue){Fe&&dt((Ue==null?void 0:Ue.message)||`Failed to load published ${i} marks`)}finally{Fe&&We(!1)}}}x.useEffect(()=>{e&&Tr(!1)},[e,n,t]);const Dr=x.useRef(null);x.useEffect(()=>{Dr.current=null},[e,n,t]),x.useEffect(()=>{if(!e||!ue)return;if(!Re){Dr.current=!1;return}const Fe=Dr.current;if(Dr.current=!0,Fe===!0)return;let Ue=!0;return(async()=>{try{const Ct=await ri(n,String(e));if(!Ue)return;const gt=Ct==null?void 0:Ct.draft,yt=gt==null?void 0:gt.sheet,mt=gt==null?void 0:gt.selectedBtls;if(yt&&typeof yt=="object"&&Array.isArray(yt.rows)&&yt.rows.some(lr=>(lr==null?void 0:lr.total)!==""&&(lr==null?void 0:lr.total)!=null)){g(lr=>({...lr,termLabel:String(yt.termLabel||y||"KRCT AY25-26"),batchLabel:e,rows:yt.rows,markManagerSnapshot:(yt==null?void 0:yt.markManagerSnapshot)??lr.markManagerSnapshot??null,markManagerApprovalUntil:(yt==null?void 0:yt.markManagerApprovalUntil)??lr.markManagerApprovalUntil??null,markManagerLocked:typeof(yt==null?void 0:yt.markManagerLocked)=="boolean"?yt.markManagerLocked:!!((yt==null?void 0:yt.markManagerSnapshot)??lr.markManagerSnapshot)})),Array.isArray(mt)&&oe(mt.map(lr=>Number(lr)).filter(lr=>Number.isFinite(lr))),F.current=!0;return}}catch{}Ue&&Tr(!1)})(),()=>{Ue=!1}},[Re,ue,e,n,y]),x.useEffect(()=>{if(!e||!ue||Re)return;const Fe=window.setInterval(()=>{Pr({silent:!0})},3e4);return()=>window.clearInterval(Fe)},[Re,ue,e,Pr]),x.useEffect(()=>{ne&&e&&(_e(null),Tr(!0))},[ne,e]);const Rr=async()=>{W(!0),C(null);try{await Fi(n,e,{sheet:m,selectedBtls:H}),q(new Date().toLocaleString())}catch(Fe){C((Fe==null?void 0:Fe.message)||`Failed to save ${i} draft`)}finally{W(!1)}},tt=x.useRef(m);tt.current=m;const Xe=x.useRef(H);Xe.current=H,x.useEffect(()=>{const Fe=()=>{if(!e||er)return;const Ue={sheet:tt.current,selectedBtls:Xe.current};Fi(n,e,Ue).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",Fe),()=>window.removeEventListener("obe:before-tab-switch",Fe)},[e,n,er]);const ot=async()=>{if(e){if(Ur){C("Publishing is locked by IQAC.");return}if(!Ie){C("Publish window is closed. Please request IQAC approval.");return}ae(!0),C(null);try{await u(e,m,t),K(new Date().toLocaleString()),pe({markEntryApprovalUntil:Ne,markManagerApprovalUntil:St}),g(Fe=>({...Fe,markManagerLocked:!0})),It(),Pr({silent:!0}),Tr(!1);try{console.debug("obe:published dispatch",{assessment:n,subjectId:e}),window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:n}}))}catch{}}catch(Fe){C((Fe==null?void 0:Fe.message)||`Failed to publish ${i}`)}finally{ae(!1)}}},Wt=async()=>{Lr(!0),Me(null),C(null);try{await jh({assessment:n,subject_code:e,reason:qr,teaching_assignment_id:t}),Me("Request sent to IQAC for approval.")}catch(Fe){C((Fe==null?void 0:Fe.message)||"Failed to request approval")}finally{Lr(!1),It()}};function pr(Fe){return JSON.stringify({maxTotal:w,coMax:j,selectedBtls:H.slice(),btlMax:k})}async function Nr(){if(e){At(!0),Zt(null);try{const Fe=await sl({assessment:n,subject_code:String(e),scope:"MARK_MANAGER",reason:`Edit request: Mark Manager changes for ${i} ${e}`,teaching_assignment_id:t});alert(ol(Fe))}catch(Fe){const Ue=ll(Fe,"Request failed");Zt(Ue),alert(`Edit request failed: ${Ue}`)}finally{At(!1)}}}async function br(){if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}if(Vt){alert("Edit request is pending. Please wait for approval.");return}const Ue=String(ie||"").trim();if(!Ue){je("Reason is required.");return}me(!0),je(null);try{const Ct=await sl({assessment:n,subject_code:String(e),scope:"MARK_ENTRY",reason:Ue,teaching_assignment_id:t});alert(ol(Ct)),I(!1),D(""),zt(Date.now()+24*60*60*1e3);try{vt({silent:!0})}catch{}Pr({silent:!0}),It()}catch(Ct){const gt=ll(Ct,"Request failed");je(gt),alert(`Edit request failed: ${gt}`)}finally{me(!1)}}async function Je(){if(e){At(!0),Zt(null);try{const Fe=pr(m),Ue=Nt!=null&&Nt.approval_until?String(Nt.approval_until):m.markManagerApprovalUntil||null,Ct={...m,markManagerLocked:!0,markManagerSnapshot:Fe,markManagerApprovalUntil:Ue},gt={sheet:Ct,selectedBtls:H};g(Ct),ut(null),se(!0),await Fi(n,String(e),gt),q(new Date().toLocaleString());try{await fh(n,String(e),t),Pr({silent:!0})}catch(yt){console.warn("confirmMarkManagerLock failed",yt)}}catch(Fe){Zt((Fe==null?void 0:Fe.message)||"Save failed")}finally{At(!1),setTimeout(()=>se(!1),2e3)}}}const Ht=()=>{confirm(`Reset ${i} marks for all students in this section?`)&&(er||g(Fe=>({...Fe,rows:(Fe.rows||[]).map(Ue=>({...Ue,total:""}))})))},it=(Fe,Ue)=>{g(Ct=>{const gt=Ct.rows.slice(),yt=gt[Fe]||{studentId:0,section:"",registerNo:"",name:"",total:""};return gt[Fe]={...yt,...Ue},{...Ct,rows:gt}})},bt=()=>{const Fe=m.rows.map((Ue,Ct)=>{const gt=typeof Ue.total=="number"?oo(Number(Ue.total),0,w):null,yt=gt==null?"":Hl(gt),tr=gt==null?null:Hl(gt/2),lr=tr==null?null:oo(tr,0,j.co1),Fr=tr==null?null:oo(tr,0,j.co2),rn=cr.map(Se=>Se-1),Gr=[k.btl1,k.btl2,k.btl3,k.btl4,k.btl5,k.btl6].map((Se,st)=>rn.includes(st)?s?A:Se>0?Se:Dp:Se),fn=gt==null?null:rn.length?Hl(gt/rn.length):0,an=Gr.map((Se,st)=>gt==null||!rn.includes(st)?null:Se>0?oo(fn,0,Se):Hl(fn)),bn={sno:Ct+1,registerNo:Ue.registerNo,name:Ue.name,co1_mark:lr??"",co1_pct:xl(lr,j.co1),co2_mark:Fr??"",co2_pct:xl(Fr,j.co2),btl1_mark:an[0]??"",btl1_pct:xl(an[0],Gr[0]),btl2_mark:an[1]??"",btl2_pct:xl(an[1],Gr[1]),btl3_mark:an[2]??"",btl3_pct:xl(an[2],Gr[2]),btl4_mark:an[3]??"",btl4_pct:xl(an[3],Gr[3]),btl5_mark:an[4]??"",btl5_pct:xl(an[4],Gr[4]),btl6_mark:an[5]??"",btl6_pct:xl(an[5],Gr[5])};return bn[i]=yt,bn});Wxe(`${e}_${MM(i)||"SSA1"}_sheet.csv`,Fe)},_t=()=>{if(!m.rows.length)return;const Fe=Number.isFinite(Number(j.co1))?Number(j.co1):0,Ue=Number.isFinite(Number(j.co2))?Number(j.co2):0,Ct=["Register No","Student Name",`Q1 (${Fe.toFixed(2)})`,`Q2 (${Ue.toFixed(2)})`,"Status"],gt=m.rows.map(lr=>[lr.registerNo,lr.name,"","","present"]),yt=bs.aoa_to_sheet([Ct,...gt]);yt["!freeze"]={xSplit:0,ySplit:1};const mt=bs.book_new();bs.book_append_sheet(mt,yt,i||"SSA1");const tr=`${e}_${MM(i)||"SSA1"}_template.xlsx`;uy(mt,tr)},Tt=async()=>{const Fe=m.rows.map((Ue,Ct)=>({sno:Ct+1,regNo:String(Ue.registerNo||""),name:String(Ue.name||""),total:Ue.total===""?"":Number(Ue.total)}));await fy({filenameBase:`${e}_${i}`,meta:{courseName:(h==null?void 0:h.courseName)||"",courseCode:(h==null?void 0:h.courseCode)||e,className:(h==null?void 0:h.className)||""},rows:Fe})};function Dt(Fe){return String(Fe??"").trim().toLowerCase().replace(/\s+/g," ")}const Gt=()=>{var Fe;er||(Fe=R.current)==null||Fe.click()},$t=async Fe=>{var Ue;if(Fe){B(!0);try{const Ct=await Fe.arrayBuffer(),gt=C0(Ct,{type:"array"}),yt=(Ue=gt.SheetNames)==null?void 0:Ue[0];if(!yt)throw new Error("No sheet found in the Excel file.");const mt=gt.Sheets[yt],tr=bs.sheet_to_json(mt,{header:1});if(!tr.length)throw new Error("Excel sheet is empty.");const lr=(tr[0]||[]).map(Dt),Fr=pt=>lr.findIndex(Qe=>pt(Qe)),rn=Fr(pt=>pt==="register no"||pt==="reg no"||pt.includes("register")),Sn=Fr(pt=>pt.startsWith("q1")),Gr=Fr(pt=>pt.startsWith("q2")),fn=Fr(pt=>pt==="total"||pt.includes("total")),an=Fr(pt=>pt==="status"||pt.includes("status"));if(rn<0)throw new Error("Could not find Register No column.");const bn=Number.isFinite(Number(j.co1))?Number(j.co1):0,Se=Number.isFinite(Number(j.co2))?Number(j.co2):0,st=new Map;m.rows.forEach((pt,Qe)=>{const vr=String(pt.registerNo||"").trim();vr&&st.set(vr,Qe);const tn=Uj(vr);tn&&st.set(tn,Qe)}),g(pt=>{const Qe=pt.rows.slice();for(let vr=1;vr<tr.length;vr++){const tn=tr[vr]||[],An=String(tn[rn]??"").trim();if(!An)continue;const xn=st.get(An);if(xn==null)continue;const Rn=(an>=0?String(tn[an]??""):"").trim().toLowerCase(),xi=Rn==="absent"||Rn==="ab"||Rn==="a",L=Sn>=0?Kv(tn[Sn]):null,le=Gr>=0?Kv(tn[Gr]):null,Oe=fn>=0?Kv(tn[fn]):null,rt=L==null?0:oo(L,0,bn),Et=le==null?0:oo(le,0,Se),hr=Oe??rt+Et,ir=xi?0:oo(hr,0,w);Qe[xn]={...Qe[xn],total:Hl(ir)}}return{...pt,rows:Qe}})}finally{B(!1)}}},ze=async Fe=>{var Ct;const Ue=(Ct=Fe.target.files)==null?void 0:Ct[0];if(Fe.target.value="",!!Ue)try{await $t(Ue)}catch(gt){alert((gt==null?void 0:gt.message)||"Failed to import Excel")}},Ze={padding:"10px 12px",background:"linear-gradient(180deg, rgba(11,74,111,0.06), rgba(240,249,255,0.06))",color:"#0b4a6f",textAlign:"center",fontWeight:800,fontSize:12,borderBottom:"1px solid rgba(148,163,184,0.5)",borderRight:"1px solid rgba(226,232,240,0.8)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},jt={padding:"10px 12px",fontSize:12,borderBottom:"1px solid rgba(226,232,240,0.9)",borderRight:"1px solid rgba(226,232,240,0.8)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},Bt={width:"100%",padding:"8px 10px",borderRadius:10,border:"1px solid rgba(226,232,240,0.9)",outline:"none",background:"rgba(255,255,255,0.9)",fontSize:12,textAlign:"center"},gr={display:"inline-flex",alignItems:"center",gap:6,padding:"4px 8px",border:"1px solid #d1d5db",borderRadius:999,background:"#fff",cursor:"pointer",userSelect:"none",fontSize:11},dr={border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},Kt=Fe=>{if(Ur||wt)return;const Ue=m.markManagerSnapshot!=null;xe&&Ue||oe(Ct=>Ct.includes(Fe)?Ct.filter(gt=>gt!==Fe):Ct.concat(Fe).sort((gt,yt)=>gt-yt))},ye=!!(ue&&xt),Ce=async()=>{if(Vt){alert("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}je(null),I(!0)},$e=ye?Ce:ot,ft=ye?Vt:!!(V||!Ie||er);return a.jsx(a.Fragment,{children:a.jsxs(X0,{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{onClick:nr,className:"obe-btn obe-btn-secondary",disabled:E,children:E?"Loading roster":"Load/Refresh Roster"}),a.jsx("button",{onClick:Ht,className:"obe-btn obe-btn-danger",disabled:!m.rows.length,children:"Reset Marks"}),a.jsxs("button",{className:"obe-btn obe-btn-secondary",disabled:!en,onClick:()=>{if(Ye)return;const Fe=m.rows.filter(Ue=>!!Ue.absent||Object.values(Ue).some(Ct=>typeof Ct=="string"&&String(Ct).toLowerCase().includes("absent"))).map(Ue=>Number(Ue.studentId)).filter(Ue=>Number.isFinite(Ue));ke(Fe.length?Fe:null),lt(!0)},title:en?"Filter the table to show only absentees":"No absentees marked yet",style:Ye?{background:"linear-gradient(180deg, #111827, #334155)",color:"#fff",borderColor:"rgba(2,6,23,0.12)"}:void 0,children:["Show absentees list",Ye?a.jsx("span",{onClick:Fe=>{Fe.stopPropagation(),lt(!1),ke(null)},role:"button","aria-label":"Close absentees list",title:"Close absentees list",style:{marginLeft:10,display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:999,background:"rgba(255,255,255,0.18)",border:"1px solid rgba(255,255,255,0.25)",fontWeight:900,lineHeight:1,cursor:"pointer",userSelect:"none"},children:""}):null]}),a.jsx("button",{onClick:bt,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Export CSV"}),a.jsx("button",{onClick:_t,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Export Excel"}),a.jsx("button",{onClick:Gt,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length||er||M,children:M?"Importing":"Import Excel"}),a.jsx("input",{ref:R,type:"file",accept:".xlsx,.xls",style:{display:"none"},onChange:ze})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:Tt,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Download"}),a.jsx("button",{onClick:Rr,className:"obe-btn obe-btn-success",disabled:de||er,title:er?"Table locked  confirm Mark Manager to enable actions":void 0,children:de?"Saving":"Save Draft"}),a.jsx("button",{onClick:$e,className:"obe-btn obe-btn-primary",disabled:ft,title:er?"Table locked  confirm Mark Manager to enable actions":void 0,children:ye?Vt?"Request Pending":"Request Edit":V?"Publishing":"Publish"})]})]}),a.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{style:dr,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Term"}),a.jsx("div",{style:{fontWeight:700},children:m.termLabel||""})]}),a.jsxs("div",{style:dr,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Batch"}),a.jsx("div",{style:{fontWeight:700},children:m.batchLabel||""})]}),a.jsxs("div",{style:dr,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Saved"}),a.jsx("div",{style:{fontWeight:700},children:Y||""}),O?a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["by ",a.jsx("span",{style:{color:"#0369a1",fontWeight:700},children:O})]}):null]}),a.jsxs("div",{style:dr,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Published"}),a.jsx("div",{style:{fontWeight:700},children:Q||""})]})]}),a.jsx("div",{style:{marginTop:10,fontSize:12,color:Ie?"#065f46":"#b91c1c"},children:we?"Checking publish due time":ht||(ce!=null&&ce.due_at?a.jsxs(a.Fragment,{children:["Due: ",new Date(ce.due_at).toLocaleString(),"  Remaining: ",sg(nt),ce.allowed_by_approval&&ce.approval_until?a.jsxs(a.Fragment,{children:["  Approved until ",new Date(ce.approval_until).toLocaleString()]}):null]}):"Due time not set by IQAC.")}),Ur?a.jsxs("div",{style:{marginTop:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),a.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:a.jsx("button",{className:"obe-btn",onClick:()=>It(),disabled:we,children:"Refresh"})})]}):Ie?null:a.jsxs("div",{style:{marginTop:10,border:"1px solid #fecaca",background:"#fff7ed",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publish time is over"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:"Send a request to IQAC to approve publishing."}),a.jsx("textarea",{value:qr,onChange:Fe=>cn(Fe.target.value),placeholder:"Reason (optional)",rows:3,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:[a.jsx("button",{className:"obe-btn",onClick:()=>It(),disabled:Pn||we,children:"Refresh"}),a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:Wt,disabled:Pn,children:Pn?"Requesting":"Request Approval"})]}),mn?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:mn}):null]}),ne?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:70},onClick:()=>re(!1),children:a.jsxs("div",{style:{width:"min(1100px, 96vw)",maxHeight:"min(80vh, 900px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Fe=>Fe.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsxs("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:["View Published ",i]}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:i}),a.jsx("button",{onClick:Fe=>{Fe.stopPropagation(),re(!1)},"aria-label":"Close",style:{marginLeft:8,border:"none",background:"transparent",fontSize:20,lineHeight:1,cursor:"pointer"},children:""})]}),He?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading published marks"}):null,Pt?a.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:Pt}):null,a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12,background:"#fff"},children:a.jsxs("table",{className:"ssa-modern-table",style:{borderCollapse:"separate",borderSpacing:0,width:"100%",minWidth:920},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:Ze,colSpan:ur,children:[m.termLabel," | ",m.batchLabel," | ",i]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...Ze,width:42,minWidth:42},rowSpan:4,children:"S.No"}),a.jsx("th",{style:Ze,rowSpan:4,children:"Register No."}),a.jsx("th",{style:Ze,rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:Ze,children:i}),null,a.jsx("th",{style:Ze,colSpan:4,children:"CO ATTAINMENT"}),cr.length?a.jsx("th",{style:Ze,colSpan:cr.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[a.jsxs("th",{style:Ze,children:[a.jsx("div",{style:{fontWeight:800},children:"COs"}),a.jsx("div",{style:{fontSize:12},children:"1,2"})]}),null,a.jsx("th",{style:Ze,colSpan:2,children:"CO-1"}),a.jsx("th",{style:Ze,colSpan:2,children:"CO-2"}),cr.map(Fe=>a.jsxs("th",{style:Ze,colSpan:2,children:["BTL-",Fe]},`btl-head-${Fe}`))]}),a.jsxs("tr",{children:[a.jsxs("th",{style:Ze,children:[a.jsx("div",{style:{fontWeight:800},children:"BTL"}),a.jsx("div",{style:{fontSize:12},children:cr.length?cr.join(","):"-"})]}),null,Array.from({length:2+cr.length}).flatMap((Fe,Ue)=>a.jsxs(sn.Fragment,{children:[a.jsx("th",{style:Ze,children:"Mark"}),a.jsx("th",{style:Ze,children:"%"})]},Ue))]}),a.jsxs("tr",{children:[a.jsx("th",{style:Ze,children:"Name / Max Marks"}),a.jsx("th",{style:Ze,children:w}),null,a.jsx("th",{style:Ze,children:j.co1}),a.jsx("th",{style:Ze,children:"%"}),a.jsx("th",{style:Ze,children:j.co2}),a.jsx("th",{style:Ze,children:"%"}),cr.flatMap(Fe=>[a.jsx("th",{style:Ze,children:String(s?A:Math.max(Number(k[`btl${Fe}`]??0)||0,Dp))},`btl-max-${Fe}`),a.jsx("th",{style:Ze,children:"%"},`btl-pct-${Fe}`)])]})]}),a.jsx("tbody",{children:m.rows.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:ur,style:{padding:14,color:"#6b7280",fontSize:13},children:"No students loaded yet. Choose a Teaching Assignment above, then click Load/Refresh Roster."})}):nn.map((Fe,Ue)=>{var an;const Ct=((an=Le==null?void 0:Le.marks)==null?void 0:an[String(Fe.studentId)])??null,gt=Ct==null||Ct===""?null:oo(Number(Ct),0,w),mt=gt==null?null:Hl(gt/2),tr=mt==null?null:oo(mt,0,j.co1),lr=mt==null?null:oo(mt,0,j.co2),Fr=cr.map(bn=>bn-1),Sn=[k.btl1,k.btl2,k.btl3,k.btl4,k.btl5,k.btl6].map((bn,Se)=>Fr.includes(Se)?s?A:bn>0?bn:Dp:bn),Gr=gt==null?null:Fr.length?Hl(gt/Fr.length):0,fn=Sn.map((bn,Se)=>gt==null||!Fr.includes(Se)?null:bn>0?oo(Gr,0,bn):Hl(Gr));return a.jsxs("tr",{style:{background:Ue%2===1?"#f8fafc":"#fff"},children:[a.jsx("td",{style:{...jt,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Ue+1}),a.jsx("td",{style:jt,children:Uj(Fe.registerNo)}),a.jsx("td",{style:jt,children:Fe.name}),a.jsx("td",{style:{...jt,width:90,background:"#fff7ed",textAlign:"center"},children:gt==null?"":Hl(gt)}),null,a.jsx("td",{style:{...jt,textAlign:"center"},children:tr??""}),a.jsx("td",{style:{...jt,textAlign:"center"},children:xl(tr,j.co1)}),a.jsx("td",{style:{...jt,textAlign:"center"},children:lr??""}),a.jsx("td",{style:{...jt,textAlign:"center"},children:xl(lr,j.co2)}),cr.map(bn=>{const Se=bn-1,st=fn[Se],pt=Sn[Se];return a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...jt,textAlign:"center"},children:st??""}),a.jsx("td",{style:{...jt,textAlign:"center"},children:xl(st,pt)})]},bn)})]},String(Fe.studentId||Ue))})})]})}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{className:"obe-btn",onClick:()=>re(!1),children:"Close"})})]})})}):null,(U||ee)&&a.jsx("div",{style:{marginTop:10,color:"#b91c1c",fontSize:13},children:U||ee}),a.jsxs("div",{style:{marginTop:12,...dr},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("div",{style:{fontWeight:800},children:"Mark Manager"}),a.jsx("div",{children:a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>{const Fe=m.markManagerSnapshot!=null;ut({mode:Fe?"request":"confirm"})},disabled:!e||wt,children:m.markManagerSnapshot?"Edit":"Save"})})]}),a.jsxs("div",{style:{marginTop:8,fontSize:13,color:"#6b7280"},children:[a.jsxs("div",{children:["Max ",i,": ",a.jsx("strong",{style:{color:"#111"},children:w})]}),a.jsxs("div",{children:["CO-1 max: ",a.jsx("strong",{style:{color:"#111"},children:j.co1}),"  CO-2 max: ",a.jsx("strong",{style:{color:"#111"},children:j.co2})]}),a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Selected BTLs:"}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[1,2,3,4,5,6].map(Fe=>{const Ue=H.includes(Fe),Ct=!!(xe&&m.markManagerSnapshot!=null);return a.jsxs("div",{onClick:()=>Kt(Fe),style:{...gr,borderColor:Ue?"#16a34a":"#cbd5e1",background:Ue?"#ecfdf5":"#fff",cursor:Ct||wt?"not-allowed":"pointer",opacity:Ct?.6:1,padding:"6px 8px"},"aria-disabled":Ct||wt,children:[a.jsx("input",{type:"checkbox",checked:Ue,readOnly:!0,style:{marginRight:6}}),a.jsxs("span",{style:{fontWeight:800},children:["BTL",Fe]})]},`card_btl_${Fe}`)})})]})]}),sr?a.jsx("div",{style:{marginTop:8,color:"#991b1b"},children:sr}):null]}),a.jsx("div",{style:{marginTop:14},children:Br?a.jsx("div",{className:"obe-table-wrapper",style:{overflowX:"auto"},children:a.jsx(og,{locked:!!(Ur||xt||ue&&Lt),title:Ur?"Locked by IQAC":xt?"Published  Locked":"Table Locked",subtitle:Ur?"Publishing is turned OFF globally for this assessment.":xt?"Marks are published. Request IQAC approval to edit.":"Confirm the Mark Manager",children:a.jsxs("table",{className:"ssa-modern-table",style:{borderCollapse:"separate",borderSpacing:0,width:"100%",minWidth:920},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:Ze,colSpan:ur,children:[m.termLabel," | ",m.batchLabel," | ",i]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...Ze,width:42,minWidth:42},rowSpan:4,children:"S.No"}),a.jsx("th",{style:Ze,rowSpan:4,children:"Register No."}),a.jsx("th",{style:Ze,rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:Ze,children:i}),null,a.jsx("th",{style:Ze,colSpan:4,children:"CO ATTAINMENT"}),cr.length?a.jsx("th",{style:Ze,colSpan:cr.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[a.jsxs("th",{style:Ze,children:[a.jsx("div",{style:{fontWeight:800},children:"COs"}),a.jsx("div",{style:{fontSize:12},children:"1,2"})]}),null,a.jsx("th",{style:Ze,colSpan:2,children:"CO-1"}),a.jsx("th",{style:Ze,colSpan:2,children:"CO-2"}),cr.map(Fe=>a.jsxs("th",{style:Ze,colSpan:2,children:["BTL-",Fe]},`btl-head-${Fe}`))]}),a.jsxs("tr",{children:[a.jsxs("th",{style:Ze,children:[a.jsx("div",{style:{fontWeight:800},children:"BTL"}),a.jsx("div",{style:{fontSize:12},children:cr.length?cr.join(","):"-"})]}),null,Array.from({length:2+cr.length}).flatMap((Fe,Ue)=>a.jsxs(sn.Fragment,{children:[a.jsx("th",{style:Ze,children:"Mark"}),a.jsx("th",{style:Ze,children:"%"})]},Ue))]}),a.jsxs("tr",{children:[a.jsx("th",{style:Ze,children:"Name / Max Marks"}),a.jsx("th",{style:Ze,children:w}),null,a.jsx("th",{style:Ze,children:j.co1}),a.jsx("th",{style:Ze,children:"%"}),a.jsx("th",{style:Ze,children:j.co2}),a.jsx("th",{style:Ze,children:"%"}),cr.flatMap(Fe=>[a.jsx("th",{style:Ze,children:String(s?A:Uxe(k[`btl${Fe}`]))},`btl-max-${Fe}`),a.jsx("th",{style:Ze,children:"%"},`btl-pct-${Fe}`)])]})]}),a.jsx("tbody",{children:m.rows.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:ur,style:{padding:14,color:"#6b7280",fontSize:13},children:"No students loaded yet. Choose a Teaching Assignment above, then click Load/Refresh Roster."})}):er&&!xt?a.jsx("tr",{children:a.jsx("td",{colSpan:ur,style:{padding:20,textAlign:"center",color:"#065f46",fontWeight:900},children:"Table locked  confirm the Mark Manager to enable student marks"})}):nn.map((Fe,Ue)=>{const Ct=typeof Fe.total=="number"?oo(Number(Fe.total),0,w):null,gt=Ct==null?null:Hl(Ct/2),yt=gt==null?null:oo(gt,0,j.co1),mt=gt==null?null:oo(gt,0,j.co2),tr=cr.map(Gr=>Gr-1),Fr=[k.btl1,k.btl2,k.btl3,k.btl4,k.btl5,k.btl6].map((Gr,fn)=>tr.includes(fn)?s?A:Gr>0?Gr:Dp:Gr),rn=Ct==null?null:tr.length?Hl(Ct/tr.length):0,Sn=Fr.map((Gr,fn)=>Ct==null||!tr.includes(fn)?null:Gr>0?oo(rn,0,Gr):Hl(rn));return a.jsxs("tr",{style:{background:Ue%2===1?"#f8fafc":"#fff"},children:[a.jsx("td",{style:{...jt,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Ue+1}),a.jsx("td",{style:jt,children:Uj(Fe.registerNo)}),a.jsx("td",{style:jt,children:Fe.name}),a.jsx("td",{style:{...jt,width:90,background:"#fff7ed"},children:yr?a.jsx("div",{style:Bt,children:typeof Fe.total=="number"?Hl(Fe.total):""}):a.jsx("input",{style:Bt,type:"number",value:Fe.total,min:0,max:w,onChange:Gr=>{if(yr)return;const fn=Gr.target.value;if(fn==="")return it(Ue,{total:""});const an=Number(fn);if(!Number.isFinite(an))return it(Ue,{total:""});if(an>w){Gr.currentTarget.setCustomValidity(`Max mark is ${w}`),Gr.currentTarget.reportValidity(),window.setTimeout(()=>Gr.currentTarget.setCustomValidity(""),0);return}Gr.currentTarget.setCustomValidity("");const bn=oo(an,0,w);it(Ue,{total:bn})}})}),null,a.jsx("td",{style:{...jt,textAlign:"center"},children:yt??""}),a.jsx("td",{style:{...jt,textAlign:"center"},children:xl(yt,j.co1)}),a.jsx("td",{style:{...jt,textAlign:"center"},children:mt??""}),a.jsx("td",{style:{...jt,textAlign:"center"},children:xl(mt,j.co2)}),cr.map(Gr=>{const fn=Gr-1,an=Sn[fn],bn=Fr[fn];return a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...jt,textAlign:"center"},children:an??""}),a.jsx("td",{style:{...jt,textAlign:"center"},children:xl(an,bn)})]},Gr)})]},String(Fe.studentId||Ue))})})]})})}):a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:20,background:"#fff"},children:a.jsxs("div",{style:{display:"grid",placeItems:"center",padding:40},children:[a.jsx("div",{style:{fontSize:40},children:""}),a.jsx("div",{style:{fontWeight:800,fontSize:16,marginTop:8},children:xt?"Published  Locked":"Table Locked"}),a.jsx("div",{style:{color:"#6b7280",marginTop:6},children:xt?"Marks published. Use View to inspect or Request Edit to ask IQAC for edit access.":"Confirm the Mark Manager to unlock the student list."}),a.jsx("div",{style:{display:"flex",gap:8,marginTop:12},children:xt?a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn",onClick:()=>re(!0),children:"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:Vt,onClick:Ce,children:Vt?"Request Pending":"Request Edit"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>ut({mode:"confirm"}),disabled:!e||wt,children:"Save Mark Manager"}),a.jsx("button",{className:"obe-btn",onClick:()=>Nr(),disabled:wt,children:"Request Access"})]})})]})})}),T?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:80},onClick:()=>{Z||I(!1)},children:a.jsxs("div",{style:{width:"min(560px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Fe=>Fe.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[i,"  ",String(e||"")]})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",qt?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:ie,onChange:Fe=>D(Fe.target.value),placeholder:"Explain why you need to edit (required)",rows:4,className:"obe-input",style:{resize:"vertical"}})]}),Te?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#b91c1c"},children:Te}):null,a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:12},children:[a.jsx("button",{className:"obe-btn",disabled:Z,onClick:()=>I(!1),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:Z||Vt||!e||!String(ie||"").trim(),onClick:br,children:Z?"Requesting":Vt?"Request Pending":"Send Request"})]})]})})}):null,a.jsx("style",{children:`
        @keyframes markManagerGlitch {
          0%, 100% { transform: translate(0,0); filter: none; }
          10% { transform: translate(-2px, 1px); }
          20% { transform: translate(2px, -1px); }
          30% { transform: translate(-1px, -2px); }
          40% { transform: translate(1px, 2px); }
          50% { transform: translate(-2px, -1px); }
          60% { transform: translate(2px, 1px); }
          70% { transform: translate(-1px, 1px); }
          80% { transform: translate(1px, -1px); }
          90% { transform: translate(-1px, 0); }
        }
        @keyframes markManagerDust {
          0% { opacity: 0.9; transform: translate(0,0) scale(1); }
          100% { opacity: 0; transform: translate(80px, -40px) scale(0.6); }
        }
        .markManagerDustParticle {
          position: absolute;
          width: 4px;
          height: 4px;
          background: #d1d5db;
          border-radius: 50%;
          animation: markManagerDust 2s ease-out forwards;
        }

        /* SSA table modern look (UI-only) */
        .ssa-modern-table th:last-child,
        .ssa-modern-table td:last-child {
          border-right: none;
        }
        .ssa-modern-table tbody tr:nth-child(even) td {
          background: #fbfdff;
        }
        .ssa-modern-table tbody tr:hover td {
          background: rgba(2, 132, 199, 0.03);
        }
      `}),a.jsxs("div",{style:{position:"relative"},children:[xe?null:a.jsx("div",{style:{position:"absolute",inset:0,zIndex:30,pointerEvents:"none",background:"rgba(107, 114, 128, 0.15)"}}),!xe&&!xt?a.jsxs("div",{style:{position:"absolute",left:"50%",top:6,transform:"translateX(-50%)",zIndex:40,width:160,background:"#fff",border:"1px solid #e5e7eb",padding:10,borderRadius:12,display:"flex",flexDirection:"column",gap:8,alignItems:"center",boxShadow:"0 6px 18px rgba(17,24,39,0.06)"},children:[a.jsx("div",{style:{width:100,height:72,display:"grid",placeItems:"center",background:"#fff",borderRadius:8},children:a.jsx("img",{src:"https://media.lordicon.com/icons/wired/flat/94-lock-unlock.gif",alt:"locked",style:{maxWidth:72,maxHeight:72,display:"block"}})}),a.jsxs("div",{style:{textAlign:"center"},children:[a.jsx("div",{style:{fontWeight:800,color:"#111827"},children:"Table Locked"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Confirm the Mark Manager"})]})]}):null]}),qe?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:9999},onClick:()=>{wt||ut(null)},children:a.jsxs("div",{style:{width:"min(640px,96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Fe=>Fe.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:qe.mode==="confirm"?`Confirmation - ${i}`:`Request Edit - ${i}`}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:i})]}),qe.mode==="confirm"?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"Confirm the selected settings. After confirming, Mark Manager will be applied and table will be editable."}),a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Item"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Value"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:["Max ",i]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:w})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"CO-1 max"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:j.co1})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"CO-2 max"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:j.co2})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"Selected BTLs"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",flexWrap:"wrap"},children:[1,2,3,4,5,6].map(Fe=>{const Ue=H.includes(Fe);return a.jsxs("div",{onClick:()=>oe(Ct=>Ct.includes(Fe)?Ct.filter(gt=>gt!==Fe):[...Ct,Fe].sort((gt,yt)=>gt-yt)),style:{...gr,borderColor:Ue?"#16a34a":"#cbd5e1",background:Ue?"#ecfdf5":"#fff",cursor:wt?"not-allowed":"pointer",padding:"6px 8px"},children:[a.jsx("input",{type:"checkbox",checked:Ue,readOnly:!0,style:{marginRight:6}}),a.jsxs("span",{style:{fontWeight:800},children:["BTL",Fe]})]},`modal_btl_${Fe}`)})})})]})]})]})})]}):a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. Mark Manager will remain locked until IQAC approves."}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[a.jsx("button",{className:"obe-btn",disabled:wt,onClick:()=>ut(null),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:wt||!e,onClick:async()=>{if(e){if(qe.mode==="request"){ut(null),await Nr();return}await Je()}},children:qe.mode==="confirm"?"Confirm":"Send Request"})]})]})})}):null]})})}function Hxe({subjectId:e,teachingAssignmentId:t,label:r}){return a.jsx(Kz,{subjectId:e,teachingAssignmentId:t,assessmentKey:"ssa1",label:r||"SSA1"})}const Vxe=20,LM={co3:10,co4:10},kp={btl1:0,btl2:0,btl3:10,btl4:10,btl5:0,btl6:0},Ap=10;function lo(e,t,r){return Math.max(t,Math.min(r,e))}function Vl(e){return Math.round(e*10)/10}function yl(e,t){if(e==null)return"";if(!Number.isFinite(t)||t<=0)return"0";const r=e/t*100;return`${Number.isFinite(r)?r.toFixed(0):0}`}function Yv(e){if(e===""||e==null||typeof e=="string"&&e.trim()==="")return null;const t=Number(e);return Number.isFinite(t)?t:null}function Np(e,t,r){const n=e==null?void 0:e.btlMax,i=(n==null?void 0:n[String(t)])??(n==null?void 0:n[`btl${t}`])??(n==null?void 0:n[t]),s=Yv(i);return s??r}function Gxe(e,t){return`${t}_sheet_${e}`}function RM(e){return String(e||"").trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_-]/g,"").slice(0,48)}function Kxe(e,t){if(!t.length)return;const r=Object.keys(t[0]),n=[r.join(",")].concat(t.map(l=>r.map(c=>{const u=l[c],d=String(u??"").replace(/\n/g," ");return d.includes(",")||d.includes('"')?`"${d.replace(/"/g,'""')}"`:d}).join(","))).join(`
`),i=new Blob([n],{type:"text/csv"}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function Yxe(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const l=r.localeCompare(n);if(l)return l}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim(),o=i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"});return o||0}function Qb(e){return e.slice(-8)}function Yz({subjectId:e,teachingAssignmentId:t,label:r,assessmentKey:n="ssa2"}){var ye,Ce,$e,ft,Sr;const i=String(r||"SSA2"),s=n==="review2",o=!1,l=x.useMemo(()=>Gxe(e,n),[e,n]),c=n==="review2"?jS:ey,u=n==="review2"?M9:O9,[d,f]=x.useState(null),[h,p]=x.useState(null),[m,g]=x.useState({termLabel:"KRCT AY25-26",batchLabel:e,rows:[],markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null}),y=String((d==null?void 0:d.termLabel)||"KRCT AY25-26"),b=((ye=d==null?void 0:d.assessments)==null?void 0:ye.ssa2)||{},v=Number.isFinite(Number(b==null?void 0:b.maxTotal))?Number(b.maxTotal):Vxe,w=s?30:v,S={co3:Number.isFinite(Number((Ce=b==null?void 0:b.coMax)==null?void 0:Ce.co3))?Number(b.coMax.co3):Number.isFinite(Number(($e=b==null?void 0:b.coMax)==null?void 0:$e.co1))?Number(b.coMax.co1):LM.co3,co4:Number.isFinite(Number((ft=b==null?void 0:b.coMax)==null?void 0:ft.co4))?Number(b.coMax.co4):Number.isFinite(Number((Sr=b==null?void 0:b.coMax)==null?void 0:Sr.co2))?Number(b.coMax.co2):LM.co4},j=s?{co3:15,co4:15}:S,k={btl1:Np(b,1,kp.btl1),btl2:Np(b,2,kp.btl2),btl3:Np(b,3,kp.btl3),btl4:Np(b,4,kp.btl4),btl5:Np(b,5,kp.btl5),btl6:Np(b,6,kp.btl6)},A=s?30:Ap,R=x.useRef(null),[M,B]=x.useState(!1);x.useEffect(()=>{let at=!0;return(async()=>{try{const Ut=await oc();if(!at)return;f(Ut||null),g(Fe=>({...Fe,termLabel:String((Ut==null?void 0:Ut.termLabel)||Fe.termLabel||"KRCT AY25-26"),batchLabel:e}))}catch{}})(),()=>{at=!1}},[e]);const[E,P]=x.useState(!1),[U,G]=x.useState(null),[H,oe]=x.useState(()=>s?[3,4]:[]),[de,W]=x.useState(!1),[V,ae]=x.useState(!1),[ee,C]=x.useState(null),[Y,q]=x.useState(null),[O,X]=x.useState(null),F=x.useRef(!1),[Q,K]=x.useState(null),[ne,re]=x.useState(!1),[T,I]=x.useState(""),[ie,D]=x.useState(!1),[Z,me]=x.useState(null),[Te,je]=x.useState(!1),[Le,_e]=x.useState(null),[He,We]=x.useState(!1),[Pt,dt]=x.useState(null),[Ye,lt]=x.useState(!1),{data:be,loading:ke,error:ce,remainingSeconds:we,publishAllowed:ht,refresh:nt}=V0({assessment:n,subjectCode:e,teachingAssignmentId:t}),{data:Ie,loading:It,error:ct,refresh:Mt}=G0({assessment:n,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:xr,refresh:Pr}=lc({assessment:n,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!0}}),{data:Nt,refresh:Jr}=lc({assessment:n,subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:t,options:{poll:!0}}),Ur=!!(be!=null&&be.global_override_active&&(be==null?void 0:be.global_is_open)===!1),[qr,cn]=x.useState(""),[Pn,Lr]=x.useState(!1),[mn,Me]=x.useState(null),[qe,ut]=x.useState(null),[wt,At]=x.useState(!1),[sr,Zt]=x.useState(null),[Cr,se]=x.useState(null);x.useEffect(()=>{se(null),K(null),_e(null),dt(null)},[e,n,t]);const ue=!!Q||!!(Ie!=null&&Ie.exists&&(Ie!=null&&Ie.is_published))||!!Le,J=!!m.markManagerLocked;x.useEffect(()=>{if(Ie!=null&&Ie.is_published&&(Ie!=null&&Ie.updated_at)&&!Q)try{K(new Date(String(Ie.updated_at)).toLocaleString())}catch{K(String(Ie.updated_at))}},[Ie==null?void 0:Ie.is_published,Ie==null?void 0:Ie.updated_at]);const pe=Nt!=null&&Nt.approval_until?String(Nt.approval_until):null,xe=xr!=null&&xr.approval_until?String(xr.approval_until):null,Ne=!!(Nt!=null&&Nt.allowed_by_approval)&&!!pe&&pe!==((Cr==null?void 0:Cr.markEntryApprovalUntil)??null),St=!!(xr!=null&&xr.allowed_by_approval)&&!!xe&&xe!==((Cr==null?void 0:Cr.markManagerApprovalUntil)??null),Ve=ue?!!(Ie!=null&&Ie.entry_open)||Ne||St:!0,De=!!(ue&&!Ve),{pending:Re,pendingUntilMs:xt,setPendingUntilMs:Vt,refresh:qt}=K0({enabled:!!(ue&&De)&&!!e,assessment:n,subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:t});Y0(!!ne||!!qe||!!Te);const zt=!!(ue&&De),vt=async()=>{if(Re){alert("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}me(null),re(!0)},Lt=!!e&&(It||!!ct||Ie==null),er=!!(Ur||Lt||(Ie?!Ie.entry_open:ue?!Ve:!J)),yr=m.markManagerSnapshot!=null,Br=!!(Ur||De||er),cr=!!(ue&&De&&J),ur=x.useMemo(()=>{const at=new Set(H);return[1,2,3,4,5,6].filter(Ut=>at.has(Ut))},[H]),en=x.useMemo(()=>8+ur.length*2,[o,ur.length]);x.useEffect(()=>{if(!e)return;try{const Fe=`${n}_selected_btls_${e}`;Kn(Fe,H)}catch{}if(!F.current)return;let at=!1;const Ut=setTimeout(async()=>{try{await Fi(n,e,{sheet:m,selectedBtls:H});try{l&&Kn(l,{termLabel:m.termLabel,batchLabel:m.batchLabel,rows:m.rows})}catch{}at||q(new Date().toLocaleString())}catch{}},700);return()=>{at=!0,clearTimeout(Ut)}},[H,e,m,l,n]),x.useEffect(()=>{if(!e)return;const at=Zn(l);at&&typeof at=="object"&&Array.isArray(at.rows)?g({termLabel:d!=null&&d.termLabel?String(d.termLabel):String(at.termLabel||"KRCT AY25-26"),batchLabel:e,rows:at.rows,markManagerSnapshot:(at==null?void 0:at.markManagerSnapshot)??null,markManagerApprovalUntil:(at==null?void 0:at.markManagerApprovalUntil)??null,markManagerLocked:typeof(at==null?void 0:at.markManagerLocked)=="boolean"?at.markManagerLocked:!!(at!=null&&at.markManagerSnapshot)}):g({termLabel:y||"KRCT AY25-26",batchLabel:e,rows:[],markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null})},[l,e,d,y]),x.useEffect(()=>{let at=!0;return F.current=!1,(async()=>{if(e){try{const Ut=await ri(n,e);if(!at)return;const Fe=Ut==null?void 0:Ut.draft,Ue=Fe==null?void 0:Fe.sheet,Ct=Fe==null?void 0:Fe.selectedBtls;if(Ue&&typeof Ue=="object"&&Array.isArray(Ue.rows)){g(mt=>({...mt,termLabel:String(Ue.termLabel||y||"KRCT AY25-26"),batchLabel:e,rows:Ue.rows,markManagerSnapshot:(Ue==null?void 0:Ue.markManagerSnapshot)??mt.markManagerSnapshot??null,markManagerApprovalUntil:(Ue==null?void 0:Ue.markManagerApprovalUntil)??mt.markManagerApprovalUntil??null,markManagerLocked:typeof(Ue==null?void 0:Ue.markManagerLocked)=="boolean"?Ue.markManagerLocked:!!((Ue==null?void 0:Ue.markManagerSnapshot)??mt.markManagerSnapshot)}));const gt=(Ut==null?void 0:Ut.updated_at)??null,yt=(Ut==null?void 0:Ut.updated_by)??null;if(gt)try{q(new Date(String(gt)).toLocaleString())}catch{q(String(gt))}yt&&X(String(yt.name||yt.username||yt.id||""));try{l&&Kn(l,{termLabel:String(Ue.termLabel||y||"KRCT AY25-26"),batchLabel:e,rows:Ue.rows})}catch{}}if(Array.isArray(Ct)){const gt=Ct.map(yt=>Number(yt)).filter(yt=>Number.isFinite(yt));oe(gt);try{const yt=`${n}_selected_btls_${e}`;Kn(yt,gt)}catch{}}}catch{}at&&(F.current=!0)}})(),()=>{at=!1}},[e,y,l,n]),x.useEffect(()=>{if(!e)return;if((!!(Ie!=null&&Ie.exists&&(Ie!=null&&Ie.is_published))||!!Q)&&(Ie!=null&&Ie.exists)){const Ue=!!(Ie!=null&&Ie.mark_manager_locked);!!m.markManagerLocked!==Ue&&g(Ct=>({...Ct,markManagerLocked:Ue}));return}const Ut=!!(xr!=null&&xr.allowed_by_approval),Fe=xr!=null&&xr.approval_until?String(xr.approval_until):null;if(Ut&&Fe){if(Fe===((Cr==null?void 0:Cr.markManagerApprovalUntil)??null))return;const Ue=m.markManagerApprovalUntil?String(m.markManagerApprovalUntil):null;m.markManagerLocked&&Ue!==Fe&&g(Ct=>({...Ct,markManagerLocked:!1,markManagerApprovalUntil:Fe}));return}},[e,Ie==null?void 0:Ie.exists,Ie==null?void 0:Ie.is_published,Ie==null?void 0:Ie.mark_manager_locked,xr==null?void 0:xr.allowed_by_approval,xr==null?void 0:xr.approval_until,m.markManagerLocked,m.markManagerApprovalUntil,Q,Cr==null?void 0:Cr.markManagerApprovalUntil]);const nn=at=>{g(Ut=>{const Fe=new Map,Ue=new Map;for(const gt of Ut.rows||[])typeof gt.studentId=="number"&&Fe.set(gt.studentId,gt),gt.registerNo&&Ue.set(String(gt.registerNo),gt);const Ct=(at||[]).slice().sort(Yxe).map(gt=>{const yt=Fe.get(gt.id)||Ue.get(String(gt.reg_no||""));return{studentId:gt.id,section:String(gt.section||""),registerNo:String(gt.reg_no||""),name:String(gt.name||""),total:typeof(yt==null?void 0:yt.total)=="number"?lo(Number(yt.total),0,w):((yt==null?void 0:yt.total)==="","")}});return{...Ut,rows:Ct}})},gn=async()=>{var at,Ut,Fe;if(!e){G("Subject ID is required.");return}P(!0),G(null);try{let Ue=[],Ct=null;try{const gt=await hc();console.log("[SSA2] My TAs:",gt==null?void 0:gt.length,"for subject:",e,"teachingAssignmentId:",t),Ct=(gt||[]).find(yt=>{const mt=String(yt.subject_code||"").trim().toUpperCase()===String(e||"").trim().toUpperCase();return(t?yt.id===t:!1)||mt}),Ct?console.log("[SSA2] Found TA match:",Ct.id,"elective_subject_id:",Ct.elective_subject_id,"section_id:",Ct.section_id):console.log("[SSA2] No TA match found in user TAs")}catch(gt){console.warn("[SSA2] My TAs fetch failed:",gt)}if(Ct&&Ct.elective_subject_id&&!Ct.section_id){console.log("[SSA2] Detected elective, fetching elective-choices for elective_subject_id:",Ct.elective_subject_id);try{const gt=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(Ct.elective_subject_id))}`);if(gt.ok){const yt=await gt.json(),mt=Array.isArray(yt.results)?yt.results:Array.isArray(yt)?yt:yt.items||[];console.log("[SSA2] Elective choices returned:",mt==null?void 0:mt.length,"students"),Ue=(mt||[]).map(tr=>({id:Number(tr.student_id??tr.id),reg_no:String(tr.reg_no??tr.regno??""),name:String(tr.name??tr.full_name??tr.username??""),section:tr.section_name??tr.section??null}))}else console.warn("[SSA2] Elective-choices API returned error:",gt.status)}catch(gt){console.warn("[SSA2] Elective-choices fetch failed:",gt)}}if(!Ue.length&&Ct&&Ct.id){console.log("[SSA2] Fetching regular TA roster for TA ID:",Ct.id);try{const gt=await pc(Ct.id);Ue=gt.students||[],p({courseName:String(((at=gt==null?void 0:gt.teaching_assignment)==null?void 0:at.subject_name)||(Ct==null?void 0:Ct.subject_name)||""),courseCode:String(((Ut=gt==null?void 0:gt.teaching_assignment)==null?void 0:Ut.subject_code)||(Ct==null?void 0:Ct.subject_code)||e||""),className:String(((Fe=gt==null?void 0:gt.teaching_assignment)==null?void 0:Fe.section_name)||(Ct==null?void 0:Ct.section_name)||"")}),console.log("[SSA2] Regular roster returned:",Ue.length,"students")}catch(gt){console.warn("[SSA2] TA roster fetch failed:",gt)}}console.log("[SSA2] Final roster count:",Ue.length),nn(Ue)}catch(Ue){G((Ue==null?void 0:Ue.message)||"Failed to load roster")}finally{P(!1)}};x.useEffect(()=>{e&&gn()},[t,e]);async function nr(at){if(e){at&&We(!0),dt(null);try{const Ut=await c(String(e));_e(Ut||null)}catch(Ut){at&&dt((Ut==null?void 0:Ut.message)||`Failed to load published ${i} marks`)}finally{at&&We(!1)}}}x.useEffect(()=>{e&&nr(!1)},[e,n,t]);const Tr=x.useRef(null);x.useEffect(()=>{Tr.current=null},[e,n,t]);const Dr=x.useRef(null);async function Rr(at=!0){try{if(nt(),Mt({silent:!1}),await nr(at),t)try{await gn()}catch{}}catch{}}x.useEffect(()=>{if(!e||!ue)return;if(!Ve){Tr.current=!1;return}const at=Tr.current;if(Tr.current=!0,at===!0)return;let Ut=!0;return(async()=>{try{const Fe=await ri(n,String(e));if(!Ut)return;const Ue=Fe==null?void 0:Fe.draft,Ct=Ue==null?void 0:Ue.sheet,gt=Ue==null?void 0:Ue.selectedBtls;if(Ct&&typeof Ct=="object"&&Array.isArray(Ct.rows)&&Ct.rows.some(mt=>(mt==null?void 0:mt.total)!==""&&(mt==null?void 0:mt.total)!=null)){g(mt=>({...mt,termLabel:String(Ct.termLabel||y||"KRCT AY25-26"),batchLabel:e,rows:Ct.rows,markManagerSnapshot:(Ct==null?void 0:Ct.markManagerSnapshot)??mt.markManagerSnapshot??null,markManagerApprovalUntil:(Ct==null?void 0:Ct.markManagerApprovalUntil)??mt.markManagerApprovalUntil??null,markManagerLocked:typeof(Ct==null?void 0:Ct.markManagerLocked)=="boolean"?Ct.markManagerLocked:!!((Ct==null?void 0:Ct.markManagerSnapshot)??mt.markManagerSnapshot)})),Array.isArray(gt)&&oe(gt.map(mt=>Number(mt)).filter(mt=>Number.isFinite(mt))),F.current=!0;return}}catch{}Ut&&nr(!1)})(),()=>{Ut=!1}},[Ve,ue,e,n,y]),x.useEffect(()=>{if(!e||!ue||Ve)return;const at=window.setInterval(()=>{Mt({silent:!0})},3e4);return()=>window.clearInterval(at)},[Ve,ue,e,Mt]),x.useEffect(()=>{Te&&e&&(_e(null),nr(!0))},[Te,e]);const tt=async()=>{W(!0),C(null);try{await Fi(n,e,{sheet:m,selectedBtls:H}),q(new Date().toLocaleString())}catch(at){C((at==null?void 0:at.message)||`Failed to save ${i} draft`)}finally{W(!1)}},Xe=x.useRef(m);Xe.current=m;const ot=x.useRef(H);ot.current=H,x.useEffect(()=>{const at=()=>{if(!e||er)return;const Ut={sheet:Xe.current,selectedBtls:ot.current};Fi(n,e,Ut).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",at),()=>window.removeEventListener("obe:before-tab-switch",at)},[e,n,er]);const Wt=async()=>{if(e){if(Ur){C("Publishing is locked by IQAC.");return}if(!ht){C("Publish window is closed. Please request IQAC approval.");return}if(ue&&De){if(Re){C("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}re(!0);return}ae(!0),C(null);try{await u(e,m,t),K(new Date().toLocaleString()),se({markEntryApprovalUntil:pe,markManagerApprovalUntil:xe}),g(at=>({...at,markManagerLocked:!0})),nt(),Mt({silent:!0}),nr(!1),setTimeout(()=>{try{if(Te&&Dr.current){const at=Dr.current;at.scrollTop=at.scrollHeight}}catch{}},50);try{console.debug("obe:published dispatch",{assessment:n,subjectId:e}),window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:n}}))}catch{}setTimeout(()=>{Rr(!0),lt(!0),setTimeout(()=>lt(!1),5e3)},2e3)}catch(at){C((at==null?void 0:at.message)||`Failed to publish ${i}`)}finally{ae(!1)}}},pr=async()=>{Lr(!0),Me(null),C(null);try{await jh({assessment:n,subject_code:e,reason:qr,teaching_assignment_id:t}),Me("Request sent to IQAC for approval.")}catch(at){C((at==null?void 0:at.message)||"Failed to request approval")}finally{Lr(!1),nt()}},Nr=()=>{confirm(`Reset ${i} marks for all students in this section?`)&&(er||g(at=>({...at,rows:(at.rows||[]).map(Ut=>({...Ut,total:""}))})))};function br(at){return JSON.stringify({maxTotal:w,coMax:j,selectedBtls:H.slice(),btlMax:k})}async function Je(){if(e){At(!0),Zt(null);try{const at=await sl({assessment:n,subject_code:String(e),scope:"MARK_MANAGER",reason:`Edit request: Mark Manager changes for ${i} ${e}`,teaching_assignment_id:t});alert(ol(at));try{await(Pr?Pr({silent:!0}):Promise.resolve())}catch{}}catch(at){const Ut=ll(at,"Request failed");Zt(Ut),alert(`Edit request failed: ${Ut}`)}finally{At(!1)}}}async function Ht(){if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}if(Re){alert("Edit request is pending. Please wait for approval.");return}const Ut=String(T||"").trim();if(!Ut){me("Reason is required.");return}D(!0),me(null);try{const Fe=await sl({assessment:n,subject_code:String(e),scope:"MARK_ENTRY",reason:Ut,teaching_assignment_id:t});alert(ol(Fe)),re(!1),I(""),Vt(Date.now()+24*60*60*1e3);try{qt({silent:!0})}catch{}Mt({silent:!0});try{await(Jr?Jr({silent:!0}):Promise.resolve())}catch{}}catch(Fe){const Ue=ll(Fe,"Request failed");me(Ue),alert(`Edit request failed: ${Ue}`)}finally{D(!1)}}async function it(){if(e){At(!0),Zt(null);try{const at=br(m),Ut=xr!=null&&xr.approval_until?String(xr.approval_until):m.markManagerApprovalUntil||null,Fe={...m,markManagerLocked:!0,markManagerSnapshot:at,markManagerApprovalUntil:Ut},Ue={sheet:Fe,selectedBtls:H};g(Fe),ut(null),await Fi(n,String(e),Ue),q(new Date().toLocaleString());try{await fh(n,String(e),t),Mt({silent:!0})}catch(Ct){console.warn("confirmMarkManagerLock failed",Ct)}}catch(at){Zt((at==null?void 0:at.message)||"Save failed")}finally{At(!1)}}}const bt=(at,Ut)=>{g(Fe=>{const Ue=Fe.rows.slice(),Ct=Ue[at]||{studentId:0,section:"",registerNo:"",name:"",total:""};return Ue[at]={...Ct,...Ut},{...Fe,rows:Ue}})},_t=()=>{const at=m.rows.map((Ut,Fe)=>{const Ue=typeof Ut.total=="number"?lo(Number(Ut.total),0,w):null,Ct=Ue==null?"":Vl(Ue),yt=Ue==null?null:Vl(Ue/2),mt=yt==null?null:lo(yt,0,j.co3),tr=yt==null?null:lo(yt,0,j.co4),lr=ur.map(an=>an-1),rn=[k.btl1,k.btl2,k.btl3,k.btl4,k.btl5,k.btl6].map((an,bn)=>lr.includes(bn)?s?A:an>0?an:Ap:an),Sn=Ue==null?null:lr.length?Vl(Ue/lr.length):0,Gr=rn.map((an,bn)=>Ue==null||!lr.includes(bn)?null:an>0?lo(Sn,0,an):Vl(Sn)),fn={sno:Fe+1,registerNo:Qb(Ut.registerNo),name:Ut.name,co3_mark:mt??"",co3_pct:yl(mt,j.co3),co4_mark:tr??"",co4_pct:yl(tr,j.co4),btl1_mark:Gr[0]??"",btl1_pct:yl(Gr[0],rn[0]),btl2_mark:Gr[1]??"",btl2_pct:yl(Gr[1],rn[1]),btl3_mark:Gr[2]??"",btl3_pct:yl(Gr[2],rn[2]),btl4_mark:Gr[3]??"",btl4_pct:yl(Gr[3],rn[3]),btl5_mark:Gr[4]??"",btl5_pct:yl(Gr[4],rn[4]),btl6_mark:Gr[5]??"",btl6_pct:yl(Gr[5],rn[5])};return fn[i]=Ct,fn});Kxe(`${e}_${RM(i)||"SSA2"}_sheet.csv`,at)},Tt=()=>{if(!m.rows.length)return;const at=Number.isFinite(Number(j.co3))?Number(j.co3):0,Ut=Number.isFinite(Number(j.co4))?Number(j.co4):0,Fe=["Register No","Student Name",`Q1 (${at.toFixed(2)})`,`Q2 (${Ut.toFixed(2)})`,"Status"],Ue=m.rows.map(mt=>[mt.registerNo,mt.name,"","","present"]),Ct=bs.aoa_to_sheet([Fe,...Ue]);Ct["!freeze"]={xSplit:0,ySplit:1};const gt=bs.book_new();bs.book_append_sheet(gt,Ct,i||"SSA2");const yt=`${e}_${RM(i)||"SSA2"}_template.xlsx`;uy(gt,yt)},Dt=async()=>{const at=m.rows.map((Ut,Fe)=>({sno:Fe+1,regNo:String(Ut.registerNo||""),name:String(Ut.name||""),total:Ut.total===""?"":Number(Ut.total)}));await fy({filenameBase:`${e}_${i}`,meta:{courseName:(h==null?void 0:h.courseName)||"",courseCode:(h==null?void 0:h.courseCode)||e,className:(h==null?void 0:h.className)||""},rows:at})};function Gt(at){return String(at??"").trim().toLowerCase().replace(/\s+/g," ")}const $t=()=>{var at;er||(at=R.current)==null||at.click()},ze=async at=>{var Ut;if(at){B(!0);try{const Fe=await at.arrayBuffer(),Ue=C0(Fe,{type:"array"}),Ct=(Ut=Ue.SheetNames)==null?void 0:Ut[0];if(!Ct)throw new Error("No sheet found in the Excel file.");const gt=Ue.Sheets[Ct],yt=bs.sheet_to_json(gt,{header:1});if(!yt.length)throw new Error("Excel sheet is empty.");const mt=(yt[0]||[]).map(Gt),tr=Se=>mt.findIndex(st=>Se(st)),lr=tr(Se=>Se==="register no"||Se==="reg no"||Se.includes("register")),Fr=tr(Se=>Se.startsWith("q1")),rn=tr(Se=>Se.startsWith("q2")),Sn=tr(Se=>Se==="total"||Se.includes("total")),Gr=tr(Se=>Se==="status"||Se.includes("status"));if(lr<0)throw new Error("Could not find Register No column.");const fn=Number.isFinite(Number(j.co3))?Number(j.co3):0,an=Number.isFinite(Number(j.co4))?Number(j.co4):0,bn=new Map;m.rows.forEach((Se,st)=>{const pt=String(Se.registerNo||"").trim();pt&&bn.set(pt,st);const Qe=Qb(pt);Qe&&bn.set(Qe,st)}),g(Se=>{const st=Se.rows.slice();for(let pt=1;pt<yt.length;pt++){const Qe=yt[pt]||[],vr=String(Qe[lr]??"").trim();if(!vr)continue;const tn=bn.get(vr);if(tn==null)continue;const xn=(Gr>=0?String(Qe[Gr]??""):"").trim().toLowerCase(),zn=xn==="absent"||xn==="ab"||xn==="a",Rn=Fr>=0?Yv(Qe[Fr]):null,xi=rn>=0?Yv(Qe[rn]):null,L=Sn>=0?Yv(Qe[Sn]):null,le=Rn==null?0:lo(Rn,0,fn),Oe=xi==null?0:lo(xi,0,an),rt=L??le+Oe,Et=zn?0:lo(rt,0,w);st[tn]={...st[tn],total:Vl(Et)}}return{...Se,rows:st}})}finally{B(!1)}}},Ze=async at=>{var Fe;const Ut=(Fe=at.target.files)==null?void 0:Fe[0];if(at.target.value="",!!Ut)try{await ze(Ut)}catch(Ue){alert((Ue==null?void 0:Ue.message)||"Failed to import Excel")}},jt={padding:"10px 12px",background:"linear-gradient(180deg, rgba(11,74,111,0.06), rgba(240,249,255,0.06))",color:"#0b4a6f",textAlign:"center",fontWeight:800,fontSize:12,borderBottom:"1px solid rgba(148,163,184,0.5)",borderRight:"1px solid rgba(226,232,240,0.8)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},Bt={padding:"10px 12px",fontSize:12,borderBottom:"1px solid rgba(226,232,240,0.9)",borderRight:"1px solid rgba(226,232,240,0.8)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},gr={width:"100%",padding:"8px 10px",borderRadius:10,border:"1px solid rgba(226,232,240,0.9)",outline:"none",background:"rgba(255,255,255,0.9)",fontSize:12,textAlign:"center"},dr={display:"inline-flex",alignItems:"center",gap:6,padding:"4px 8px",border:"1px solid #d1d5db",borderRadius:999,background:"#fff",cursor:"pointer",userSelect:"none",fontSize:11},Kt={border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"};return a.jsx(a.Fragment,{children:a.jsxs(X0,{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{onClick:gn,className:"obe-btn obe-btn-secondary",disabled:E,children:E?"Loading roster":"Load/Refresh Roster"}),a.jsx("button",{onClick:Nr,className:"obe-btn obe-btn-danger",disabled:!m.rows.length,children:"Reset Marks"}),a.jsx("button",{onClick:_t,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Export CSV"}),a.jsx("button",{onClick:Tt,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Export Excel"}),a.jsx("button",{onClick:$t,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length||er||M,children:M?"Importing":"Import Excel"}),a.jsx("input",{ref:R,type:"file",accept:".xlsx,.xls",style:{display:"none"},onChange:Ze})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:Dt,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Download"}),a.jsx("button",{onClick:tt,className:"obe-btn obe-btn-success",disabled:de||er,title:er?"Table locked  confirm Mark Manager to enable actions":void 0,children:de?"Saving":"Save Draft"}),a.jsx("button",{onClick:Wt,className:"obe-btn obe-btn-primary",disabled:zt?Re:V||!ht||er,title:er?"Table locked  confirm Mark Manager to enable actions":void 0,children:zt?Re?"Request Pending":"Request Edit":V?"Publishing":"Publish"})]})]}),Ye?a.jsx("div",{style:{marginTop:8,padding:8,background:"#ecfdf5",border:"1px solid #bbf7d0",borderRadius:8,color:"#065f46",fontWeight:700},children:"Name list locked"}):null,a.jsx("div",{style:{marginTop:10,fontSize:12,color:ht?"#065f46":"#b91c1c"},children:ke?"Checking publish due time":ce||(be!=null&&be.due_at?a.jsxs(a.Fragment,{children:["Due: ",new Date(be.due_at).toLocaleString(),"  Remaining: ",sg(we),be.allowed_by_approval&&be.approval_until?a.jsxs(a.Fragment,{children:["  Approved until ",new Date(be.approval_until).toLocaleString()]}):null]}):"Due time not set by IQAC.")}),Ur?a.jsxs("div",{style:{marginTop:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),a.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:a.jsx("button",{className:"obe-btn",onClick:()=>nt(),disabled:ke,children:"Refresh"})})]}):ht?null:a.jsxs("div",{style:{marginTop:10,border:"1px solid #fecaca",background:"#fff7ed",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publish time is over"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:"Send a request to IQAC to approve publishing."}),a.jsx("textarea",{value:qr,onChange:at=>cn(at.target.value),placeholder:"Reason (optional)",rows:3,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:[a.jsx("button",{className:"obe-btn",onClick:()=>nt(),disabled:Pn||ke,children:"Refresh"}),a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:pr,disabled:Pn,children:Pn?"Requesting":"Request Approval"})]}),mn?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:mn}):null]}),(U||ee)&&a.jsx("div",{style:{marginTop:10,color:"#b91c1c",fontSize:13},children:U||ee}),a.jsxs("div",{style:{marginTop:10,display:"flex",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{style:Kt,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Term"}),a.jsx("div",{style:{fontWeight:700},children:m.termLabel||""})]}),a.jsxs("div",{style:Kt,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Batch"}),a.jsx("div",{style:{fontWeight:700},children:m.batchLabel||""})]}),a.jsxs("div",{style:Kt,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Saved"}),a.jsx("div",{style:{fontWeight:700},children:Y||""}),O?a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["by ",a.jsx("span",{style:{color:"#0369a1",fontWeight:700},children:O})]}):null]}),a.jsxs("div",{style:Kt,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Published"}),a.jsx("div",{style:{fontWeight:700},children:Q||""})]})]}),a.jsxs("div",{style:{marginTop:12,...Kt},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("div",{style:{fontWeight:800},children:"Mark Manager"}),a.jsx("div",{children:a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>{const at=m.markManagerSnapshot!=null;ut({mode:at?"request":"confirm"})},disabled:!e||wt,children:m.markManagerSnapshot?"Edit":"Save"})})]}),a.jsxs("div",{style:{marginTop:8,fontSize:13,color:"#6b7280"},children:[a.jsxs("div",{children:["Max ",i,": ",a.jsx("strong",{style:{color:"#111"},children:w})]}),a.jsxs("div",{children:["CO-3 max: ",a.jsx("strong",{style:{color:"#111"},children:j.co3}),"  CO-4 max: ",a.jsx("strong",{style:{color:"#111"},children:j.co4})]}),a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Selected BTLs:"}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[1,2,3,4,5,6].map(at=>{const Ut=H.includes(at),Fe=!!(J&&m.markManagerSnapshot!=null);return a.jsxs("div",{onClick:()=>{if(Ur||wt)return;const Ue=m.markManagerSnapshot!=null;J&&Ue||oe(Ct=>Ct.includes(at)?Ct.filter(gt=>gt!==at):Ct.concat(at).sort((gt,yt)=>gt-yt))},style:{...dr,borderColor:Ut?"#16a34a":"#cbd5e1",background:Ut?"#ecfdf5":"#fff",cursor:Fe||wt?"not-allowed":"pointer",opacity:Fe?.6:1,padding:"6px 8px"},"aria-disabled":Fe||wt,children:[a.jsx("input",{type:"checkbox",checked:Ut,readOnly:!0,style:{marginRight:6}}),a.jsxs("span",{style:{fontWeight:800},children:["BTL",at]})]},`card_btl_${at}`)})})]})]}),sr?a.jsx("div",{style:{marginTop:8,color:"#991b1b"},children:sr}):null]}),a.jsx("div",{style:{marginTop:14},children:yr?a.jsxs("div",{style:{position:"relative"},children:[a.jsx("div",{className:"obe-table-wrapper",style:{overflowX:"auto"},children:a.jsx(og,{locked:!!(Ur||De||ue&&Lt),title:Ur?"Locked by IQAC":De?"Published  Locked":"Table Locked",subtitle:Ur?"Publishing is turned OFF globally for this assessment.":De?"Marks are published. Request IQAC approval to edit.":"Confirm the Mark Manager",children:a.jsxs("table",{className:"ssa-modern-table",style:{borderCollapse:"separate",borderSpacing:0,width:"100%",minWidth:920},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:jt,colSpan:en,children:[m.termLabel," | ",m.batchLabel," | ",i]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...jt,width:42,minWidth:42},rowSpan:4,children:"S.No"}),a.jsx("th",{style:jt,rowSpan:4,children:"Register No."}),a.jsx("th",{style:jt,rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:jt,children:i}),null,a.jsx("th",{style:jt,colSpan:4,children:"CO ATTAINMENT"}),ur.length?a.jsx("th",{style:jt,colSpan:ur.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[a.jsxs("th",{style:jt,children:[a.jsx("div",{style:{fontWeight:800},children:"COs"}),a.jsx("div",{style:{fontSize:12},children:"3,4"})]}),null,a.jsx("th",{style:jt,colSpan:2,children:"CO-3"}),a.jsx("th",{style:jt,colSpan:2,children:"CO-4"}),ur.map(at=>a.jsxs("th",{style:jt,colSpan:2,children:["BTL-",at]},`btl-head-${at}`))]}),a.jsxs("tr",{children:[a.jsxs("th",{style:jt,children:[a.jsx("div",{style:{fontWeight:800},children:"BTL"}),a.jsx("div",{style:{fontSize:12},children:ur.length?ur.join(","):"-"})]}),null,Array.from({length:2+ur.length}).flatMap((at,Ut)=>a.jsxs(sn.Fragment,{children:[a.jsx("th",{style:jt,children:"Mark"}),a.jsx("th",{style:jt,children:"%"})]},Ut))]}),a.jsxs("tr",{children:[a.jsx("th",{style:jt,children:"Name / Max Marks"}),a.jsx("th",{style:jt,children:w}),null,a.jsx("th",{style:jt,children:j.co3}),a.jsx("th",{style:jt,children:"%"}),a.jsx("th",{style:jt,children:j.co4}),a.jsx("th",{style:jt,children:"%"}),ur.flatMap(at=>[a.jsx("th",{style:jt,children:String(s?A:Math.max(Number(k[`btl${at}`]??0)||0,Ap))},`btl-max-${at}`),a.jsx("th",{style:jt,children:"%"},`btl-pct-${at}`)])]})]}),a.jsx("tbody",{children:m.rows.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:en,style:{padding:14,color:"#6b7280",fontSize:13},children:"No students loaded yet. Choose a Teaching Assignment above, then click Load/Refresh Roster."})}):er&&!De?a.jsx("tr",{children:a.jsx("td",{colSpan:en,style:{padding:20,textAlign:"center",color:"#065f46",fontWeight:900},children:"Table locked  confirm the Mark Manager to enable student marks"})}):m.rows.map((at,Ut)=>{const Fe=typeof at.total=="number"?lo(Number(at.total),0,w):null,Ue=Fe==null?null:Vl(Fe/2),Ct=Ue==null?null:lo(Ue,0,j.co3),gt=Ue==null?null:lo(Ue,0,j.co4),yt=ur.map(rn=>rn-1),tr=[k.btl1,k.btl2,k.btl3,k.btl4,k.btl5,k.btl6].map((rn,Sn)=>yt.includes(Sn)?s?A:rn>0?rn:Ap:rn),lr=Fe==null?null:yt.length?Vl(Fe/yt.length):0,Fr=tr.map((rn,Sn)=>Fe==null||!yt.includes(Sn)?null:rn>0?lo(lr,0,rn):Vl(lr));return a.jsxs("tr",{style:{background:Ut%2===1?"#f8fafc":"#fff"},children:[a.jsx("td",{style:{...Bt,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Ut+1}),a.jsx("td",{style:Bt,children:Qb(at.registerNo)}),a.jsx("td",{style:Bt,children:at.name}),a.jsx("td",{style:{...Bt,width:90,background:"#fff7ed"},children:Br?a.jsx("div",{style:gr,children:typeof at.total=="number"?Vl(at.total):""}):a.jsx("input",{style:gr,type:"number",value:at.total,min:0,max:w,onChange:rn=>{if(Br)return;const Sn=rn.target.value;if(Sn==="")return bt(Ut,{total:""});const Gr=Number(Sn);if(!Number.isFinite(Gr))return bt(Ut,{total:""});if(Gr>w){rn.currentTarget.setCustomValidity(`Max mark is ${w}`),rn.currentTarget.reportValidity(),window.setTimeout(()=>rn.currentTarget.setCustomValidity(""),0);return}rn.currentTarget.setCustomValidity("");const fn=lo(Gr,0,w);bt(Ut,{total:fn})}})}),null,a.jsx("td",{style:{...Bt,textAlign:"center"},children:Ct??""}),a.jsx("td",{style:{...Bt,textAlign:"center"},children:yl(Ct,j.co3)}),a.jsx("td",{style:{...Bt,textAlign:"center"},children:gt??""}),a.jsx("td",{style:{...Bt,textAlign:"center"},children:yl(gt,j.co4)}),ur.map(rn=>{const Sn=rn-1,Gr=Fr[Sn],fn=tr[Sn];return a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...Bt,textAlign:"center"},children:Gr??""}),a.jsx("td",{style:{...Bt,textAlign:"center"},children:yl(Gr,fn)})]},rn)})]},String(at.studentId||Ut))})})]})})}),cr&&yr?a.jsxs("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:40,width:360,background:"#fff",border:"1px solid #e5e7eb",padding:10,borderRadius:12,display:"flex",flexDirection:"column",gap:8,alignItems:"center",boxShadow:"0 6px 18px rgba(17,24,39,0.06)"},children:[a.jsx("div",{style:{textAlign:"center"},children:De?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontWeight:900,color:"#065f46"},children:"Published"}),a.jsx("div",{style:{fontSize:13,color:"#065f46"},children:"Marks are locked. Request IQAC approval to edit."})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontWeight:900,color:"#065f46"},children:"Table Locked"}),a.jsx("div",{style:{fontSize:13,color:"#065f46"},children:"Confirm the Mark Manager"})]})}),a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center"},children:[a.jsx("button",{className:"obe-btn",onClick:()=>je(!0),children:"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:Re,onClick:vt,children:Re?"Request Pending":"Request Edit"})]})]}):null]}):a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:20,background:"#fff"},children:a.jsxs("div",{style:{display:"grid",placeItems:"center",padding:40},children:[a.jsx("div",{style:{fontWeight:800,fontSize:16,marginTop:8},children:De?"Published  Locked":"Table Locked"}),a.jsx("div",{style:{color:"#6b7280",marginTop:6},children:De?"Marks published. Use View to inspect or Request Edit to ask IQAC for edit access.":"Confirm the Mark Manager to unlock the student list."}),a.jsx("div",{style:{display:"flex",gap:8,marginTop:12},children:De?a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn",onClick:()=>je(!0),children:"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:Re,onClick:vt,children:Re?"Request Pending":"Request Edit"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>ut({mode:"confirm"}),disabled:!e||wt,children:"Save Mark Manager"}),a.jsx("button",{className:"obe-btn",onClick:()=>Je(),disabled:wt,children:"Request Access"})]})})]})})}),Te?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:70},onClick:()=>je(!1),children:a.jsxs("div",{style:{width:"min(1100px, 96vw)",maxHeight:"min(80vh, 900px)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:0,display:"flex",flexDirection:"column"},onClick:at=>at.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"12px 14px",borderBottom:"1px solid #eef2f7"},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Only"}),a.jsx("button",{onClick:at=>{at.stopPropagation(),je(!1)},"aria-label":"Close",style:{marginLeft:"auto",border:"none",background:"transparent",fontSize:20,lineHeight:1,cursor:"pointer"},children:""})]}),a.jsxs("div",{style:{padding:14},children:[He?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading published marks"}):null,Pt?a.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:Pt}):null]}),a.jsx("div",{ref:Dr,style:{overflow:"auto",borderTop:"1px solid #e5e7eb",borderBottom:"1px solid #e5e7eb",borderLeft:"1px solid #e5e7eb",borderRight:"1px solid #e5e7eb",borderRadius:0,maxHeight:"60vh",background:"#fff"},children:a.jsxs("table",{className:"ssa-modern-table",style:{borderCollapse:"separate",borderSpacing:0,width:"100%",minWidth:920},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:jt,colSpan:en,children:[m.termLabel," | ",m.batchLabel," | ",i]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...jt,width:42,minWidth:42},rowSpan:4,children:"S.No"}),a.jsx("th",{style:jt,rowSpan:4,children:"Register No."}),a.jsx("th",{style:jt,rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:jt,children:i}),null,a.jsx("th",{style:jt,colSpan:4,children:"CO ATTAINMENT"}),ur.length?a.jsx("th",{style:jt,colSpan:ur.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[a.jsxs("th",{style:jt,children:[a.jsx("div",{style:{fontWeight:800},children:"COs"}),a.jsx("div",{style:{fontSize:12},children:"3,4"})]}),null,a.jsx("th",{style:jt,colSpan:2,children:"CO-3"}),a.jsx("th",{style:jt,colSpan:2,children:"CO-4"}),ur.map(at=>a.jsxs("th",{style:jt,colSpan:2,children:["BTL-",at]},`btl-head-${at}`))]}),a.jsxs("tr",{children:[a.jsxs("th",{style:jt,children:[a.jsx("div",{style:{fontWeight:800},children:"BTL"}),a.jsx("div",{style:{fontSize:12},children:ur.length?ur.join(","):"-"})]}),null,Array.from({length:2+ur.length}).flatMap((at,Ut)=>a.jsxs(sn.Fragment,{children:[a.jsx("th",{style:jt,children:"Mark"}),a.jsx("th",{style:jt,children:"%"})]},Ut))]}),a.jsxs("tr",{children:[a.jsx("th",{style:jt,children:"Name / Max Marks"}),a.jsx("th",{style:jt,children:w}),null,a.jsx("th",{style:jt,children:j.co3}),a.jsx("th",{style:jt,children:"%"}),a.jsx("th",{style:jt,children:j.co4}),a.jsx("th",{style:jt,children:"%"}),ur.flatMap(at=>[a.jsx("th",{style:jt,children:String(s?A:Math.max(Number(k[`btl${at}`]??0)||0,Ap))},`btl-max-${at}`),a.jsx("th",{style:jt,children:"%"},`btl-pct-${at}`)])]})]}),a.jsx("tbody",{children:m.rows.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:en,style:{padding:14,color:"#6b7280",fontSize:13},children:"No students loaded yet. Choose a Teaching Assignment above, then click Load/Refresh Roster."})}):m.rows.map((at,Ut)=>{var Gr;const Fe=((Gr=Le==null?void 0:Le.marks)==null?void 0:Gr[String(at.studentId)])??null,Ue=Fe==null||Fe===""?null:lo(Number(Fe),0,w),gt=Ue==null?null:Vl(Ue/2),yt=gt==null?null:lo(gt,0,j.co3),mt=gt==null?null:lo(gt,0,j.co4),tr=ur.map(fn=>fn-1),Fr=[k.btl1,k.btl2,k.btl3,k.btl4,k.btl5,k.btl6].map((fn,an)=>tr.includes(an)?s?A:fn>0?fn:Ap:fn),rn=Ue==null?null:tr.length?Vl(Ue/tr.length):0,Sn=Fr.map((fn,an)=>Ue==null||!tr.includes(an)?null:fn>0?lo(rn,0,fn):Vl(rn));return a.jsxs("tr",{style:{background:Ut%2===1?"#f8fafc":"#fff"},children:[a.jsx("td",{style:{...Bt,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Ut+1}),a.jsx("td",{style:Bt,children:Qb(at.registerNo)}),a.jsx("td",{style:Bt,children:at.name}),a.jsx("td",{style:{...Bt,width:90,background:"#fff7ed",textAlign:"center"},children:Ue==null?"":Vl(Ue)}),null,a.jsx("td",{style:{...Bt,textAlign:"center"},children:yt??""}),a.jsx("td",{style:{...Bt,textAlign:"center"},children:yl(yt,j.co3)}),a.jsx("td",{style:{...Bt,textAlign:"center"},children:mt??""}),a.jsx("td",{style:{...Bt,textAlign:"center"},children:yl(mt,j.co4)}),ur.map(fn=>{const an=fn-1,bn=Sn[an],Se=Fr[an];return a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...Bt,textAlign:"center"},children:bn??""}),a.jsx("td",{style:{...Bt,textAlign:"center"},children:yl(bn,Se)})]},fn)})]},String(at.studentId||Ut))})})]})}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{className:"obe-btn",onClick:()=>je(!1),children:"Close"})})]})})}):null,qe?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:9999},onClick:()=>{wt||ut(null)},children:a.jsxs("div",{style:{width:"min(640px,96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:at=>at.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:qe.mode==="confirm"?`Confirmation - ${i}`:`Request Edit - ${i}`}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:i})]}),qe.mode==="confirm"?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"Confirm the selected settings. After confirming, Mark Manager will be applied and table will be editable."}),a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Item"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Value"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:["Max ",i]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:w})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"CO-3 max"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:j.co3})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"CO-4 max"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:j.co4})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"Selected BTLs"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",flexWrap:"wrap"},children:[1,2,3,4,5,6].map(at=>{const Ut=H.includes(at);return a.jsxs("div",{onClick:()=>{wt||oe(Fe=>Fe.includes(at)?Fe.filter(Ue=>Ue!==at):[...Fe,at].sort((Ue,Ct)=>Ue-Ct))},style:{...dr,borderColor:Ut?"#16a34a":"#cbd5e1",background:Ut?"#ecfdf5":"#fff",cursor:wt?"not-allowed":"pointer",padding:"6px 8px"},children:[a.jsx("input",{type:"checkbox",checked:Ut,readOnly:!0,style:{marginRight:6}}),a.jsxs("span",{style:{fontWeight:800},children:["BTL",at]})]},`modal_btl_${at}`)})})})]})]})]})})]}):a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. Mark Manager will remain locked until IQAC approves."}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[a.jsx("button",{className:"obe-btn",disabled:wt,onClick:()=>ut(null),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:wt||!e,onClick:async()=>{if(e){if(qe.mode==="request"){ut(null),await Je();return}await it()}},children:qe.mode==="confirm"?"Confirm":"Send Request"})]})]})})}):null,ne?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>{ie||re(!1)},children:a.jsxs("div",{style:{width:"min(560px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:at=>at.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:i})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",xt?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{fontSize:13,color:"#374151",marginBottom:10,lineHeight:1.35},children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Subject:"})," ",String(e||"")]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Published:"})," ",Q||""]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Saved:"})," ",Y||""]})]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:T,onChange:at=>I(at.target.value),placeholder:"Explain why you need to edit (required)",rows:4,className:"obe-input",style:{resize:"vertical"}})]}),Z?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#b91c1c"},children:Z}):null,a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[a.jsx("button",{type:"button",className:"obe-btn",disabled:ie,onClick:()=>re(!1),children:"Cancel"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-primary",disabled:ie||Re||!e||!String(T||"").trim(),onClick:async()=>{await Ht()},children:ie?"Requesting":Re?"Request Pending":"Send Request"})]})]})})}):null,a.jsx("style",{children:`
        /* SSA table modern look (UI-only) */
        .ssa-modern-table th:last-child,
        .ssa-modern-table td:last-child {
          border-right: none;
        }
        .ssa-modern-table tbody tr:nth-child(even) td {
          background: #fbfdff;
        }
        .ssa-modern-table tbody tr:hover td {
          background: rgba(2, 132, 199, 0.03);
        }
      `}),a.jsx("div",{style:{marginTop:14},children:yr?a.jsx("div",{className:"obe-table-wrapper",style:{overflowX:"auto"}}):null})]})})}function Xxe({subjectId:e,teachingAssignmentId:t,label:r}){return a.jsx(Yz,{subjectId:e,teachingAssignmentId:t,assessmentKey:"ssa2",label:r||"SSA2"})}const Jb=[{key:"q1",max:2},{key:"q2",max:2},{key:"q3",max:2},{key:"q4",max:2},{key:"q5",max:2},{key:"q6",max:2},{key:"q7",max:2},{key:"q8",max:2},{key:"q9",max:2},{key:"q10",max:2},{key:"q11",max:14},{key:"q12",max:14},{key:"q13",max:14},{key:"q14",max:14},{key:"q15",max:14},{key:"q16",max:10}],FM=[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5,5];function jd(e,t,r){return Math.max(t,Math.min(r,e))}function Qxe(e){const t=Array.isArray(e)?e:[];return new Set(t.map(r=>String(r||"").trim().toLowerCase()).filter(Boolean))}function BM(e,t){if(Array.isArray(e)){const r=e.slice(0,t).map(n=>typeof n=="number"&&Number.isFinite(n)?n:"");for(;r.length<t;)r.push("");return r}return new Array(t).fill("")}function IM(e){const t=(e||[]).filter(r=>typeof r=="number"&&Number.isFinite(r));return t.length?t.reduce((r,n)=>r+n,0)/t.length:null}function Es(e){return Math.round(e*100)/100}function Jxe(e,t){const r=String(t||"").toLowerCase();return r==="ssa"?"SSA":r==="cia"?"CIA":r==="fa"?"FA":r==="review"?"REVIEW":r==="me"?"ME":r==="lab1"?"LAB1":r==="lab2"?"LAB2":String(t||"").toUpperCase()}function nu(e){if(e===""||e==null)return null;const t=Number(e);return Number.isFinite(t)?t:null}function Zxe(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const o=r.localeCompare(n);if(o)return o}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim();return i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}function DM(e){if(e==="1&2"||e==="both")return"1&2";if(typeof e=="string"){const n=e.trim().toUpperCase().replace(/\s+/g,""),i=n.includes("1"),s=n.includes("2");if(i&&s||n==="1&2"||n==="1,2"||n==="1/2"||n==="2/1"||n==="CO1&CO2"||n==="CO1,CO2"||n==="CO1/CO2"||n==="CO2/CO1")return"1&2";if(n==="CO2"||n==="2")return 2;if(n==="CO1"||n==="1")return 1}if(Array.isArray(e)){const r=e.map(n=>{if(typeof n=="string"){const i=n.match(/\d+/);return Number(i?i[0]:n)}return Number(n)}).filter(n=>Number.isFinite(n));if(r.includes(1)&&r.includes(2))return"1&2";if(r.includes(2))return 2;if(r.includes(1))return 1}const t=Number(typeof e=="string"?(e.match(/\d+/)||[])[0]:e);return t===2?2:t===12?"1&2":1}function $M(e){if(e==="3&4"||e==="both")return"3&4";if(typeof e=="string"){const n=e.trim().toUpperCase().replace(/\s+/g,""),i=n.includes("3"),s=n.includes("4");if(i&&s)return"3&4";if(s)return 4;if(i)return 3;if(n==="3&4"||n==="3,4"||n==="3/4"||n==="4/3"||n==="CO3&CO4"||n==="CO3,CO4"||n==="CO3/CO4"||n==="CO4/CO3")return"3&4";if(n==="CO4"||n==="4")return 4;if(n==="CO3"||n==="3")return 3}if(Array.isArray(e)){const r=e.map(n=>{if(typeof n=="string"){const i=n.match(/\d+/);return Number(i?i[0]:n)}return Number(n)}).filter(n=>Number.isFinite(n));if(r.includes(3)&&r.includes(4))return"3&4";if(r.includes(4))return 4;if(r.includes(3))return 3}const t=Number(typeof e=="string"?(e.match(/\d+/)||[])[0]:e);return t===4?4:t===3?3:t===34?"3&4":3}function e1e(e,t){const r=e[t];if(!r)return{co1:0,co2:0};const n=DM(r.co);if(n==="1&2")return{co1:.5,co2:.5};const i=e.some(u=>DM(u==null?void 0:u.co)==="1&2"),s=t===e.length-1,o=String((r==null?void 0:r.key)||"").toLowerCase(),l=String((r==null?void 0:r.label)||"").toLowerCase(),c=o==="q9"||l.includes("q9");return!i&&s&&c?{co1:.5,co2:.5}:n===2?{co1:0,co2:1}:{co1:1,co2:0}}function t1e(e,t){const r=e[t];if(!r)return{co3:0,co4:0};const n=$M(r.co);if(n==="3&4")return{co3:.5,co4:.5};const i=e.some(u=>$M(u==null?void 0:u.co)==="3&4"),s=t===e.length-1,o=String((r==null?void 0:r.key)||"").toLowerCase(),l=String((r==null?void 0:r.label)||"").toLowerCase(),c=o==="q9"||l.includes("q9");return!i&&s&&c?{co3:.5,co4:.5}:n===4?{co3:0,co4:1}:{co3:1,co4:0}}function r1e({subjectId:e,teachingAssignmentId:t,classType:r,enabledAssessments:n,assessmentType:i,cos:s,cqiDivider:o,cqiMultiplier:l}){var O,X;const[c,u]=x.useState([]),[d,f]=x.useState(!1),[h,p]=x.useState(null),[m,g]=x.useState({}),[y,b]=x.useState({}),[v,w]=x.useState({}),[S,j]=x.useState(null),[k,A]=x.useState(null),R=58,M=x.useMemo(()=>{const F=Number(o);if(Number.isFinite(F)&&F>0)return F;const Q=Number(k==null?void 0:k.divider);return Number.isFinite(Q)&&Q>0?Q:2},[o,k]),B=x.useMemo(()=>{const F=Number(l);if(Number.isFinite(F)&&F>=0)return F;const Q=Number(k==null?void 0:k.multiplier);return Number.isFinite(Q)&&Q>=0?Q:.15},[l,k]),[E,P]=x.useState(!0),[U,G]=x.useState(!0),[H,oe]=x.useState(null),[de,W]=x.useState(!0),[V,ae]=x.useState(!1);x.useEffect(()=>{let F=!0;return(async()=>{try{const Q=await wS();if(!F)return;const K=Number(Q==null?void 0:Q.divider),ne=Number(Q==null?void 0:Q.multiplier);A({options:Array.isArray(Q==null?void 0:Q.options)?Q.options:[],divider:Number.isFinite(K)?K:2,multiplier:Number.isFinite(ne)?ne:.15})}catch{F&&A(null)}})(),()=>{F=!1}},[]);const ee=x.useMemo(()=>!s||!Array.isArray(s)?[]:s.map(F=>{const Q=F.match(/\d+/);return Q?parseInt(Q[0]):null}).filter(F=>F!==null).sort((F,Q)=>F-Q),[s]),C=x.useMemo(()=>{const F={};return ee.forEach(Q=>{const K=`co${Q}`;let ne=null;Object.values(m).forEach(re=>{const T=re&&re[K];if(T&&typeof T.max=="number"){const I=T.max;(ne==null||I>ne)&&(ne=I)}}),F[Q]=ne}),F},[m,ee]);x.useEffect(()=>{let F=!0;return(async()=>{try{const Q=await oc();if(!F)return;j(Q||null)}catch{}})(),()=>{F=!1}},[e]),x.useEffect(()=>{if(!t)return;let F=!0;return f(!0),p(null),(async()=>{try{const Q=await pc(t);if(!F)return;const K=(Q.students||[]).map(ne=>({id:Number(ne.id),reg_no:String(ne.reg_no??""),name:String(ne.name??""),section:ne.section??null})).filter(ne=>Number.isFinite(ne.id)).sort(Zxe);u(K)}catch(Q){if(!F)return;p((Q==null?void 0:Q.message)||"Failed to load roster")}finally{F&&f(!1)}})(),()=>{F=!1}},[t]),x.useEffect(()=>{if(!e||!t)return;const F=`cqi_entries_${e}_${t}`,Q=Zn(F);Q&&typeof Q=="object"&&(b(Q),ae(!1)),(async()=>{try{const K=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",ne=await mr(`/api/obe/cqi-draft/${encodeURIComponent(String(e))}${K}`,{method:"GET"}).catch(()=>null);if(ne&&ne.ok){const re=await ne.json().catch(()=>null);re!=null&&re.draft&&(b(re.draft.entries||re.draft||{}),oe({updated_at:re.updated_at||null,updated_by:re.updated_by||null}),ae(!1))}}catch{}})()},[e,t]),x.useEffect(()=>{if(!e||!t||c.length===0||ee.length===0)return;let F=!0;return(async()=>{var Q,K,ne,re,T,I,ie,D,Z,me,Te,je,Le,_e,He,We,Pt,dt,Ye,lt,be,ke,ce,we,ht,nt;try{f(!0);const Ie=ni(r),It=Qxe(n),ct=Ie==="SPECIAL"&&It.size,Mt=nr=>ct?It.has(String(nr).toLowerCase()):!0,xr=Ie==="TCPR",Pr=Ie==="TCPL",Nt=Ie==="LAB"||Ie==="PRACTICAL",Ur=!Nt&&Ie!=="SPECIAL"&&ee.some(nr=>nr>=1&&nr<=5),qr=(()=>{if(!Ur)return null;const nr=String(t??"none"),Tr=[];Ie==="THEORY"?(Tr.push(`model_theory_sheet_${e}_${nr}`),Tr.push(`model_theory_sheet_${e}_none`)):Ie==="TCPL"?(Tr.push(`model_tcpl_sheet_${e}_${nr}`),Tr.push(`model_tcpl_sheet_${e}_none`)):Ie==="TCPR"&&(Tr.push(`model_tcpr_sheet_${e}_${nr}`),Tr.push(`model_tcpr_sheet_${e}_none`)),Tr.push(`model_sheet_${e}`);for(const Dr of Tr){const Rr=Zn(Dr);if(Rr&&typeof Rr=="object")return Rr}return null})(),cn=(()=>{const nr={co1:0,co2:0,co3:0,co4:0,co5:0};for(let Tr=0;Tr<Jb.length;Tr++){const Dr=Jb[Tr],Rr=FM[Tr];Rr===1?nr.co1+=Dr.max:Rr===2?nr.co2+=Dr.max:Rr===3?nr.co3+=Dr.max:Rr===4?nr.co4+=Dr.max:Rr===5&&(nr.co5+=Dr.max)}return nr})(),Pn=nr=>{if(!qr)return null;const Tr=`id:${String(nr.id)}`,Dr=nr.reg_no?`reg:${String(nr.reg_no).trim()}`:"",Rr=qr[Tr]||(Dr?qr[Dr]:null)||null;if(!Rr||typeof Rr!="object")return null;const tt=!!Rr.absent,Xe=String(Rr.absentKind||"AL").toUpperCase();if(tt&&Xe==="AL")return null;const ot=Rr.q&&typeof Rr.q=="object"?Rr.q:Rr;let Wt=!1;const pr={co1:0,co2:0,co3:0,co4:0,co5:0};for(let br=0;br<Jb.length;br++){const Je=Jb[br],Ht=nu(ot[Je.key]);if(Ht==null)continue;Wt=!0;const it=FM[br];it===1?pr.co1+=Ht:it===2?pr.co2+=Ht:it===3?pr.co3+=Ht:it===4?pr.co4+=Ht:it===5&&(pr.co5+=Ht)}if(!Wt)return null;const Nr=(br,Je,Ht)=>!Je||!Number.isFinite(Je)||Je<=0?0:jd(jd(br,0,Je)/Je*Ht,0,Ht);return{co1:Nr(pr.co1,cn.co1,2),co2:Nr(pr.co2,cn.co2,2),co3:Nr(pr.co3,cn.co3,2),co4:Nr(pr.co4,cn.co4,2),co5:Nr(pr.co5,cn.co5,4)}},Lr=ee.some(nr=>nr===1||nr===2),mn=ee.some(nr=>nr===3||nr===4),Me=ee.some(nr=>nr===5),[qe,ut,wt,At,sr,Zt,Cr,se,ue,J,pe,xe,Ne]=await Promise.all([Lr&&Mt("ssa1")&&!Nt?ag(e,t).catch(()=>({marks:{}})):{marks:{}},mn&&Mt("ssa2")&&!Nt?ey(e,t).catch(()=>({marks:{}})):{marks:{}},Lr&&Mt("formative1")&&!Nt&&!xr&&!Pr?kS(e,t).catch(()=>({marks:{}})):{marks:{}},mn&&Mt("formative2")&&!Nt&&!xr&&!Pr?v0("formative2",e,t).catch(()=>({marks:{}})):{marks:{}},Lr&&Mt("cia1")&&!Nt?ty(e,t).catch(()=>({data:null})):{data:null},mn&&Mt("cia2")&&!Nt?w0("cia2",e,t).catch(()=>({data:null})):{data:null},Lr&&Mt("review1")&&xr?_S(e).catch(()=>({marks:{}})):{marks:{}},mn&&Mt("review2")&&xr?jS(e).catch(()=>({marks:{}})):{marks:{}},Lr&&Mt("formative1")&&Pr?(async()=>{try{const nr=await ri("formative1",e,t);if(nr!=null&&nr.draft)return{data:nr.draft.data??nr.draft}}catch{}return Ys("formative1",e,t).catch(()=>({data:null}))})():{data:null},mn&&Mt("formative2")&&Pr?(async()=>{try{const nr=await ri("formative2",e,t);if(nr!=null&&nr.draft)return{data:nr.draft.data??nr.draft}}catch{}return Ys("formative2",e,t).catch(()=>({data:null}))})():{data:null},Lr&&Mt("cia1")&&Nt?(async()=>{try{const nr=await ri("cia1",e,t);if(nr!=null&&nr.draft)return{data:nr.draft.data??nr.draft}}catch{}return Ys("cia1",e,t).catch(()=>({data:null}))})():{data:null},mn&&Mt("cia2")&&Nt?(async()=>{try{const nr=await ri("cia2",e,t);if(nr!=null&&nr.draft)return{data:nr.draft.data??nr.draft}}catch{}return Ys("cia2",e,t).catch(()=>({data:null}))})():{data:null},Me&&Mt("model")&&Nt?(async()=>{try{const nr=await ri("model",e,t);if(nr!=null&&nr.draft)return{data:nr.draft.data??nr.draft}}catch{}return Im(e,t).catch(()=>({data:null}))})():{data:null}]);if(!F)return;const St={ssa:1.5,cia:3,fa:2.5},Ve={ssa:St.ssa,cia:St.cia,fa:St.fa},De=((Q=S==null?void 0:S.assessments)==null?void 0:Q.ssa1)||{},Re=((K=S==null?void 0:S.assessments)==null?void 0:K.ssa2)||{},xt=((ne=S==null?void 0:S.assessments)==null?void 0:ne.formative1)||{},Vt=((re=S==null?void 0:S.assessments)==null?void 0:re.formative2)||{},qt=((T=S==null?void 0:S.assessments)==null?void 0:T.cia1)||{},zt=((I=S==null?void 0:S.assessments)==null?void 0:I.cia2)||{},vt=((ie=S==null?void 0:S.assessments)==null?void 0:ie.review1)||{},Lt=((D=S==null?void 0:S.assessments)==null?void 0:D.review2)||{},er={ssa1:{co1:Number((Z=De==null?void 0:De.coMax)==null?void 0:Z.co1)||10,co2:Number((me=De==null?void 0:De.coMax)==null?void 0:me.co2)||10},ssa2:{co3:Number(((Te=Re==null?void 0:Re.coMax)==null?void 0:Te.co3)??((je=Re==null?void 0:Re.coMax)==null?void 0:je.co1))||10,co4:Number(((Le=Re==null?void 0:Re.coMax)==null?void 0:Le.co4)??((_e=Re==null?void 0:Re.coMax)==null?void 0:_e.co2))||10},cia1:{co1:Number((He=qt==null?void 0:qt.coMax)==null?void 0:He.co1)||30,co2:Number((We=qt==null?void 0:qt.coMax)==null?void 0:We.co2)||30},cia2:{co3:Number(((Pt=zt==null?void 0:zt.coMax)==null?void 0:Pt.co3)??((dt=zt==null?void 0:zt.coMax)==null?void 0:dt.co1))||30,co4:Number(((Ye=zt==null?void 0:zt.coMax)==null?void 0:Ye.co4)??((lt=zt==null?void 0:zt.coMax)==null?void 0:lt.co2))||30},f1:{co1:Number(xt==null?void 0:xt.maxCo)||10,co2:Number(xt==null?void 0:xt.maxCo)||10},f2:{co3:Number(Vt==null?void 0:Vt.maxCo)||10,co4:Number(Vt==null?void 0:Vt.maxCo)||10},review1:{co1:Number((be=vt==null?void 0:vt.coMax)==null?void 0:be.co1)||15,co2:Number((ke=vt==null?void 0:vt.coMax)==null?void 0:ke.co2)||15},review2:{co3:Number(((ce=Lt==null?void 0:Lt.coMax)==null?void 0:ce.co3)??((we=Lt==null?void 0:Lt.coMax)==null?void 0:we.co1))||15,co4:Number(((ht=Lt==null?void 0:Lt.coMax)==null?void 0:ht.co4)??((nt=Lt==null?void 0:Lt.coMax)==null?void 0:nt.co2))||15}},yr=nr=>{const Tr=nr!=null&&nr.sheet&&typeof nr.sheet=="object"?nr.sheet:{},Dr=Tr!=null&&Tr.rowsByStudentId&&typeof Tr.rowsByStudentId=="object"?Tr.rowsByStudentId:{},Rr=jd(Number((Tr==null?void 0:Tr.expCountA)??0),0,12),tt=jd(Number((Tr==null?void 0:Tr.expCountB)??0),0,12),Xe=Number.isFinite(Number(Tr==null?void 0:Tr.expMaxA))?Number(Tr.expMaxA):25,ot=Number.isFinite(Number(Tr==null?void 0:Tr.expMaxB))?Number(Tr.expMaxB):25,Wt=(Tr==null?void 0:Tr.ciaExamEnabled)!==!1,pr=30/2,Nr=Xe+(Wt?pr:0),br=ot+(Wt?pr:0);return{get:Ht=>{const it=Dr[String(Ht)]||{},bt=BM(it==null?void 0:it.marksA,Rr),_t=BM(it==null?void 0:it.marksB,tt),Tt=IM(bt),Dt=IM(_t),Gt=it==null?void 0:it.ciaExam,$t=typeof Gt=="number"&&Number.isFinite(Gt)?Gt:null,ze=Tt!=null||Dt!=null||$t!=null,Ze=ze?(Tt??0)+(Wt?($t??0)/2:0):null,jt=ze?(Dt??0)+(Wt?($t??0)/2:0):null;return{a:Ze==null?null:jd(Ze,0,Nr),b:jt==null?null:jd(jt,0,br)}},CO_MAX_A:Nr,CO_MAX_B:br}},Br=Pr?yr((ue==null?void 0:ue.data)??null):null,cr=Pr?yr((J==null?void 0:J.data)??null):null,ur=Nt?yr((pe==null?void 0:pe.data)??null):null,en=Nt?yr((xe==null?void 0:xe.data)??null):null,nn=Nt?yr((Ne==null?void 0:Ne.data)??null):null,gn={};c.forEach(nr=>{gn[nr.id]={};const Tr=Ur?Pn(nr):null;ee.forEach(Dr=>{let Rr=null,tt=0,Xe=null,ot=0,Wt=null,pr=0,Nr=null,br=0,Je=null,Ht=0;if(Tr){const bt=`co${Dr}`;bt in Tr&&(Je=Number(Tr[bt]),Ht=Dr===5?4:2)}if(Dr===1||Dr===2)if(Nt){if(ur){const bt=ur.get(nr.id),_t=Dr===1?bt.a:bt.b;_t!=null&&(Xe=_t,ot=Dr===1?ur.CO_MAX_A:ur.CO_MAX_B)}}else{const bt=nu(qe.marks[String(nr.id)]);Rr=bt==null?null:Number(bt)/2,tt=Dr===1?er.ssa1.co1:er.ssa1.co2;const Tt=sr.data;if(Tt){const Gt=(Tt.rowsByStudentId||{})[String(nr.id)]||{},$t=Tt.questions||[],ze=Gt!=null&&Gt.q&&typeof Gt.q=="object"?Gt.q:Gt;let Ze=!1,jt=0,Bt=0;$t.forEach((gr,dr)=>{const Kt=Number((gr==null?void 0:gr.max)||0),ye=e1e($t,dr),Ce=Dr===2?ye.co2:ye.co1;Ce>0&&Kt>0&&(Bt+=Kt*Ce);const $e=nu(ze==null?void 0:ze[gr.key]);if($e==null||Ce<=0)return;Ze=!0;const ft=Kt>0?jd($e,0,Kt):$e;jt+=ft*Ce}),Ze&&(Xe=jt,ot=Bt>0?Bt:Dr===1?er.cia1.co1:er.cia1.co2)}if(xr){const Dt=nu(Cr.marks[String(nr.id)]),Gt=Dt==null?null:Number(Dt)/2;Gt!=null&&(Wt=Gt,pr=Dr===1?er.review1.co1:er.review1.co2)}if(Pr&&Br){const Dt=Br.get(nr.id),Gt=Dr===1?Dt.a:Dt.b;Gt!=null&&(Nr=Gt,br=Dr===1?Br.CO_MAX_A:Br.CO_MAX_B)}if(!xr&&!Pr){const Dt=(wt.marks||{})[String(nr.id)]||{},Gt=Dr===1?"skill1":"skill2",$t=Dr===1?"att1":"att2",ze=nu(Dt[Gt]),Ze=nu(Dt[$t]);ze!==null&&Ze!==null&&(Nr=ze+Ze,br=Dr===1?er.f1.co1:er.f1.co2)}}else if(Dr===3||Dr===4)if(Nt){if(en){const bt=en.get(nr.id),_t=Dr===3?bt.a:bt.b;_t!=null&&(Xe=_t,ot=Dr===3?en.CO_MAX_A:en.CO_MAX_B)}}else{const bt=nu(ut.marks[String(nr.id)]);Rr=bt==null?null:Number(bt)/2,tt=Dr===3?er.ssa2.co3:er.ssa2.co4;const Tt=Zt.data;if(Tt){const Gt=(Tt.rowsByStudentId||{})[String(nr.id)]||{},$t=Tt.questions||[],ze=Gt!=null&&Gt.q&&typeof Gt.q=="object"?Gt.q:Gt;let Ze=!1,jt=0,Bt=0;$t.forEach((gr,dr)=>{const Kt=Number((gr==null?void 0:gr.max)||0),ye=t1e($t,dr),Ce=Dr===4?ye.co4:ye.co3;Ce>0&&Kt>0&&(Bt+=Kt*Ce);const $e=nu(ze==null?void 0:ze[gr.key]);if($e==null||Ce<=0)return;Ze=!0;const ft=Kt>0?jd($e,0,Kt):$e;jt+=ft*Ce}),Ze&&(Xe=jt,ot=Bt>0?Bt:Dr===3?er.cia2.co3:er.cia2.co4)}if(xr){const Dt=nu(se.marks[String(nr.id)]),Gt=Dt==null?null:Number(Dt)/2;Gt!=null&&(Wt=Gt,pr=Dr===3?er.review2.co3:er.review2.co4)}if(Pr&&cr){const Dt=cr.get(nr.id),Gt=Dr===3?Dt.a:Dt.b;Gt!=null&&(Nr=Gt,br=Dr===3?cr.CO_MAX_A:cr.CO_MAX_B)}if(!xr&&!Pr){const Dt=(At.marks||{})[String(nr.id)]||{},Gt=Dr===3?"skill1":"skill2",$t=Dr===3?"att1":"att2",ze=nu(Dt[Gt]),Ze=nu(Dt[$t]);ze!==null&&Ze!==null&&(Nr=ze+Ze,br=Dr===3?er.f2.co3:er.f2.co4)}}if(Nt&&Dr===5&&nn){const bt=nn.get(nr.id);bt.a!=null&&(Je=bt.a,Ht=nn.CO_MAX_A)}const it=[];if(Rr!==null&&tt>0&&it.push({key:"ssa",mark:Rr,max:tt,w:Ve.ssa}),Xe!==null&&ot>0&&it.push({key:"cia",mark:Xe,max:ot,w:Ve.cia}),Wt!==null&&pr>0&&it.push({key:"review",mark:Wt,max:pr,w:Ve.fa}),Nr!==null&&br>0){const bt=Pr?Dr===1||Dr===2?"lab1":Dr===3||Dr===4?"lab2":"fa":"fa";it.push({key:bt,mark:Nr,max:br,w:Ve.fa})}if(Je!==null&&Ht>0&&it.push({key:"me",mark:Je,max:Ht,w:Ht}),it.length>0){const _t=it.reduce((Gt,$t)=>Gt+$t.w,0),Tt=it.reduce((Gt,$t)=>{const ze=$t.mark/$t.max;return Gt+ze*$t.w},0),Dt=it.map(Gt=>({...Gt,contrib:Es(Gt.mark/Gt.max*Gt.w)}));gn[nr.id][`co${Dr}`]={value:Es(Tt),max:Es(_t),breakdown:Dt}}else gn[nr.id][`co${Dr}`]=null})}),g(gn)}catch(Ie){if(!F)return;p((Ie==null?void 0:Ie.message)||"Failed to calculate CO totals")}finally{F&&f(!1)}})(),()=>{F=!1}},[e,t,r,n,c,ee,S]);const Y=(F,Q,K)=>{if(K===""){w(I=>{const ie={...I};return delete ie[`${F}_${Q}`],ie}),b(I=>({...I,[F]:{...I[F],[Q]:null}}));return}const ne=Number(K);if(!(Number.isFinite(ne)&&Math.floor(ne)===ne)){w(I=>({...I,[`${F}_${Q}`]:"Enter an integer between 0 and 10"})),b(I=>({...I,[F]:{...I[F],[Q]:null}}));return}const T=ne;if(T<0||T>10){w(I=>({...I,[`${F}_${Q}`]:"Value must be between 0 and 10"})),b(I=>({...I,[F]:{...I[F],[Q]:T}}));return}w(I=>{const ie={...I};return delete ie[`${F}_${Q}`],ie}),b(I=>{const ie={...I,[F]:{...I[F],[Q]:T}};if(e&&t){const D=`cqi_entries_${e}_${t}`;try{Kn(D,ie)}catch{}}return ae(!0),ie})},q=()=>{if(!(!e||!t)){if(Object.keys(v).length){alert("Fix CQI input errors before saving");return}(async()=>{const F=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"";try{const K=await mr(`/api/obe/cqi-save/${encodeURIComponent(String(e))}${F}`,{method:"PUT",body:JSON.stringify({entries:y})}).catch(()=>null);if(K&&K.ok){alert("CQI entries saved to server"),ae(!1);try{const ne=await K.json().catch(()=>null);ne&&oe(ne)}catch{}return}}catch{}const Q=`cqi_entries_${e}_${t}`;try{Kn(Q,y),ae(!1),alert("CQI entries saved locally")}catch(K){alert("Failed to save CQI entries: "+String((K==null?void 0:K.message)||K))}})()}};return!e||!t?a.jsx("div",{style:{padding:24,color:"#b91c1c"},children:"Missing subject ID or teaching assignment ID"}):d?a.jsx("div",{style:{padding:24,textAlign:"center",color:"#6b7280"},children:"Loading CQI data..."}):h?a.jsxs("div",{style:{padding:24,color:"#b91c1c"},children:["Error: ",h]}):ee.length===0?a.jsx("div",{style:{padding:24,color:"#b91c1c"},children:"No course outcomes selected for CQI entry"}):a.jsxs("div",{style:{padding:12},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16,padding:16,background:"linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)",borderRadius:12,border:"1px solid #bae6fd"},children:[a.jsxs("div",{children:[a.jsxs("h2",{style:{margin:0,fontSize:20,fontWeight:700,color:"#0f172a"},children:["CQI Entry - ",s==null?void 0:s.join(", ")]}),a.jsxs("div",{style:{marginTop:4,fontSize:14,color:"#64748b"},children:["Students below ",R,"% threshold require CQI intervention"]})]}),a.jsx("button",{onClick:q,className:"obe-btn obe-btn-primary",style:{minWidth:100},children:"Save CQI"}),a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[a.jsx("button",{type:"button",onClick:()=>P(F=>!F),className:"obe-btn",style:{minWidth:90,background:E?"#fef3c7":void 0},children:E?"DEBUG ON":"DEBUG"}),a.jsx("button",{type:"button",onClick:()=>G(F=>!F),className:"obe-btn",style:{minWidth:120},children:U?"Hide Header Max":"Show Header Max"}),a.jsx("button",{type:"button",onClick:async()=>{if(!e||!t)return alert("Missing subject/teaching assignment");try{const F={entries:y},Q=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",K=await mr(`/api/obe/cqi-draft/${encodeURIComponent(String(e))}${Q}`,{method:"PUT",body:JSON.stringify(F)}).catch(()=>null);if(K&&K.ok){const ne=await K.json().catch(()=>null);oe(ne||{updated_at:new Date().toISOString(),updated_by:null}),ae(!1),alert("Draft saved to server")}else{const ne=`cqi_entries_${e}_${t}`;try{Kn(ne,y),ae(!1),alert("Draft saved locally")}catch{alert("Failed to save draft")}}}catch(F){alert("Failed to save draft: "+String((F==null?void 0:F.message)||F))}},className:"obe-btn",style:{minWidth:110},children:"Save Draft"}),a.jsx("button",{type:"button",onClick:async()=>{if(!e)return alert("Missing subject");if(confirm("Publish CQI to DB? This action cannot be undone."))try{const F=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",Q=await mr(`/api/obe/cqi-publish/${encodeURIComponent(String(e))}${F}`,{method:"POST"}).catch(()=>null);Q&&Q.ok?alert("CQI published"):alert("Publish failed (server may not support CQI publish)")}catch(F){alert("Publish failed: "+String((F==null?void 0:F.message)||F))}},className:"obe-btn obe-btn-primary",style:{minWidth:110},children:"Publish"})]})]}),a.jsxs("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:10},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 12px",background:"#f8fafc",borderBottom:"1px solid #e6eef8"},children:[a.jsxs("div",{style:{fontSize:13,color:"#475569"},children:["Draft: ",H!=null&&H.updated_at?new Date(String(H.updated_at)).toLocaleString():"never"," ",H!=null&&H.updated_by?`by ${((O=H.updated_by)==null?void 0:O.name)||((X=H.updated_by)==null?void 0:X.username)||H.updated_by}`:"",V?"  unsaved changes":""]}),a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[a.jsxs("label",{style:{fontSize:13,color:"#475569"},children:[a.jsx("input",{type:"checkbox",checked:de,onChange:()=>W(F=>!F)})," Auto-save"]}),a.jsx("button",{className:"obe-btn",onClick:()=>{(async()=>{if(!e||!t)return alert("Missing subject/TA");try{const F=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",Q=await mr(`/api/obe/cqi-draft/${encodeURIComponent(String(e))}${F}`,{method:"PUT",body:JSON.stringify({entries:y})}).catch(()=>null);if(Q&&Q.ok){const K=await Q.json().catch(()=>null);oe(K||null),ae(!1),alert("Draft synced to server")}else alert("Server save failed")}catch(F){alert("Server save failed: "+String((F==null?void 0:F.message)||F))}})()},children:"Sync Draft"})]})]}),a.jsxs("table",{className:"cqi-table",style:{width:"100%",borderCollapse:"collapse",fontSize:14},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{backgroundColor:"#f8fafc",borderBottom:"2px solid #e2e8f0"},children:[a.jsx("th",{style:{padding:"12px 8px",textAlign:"left",fontWeight:700,color:"#475569",minWidth:60},children:"S.No"}),a.jsx("th",{style:{padding:"12px 8px",textAlign:"left",fontWeight:700,color:"#475569",minWidth:120},children:"Reg No"}),a.jsx("th",{style:{padding:"12px 8px",textAlign:"left",fontWeight:700,color:"#475569",minWidth:200},children:"Name"}),a.jsxs("th",{style:{padding:"12px 8px",textAlign:"center",fontWeight:700,color:"#475569",minWidth:100},children:["BEFORE CQI",a.jsx("div",{style:{fontSize:11,fontWeight:400,color:"#94a3b8",marginTop:2},children:"Total / Max"})]}),a.jsxs("th",{style:{padding:"12px 8px",textAlign:"center",fontWeight:700,color:"#475569",minWidth:100},children:["AFTER CQI",a.jsx("div",{style:{fontSize:11,fontWeight:400,color:"#94a3b8",marginTop:2},children:"Total / Max"})]}),a.jsxs("th",{style:{padding:"12px 8px",textAlign:"center",fontWeight:700,color:"#475569",minWidth:120},children:["TOTAL",a.jsx("div",{style:{fontSize:11,fontWeight:400,color:"#94a3b8",marginTop:2},children:"Sum of selected COs"})]}),ee.map(F=>a.jsxs("th",{style:{padding:"12px 8px",textAlign:"center",fontWeight:700,color:"#475569",minWidth:150},children:["CO",F,a.jsx("div",{style:{fontSize:11,fontWeight:400,color:"#94a3b8",marginTop:2},children:U?a.jsxs(a.Fragment,{children:["Max: ",C[F]!=null?Es(C[F]):""]}):a.jsx(a.Fragment,{children:""})})]},F))]})}),a.jsx("tbody",{children:c.map((F,Q)=>{const K=m[F.id]||{};let ne=0,re=0;ee.forEach(_e=>{const He=K[`co${_e}`];He&&(ne+=He.value,re+=He.max)});const T=ne,I=re,ie=I?T/I*100:0,D=re?ne/re*100:0,Z=I?ie:D,me=re;let Te=ne,je=0;ee.forEach(_e=>{var ke;const He=`co${_e}`,We=K[He],Pt=(ke=y[F.id])==null?void 0:ke[He];if(!We||Pt==null||!((We.max?Number(We.value)/Number(We.max)*100:0)<R))return;const lt=Number(Pt)/10*Number(We.max),be=Z<R?lt/M:lt*B;Number.isFinite(be)&&be>0&&(je+=be,Te+=be)}),Te=Number.isFinite(Te)?jd(Te,0,me||Te):ne;const Le=me?Te/me*100:0;return a.jsxs("tr",{style:{borderBottom:"1px solid #e5e7eb",backgroundColor:Q%2===0?"white":"#f9fafb"},children:[a.jsx("td",{style:{padding:"10px 8px",color:"#64748b"},children:Q+1}),a.jsx("td",{style:{padding:"10px 8px",fontFamily:"monospace",color:"#0f172a"},children:F.reg_no}),a.jsx("td",{style:{padding:"10px 8px",color:"#0f172a"},children:F.name}),a.jsx("td",{style:{padding:"10px 8px",textAlign:"center",fontWeight:600},children:re>0?a.jsxs("div",{children:[a.jsxs("div",{style:{color:"#0f172a",fontSize:14},children:[Es(ne),!E&&re>0?a.jsxs(a.Fragment,{children:[" / ",Es(re)]}):null]}),a.jsxs("div",{style:{fontSize:12,color:"#64748b",marginTop:2},children:["(",Es(D),"%)"]})]}):a.jsx("span",{style:{color:"#94a3b8"},children:""})}),a.jsx("td",{style:{padding:"10px 8px",textAlign:"center",fontWeight:600,backgroundColor:Te>ne?"#f0fdf4":"transparent"},children:me>0?a.jsxs("div",{children:[a.jsxs("div",{style:{color:"#0f172a",fontSize:14},children:[Es(Te),!E&&me>0?a.jsxs(a.Fragment,{children:[" / ",Es(me)]}):null]}),a.jsxs("div",{style:{fontSize:12,color:"#64748b",marginTop:2},children:["(",Es(Le),"%)"]}),je>0&&a.jsxs("div",{style:{fontSize:11,color:"#16a34a",marginTop:2},children:["+",Es(je)]})]}):a.jsx("span",{style:{color:"#94a3b8"},children:""})}),a.jsx("td",{style:{padding:"10px 8px",textAlign:"center",fontWeight:700},children:I>0?a.jsxs("div",{style:{backgroundColor:ie<R?"#fff1f2":"transparent",padding:6,borderRadius:6},children:[a.jsxs("div",{style:{color:ie<R?"#ef4444":"#0f172a",fontSize:14,fontWeight:800},children:[Es(ie),"%"]}),a.jsxs("div",{style:{fontSize:12,color:"#64748b",marginTop:6},children:[Es(T),!E&&I>0?a.jsxs(a.Fragment,{children:[" / ",Es(I)]}):null]})]}):a.jsx("span",{style:{color:"#94a3b8"},children:""})}),ee.map(_e=>{var lt;const He=`co${_e}`,We=K[He];if(!We)return a.jsx("td",{style:{padding:"10px 8px",textAlign:"center",color:"#94a3b8"},children:""},_e);const Pt=We.max?We.value/We.max*100:0,dt=Pt<R,Ye=(lt=y[F.id])==null?void 0:lt[He];return a.jsxs("td",{style:{padding:"10px 8px",textAlign:"center",backgroundColor:dt?"#fef2f2":"#f0fdf4"},children:[a.jsxs("div",{style:{fontSize:13,color:"#64748b",marginBottom:6},children:[a.jsxs("div",{children:[Es(We.value)," (",Es(Pt),"%)"]}),E?null:Array.isArray(We.breakdown)&&a.jsx("div",{style:{marginTop:6,fontSize:11,color:"#94a3b8"},children:We.breakdown.map(be=>a.jsxs("div",{style:{display:"inline-block",marginRight:8},children:[Jxe(ni(r),String(be.key||"")),": ",Es(be.mark)," / ",Es(be.max)," =",Es(be.contrib)]},be.key))})]}),dt?a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:11,color:"#dc2626",fontWeight:600,marginBottom:4},children:"CQI ATTAINED"}),a.jsx("input",{type:"number",value:Ye??"",onChange:be=>Y(F.id,He,be.target.value),placeholder:"Enter CQI",className:"obe-input",style:{width:90,padding:"4px 8px",fontSize:13,textAlign:"center"}}),v[`${F.id}_${He}`]&&a.jsx("div",{style:{color:"#dc2626",fontSize:11,marginTop:6},children:v[`${F.id}_${He}`]})]}):a.jsx("div",{style:{fontSize:12,color:"#16a34a",fontWeight:600},children:" NO CQI"})]},_e)})]},F.id)})})]})]}),c.length===0&&a.jsx("div",{style:{textAlign:"center",padding:32,color:"#94a3b8"},children:"No students found in this section"})]})}function Xz(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(r=Xz(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function _i(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=Xz(e))&&(n&&(n+=" "),n+=t);return n}var n1e=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function wC(e){if(typeof e!="string")return!1;var t=n1e;return t.includes(e)}var i1e=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],a1e=new Set(i1e);function Qz(e){return typeof e!="string"?!1:a1e.has(e)}function Jz(e){return typeof e=="string"&&e.startsWith("data-")}function cl(e){if(typeof e!="object"||e===null)return{};var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(Qz(r)||Jz(r))&&(t[r]=e[r]);return t}function yh(e){if(e==null)return null;if(x.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return cl(t)}return typeof e=="object"&&!Array.isArray(e)?cl(e):null}function Vo(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(Qz(r)||Jz(r)||wC(r))&&(t[r]=e[r]);return t}function s1e(e){return e==null?null:x.isValidElement(e)?Vo(e.props):typeof e=="object"&&!Array.isArray(e)?Vo(e):null}var o1e=["children","width","height","viewBox","className","style","title","desc"];function lA(){return lA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lA.apply(null,arguments)}function l1e(e,t){if(e==null)return{};var r,n,i=c1e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function c1e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var SC=x.forwardRef((e,t)=>{var{children:r,width:n,height:i,viewBox:s,className:o,style:l,title:c,desc:u}=e,d=l1e(e,o1e),f=s||{width:n,height:i,x:0,y:0},h=_i("recharts-surface",o);return x.createElement("svg",lA({},Vo(d),{className:h,width:n,height:i,style:l,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:t}),x.createElement("title",null,c),x.createElement("desc",null,u),r)}),u1e=["children","className"];function cA(){return cA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cA.apply(null,arguments)}function d1e(e,t){if(e==null)return{};var r,n,i=f1e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function f1e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ja=x.forwardRef((e,t)=>{var{children:r,className:n}=e,i=d1e(e,u1e),s=_i("recharts-layer",n);return x.createElement("g",cA({className:s},Vo(i),{ref:t}),r)}),Zz=x.createContext(null),h1e=()=>x.useContext(Zz);function sa(e){return function(){return e}}const eW=Math.cos,ew=Math.sin,ku=Math.sqrt,tw=Math.PI,BS=2*tw,uA=Math.PI,dA=2*uA,Uh=1e-6,p1e=dA-Uh;function tW(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function m1e(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return tW;const r=10**t;return function(n){this._+=n[0];for(let i=1,s=n.length;i<s;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}class g1e{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?tW:m1e(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,i){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(t,r,n,i,s,o){this._append`C${+t},${+r},${+n},${+i},${this._x1=+s},${this._y1=+o}`}arcTo(t,r,n,i,s){if(t=+t,r=+r,n=+n,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,l=this._y1,c=n-t,u=i-r,d=o-t,f=l-r,h=d*d+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(h>Uh)if(!(Math.abs(f*c-u*d)>Uh)||!s)this._append`L${this._x1=t},${this._y1=r}`;else{let p=n-o,m=i-l,g=c*c+u*u,y=p*p+m*m,b=Math.sqrt(g),v=Math.sqrt(h),w=s*Math.tan((uA-Math.acos((g+h-y)/(2*b*v)))/2),S=w/v,j=w/b;Math.abs(S-1)>Uh&&this._append`L${t+S*d},${r+S*f}`,this._append`A${s},${s},0,0,${+(f*p>d*m)},${this._x1=t+j*c},${this._y1=r+j*u}`}}arc(t,r,n,i,s,o){if(t=+t,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(i),c=n*Math.sin(i),u=t+l,d=r+c,f=1^o,h=o?i-s:s-i;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>Uh||Math.abs(this._y1-d)>Uh)&&this._append`L${u},${d}`,n&&(h<0&&(h=h%dA+dA),h>p1e?this._append`A${n},${n},0,1,${f},${t-l},${r-c}A${n},${n},0,1,${f},${this._x1=u},${this._y1=d}`:h>Uh&&this._append`A${n},${n},0,${+(h>=uA)},${f},${this._x1=t+n*Math.cos(s)},${this._y1=r+n*Math.sin(s)}`)}rect(t,r,n,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function _C(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new g1e(t)}function jC(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function rW(e){this._context=e}rW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function IS(e){return new rW(e)}function nW(e){return e[0]}function iW(e){return e[1]}function aW(e,t){var r=sa(!0),n=null,i=IS,s=null,o=_C(l);e=typeof e=="function"?e:e===void 0?nW:sa(e),t=typeof t=="function"?t:t===void 0?iW:sa(t);function l(c){var u,d=(c=jC(c)).length,f,h=!1,p;for(n==null&&(s=i(p=o())),u=0;u<=d;++u)!(u<d&&r(f=c[u],u,c))===h&&((h=!h)?s.lineStart():s.lineEnd()),h&&s.point(+e(f,u,c),+t(f,u,c));if(p)return s=null,p+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:sa(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:sa(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:sa(!!c),l):r},l.curve=function(c){return arguments.length?(i=c,n!=null&&(s=i(n)),l):i},l.context=function(c){return arguments.length?(c==null?n=s=null:s=i(n=c),l):n},l}function Zb(e,t,r){var n=null,i=sa(!0),s=null,o=IS,l=null,c=_C(u);e=typeof e=="function"?e:e===void 0?nW:sa(+e),t=typeof t=="function"?t:sa(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?iW:sa(+r);function u(f){var h,p,m,g=(f=jC(f)).length,y,b=!1,v,w=new Array(g),S=new Array(g);for(s==null&&(l=o(v=c())),h=0;h<=g;++h){if(!(h<g&&i(y=f[h],h,f))===b)if(b=!b)p=h,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),m=h-1;m>=p;--m)l.point(w[m],S[m]);l.lineEnd(),l.areaEnd()}b&&(w[h]=+e(y,h,f),S[h]=+t(y,h,f),l.point(n?+n(y,h,f):w[h],r?+r(y,h,f):S[h]))}if(v)return l=null,v+""||null}function d(){return aW().defined(i).curve(o).context(s)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:sa(+f),n=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:sa(+f),u):e},u.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:sa(+f),u):n},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:sa(+f),r=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:sa(+f),u):t},u.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:sa(+f),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(n).y(t)},u.defined=function(f){return arguments.length?(i=typeof f=="function"?f:sa(!!f),u):i},u.curve=function(f){return arguments.length?(o=f,s!=null&&(l=o(s)),u):o},u.context=function(f){return arguments.length?(f==null?s=l=null:l=o(s=f),u):s},u}class sW{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function x1e(e){return new sW(e,!0)}function y1e(e){return new sW(e,!1)}const kC={draw(e,t){const r=ku(t/tw);e.moveTo(r,0),e.arc(0,0,r,0,BS)}},b1e={draw(e,t){const r=ku(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},oW=ku(1/3),v1e=oW*2,w1e={draw(e,t){const r=ku(t/v1e),n=r*oW;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},S1e={draw(e,t){const r=ku(t),n=-r/2;e.rect(n,n,r,r)}},_1e=.8908130915292852,lW=ew(tw/10)/ew(7*tw/10),j1e=ew(BS/10)*lW,k1e=-eW(BS/10)*lW,A1e={draw(e,t){const r=ku(t*_1e),n=j1e*r,i=k1e*r;e.moveTo(0,-r),e.lineTo(n,i);for(let s=1;s<5;++s){const o=BS*s/5,l=eW(o),c=ew(o);e.lineTo(c*r,-l*r),e.lineTo(l*n-c*i,c*n+l*i)}e.closePath()}},zj=ku(3),N1e={draw(e,t){const r=-ku(t/(zj*3));e.moveTo(0,r*2),e.lineTo(-zj*r,-r),e.lineTo(zj*r,-r),e.closePath()}},jc=-.5,kc=ku(3)/2,fA=1/ku(12),C1e=(fA/2+1)*3,E1e={draw(e,t){const r=ku(t/C1e),n=r/2,i=r*fA,s=n,o=r*fA+r,l=-s,c=o;e.moveTo(n,i),e.lineTo(s,o),e.lineTo(l,c),e.lineTo(jc*n-kc*i,kc*n+jc*i),e.lineTo(jc*s-kc*o,kc*s+jc*o),e.lineTo(jc*l-kc*c,kc*l+jc*c),e.lineTo(jc*n+kc*i,jc*i-kc*n),e.lineTo(jc*s+kc*o,jc*o-kc*s),e.lineTo(jc*l+kc*c,jc*c-kc*l),e.closePath()}};function T1e(e,t){let r=null,n=_C(i);e=typeof e=="function"?e:sa(e||kC),t=typeof t=="function"?t:sa(t===void 0?64:+t);function i(){let s;if(r||(r=s=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),s)return r=null,s+""||null}return i.type=function(s){return arguments.length?(e=typeof s=="function"?s:sa(s),i):e},i.size=function(s){return arguments.length?(t=typeof s=="function"?s:sa(+s),i):t},i.context=function(s){return arguments.length?(r=s??null,i):r},i}function rw(){}function nw(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function cW(e){this._context=e}cW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:nw(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:nw(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function P1e(e){return new cW(e)}function uW(e){this._context=e}uW.prototype={areaStart:rw,areaEnd:rw,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:nw(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function O1e(e){return new uW(e)}function dW(e){this._context=e}dW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:nw(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function M1e(e){return new dW(e)}function fW(e){this._context=e}fW.prototype={areaStart:rw,areaEnd:rw,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function L1e(e){return new fW(e)}function UM(e){return e<0?-1:1}function zM(e,t,r){var n=e._x1-e._x0,i=t-e._x1,s=(e._y1-e._y0)/(n||i<0&&-0),o=(r-e._y1)/(i||n<0&&-0),l=(s*i+o*n)/(n+i);return(UM(s)+UM(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(l))||0}function WM(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Wj(e,t,r){var n=e._x0,i=e._y0,s=e._x1,o=e._y1,l=(s-n)/3;e._context.bezierCurveTo(n+l,i+l*t,s-l,o-l*r,s,o)}function iw(e){this._context=e}iw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Wj(this,this._t0,WM(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Wj(this,WM(this,r=zM(this,e,t)),r);break;default:Wj(this,this._t0,r=zM(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function hW(e){this._context=new pW(e)}(hW.prototype=Object.create(iw.prototype)).point=function(e,t){iw.prototype.point.call(this,t,e)};function pW(e){this._context=e}pW.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,i,s){this._context.bezierCurveTo(t,e,n,r,s,i)}};function R1e(e){return new iw(e)}function F1e(e){return new hW(e)}function mW(e){this._context=e}mW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=qM(e),i=qM(t),s=0,o=1;o<r;++s,++o)this._context.bezierCurveTo(n[0][s],i[0][s],n[1][s],i[1][s],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function qM(e){var t,r=e.length-1,n,i=new Array(r),s=new Array(r),o=new Array(r);for(i[0]=0,s[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,s[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,s[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/s[t-1],s[t]-=n,o[t]-=n*o[t-1];for(i[r-1]=o[r-1]/s[r-1],t=r-2;t>=0;--t)i[t]=(o[t]-i[t+1])/s[t];for(s[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)s[t]=2*e[t+1]-i[t+1];return[i,s]}function B1e(e){return new mW(e)}function DS(e,t){this._context=e,this._t=t}DS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function I1e(e){return new DS(e,.5)}function D1e(e){return new DS(e,0)}function $1e(e){return new DS(e,1)}function P0(e,t){if((o=e.length)>1)for(var r=1,n,i,s=e[t[0]],o,l=s.length;r<o;++r)for(i=s,s=e[t[r]],n=0;n<l;++n)s[n][1]+=s[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function hA(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function U1e(e,t){return e[t]}function z1e(e){const t=[];return t.key=e,t}function W1e(){var e=sa([]),t=hA,r=P0,n=U1e;function i(s){var o=Array.from(e.apply(this,arguments),z1e),l,c=o.length,u=-1,d;for(const f of s)for(l=0,++u;l<c;++l)(o[l][u]=[0,+n(f,o[l].key,u,s)]).data=f;for(l=0,d=jC(t(o));l<c;++l)o[d[l]].index=l;return r(o,d),o}return i.keys=function(s){return arguments.length?(e=typeof s=="function"?s:sa(Array.from(s)),i):e},i.value=function(s){return arguments.length?(n=typeof s=="function"?s:sa(+s),i):n},i.order=function(s){return arguments.length?(t=s==null?hA:typeof s=="function"?s:sa(Array.from(s)),i):t},i.offset=function(s){return arguments.length?(r=s??P0,i):r},i}function q1e(e,t){if((n=e.length)>0){for(var r,n,i=0,s=e[0].length,o;i<s;++i){for(o=r=0;r<n;++r)o+=e[r][i][1]||0;if(o)for(r=0;r<n;++r)e[r][i][1]/=o}P0(e,t)}}function H1e(e,t){if((i=e.length)>0){for(var r=0,n=e[t[0]],i,s=n.length;r<s;++r){for(var o=0,l=0;o<i;++o)l+=e[o][r][1]||0;n[r][1]+=n[r][0]=-l/2}P0(e,t)}}function V1e(e,t){if(!(!((o=e.length)>0)||!((s=(i=e[t[0]]).length)>0))){for(var r=0,n=1,i,s,o;n<s;++n){for(var l=0,c=0,u=0;l<o;++l){for(var d=e[t[l]],f=d[n][1]||0,h=d[n-1][1]||0,p=(f-h)/2,m=0;m<l;++m){var g=e[t[m]],y=g[n][1]||0,b=g[n-1][1]||0;p+=y-b}c+=f,u+=p*f}i[n-1][1]+=i[n-1][0]=r,c&&(r-=u/c)}i[n-1][1]+=i[n-1][0]=r,P0(e,t)}}var $S={},gW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(gW);var AC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(AC);var US={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var n;return typeof r=="string"||typeof r=="symbol"?r:Object.is((n=r==null?void 0:r.valueOf)==null?void 0:n.call(r),-0)?"-0":String(r)}e.toKey=t})(US);var zS={},xW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}e.toString=t})(xW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=xW,r=US;function n(i){if(Array.isArray(i))return i.map(r.toKey);if(typeof i=="symbol")return[i];i=t.toString(i);const s=[],o=i.length;if(o===0)return s;let l=0,c="",u="",d=!1;for(i.charCodeAt(0)===46&&(s.push(""),l++);l<o;){const f=i[l];u?f==="\\"&&l+1<o?(l++,c+=i[l]):f===u?u="":c+=f:d?f==='"'||f==="'"?u=f:f==="]"?(d=!1,s.push(c),c=""):c+=f:f==="["?(d=!0,c&&(s.push(c),c="")):f==="."?c&&(s.push(c),c=""):c+=f,l++}return c&&s.push(c),s}e.toPath=n})(zS);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=gW,r=AC,n=US,i=zS;function s(l,c,u){if(l==null)return u;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?r.isDeepKey(c)?s(l,i.toPath(c),u):u:d}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const d=l[c];return d===void 0?u:d}default:{if(Array.isArray(c))return o(l,c,u);if(Object.is(c==null?void 0:c.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?u:d}}}function o(l,c,u){if(c.length===0)return u;let d=l;for(let f=0;f<c.length;f++){if(d==null||t.isUnsafeProperty(c[f]))return u;d=d[c[f]]}return d===void 0?u:d}e.get=s})($S);var G1e=$S.get;const O0=sf(G1e);var K1e=4;function Yf(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:K1e,r=10**t,n=Math.round(e*r)/r;return Object.is(n,-0)?0:n}function za(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.reduce((i,s,o)=>{var l=r[o-1];return typeof l=="string"?i+l+s:l!==void 0?i+Yf(l)+s:i+s},"")}var Qs=e=>e===0?0:e>0?1:-1,nd=e=>typeof e=="number"&&e!=+e,M0=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,En=e=>(typeof e=="number"||e instanceof Number)&&!nd(e),Hc=e=>En(e)||typeof e=="string",Y1e=0,k1=e=>{var t=++Y1e;return"".concat(e||"").concat(t)},Wo=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!En(t)&&typeof t!="string")return n;var s;if(M0(t)){if(r==null)return n;var o=t.indexOf("%");s=r*parseFloat(t.slice(0,o))/100}else s=+t;return nd(s)&&(s=n),i&&r!=null&&s>r&&(s=r),s},yW=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[String(e[n])])r[String(e[n])]=!0;else return!0;return!1};function Xi(e,t,r){return En(e)&&En(t)?Yf(e+r*(t-e)):t}function bW(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):O0(n,t))===r)}var X1e=e=>{for(var t=e.length,r=0,n=0,i=0,s=0,o=1/0,l=-1/0,c=0,u=0,d=0;d<t;d++){var f,h;c=((f=e[d])===null||f===void 0?void 0:f.cx)||0,u=((h=e[d])===null||h===void 0?void 0:h.cy)||0,r+=c,n+=u,i+=c*u,s+=c*c,o=Math.min(o,c),l=Math.max(l,c)}var p=t*s!==r*r?(t*i-r*n)/(t*s-r*r):0;return{xmin:o,xmax:l,a:p,b:(n-p*r)/t}},Qi=e=>e===null||typeof e>"u",hy=e=>Qi(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function _l(e){return e!=null}function ap(){}var Q1e=["type","size","sizeType"];function pA(){return pA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pA.apply(null,arguments)}function HM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function VM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HM(Object(r),!0).forEach(function(n){J1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function J1e(e,t,r){return(t=Z1e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Z1e(e){var t=eye(e,"string");return typeof t=="symbol"?t:t+""}function eye(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tye(e,t){if(e==null)return{};var r,n,i=rye(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function rye(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var vW={symbolCircle:kC,symbolCross:b1e,symbolDiamond:w1e,symbolSquare:S1e,symbolStar:A1e,symbolTriangle:N1e,symbolWye:E1e},nye=Math.PI/180,iye=e=>{var t="symbol".concat(hy(e));return vW[t]||kC},aye=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*nye;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},sye=(e,t)=>{vW["symbol".concat(hy(e))]=t},WS=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,i=tye(e,Q1e),s=VM(VM({},i),{},{type:t,size:r,sizeType:n}),o="circle";typeof t=="string"&&(o=t);var l=()=>{var h=iye(o),p=T1e().type(h).size(aye(r,n,o)),m=p();if(m!==null)return m},{className:c,cx:u,cy:d}=s,f=Vo(s);return En(u)&&En(d)&&En(r)?x.createElement("path",pA({},f,{className:_i("recharts-symbols",c),transform:"translate(".concat(u,", ").concat(d,")"),d:l()})):null};WS.registerSymbol=sye;var wW=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,NC=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(x.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(i=>{wC(i)&&(n[i]=s=>r[i](r,s))}),n},oye=(e,t,r)=>n=>(e(t,r,n),null),hg=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(i=>{var s=e[i];wC(i)&&typeof s=="function"&&(n||(n={}),n[i]=oye(s,t,r))}),n},lye=e=>Array.isArray(e)&&e.length>0;function GM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function cye(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GM(Object(r),!0).forEach(function(n){uye(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uye(e,t,r){return(t=dye(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dye(e){var t=fye(e,"string");return typeof t=="symbol"?t:t+""}function fye(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ka(e,t){var r=cye({},e),n=t,i=Object.keys(t),s=i.reduce((o,l)=>(o[l]===void 0&&n[l]!==void 0&&(o[l]=n[l]),o),r);return s}function aw(){return aw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},aw.apply(null,arguments)}function KM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function hye(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KM(Object(r),!0).forEach(function(n){pye(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pye(e,t,r){return(t=mye(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mye(e){var t=gye(e,"string");return typeof t=="symbol"?t:t+""}function gye(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tc=32,xye={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function yye(e){var{data:t,iconType:r,inactiveColor:n}=e,i=Tc/2,s=Tc/6,o=Tc/3,l=t.inactive?n:t.color,c=r??t.type;if(c==="none")return null;if(c==="plainline"){var u;return x.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:(u=t.payload)===null||u===void 0?void 0:u.strokeDasharray,x1:0,y1:i,x2:Tc,y2:i,className:"recharts-legend-icon"})}if(c==="line")return x.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(i,"h").concat(o,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*o,",").concat(i,`
            H`).concat(Tc,"M").concat(2*o,",").concat(i,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(o,",").concat(i),className:"recharts-legend-icon"});if(c==="rect")return x.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(Tc/8,"h").concat(Tc,"v").concat(Tc*3/4,"h").concat(-Tc,"z"),className:"recharts-legend-icon"});if(x.isValidElement(t.legendIcon)){var d=hye({},t);return delete d.legendIcon,x.cloneElement(t.legendIcon,d)}return x.createElement(WS,{fill:l,cx:i,cy:i,size:Tc,sizeType:"diameter",type:c})}function bye(e){var{payload:t,iconSize:r,layout:n,formatter:i,inactiveColor:s,iconType:o}=e,l={x:0,y:0,width:Tc,height:Tc},c={display:n==="horizontal"?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((d,f)=>{var h=d.formatter||i,p=_i({"recharts-legend-item":!0,["legend-item-".concat(f)]:!0,inactive:d.inactive});if(d.type==="none")return null;var m=d.inactive?s:d.color,g=h?h(d.value,d,f):d.value;return x.createElement("li",aw({className:p,style:c,key:"legend-item-".concat(f)},hg(e,d,f)),x.createElement(SC,{width:r,height:r,viewBox:l,style:u,"aria-label":"".concat(g," legend icon")},x.createElement(yye,{data:d,iconType:o,inactiveColor:s})),x.createElement("span",{className:"recharts-legend-item-text",style:{color:m}},g))})}var vye=e=>{var t=ka(e,xye),{payload:r,layout:n,align:i}=t;if(!r||!r.length)return null;var s={padding:0,margin:0,textAlign:n==="horizontal"?i:"left"};return x.createElement("ul",{className:"recharts-default-legend",style:s},x.createElement(bye,aw({},t,{payload:r})))},SW={},_W={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const i=new Map;for(let s=0;s<r.length;s++){const o=r[s],l=n(o,s,r);i.has(l)||i.set(l,o)}return Array.from(i.values())}e.uniqBy=t})(_W);var jW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return function(...i){return r.apply(this,i.slice(0,n))}}e.ary=t})(jW);var CC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(CC);var kW={},qS={},AW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(AW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=AW;function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(qS);var NW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(NW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=qS,r=NW;function n(i){return r.isObjectLike(i)&&t.isArrayLike(i)}e.isArrayLikeObject=n})(kW);var CW={},EW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$S;function r(n){return function(i){return t.get(i,n)}}e.property=r})(EW);var TW={},EC={},PW={},TC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(TC);var PC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(PC);var OC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.isEqualsSameValueZero=t})(OC);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=TC,r=PC,n=OC;function i(d,f,h){return typeof h!="function"?i(d,f,()=>{}):s(d,f,function p(m,g,y,b,v,w){const S=h(m,g,y,b,v,w);return S!==void 0?!!S:s(m,g,p,w)},new Map)}function s(d,f,h,p){if(f===d)return!0;switch(typeof f){case"object":return o(d,f,h,p);case"function":return Object.keys(f).length>0?s(d,{...f},h,p):n.isEqualsSameValueZero(d,f);default:return t.isObject(d)?typeof f=="string"?f==="":!0:n.isEqualsSameValueZero(d,f)}}function o(d,f,h,p){if(f==null)return!0;if(Array.isArray(f))return c(d,f,h,p);if(f instanceof Map)return l(d,f,h,p);if(f instanceof Set)return u(d,f,h,p);const m=Object.keys(f);if(d==null||r.isPrimitive(d))return m.length===0;if(m.length===0)return!0;if(p!=null&&p.has(f))return p.get(f)===d;p==null||p.set(f,d);try{for(let g=0;g<m.length;g++){const y=m[g];if(!r.isPrimitive(d)&&!(y in d)||f[y]===void 0&&d[y]!==void 0||f[y]===null&&d[y]!==null||!h(d[y],f[y],y,d,f,p))return!1}return!0}finally{p==null||p.delete(f)}}function l(d,f,h,p){if(f.size===0)return!0;if(!(d instanceof Map))return!1;for(const[m,g]of f.entries()){const y=d.get(m);if(h(y,g,m,d,f,p)===!1)return!1}return!0}function c(d,f,h,p){if(f.length===0)return!0;if(!Array.isArray(d))return!1;const m=new Set;for(let g=0;g<f.length;g++){const y=f[g];let b=!1;for(let v=0;v<d.length;v++){if(m.has(v))continue;const w=d[v];let S=!1;if(h(w,y,g,d,f,p)&&(S=!0),S){m.add(v),b=!0;break}}if(!b)return!1}return!0}function u(d,f,h,p){return f.size===0?!0:d instanceof Set?c([...d],[...f],h,p):!1}e.isMatchWith=i,e.isSetMatch=u})(PW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=PW;function r(n,i){return t.isMatchWith(n,i,()=>{})}e.isMatch=r})(EC);var OW={},MC={},MW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(MW);var HS={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(HS);var LC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",i="[object Boolean]",s="[object Arguments]",o="[object Symbol]",l="[object Date]",c="[object Map]",u="[object Set]",d="[object Array]",f="[object Function]",h="[object ArrayBuffer]",p="[object Object]",m="[object Error]",g="[object DataView]",y="[object Uint8Array]",b="[object Uint8ClampedArray]",v="[object Uint16Array]",w="[object Uint32Array]",S="[object BigUint64Array]",j="[object Int8Array]",k="[object Int16Array]",A="[object Int32Array]",R="[object BigInt64Array]",M="[object Float32Array]",B="[object Float64Array]";e.argumentsTag=s,e.arrayBufferTag=h,e.arrayTag=d,e.bigInt64ArrayTag=R,e.bigUint64ArrayTag=S,e.booleanTag=i,e.dataViewTag=g,e.dateTag=l,e.errorTag=m,e.float32ArrayTag=M,e.float64ArrayTag=B,e.functionTag=f,e.int16ArrayTag=k,e.int32ArrayTag=A,e.int8ArrayTag=j,e.mapTag=c,e.numberTag=n,e.objectTag=p,e.regexpTag=t,e.setTag=u,e.stringTag=r,e.symbolTag=o,e.uint16ArrayTag=v,e.uint32ArrayTag=w,e.uint8ArrayTag=y,e.uint8ClampedArrayTag=b})(LC);var LW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(LW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=MW,r=HS,n=LC,i=PC,s=LW;function o(d,f){return l(d,void 0,d,new Map,f)}function l(d,f,h,p=new Map,m=void 0){const g=m==null?void 0:m(d,f,h,p);if(g!==void 0)return g;if(i.isPrimitive(d))return d;if(p.has(d))return p.get(d);if(Array.isArray(d)){const y=new Array(d.length);p.set(d,y);for(let b=0;b<d.length;b++)y[b]=l(d[b],b,h,p,m);return Object.hasOwn(d,"index")&&(y.index=d.index),Object.hasOwn(d,"input")&&(y.input=d.input),y}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const y=new RegExp(d.source,d.flags);return y.lastIndex=d.lastIndex,y}if(d instanceof Map){const y=new Map;p.set(d,y);for(const[b,v]of d)y.set(b,l(v,b,h,p,m));return y}if(d instanceof Set){const y=new Set;p.set(d,y);for(const b of d)y.add(l(b,void 0,h,p,m));return y}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(s.isTypedArray(d)){const y=new(Object.getPrototypeOf(d)).constructor(d.length);p.set(d,y);for(let b=0;b<d.length;b++)y[b]=l(d[b],b,h,p,m);return y}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const y=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return p.set(d,y),c(y,d,h,p,m),y}if(typeof File<"u"&&d instanceof File){const y=new File([d],d.name,{type:d.type});return p.set(d,y),c(y,d,h,p,m),y}if(typeof Blob<"u"&&d instanceof Blob){const y=new Blob([d],{type:d.type});return p.set(d,y),c(y,d,h,p,m),y}if(d instanceof Error){const y=new d.constructor;return p.set(d,y),y.message=d.message,y.name=d.name,y.stack=d.stack,y.cause=d.cause,c(y,d,h,p,m),y}if(d instanceof Boolean){const y=new Boolean(d.valueOf());return p.set(d,y),c(y,d,h,p,m),y}if(d instanceof Number){const y=new Number(d.valueOf());return p.set(d,y),c(y,d,h,p,m),y}if(d instanceof String){const y=new String(d.valueOf());return p.set(d,y),c(y,d,h,p,m),y}if(typeof d=="object"&&u(d)){const y=Object.create(Object.getPrototypeOf(d));return p.set(d,y),c(y,d,h,p,m),y}return d}function c(d,f,h=d,p,m){const g=[...Object.keys(f),...t.getSymbols(f)];for(let y=0;y<g.length;y++){const b=g[y],v=Object.getOwnPropertyDescriptor(d,b);(v==null||v.writable)&&(d[b]=l(f[b],b,h,p,m))}}function u(d){switch(r.getTag(d)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=o,e.cloneDeepWithImpl=l,e.copyProperties=c})(MC);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=MC;function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(OW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=EC,r=OW;function n(i){return i=r.cloneDeep(i),s=>t.isMatch(s,i)}e.matches=n})(TW);var RW={},FW={},BW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=MC,r=HS,n=LC;function i(s,o){return t.cloneDeepWith(s,(l,c,u,d)=>{const f=o==null?void 0:o(l,c,u,d);if(f!==void 0)return f;if(typeof s=="object"){if(r.getTag(s)===n.objectTag&&typeof s.constructor!="function"){const h={};return d.set(s,h),t.copyProperties(h,s,u,d),h}switch(Object.prototype.toString.call(s)){case n.numberTag:case n.stringTag:case n.booleanTag:{const h=new s.constructor(s==null?void 0:s.valueOf());return t.copyProperties(h,s),h}case n.argumentsTag:{const h={};return t.copyProperties(h,s),h.length=s.length,h[Symbol.iterator]=s[Symbol.iterator],h}default:return}}})}e.cloneDeepWith=i})(BW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=BW;function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(FW);var IW={},RC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,i=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<i;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(RC);var DW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=HS;function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(DW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=AC,r=RC,n=DW,i=zS;function s(o,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&t.isDeepKey(l)&&(o==null?void 0:o[l])==null?c=i.toPath(l):c=[l],c.length===0)return!1;let u=o;for(let d=0;d<c.length;d++){const f=c[d];if((u==null||!Object.hasOwn(u,f))&&!((Array.isArray(u)||n.isArguments(u))&&r.isIndex(f)&&f<u.length))return!1;u=u[f]}return!0}e.has=s})(IW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=EC,r=US,n=FW,i=$S,s=IW;function o(l,c){switch(typeof l){case"object":{Object.is(l==null?void 0:l.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return c=n.cloneDeep(c),function(u){const d=i.get(u,l);return d===void 0?s.has(u,l):c===void 0?d===void 0:t.isMatch(d,c)}}e.matchesProperty=o})(RW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=CC,r=EW,n=TW,i=RW;function s(o){if(o==null)return t.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?i.matchesProperty(o[0],o[1]):n.matches(o);case"string":case"symbol":case"number":return r.property(o)}}e.iteratee=s})(CW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=_W,r=jW,n=CC,i=kW,s=CW;function o(l,c=n.identity){return i.isArrayLikeObject(l)?t.uniqBy(Array.from(l),r.ary(s.iteratee(c),1)):[]}e.uniqBy=o})(SW);var wye=SW.uniqBy;const YM=sf(wye);function $W(e,t,r){return t===!0?YM(e,r):typeof t=="function"?YM(e,t):e}var UW={exports:{}},zW={},WW={exports:{}},qW={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wm=x;function Sye(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var _ye=typeof Object.is=="function"?Object.is:Sye,jye=Wm.useState,kye=Wm.useEffect,Aye=Wm.useLayoutEffect,Nye=Wm.useDebugValue;function Cye(e,t){var r=t(),n=jye({inst:{value:r,getSnapshot:t}}),i=n[0].inst,s=n[1];return Aye(function(){i.value=r,i.getSnapshot=t,qj(i)&&s({inst:i})},[e,r,t]),kye(function(){return qj(i)&&s({inst:i}),e(function(){qj(i)&&s({inst:i})})},[e]),Nye(r),r}function qj(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!_ye(e,r)}catch{return!0}}function Eye(e,t){return t()}var Tye=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Eye:Cye;qW.useSyncExternalStore=Wm.useSyncExternalStore!==void 0?Wm.useSyncExternalStore:Tye;WW.exports=qW;var Pye=WW.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VS=x,Oye=Pye;function Mye(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Lye=typeof Object.is=="function"?Object.is:Mye,Rye=Oye.useSyncExternalStore,Fye=VS.useRef,Bye=VS.useEffect,Iye=VS.useMemo,Dye=VS.useDebugValue;zW.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var s=Fye(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=Iye(function(){function c(p){if(!u){if(u=!0,d=p,p=n(p),i!==void 0&&o.hasValue){var m=o.value;if(i(m,p))return f=m}return f=p}if(m=f,Lye(d,p))return m;var g=n(p);return i!==void 0&&i(m,g)?(d=p,m):(d=p,f=g)}var u=!1,d,f,h=r===void 0?null:r;return[function(){return c(t())},h===null?void 0:function(){return c(h())}]},[t,r,n,i]);var l=Rye(e,s[0],s[1]);return Bye(function(){o.hasValue=!0,o.value=l},[l]),Dye(l),l};UW.exports=zW;var $ye=UW.exports,FC=x.createContext(null),Uye=e=>e,Zi=()=>{var e=x.useContext(FC);return e?e.store.dispatch:Uye},Xv=()=>{},zye=()=>Xv,Wye=(e,t)=>e===t;function jn(e){var t=x.useContext(FC),r=x.useMemo(()=>t?n=>{if(n!=null)return e(n)}:Xv,[t,e]);return $ye.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:zye,t?t.store.getState:Xv,t?t.store.getState:Xv,r,Wye)}function qye(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function Hye(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function Vye(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var XM=e=>Array.isArray(e)?e:[e];function Gye(e){const t=Array.isArray(e[0])?e[0]:e;return Vye(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function Kye(e,t){const r=[],{length:n}=e;for(let i=0;i<n;i++)r.push(e[i].apply(null,t));return r}var Yye=class{constructor(e){this.value=e}deref(){return this.value}},Xye=typeof WeakRef<"u"?WeakRef:Yye,Qye=0,QM=1;function ev(){return{s:Qye,v:void 0,o:null,p:null}}function HW(e,t={}){let r=ev();const{resultEqualityCheck:n}=t;let i,s=0;function o(){var f;let l=r;const{length:c}=arguments;for(let h=0,p=c;h<p;h++){const m=arguments[h];if(typeof m=="function"||typeof m=="object"&&m!==null){let g=l.o;g===null&&(l.o=g=new WeakMap);const y=g.get(m);y===void 0?(l=ev(),g.set(m,l)):l=y}else{let g=l.p;g===null&&(l.p=g=new Map);const y=g.get(m);y===void 0?(l=ev(),g.set(m,l)):l=y}}const u=l;let d;if(l.s===QM)d=l.v;else if(d=e.apply(null,arguments),s++,n){const h=((f=i==null?void 0:i.deref)==null?void 0:f.call(i))??i;h!=null&&n(h,d)&&(d=h,s!==0&&s--),i=typeof d=="object"&&d!==null||typeof d=="function"?new Xye(d):d}return u.s=QM,u.v=d,d}return o.clearCache=()=>{r=ev(),o.resetResultsCount()},o.resultsCount=()=>s,o.resetResultsCount=()=>{s=0},o}function Jye(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...i)=>{let s=0,o=0,l,c={},u=i.pop();typeof u=="object"&&(c=u,u=i.pop()),qye(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...c},{memoize:f,memoizeOptions:h=[],argsMemoize:p=HW,argsMemoizeOptions:m=[]}=d,g=XM(h),y=XM(m),b=Gye(i),v=f(function(){return s++,u.apply(null,arguments)},...g),w=p(function(){o++;const j=Kye(b,arguments);return l=v.apply(null,j),l},...y);return Object.assign(w,{resultFunc:u,memoizedResultFunc:v,dependencies:b,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>s,resetRecomputations:()=>{s=0},memoize:f,argsMemoize:p})};return Object.assign(n,{withTypes:()=>n}),n}var Qt=Jye(HW),Zye=Object.assign((e,t=Qt)=>{Hye(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(s=>e[s]);return t(n,(...s)=>s.reduce((o,l,c)=>(o[r[c]]=l,o),{}))},{withTypes:()=>Zye}),VW={},GW={},KW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,i,s)=>{if(n!==i){const o=t(n),l=t(i);if(o===l&&o===0){if(n<i)return s==="desc"?1:-1;if(n>i)return s==="desc"?-1:1}return s==="desc"?l-o:o-l}return 0};e.compareValues=r})(KW);var YW={},BC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(BC);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=BC,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(s,o){return Array.isArray(s)?!1:typeof s=="number"||typeof s=="boolean"||s==null||t.isSymbol(s)?!0:typeof s=="string"&&(n.test(s)||!r.test(s))||o!=null&&Object.hasOwn(o,s)}e.isKey=i})(YW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=KW,r=YW,n=zS;function i(s,o,l,c){if(s==null)return[];l=c?void 0:l,Array.isArray(s)||(s=Object.values(s)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(p=>String(p));const u=(p,m)=>{let g=p;for(let y=0;y<m.length&&g!=null;++y)g=g[m[y]];return g},d=(p,m)=>m==null||p==null?m:typeof p=="object"&&"key"in p?Object.hasOwn(m,p.key)?m[p.key]:u(m,p.path):typeof p=="function"?p(m):Array.isArray(p)?u(m,p):typeof m=="object"?m[p]:m,f=o.map(p=>(Array.isArray(p)&&p.length===1&&(p=p[0]),p==null||typeof p=="function"||Array.isArray(p)||r.isKey(p)?p:{key:p,path:n.toPath(p)}));return s.map(p=>({original:p,criteria:f.map(m=>d(m,p))})).slice().sort((p,m)=>{for(let g=0;g<f.length;g++){const y=t.compareValues(p.criteria[g],m.criteria[g],l[g]);if(y!==0)return y}return 0}).map(p=>p.original)}e.orderBy=i})(GW);var XW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const i=[],s=Math.floor(n),o=(l,c)=>{for(let u=0;u<l.length;u++){const d=l[u];Array.isArray(d)&&c<s?o(d,c+1):i.push(d)}};return o(r,0),i}e.flatten=t})(XW);var IC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=RC,r=qS,n=TC,i=OC;function s(o,l,c){return n.isObject(c)&&(typeof l=="number"&&r.isArrayLike(c)&&t.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?i.isEqualsSameValueZero(c[l],o):!1}e.isIterateeCall=s})(IC);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=GW,r=XW,n=IC;function i(s,...o){const l=o.length;return l>1&&n.isIterateeCall(s,o[0],o[1])?o=[]:l>2&&n.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),t.orderBy(s,r.flatten(o),["asc"])}e.sortBy=i})(VW);var ebe=VW.sortBy;const GS=sf(ebe);var QW=e=>e.legend.settings,tbe=e=>e.legend.size,rbe=e=>e.legend.payload,nbe=Qt([rbe,QW],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?GS(n,r):n});function ibe(){return jn(nbe)}var tv=1;function JW(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=x.useState({height:0,left:0,top:0,width:0}),n=x.useCallback(i=>{if(i!=null){var s=i.getBoundingClientRect(),o={height:s.height,left:s.left,top:s.top,width:s.width};(Math.abs(o.height-t.height)>tv||Math.abs(o.left-t.left)>tv||Math.abs(o.top-t.top)>tv||Math.abs(o.width-t.width)>tv)&&r({height:o.height,left:o.left,top:o.top,width:o.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function ho(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var abe=typeof Symbol=="function"&&Symbol.observable||"@@observable",JM=abe,Hj=()=>Math.random().toString(36).substring(7).split("").join("."),sbe={INIT:`@@redux/INIT${Hj()}`,REPLACE:`@@redux/REPLACE${Hj()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Hj()}`},sw=sbe;function DC(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function ZW(e,t,r){if(typeof e!="function")throw new Error(ho(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(ho(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(ho(1));return r(ZW)(e,t)}let n=e,i=t,s=new Map,o=s,l=0,c=!1;function u(){o===s&&(o=new Map,s.forEach((y,b)=>{o.set(b,y)}))}function d(){if(c)throw new Error(ho(3));return i}function f(y){if(typeof y!="function")throw new Error(ho(4));if(c)throw new Error(ho(5));let b=!0;u();const v=l++;return o.set(v,y),function(){if(b){if(c)throw new Error(ho(6));b=!1,u(),o.delete(v),s=null}}}function h(y){if(!DC(y))throw new Error(ho(7));if(typeof y.type>"u")throw new Error(ho(8));if(typeof y.type!="string")throw new Error(ho(17));if(c)throw new Error(ho(9));try{c=!0,i=n(i,y)}finally{c=!1}return(s=o).forEach(v=>{v()}),y}function p(y){if(typeof y!="function")throw new Error(ho(10));n=y,h({type:sw.REPLACE})}function m(){const y=f;return{subscribe(b){if(typeof b!="object"||b===null)throw new Error(ho(11));function v(){const S=b;S.next&&S.next(d())}return v(),{unsubscribe:y(v)}},[JM](){return this}}}return h({type:sw.INIT}),{dispatch:h,subscribe:f,getState:d,replaceReducer:p,[JM]:m}}function obe(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:sw.INIT})>"u")throw new Error(ho(12));if(typeof r(void 0,{type:sw.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(ho(13))})}function eq(e){const t=Object.keys(e),r={};for(let s=0;s<t.length;s++){const o=t[s];typeof e[o]=="function"&&(r[o]=e[o])}const n=Object.keys(r);let i;try{obe(r)}catch(s){i=s}return function(o={},l){if(i)throw i;let c=!1;const u={};for(let d=0;d<n.length;d++){const f=n[d],h=r[f],p=o[f],m=h(p,l);if(typeof m>"u")throw l&&l.type,new Error(ho(14));u[f]=m,c=c||m!==p}return c=c||n.length!==Object.keys(o).length,c?u:o}}function ow(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function lbe(...e){return t=>(r,n)=>{const i=t(r,n);let s=()=>{throw new Error(ho(15))};const o={getState:i.getState,dispatch:(c,...u)=>s(c,...u)},l=e.map(c=>c(o));return s=ow(...l)(i.dispatch),{...i,dispatch:s}}}function tq(e){return DC(e)&&"type"in e&&typeof e.type=="string"}var rq=Symbol.for("immer-nothing"),ZM=Symbol.for("immer-draftable"),ul=Symbol.for("immer-state");function lu(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var rc=Object,qm=rc.getPrototypeOf,lw="constructor",KS="prototype",mA="configurable",cw="enumerable",Qv="writable",A1="value",Qd=e=>!!e&&!!e[ul];function wu(e){var t;return e?nq(e)||XS(e)||!!e[ZM]||!!((t=e[lw])!=null&&t[ZM])||QS(e)||JS(e):!1}var cbe=rc[KS][lw].toString(),eL=new WeakMap;function nq(e){if(!e||!$C(e))return!1;const t=qm(e);if(t===null||t===rc[KS])return!0;const r=rc.hasOwnProperty.call(t,lw)&&t[lw];if(r===Object)return!0;if(!$p(r))return!1;let n=eL.get(r);return n===void 0&&(n=Function.toString.call(r),eL.set(r,n)),n===cbe}function YS(e,t,r=!0){py(e)===0?(r?Reflect.ownKeys(e):rc.keys(e)).forEach(i=>{t(i,e[i],e)}):e.forEach((n,i)=>t(i,n,e))}function py(e){const t=e[ul];return t?t.type_:XS(e)?1:QS(e)?2:JS(e)?3:0}var tL=(e,t,r=py(e))=>r===2?e.has(t):rc[KS].hasOwnProperty.call(e,t),gA=(e,t,r=py(e))=>r===2?e.get(t):e[t],uw=(e,t,r,n=py(e))=>{n===2?e.set(t,r):n===3?e.add(r):e[t]=r};function ube(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}var XS=Array.isArray,QS=e=>e instanceof Map,JS=e=>e instanceof Set,$C=e=>typeof e=="object",$p=e=>typeof e=="function",Vj=e=>typeof e=="boolean";function dbe(e){const t=+e;return Number.isInteger(t)&&String(t)===e}var Td=e=>e.copy_||e.base_,UC=e=>e.modified_?e.copy_:e.base_;function xA(e,t){if(QS(e))return new Map(e);if(JS(e))return new Set(e);if(XS(e))return Array[KS].slice.call(e);const r=nq(e);if(t===!0||t==="class_only"&&!r){const n=rc.getOwnPropertyDescriptors(e);delete n[ul];let i=Reflect.ownKeys(n);for(let s=0;s<i.length;s++){const o=i[s],l=n[o];l[Qv]===!1&&(l[Qv]=!0,l[mA]=!0),(l.get||l.set)&&(n[o]={[mA]:!0,[Qv]:!0,[cw]:l[cw],[A1]:e[o]})}return rc.create(qm(e),n)}else{const n=qm(e);if(n!==null&&r)return{...e};const i=rc.create(n);return rc.assign(i,e)}}function zC(e,t=!1){return ZS(e)||Qd(e)||!wu(e)||(py(e)>1&&rc.defineProperties(e,{set:rv,add:rv,clear:rv,delete:rv}),rc.freeze(e),t&&YS(e,(r,n)=>{zC(n,!0)},!1)),e}function fbe(){lu(2)}var rv={[A1]:fbe};function ZS(e){return e===null||!$C(e)?!0:rc.isFrozen(e)}var dw="MapSet",yA="Patches",rL="ArrayMethods",iq={};function L0(e){const t=iq[e];return t||lu(0,e),t}var nL=e=>!!iq[e],N1,aq=()=>N1,hbe=(e,t)=>({drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:nL(dw)?L0(dw):void 0,arrayMethodsPlugin_:nL(rL)?L0(rL):void 0});function iL(e,t){t&&(e.patchPlugin_=L0(yA),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function bA(e){vA(e),e.drafts_.forEach(pbe),e.drafts_=null}function vA(e){e===N1&&(N1=e.parent_)}var aL=e=>N1=hbe(N1,e);function pbe(e){const t=e[ul];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function sL(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];if(e!==void 0&&e!==r){r[ul].modified_&&(bA(t),lu(4)),wu(e)&&(e=oL(t,e));const{patchPlugin_:i}=t;i&&i.generateReplacementPatches_(r[ul].base_,e,t)}else e=oL(t,r);return mbe(t,e,!0),bA(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==rq?e:void 0}function oL(e,t){if(ZS(t))return t;const r=t[ul];if(!r)return fw(t,e.handledSet_,e);if(!e_(r,e))return t;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:n}=r;if(n)for(;n.length>0;)n.pop()(e);lq(r,e)}return r.copy_}function mbe(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&zC(t,r)}function sq(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var e_=(e,t)=>e.scope_===t,gbe=[];function oq(e,t,r,n){const i=Td(e),s=e.type_;if(n!==void 0&&gA(i,n,s)===t){uw(i,n,r,s);return}if(!e.draftLocations_){const l=e.draftLocations_=new Map;YS(i,(c,u)=>{if(Qd(u)){const d=l.get(u)||[];d.push(c),l.set(u,d)}})}const o=e.draftLocations_.get(t)??gbe;for(const l of o)uw(i,l,r,s)}function xbe(e,t,r){e.callbacks_.push(function(i){var l;const s=t;if(!s||!e_(s,i))return;(l=i.mapSetPlugin_)==null||l.fixSetContents(s);const o=UC(s);oq(e,s.draft_??s,o,r),lq(s,i)})}function lq(e,t){var n;if(e.modified_&&!e.finalized_&&(e.type_===3||e.type_===1&&e.allIndicesReassigned_||(((n=e.assigned_)==null?void 0:n.size)??0)>0)){const{patchPlugin_:i}=t;if(i){const s=i.getPath(e);s&&i.generatePatches_(e,s,t)}sq(e)}}function ybe(e,t,r){const{scope_:n}=e;if(Qd(r)){const i=r[ul];e_(i,n)&&i.callbacks_.push(function(){Jv(e);const o=UC(i);oq(e,r,o,t)})}else wu(r)&&e.callbacks_.push(function(){const s=Td(e);e.type_===3?s.has(r)&&fw(r,n.handledSet_,n):gA(s,t,e.type_)===r&&n.drafts_.length>1&&(e.assigned_.get(t)??!1)===!0&&e.copy_&&fw(gA(e.copy_,t,e.type_),n.handledSet_,n)})}function fw(e,t,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||Qd(e)||t.has(e)||!wu(e)||ZS(e)||(t.add(e),YS(e,(n,i)=>{if(Qd(i)){const s=i[ul];if(e_(s,r)){const o=UC(s);uw(e,n,o,e.type_),sq(s)}}else wu(i)&&fw(i,t,r)})),e}function bbe(e,t){const r=XS(e),n={type_:r?1:0,scope_:t?t.scope_:aq(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let i=n,s=hw;r&&(i=[n],s=C1);const{revoke:o,proxy:l}=Proxy.revocable(i,s);return n.draft_=l,n.revoke_=o,[l,n]}var hw={get(e,t){if(t===ul)return e;let r=e.scope_.arrayMethodsPlugin_;const n=e.type_===1&&typeof t=="string";if(n&&r!=null&&r.isArrayOperationMethod(t))return r.createMethodInterceptor(e,t);const i=Td(e);if(!tL(i,t,e.type_))return vbe(e,i,t);const s=i[t];if(e.finalized_||!wu(s)||n&&e.operationMethod&&(r!=null&&r.isMutatingArrayMethod(e.operationMethod))&&dbe(t))return s;if(s===Gj(e.base_,t)){Jv(e);const o=e.type_===1?+t:t,l=SA(e.scope_,s,e,o);return e.copy_[o]=l}return s},has(e,t){return t in Td(e)},ownKeys(e){return Reflect.ownKeys(Td(e))},set(e,t,r){const n=cq(Td(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const i=Gj(Td(e),t),s=i==null?void 0:i[ul];if(s&&s.base_===r)return e.copy_[t]=r,e.assigned_.set(t,!1),!0;if(ube(r,i)&&(r!==void 0||tL(e.base_,t,e.type_)))return!0;Jv(e),wA(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_.set(t,!0),ybe(e,t,r)),!0},deleteProperty(e,t){return Jv(e),Gj(e.base_,t)!==void 0||t in e.base_?(e.assigned_.set(t,!1),wA(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Td(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{[Qv]:!0,[mA]:e.type_!==1||t!=="length",[cw]:n[cw],[A1]:r[t]}},defineProperty(){lu(11)},getPrototypeOf(e){return qm(e.base_)},setPrototypeOf(){lu(12)}},C1={};for(let e in hw){let t=hw[e];C1[e]=function(){const r=arguments;return r[0]=r[0][0],t.apply(this,r)}}C1.deleteProperty=function(e,t){return C1.set.call(this,e,t,void 0)};C1.set=function(e,t,r){return hw.set.call(this,e[0],t,r,e[0])};function Gj(e,t){const r=e[ul];return(r?Td(r):e)[t]}function vbe(e,t,r){var i;const n=cq(t,r);return n?A1 in n?n[A1]:(i=n.get)==null?void 0:i.call(e.draft_):void 0}function cq(e,t){if(!(t in e))return;let r=qm(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=qm(r)}}function wA(e){e.modified_||(e.modified_=!0,e.parent_&&wA(e.parent_))}function Jv(e){e.copy_||(e.assigned_=new Map,e.copy_=xA(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var wbe=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(r,n,i)=>{if($p(r)&&!$p(n)){const o=n;n=r;const l=this;return function(u=o,...d){return l.produce(u,f=>n.call(this,f,...d))}}$p(n)||lu(6),i!==void 0&&!$p(i)&&lu(7);let s;if(wu(r)){const o=aL(this),l=SA(o,r,void 0);let c=!0;try{s=n(l),c=!1}finally{c?bA(o):vA(o)}return iL(o,i),sL(s,o)}else if(!r||!$C(r)){if(s=n(r),s===void 0&&(s=r),s===rq&&(s=void 0),this.autoFreeze_&&zC(s,!0),i){const o=[],l=[];L0(yA).generateReplacementPatches_(r,s,{patches_:o,inversePatches_:l}),i(o,l)}return s}else lu(1,r)},this.produceWithPatches=(r,n)=>{if($p(r))return(l,...c)=>this.produceWithPatches(l,u=>r(u,...c));let i,s;return[this.produce(r,n,(l,c)=>{i=l,s=c}),i,s]},Vj(t==null?void 0:t.autoFreeze)&&this.setAutoFreeze(t.autoFreeze),Vj(t==null?void 0:t.useStrictShallowCopy)&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),Vj(t==null?void 0:t.useStrictIteration)&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){wu(t)||lu(8),Qd(t)&&(t=xu(t));const r=aL(this),n=SA(r,t,void 0);return n[ul].isManual_=!0,vA(r),n}finishDraft(t,r){const n=t&&t[ul];(!n||!n.isManual_)&&lu(9);const{scope_:i}=n;return iL(i,r),sL(void 0,i)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,r){let n;for(n=r.length-1;n>=0;n--){const s=r[n];if(s.path.length===0&&s.op==="replace"){t=s.value;break}}n>-1&&(r=r.slice(n+1));const i=L0(yA).applyPatches_;return Qd(t)?i(t,r):this.produce(t,s=>i(s,r))}};function SA(e,t,r,n){const[i,s]=QS(t)?L0(dw).proxyMap_(t,r):JS(t)?L0(dw).proxySet_(t,r):bbe(t,r);return((r==null?void 0:r.scope_)??aq()).drafts_.push(i),s.callbacks_=(r==null?void 0:r.callbacks_)??[],s.key_=n,r&&n!==void 0?xbe(r,s,n):s.callbacks_.push(function(c){var d;(d=c.mapSetPlugin_)==null||d.fixSetContents(s);const{patchPlugin_:u}=c;s.modified_&&u&&u.generatePatches_(s,[],c)}),i}function xu(e){return Qd(e)||lu(10,e),uq(e)}function uq(e){if(!wu(e)||ZS(e))return e;const t=e[ul];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=xA(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=xA(e,!0);return YS(r,(i,s)=>{uw(r,i,uq(s))},n),t&&(t.finalized_=!1),r}var Sbe=new wbe,dq=Sbe.produce;function fq(e){return({dispatch:r,getState:n})=>i=>s=>typeof s=="function"?s(r,n,e):i(s)}var _be=fq(),jbe=fq,kbe=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?ow:ow.apply(null,arguments)};function Vc(e,t){function r(...n){if(t){let i=t(...n);if(!i)throw new Error(ic(0));return{type:e,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>tq(n)&&n.type===e,r}var hq=class gx extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,gx.prototype)}static get[Symbol.species](){return gx}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new gx(...t[0].concat(this)):new gx(...t.concat(this))}};function lL(e){return wu(e)?dq(e,()=>{}):e}function nv(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function Abe(e){return typeof e=="boolean"}var Nbe=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:s=!0}=t??{};let o=new hq;return r&&(Abe(r)?o.push(_be):o.push(jbe(r.extraArgument))),o},pq="RTK_autoBatch",wa=()=>e=>({payload:e,meta:{[pq]:!0}}),cL=e=>t=>{setTimeout(t,e)},mq=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let i=!0,s=!1,o=!1;const l=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:cL(10):e.type==="callback"?e.queueNotification:cL(e.timeout),u=()=>{o=!1,s&&(s=!1,l.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const f=()=>i&&d(),h=n.subscribe(f);return l.add(d),()=>{h(),l.delete(d)}},dispatch(d){var f;try{return i=!((f=d==null?void 0:d.meta)!=null&&f[pq]),s=!i,s&&(o||(o=!0,c(u))),n.dispatch(d)}finally{i=!0}}})},Cbe=e=>function(r){const{autoBatch:n=!0}=r??{};let i=new hq(e);return n&&i.push(mq(typeof n=="object"?n:void 0)),i};function Ebe(e){const t=Nbe(),{reducer:r=void 0,middleware:n,devTools:i=!0,preloadedState:s=void 0,enhancers:o=void 0}=e||{};let l;if(typeof r=="function")l=r;else if(DC(r))l=eq(r);else throw new Error(ic(1));let c;typeof n=="function"?c=n(t):c=t();let u=ow;i&&(u=kbe({trace:!1,...typeof i=="object"&&i}));const d=lbe(...c),f=Cbe(d);let h=typeof o=="function"?o(f):f();const p=u(...h);return ZW(l,s,p)}function gq(e){const t={},r=[];let n;const i={addCase(s,o){const l=typeof s=="string"?s:s.type;if(!l)throw new Error(ic(28));if(l in t)throw new Error(ic(29));return t[l]=o,i},addAsyncThunk(s,o){return o.pending&&(t[s.pending.type]=o.pending),o.rejected&&(t[s.rejected.type]=o.rejected),o.fulfilled&&(t[s.fulfilled.type]=o.fulfilled),o.settled&&r.push({matcher:s.settled,reducer:o.settled}),i},addMatcher(s,o){return r.push({matcher:s,reducer:o}),i},addDefaultCase(s){return n=s,i}};return e(i),[t,r,n]}function Tbe(e){return typeof e=="function"}function Pbe(e,t){let[r,n,i]=gq(t),s;if(Tbe(e))s=()=>lL(e());else{const l=lL(e);s=()=>l}function o(l=s(),c){let u=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[i]),u.reduce((d,f)=>{if(f)if(Qd(d)){const p=f(d,c);return p===void 0?d:p}else{if(wu(d))return dq(d,h=>f(h,c));{const h=f(d,c);if(h===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return h}}return d},l)}return o.getInitialState=s,o}var Obe="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",Mbe=(e=21)=>{let t="",r=e;for(;r--;)t+=Obe[Math.random()*64|0];return t},Lbe=Symbol.for("rtk-slice-createasyncthunk");function Rbe(e,t){return`${e}/${t}`}function Fbe({creators:e}={}){var r;const t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[Lbe];return function(i){const{name:s,reducerPath:o=s}=i;if(!s)throw new Error(ic(11));const l=(typeof i.reducers=="function"?i.reducers(Ibe()):i.reducers)||{},c=Object.keys(l),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(S,j){const k=typeof S=="string"?S:S.type;if(!k)throw new Error(ic(12));if(k in u.sliceCaseReducersByType)throw new Error(ic(13));return u.sliceCaseReducersByType[k]=j,d},addMatcher(S,j){return u.sliceMatchers.push({matcher:S,reducer:j}),d},exposeAction(S,j){return u.actionCreators[S]=j,d},exposeCaseReducer(S,j){return u.sliceCaseReducersByName[S]=j,d}};c.forEach(S=>{const j=l[S],k={reducerName:S,type:Rbe(s,S),createNotation:typeof i.reducers=="function"};$be(j)?zbe(k,j,d,t):Dbe(k,j,d)});function f(){const[S={},j=[],k=void 0]=typeof i.extraReducers=="function"?gq(i.extraReducers):[i.extraReducers],A={...S,...u.sliceCaseReducersByType};return Pbe(i.initialState,R=>{for(let M in A)R.addCase(M,A[M]);for(let M of u.sliceMatchers)R.addMatcher(M.matcher,M.reducer);for(let M of j)R.addMatcher(M.matcher,M.reducer);k&&R.addDefaultCase(k)})}const h=S=>S,p=new Map,m=new WeakMap;let g;function y(S,j){return g||(g=f()),g(S,j)}function b(){return g||(g=f()),g.getInitialState()}function v(S,j=!1){function k(R){let M=R[S];return typeof M>"u"&&j&&(M=nv(m,k,b)),M}function A(R=h){const M=nv(p,j,()=>new WeakMap);return nv(M,R,()=>{const B={};for(const[E,P]of Object.entries(i.selectors??{}))B[E]=Bbe(P,R,()=>nv(m,R,b),j);return B})}return{reducerPath:S,getSelectors:A,get selectors(){return A(k)},selectSlice:k}}const w={name:s,reducer:y,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:b,...v(o),injectInto(S,{reducerPath:j,...k}={}){const A=j??o;return S.inject({reducerPath:A,reducer:y},k),{...w,...v(A,!0)}}};return w}}function Bbe(e,t,r,n){function i(s,...o){let l=t(s);return typeof l>"u"&&n&&(l=r()),e(l,...o)}return i.unwrapped=e,i}var Ll=Fbe();function Ibe(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function Dbe({type:e,reducerName:t,createNotation:r},n,i){let s,o;if("reducer"in n){if(r&&!Ube(n))throw new Error(ic(17));s=n.reducer,o=n.prepare}else s=n;i.addCase(e,s).exposeCaseReducer(t,s).exposeAction(t,o?Vc(e,o):Vc(e))}function $be(e){return e._reducerDefinitionType==="asyncThunk"}function Ube(e){return e._reducerDefinitionType==="reducerWithPrepare"}function zbe({type:e,reducerName:t},r,n,i){if(!i)throw new Error(ic(18));const{payloadCreator:s,fulfilled:o,pending:l,rejected:c,settled:u,options:d}=r,f=i(e,s,d);n.exposeAction(t,f),o&&n.addCase(f.fulfilled,o),l&&n.addCase(f.pending,l),c&&n.addCase(f.rejected,c),u&&n.addMatcher(f.settled,u),n.exposeCaseReducer(t,{fulfilled:o||iv,pending:l||iv,rejected:c||iv,settled:u||iv})}function iv(){}var Wbe="task",xq="listener",yq="completed",WC="cancelled",qbe=`task-${WC}`,Hbe=`task-${yq}`,_A=`${xq}-${WC}`,Vbe=`${xq}-${yq}`,t_=class{constructor(e){Mi(this,"name","TaskAbortError");Mi(this,"message");this.code=e,this.message=`${Wbe} ${WC} (reason: ${e})`}},qC=(e,t)=>{if(typeof e!="function")throw new TypeError(ic(32))},pw=()=>{},bq=(e,t=pw)=>(e.catch(t),e),vq=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),d0=e=>{if(e.aborted)throw new t_(e.reason)};function wq(e,t){let r=pw;return new Promise((n,i)=>{const s=()=>i(new t_(e.reason));if(e.aborted){s();return}r=vq(e,s),t.finally(()=>r()).then(n,i)}).finally(()=>{r=pw})}var Gbe=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof t_?"cancelled":"rejected",error:r}}finally{t==null||t()}},mw=e=>t=>bq(wq(e,t).then(r=>(d0(e),r))),Sq=e=>{const t=mw(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:_m}=Object,uL={},r_="listenerMiddleware",Kbe=(e,t)=>{const r=n=>vq(e,()=>n.abort(e.reason));return(n,i)=>{qC(n);const s=new AbortController;r(s);const o=Gbe(async()=>{d0(e),d0(s.signal);const l=await n({pause:mw(s.signal),delay:Sq(s.signal),signal:s.signal});return d0(s.signal),l},()=>s.abort(Hbe));return i!=null&&i.autoJoin&&t.push(o.catch(pw)),{result:mw(e)(o),cancel(){s.abort(qbe)}}}},Ybe=(e,t)=>{const r=async(n,i)=>{d0(t);let s=()=>{};const l=[new Promise((c,u)=>{let d=e({predicate:n,effect:(f,h)=>{h.unsubscribe(),c([f,h.getState(),h.getOriginalState()])}});s=()=>{d(),u()}})];i!=null&&l.push(new Promise(c=>setTimeout(c,i,null)));try{const c=await wq(t,Promise.race(l));return d0(t),c}finally{s()}};return(n,i)=>bq(r(n,i))},_q=e=>{let{type:t,actionCreator:r,matcher:n,predicate:i,effect:s}=e;if(t)i=Vc(t).match;else if(r)t=r.type,i=r.match;else if(n)i=n;else if(!i)throw new Error(ic(21));return qC(s),{predicate:i,type:t,effect:s}},jq=_m(e=>{const{type:t,predicate:r,effect:n}=_q(e);return{id:Mbe(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(ic(22))}}},{withTypes:()=>jq}),dL=(e,t)=>{const{type:r,effect:n,predicate:i}=_q(t);return Array.from(e.values()).find(s=>(typeof r=="string"?s.type===r:s.predicate===i)&&s.effect===n)},jA=e=>{e.pending.forEach(t=>{t.abort(_A)})},Xbe=(e,t)=>()=>{for(const r of t.keys())jA(r);e.clear()},fL=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},kq=_m(Vc(`${r_}/add`),{withTypes:()=>kq}),Qbe=Vc(`${r_}/removeAll`),Aq=_m(Vc(`${r_}/remove`),{withTypes:()=>Aq}),Jbe=(...e)=>{console.error(`${r_}/error`,...e)},my=(e={})=>{const t=new Map,r=new Map,n=p=>{const m=r.get(p)??0;r.set(p,m+1)},i=p=>{const m=r.get(p)??1;m===1?r.delete(p):r.set(p,m-1)},{extra:s,onError:o=Jbe}=e;qC(o);const l=p=>(p.unsubscribe=()=>t.delete(p.id),t.set(p.id,p),m=>{p.unsubscribe(),m!=null&&m.cancelActive&&jA(p)}),c=p=>{const m=dL(t,p)??jq(p);return l(m)};_m(c,{withTypes:()=>c});const u=p=>{const m=dL(t,p);return m&&(m.unsubscribe(),p.cancelActive&&jA(m)),!!m};_m(u,{withTypes:()=>u});const d=async(p,m,g,y)=>{const b=new AbortController,v=Ybe(c,b.signal),w=[];try{p.pending.add(b),n(p),await Promise.resolve(p.effect(m,_m({},g,{getOriginalState:y,condition:(S,j)=>v(S,j).then(Boolean),take:v,delay:Sq(b.signal),pause:mw(b.signal),extra:s,signal:b.signal,fork:Kbe(b.signal,w),unsubscribe:p.unsubscribe,subscribe:()=>{t.set(p.id,p)},cancelActiveListeners:()=>{p.pending.forEach((S,j,k)=>{S!==b&&(S.abort(_A),k.delete(S))})},cancel:()=>{b.abort(_A),p.pending.delete(b)},throwIfCancelled:()=>{d0(b.signal)}})))}catch(S){S instanceof t_||fL(o,S,{raisedBy:"effect"})}finally{await Promise.all(w),b.abort(Vbe),i(p),p.pending.delete(b)}},f=Xbe(t,r);return{middleware:p=>m=>g=>{if(!tq(g))return m(g);if(kq.match(g))return c(g.payload);if(Qbe.match(g)){f();return}if(Aq.match(g))return u(g.payload);let y=p.getState();const b=()=>{if(y===uL)throw new Error(ic(23));return y};let v;try{if(v=m(g),t.size>0){const w=p.getState(),S=Array.from(t.values());for(const j of S){let k=!1;try{k=j.predicate(g,w,y)}catch(A){k=!1,fL(o,A,{raisedBy:"predicate"})}k&&d(j,g,p,b)}}}finally{y=uL}return v},startListening:c,stopListening:u,clearListeners:f}};function ic(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Zbe={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},Nq=Ll({name:"chartLayout",initialState:Zbe,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,i,s;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(i=t.payload.bottom)!==null&&i!==void 0?i:0,e.margin.left=(s=t.payload.left)!==null&&s!==void 0?s:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:eve,setLayout:tve,setChartSize:rve,setScale:nve}=Nq.actions,ive=Nq.reducer;function Cq(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function pi(e){return Number.isFinite(e)}function id(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function hL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function nm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hL(Object(r),!0).forEach(function(n){ave(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ave(e,t,r){return(t=sve(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sve(e){var t=ove(e,"string");return typeof t=="symbol"?t:t+""}function ove(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ti(e,t,r){return Qi(e)||Qi(t)?r:Hc(t)?O0(e,t,r):typeof t=="function"?t(e):r}var lve=(e,t,r)=>{if(t&&r){var{width:n,height:i}=r,{align:s,verticalAlign:o,layout:l}=t;if((l==="vertical"||l==="horizontal"&&o==="middle")&&s!=="center"&&En(e[s]))return nm(nm({},e),{},{[s]:e[s]+(n||0)});if((l==="horizontal"||l==="vertical"&&s==="center")&&o!=="middle"&&En(e[o]))return nm(nm({},e),{},{[o]:e[o]+(i||0)})}return e},hf=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",Eq=(e,t,r,n)=>{if(n)return e.map(l=>l.coordinate);var i,s,o=e.map(l=>(l.coordinate===t&&(i=!0),l.coordinate===r&&(s=!0),l.coordinate));return i||o.push(t),s||o.push(r),o},Tq=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:i,range:s,scale:o,realScaleType:l,isCategorical:c,categoricalDomain:u,tickCount:d,ticks:f,niceTicks:h,axisType:p}=e;if(!o)return null;var m=l==="scaleBand"&&o.bandwidth?o.bandwidth()/2:2,g=i==="category"&&o.bandwidth?o.bandwidth()/m:0;if(g=p==="angleAxis"&&s&&s.length>=2?Qs(s[0]-s[1])*2*g:g,f||h){var y=(f||h||[]).map((b,v)=>{var w=n?n.indexOf(b):b,S=o.map(w);return pi(S)?{coordinate:S+g,value:b,offset:g,index:v}:null}).filter(_l);return y}return c&&u?u.map((b,v)=>{var w=o.map(b);return pi(w)?{coordinate:w+g,value:b,index:v,offset:g}:null}).filter(_l):o.ticks&&d!=null?o.ticks(d).map((b,v)=>{var w=o.map(b);return pi(w)?{coordinate:w+g,value:b,index:v,offset:g}:null}).filter(_l):o.domain().map((b,v)=>{var w=o.map(b);return pi(w)?{coordinate:w+g,value:n?n[b]:b,index:v,offset:g}:null}).filter(_l)},cve=(e,t)=>{if(!t||t.length!==2||!En(t[0])||!En(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),i=[e[0],e[1]];return(!En(e[0])||e[0]<r)&&(i[0]=r),(!En(e[1])||e[1]>n)&&(i[1]=n),i[0]>n&&(i[0]=n),i[1]<r&&(i[1]=r),i},uve=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var i=0;i<n;++i)for(var s=0,o=0,l=0;l<r;++l){var c=e[l],u=c==null?void 0:c[i];if(u!=null){var d=u[1],f=u[0],h=nd(d)?f:d;h>=0?(u[0]=s,s+=h,u[1]=s):(u[0]=o,o+=h,u[1]=o)}}}},dve=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var i=0;i<n;++i)for(var s=0,o=0;o<r;++o){var l=e[o],c=l==null?void 0:l[i];if(c!=null){var u=nd(c[1])?c[0]:c[1];u>=0?(c[0]=s,s+=u,c[1]=s):(c[0]=0,c[1]=0)}}}},fve={sign:uve,expand:q1e,none:P0,silhouette:H1e,wiggle:V1e,positive:dve},hve=(e,t,r)=>{var n,i=(n=fve[r])!==null&&n!==void 0?n:P0,s=W1e().keys(t).value((l,c)=>Number(Ti(l,c,0))).order(hA).offset(i),o=s(e);return o.forEach((l,c)=>{l.forEach((u,d)=>{var f=Ti(e[d],t[c],0);Array.isArray(f)&&f.length===2&&En(f[0])&&En(f[1])&&(u[0]=f[0],u[1]=f[1])})}),o};function pve(e){return e==null?void 0:String(e)}function gw(e){var{axis:t,ticks:r,bandSize:n,entry:i,index:s,dataKey:o}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Qi(i[t.dataKey])){var l=bW(r,"value",i[t.dataKey]);if(l)return l.coordinate+n/2}return r!=null&&r[s]?r[s].coordinate+n/2:null}var c=Ti(i,Qi(o)?t.dataKey:o),u=t.scale.map(c);return En(u)?u:null}var pL=e=>{var{axis:t,ticks:r,offset:n,bandSize:i,entry:s,index:o}=e;if(t.type==="category")return r[o]?r[o].coordinate+n:null;var l=Ti(s,t.dataKey,t.scale.domain()[o]);if(Qi(l))return null;var c=t.scale.map(l);return En(c)?c-i/2+n:null},mve=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]);return n<=0&&i>=0?0:i<0?i:n}return r[0]},gve=e=>{var t=e.flat(2).filter(En);return[Math.min(...t),Math.max(...t)]},xve=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],yve=(e,t,r)=>{if(e!=null)return xve(Object.keys(e).reduce((n,i)=>{var s=e[i];if(!s)return n;var{stackedData:o}=s,l=o.reduce((c,u)=>{var d=Cq(u,t,r),f=gve(d);return!pi(f[0])||!pi(f[1])?c:[Math.min(c[0],f[0]),Math.max(c[1],f[1])]},[1/0,-1/0]);return[Math.min(l[0],n[0]),Math.max(l[1],n[1])]},[1/0,-1/0]))},mL=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,gL=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Hm=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var i=GS(t,d=>d.coordinate),s=1/0,o=1,l=i.length;o<l;o++){var c=i[o],u=i[o-1];s=Math.min(((c==null?void 0:c.coordinate)||0)-((u==null?void 0:u.coordinate)||0),s)}return s===1/0?0:s}return r?void 0:0};function xL(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:i,name:s}=e;return nm(nm({},t),{},{dataKey:r,payload:n,value:i,name:s})}function Ch(e,t){if(e)return String(e);if(typeof t=="string")return t}var bve=(e,t)=>{if(t==="horizontal")return e.chartX;if(t==="vertical")return e.chartY},vve=(e,t)=>t==="centric"?e.angle:e.radius,pf=e=>e.layout.width,mf=e=>e.layout.height,wve=e=>e.layout.scale,Pq=e=>e.layout.margin,n_=Qt(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),i_=Qt(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),Oq="data-recharts-item-index",HC="data-recharts-item-id",gy=60;function yL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function av(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yL(Object(r),!0).forEach(function(n){Sve(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Sve(e,t,r){return(t=_ve(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ve(e){var t=jve(e,"string");return typeof t=="symbol"?t:t+""}function jve(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kve=e=>e.brush.height;function Ave(e){var t=i_(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var i=typeof n.width=="number"?n.width:gy;return r+i}return r},0)}function Nve(e){var t=i_(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var i=typeof n.width=="number"?n.width:gy;return r+i}return r},0)}function Cve(e){var t=n_(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function Eve(e){var t=n_(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var Rs=Qt([pf,mf,Pq,kve,Ave,Nve,Cve,Eve,QW,tbe],(e,t,r,n,i,s,o,l,c,u)=>{var d={left:(r.left||0)+i,right:(r.right||0)+s},f={top:(r.top||0)+o,bottom:(r.bottom||0)+l},h=av(av({},f),d),p=h.bottom;h.bottom+=n,h=lve(h,c,u);var m=e-h.left-h.right,g=t-h.top-h.bottom;return av(av({brushBottom:p},h),{},{width:Math.max(m,0),height:Math.max(g,0)})}),Tve=Qt(Rs,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),VC=Qt(pf,mf,(e,t)=>({x:0,y:0,width:e,height:t})),Pve=x.createContext(null),Fs=()=>x.useContext(Pve)!=null,a_=e=>e.brush,s_=Qt([a_,Rs,Pq],(e,t,r)=>({height:e.height,x:En(e.x)?e.x:t.left,y:En(e.y)?e.y:t.top+t.height+t.brushBottom-((r==null?void 0:r.bottom)||0),width:En(e.width)?e.width:t.width})),Mq={},Lq={},Rq={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:i,edges:s}={}){let o,l=null;const c=s!=null&&s.includes("leading"),u=s==null||s.includes("trailing"),d=()=>{l!==null&&(r.apply(o,l),o=void 0,l=null)},f=()=>{u&&d(),g()};let h=null;const p=()=>{h!=null&&clearTimeout(h),h=setTimeout(()=>{h=null,f()},n)},m=()=>{h!==null&&(clearTimeout(h),h=null)},g=()=>{m(),o=void 0,l=null},y=()=>{d()},b=function(...v){if(i!=null&&i.aborted)return;o=this,l=v;const w=h==null;p(),c&&w&&d()};return b.schedule=p,b.cancel=g,b.flush=y,i==null||i.addEventListener("abort",g,{once:!0}),b}e.debounce=t})(Rq);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Rq;function r(n,i=0,s={}){typeof s!="object"&&(s={});const{leading:o=!1,trailing:l=!0,maxWait:c}=s,u=Array(2);o&&(u[0]="leading"),l&&(u[1]="trailing");let d,f=null;const h=t.debounce(function(...g){d=n.apply(this,g),f=null},i,{edges:u}),p=function(...g){return c!=null&&(f===null&&(f=Date.now()),Date.now()-f>=c)?(d=n.apply(this,g),f=Date.now(),h.cancel(),h.schedule(),d):(h.apply(this,g),d)},m=()=>(h.flush(),d);return p.cancel=h.cancel,p.flush=m,p}e.debounce=r})(Lq);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Lq;function r(n,i=0,s={}){const{leading:o=!0,trailing:l=!0}=s;return t.debounce(n,i,{leading:o,maxWait:i,trailing:l})}e.throttle=r})(Mq);var Ove=Mq.throttle;const Mve=sf(Ove);var xw=function(t,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];if(typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var o=0;console.warn(r.replace(/%s/g,()=>i[o++]))}},Xu={width:"100%",height:"100%",debounce:0,minWidth:0,initialDimension:{width:-1,height:-1}},Fq=(e,t,r)=>{var{width:n=Xu.width,height:i=Xu.height,aspect:s,maxHeight:o}=r,l=M0(n)?e:Number(n),c=M0(i)?t:Number(i);return s&&s>0&&(l?c=l/s:c&&(l=c*s),o&&c!=null&&c>o&&(c=o)),{calculatedWidth:l,calculatedHeight:c}},Lve={width:0,height:0,overflow:"visible"},Rve={width:0,overflowX:"visible"},Fve={height:0,overflowY:"visible"},Bve={},Ive=e=>{var{width:t,height:r}=e,n=M0(t),i=M0(r);return n&&i?Lve:n?Rve:i?Fve:Bve};function Dve(e){var{width:t,height:r,aspect:n}=e,i=t,s=r;return i===void 0&&s===void 0?(i=Xu.width,s=Xu.height):i===void 0?i=n&&n>0?void 0:Xu.width:s===void 0&&(s=n&&n>0?void 0:Xu.height),{width:i,height:s}}function kA(){return kA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kA.apply(null,arguments)}function bL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function vL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bL(Object(r),!0).forEach(function(n){$ve(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $ve(e,t,r){return(t=Uve(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Uve(e){var t=zve(e,"string");return typeof t=="symbol"?t:t+""}function zve(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bq=x.createContext(Xu.initialDimension);function Wve(e){return id(e.width)&&id(e.height)}function Iq(e){var{children:t,width:r,height:n}=e,i=x.useMemo(()=>({width:r,height:n}),[r,n]);return Wve(i)?x.createElement(Bq.Provider,{value:i},t):null}var GC=()=>x.useContext(Bq),qve=x.forwardRef((e,t)=>{var{aspect:r,initialDimension:n=Xu.initialDimension,width:i,height:s,minWidth:o=Xu.minWidth,minHeight:l,maxHeight:c,children:u,debounce:d=Xu.debounce,id:f,className:h,onResize:p,style:m={}}=e,g=x.useRef(null),y=x.useRef();y.current=p,x.useImperativeHandle(t,()=>g.current);var[b,v]=x.useState({containerWidth:n.width,containerHeight:n.height}),w=x.useCallback((R,M)=>{v(B=>{var E=Math.round(R),P=Math.round(M);return B.containerWidth===E&&B.containerHeight===P?B:{containerWidth:E,containerHeight:P}})},[]);x.useEffect(()=>{if(g.current==null||typeof ResizeObserver>"u")return ap;var R=P=>{var U,G=P[0];if(G!=null){var{width:H,height:oe}=G.contentRect;w(H,oe),(U=y.current)===null||U===void 0||U.call(y,H,oe)}};d>0&&(R=Mve(R,d,{trailing:!0,leading:!1}));var M=new ResizeObserver(R),{width:B,height:E}=g.current.getBoundingClientRect();return w(B,E),M.observe(g.current),()=>{M.disconnect()}},[w,d]);var{containerWidth:S,containerHeight:j}=b;xw(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:k,calculatedHeight:A}=Fq(S,j,{width:i,height:s,aspect:r,maxHeight:c});return xw(k!=null&&k>0||A!=null&&A>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,k,A,i,s,o,l,r),x.createElement("div",{id:f?"".concat(f):void 0,className:_i("recharts-responsive-container",h),style:vL(vL({},m),{},{width:i,height:s,minWidth:o,minHeight:l,maxHeight:c}),ref:g},x.createElement("div",{style:Ive({width:i,height:s})},x.createElement(Iq,{width:k,height:A},u)))}),xy=x.forwardRef((e,t)=>{var r=GC();if(id(r.width)&&id(r.height))return e.children;var{width:n,height:i}=Dve({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:s,calculatedHeight:o}=Fq(void 0,void 0,{width:n,height:i,aspect:e.aspect,maxHeight:e.maxHeight});return En(s)&&En(o)?x.createElement(Iq,{width:s,height:o},e.children):x.createElement(qve,kA({},e,{width:n,height:i,ref:t}))});function KC(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var pg=()=>{var e,t=Fs(),r=jn(Tve),n=jn(s_),i=(e=jn(a_))===null||e===void 0?void 0:e.padding;return!t||!n||!i?r:{width:n.width-i.left-i.right,height:n.height-i.top-i.bottom,x:i.left,y:i.top}},Hve={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},Dq=()=>{var e;return(e=jn(Rs))!==null&&e!==void 0?e:Hve},YC=()=>jn(pf),XC=()=>jn(mf),Vve=()=>jn(e=>e.layout.margin),Oi=e=>e.layout.layoutType,sp=()=>jn(Oi),$q=()=>{var e=sp();if(e==="horizontal"||e==="vertical")return e},Uq=e=>{var t=e.layout.layoutType;if(t==="centric"||t==="radial")return t},Gve=()=>{var e=sp();return e!==void 0},yy=e=>{var t=Zi(),r=Fs(),{width:n,height:i}=e,s=GC(),o=n,l=i;return s&&(o=s.width>0?s.width:n,l=s.height>0?s.height:i),x.useEffect(()=>{!r&&id(o)&&id(l)&&t(rve({width:o,height:l}))},[t,r,o,l]),null},zq=Symbol.for("immer-nothing"),wL=Symbol.for("immer-draftable"),uc=Symbol.for("immer-state");function cu(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var E1=Object.getPrototypeOf;function Vm(e){return!!e&&!!e[uc]}function R0(e){var t;return e?Wq(e)||Array.isArray(e)||!!e[wL]||!!((t=e.constructor)!=null&&t[wL])||by(e)||l_(e):!1}var Kve=Object.prototype.constructor.toString(),SL=new WeakMap;function Wq(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=SL.get(r);return n===void 0&&(n=Function.toString.call(r),SL.set(r,n)),n===Kve}function yw(e,t,r=!0){o_(e)===0?(r?Reflect.ownKeys(e):Object.keys(e)).forEach(i=>{t(i,e[i],e)}):e.forEach((n,i)=>t(i,n,e))}function o_(e){const t=e[uc];return t?t.type_:Array.isArray(e)?1:by(e)?2:l_(e)?3:0}function AA(e,t){return o_(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function qq(e,t,r){const n=o_(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function Yve(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function by(e){return e instanceof Map}function l_(e){return e instanceof Set}function zh(e){return e.copy_||e.base_}function NA(e,t){if(by(e))return new Map(e);if(l_(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=Wq(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[uc];let i=Reflect.ownKeys(n);for(let s=0;s<i.length;s++){const o=i[s],l=n[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[o]})}return Object.create(E1(e),n)}else{const n=E1(e);if(n!==null&&r)return{...e};const i=Object.create(n);return Object.assign(i,e)}}function QC(e,t=!1){return c_(e)||Vm(e)||!R0(e)||(o_(e)>1&&Object.defineProperties(e,{set:sv,add:sv,clear:sv,delete:sv}),Object.freeze(e),t&&Object.values(e).forEach(r=>QC(r,!0))),e}function Xve(){cu(2)}var sv={value:Xve};function c_(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var Qve={};function F0(e){const t=Qve[e];return t||cu(0,e),t}var T1;function Hq(){return T1}function Jve(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function _L(e,t){t&&(F0("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function CA(e){EA(e),e.drafts_.forEach(Zve),e.drafts_=null}function EA(e){e===T1&&(T1=e.parent_)}function jL(e){return T1=Jve(T1,e)}function Zve(e){const t=e[uc];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function kL(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[uc].modified_&&(CA(t),cu(4)),R0(e)&&(e=bw(t,e),t.parent_||vw(t,e)),t.patches_&&F0("Patches").generateReplacementPatches_(r[uc].base_,e,t.patches_,t.inversePatches_)):e=bw(t,r,[]),CA(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==zq?e:void 0}function bw(e,t,r){if(c_(t))return t;const n=e.immer_.shouldUseStrictIteration(),i=t[uc];if(!i)return yw(t,(s,o)=>AL(e,i,t,s,o,r),n),t;if(i.scope_!==e)return t;if(!i.modified_)return vw(e,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const s=i.copy_;let o=s,l=!1;i.type_===3&&(o=new Set(s),s.clear(),l=!0),yw(o,(c,u)=>AL(e,i,s,c,u,r,l),n),vw(e,s,!1),r&&e.patches_&&F0("Patches").generatePatches_(i,r,e.patches_,e.inversePatches_)}return i.copy_}function AL(e,t,r,n,i,s,o){if(i==null||typeof i!="object"&&!o)return;const l=c_(i);if(!(l&&!o)){if(Vm(i)){const c=s&&t&&t.type_!==3&&!AA(t.assigned_,n)?s.concat(n):void 0,u=bw(e,i,c);if(qq(r,n,u),Vm(u))e.canAutoFreeze_=!1;else return}else o&&r.add(i);if(R0(i)&&!l){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[n]===i&&l)return;bw(e,i),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(by(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&vw(e,i)}}}function vw(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&QC(t,r)}function e2e(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:Hq(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,s=JC;r&&(i=[n],s=P1);const{revoke:o,proxy:l}=Proxy.revocable(i,s);return n.draft_=l,n.revoke_=o,l}var JC={get(e,t){if(t===uc)return e;const r=zh(e);if(!AA(r,t))return t2e(e,r,t);const n=r[t];return e.finalized_||!R0(n)?n:n===Kj(e.base_,t)?(Yj(e),e.copy_[t]=PA(n,e)):n},has(e,t){return t in zh(e)},ownKeys(e){return Reflect.ownKeys(zh(e))},set(e,t,r){const n=Vq(zh(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const i=Kj(zh(e),t),s=i==null?void 0:i[uc];if(s&&s.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(Yve(r,i)&&(r!==void 0||AA(e.base_,t)))return!0;Yj(e),TA(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Kj(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Yj(e),TA(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=zh(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){cu(11)},getPrototypeOf(e){return E1(e.base_)},setPrototypeOf(){cu(12)}},P1={};yw(JC,(e,t)=>{P1[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});P1.deleteProperty=function(e,t){return P1.set.call(this,e,t,void 0)};P1.set=function(e,t,r){return JC.set.call(this,e[0],t,r,e[0])};function Kj(e,t){const r=e[uc];return(r?zh(r):e)[t]}function t2e(e,t,r){var i;const n=Vq(t,r);return n?"value"in n?n.value:(i=n.get)==null?void 0:i.call(e.draft_):void 0}function Vq(e,t){if(!(t in e))return;let r=E1(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=E1(r)}}function TA(e){e.modified_||(e.modified_=!0,e.parent_&&TA(e.parent_))}function Yj(e){e.copy_||(e.copy_=NA(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var r2e=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const s=r;r=t;const o=this;return function(c=s,...u){return o.produce(c,d=>r.call(this,d,...u))}}typeof r!="function"&&cu(6),n!==void 0&&typeof n!="function"&&cu(7);let i;if(R0(t)){const s=jL(this),o=PA(t,void 0);let l=!0;try{i=r(o),l=!1}finally{l?CA(s):EA(s)}return _L(s,n),kL(i,s)}else if(!t||typeof t!="object"){if(i=r(t),i===void 0&&(i=t),i===zq&&(i=void 0),this.autoFreeze_&&QC(i,!0),n){const s=[],o=[];F0("Patches").generateReplacementPatches_(t,i,s,o),n(s,o)}return i}else cu(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(o,...l)=>this.produceWithPatches(o,c=>t(c,...l));let n,i;return[this.produce(t,r,(o,l)=>{n=o,i=l}),n,i]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof(e==null?void 0:e.useStrictIteration)=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){R0(e)||cu(8),Vm(e)&&(e=n2e(e));const t=jL(this),r=PA(e,void 0);return r[uc].isManual_=!0,EA(t),r}finishDraft(e,t){const r=e&&e[uc];(!r||!r.isManual_)&&cu(9);const{scope_:n}=r;return _L(n,t),kL(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const i=t[r];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}r>-1&&(t=t.slice(r+1));const n=F0("Patches").applyPatches_;return Vm(e)?n(e,t):this.produce(e,i=>n(i,t))}};function PA(e,t){const r=by(e)?F0("MapSet").proxyMap_(e,t):l_(e)?F0("MapSet").proxySet_(e,t):e2e(e,t);return(t?t.scope_:Hq()).drafts_.push(r),r}function n2e(e){return Vm(e)||cu(10,e),Gq(e)}function Gq(e){if(!R0(e)||c_(e))return e;const t=e[uc];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=NA(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=NA(e,!0);return yw(r,(i,s)=>{qq(r,i,Gq(s))},n),t&&(t.finalized_=!1),r}var i2e=new r2e;i2e.produce;var a2e={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},Kq=Ll({name:"legend",initialState:a2e,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:wa()},replaceLegendPayload:{reducer(e,t){var{prev:r,next:n}=t.payload,i=xu(e).payload.indexOf(r);i>-1&&(e.payload[i]=n)},prepare:wa()},removeLegendPayload:{reducer(e,t){var r=xu(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)},prepare:wa()}}}),{setLegendSize:NL,setLegendSettings:s2e,addLegendPayload:Yq,replaceLegendPayload:Xq,removeLegendPayload:Qq}=Kq.actions,o2e=Kq.reducer,l2e=["contextPayload"];function OA(){return OA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},OA.apply(null,arguments)}function CL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Gm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CL(Object(r),!0).forEach(function(n){c2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function c2e(e,t,r){return(t=u2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u2e(e){var t=d2e(e,"string");return typeof t=="symbol"?t:t+""}function d2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function f2e(e,t){if(e==null)return{};var r,n,i=h2e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function h2e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function p2e(e){return e.value}function m2e(e){var{contextPayload:t}=e,r=f2e(e,l2e),n=$W(t,e.payloadUniqBy,p2e),i=Gm(Gm({},r),{},{payload:n});return x.isValidElement(e.content)?x.cloneElement(e.content,i):typeof e.content=="function"?x.createElement(e.content,i):x.createElement(vye,i)}function g2e(e,t,r,n,i,s){var{layout:o,align:l,verticalAlign:c}=t,u,d;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(l==="center"&&o==="vertical"?u={left:((n||0)-s.width)/2}:u=l==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(c==="middle"?d={top:((i||0)-s.height)/2}:d=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),Gm(Gm({},u),d)}function x2e(e){var t=Zi();return x.useEffect(()=>{t(s2e(e))},[t,e]),null}function y2e(e){var t=Zi();return x.useEffect(()=>(t(NL(e)),()=>{t(NL({width:0,height:0}))}),[t,e]),null}function b2e(e,t,r,n){return e==="vertical"&&t!=null?{height:t}:e==="horizontal"?{width:r||n}:null}var v2e={align:"center",iconSize:14,inactiveColor:"#ccc",itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function ZC(e){var t=ka(e,v2e),r=ibe(),n=h1e(),i=Vve(),{width:s,height:o,wrapperStyle:l,portal:c}=t,[u,d]=JW([r]),f=YC(),h=XC();if(f==null||h==null)return null;var p=f-((i==null?void 0:i.left)||0)-((i==null?void 0:i.right)||0),m=b2e(t.layout,o,s,p),g=c?l:Gm(Gm({position:"absolute",width:(m==null?void 0:m.width)||s||"auto",height:(m==null?void 0:m.height)||o||"auto"},g2e(l,t,i,f,h,u)),l),y=c??n;if(y==null||r==null)return null;var b=x.createElement("div",{className:"recharts-legend-wrapper",style:g,ref:d},x.createElement(x2e,{layout:t.layout,align:t.align,verticalAlign:t.verticalAlign,itemSorter:t.itemSorter}),!c&&x.createElement(y2e,{width:u.width,height:u.height}),x.createElement(m2e,OA({},t,m,{margin:i,chartWidth:f,chartHeight:h,contextPayload:r})));return Y1.createPortal(b,y)}ZC.displayName="Legend";function MA(){return MA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},MA.apply(null,arguments)}function EL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Kg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EL(Object(r),!0).forEach(function(n){w2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function w2e(e,t,r){return(t=S2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S2e(e){var t=_2e(e,"string");return typeof t=="symbol"?t:t+""}function _2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function j2e(e){return Array.isArray(e)&&Hc(e[0])&&Hc(e[1])?e.join(" ~ "):e}var Cp={separator:" : ",contentStyle:{margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},itemStyle:{display:"block",paddingTop:4,paddingBottom:4,color:"#000"},labelStyle:{},accessibilityLayer:!1},k2e=e=>{var{separator:t=Cp.separator,contentStyle:r,itemStyle:n,labelStyle:i=Cp.labelStyle,payload:s,formatter:o,itemSorter:l,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:f,accessibilityLayer:h=Cp.accessibilityLayer}=e,p=()=>{if(s&&s.length){var j={padding:0,margin:0},k=(l?GS(s,l):s).map((A,R)=>{if(A.type==="none")return null;var M=A.formatter||o||j2e,{value:B,name:E}=A,P=B,U=E;if(M){var G=M(B,E,A,R,s);if(Array.isArray(G))[P,U]=G;else if(G!=null)P=G;else return null}var H=Kg(Kg({},Cp.itemStyle),{},{color:A.color||Cp.itemStyle.color},n);return x.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(R),style:H},Hc(U)?x.createElement("span",{className:"recharts-tooltip-item-name"},U):null,Hc(U)?x.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,x.createElement("span",{className:"recharts-tooltip-item-value"},P),x.createElement("span",{className:"recharts-tooltip-item-unit"},A.unit||""))});return x.createElement("ul",{className:"recharts-tooltip-item-list",style:j},k)}return null},m=Kg(Kg({},Cp.contentStyle),r),g=Kg({margin:0},i),y=!Qi(d),b=y?d:"",v=_i("recharts-default-tooltip",c),w=_i("recharts-tooltip-label",u);y&&f&&s!==void 0&&s!==null&&(b=f(d,s));var S=h?{role:"status","aria-live":"assertive"}:{};return x.createElement("div",MA({className:v,style:m},S),x.createElement("p",{className:w,style:g},x.isValidElement(b)?b:"".concat(b)),p())},Yg="recharts-tooltip-wrapper",A2e={visibility:"hidden"};function N2e(e){var{coordinate:t,translateX:r,translateY:n}=e;return _i(Yg,{["".concat(Yg,"-right")]:En(r)&&t&&En(t.x)&&r>=t.x,["".concat(Yg,"-left")]:En(r)&&t&&En(t.x)&&r<t.x,["".concat(Yg,"-bottom")]:En(n)&&t&&En(t.y)&&n>=t.y,["".concat(Yg,"-top")]:En(n)&&t&&En(t.y)&&n<t.y})}function TL(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offset:i,position:s,reverseDirection:o,tooltipDimension:l,viewBox:c,viewBoxDimension:u}=e;if(s&&En(s[n]))return s[n];var d=r[n]-l-(i>0?i:0),f=r[n]+i;if(t[n])return o[n]?d:f;var h=c[n];if(h==null)return 0;if(o[n]){var p=d,m=h;return p<m?Math.max(f,h):Math.max(d,h)}if(u==null)return 0;var g=f+l,y=h+u;return g>y?Math.max(d,h):Math.max(f,h)}function C2e(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function E2e(e){var{allowEscapeViewBox:t,coordinate:r,offsetTop:n,offsetLeft:i,position:s,reverseDirection:o,tooltipBox:l,useTranslate3d:c,viewBox:u}=e,d,f,h;return l.height>0&&l.width>0&&r?(f=TL({allowEscapeViewBox:t,coordinate:r,key:"x",offset:i,position:s,reverseDirection:o,tooltipDimension:l.width,viewBox:u,viewBoxDimension:u.width}),h=TL({allowEscapeViewBox:t,coordinate:r,key:"y",offset:n,position:s,reverseDirection:o,tooltipDimension:l.height,viewBox:u,viewBoxDimension:u.height}),d=C2e({translateX:f,translateY:h,useTranslate3d:c})):d=A2e,{cssProperties:d,cssClasses:N2e({translateX:f,translateY:h,coordinate:r})}}function PL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ov(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PL(Object(r),!0).forEach(function(n){LA(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LA(e,t,r){return(t=T2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T2e(e){var t=P2e(e,"string");return typeof t=="symbol"?t:t+""}function P2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class O2e extends x.PureComponent{constructor(){super(...arguments),LA(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),LA(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,i,s;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(i=(s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==null&&i!==void 0?i:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:i,children:s,coordinate:o,hasPayload:l,isAnimationActive:c,offset:u,position:d,reverseDirection:f,useTranslate3d:h,viewBox:p,wrapperStyle:m,lastBoundingBox:g,innerRef:y,hasPortalFromProps:b}=this.props,v=typeof u=="number"?u:u.x,w=typeof u=="number"?u:u.y,{cssClasses:S,cssProperties:j}=E2e({allowEscapeViewBox:r,coordinate:o,offsetLeft:v,offsetTop:w,position:d,reverseDirection:f,tooltipBox:{height:g.height,width:g.width},useTranslate3d:h,viewBox:p}),k=b?{}:ov(ov({transition:c&&t?"transform ".concat(n,"ms ").concat(i):void 0},j),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&l?"visible":"hidden",position:"absolute",top:0,left:0}),A=ov(ov({},k),{},{visibility:!this.state.dismissed&&t&&l?"visible":"hidden"},m);return x.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:S,style:A,ref:y},s)}}var Jq=()=>{var e;return(e=jn(t=>t.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0};function RA(){return RA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},RA.apply(null,arguments)}function OL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ML(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?OL(Object(r),!0).forEach(function(n){M2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):OL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function M2e(e,t,r){return(t=L2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L2e(e){var t=R2e(e,"string");return typeof t=="symbol"?t:t+""}function R2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LL={curveBasisClosed:O1e,curveBasisOpen:M1e,curveBasis:P1e,curveBumpX:x1e,curveBumpY:y1e,curveLinearClosed:L1e,curveLinear:IS,curveMonotoneX:R1e,curveMonotoneY:F1e,curveNatural:B1e,curveStep:I1e,curveStepAfter:$1e,curveStepBefore:D1e},ww=e=>pi(e.x)&&pi(e.y),RL=e=>e.base!=null&&ww(e.base)&&ww(e),Xg=e=>e.x,Qg=e=>e.y,F2e=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(hy(e));if((r==="curveMonotone"||r==="curveBump")&&t){var n=LL["".concat(r).concat(t==="vertical"?"Y":"X")];if(n)return n}return LL[r]||IS},FL={connectNulls:!1,type:"linear"},B2e=e=>{var{type:t=FL.type,points:r=[],baseLine:n,layout:i,connectNulls:s=FL.connectNulls}=e,o=F2e(t,i),l=s?r.filter(ww):r;if(Array.isArray(n)){var c,u=r.map((m,g)=>ML(ML({},m),{},{base:n[g]}));i==="vertical"?c=Zb().y(Qg).x1(Xg).x0(m=>m.base.x):c=Zb().x(Xg).y1(Qg).y0(m=>m.base.y);var d=c.defined(RL).curve(o),f=s?u.filter(RL):u;return d(f)}var h;i==="vertical"&&En(n)?h=Zb().y(Qg).x1(Xg).x0(n):En(n)?h=Zb().x(Xg).y1(Qg).y0(n):h=aW().x(Xg).y(Qg);var p=h.defined(ww).curve(o);return p(l)},u_=e=>{var{className:t,points:r,path:n,pathRef:i}=e,s=sp();if((!r||!r.length)&&!n)return null;var o={type:e.type,points:e.points,baseLine:e.baseLine,layout:e.layout||s,connectNulls:e.connectNulls},l=r&&r.length?B2e(o):n;return x.createElement("path",RA({},cl(e),NC(e),{className:_i("recharts-curve",t),d:l===null?void 0:l,ref:i}))},I2e=["x","y","top","left","width","height","className"];function FA(){return FA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},FA.apply(null,arguments)}function BL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function D2e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BL(Object(r),!0).forEach(function(n){$2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $2e(e,t,r){return(t=U2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U2e(e){var t=z2e(e,"string");return typeof t=="symbol"?t:t+""}function z2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function W2e(e,t){if(e==null)return{};var r,n,i=q2e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function q2e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var H2e=(e,t,r,n,i,s)=>"M".concat(e,",").concat(i,"v").concat(n,"M").concat(s,",").concat(t,"h").concat(r),V2e=e=>{var{x:t=0,y:r=0,top:n=0,left:i=0,width:s=0,height:o=0,className:l}=e,c=W2e(e,I2e),u=D2e({x:t,y:r,top:n,left:i,width:s,height:o},c);return!En(t)||!En(r)||!En(s)||!En(o)||!En(n)||!En(i)?null:x.createElement("path",FA({},Vo(u),{className:_i("recharts-cross",l),d:H2e(t,r,s,o,n,i)}))};function G2e(e,t,r,n){var i=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-i:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-i,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function IL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function DL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IL(Object(r),!0).forEach(function(n){K2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function K2e(e,t,r){return(t=Y2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Y2e(e){var t=X2e(e,"string");return typeof t=="symbol"?t:t+""}function X2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Q2e=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),Zq=(e,t,r)=>e.map(n=>"".concat(Q2e(n)," ").concat(t,"ms ").concat(r)).join(","),J2e=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(i=>n.includes(i))),O1=(e,t)=>Object.keys(t).reduce((r,n)=>DL(DL({},r),{},{[n]:e(n,t[n])}),{});function $L(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ps(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$L(Object(r),!0).forEach(function(n){Z2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$L(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Z2e(e,t,r){return(t=ewe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ewe(e){var t=twe(e,"string");return typeof t=="symbol"?t:t+""}function twe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sw=(e,t,r)=>e+(t-e)*r,BA=e=>{var{from:t,to:r}=e;return t!==r},eH=(e,t,r)=>{var n=O1((i,s)=>{if(BA(s)){var[o,l]=e(s.from,s.to,s.velocity);return Ps(Ps({},s),{},{from:o,velocity:l})}return s},t);return r<1?O1((i,s)=>BA(s)&&n[i]!=null?Ps(Ps({},s),{},{velocity:Sw(s.velocity,n[i].velocity,r),from:Sw(s.from,n[i].from,r)}):s,t):eH(e,n,r-1)};function rwe(e,t,r,n,i,s){var o,l=n.reduce((h,p)=>Ps(Ps({},h),{},{[p]:{from:e[p],velocity:0,to:t[p]}}),{}),c=()=>O1((h,p)=>p.from,l),u=()=>!Object.values(l).filter(BA).length,d=null,f=h=>{o||(o=h);var p=h-o,m=p/r.dt;l=eH(r,l,m),i(Ps(Ps(Ps({},e),t),c())),o=h,u()||(d=s.setTimeout(f))};return()=>(d=s.setTimeout(f),()=>{var h;(h=d)===null||h===void 0||h()})}function nwe(e,t,r,n,i,s,o){var l=null,c=i.reduce((f,h)=>{var p=e[h],m=t[h];return p==null||m==null?f:Ps(Ps({},f),{},{[h]:[p,m]})},{}),u,d=f=>{u||(u=f);var h=(f-u)/n,p=O1((g,y)=>Sw(...y,r(h)),c);if(s(Ps(Ps(Ps({},e),t),p)),h<1)l=o.setTimeout(d);else{var m=O1((g,y)=>Sw(...y,r(1)),c);s(Ps(Ps(Ps({},e),t),m))}};return()=>(l=o.setTimeout(d),()=>{var f;(f=l)===null||f===void 0||f()})}const iwe=(e,t,r,n,i,s)=>{var o=J2e(e,t);return r==null?()=>(i(Ps(Ps({},e),t)),()=>{}):r.isStepper===!0?rwe(e,t,r,o,i,s):nwe(e,t,r,n,o,i,s)};var _w=1e-4,tH=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],rH=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),UL=(e,t)=>r=>{var n=tH(e,t);return rH(n,r)},awe=(e,t)=>r=>{var n=tH(e,t),i=[...n.map((s,o)=>s*o).slice(1),0];return rH(i,r)},swe=e=>{var t,r=e.split("(");if(r.length!==2||r[0]!=="cubic-bezier")return null;var n=(t=r[1])===null||t===void 0||(t=t.split(")")[0])===null||t===void 0?void 0:t.split(",");if(n==null||n.length!==4)return null;var i=n.map(s=>parseFloat(s));return[i[0],i[1],i[2],i[3]]},owe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var i=swe(r[0]);if(i)return i}}return r.length===4?r:[0,0,1,1]},lwe=(e,t,r,n)=>{var i=UL(e,r),s=UL(t,n),o=awe(e,r),l=u=>u>1?1:u<0?0:u,c=u=>{for(var d=u>1?1:u,f=d,h=0;h<8;++h){var p=i(f)-d,m=o(f);if(Math.abs(p-d)<_w||m<_w)return s(f);f=l(f-p/m)}return s(f)};return c.isStepper=!1,c},zL=function(){return lwe(...owe(...arguments))},cwe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:i=17}=t,s=(o,l,c)=>{var u=-(o-l)*r,d=c*n,f=c+(u-d)*i/1e3,h=c*i/1e3+o;return Math.abs(h-l)<_w&&Math.abs(f)<_w?[l,0]:[h,f]};return s.isStepper=!0,s.dt=i,s},uwe=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return zL(e);case"spring":return cwe();default:if(e.split("(")[0]==="cubic-bezier")return zL(e)}return typeof e=="function"?e:null};function dwe(e){var t,r=()=>null,n=!1,i=null,s=o=>{if(!n){if(Array.isArray(o)){if(!o.length)return;var l=o,[c,...u]=l;if(typeof c=="number"){i=e.setTimeout(s.bind(null,u),c);return}s(c),i=e.setTimeout(s.bind(null,u));return}typeof o=="string"&&(t=o,r(t)),typeof o=="object"&&(t=o,r(t)),typeof o=="function"&&o()}};return{stop:()=>{n=!0},start:o=>{n=!1,i&&(i(),i=null),s(o)},subscribe:o=>(r=o,()=>{r=()=>null}),getTimeoutController:()=>e}}class fwe{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),i=null,s=o=>{o-n>=r?t(o):typeof requestAnimationFrame=="function"&&(i=requestAnimationFrame(s))};return i=requestAnimationFrame(s),()=>{i!=null&&cancelAnimationFrame(i)}}}function hwe(){return dwe(new fwe)}var pwe=x.createContext(hwe);function mwe(e,t){var r=x.useContext(pwe);return x.useMemo(()=>t??r(e),[e,t,r])}var gwe=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),d_={isSsr:gwe()},xwe={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},WL={t:0},Xj={t:1};function mg(e){var t=ka(e,xwe),{isActive:r,canBegin:n,duration:i,easing:s,begin:o,onAnimationEnd:l,onAnimationStart:c,children:u}=t,d=r==="auto"?!d_.isSsr:r,f=mwe(t.animationId,t.animationManager),[h,p]=x.useState(d?WL:Xj),m=x.useRef(null);return x.useEffect(()=>{d||p(Xj)},[d]),x.useEffect(()=>{if(!d||!n)return ap;var g=iwe(WL,Xj,uwe(s),i,p,f.getTimeoutController()),y=()=>{m.current=g()};return f.start([c,o,y,i,l]),()=>{f.stop(),m.current&&m.current(),l()}},[d,n,i,s,o,c,l,f]),u(h.t)}function gg(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=x.useRef(k1(t)),n=x.useRef(e);return n.current!==e&&(r.current=k1(t),n.current=e),r.current}var ywe=["radius"],bwe=["radius"],qL,HL,VL,GL,KL,YL,XL,QL,JL,ZL;function e7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function t7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?e7(Object(r),!0).forEach(function(n){vwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):e7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vwe(e,t,r){return(t=wwe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wwe(e){var t=Swe(e,"string");return typeof t=="symbol"?t:t+""}function Swe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jw(){return jw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jw.apply(null,arguments)}function r7(e,t){if(e==null)return{};var r,n,i=_we(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function _we(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Ru(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var n7=(e,t,r,n,i)=>{var s=Yf(r),o=Yf(n),l=Math.min(Math.abs(s)/2,Math.abs(o)/2),c=o>=0?1:-1,u=s>=0?1:-1,d=o>=0&&s>=0||o<0&&s<0?1:0,f;if(l>0&&Array.isArray(i)){for(var h=[0,0,0,0],p=0,m=4;p<m;p++){var g,y=(g=i[p])!==null&&g!==void 0?g:0;h[p]=y>l?l:y}f=za(qL||(qL=Ru(["M",",",""])),e,t+c*h[0]),h[0]>0&&(f+=za(HL||(HL=Ru(["A ",",",",0,0,",",",",",""])),h[0],h[0],d,e+u*h[0],t)),f+=za(VL||(VL=Ru(["L ",",",""])),e+r-u*h[1],t),h[1]>0&&(f+=za(GL||(GL=Ru(["A ",",",",0,0,",`,
        `,",",""])),h[1],h[1],d,e+r,t+c*h[1])),f+=za(KL||(KL=Ru(["L ",",",""])),e+r,t+n-c*h[2]),h[2]>0&&(f+=za(YL||(YL=Ru(["A ",",",",0,0,",`,
        `,",",""])),h[2],h[2],d,e+r-u*h[2],t+n)),f+=za(XL||(XL=Ru(["L ",",",""])),e+u*h[3],t+n),h[3]>0&&(f+=za(QL||(QL=Ru(["A ",",",",0,0,",`,
        `,",",""])),h[3],h[3],d,e,t+n-c*h[3])),f+="Z"}else if(l>0&&i===+i&&i>0){var b=Math.min(l,i);f=za(JL||(JL=Ru(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),e,t+c*b,b,b,d,e+u*b,t,e+r-u*b,t,b,b,d,e+r,t+c*b,e+r,t+n-c*b,b,b,d,e+r-u*b,t+n,e+u*b,t+n,b,b,d,e,t+n-c*b)}else f=za(ZL||(ZL=Ru(["M ",","," h "," v "," h "," Z"])),e,t,r,n,-r);return f},i7={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},nH=e=>{var t=ka(e,i7),r=x.useRef(null),[n,i]=x.useState(-1);x.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var de=r.current.getTotalLength();de&&i(de)}catch{}},[]);var{x:s,y:o,width:l,height:c,radius:u,className:d}=t,{animationEasing:f,animationDuration:h,animationBegin:p,isAnimationActive:m,isUpdateAnimationActive:g}=t,y=x.useRef(l),b=x.useRef(c),v=x.useRef(s),w=x.useRef(o),S=x.useMemo(()=>({x:s,y:o,width:l,height:c,radius:u}),[s,o,l,c,u]),j=gg(S,"rectangle-");if(s!==+s||o!==+o||l!==+l||c!==+c||l===0||c===0)return null;var k=_i("recharts-rectangle",d);if(!g){var A=Vo(t),{radius:R}=A,M=r7(A,ywe);return x.createElement("path",jw({},M,{x:Yf(s),y:Yf(o),width:Yf(l),height:Yf(c),radius:typeof u=="number"?u:void 0,className:k,d:n7(s,o,l,c,u)}))}var B=y.current,E=b.current,P=v.current,U=w.current,G="0px ".concat(n===-1?1:n,"px"),H="".concat(n,"px 0px"),oe=Zq(["strokeDasharray"],h,typeof f=="string"?f:i7.animationEasing);return x.createElement(mg,{animationId:j,key:j,canBegin:n>0,duration:h,easing:f,isActive:g,begin:p},de=>{var W=Xi(B,l,de),V=Xi(E,c,de),ae=Xi(P,s,de),ee=Xi(U,o,de);r.current&&(y.current=W,b.current=V,v.current=ae,w.current=ee);var C;m?de>0?C={transition:oe,strokeDasharray:H}:C={strokeDasharray:G}:C={strokeDasharray:H};var Y=Vo(t),{radius:q}=Y,O=r7(Y,bwe);return x.createElement("path",jw({},O,{radius:typeof u=="number"?u:void 0,className:k,d:n7(ae,ee,W,V,u),ref:r,style:t7(t7({},C),t.style)}))})};function a7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function s7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?a7(Object(r),!0).forEach(function(n){jwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jwe(e,t,r){return(t=kwe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kwe(e){var t=Awe(e,"string");return typeof t=="symbol"?t:t+""}function Awe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kw=Math.PI/180,Nwe=e=>e*180/Math.PI,vs=(e,t,r,n)=>({x:e+Math.cos(-kw*n)*r,y:t+Math.sin(-kw*n)*r}),iH=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},Cwe=(e,t)=>{var{x:r,y:n}=e,{x:i,y:s}=t;return Math.sqrt((r-i)**2+(n-s)**2)},Ewe=(e,t)=>{var{x:r,y:n}=e,{cx:i,cy:s}=t,o=Cwe({x:r,y:n},{x:i,y:s});if(o<=0)return{radius:o,angle:0};var l=(r-i)/o,c=Math.acos(l);return n>s&&(c=2*Math.PI-c),{radius:o,angle:Nwe(c),angleInRadian:c}},Twe=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),i=Math.floor(r/360),s=Math.min(n,i);return{startAngle:t-s*360,endAngle:r-s*360}},Pwe=(e,t)=>{var{startAngle:r,endAngle:n}=t,i=Math.floor(r/360),s=Math.floor(n/360),o=Math.min(i,s);return e+o*360},Owe=(e,t)=>{var{chartX:r,chartY:n}=e,{radius:i,angle:s}=Ewe({x:r,y:n},t),{innerRadius:o,outerRadius:l}=t;if(i<o||i>l||i===0)return null;var{startAngle:c,endAngle:u}=Twe(t),d=s,f;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;f=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;f=d>=u&&d<=c}return f?s7(s7({},t),{},{radius:i,angle:Pwe(d,t)}):null};function aH(e){var{cx:t,cy:r,radius:n,startAngle:i,endAngle:s}=e,o=vs(t,r,n,i),l=vs(t,r,n,s);return{points:[o,l],cx:t,cy:r,radius:n,startAngle:i,endAngle:s}}var o7,l7,c7,u7,d7,f7,h7;function IA(){return IA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},IA.apply(null,arguments)}function Qh(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Mwe=(e,t)=>{var r=Qs(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},lv=e=>{var{cx:t,cy:r,radius:n,angle:i,sign:s,isExternal:o,cornerRadius:l,cornerIsExternal:c}=e,u=l*(o?1:-1)+n,d=Math.asin(l/u)/kw,f=c?i:i+s*d,h=vs(t,r,u,f),p=vs(t,r,n,f),m=c?i-s*d:i,g=vs(t,r,u*Math.cos(d*kw),m);return{center:h,circleTangency:p,lineTangency:g,theta:d}},sH=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:i,startAngle:s,endAngle:o}=e,l=Mwe(s,o),c=s+l,u=vs(t,r,i,s),d=vs(t,r,i,c),f=za(o7||(o7=Qh(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),u.x,u.y,i,i,+(Math.abs(l)>180),+(s>c),d.x,d.y);if(n>0){var h=vs(t,r,n,s),p=vs(t,r,n,c);f+=za(l7||(l7=Qh(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),p.x,p.y,n,n,+(Math.abs(l)>180),+(s<=c),h.x,h.y)}else f+=za(c7||(c7=Qh(["L ",","," Z"])),t,r);return f},Lwe=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:i,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:u}=e,d=Qs(u-c),{circleTangency:f,lineTangency:h,theta:p}=lv({cx:t,cy:r,radius:i,angle:c,sign:d,cornerRadius:s,cornerIsExternal:l}),{circleTangency:m,lineTangency:g,theta:y}=lv({cx:t,cy:r,radius:i,angle:u,sign:-d,cornerRadius:s,cornerIsExternal:l}),b=l?Math.abs(c-u):Math.abs(c-u)-p-y;if(b<0)return o?za(u7||(u7=Qh(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),h.x,h.y,s,s,s*2,s,s,-s*2):sH({cx:t,cy:r,innerRadius:n,outerRadius:i,startAngle:c,endAngle:u});var v=za(d7||(d7=Qh(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),h.x,h.y,s,s,+(d<0),f.x,f.y,i,i,+(b>180),+(d<0),m.x,m.y,s,s,+(d<0),g.x,g.y);if(n>0){var{circleTangency:w,lineTangency:S,theta:j}=lv({cx:t,cy:r,radius:n,angle:c,sign:d,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),{circleTangency:k,lineTangency:A,theta:R}=lv({cx:t,cy:r,radius:n,angle:u,sign:-d,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),M=l?Math.abs(c-u):Math.abs(c-u)-j-R;if(M<0&&s===0)return"".concat(v,"L").concat(t,",").concat(r,"Z");v+=za(f7||(f7=Qh(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),A.x,A.y,s,s,+(d<0),k.x,k.y,n,n,+(M>180),+(d>0),w.x,w.y,s,s,+(d<0),S.x,S.y)}else v+=za(h7||(h7=Qh(["L",",","Z"])),t,r);return v},Rwe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},oH=e=>{var t=ka(e,Rwe),{cx:r,cy:n,innerRadius:i,outerRadius:s,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d,className:f}=t;if(s<i||u===d)return null;var h=_i("recharts-sector",f),p=s-i,m=Wo(o,p,0,!0),g;return m>0&&Math.abs(u-d)<360?g=Lwe({cx:r,cy:n,innerRadius:i,outerRadius:s,cornerRadius:Math.min(m,p/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d}):g=sH({cx:r,cy:n,innerRadius:i,outerRadius:s,startAngle:u,endAngle:d}),x.createElement("path",IA({},Vo(t),{className:h,d:g}))};function Fwe(e,t,r){if(e==="horizontal")return[{x:t.x,y:r.top},{x:t.x,y:r.top+r.height}];if(e==="vertical")return[{x:r.left,y:t.y},{x:r.left+r.width,y:t.y}];if(wW(t)){if(e==="centric"){var{cx:n,cy:i,innerRadius:s,outerRadius:o,angle:l}=t,c=vs(n,i,s,l),u=vs(n,i,o,l);return[{x:c.x,y:c.y},{x:u.x,y:u.y}]}return aH(t)}}var lH={},cH={},uH={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=BC;function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(uH);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=uH;function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(cH);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=IC,r=cH;function n(i,s,o){o&&typeof o!="number"&&t.isIterateeCall(i,s,o)&&(s=o=void 0),i=r.toFinite(i),s===void 0?(s=i,i=0):s=r.toFinite(s),o=o===void 0?i<s?1:-1:r.toFinite(o);const l=Math.max(Math.ceil((s-i)/(o||1)),0),c=new Array(l);for(let u=0;u<l;u++)c[u]=i,i+=o;return c}e.range=n})(lH);var Bwe=lH.range;const dH=sf(Bwe);function oh(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Iwe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function eE(e){let t,r,n;e.length!==2?(t=oh,r=(l,c)=>oh(e(l),c),n=(l,c)=>e(l)-c):(t=e===oh||e===Iwe?e:Dwe,r=e,n=e);function i(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<0?u=f+1:d=f}while(u<d)}return u}function s(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<=0?u=f+1:d=f}while(u<d)}return u}function o(l,c,u=0,d=l.length){const f=i(l,c,u,d-1);return f>u&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:i,center:o,right:s}}function Dwe(){return 0}function fH(e){return e===null?NaN:+e}function*$we(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const Uwe=eE(oh),vy=Uwe.right;eE(fH).center;class p7 extends Map{constructor(t,r=qwe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,i]of t)this.set(n,i)}get(t){return super.get(m7(this,t))}has(t){return super.has(m7(this,t))}set(t,r){return super.set(zwe(this,t),r)}delete(t){return super.delete(Wwe(this,t))}}function m7({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function zwe({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function Wwe({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function qwe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Hwe(e=oh){if(e===oh)return hH;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function hH(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const Vwe=Math.sqrt(50),Gwe=Math.sqrt(10),Kwe=Math.sqrt(2);function Aw(e,t,r){const n=(t-e)/Math.max(0,r),i=Math.floor(Math.log10(n)),s=n/Math.pow(10,i),o=s>=Vwe?10:s>=Gwe?5:s>=Kwe?2:1;let l,c,u;return i<0?(u=Math.pow(10,-i)/o,l=Math.round(e*u),c=Math.round(t*u),l/u<e&&++l,c/u>t&&--c,u=-u):(u=Math.pow(10,i)*o,l=Math.round(e/u),c=Math.round(t/u),l*u<e&&++l,c*u>t&&--c),c<l&&.5<=r&&r<2?Aw(e,t,r*2):[l,c,u]}function DA(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[i,s,o]=n?Aw(t,e,r):Aw(e,t,r);if(!(s>=i))return[];const l=s-i+1,c=new Array(l);if(n)if(o<0)for(let u=0;u<l;++u)c[u]=(s-u)/-o;else for(let u=0;u<l;++u)c[u]=(s-u)*o;else if(o<0)for(let u=0;u<l;++u)c[u]=(i+u)/-o;else for(let u=0;u<l;++u)c[u]=(i+u)*o;return c}function $A(e,t,r){return t=+t,e=+e,r=+r,Aw(e,t,r)[2]}function UA(e,t,r){t=+t,e=+e,r=+r;const n=t<e,i=n?$A(t,e,r):$A(e,t,r);return(n?-1:1)*(i<0?1/-i:i)}function g7(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function x7(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function pH(e,t,r=0,n=1/0,i){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(i=i===void 0?hH:Hwe(i);n>r;){if(n-r>600){const c=n-r+1,u=t-r+1,d=Math.log(c),f=.5*Math.exp(2*d/3),h=.5*Math.sqrt(d*f*(c-f)/c)*(u-c/2<0?-1:1),p=Math.max(r,Math.floor(t-u*f/c+h)),m=Math.min(n,Math.floor(t+(c-u)*f/c+h));pH(e,t,p,m,i)}const s=e[t];let o=r,l=n;for(Jg(e,r,t),i(e[n],s)>0&&Jg(e,r,n);o<l;){for(Jg(e,o,l),++o,--l;i(e[o],s)<0;)++o;for(;i(e[l],s)>0;)--l}i(e[r],s)===0?Jg(e,r,l):(++l,Jg(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function Jg(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function Ywe(e,t,r){if(e=Float64Array.from($we(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return x7(e);if(t>=1)return g7(e);var n,i=(n-1)*t,s=Math.floor(i),o=g7(pH(e,s).subarray(0,s+1)),l=x7(e.subarray(s+1));return o+(l-o)*(i-s)}}function Xwe(e,t,r=fH){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,i=(n-1)*t,s=Math.floor(i),o=+r(e[s],s,e),l=+r(e[s+1],s+1,e);return o+(l-o)*(i-s)}}function Qwe(e,t,r){e=+e,t=+t,r=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((t-e)/r))|0,s=new Array(i);++n<i;)s[n]=e+n*r;return s}function Yc(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function gf(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const zA=Symbol("implicit");function tE(){var e=new p7,t=[],r=[],n=zA;function i(s){let o=e.get(s);if(o===void 0){if(n!==zA)return n;e.set(s,o=t.push(s)-1)}return r[o%r.length]}return i.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new p7;for(const o of s)e.has(o)||e.set(o,t.push(o)-1);return i},i.range=function(s){return arguments.length?(r=Array.from(s),i):r.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return tE(t,r).unknown(n)},Yc.apply(i,arguments),i}function rE(){var e=tE().unknown(void 0),t=e.domain,r=e.range,n=0,i=1,s,o,l=!1,c=0,u=0,d=.5;delete e.unknown;function f(){var h=t().length,p=i<n,m=p?i:n,g=p?n:i;s=(g-m)/Math.max(1,h-c+u*2),l&&(s=Math.floor(s)),m+=(g-m-s*(h-c))*d,o=s*(1-c),l&&(m=Math.round(m),o=Math.round(o));var y=Qwe(h).map(function(b){return m+s*b});return r(p?y.reverse():y)}return e.domain=function(h){return arguments.length?(t(h),f()):t()},e.range=function(h){return arguments.length?([n,i]=h,n=+n,i=+i,f()):[n,i]},e.rangeRound=function(h){return[n,i]=h,n=+n,i=+i,l=!0,f()},e.bandwidth=function(){return o},e.step=function(){return s},e.round=function(h){return arguments.length?(l=!!h,f()):l},e.padding=function(h){return arguments.length?(c=Math.min(1,u=+h),f()):c},e.paddingInner=function(h){return arguments.length?(c=Math.min(1,h),f()):c},e.paddingOuter=function(h){return arguments.length?(u=+h,f()):u},e.align=function(h){return arguments.length?(d=Math.max(0,Math.min(1,h)),f()):d},e.copy=function(){return rE(t(),[n,i]).round(l).paddingInner(c).paddingOuter(u).align(d)},Yc.apply(f(),arguments)}function mH(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return mH(t())},e}function Jwe(){return mH(rE.apply(null,arguments).paddingInner(1))}function nE(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function gH(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function wy(){}var M1=.7,Nw=1/M1,jm="\\s*([+-]?\\d+)\\s*",L1="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",td="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Zwe=/^#([0-9a-f]{3,8})$/,eSe=new RegExp(`^rgb\\(${jm},${jm},${jm}\\)$`),tSe=new RegExp(`^rgb\\(${td},${td},${td}\\)$`),rSe=new RegExp(`^rgba\\(${jm},${jm},${jm},${L1}\\)$`),nSe=new RegExp(`^rgba\\(${td},${td},${td},${L1}\\)$`),iSe=new RegExp(`^hsl\\(${L1},${td},${td}\\)$`),aSe=new RegExp(`^hsla\\(${L1},${td},${td},${L1}\\)$`),y7={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};nE(wy,R1,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:b7,formatHex:b7,formatHex8:sSe,formatHsl:oSe,formatRgb:v7,toString:v7});function b7(){return this.rgb().formatHex()}function sSe(){return this.rgb().formatHex8()}function oSe(){return xH(this).formatHsl()}function v7(){return this.rgb().formatRgb()}function R1(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=Zwe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?w7(t):r===3?new jl(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?cv(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?cv(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=eSe.exec(e))?new jl(t[1],t[2],t[3],1):(t=tSe.exec(e))?new jl(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=rSe.exec(e))?cv(t[1],t[2],t[3],t[4]):(t=nSe.exec(e))?cv(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=iSe.exec(e))?j7(t[1],t[2]/100,t[3]/100,1):(t=aSe.exec(e))?j7(t[1],t[2]/100,t[3]/100,t[4]):y7.hasOwnProperty(e)?w7(y7[e]):e==="transparent"?new jl(NaN,NaN,NaN,0):null}function w7(e){return new jl(e>>16&255,e>>8&255,e&255,1)}function cv(e,t,r,n){return n<=0&&(e=t=r=NaN),new jl(e,t,r,n)}function lSe(e){return e instanceof wy||(e=R1(e)),e?(e=e.rgb(),new jl(e.r,e.g,e.b,e.opacity)):new jl}function WA(e,t,r,n){return arguments.length===1?lSe(e):new jl(e,t,r,n??1)}function jl(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}nE(jl,WA,gH(wy,{brighter(e){return e=e==null?Nw:Math.pow(Nw,e),new jl(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?M1:Math.pow(M1,e),new jl(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new jl(f0(this.r),f0(this.g),f0(this.b),Cw(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:S7,formatHex:S7,formatHex8:cSe,formatRgb:_7,toString:_7}));function S7(){return`#${Jh(this.r)}${Jh(this.g)}${Jh(this.b)}`}function cSe(){return`#${Jh(this.r)}${Jh(this.g)}${Jh(this.b)}${Jh((isNaN(this.opacity)?1:this.opacity)*255)}`}function _7(){const e=Cw(this.opacity);return`${e===1?"rgb(":"rgba("}${f0(this.r)}, ${f0(this.g)}, ${f0(this.b)}${e===1?")":`, ${e})`}`}function Cw(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function f0(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Jh(e){return e=f0(e),(e<16?"0":"")+e.toString(16)}function j7(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new uu(e,t,r,n)}function xH(e){if(e instanceof uu)return new uu(e.h,e.s,e.l,e.opacity);if(e instanceof wy||(e=R1(e)),!e)return new uu;if(e instanceof uu)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),s=Math.max(t,r,n),o=NaN,l=s-i,c=(s+i)/2;return l?(t===s?o=(r-n)/l+(r<n)*6:r===s?o=(n-t)/l+2:o=(t-r)/l+4,l/=c<.5?s+i:2-s-i,o*=60):l=c>0&&c<1?0:o,new uu(o,l,c,e.opacity)}function uSe(e,t,r,n){return arguments.length===1?xH(e):new uu(e,t,r,n??1)}function uu(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}nE(uu,uSe,gH(wy,{brighter(e){return e=e==null?Nw:Math.pow(Nw,e),new uu(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?M1:Math.pow(M1,e),new uu(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new jl(Qj(e>=240?e-240:e+120,i,n),Qj(e,i,n),Qj(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new uu(k7(this.h),uv(this.s),uv(this.l),Cw(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Cw(this.opacity);return`${e===1?"hsl(":"hsla("}${k7(this.h)}, ${uv(this.s)*100}%, ${uv(this.l)*100}%${e===1?")":`, ${e})`}`}}));function k7(e){return e=(e||0)%360,e<0?e+360:e}function uv(e){return Math.max(0,Math.min(1,e||0))}function Qj(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const iE=e=>()=>e;function dSe(e,t){return function(r){return e+r*t}}function fSe(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function hSe(e){return(e=+e)==1?yH:function(t,r){return r-t?fSe(t,r,e):iE(isNaN(t)?r:t)}}function yH(e,t){var r=t-e;return r?dSe(e,r):iE(isNaN(e)?t:e)}const A7=function e(t){var r=hSe(t);function n(i,s){var o=r((i=WA(i)).r,(s=WA(s)).r),l=r(i.g,s.g),c=r(i.b,s.b),u=yH(i.opacity,s.opacity);return function(d){return i.r=o(d),i.g=l(d),i.b=c(d),i.opacity=u(d),i+""}}return n.gamma=e,n}(1);function pSe(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(s){for(i=0;i<r;++i)n[i]=e[i]*(1-s)+t[i]*s;return n}}function mSe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function gSe(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),s=new Array(r),o;for(o=0;o<n;++o)i[o]=xg(e[o],t[o]);for(;o<r;++o)s[o]=t[o];return function(l){for(o=0;o<n;++o)s[o]=i[o](l);return s}}function xSe(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Ew(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function ySe(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=xg(e[i],t[i]):n[i]=t[i];return function(s){for(i in r)n[i]=r[i](s);return n}}var qA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Jj=new RegExp(qA.source,"g");function bSe(e){return function(){return e}}function vSe(e){return function(t){return e(t)+""}}function wSe(e,t){var r=qA.lastIndex=Jj.lastIndex=0,n,i,s,o=-1,l=[],c=[];for(e=e+"",t=t+"";(n=qA.exec(e))&&(i=Jj.exec(t));)(s=i.index)>r&&(s=t.slice(r,s),l[o]?l[o]+=s:l[++o]=s),(n=n[0])===(i=i[0])?l[o]?l[o]+=i:l[++o]=i:(l[++o]=null,c.push({i:o,x:Ew(n,i)})),r=Jj.lastIndex;return r<t.length&&(s=t.slice(r),l[o]?l[o]+=s:l[++o]=s),l.length<2?c[0]?vSe(c[0].x):bSe(t):(t=c.length,function(u){for(var d=0,f;d<t;++d)l[(f=c[d]).i]=f.x(u);return l.join("")})}function xg(e,t){var r=typeof t,n;return t==null||r==="boolean"?iE(t):(r==="number"?Ew:r==="string"?(n=R1(t))?(t=n,A7):wSe:t instanceof R1?A7:t instanceof Date?xSe:mSe(t)?pSe:Array.isArray(t)?gSe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?ySe:Ew)(e,t)}function aE(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function SSe(e,t){t===void 0&&(t=e,e=xg);for(var r=0,n=t.length-1,i=t[0],s=new Array(n<0?0:n);r<n;)s[r]=e(i,i=t[++r]);return function(o){var l=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return s[l](o-l)}}function _Se(e){return function(){return e}}function Tw(e){return+e}var N7=[0,1];function nl(e){return e}function HA(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:_Se(isNaN(t)?NaN:.5)}function jSe(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function kSe(e,t,r){var n=e[0],i=e[1],s=t[0],o=t[1];return i<n?(n=HA(i,n),s=r(o,s)):(n=HA(n,i),s=r(s,o)),function(l){return s(n(l))}}function ASe(e,t,r){var n=Math.min(e.length,t.length)-1,i=new Array(n),s=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)i[o]=HA(e[o],e[o+1]),s[o]=r(t[o],t[o+1]);return function(l){var c=vy(e,l,1,n)-1;return s[c](i[c](l))}}function Sy(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function f_(){var e=N7,t=N7,r=xg,n,i,s,o=nl,l,c,u;function d(){var h=Math.min(e.length,t.length);return o!==nl&&(o=jSe(e[0],e[h-1])),l=h>2?ASe:kSe,c=u=null,f}function f(h){return h==null||isNaN(h=+h)?s:(c||(c=l(e.map(n),t,r)))(n(o(h)))}return f.invert=function(h){return o(i((u||(u=l(t,e.map(n),Ew)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,Tw),d()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),d()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),r=aE,d()},f.clamp=function(h){return arguments.length?(o=h?!0:nl,d()):o!==nl},f.interpolate=function(h){return arguments.length?(r=h,d()):r},f.unknown=function(h){return arguments.length?(s=h,f):s},function(h,p){return n=h,i=p,d()}}function sE(){return f_()(nl,nl)}function NSe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Pw(e,t){if(!isFinite(e)||e===0)return null;var r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"),n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Km(e){return e=Pw(Math.abs(e)),e?e[1]:NaN}function CSe(e,t){return function(r,n){for(var i=r.length,s=[],o=0,l=e[0],c=0;i>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),s.push(r.substring(i-=l,i+l)),!((c+=l+1)>n));)l=e[o=(o+1)%e.length];return s.reverse().join(t)}}function ESe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var TSe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function F1(e){if(!(t=TSe.exec(e)))throw new Error("invalid format: "+e);var t;return new oE({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}F1.prototype=oE.prototype;function oE(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}oE.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function PSe(e){e:for(var t=e.length,r=1,n=-1,i;r<t;++r)switch(e[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(i+1):e}var Ow;function OSe(e,t){var r=Pw(e,t);if(!r)return Ow=void 0,e.toPrecision(t);var n=r[0],i=r[1],s=i-(Ow=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=n.length;return s===o?n:s>o?n+new Array(s-o+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+Pw(e,Math.max(0,t+s-1))[0]}function C7(e,t){var r=Pw(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const E7={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:NSe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>C7(e*100,t),r:C7,s:OSe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function T7(e){return e}var P7=Array.prototype.map,O7=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function MSe(e){var t=e.grouping===void 0||e.thousands===void 0?T7:CSe(P7.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?T7:ESe(P7.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(f,h){f=F1(f);var p=f.fill,m=f.align,g=f.sign,y=f.symbol,b=f.zero,v=f.width,w=f.comma,S=f.precision,j=f.trim,k=f.type;k==="n"?(w=!0,k="g"):E7[k]||(S===void 0&&(S=12),j=!0,k="g"),(b||p==="0"&&m==="=")&&(b=!0,p="0",m="=");var A=(h&&h.prefix!==void 0?h.prefix:"")+(y==="$"?r:y==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():""),R=(y==="$"?n:/[%p]/.test(k)?o:"")+(h&&h.suffix!==void 0?h.suffix:""),M=E7[k],B=/[defgprs%]/.test(k);S=S===void 0?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,S)):Math.max(0,Math.min(20,S));function E(P){var U=A,G=R,H,oe,de;if(k==="c")G=M(P)+G,P="";else{P=+P;var W=P<0||1/P<0;if(P=isNaN(P)?c:M(Math.abs(P),S),j&&(P=PSe(P)),W&&+P==0&&g!=="+"&&(W=!1),U=(W?g==="("?g:l:g==="-"||g==="("?"":g)+U,G=(k==="s"&&!isNaN(P)&&Ow!==void 0?O7[8+Ow/3]:"")+G+(W&&g==="("?")":""),B){for(H=-1,oe=P.length;++H<oe;)if(de=P.charCodeAt(H),48>de||de>57){G=(de===46?i+P.slice(H+1):P.slice(H))+G,P=P.slice(0,H);break}}}w&&!b&&(P=t(P,1/0));var V=U.length+P.length+G.length,ae=V<v?new Array(v-V+1).join(p):"";switch(w&&b&&(P=t(ae+P,ae.length?v-G.length:1/0),ae=""),m){case"<":P=U+P+G+ae;break;case"=":P=U+ae+P+G;break;case"^":P=ae.slice(0,V=ae.length>>1)+U+P+G+ae.slice(V);break;default:P=ae+U+P+G;break}return s(P)}return E.toString=function(){return f+""},E}function d(f,h){var p=Math.max(-8,Math.min(8,Math.floor(Km(h)/3)))*3,m=Math.pow(10,-p),g=u((f=F1(f),f.type="f",f),{suffix:O7[8+p/3]});return function(y){return g(m*y)}}return{format:u,formatPrefix:d}}var dv,lE,bH;LSe({thousands:",",grouping:[3],currency:["$",""]});function LSe(e){return dv=MSe(e),lE=dv.format,bH=dv.formatPrefix,dv}function RSe(e){return Math.max(0,-Km(Math.abs(e)))}function FSe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Km(t)/3)))*3-Km(Math.abs(e)))}function BSe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Km(t)-Km(e))+1}function vH(e,t,r,n){var i=UA(e,t,r),s;switch(n=F1(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(s=FSe(i,o))&&(n.precision=s),bH(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(s=BSe(i,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=s-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(s=RSe(i))&&(n.precision=s-(n.type==="%")*2);break}}return lE(n)}function Eh(e){var t=e.domain;return e.ticks=function(r){var n=t();return DA(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var i=t();return vH(i[0],i[i.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),i=0,s=n.length-1,o=n[i],l=n[s],c,u,d=10;for(l<o&&(u=o,o=l,l=u,u=i,i=s,s=u);d-- >0;){if(u=$A(o,l,r),u===c)return n[i]=o,n[s]=l,t(n);if(u>0)o=Math.floor(o/u)*u,l=Math.ceil(l/u)*u;else if(u<0)o=Math.ceil(o*u)/u,l=Math.floor(l*u)/u;else break;c=u}return e},e}function wH(){var e=sE();return e.copy=function(){return Sy(e,wH())},Yc.apply(e,arguments),Eh(e)}function SH(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Tw),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return SH(e).unknown(t)},e=arguments.length?Array.from(e,Tw):[0,1],Eh(r)}function _H(e,t){e=e.slice();var r=0,n=e.length-1,i=e[r],s=e[n],o;return s<i&&(o=r,r=n,n=o,o=i,i=s,s=o),e[r]=t.floor(i),e[n]=t.ceil(s),e}function M7(e){return Math.log(e)}function L7(e){return Math.exp(e)}function ISe(e){return-Math.log(-e)}function DSe(e){return-Math.exp(-e)}function $Se(e){return isFinite(e)?+("1e"+e):e<0?0:e}function USe(e){return e===10?$Se:e===Math.E?Math.exp:t=>Math.pow(e,t)}function zSe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function R7(e){return(t,r)=>-e(-t,r)}function cE(e){const t=e(M7,L7),r=t.domain;let n=10,i,s;function o(){return i=zSe(n),s=USe(n),r()[0]<0?(i=R7(i),s=R7(s),e(ISe,DSe)):e(M7,L7),t}return t.base=function(l){return arguments.length?(n=+l,o()):n},t.domain=function(l){return arguments.length?(r(l),o()):r()},t.ticks=l=>{const c=r();let u=c[0],d=c[c.length-1];const f=d<u;f&&([u,d]=[d,u]);let h=i(u),p=i(d),m,g;const y=l==null?10:+l;let b=[];if(!(n%1)&&p-h<y){if(h=Math.floor(h),p=Math.ceil(p),u>0){for(;h<=p;++h)for(m=1;m<n;++m)if(g=h<0?m/s(-h):m*s(h),!(g<u)){if(g>d)break;b.push(g)}}else for(;h<=p;++h)for(m=n-1;m>=1;--m)if(g=h>0?m/s(-h):m*s(h),!(g<u)){if(g>d)break;b.push(g)}b.length*2<y&&(b=DA(u,d,y))}else b=DA(h,p,Math.min(p-h,y)).map(s);return f?b.reverse():b},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=F1(c)).precision==null&&(c.trim=!0),c=lE(c)),l===1/0)return c;const u=Math.max(1,n*l/t.ticks().length);return d=>{let f=d/s(Math.round(i(d)));return f*n<n-.5&&(f*=n),f<=u?c(d):""}},t.nice=()=>r(_H(r(),{floor:l=>s(Math.floor(i(l))),ceil:l=>s(Math.ceil(i(l)))})),t}function jH(){const e=cE(f_()).domain([1,10]);return e.copy=()=>Sy(e,jH()).base(e.base()),Yc.apply(e,arguments),e}function F7(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function B7(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function uE(e){var t=1,r=e(F7(t),B7(t));return r.constant=function(n){return arguments.length?e(F7(t=+n),B7(t)):t},Eh(r)}function kH(){var e=uE(f_());return e.copy=function(){return Sy(e,kH()).constant(e.constant())},Yc.apply(e,arguments)}function I7(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function WSe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function qSe(e){return e<0?-e*e:e*e}function dE(e){var t=e(nl,nl),r=1;function n(){return r===1?e(nl,nl):r===.5?e(WSe,qSe):e(I7(r),I7(1/r))}return t.exponent=function(i){return arguments.length?(r=+i,n()):r},Eh(t)}function fE(){var e=dE(f_());return e.copy=function(){return Sy(e,fE()).exponent(e.exponent())},Yc.apply(e,arguments),e}function HSe(){return fE.apply(null,arguments).exponent(.5)}function D7(e){return Math.sign(e)*e*e}function VSe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function AH(){var e=sE(),t=[0,1],r=!1,n;function i(s){var o=VSe(e(s));return isNaN(o)?n:r?Math.round(o):o}return i.invert=function(s){return e.invert(D7(s))},i.domain=function(s){return arguments.length?(e.domain(s),i):e.domain()},i.range=function(s){return arguments.length?(e.range((t=Array.from(s,Tw)).map(D7)),i):t.slice()},i.rangeRound=function(s){return i.range(s).round(!0)},i.round=function(s){return arguments.length?(r=!!s,i):r},i.clamp=function(s){return arguments.length?(e.clamp(s),i):e.clamp()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return AH(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Yc.apply(i,arguments),Eh(i)}function NH(){var e=[],t=[],r=[],n;function i(){var o=0,l=Math.max(1,t.length);for(r=new Array(l-1);++o<l;)r[o-1]=Xwe(e,o/l);return s}function s(o){return o==null||isNaN(o=+o)?n:t[vy(r,o)]}return s.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(oh),i()},s.range=function(o){return arguments.length?(t=Array.from(o),i()):t.slice()},s.unknown=function(o){return arguments.length?(n=o,s):n},s.quantiles=function(){return r.slice()},s.copy=function(){return NH().domain(e).range(t).unknown(n)},Yc.apply(s,arguments)}function CH(){var e=0,t=1,r=1,n=[.5],i=[0,1],s;function o(c){return c!=null&&c<=c?i[vy(n,c,0,r)]:s}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return o}return o.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},o.range=function(c){return arguments.length?(r=(i=Array.from(c)).length-1,l()):i.slice()},o.invertExtent=function(c){var u=i.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},o.unknown=function(c){return arguments.length&&(s=c),o},o.thresholds=function(){return n.slice()},o.copy=function(){return CH().domain([e,t]).range(i).unknown(s)},Yc.apply(Eh(o),arguments)}function EH(){var e=[.5],t=[0,1],r,n=1;function i(s){return s!=null&&s<=s?t[vy(e,s,0,n)]:r}return i.domain=function(s){return arguments.length?(e=Array.from(s),n=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(s){return arguments.length?(t=Array.from(s),n=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return EH().domain(e).range(t).unknown(r)},Yc.apply(i,arguments)}const Zj=new Date,ek=new Date;function Bs(e,t,r,n){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const o=i(s),l=i.ceil(s);return s-o<l-s?o:l},i.offset=(s,o)=>(t(s=new Date(+s),o==null?1:Math.floor(o)),s),i.range=(s,o,l)=>{const c=[];if(s=i.ceil(s),l=l==null?1:Math.floor(l),!(s<o)||!(l>0))return c;let u;do c.push(u=new Date(+s)),t(s,l),e(s);while(u<s&&s<o);return c},i.filter=s=>Bs(o=>{if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!s(o););else for(;--l>=0;)for(;t(o,1),!s(o););}),r&&(i.count=(s,o)=>(Zj.setTime(+s),ek.setTime(+o),e(Zj),e(ek),Math.floor(r(Zj,ek))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(n?o=>n(o)%s===0:o=>i.count(0,o)%s===0):i)),i}const Mw=Bs(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Mw.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Bs(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Mw);Mw.range;const Fd=1e3,Ic=Fd*60,Bd=Ic*60,Jd=Bd*24,hE=Jd*7,$7=Jd*30,tk=Jd*365,Zh=Bs(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Fd)},(e,t)=>(t-e)/Fd,e=>e.getUTCSeconds());Zh.range;const pE=Bs(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Fd)},(e,t)=>{e.setTime(+e+t*Ic)},(e,t)=>(t-e)/Ic,e=>e.getMinutes());pE.range;const mE=Bs(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ic)},(e,t)=>(t-e)/Ic,e=>e.getUTCMinutes());mE.range;const gE=Bs(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Fd-e.getMinutes()*Ic)},(e,t)=>{e.setTime(+e+t*Bd)},(e,t)=>(t-e)/Bd,e=>e.getHours());gE.range;const xE=Bs(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Bd)},(e,t)=>(t-e)/Bd,e=>e.getUTCHours());xE.range;const _y=Bs(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ic)/Jd,e=>e.getDate()-1);_y.range;const h_=Bs(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Jd,e=>e.getUTCDate()-1);h_.range;const TH=Bs(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Jd,e=>Math.floor(e/Jd));TH.range;function op(e){return Bs(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Ic)/hE)}const p_=op(0),Lw=op(1),GSe=op(2),KSe=op(3),Ym=op(4),YSe=op(5),XSe=op(6);p_.range;Lw.range;GSe.range;KSe.range;Ym.range;YSe.range;XSe.range;function lp(e){return Bs(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/hE)}const m_=lp(0),Rw=lp(1),QSe=lp(2),JSe=lp(3),Xm=lp(4),ZSe=lp(5),e_e=lp(6);m_.range;Rw.range;QSe.range;JSe.range;Xm.range;ZSe.range;e_e.range;const yE=Bs(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());yE.range;const bE=Bs(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());bE.range;const Zd=Bs(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Zd.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Bs(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Zd.range;const ef=Bs(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());ef.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Bs(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});ef.range;function PH(e,t,r,n,i,s){const o=[[Zh,1,Fd],[Zh,5,5*Fd],[Zh,15,15*Fd],[Zh,30,30*Fd],[s,1,Ic],[s,5,5*Ic],[s,15,15*Ic],[s,30,30*Ic],[i,1,Bd],[i,3,3*Bd],[i,6,6*Bd],[i,12,12*Bd],[n,1,Jd],[n,2,2*Jd],[r,1,hE],[t,1,$7],[t,3,3*$7],[e,1,tk]];function l(u,d,f){const h=d<u;h&&([u,d]=[d,u]);const p=f&&typeof f.range=="function"?f:c(u,d,f),m=p?p.range(u,+d+1):[];return h?m.reverse():m}function c(u,d,f){const h=Math.abs(d-u)/f,p=eE(([,,y])=>y).right(o,h);if(p===o.length)return e.every(UA(u/tk,d/tk,f));if(p===0)return Mw.every(Math.max(UA(u,d,f),1));const[m,g]=o[h/o[p-1][2]<o[p][2]/h?p-1:p];return m.every(g)}return[l,c]}const[t_e,r_e]=PH(ef,bE,m_,TH,xE,mE),[n_e,i_e]=PH(Zd,yE,p_,_y,gE,pE);function rk(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function nk(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Zg(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function a_e(e){var t=e.dateTime,r=e.date,n=e.time,i=e.periods,s=e.days,o=e.shortDays,l=e.months,c=e.shortMonths,u=ex(i),d=tx(i),f=ex(s),h=tx(s),p=ex(o),m=tx(o),g=ex(l),y=tx(l),b=ex(c),v=tx(c),w={a:de,A:W,b:V,B:ae,c:null,d:V7,e:V7,f:C_e,g:I_e,G:$_e,H:k_e,I:A_e,j:N_e,L:OH,m:E_e,M:T_e,p:ee,q:C,Q:Y7,s:X7,S:P_e,u:O_e,U:M_e,V:L_e,w:R_e,W:F_e,x:null,X:null,y:B_e,Y:D_e,Z:U_e,"%":K7},S={a:Y,A:q,b:O,B:X,c:null,d:G7,e:G7,f:H_e,g:t5e,G:n5e,H:z_e,I:W_e,j:q_e,L:LH,m:V_e,M:G_e,p:F,q:Q,Q:Y7,s:X7,S:K_e,u:Y_e,U:X_e,V:Q_e,w:J_e,W:Z_e,x:null,X:null,y:e5e,Y:r5e,Z:i5e,"%":K7},j={a:B,A:E,b:P,B:U,c:G,d:q7,e:q7,f:w_e,g:W7,G:z7,H:H7,I:H7,j:x_e,L:v_e,m:g_e,M:y_e,p:M,q:m_e,Q:__e,s:j_e,S:b_e,u:u_e,U:d_e,V:f_e,w:c_e,W:h_e,x:H,X:oe,y:W7,Y:z7,Z:p_e,"%":S_e};w.x=k(r,w),w.X=k(n,w),w.c=k(t,w),S.x=k(r,S),S.X=k(n,S),S.c=k(t,S);function k(K,ne){return function(re){var T=[],I=-1,ie=0,D=K.length,Z,me,Te;for(re instanceof Date||(re=new Date(+re));++I<D;)K.charCodeAt(I)===37&&(T.push(K.slice(ie,I)),(me=U7[Z=K.charAt(++I)])!=null?Z=K.charAt(++I):me=Z==="e"?" ":"0",(Te=ne[Z])&&(Z=Te(re,me)),T.push(Z),ie=I+1);return T.push(K.slice(ie,I)),T.join("")}}function A(K,ne){return function(re){var T=Zg(1900,void 0,1),I=R(T,K,re+="",0),ie,D;if(I!=re.length)return null;if("Q"in T)return new Date(T.Q);if("s"in T)return new Date(T.s*1e3+("L"in T?T.L:0));if(ne&&!("Z"in T)&&(T.Z=0),"p"in T&&(T.H=T.H%12+T.p*12),T.m===void 0&&(T.m="q"in T?T.q:0),"V"in T){if(T.V<1||T.V>53)return null;"w"in T||(T.w=1),"Z"in T?(ie=nk(Zg(T.y,0,1)),D=ie.getUTCDay(),ie=D>4||D===0?Rw.ceil(ie):Rw(ie),ie=h_.offset(ie,(T.V-1)*7),T.y=ie.getUTCFullYear(),T.m=ie.getUTCMonth(),T.d=ie.getUTCDate()+(T.w+6)%7):(ie=rk(Zg(T.y,0,1)),D=ie.getDay(),ie=D>4||D===0?Lw.ceil(ie):Lw(ie),ie=_y.offset(ie,(T.V-1)*7),T.y=ie.getFullYear(),T.m=ie.getMonth(),T.d=ie.getDate()+(T.w+6)%7)}else("W"in T||"U"in T)&&("w"in T||(T.w="u"in T?T.u%7:"W"in T?1:0),D="Z"in T?nk(Zg(T.y,0,1)).getUTCDay():rk(Zg(T.y,0,1)).getDay(),T.m=0,T.d="W"in T?(T.w+6)%7+T.W*7-(D+5)%7:T.w+T.U*7-(D+6)%7);return"Z"in T?(T.H+=T.Z/100|0,T.M+=T.Z%100,nk(T)):rk(T)}}function R(K,ne,re,T){for(var I=0,ie=ne.length,D=re.length,Z,me;I<ie;){if(T>=D)return-1;if(Z=ne.charCodeAt(I++),Z===37){if(Z=ne.charAt(I++),me=j[Z in U7?ne.charAt(I++):Z],!me||(T=me(K,re,T))<0)return-1}else if(Z!=re.charCodeAt(T++))return-1}return T}function M(K,ne,re){var T=u.exec(ne.slice(re));return T?(K.p=d.get(T[0].toLowerCase()),re+T[0].length):-1}function B(K,ne,re){var T=p.exec(ne.slice(re));return T?(K.w=m.get(T[0].toLowerCase()),re+T[0].length):-1}function E(K,ne,re){var T=f.exec(ne.slice(re));return T?(K.w=h.get(T[0].toLowerCase()),re+T[0].length):-1}function P(K,ne,re){var T=b.exec(ne.slice(re));return T?(K.m=v.get(T[0].toLowerCase()),re+T[0].length):-1}function U(K,ne,re){var T=g.exec(ne.slice(re));return T?(K.m=y.get(T[0].toLowerCase()),re+T[0].length):-1}function G(K,ne,re){return R(K,t,ne,re)}function H(K,ne,re){return R(K,r,ne,re)}function oe(K,ne,re){return R(K,n,ne,re)}function de(K){return o[K.getDay()]}function W(K){return s[K.getDay()]}function V(K){return c[K.getMonth()]}function ae(K){return l[K.getMonth()]}function ee(K){return i[+(K.getHours()>=12)]}function C(K){return 1+~~(K.getMonth()/3)}function Y(K){return o[K.getUTCDay()]}function q(K){return s[K.getUTCDay()]}function O(K){return c[K.getUTCMonth()]}function X(K){return l[K.getUTCMonth()]}function F(K){return i[+(K.getUTCHours()>=12)]}function Q(K){return 1+~~(K.getUTCMonth()/3)}return{format:function(K){var ne=k(K+="",w);return ne.toString=function(){return K},ne},parse:function(K){var ne=A(K+="",!1);return ne.toString=function(){return K},ne},utcFormat:function(K){var ne=k(K+="",S);return ne.toString=function(){return K},ne},utcParse:function(K){var ne=A(K+="",!0);return ne.toString=function(){return K},ne}}}var U7={"-":"",_:" ",0:"0"},Zs=/^\s*\d+/,s_e=/^%/,o_e=/[\\^$*+?|[\]().{}]/g;function Pi(e,t,r){var n=e<0?"-":"",i=(n?-e:e)+"",s=i.length;return n+(s<r?new Array(r-s+1).join(t)+i:i)}function l_e(e){return e.replace(o_e,"\\$&")}function ex(e){return new RegExp("^(?:"+e.map(l_e).join("|")+")","i")}function tx(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function c_e(e,t,r){var n=Zs.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function u_e(e,t,r){var n=Zs.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function d_e(e,t,r){var n=Zs.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function f_e(e,t,r){var n=Zs.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function h_e(e,t,r){var n=Zs.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function z7(e,t,r){var n=Zs.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function W7(e,t,r){var n=Zs.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function p_e(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function m_e(e,t,r){var n=Zs.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function g_e(e,t,r){var n=Zs.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function q7(e,t,r){var n=Zs.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function x_e(e,t,r){var n=Zs.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function H7(e,t,r){var n=Zs.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function y_e(e,t,r){var n=Zs.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function b_e(e,t,r){var n=Zs.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function v_e(e,t,r){var n=Zs.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function w_e(e,t,r){var n=Zs.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function S_e(e,t,r){var n=s_e.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function __e(e,t,r){var n=Zs.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function j_e(e,t,r){var n=Zs.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function V7(e,t){return Pi(e.getDate(),t,2)}function k_e(e,t){return Pi(e.getHours(),t,2)}function A_e(e,t){return Pi(e.getHours()%12||12,t,2)}function N_e(e,t){return Pi(1+_y.count(Zd(e),e),t,3)}function OH(e,t){return Pi(e.getMilliseconds(),t,3)}function C_e(e,t){return OH(e,t)+"000"}function E_e(e,t){return Pi(e.getMonth()+1,t,2)}function T_e(e,t){return Pi(e.getMinutes(),t,2)}function P_e(e,t){return Pi(e.getSeconds(),t,2)}function O_e(e){var t=e.getDay();return t===0?7:t}function M_e(e,t){return Pi(p_.count(Zd(e)-1,e),t,2)}function MH(e){var t=e.getDay();return t>=4||t===0?Ym(e):Ym.ceil(e)}function L_e(e,t){return e=MH(e),Pi(Ym.count(Zd(e),e)+(Zd(e).getDay()===4),t,2)}function R_e(e){return e.getDay()}function F_e(e,t){return Pi(Lw.count(Zd(e)-1,e),t,2)}function B_e(e,t){return Pi(e.getFullYear()%100,t,2)}function I_e(e,t){return e=MH(e),Pi(e.getFullYear()%100,t,2)}function D_e(e,t){return Pi(e.getFullYear()%1e4,t,4)}function $_e(e,t){var r=e.getDay();return e=r>=4||r===0?Ym(e):Ym.ceil(e),Pi(e.getFullYear()%1e4,t,4)}function U_e(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Pi(t/60|0,"0",2)+Pi(t%60,"0",2)}function G7(e,t){return Pi(e.getUTCDate(),t,2)}function z_e(e,t){return Pi(e.getUTCHours(),t,2)}function W_e(e,t){return Pi(e.getUTCHours()%12||12,t,2)}function q_e(e,t){return Pi(1+h_.count(ef(e),e),t,3)}function LH(e,t){return Pi(e.getUTCMilliseconds(),t,3)}function H_e(e,t){return LH(e,t)+"000"}function V_e(e,t){return Pi(e.getUTCMonth()+1,t,2)}function G_e(e,t){return Pi(e.getUTCMinutes(),t,2)}function K_e(e,t){return Pi(e.getUTCSeconds(),t,2)}function Y_e(e){var t=e.getUTCDay();return t===0?7:t}function X_e(e,t){return Pi(m_.count(ef(e)-1,e),t,2)}function RH(e){var t=e.getUTCDay();return t>=4||t===0?Xm(e):Xm.ceil(e)}function Q_e(e,t){return e=RH(e),Pi(Xm.count(ef(e),e)+(ef(e).getUTCDay()===4),t,2)}function J_e(e){return e.getUTCDay()}function Z_e(e,t){return Pi(Rw.count(ef(e)-1,e),t,2)}function e5e(e,t){return Pi(e.getUTCFullYear()%100,t,2)}function t5e(e,t){return e=RH(e),Pi(e.getUTCFullYear()%100,t,2)}function r5e(e,t){return Pi(e.getUTCFullYear()%1e4,t,4)}function n5e(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Xm(e):Xm.ceil(e),Pi(e.getUTCFullYear()%1e4,t,4)}function i5e(){return"+0000"}function K7(){return"%"}function Y7(e){return+e}function X7(e){return Math.floor(+e/1e3)}var Ep,FH,BH;a5e({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function a5e(e){return Ep=a_e(e),FH=Ep.format,Ep.parse,BH=Ep.utcFormat,Ep.utcParse,Ep}function s5e(e){return new Date(e)}function o5e(e){return e instanceof Date?+e:+new Date(+e)}function vE(e,t,r,n,i,s,o,l,c,u){var d=sE(),f=d.invert,h=d.domain,p=u(".%L"),m=u(":%S"),g=u("%I:%M"),y=u("%I %p"),b=u("%a %d"),v=u("%b %d"),w=u("%B"),S=u("%Y");function j(k){return(c(k)<k?p:l(k)<k?m:o(k)<k?g:s(k)<k?y:n(k)<k?i(k)<k?b:v:r(k)<k?w:S)(k)}return d.invert=function(k){return new Date(f(k))},d.domain=function(k){return arguments.length?h(Array.from(k,o5e)):h().map(s5e)},d.ticks=function(k){var A=h();return e(A[0],A[A.length-1],k??10)},d.tickFormat=function(k,A){return A==null?j:u(A)},d.nice=function(k){var A=h();return(!k||typeof k.range!="function")&&(k=t(A[0],A[A.length-1],k??10)),k?h(_H(A,k)):d},d.copy=function(){return Sy(d,vE(e,t,r,n,i,s,o,l,c,u))},d}function l5e(){return Yc.apply(vE(n_e,i_e,Zd,yE,p_,_y,gE,pE,Zh,FH).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function c5e(){return Yc.apply(vE(t_e,r_e,ef,bE,m_,h_,xE,mE,Zh,BH).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function g_(){var e=0,t=1,r,n,i,s,o=nl,l=!1,c;function u(f){return f==null||isNaN(f=+f)?c:o(i===0?.5:(f=(s(f)-r)*i,l?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,r=s(e=+e),n=s(t=+t),i=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(f){return arguments.length?(l=!!f,u):l},u.interpolator=function(f){return arguments.length?(o=f,u):o};function d(f){return function(h){var p,m;return arguments.length?([p,m]=h,o=f(p,m),u):[o(0),o(1)]}}return u.range=d(xg),u.rangeRound=d(aE),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return s=f,r=f(e),n=f(t),i=r===n?0:1/(n-r),u}}function Th(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function IH(){var e=Eh(g_()(nl));return e.copy=function(){return Th(e,IH())},gf.apply(e,arguments)}function DH(){var e=cE(g_()).domain([1,10]);return e.copy=function(){return Th(e,DH()).base(e.base())},gf.apply(e,arguments)}function $H(){var e=uE(g_());return e.copy=function(){return Th(e,$H()).constant(e.constant())},gf.apply(e,arguments)}function wE(){var e=dE(g_());return e.copy=function(){return Th(e,wE()).exponent(e.exponent())},gf.apply(e,arguments)}function u5e(){return wE.apply(null,arguments).exponent(.5)}function UH(){var e=[],t=nl;function r(n){if(n!=null&&!isNaN(n=+n))return t((vy(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let i of n)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(oh),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,i)=>t(i/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,s)=>Ywe(e,s/n))},r.copy=function(){return UH(t).domain(e)},gf.apply(r,arguments)}function x_(){var e=0,t=.5,r=1,n=1,i,s,o,l,c,u=nl,d,f=!1,h;function p(g){return isNaN(g=+g)?h:(g=.5+((g=+d(g))-s)*(n*g<n*s?l:c),u(f?Math.max(0,Math.min(1,g)):g))}p.domain=function(g){return arguments.length?([e,t,r]=g,i=d(e=+e),s=d(t=+t),o=d(r=+r),l=i===s?0:.5/(s-i),c=s===o?0:.5/(o-s),n=s<i?-1:1,p):[e,t,r]},p.clamp=function(g){return arguments.length?(f=!!g,p):f},p.interpolator=function(g){return arguments.length?(u=g,p):u};function m(g){return function(y){var b,v,w;return arguments.length?([b,v,w]=y,u=SSe(g,[b,v,w]),p):[u(0),u(.5),u(1)]}}return p.range=m(xg),p.rangeRound=m(aE),p.unknown=function(g){return arguments.length?(h=g,p):h},function(g){return d=g,i=g(e),s=g(t),o=g(r),l=i===s?0:.5/(s-i),c=s===o?0:.5/(o-s),n=s<i?-1:1,p}}function zH(){var e=Eh(x_()(nl));return e.copy=function(){return Th(e,zH())},gf.apply(e,arguments)}function WH(){var e=cE(x_()).domain([.1,1,10]);return e.copy=function(){return Th(e,WH()).base(e.base())},gf.apply(e,arguments)}function qH(){var e=uE(x_());return e.copy=function(){return Th(e,qH()).constant(e.constant())},gf.apply(e,arguments)}function SE(){var e=dE(x_());return e.copy=function(){return Th(e,SE()).exponent(e.exponent())},gf.apply(e,arguments)}function d5e(){return SE.apply(null,arguments).exponent(.5)}const xx=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:rE,scaleDiverging:zH,scaleDivergingLog:WH,scaleDivergingPow:SE,scaleDivergingSqrt:d5e,scaleDivergingSymlog:qH,scaleIdentity:SH,scaleImplicit:zA,scaleLinear:wH,scaleLog:jH,scaleOrdinal:tE,scalePoint:Jwe,scalePow:fE,scaleQuantile:NH,scaleQuantize:CH,scaleRadial:AH,scaleSequential:IH,scaleSequentialLog:DH,scaleSequentialPow:wE,scaleSequentialQuantile:UH,scaleSequentialSqrt:u5e,scaleSequentialSymlog:$H,scaleSqrt:HSe,scaleSymlog:kH,scaleThreshold:EH,scaleTime:l5e,scaleUtc:c5e,tickFormat:vH},Symbol.toStringTag,{value:"Module"}));var xf=e=>e.chartData,y_=Qt([xf],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),b_=(e,t,r,n)=>n?y_(e):xf(e),f5e=(e,t,r)=>r?y_(e):xf(e);function tf(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(pi(t)&&pi(r))return!0}return!1}function Q7(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function HH(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,i,s;if(pi(r))i=r;else if(typeof r=="function")return;if(pi(n))s=n;else if(typeof n=="function")return;var o=[i,s];if(tf(o))return o}}function h5e(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(tf(n))return Q7(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[i,s]=e,o,l;if(i==="auto")t!=null&&(o=Math.min(...t));else if(En(i))o=i;else if(typeof i=="function")try{t!=null&&(o=i(t==null?void 0:t[0]))}catch{}else if(typeof i=="string"&&mL.test(i)){var c=mL.exec(i);if(c==null||c[1]==null||t==null)o=void 0;else{var u=+c[1];o=t[0]-u}}else o=t==null?void 0:t[0];if(s==="auto")t!=null&&(l=Math.max(...t));else if(En(s))l=s;else if(typeof s=="function")try{t!=null&&(l=s(t==null?void 0:t[1]))}catch{}else if(typeof s=="string"&&gL.test(s)){var d=gL.exec(s);if(d==null||d[1]==null||t==null)l=void 0;else{var f=+d[1];l=t[1]+f}}else l=t==null?void 0:t[1];var h=[o,l];if(tf(h))return t==null?h:Q7(h,t,r)}}}var yg=1e9,p5e={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},jE,_a=!0,Gc="[DecimalError] ",h0=Gc+"Invalid argument: ",_E=Gc+"Exponent out of range: ",bg=Math.floor,Wh=Math.pow,m5e=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Zl,Hs=1e7,ha=7,VH=9007199254740991,Fw=bg(VH/ha),Tn={};Tn.absoluteValue=Tn.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Tn.comparedTo=Tn.cmp=function(e){var t,r,n,i,s=this;if(e=new s.constructor(e),s.s!==e.s)return s.s||-e.s;if(s.e!==e.e)return s.e>e.e^s.s<0?1:-1;for(n=s.d.length,i=e.d.length,t=0,r=n<i?n:i;t<r;++t)if(s.d[t]!==e.d[t])return s.d[t]>e.d[t]^s.s<0?1:-1;return n===i?0:n>i^s.s<0?1:-1};Tn.decimalPlaces=Tn.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*ha;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Tn.dividedBy=Tn.div=function(e){return Wd(this,new this.constructor(e))};Tn.dividedToIntegerBy=Tn.idiv=function(e){var t=this,r=t.constructor;return ia(Wd(t,new r(e),0,1),r.precision)};Tn.equals=Tn.eq=function(e){return!this.cmp(e)};Tn.exponent=function(){return ws(this)};Tn.greaterThan=Tn.gt=function(e){return this.cmp(e)>0};Tn.greaterThanOrEqualTo=Tn.gte=function(e){return this.cmp(e)>=0};Tn.isInteger=Tn.isint=function(){return this.e>this.d.length-2};Tn.isNegative=Tn.isneg=function(){return this.s<0};Tn.isPositive=Tn.ispos=function(){return this.s>0};Tn.isZero=function(){return this.s===0};Tn.lessThan=Tn.lt=function(e){return this.cmp(e)<0};Tn.lessThanOrEqualTo=Tn.lte=function(e){return this.cmp(e)<1};Tn.logarithm=Tn.log=function(e){var t,r=this,n=r.constructor,i=n.precision,s=i+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Zl))throw Error(Gc+"NaN");if(r.s<1)throw Error(Gc+(r.s?"NaN":"-Infinity"));return r.eq(Zl)?new n(0):(_a=!1,t=Wd(B1(r,s),B1(e,s),s),_a=!0,ia(t,i))};Tn.minus=Tn.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?YH(t,e):GH(t,(e.s=-e.s,e))};Tn.modulo=Tn.mod=function(e){var t,r=this,n=r.constructor,i=n.precision;if(e=new n(e),!e.s)throw Error(Gc+"NaN");return r.s?(_a=!1,t=Wd(r,e,0,1).times(e),_a=!0,r.minus(t)):ia(new n(r),i)};Tn.naturalExponential=Tn.exp=function(){return KH(this)};Tn.naturalLogarithm=Tn.ln=function(){return B1(this)};Tn.negated=Tn.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Tn.plus=Tn.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?GH(t,e):YH(t,(e.s=-e.s,e))};Tn.precision=Tn.sd=function(e){var t,r,n,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(h0+e);if(t=ws(i)+1,n=i.d.length-1,r=n*ha+1,n=i.d[n],n){for(;n%10==0;n/=10)r--;for(n=i.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};Tn.squareRoot=Tn.sqrt=function(){var e,t,r,n,i,s,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(Gc+"NaN")}for(e=ws(l),_a=!1,i=Math.sqrt(+l),i==0||i==1/0?(t=Qu(l.d),(t.length+e)%2==0&&(t+="0"),i=Math.sqrt(t),e=bg((e+1)/2)-(e<0||e%2),i==1/0?t="5e"+e:(t=i.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(i.toString()),r=c.precision,i=o=r+3;;)if(s=n,n=s.plus(Wd(l,s,o+2)).times(.5),Qu(s.d).slice(0,o)===(t=Qu(n.d)).slice(0,o)){if(t=t.slice(o-3,o+1),i==o&&t=="4999"){if(ia(s,r+1,0),s.times(s).eq(l)){n=s;break}}else if(t!="9999")break;o+=4}return _a=!0,ia(n,r)};Tn.times=Tn.mul=function(e){var t,r,n,i,s,o,l,c,u,d=this,f=d.constructor,h=d.d,p=(e=new f(e)).d;if(!d.s||!e.s)return new f(0);for(e.s*=d.s,r=d.e+e.e,c=h.length,u=p.length,c<u&&(s=h,h=p,p=s,o=c,c=u,u=o),s=[],o=c+u,n=o;n--;)s.push(0);for(n=u;--n>=0;){for(t=0,i=c+n;i>n;)l=s[i]+p[n]*h[i-n-1]+t,s[i--]=l%Hs|0,t=l/Hs|0;s[i]=(s[i]+t)%Hs|0}for(;!s[--o];)s.pop();return t?++r:s.shift(),e.d=s,e.e=r,_a?ia(e,f.precision):e};Tn.toDecimalPlaces=Tn.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(ad(e,0,yg),t===void 0?t=n.rounding:ad(t,0,8),ia(r,e+ws(r)+1,t))};Tn.toExponential=function(e,t){var r,n=this,i=n.constructor;return e===void 0?r=B0(n,!0):(ad(e,0,yg),t===void 0?t=i.rounding:ad(t,0,8),n=ia(new i(n),e+1,t),r=B0(n,!0,e+1)),r};Tn.toFixed=function(e,t){var r,n,i=this,s=i.constructor;return e===void 0?B0(i):(ad(e,0,yg),t===void 0?t=s.rounding:ad(t,0,8),n=ia(new s(i),e+ws(i)+1,t),r=B0(n.abs(),!1,e+ws(n)+1),i.isneg()&&!i.isZero()?"-"+r:r)};Tn.toInteger=Tn.toint=function(){var e=this,t=e.constructor;return ia(new t(e),ws(e)+1,t.rounding)};Tn.toNumber=function(){return+this};Tn.toPower=Tn.pow=function(e){var t,r,n,i,s,o,l=this,c=l.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c(Zl);if(l=new c(l),!l.s){if(e.s<1)throw Error(Gc+"Infinity");return l}if(l.eq(Zl))return l;if(n=c.precision,e.eq(Zl))return ia(l,n);if(t=e.e,r=e.d.length-1,o=t>=r,s=l.s,o){if((r=d<0?-d:d)<=VH){for(i=new c(Zl),t=Math.ceil(n/ha+4),_a=!1;r%2&&(i=i.times(l),Z7(i.d,t)),r=bg(r/2),r!==0;)l=l.times(l),Z7(l.d,t);return _a=!0,e.s<0?new c(Zl).div(i):ia(i,n)}}else if(s<0)throw Error(Gc+"NaN");return s=s<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,_a=!1,i=e.times(B1(l,n+u)),_a=!0,i=KH(i),i.s=s,i};Tn.toPrecision=function(e,t){var r,n,i=this,s=i.constructor;return e===void 0?(r=ws(i),n=B0(i,r<=s.toExpNeg||r>=s.toExpPos)):(ad(e,1,yg),t===void 0?t=s.rounding:ad(t,0,8),i=ia(new s(i),e,t),r=ws(i),n=B0(i,e<=r||r<=s.toExpNeg,e)),n};Tn.toSignificantDigits=Tn.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(ad(e,1,yg),t===void 0?t=n.rounding:ad(t,0,8)),ia(new n(r),e,t)};Tn.toString=Tn.valueOf=Tn.val=Tn.toJSON=Tn[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=ws(e),r=e.constructor;return B0(e,t<=r.toExpNeg||t>=r.toExpPos)};function GH(e,t){var r,n,i,s,o,l,c,u,d=e.constructor,f=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),_a?ia(t,f):t;if(c=e.d,u=t.d,o=e.e,i=t.e,c=c.slice(),s=o-i,s){for(s<0?(n=c,s=-s,l=u.length):(n=u,i=o,l=c.length),o=Math.ceil(f/ha),l=o>l?o+1:l+1,s>l&&(s=l,n.length=1),n.reverse();s--;)n.push(0);n.reverse()}for(l=c.length,s=u.length,l-s<0&&(s=l,n=u,u=c,c=n),r=0;s;)r=(c[--s]=c[s]+u[s]+r)/Hs|0,c[s]%=Hs;for(r&&(c.unshift(r),++i),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=i,_a?ia(t,f):t}function ad(e,t,r){if(e!==~~e||e<t||e>r)throw Error(h0+e)}function Qu(e){var t,r,n,i=e.length-1,s="",o=e[0];if(i>0){for(s+=o,t=1;t<i;t++)n=e[t]+"",r=ha-n.length,r&&(s+=Ff(r)),s+=n;o=e[t],n=o+"",r=ha-n.length,r&&(s+=Ff(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var Wd=function(){function e(n,i){var s,o=0,l=n.length;for(n=n.slice();l--;)s=n[l]*i+o,n[l]=s%Hs|0,o=s/Hs|0;return o&&n.unshift(o),n}function t(n,i,s,o){var l,c;if(s!=o)c=s>o?1:-1;else for(l=c=0;l<s;l++)if(n[l]!=i[l]){c=n[l]>i[l]?1:-1;break}return c}function r(n,i,s){for(var o=0;s--;)n[s]-=o,o=n[s]<i[s]?1:0,n[s]=o*Hs+n[s]-i[s];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,s,o){var l,c,u,d,f,h,p,m,g,y,b,v,w,S,j,k,A,R,M=n.constructor,B=n.s==i.s?1:-1,E=n.d,P=i.d;if(!n.s)return new M(n);if(!i.s)throw Error(Gc+"Division by zero");for(c=n.e-i.e,A=P.length,j=E.length,p=new M(B),m=p.d=[],u=0;P[u]==(E[u]||0);)++u;if(P[u]>(E[u]||0)&&--c,s==null?v=s=M.precision:o?v=s+(ws(n)-ws(i))+1:v=s,v<0)return new M(0);if(v=v/ha+2|0,u=0,A==1)for(d=0,P=P[0],v++;(u<j||d)&&v--;u++)w=d*Hs+(E[u]||0),m[u]=w/P|0,d=w%P|0;else{for(d=Hs/(P[0]+1)|0,d>1&&(P=e(P,d),E=e(E,d),A=P.length,j=E.length),S=A,g=E.slice(0,A),y=g.length;y<A;)g[y++]=0;R=P.slice(),R.unshift(0),k=P[0],P[1]>=Hs/2&&++k;do d=0,l=t(P,g,A,y),l<0?(b=g[0],A!=y&&(b=b*Hs+(g[1]||0)),d=b/k|0,d>1?(d>=Hs&&(d=Hs-1),f=e(P,d),h=f.length,y=g.length,l=t(f,g,h,y),l==1&&(d--,r(f,A<h?R:P,h))):(d==0&&(l=d=1),f=P.slice()),h=f.length,h<y&&f.unshift(0),r(g,f,y),l==-1&&(y=g.length,l=t(P,g,A,y),l<1&&(d++,r(g,A<y?R:P,y))),y=g.length):l===0&&(d++,g=[0]),m[u++]=d,l&&g[0]?g[y++]=E[S]||0:(g=[E[S]],y=1);while((S++<j||g[0]!==void 0)&&v--)}return m[0]||m.shift(),p.e=c,ia(p,o?s+ws(p)+1:s)}}();function KH(e,t){var r,n,i,s,o,l,c=0,u=0,d=e.constructor,f=d.precision;if(ws(e)>16)throw Error(_E+ws(e));if(!e.s)return new d(Zl);for(_a=!1,l=f,o=new d(.03125);e.abs().gte(.1);)e=e.times(o),u+=5;for(n=Math.log(Wh(2,u))/Math.LN10*2+5|0,l+=n,r=i=s=new d(Zl),d.precision=l;;){if(i=ia(i.times(e),l),r=r.times(++c),o=s.plus(Wd(i,r,l)),Qu(o.d).slice(0,l)===Qu(s.d).slice(0,l)){for(;u--;)s=ia(s.times(s),l);return d.precision=f,t==null?(_a=!0,ia(s,f)):s}s=o}}function ws(e){for(var t=e.e*ha,r=e.d[0];r>=10;r/=10)t++;return t}function ik(e,t,r){if(t>e.LN10.sd())throw _a=!0,r&&(e.precision=r),Error(Gc+"LN10 precision limit exceeded");return ia(new e(e.LN10),t)}function Ff(e){for(var t="";e--;)t+="0";return t}function B1(e,t){var r,n,i,s,o,l,c,u,d,f=1,h=10,p=e,m=p.d,g=p.constructor,y=g.precision;if(p.s<1)throw Error(Gc+(p.s?"NaN":"-Infinity"));if(p.eq(Zl))return new g(0);if(t==null?(_a=!1,u=y):u=t,p.eq(10))return t==null&&(_a=!0),ik(g,u);if(u+=h,g.precision=u,r=Qu(m),n=r.charAt(0),s=ws(p),Math.abs(s)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)p=p.times(e),r=Qu(p.d),n=r.charAt(0),f++;s=ws(p),n>1?(p=new g("0."+r),s++):p=new g(n+"."+r.slice(1))}else return c=ik(g,u+2,y).times(s+""),p=B1(new g(n+"."+r.slice(1)),u-h).plus(c),g.precision=y,t==null?(_a=!0,ia(p,y)):p;for(l=o=p=Wd(p.minus(Zl),p.plus(Zl),u),d=ia(p.times(p),u),i=3;;){if(o=ia(o.times(d),u),c=l.plus(Wd(o,new g(i),u)),Qu(c.d).slice(0,u)===Qu(l.d).slice(0,u))return l=l.times(2),s!==0&&(l=l.plus(ik(g,u+2,y).times(s+""))),l=Wd(l,new g(f),u),g.precision=y,t==null?(_a=!0,ia(l,y)):l;l=c,i+=2}}function J7(e,t){var r,n,i;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(i=t.length;t.charCodeAt(i-1)===48;)--i;if(t=t.slice(n,i),t){if(i-=n,r=r-n-1,e.e=bg(r/ha),e.d=[],n=(r+1)%ha,r<0&&(n+=ha),n<i){for(n&&e.d.push(+t.slice(0,n)),i-=ha;n<i;)e.d.push(+t.slice(n,n+=ha));t=t.slice(n),n=ha-t.length}else n-=i;for(;n--;)t+="0";if(e.d.push(+t),_a&&(e.e>Fw||e.e<-Fw))throw Error(_E+r)}else e.s=0,e.e=0,e.d=[0];return e}function ia(e,t,r){var n,i,s,o,l,c,u,d,f=e.d;for(o=1,s=f[0];s>=10;s/=10)o++;if(n=t-o,n<0)n+=ha,i=t,u=f[d=0];else{if(d=Math.ceil((n+1)/ha),s=f.length,d>=s)return e;for(u=s=f[d],o=1;s>=10;s/=10)o++;n%=ha,i=n-ha+o}if(r!==void 0&&(s=Wh(10,o-i-1),l=u/s%10|0,c=t<0||f[d+1]!==void 0||u%s,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?i>0?u/Wh(10,o-i):0:f[d-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(s=ws(e),f.length=1,t=t-s-1,f[0]=Wh(10,(ha-t%ha)%ha),e.e=bg(-t/ha)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=d,s=1,d--):(f.length=d+1,s=Wh(10,ha-n),f[d]=i>0?(u/Wh(10,o-i)%Wh(10,i)|0)*s:0),c)for(;;)if(d==0){(f[0]+=s)==Hs&&(f[0]=1,++e.e);break}else{if(f[d]+=s,f[d]!=Hs)break;f[d--]=0,s=1}for(n=f.length;f[--n]===0;)f.pop();if(_a&&(e.e>Fw||e.e<-Fw))throw Error(_E+ws(e));return e}function YH(e,t){var r,n,i,s,o,l,c,u,d,f,h=e.constructor,p=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),_a?ia(t,p):t;if(c=e.d,f=t.d,n=t.e,u=e.e,c=c.slice(),o=u-n,o){for(d=o<0,d?(r=c,o=-o,l=f.length):(r=f,n=u,l=c.length),i=Math.max(Math.ceil(p/ha),l)+2,o>i&&(o=i,r.length=1),r.reverse(),i=o;i--;)r.push(0);r.reverse()}else{for(i=c.length,l=f.length,d=i<l,d&&(l=i),i=0;i<l;i++)if(c[i]!=f[i]){d=c[i]<f[i];break}o=0}for(d&&(r=c,c=f,f=r,t.s=-t.s),l=c.length,i=f.length-l;i>0;--i)c[l++]=0;for(i=f.length;i>o;){if(c[--i]<f[i]){for(s=i;s&&c[--s]===0;)c[s]=Hs-1;--c[s],c[i]+=Hs}c[i]-=f[i]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,_a?ia(t,p):t):new h(0)}function B0(e,t,r){var n,i=ws(e),s=Qu(e.d),o=s.length;return t?(r&&(n=r-o)>0?s=s.charAt(0)+"."+s.slice(1)+Ff(n):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(i<0?"e":"e+")+i):i<0?(s="0."+Ff(-i-1)+s,r&&(n=r-o)>0&&(s+=Ff(n))):i>=o?(s+=Ff(i+1-o),r&&(n=r-i-1)>0&&(s=s+"."+Ff(n))):((n=i+1)<o&&(s=s.slice(0,n)+"."+s.slice(n)),r&&(n=r-o)>0&&(i+1===o&&(s+="."),s+=Ff(n))),e.s<0?"-"+s:s}function Z7(e,t){if(e.length>t)return e.length=t,!0}function XH(e){var t,r,n;function i(s){var o=this;if(!(o instanceof i))return new i(s);if(o.constructor=i,s instanceof i){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(h0+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return J7(o,s.toString())}else if(typeof s!="string")throw Error(h0+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,m5e.test(s))J7(o,s);else throw Error(h0+s)}if(i.prototype=Tn,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=XH,i.config=i.set=g5e,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return i.config(e),i}function g5e(e){if(!e||typeof e!="object")throw Error(Gc+"Object expected");var t,r,n,i=["precision",1,yg,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<i.length;t+=3)if((n=e[r=i[t]])!==void 0)if(bg(n)===n&&n>=i[t+1]&&n<=i[t+2])this[r]=n;else throw Error(h0+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(h0+r+": "+n);return this}var jE=XH(p5e);Zl=new jE(1);const qi=jE;function QH(e){var t;return e===0?t=1:t=Math.floor(new qi(e).abs().log(10).toNumber())+1,t}function JH(e,t,r){for(var n=new qi(e),i=0,s=[];n.lt(t)&&i<1e5;)s.push(n.toNumber()),n=n.add(r),i++;return s}var ZH=e=>{var[t,r]=e,[n,i]=[t,r];return t>r&&([n,i]=[r,t]),[n,i]},eV=(e,t,r)=>{if(e.lte(0))return new qi(0);var n=QH(e.toNumber()),i=new qi(10).pow(n),s=e.div(i),o=n!==1?.05:.1,l=new qi(Math.ceil(s.div(o).toNumber())).add(r).mul(o),c=l.mul(i);return t?new qi(c.toNumber()):new qi(Math.ceil(c.toNumber()))},x5e=(e,t,r)=>{var n=new qi(1),i=new qi(e);if(!i.isint()&&r){var s=Math.abs(e);s<1?(n=new qi(10).pow(QH(e)-1),i=new qi(Math.floor(i.div(n).toNumber())).mul(n)):s>1&&(i=new qi(Math.floor(e)))}else e===0?i=new qi(Math.floor((t-1)/2)):r||(i=new qi(Math.floor(e)));for(var o=Math.floor((t-1)/2),l=[],c=0;c<t;c++)l.push(i.add(new qi(c-o).mul(n)).toNumber());return l},tV=function(t,r,n,i){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new qi(0),tickMin:new qi(0),tickMax:new qi(0)};var o=eV(new qi(r).sub(t).div(n-1),i,s),l;t<=0&&r>=0?l=new qi(0):(l=new qi(t).add(r).div(2),l=l.sub(new qi(l).mod(o)));var c=Math.ceil(l.sub(t).div(o).toNumber()),u=Math.ceil(new qi(r).sub(l).div(o).toNumber()),d=c+u+1;return d>n?tV(t,r,n,i,s+1):(d<n&&(u=r>0?u+(n-d):u,c=r>0?c:c+(n-d)),{step:o,tickMin:l.sub(new qi(c).mul(o)),tickMax:l.add(new qi(u).mul(o))})},y5e=function(t){var[r,n]=t,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(i,2),[l,c]=ZH([r,n]);if(l===-1/0||c===1/0){var u=c===1/0?[l,...Array(i-1).fill(1/0)]:[...Array(i-1).fill(-1/0),c];return r>n?u.reverse():u}if(l===c)return x5e(l,i,s);var{step:d,tickMin:f,tickMax:h}=tV(l,c,o,s,0),p=JH(f,h.add(new qi(.1).mul(d)),d);return r>n?p.reverse():p},b5e=function(t,r){var[n,i]=t,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[o,l]=ZH([n,i]);if(o===-1/0||l===1/0)return[n,i];if(o===l)return[o];var c=Math.max(r,2),u=eV(new qi(l).sub(o).div(c-1),s,0),d=[...JH(new qi(o),new qi(l),u),l];return s===!1&&(d=d.map(f=>Math.round(f))),n>i?d.reverse():d},rV=e=>e.rootProps.maxBarSize,v5e=e=>e.rootProps.barGap,nV=e=>e.rootProps.barCategoryGap,w5e=e=>e.rootProps.barSize,jy=e=>e.rootProps.stackOffset,iV=e=>e.rootProps.reverseStackOrder,kE=e=>e.options.chartName,AE=e=>e.rootProps.syncId,aV=e=>e.rootProps.syncMethod,NE=e=>e.options.eventEmitter,Oa={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},Fh={allowDecimals:!1,allowDataOverflow:!1,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"auto"},Fu={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!0,includeHidden:!1,radiusAxisId:0,reversed:!1,scale:"auto",tick:!0,tickCount:5,type:"auto"},v_=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t};function w_(e,t,r){if(r!=="auto")return r;if(e!=null)return hf(e,t)?"category":"number"}function eR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Bw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eR(Object(r),!0).forEach(function(n){S5e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function S5e(e,t,r){return(t=_5e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _5e(e){var t=j5e(e,"string");return typeof t=="symbol"?t:t+""}function j5e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tR={allowDataOverflow:Fh.allowDataOverflow,allowDecimals:Fh.allowDecimals,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Fh.angleAxisId,includeHidden:!1,name:void 0,reversed:Fh.reversed,scale:Fh.scale,tick:Fh.tick,tickCount:void 0,ticks:void 0,type:Fh.type,unit:void 0},rR={allowDataOverflow:Fu.allowDataOverflow,allowDecimals:Fu.allowDecimals,allowDuplicatedCategory:Fu.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Fu.radiusAxisId,includeHidden:Fu.includeHidden,name:void 0,reversed:Fu.reversed,scale:Fu.scale,tick:Fu.tick,tickCount:Fu.tickCount,ticks:void 0,type:Fu.type,unit:void 0},k5e=(e,t)=>{if(t!=null)return e.polarAxis.angleAxis[t]},CE=Qt([k5e,Uq],(e,t)=>{var r;if(e!=null)return e;var n=(r=w_(t,"angleAxis",tR.type))!==null&&r!==void 0?r:"category";return Bw(Bw({},tR),{},{type:n})}),A5e=(e,t)=>e.polarAxis.radiusAxis[t],EE=Qt([A5e,Uq],(e,t)=>{var r;if(e!=null)return e;var n=(r=w_(t,"radiusAxis",rR.type))!==null&&r!==void 0?r:"category";return Bw(Bw({},rR),{},{type:n})}),S_=e=>e.polarOptions,TE=Qt([pf,mf,Rs],iH),sV=Qt([S_,TE],(e,t)=>{if(e!=null)return Wo(e.innerRadius,t,0)}),oV=Qt([S_,TE],(e,t)=>{if(e!=null)return Wo(e.outerRadius,t,t*.8)}),N5e=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},lV=Qt([S_],N5e);Qt([CE,lV],v_);var cV=Qt([TE,sV,oV],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});Qt([EE,cV],v_);var uV=Qt([Oi,S_,sV,oV,pf,mf],(e,t,r,n,i,s)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:o,cy:l,startAngle:c,endAngle:u}=t;return{cx:Wo(o,i,i/2),cy:Wo(l,s,s/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:u,clockWise:!1}}}),Fa=(e,t)=>t,ky=(e,t,r)=>r;function PE(e){return e==null?void 0:e.id}function dV(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:i,dataKey:s}=r,o=new Map;return e.forEach(l=>{var c,u=(c=l.data)!==null&&c!==void 0?c:n;if(!(u==null||u.length===0)){var d=PE(l);u.forEach((f,h)=>{var p=s==null||i?h:String(Ti(f,s,null)),m=Ti(f,l.dataKey,0),g;o.has(p)?g=o.get(p):g={},Object.assign(g,{[d]:m}),o.set(p,g)})}}),Array.from(o.values())}function __(e){return"stackId"in e&&e.stackId!=null&&e.dataKey!=null}var j_=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function k_(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function C5e(e,t){if(e.length===t.length){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return!1}var eo=e=>{var t=Oi(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},vg=e=>e.tooltip.settings.axisId;function E5e(e){if(e in xx)return xx[e]();var t="scale".concat(hy(e));if(t in xx)return xx[t]()}function nR(e){var t=e.ticks,r=e.bandwidth,n=e.range(),i=[Math.min(...n),Math.max(...n)];return{domain:()=>e.domain(),range:function(s){function o(){return s.apply(this,arguments)}return o.toString=function(){return s.toString()},o}(()=>i),rangeMin:()=>i[0],rangeMax:()=>i[1],isInRange(s){var o=i[0],l=i[1];return o<=l?s>=o&&s<=l:s>=l&&s<=o},bandwidth:r?()=>r.call(e):void 0,ticks:t?s=>t.call(e,s):void 0,map:(s,o)=>{var l=e(s);if(l!=null){if(e.bandwidth&&o!==null&&o!==void 0&&o.position){var c=e.bandwidth();switch(o.position){case"middle":l+=c/2;break;case"end":l+=c;break}}return l}}}}function iR(e,t,r){if(typeof e=="function")return nR(e.copy().domain(t).range(r));if(e!=null){var n=E5e(e);if(n!=null)return n.domain(t).range(r),nR(n)}}var fV=(e,t)=>{if(t!=null)switch(e){case"linear":{if(!tf(t)){for(var r,n,i=0;i<t.length;i++){var s=t[i];pi(s)&&((r===void 0||s<r)&&(r=s),(n===void 0||s>n)&&(n=s))}return r!==void 0&&n!==void 0?[r,n]:void 0}return t}default:return t}};function aR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Iw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aR(Object(r),!0).forEach(function(n){T5e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function T5e(e,t,r){return(t=P5e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P5e(e){var t=O5e(e,"string");return typeof t=="symbol"?t:t+""}function O5e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var VA=[0,"auto"],$s={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},hV=(e,t)=>e.cartesianAxis.xAxis[t],dd=(e,t)=>{var r=hV(e,t);return r??$s},Us={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:VA,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:gy},pV=(e,t)=>e.cartesianAxis.yAxis[t],fd=(e,t)=>{var r=pV(e,t);return r??Us},Id={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},OE=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??Id},Ya=(e,t,r)=>{switch(t){case"xAxis":return dd(e,r);case"yAxis":return fd(e,r);case"zAxis":return OE(e,r);case"angleAxis":return CE(e,r);case"radiusAxis":return EE(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},M5e=(e,t,r)=>{switch(t){case"xAxis":return dd(e,r);case"yAxis":return fd(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},wg=(e,t,r)=>{switch(t){case"xAxis":return dd(e,r);case"yAxis":return fd(e,r);case"angleAxis":return CE(e,r);case"radiusAxis":return EE(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},mV=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function ME(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var Ay=e=>e.graphicalItems.cartesianItems,L5e=Qt([Fa,ky],ME),LE=(e,t,r)=>e.filter(r).filter(n=>(t==null?void 0:t.includeHidden)===!0?!0:!n.hide),Ny=Qt([Ay,Ya,L5e],LE,{memoizeOptions:{resultEqualityCheck:k_}}),gV=Qt([Ny],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(__)),xV=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),R5e=Qt([Ny],xV),RE=e=>e.map(t=>t.data).filter(Boolean).flat(1),F5e=Qt([Ny],RE,{memoizeOptions:{resultEqualityCheck:k_}}),FE=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:i}=t;return e.length>0?e:r.slice(n,i+1)},BE=Qt([F5e,b_],FE),IE=(e,t,r)=>(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:Ti(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(i=>({value:Ti(i,n)}))):e.map(n=>({value:n})),A_=Qt([BE,Ya,Ny],IE);function yV(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function Zv(e){if(Hc(e)||e instanceof Date){var t=Number(e);if(pi(t))return t}}function sR(e){if(Array.isArray(e)){var t=[Zv(e[0]),Zv(e[1])];return tf(t)?t:void 0}var r=Zv(e);if(r!=null)return[r,r]}function rf(e){return e.map(Zv).filter(_l)}function B5e(e,t,r){return!r||typeof t!="number"||nd(t)?[]:r.length?rf(r.flatMap(n=>{var i=Ti(e,n.dataKey),s,o;if(Array.isArray(i)?[s,o]=i:s=o=i,!(!pi(s)||!pi(o)))return[t-s,t+o]})):[]}var Is=e=>{var t=eo(e),r=vg(e);return wg(e,t,r)},Cy=Qt([Is],e=>e==null?void 0:e.dataKey),I5e=Qt([gV,b_,Is],dV),bV=(e,t,r,n)=>{var i={},s=t.reduce((o,l)=>{if(l.stackId==null)return o;var c=o[l.stackId];return c==null&&(c=[]),c.push(l),o[l.stackId]=c,o},i);return Object.fromEntries(Object.entries(s).map(o=>{var[l,c]=o,u=n?[...c].reverse():c,d=u.map(PE);return[l,{stackedData:hve(e,d,r),graphicalItems:u}]}))},GA=Qt([I5e,gV,jy,iV],bV),vV=(e,t,r,n)=>{var{dataStartIndex:i,dataEndIndex:s}=t;if(n==null&&r!=="zAxis"){var o=yve(e,i,s);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},D5e=Qt([Ya],e=>e.allowDataOverflow),DE=e=>{var t;if(e==null||!("domain"in e))return VA;if(e.domain!=null)return e.domain;if("ticks"in e&&e.ticks!=null){if(e.type==="number"){var r=rf(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:VA},$E=Qt([Ya],DE),UE=Qt([$E,D5e],HH),$5e=Qt([GA,xf,Fa,UE],vV,{memoizeOptions:{resultEqualityCheck:j_}}),N_=e=>e.errorBars,U5e=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>yV(r,n)),Dw=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r.filter(Boolean);if(i.length!==0){var s=i.flat(),o=Math.min(...s),l=Math.max(...s);return[o,l]}},zE=(e,t,r,n,i)=>{var s,o;if(r.length>0&&e.forEach(l=>{r.forEach(c=>{var u,d,f=(u=n[c.id])===null||u===void 0?void 0:u.filter(b=>yV(i,b)),h=Ti(l,(d=t.dataKey)!==null&&d!==void 0?d:c.dataKey),p=B5e(l,h,f);if(p.length>=2){var m=Math.min(...p),g=Math.max(...p);(s==null||m<s)&&(s=m),(o==null||g>o)&&(o=g)}var y=sR(h);y!=null&&(s=s==null?y[0]:Math.min(s,y[0]),o=o==null?y[1]:Math.max(o,y[1]))})}),(t==null?void 0:t.dataKey)!=null&&e.forEach(l=>{var c=sR(Ti(l,t.dataKey));c!=null&&(s=s==null?c[0]:Math.min(s,c[0]),o=o==null?c[1]:Math.max(o,c[1]))}),pi(s)&&pi(o))return[s,o]},z5e=Qt([BE,Ya,R5e,N_,Fa],zE,{memoizeOptions:{resultEqualityCheck:j_}});function W5e(e){var{value:t}=e;if(Hc(t)||t instanceof Date)return t}var q5e=(e,t,r)=>{var n=e.map(W5e).filter(i=>i!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&yW(n))?dH(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},wV=e=>e.referenceElements.dots,Sg=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),H5e=Qt([wV,Fa,ky],Sg),SV=e=>e.referenceElements.areas,V5e=Qt([SV,Fa,ky],Sg),_V=e=>e.referenceElements.lines,G5e=Qt([_V,Fa,ky],Sg),jV=(e,t)=>{if(e!=null){var r=rf(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},K5e=Qt(H5e,Fa,jV),kV=(e,t)=>{if(e!=null){var r=rf(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},Y5e=Qt([V5e,Fa],kV);function X5e(e){var t;if(e.x!=null)return rf([e.x]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.x);return r==null||r.length===0?[]:rf(r)}function Q5e(e){var t;if(e.y!=null)return rf([e.y]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.y);return r==null||r.length===0?[]:rf(r)}var AV=(e,t)=>{if(e!=null){var r=e.flatMap(n=>t==="xAxis"?X5e(n):Q5e(n));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},J5e=Qt([G5e,Fa],AV),Z5e=Qt(K5e,J5e,Y5e,(e,t,r)=>Dw(e,r,t)),WE=(e,t,r,n,i,s,o,l)=>{if(r!=null)return r;var c=o==="vertical"&&l==="xAxis"||o==="horizontal"&&l==="yAxis",u=c?Dw(n,s,i):Dw(s,i);return h5e(t,u,e.allowDataOverflow)},eje=Qt([Ya,$E,UE,$5e,z5e,Z5e,Oi,Fa],WE,{memoizeOptions:{resultEqualityCheck:j_}}),tje=[0,1],qE=(e,t,r,n,i,s,o)=>{if(!((e==null||r==null||r.length===0)&&o===void 0)){var{dataKey:l,type:c}=e,u=hf(t,s);if(u&&l==null){var d;return dH(0,(d=r==null?void 0:r.length)!==null&&d!==void 0?d:0)}return c==="category"?q5e(n,e,u):i==="expand"?tje:o}},HE=Qt([Ya,Oi,BE,A_,jy,Fa,eje],qE);function rje(e){return e in xx}var NV=(e,t,r)=>{if(e!=null){var{scale:n,type:i}=e;if(n==="auto")return i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!t)?"point":i==="category"?"band":"linear";if(typeof n=="string"){var s="scale".concat(hy(n));return rje(s)?s:"point"}}},Ph=Qt([Ya,mV,kE],NV);function VE(e,t,r,n){if(!(r==null||n==null))return typeof e.scale=="function"?iR(e.scale,r,n):iR(t,r,n)}var GE=(e,t,r)=>{var n=DE(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&tf(e))return y5e(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&tf(e))return b5e(e,t.tickCount,t.allowDecimals)}},KE=Qt([HE,wg,Ph],GE),YE=(e,t,r,n)=>{if(n!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&tf(t)&&Array.isArray(r)&&r.length>0){var i,s,o=t[0],l=(i=r[0])!==null&&i!==void 0?i:0,c=t[1],u=(s=r[r.length-1])!==null&&s!==void 0?s:0;return[Math.min(o,l),Math.max(c,u)]}return t},nje=Qt([Ya,HE,KE,Fa],YE),ije=Qt(A_,Ya,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(rf(e.map(f=>f.value))).sort((f,h)=>f-h),i=n[0],s=n[n.length-1];if(i==null||s==null)return 1/0;var o=s-i;if(o===0)return 1/0;for(var l=0;l<n.length-1;l++){var c=n[l],u=n[l+1];if(!(c==null||u==null)){var d=u-c;r=Math.min(r,d)}}return r/o}}),CV=Qt(ije,Oi,nV,Rs,(e,t,r,n,i)=>i,(e,t,r,n,i)=>{if(!pi(e))return 0;var s=t==="vertical"?n.height:n.width;if(i==="gap")return e*s/2;if(i==="no-gap"){var o=Wo(r,e*s),l=e*s/2;return l-o-(l-o)/s*o}return 0}),aje=(e,t,r)=>{var n=dd(e,t);return n==null||typeof n.padding!="string"?0:CV(e,"xAxis",t,r,n.padding)},sje=(e,t,r)=>{var n=fd(e,t);return n==null||typeof n.padding!="string"?0:CV(e,"yAxis",t,r,n.padding)},oje=Qt(dd,aje,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:i}=e;return typeof i=="string"?{left:t,right:t}:{left:((r=i.left)!==null&&r!==void 0?r:0)+t,right:((n=i.right)!==null&&n!==void 0?n:0)+t}}),lje=Qt(fd,sje,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:i}=e;return typeof i=="string"?{top:t,bottom:t}:{top:((r=i.top)!==null&&r!==void 0?r:0)+t,bottom:((n=i.bottom)!==null&&n!==void 0?n:0)+t}}),cje=Qt([Rs,oje,s_,a_,(e,t,r)=>r],(e,t,r,n,i)=>{var{padding:s}=n;return i?[s.left,r.width-s.right]:[e.left+t.left,e.left+e.width-t.right]}),uje=Qt([Rs,Oi,lje,s_,a_,(e,t,r)=>r],(e,t,r,n,i,s)=>{var{padding:o}=i;return s?[n.height-o.bottom,o.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),Ey=(e,t,r,n)=>{var i;switch(t){case"xAxis":return cje(e,r,n);case"yAxis":return uje(e,r,n);case"zAxis":return(i=OE(e,r))===null||i===void 0?void 0:i.range;case"angleAxis":return lV(e);case"radiusAxis":return cV(e,r);default:return}},EV=Qt([Ya,Ey],v_),dje=Qt([Ph,nje],fV),Qm=Qt([Ya,Ph,dje,EV],VE);Qt([Ny,N_,Fa],U5e);function TV(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var C_=(e,t)=>t,E_=(e,t,r)=>r,fje=Qt(n_,C_,E_,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(TV)),hje=Qt(i_,C_,E_,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(TV)),PV=(e,t)=>({width:e.width,height:t.height}),pje=(e,t)=>{var r=typeof t.width=="number"?t.width:gy;return{width:r,height:e.height}},OV=Qt(Rs,dd,PV),mje=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},gje=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},xje=Qt(mf,Rs,fje,C_,E_,(e,t,r,n,i)=>{var s={},o;return r.forEach(l=>{var c=PV(t,l);o==null&&(o=mje(t,n,e));var u=n==="top"&&!i||n==="bottom"&&i;s[l.id]=o-Number(u)*c.height,o+=(u?-1:1)*c.height}),s}),yje=Qt(pf,Rs,hje,C_,E_,(e,t,r,n,i)=>{var s={},o;return r.forEach(l=>{var c=pje(t,l);o==null&&(o=gje(t,n,e));var u=n==="left"&&!i||n==="right"&&i;s[l.id]=o-Number(u)*c.width,o+=(u?-1:1)*c.width}),s}),bje=(e,t)=>{var r=dd(e,t);if(r!=null)return xje(e,r.orientation,r.mirror)},vje=Qt([Rs,dd,bje,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var i=r==null?void 0:r[n];return i==null?{x:e.left,y:0}:{x:e.left,y:i}}}),wje=(e,t)=>{var r=fd(e,t);if(r!=null)return yje(e,r.orientation,r.mirror)},Sje=Qt([Rs,fd,wje,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var i=r==null?void 0:r[n];return i==null?{x:0,y:e.top}:{x:i,y:e.top}}}),MV=Qt(Rs,fd,(e,t)=>{var r=typeof t.width=="number"?t.width:gy;return{width:r,height:e.height}}),oR=(e,t,r)=>{switch(t){case"xAxis":return OV(e,r).width;case"yAxis":return MV(e,r).height;default:return}},LV=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:i,type:s,dataKey:o}=r,l=hf(e,n),c=t.map(u=>u.value);if(o&&l&&s==="category"&&i&&yW(c))return c}},XE=Qt([Oi,A_,Ya,Fa],LV),RV=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:i,scale:s}=r,o=hf(e,n);if(o&&(i==="number"||s!=="auto"))return t.map(l=>l.value)}},QE=Qt([Oi,A_,wg,Fa],RV),lR=Qt([Oi,M5e,Ph,Qm,XE,QE,Ey,KE,Fa],(e,t,r,n,i,s,o,l,c)=>{if(t!=null){var u=hf(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:s,duplicateDomain:i,isCategorical:u,niceTicks:l,range:o,realScaleType:r,scale:n}}}),_je=(e,t,r,n,i,s,o,l,c)=>{if(!(t==null||n==null)){var u=hf(e,c),{type:d,ticks:f,tickCount:h}=t,p=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,m=d==="category"&&n.bandwidth?n.bandwidth()/p:0;m=c==="angleAxis"&&s!=null&&s.length>=2?Qs(s[0]-s[1])*2*m:m;var g=f||i;return g?g.map((y,b)=>{var v=o?o.indexOf(y):y,w=n.map(v);return pi(w)?{index:b,coordinate:w+m,value:y,offset:m}:null}).filter(_l):u&&l?l.map((y,b)=>{var v=n.map(y);return pi(v)?{coordinate:v+m,value:y,index:b,offset:m}:null}).filter(_l):n.ticks?n.ticks(h).map((y,b)=>{var v=n.map(y);return pi(v)?{coordinate:v+m,value:y,index:b,offset:m}:null}).filter(_l):n.domain().map((y,b)=>{var v=n.map(y);return pi(v)?{coordinate:v+m,value:o?o[y]:y,index:b,offset:m}:null}).filter(_l)}},FV=Qt([Oi,wg,Ph,Qm,KE,Ey,XE,QE,Fa],_je),jje=(e,t,r,n,i,s,o)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var l=hf(e,o),{tickCount:c}=t,u=0;return u=o==="angleAxis"&&(n==null?void 0:n.length)>=2?Qs(n[0]-n[1])*2*u:u,l&&s?s.map((d,f)=>{var h=r.map(d);return pi(h)?{coordinate:h+u,value:d,index:f,offset:u}:null}).filter(_l):r.ticks?r.ticks(c).map((d,f)=>{var h=r.map(d);return pi(h)?{coordinate:h+u,value:d,index:f,offset:u}:null}).filter(_l):r.domain().map((d,f)=>{var h=r.map(d);return pi(h)?{coordinate:h+u,value:i?i[d]:d,index:f,offset:u}:null}).filter(_l)}},sd=Qt([Oi,wg,Qm,Ey,XE,QE,Fa],jje),od=Qt(Ya,Qm,(e,t)=>{if(!(e==null||t==null))return Iw(Iw({},e),{},{scale:t})}),kje=Qt([Ya,Ph,HE,EV],VE),Aje=Qt((e,t,r)=>OE(e,r),kje,(e,t)=>{if(!(e==null||t==null))return Iw(Iw({},e),{},{scale:t})}),Nje=Qt([Oi,n_,i_],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),BV=e=>e.options.defaultTooltipEventType,IV=e=>e.options.validateTooltipEventTypes;function DV(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function JE(e,t){var r=BV(e),n=IV(e);return DV(t,r,n)}function Cje(e){return jn(t=>JE(t,e))}var $V=(e,t)=>{var r,n=Number(t);if(!(nd(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},Eje=e=>e.tooltip.settings,Uf={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},Tje={itemInteraction:{click:Uf,hover:Uf},axisInteraction:{click:Uf,hover:Uf},keyboardInteraction:Uf,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},UV=Ll({name:"tooltip",initialState:Tje,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:wa()},replaceTooltipEntrySettings:{reducer(e,t){var{prev:r,next:n}=t.payload,i=xu(e).tooltipItemPayloads.indexOf(r);i>-1&&(e.tooltipItemPayloads[i]=n)},prepare:wa()},removeTooltipEntrySettings:{reducer(e,t){var r=xu(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},prepare:wa()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate}}}),{addTooltipEntrySettings:Pje,replaceTooltipEntrySettings:Oje,removeTooltipEntrySettings:Mje,setTooltipSettingsState:Lje,setActiveMouseOverItemIndex:zV,mouseLeaveItem:Rje,mouseLeaveChart:WV,setActiveClickItemIndex:Fje,setMouseOverAxisIndex:qV,setMouseClickAxisIndex:Bje,setSyncInteraction:KA,setKeyboardInteraction:YA}=UV.actions,Ije=UV.reducer;function cR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function fv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cR(Object(r),!0).forEach(function(n){Dje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Dje(e,t,r){return(t=$je(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $je(e){var t=Uje(e,"string");return typeof t=="symbol"?t:t+""}function Uje(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zje(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function Wje(e){return e.index!=null}var HV=(e,t,r,n)=>{if(t==null)return Uf;var i=zje(e,t,r);if(i==null)return Uf;if(i.active)return i;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var s=e.settings.active===!0;if(Wje(i)){if(s)return fv(fv({},i),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n,graphicalItemId:void 0};return fv(fv({},Uf),{},{coordinate:i.coordinate})};function qje(e){if(typeof e=="number")return Number.isFinite(e)?e:void 0;if(e instanceof Date){var t=e.valueOf();return Number.isFinite(t)?t:void 0}var r=Number(e);return Number.isFinite(r)?r:void 0}function Hje(e,t){var r=qje(e),n=t[0],i=t[1];if(r===void 0)return!1;var s=Math.min(n,i),o=Math.max(n,i);return r>=s&&r<=o}function Vje(e,t,r){if(r==null||t==null)return!0;var n=Ti(e,t);return n==null||!tf(r)?!0:Hje(n,r)}var ZE=(e,t,r,n)=>{var i=e==null?void 0:e.index;if(i==null)return null;var s=Number(i);if(!pi(s))return i;var o=0,l=1/0;t.length>0&&(l=t.length-1);var c=Math.max(o,Math.min(s,l)),u=t[c];return u==null||Vje(u,r,n)?String(c):null},VV=(e,t,r,n,i,s,o)=>{if(s!=null){var l=o[0],c=l==null?void 0:l.getPosition(s);if(c!=null)return c;var u=i==null?void 0:i[Number(s)];if(u)switch(r){case"horizontal":return{x:u.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:u.coordinate}}}},GV=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var i;if(r==="hover"?i=e.itemInteraction.hover.graphicalItemId:i=e.itemInteraction.click.graphicalItemId,i==null&&n!=null){var s=e.tooltipItemPayloads[0];return s!=null?[s]:[]}return e.tooltipItemPayloads.filter(o=>{var l;return((l=o.settings)===null||l===void 0?void 0:l.graphicalItemId)===i})},KV=e=>e.options.tooltipPayloadSearcher,_g=e=>e.tooltip;function uR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function dR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uR(Object(r),!0).forEach(function(n){Gje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Gje(e,t,r){return(t=Kje(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kje(e){var t=Yje(e,"string");return typeof t=="symbol"?t:t+""}function Yje(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xje(e,t){return e??t}var YV=(e,t,r,n,i,s,o)=>{if(!(t==null||s==null)){var{chartData:l,computedData:c,dataStartIndex:u,dataEndIndex:d}=r,f=[];return e.reduce((h,p)=>{var m,{dataDefinedOnItem:g,settings:y}=p,b=Xje(g,l),v=Array.isArray(b)?Cq(b,u,d):b,w=(m=y==null?void 0:y.dataKey)!==null&&m!==void 0?m:n,S=y==null?void 0:y.nameKey,j;if(n&&Array.isArray(v)&&!Array.isArray(v[0])&&o==="axis"?j=bW(v,n,i):j=s(v,t,c,S),Array.isArray(j))j.forEach(A=>{var R=dR(dR({},y),{},{name:A.name,unit:A.unit,color:void 0,fill:void 0});h.push(xL({tooltipEntrySettings:R,dataKey:A.dataKey,payload:A.payload,value:Ti(A.payload,A.dataKey),name:A.name}))});else{var k;h.push(xL({tooltipEntrySettings:y,dataKey:w,payload:j,value:Ti(j,w),name:(k=Ti(j,S))!==null&&k!==void 0?k:y==null?void 0:y.name}))}return h},f)}},e6=Qt([Is,mV,kE],NV),Qje=Qt([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),Jje=Qt([eo,vg],ME),jg=Qt([Qje,Is,Jje],LE,{memoizeOptions:{resultEqualityCheck:k_}}),Zje=Qt([jg],e=>e.filter(__)),eke=Qt([jg],RE,{memoizeOptions:{resultEqualityCheck:k_}}),kg=Qt([eke,xf],FE),tke=Qt([Zje,xf,Is],dV),t6=Qt([kg,Is,jg],IE),XV=Qt([Is],DE),rke=Qt([Is],e=>e.allowDataOverflow),QV=Qt([XV,rke],HH),nke=Qt([jg],e=>e.filter(__)),ike=Qt([tke,nke,jy,iV],bV),ake=Qt([ike,xf,eo,QV],vV),ske=Qt([jg],xV),oke=Qt([kg,Is,ske,N_,eo],zE,{memoizeOptions:{resultEqualityCheck:j_}}),lke=Qt([wV,eo,vg],Sg),cke=Qt([lke,eo],jV),uke=Qt([SV,eo,vg],Sg),dke=Qt([uke,eo],kV),fke=Qt([_V,eo,vg],Sg),hke=Qt([fke,eo],AV),pke=Qt([cke,hke,dke],Dw),mke=Qt([Is,XV,QV,ake,oke,pke,Oi,eo],WE),Ty=Qt([Is,Oi,kg,t6,jy,eo,mke],qE),gke=Qt([Ty,Is,e6],GE),xke=Qt([Is,Ty,gke,eo],YE),JV=e=>{var t=eo(e),r=vg(e),n=!1;return Ey(e,t,r,n)},ZV=Qt([Is,JV],v_),eG=Qt([Is,e6,xke,ZV],VE),yke=Qt([Oi,t6,Is,eo],LV),bke=Qt([Oi,t6,Is,eo],RV),vke=(e,t,r,n,i,s,o,l)=>{if(t){var{type:c}=t,u=hf(e,l);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,f=c==="category"&&n.bandwidth?n.bandwidth()/d:0;return f=l==="angleAxis"&&i!=null&&(i==null?void 0:i.length)>=2?Qs(i[0]-i[1])*2*f:f,u&&o?o.map((h,p)=>{var m=n.map(h);return pi(m)?{coordinate:m+f,value:h,index:p,offset:f}:null}).filter(_l):n.domain().map((h,p)=>{var m=n.map(h);return pi(m)?{coordinate:m+f,value:s?s[h]:h,index:p,offset:f}:null}).filter(_l)}}},yf=Qt([Oi,Is,e6,eG,JV,yke,bke,eo],vke),r6=Qt([BV,IV,Eje],(e,t,r)=>DV(r.shared,e,t)),tG=e=>e.tooltip.settings.trigger,n6=e=>e.tooltip.settings.defaultIndex,Py=Qt([_g,r6,tG,n6],HV),nf=Qt([Py,kg,Cy,Ty],ZE),rG=Qt([yf,nf],$V),i6=Qt([Py],e=>{if(e)return e.dataKey}),wke=Qt([Py],e=>{if(e)return e.graphicalItemId}),nG=Qt([_g,r6,tG,n6],GV),Ske=Qt([pf,mf,Oi,Rs,yf,n6,nG],VV),_ke=Qt([Py,Ske],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),jke=Qt([Py],e=>{var t;return(t=e==null?void 0:e.active)!==null&&t!==void 0?t:!1}),kke=Qt([nG,nf,xf,Cy,rG,KV,r6],YV),Ake=Qt([kke],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function fR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function hR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fR(Object(r),!0).forEach(function(n){Nke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Nke(e,t,r){return(t=Cke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cke(e){var t=Eke(e,"string");return typeof t=="symbol"?t:t+""}function Eke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tke=()=>jn(Is),Pke=()=>{var e=Tke(),t=jn(yf),r=jn(eG);return Hm(!e||!r?void 0:hR(hR({},e),{},{scale:r}),t)};function pR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Tp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pR(Object(r),!0).forEach(function(n){Oke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Oke(e,t,r){return(t=Mke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mke(e){var t=Lke(e,"string");return typeof t=="symbol"?t:t+""}function Lke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rke=(e,t,r,n)=>{var i=t.find(s=>s&&s.index===r);if(i){if(e==="horizontal")return{x:i.coordinate,y:n.chartY};if(e==="vertical")return{x:n.chartX,y:i.coordinate}}return{x:0,y:0}},Fke=(e,t,r,n)=>{var i=t.find(u=>u&&u.index===r);if(i){if(e==="centric"){var s=i.coordinate,{radius:o}=n;return Tp(Tp(Tp({},n),vs(n.cx,n.cy,o,s)),{},{angle:s,radius:o})}var l=i.coordinate,{angle:c}=n;return Tp(Tp(Tp({},n),vs(n.cx,n.cy,l,c)),{},{angle:c,radius:l})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function Bke(e,t){var{chartX:r,chartY:n}=e;return r>=t.left&&r<=t.left+t.width&&n>=t.top&&n<=t.top+t.height}var iG=(e,t,r,n,i)=>{var s,o=(s=t==null?void 0:t.length)!==null&&s!==void 0?s:0;if(o<=1||e==null)return 0;if(n==="angleAxis"&&i!=null&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var l=0;l<o;l++){var c,u,d,f,h,p=l>0?(c=r[l-1])===null||c===void 0?void 0:c.coordinate:(u=r[o-1])===null||u===void 0?void 0:u.coordinate,m=(d=r[l])===null||d===void 0?void 0:d.coordinate,g=l>=o-1?(f=r[0])===null||f===void 0?void 0:f.coordinate:(h=r[l+1])===null||h===void 0?void 0:h.coordinate,y=void 0;if(!(p==null||m==null||g==null))if(Qs(m-p)!==Qs(g-m)){var b=[];if(Qs(g-m)===Qs(i[1]-i[0])){y=g;var v=m+i[1]-i[0];b[0]=Math.min(v,(v+p)/2),b[1]=Math.max(v,(v+p)/2)}else{y=p;var w=g+i[1]-i[0];b[0]=Math.min(m,(w+m)/2),b[1]=Math.max(m,(w+m)/2)}var S=[Math.min(m,(y+m)/2),Math.max(m,(y+m)/2)];if(e>S[0]&&e<=S[1]||e>=b[0]&&e<=b[1]){var j;return(j=r[l])===null||j===void 0?void 0:j.index}}else{var k=Math.min(p,g),A=Math.max(p,g);if(e>(k+m)/2&&e<=(A+m)/2){var R;return(R=r[l])===null||R===void 0?void 0:R.index}}}else if(t)for(var M=0;M<o;M++){var B=t[M];if(B!=null){var E=t[M+1],P=t[M-1];if(M===0&&E!=null&&e<=(B.coordinate+E.coordinate)/2||M===o-1&&P!=null&&e>(B.coordinate+P.coordinate)/2||M>0&&M<o-1&&P!=null&&E!=null&&e>(B.coordinate+P.coordinate)/2&&e<=(B.coordinate+E.coordinate)/2)return B.index}}return-1},Ike=()=>jn(kE),a6=(e,t)=>t,aG=(e,t,r)=>r,s6=(e,t,r,n)=>n,Dke=Qt(yf,e=>GS(e,t=>t.coordinate)),o6=Qt([_g,a6,aG,s6],HV),l6=Qt([o6,kg,Cy,Ty],ZE),$ke=(e,t,r)=>{if(t!=null){var n=_g(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},sG=Qt([_g,a6,aG,s6],GV),$w=Qt([pf,mf,Oi,Rs,yf,s6,sG],VV),Uke=Qt([o6,$w],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),oG=Qt([yf,l6],$V),zke=Qt([sG,l6,xf,Cy,oG,KV,a6],YV),Wke=Qt([o6,l6],(e,t)=>({isActive:e.active&&t!=null,activeIndex:t})),qke=(e,t,r,n,i,s,o)=>{if(!(!e||!r||!n||!i)&&Bke(e,o)){var l=bve(e,t),c=iG(l,s,i,r,n),u=Rke(t,i,c,e);return{activeIndex:String(c),activeCoordinate:u}}},Hke=(e,t,r,n,i,s,o)=>{if(!(!e||!n||!i||!s||!r)){var l=Owe(e,r);if(l){var c=vve(l,t),u=iG(c,o,s,n,i),d=Fke(t,s,u,l);return{activeIndex:String(u),activeCoordinate:d}}}},Vke=(e,t,r,n,i,s,o,l)=>{if(!(!e||!t||!n||!i||!s))return t==="horizontal"||t==="vertical"?qke(e,t,n,i,s,o,l):Hke(e,t,r,n,i,s,o)},Gke=Qt(e=>e.zIndex.zIndexMap,(e,t)=>t,(e,t,r)=>r,(e,t,r)=>{if(t!=null){var n=e[t];if(n!=null)return r?n.panoramaElement:n.element}}),Kke=Qt(e=>e.zIndex.zIndexMap,e=>{var t=Object.keys(e).map(n=>parseInt(n,10)).concat(Object.values(Oa)),r=Array.from(new Set(t));return r.sort((n,i)=>n-i)},{memoizeOptions:{resultEqualityCheck:C5e}});function mR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function gR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mR(Object(r),!0).forEach(function(n){Yke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Yke(e,t,r){return(t=Xke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xke(e){var t=Qke(e,"string");return typeof t=="symbol"?t:t+""}function Qke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jke={},Zke={zIndexMap:Object.values(Oa).reduce((e,t)=>gR(gR({},e),{},{[t]:{element:void 0,panoramaElement:void 0,consumers:0}}),Jke)},e4e=new Set(Object.values(Oa));function t4e(e){return e4e.has(e)}var lG=Ll({name:"zIndex",initialState:Zke,reducers:{registerZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]?e.zIndexMap[r].consumers+=1:e.zIndexMap[r]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:wa()},unregisterZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(e.zIndexMap[r].consumers-=1,e.zIndexMap[r].consumers<=0&&!t4e(r)&&delete e.zIndexMap[r])},prepare:wa()},registerZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r,element:n,isPanorama:i}=t.payload;e.zIndexMap[r]?i?e.zIndexMap[r].panoramaElement=n:e.zIndexMap[r].element=n:e.zIndexMap[r]={consumers:0,element:i?void 0:n,panoramaElement:i?n:void 0}},prepare:wa()},unregisterZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(t.payload.isPanorama?e.zIndexMap[r].panoramaElement=void 0:e.zIndexMap[r].element=void 0)},prepare:wa()}}}),{registerZIndexPortal:r4e,unregisterZIndexPortal:n4e,registerZIndexPortalElement:i4e,unregisterZIndexPortalElement:a4e}=lG.actions,s4e=lG.reducer;function wo(e){var{zIndex:t,children:r}=e,n=Gve(),i=n&&t!==void 0&&t!==0,s=Fs(),o=Zi();x.useLayoutEffect(()=>i?(o(r4e({zIndex:t})),()=>{o(n4e({zIndex:t}))}):ap,[o,t,i]);var l=jn(c=>Gke(c,t,s));return i?l?Y1.createPortal(r,l):null:r}function XA(){return XA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},XA.apply(null,arguments)}function xR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function hv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xR(Object(r),!0).forEach(function(n){o4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function o4e(e,t,r){return(t=l4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l4e(e){var t=c4e(e,"string");return typeof t=="symbol"?t:t+""}function c4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function u4e(e){var{cursor:t,cursorComp:r,cursorProps:n}=e;return x.isValidElement(t)?x.cloneElement(t,n):x.createElement(r,n)}function d4e(e){var t,{coordinate:r,payload:n,index:i,offset:s,tooltipAxisBandSize:o,layout:l,cursor:c,tooltipEventType:u,chartName:d}=e,f=r,h=n,p=i;if(!c||!f||d!=="ScatterChart"&&u!=="axis")return null;var m,g,y;if(d==="ScatterChart")m=f,g=V2e,y=Oa.cursorLine;else if(d==="BarChart")m=G2e(l,f,s,o),g=nH,y=Oa.cursorRectangle;else if(l==="radial"&&wW(f)){var{cx:b,cy:v,radius:w,startAngle:S,endAngle:j}=aH(f);m={cx:b,cy:v,startAngle:S,endAngle:j,innerRadius:w,outerRadius:w},g=oH,y=Oa.cursorLine}else m={points:Fwe(l,f,s)},g=u_,y=Oa.cursorLine;var k=typeof c=="object"&&"className"in c?c.className:void 0,A=hv(hv(hv(hv({stroke:"#ccc",pointerEvents:"none"},s),m),yh(c)),{},{payload:h,payloadIndex:p,className:_i("recharts-tooltip-cursor",k)});return x.createElement(wo,{zIndex:(t=e.zIndex)!==null&&t!==void 0?t:y},x.createElement(u4e,{cursor:c,cursorComp:g,cursorProps:A}))}function f4e(e){var t=Pke(),r=Dq(),n=sp(),i=Ike();return t==null||r==null||n==null||i==null?null:x.createElement(d4e,XA({},e,{offset:r,layout:n,tooltipAxisBandSize:t,chartName:i}))}var cG=x.createContext(null),h4e=()=>x.useContext(cG),uG={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function s(c,u,d,f,h){if(typeof d!="function")throw new TypeError("The listener must be a function");var p=new i(d,f||c,h),m=r?r+u:u;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],p]:c._events[m].push(p):(c._events[m]=p,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)t.call(d,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=r?r+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,p=f.length,m=new Array(p);h<p;h++)m[h]=f[h].fn;return m},l.prototype.listenerCount=function(u){var d=r?r+u:u,f=this._events[d];return f?f.fn?1:f.length:0},l.prototype.emit=function(u,d,f,h,p,m){var g=r?r+u:u;if(!this._events[g])return!1;var y=this._events[g],b=arguments.length,v,w;if(y.fn){switch(y.once&&this.removeListener(u,y.fn,void 0,!0),b){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,d),!0;case 3:return y.fn.call(y.context,d,f),!0;case 4:return y.fn.call(y.context,d,f,h),!0;case 5:return y.fn.call(y.context,d,f,h,p),!0;case 6:return y.fn.call(y.context,d,f,h,p,m),!0}for(w=1,v=new Array(b-1);w<b;w++)v[w-1]=arguments[w];y.fn.apply(y.context,v)}else{var S=y.length,j;for(w=0;w<S;w++)switch(y[w].once&&this.removeListener(u,y[w].fn,void 0,!0),b){case 1:y[w].fn.call(y[w].context);break;case 2:y[w].fn.call(y[w].context,d);break;case 3:y[w].fn.call(y[w].context,d,f);break;case 4:y[w].fn.call(y[w].context,d,f,h);break;default:if(!v)for(j=1,v=new Array(b-1);j<b;j++)v[j-1]=arguments[j];y[w].fn.apply(y[w].context,v)}}return!0},l.prototype.on=function(u,d,f){return s(this,u,d,f,!1)},l.prototype.once=function(u,d,f){return s(this,u,d,f,!0)},l.prototype.removeListener=function(u,d,f,h){var p=r?r+u:u;if(!this._events[p])return this;if(!d)return o(this,p),this;var m=this._events[p];if(m.fn)m.fn===d&&(!h||m.once)&&(!f||m.context===f)&&o(this,p);else{for(var g=0,y=[],b=m.length;g<b;g++)(m[g].fn!==d||h&&!m[g].once||f&&m[g].context!==f)&&y.push(m[g]);y.length?this._events[p]=y.length===1?y[0]:y:o(this,p)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&o(this,d)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(uG);var p4e=uG.exports;const m4e=sf(p4e);var I1=new m4e,QA="recharts.syncEvent.tooltip",yR="recharts.syncEvent.brush",T_=(e,t)=>{if(t&&Array.isArray(e)){var r=Number.parseInt(t,10);if(!nd(r))return e[r]}},g4e={chartName:"",tooltipPayloadSearcher:()=>{},eventEmitter:void 0,defaultTooltipEventType:"axis"},dG=Ll({name:"options",initialState:g4e,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),x4e=dG.reducer,{createEventEmitter:y4e}=dG.actions;function b4e(e){return e.tooltip.syncInteraction}var v4e={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},fG=Ll({name:"chartData",initialState:v4e,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:bR,setDataStartEndIndexes:w4e,setComputedData:NMe}=fG.actions,S4e=fG.reducer,_4e=["x","y"];function vR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Pp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vR(Object(r),!0).forEach(function(n){j4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function j4e(e,t,r){return(t=k4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k4e(e){var t=A4e(e,"string");return typeof t=="symbol"?t:t+""}function A4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function N4e(e,t){if(e==null)return{};var r,n,i=C4e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function C4e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function E4e(){var e=jn(AE),t=jn(NE),r=Zi(),n=jn(aV),i=jn(yf),s=sp(),o=pg(),l=jn(c=>c.rootProps.className);x.useEffect(()=>{if(e==null)return ap;var c=(u,d,f)=>{if(t!==f&&e===u){if(n==="index"){var h;if(o&&d!==null&&d!==void 0&&(h=d.payload)!==null&&h!==void 0&&h.coordinate&&d.payload.sourceViewBox){var p=d.payload.coordinate,{x:m,y:g}=p,y=N4e(p,_4e),{x:b,y:v,width:w,height:S}=d.payload.sourceViewBox,j=Pp(Pp({},y),{},{x:o.x+(w?(m-b)/w:0)*o.width,y:o.y+(S?(g-v)/S:0)*o.height});r(Pp(Pp({},d),{},{payload:Pp(Pp({},d.payload),{},{coordinate:j})}))}else r(d);return}if(i!=null){var k;if(typeof n=="function"){var A={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},R=n(i,A);k=i[R]}else n==="value"&&(k=i.find(oe=>String(oe.value)===d.payload.label));var{coordinate:M}=d.payload;if(k==null||d.payload.active===!1||M==null||o==null){r(KA({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:B,y:E}=M,P=Math.min(B,o.x+o.width),U=Math.min(E,o.y+o.height),G={x:s==="horizontal"?k.coordinate:P,y:s==="horizontal"?U:k.coordinate},H=KA({active:d.payload.active,coordinate:G,dataKey:d.payload.dataKey,index:String(k.index),label:d.payload.label,sourceViewBox:d.payload.sourceViewBox,graphicalItemId:d.payload.graphicalItemId});r(H)}}};return I1.on(QA,c),()=>{I1.off(QA,c)}},[l,r,t,e,n,i,s,o])}function T4e(){var e=jn(AE),t=jn(NE),r=Zi();x.useEffect(()=>{if(e==null)return ap;var n=(i,s,o)=>{t!==o&&e===i&&r(w4e(s))};return I1.on(yR,n),()=>{I1.off(yR,n)}},[r,t,e])}function P4e(){var e=Zi();x.useEffect(()=>{e(y4e())},[e]),E4e(),T4e()}function O4e(e,t,r,n,i,s){var o=jn(p=>$ke(p,e,t)),l=jn(NE),c=jn(AE),u=jn(aV),d=jn(b4e),f=d==null?void 0:d.active,h=pg();x.useEffect(()=>{if(!f&&c!=null&&l!=null){var p=KA({active:s,coordinate:r,dataKey:o,index:i,label:typeof n=="number"?String(n):n,sourceViewBox:h,graphicalItemId:void 0});I1.emit(QA,c,p,l)}},[f,r,o,i,n,l,c,u,s,h])}function wR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function SR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wR(Object(r),!0).forEach(function(n){M4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function M4e(e,t,r){return(t=L4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L4e(e){var t=R4e(e,"string");return typeof t=="symbol"?t:t+""}function R4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function F4e(e){return e.dataKey}function B4e(e,t){return x.isValidElement(e)?x.cloneElement(e,t):typeof e=="function"?x.createElement(e,t):x.createElement(k2e,t)}var _R=[],I4e={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Oy(e){var t,r,n=ka(e,I4e),{active:i,allowEscapeViewBox:s,animationDuration:o,animationEasing:l,content:c,filterNull:u,isAnimationActive:d,offset:f,payloadUniqBy:h,position:p,reverseDirection:m,useTranslate3d:g,wrapperStyle:y,cursor:b,shared:v,trigger:w,defaultIndex:S,portal:j,axisId:k}=n,A=Zi(),R=typeof S=="number"?String(S):S;x.useEffect(()=>{A(Lje({shared:v,trigger:w,axisId:k,active:i,defaultIndex:R}))},[A,v,w,k,i,R]);var M=pg(),B=Jq(),E=Cje(v),{activeIndex:P,isActive:U}=(t=jn(F=>Wke(F,E,w,R)))!==null&&t!==void 0?t:{},G=jn(F=>zke(F,E,w,R)),H=jn(F=>oG(F,E,w,R)),oe=jn(F=>Uke(F,E,w,R)),de=G,W=h4e(),V=(r=i??U)!==null&&r!==void 0?r:!1,[ae,ee]=JW([de,V]),C=E==="axis"?H:void 0;O4e(E,w,oe,C,P,V);var Y=j??W;if(Y==null||M==null||E==null)return null;var q=de??_R;V||(q=_R),u&&q.length&&(q=$W(q.filter(F=>F.value!=null&&(F.hide!==!0||n.includeHidden)),h,F4e));var O=q.length>0,X=x.createElement(O2e,{allowEscapeViewBox:s,animationDuration:o,animationEasing:l,isAnimationActive:d,active:V,coordinate:oe,hasPayload:O,offset:f,position:p,reverseDirection:m,useTranslate3d:g,viewBox:M,wrapperStyle:y,lastBoundingBox:ae,innerRef:ee,hasPortalFromProps:!!j},B4e(c,SR(SR({},n),{},{payload:q,label:C,active:V,activeIndex:P,coordinate:oe,accessibilityLayer:B})));return x.createElement(x.Fragment,null,Y1.createPortal(X,Y),V&&x.createElement(f4e,{cursor:b,tooltipEventType:E,coordinate:oe,payload:q,index:P}))}var cp=e=>null;cp.displayName="Cell";function D4e(e,t,r){return(t=$4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $4e(e){var t=U4e(e,"string");return typeof t=="symbol"?t:t+""}function U4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class z4e{constructor(t){D4e(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;n!=null&&this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function jR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function W4e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jR(Object(r),!0).forEach(function(n){q4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function q4e(e,t,r){return(t=H4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function H4e(e){var t=V4e(e,"string");return typeof t=="symbol"?t:t+""}function V4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var G4e={cacheSize:2e3,enableCache:!0},hG=W4e({},G4e),kR=new z4e(hG.cacheSize),K4e={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},AR="recharts_measurement_span";function Y4e(e,t){var r=t.fontSize||"",n=t.fontFamily||"",i=t.fontWeight||"",s=t.fontStyle||"",o=t.letterSpacing||"",l=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(i,"|").concat(s,"|").concat(o,"|").concat(l)}var NR=(e,t)=>{try{var r=document.getElementById(AR);r||(r=document.createElement("span"),r.setAttribute("id",AR),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,K4e,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},$x=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||d_.isSsr)return{width:0,height:0};if(!hG.enableCache)return NR(t,r);var n=Y4e(t,r),i=kR.get(n);if(i)return i;var s=NR(t,r);return kR.set(n,s),s},pG;function X4e(e,t,r){return(t=Q4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q4e(e){var t=J4e(e,"string");return typeof t=="symbol"?t:t+""}function J4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CR=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,ER=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Z4e=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,eAe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,tAe={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},rAe=["cm","mm","pt","pc","in","Q","px"];function nAe(e){return rAe.includes(e)}var im="NaN";function iAe(e,t){return e*tAe[t]}class mo{static parse(t){var r,[,n,i]=(r=eAe.exec(t))!==null&&r!==void 0?r:[];return n==null?mo.NaN:new mo(parseFloat(n),i??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,nd(t)&&(this.unit=""),r!==""&&!Z4e.test(r)&&(this.num=NaN,this.unit=""),nAe(r)&&(this.num=iAe(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new mo(NaN,""):new mo(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new mo(NaN,""):new mo(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new mo(NaN,""):new mo(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new mo(NaN,""):new mo(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return nd(this.num)}}pG=mo;X4e(mo,"NaN",new pG(NaN,""));function mG(e){if(e==null||e.includes(im))return im;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,i,s]=(r=CR.exec(t))!==null&&r!==void 0?r:[],o=mo.parse(n??""),l=mo.parse(s??""),c=i==="*"?o.multiply(l):o.divide(l);if(c.isNaN())return im;t=t.replace(CR,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var u,[,d,f,h]=(u=ER.exec(t))!==null&&u!==void 0?u:[],p=mo.parse(d??""),m=mo.parse(h??""),g=f==="+"?p.add(m):p.subtract(m);if(g.isNaN())return im;t=t.replace(ER,g.toString())}return t}var TR=/\(([^()]*)\)/;function aAe(e){for(var t=e,r;(r=TR.exec(t))!=null;){var[,n]=r;t=t.replace(TR,mG(n))}return t}function sAe(e){var t=e.replace(/\s+/g,"");return t=aAe(t),t=mG(t),t}function oAe(e){try{return sAe(e)}catch{return im}}function ak(e){var t=oAe(e.slice(5,-1));return t===im?"":t}var lAe=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],cAe=["dx","dy","angle","className","breakAll"];function JA(){return JA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},JA.apply(null,arguments)}function PR(e,t){if(e==null)return{};var r,n,i=uAe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function uAe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var gG=/[ \f\n\r\t\v\u2028\u2029]+/,xG=e=>{var{children:t,breakAll:r,style:n}=e;try{var i=[];Qi(t)||(r?i=t.toString().split(""):i=t.toString().split(gG));var s=i.map(l=>({word:l,width:$x(l,n).width})),o=r?0:$x("",n).width;return{wordsWithComputedWidth:s,spaceWidth:o}}catch{return null}};function dAe(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var yG=(e,t,r,n)=>e.reduce((i,s)=>{var{word:o,width:l}=s,c=i[i.length-1];if(c&&l!=null&&(t==null||n||c.width+l+r<Number(t)))c.words.push(o),c.width+=l+r;else{var u={words:[o],width:l};i.push(u)}return i},[]),bG=e=>e.reduce((t,r)=>t.width>r.width?t:r),fAe="",OR=(e,t,r,n,i,s,o,l)=>{var c=e.slice(0,t),u=xG({breakAll:r,style:n,children:c+fAe});if(!u)return[!1,[]];var d=yG(u.wordsWithComputedWidth,s,o,l),f=d.length>i||bG(d).width>Number(s);return[f,d]},hAe=(e,t,r,n,i)=>{var{maxLines:s,children:o,style:l,breakAll:c}=e,u=En(s),d=String(o),f=yG(t,n,r,i);if(!u||i)return f;var h=f.length>s||bG(f).width>Number(n);if(!h)return f;for(var p=0,m=d.length-1,g=0,y;p<=m&&g<=d.length-1;){var b=Math.floor((p+m)/2),v=b-1,[w,S]=OR(d,v,c,l,s,n,r,i),[j]=OR(d,b,c,l,s,n,r,i);if(!w&&!j&&(p=b+1),w&&j&&(m=b-1),!w&&j){y=S;break}g++}return y||f},MR=e=>{var t=Qi(e)?[]:e.toString().split(gG);return[{words:t,width:void 0}]},pAe=e=>{var{width:t,scaleToFit:r,children:n,style:i,breakAll:s,maxLines:o}=e;if((t||r)&&!d_.isSsr){var l,c,u=xG({breakAll:s,children:n,style:i});if(u){var{wordsWithComputedWidth:d,spaceWidth:f}=u;l=d,c=f}else return MR(n);return hAe({breakAll:s,children:n,maxLines:o,style:i},l,c,t,!!r)}return MR(n)},vG="#808080",mAe={angle:0,breakAll:!1,capHeight:"0.71em",fill:vG,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},P_=x.forwardRef((e,t)=>{var r=ka(e,mAe),{x:n,y:i,lineHeight:s,capHeight:o,fill:l,scaleToFit:c,textAnchor:u,verticalAnchor:d}=r,f=PR(r,lAe),h=x.useMemo(()=>pAe({breakAll:f.breakAll,children:f.children,maxLines:f.maxLines,scaleToFit:c,style:f.style,width:f.width}),[f.breakAll,f.children,f.maxLines,c,f.style,f.width]),{dx:p,dy:m,angle:g,className:y,breakAll:b}=f,v=PR(f,cAe);if(!Hc(n)||!Hc(i)||h.length===0)return null;var w=Number(n)+(En(p)?p:0),S=Number(i)+(En(m)?m:0);if(!pi(w)||!pi(S))return null;var j;switch(d){case"start":j=ak("calc(".concat(o,")"));break;case"middle":j=ak("calc(".concat((h.length-1)/2," * -").concat(s," + (").concat(o," / 2))"));break;default:j=ak("calc(".concat(h.length-1," * -").concat(s,")"));break}var k=[],A=h[0];if(c&&A!=null){var R=A.width,{width:M}=f;k.push("scale(".concat(En(M)&&En(R)?M/R:1,")"))}return g&&k.push("rotate(".concat(g,", ").concat(w,", ").concat(S,")")),k.length&&(v.transform=k.join(" ")),x.createElement("text",JA({},Vo(v),{ref:t,x:w,y:S,className:_i("recharts-text",y),textAnchor:u,fill:l.includes("url")?vG:l}),h.map((B,E)=>{var P=B.words.join(b?"":" ");return x.createElement("tspan",{x:w,dy:E===0?j:s,key:"".concat(P,"-").concat(E)},P)}))});P_.displayName="Text";function LR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Bu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LR(Object(r),!0).forEach(function(n){gAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gAe(e,t,r){return(t=xAe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xAe(e){var t=yAe(e,"string");return typeof t=="symbol"?t:t+""}function yAe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bAe=e=>{var{viewBox:t,position:r,offset:n=0,parentViewBox:i}=e,{x:s,y:o,height:l,upperWidth:c,lowerWidth:u}=KC(t),d=s,f=s+(c-u)/2,h=(d+f)/2,p=(c+u)/2,m=d+c/2,g=l>=0?1:-1,y=g*n,b=g>0?"end":"start",v=g>0?"start":"end",w=c>=0?1:-1,S=w*n,j=w>0?"end":"start",k=w>0?"start":"end",A=i;if(r==="top"){var R={x:d+c/2,y:o-y,horizontalAnchor:"middle",verticalAnchor:b};return A&&(R.height=Math.max(o-A.y,0),R.width=c),R}if(r==="bottom"){var M={x:f+u/2,y:o+l+y,horizontalAnchor:"middle",verticalAnchor:v};return A&&(M.height=Math.max(A.y+A.height-(o+l),0),M.width=u),M}if(r==="left"){var B={x:h-S,y:o+l/2,horizontalAnchor:j,verticalAnchor:"middle"};return A&&(B.width=Math.max(B.x-A.x,0),B.height=l),B}if(r==="right"){var E={x:h+p+S,y:o+l/2,horizontalAnchor:k,verticalAnchor:"middle"};return A&&(E.width=Math.max(A.x+A.width-E.x,0),E.height=l),E}var P=A?{width:p,height:l}:{};return r==="insideLeft"?Bu({x:h+S,y:o+l/2,horizontalAnchor:k,verticalAnchor:"middle"},P):r==="insideRight"?Bu({x:h+p-S,y:o+l/2,horizontalAnchor:j,verticalAnchor:"middle"},P):r==="insideTop"?Bu({x:d+c/2,y:o+y,horizontalAnchor:"middle",verticalAnchor:v},P):r==="insideBottom"?Bu({x:f+u/2,y:o+l-y,horizontalAnchor:"middle",verticalAnchor:b},P):r==="insideTopLeft"?Bu({x:d+S,y:o+y,horizontalAnchor:k,verticalAnchor:v},P):r==="insideTopRight"?Bu({x:d+c-S,y:o+y,horizontalAnchor:j,verticalAnchor:v},P):r==="insideBottomLeft"?Bu({x:f+S,y:o+l-y,horizontalAnchor:k,verticalAnchor:b},P):r==="insideBottomRight"?Bu({x:f+u-S,y:o+l-y,horizontalAnchor:j,verticalAnchor:b},P):r&&typeof r=="object"&&(En(r.x)||M0(r.x))&&(En(r.y)||M0(r.y))?Bu({x:s+Wo(r.x,p),y:o+Wo(r.y,l),horizontalAnchor:"end",verticalAnchor:"end"},P):Bu({x:m,y:o+l/2,horizontalAnchor:"middle",verticalAnchor:"middle"},P)},vAe=["labelRef"],wAe=["content"];function RR(e,t){if(e==null)return{};var r,n,i=SAe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function SAe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function FR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function yx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FR(Object(r),!0).forEach(function(n){_Ae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _Ae(e,t,r){return(t=jAe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jAe(e){var t=kAe(e,"string");return typeof t=="symbol"?t:t+""}function kAe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pd(){return Pd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pd.apply(null,arguments)}var wG=x.createContext(null),SG=e=>{var{x:t,y:r,upperWidth:n,lowerWidth:i,width:s,height:o,children:l}=e,c=x.useMemo(()=>({x:t,y:r,upperWidth:n,lowerWidth:i,width:s,height:o}),[t,r,n,i,s,o]);return x.createElement(wG.Provider,{value:c},l)},_G=()=>{var e=x.useContext(wG),t=pg();return e||(t?KC(t):void 0)},AAe=x.createContext(null),NAe=()=>{var e=x.useContext(AAe),t=jn(uV);return e||t},CAe=e=>{var{value:t,formatter:r}=e,n=Qi(e.children)?t:e.children;return typeof r=="function"?r(n):n},c6=e=>e!=null&&typeof e=="function",EAe=(e,t)=>{var r=Qs(t-e),n=Math.min(Math.abs(t-e),360);return r*n},TAe=(e,t,r,n,i)=>{var{offset:s,className:o}=e,{cx:l,cy:c,innerRadius:u,outerRadius:d,startAngle:f,endAngle:h,clockWise:p}=i,m=(u+d)/2,g=EAe(f,h),y=g>=0?1:-1,b,v;switch(t){case"insideStart":b=f+y*s,v=p;break;case"insideEnd":b=h-y*s,v=!p;break;case"end":b=h+y*s,v=p;break;default:throw new Error("Unsupported position ".concat(t))}v=g<=0?v:!v;var w=vs(l,c,m,b),S=vs(l,c,m,b+(v?1:-1)*359),j="M".concat(w.x,",").concat(w.y,`
    A`).concat(m,",").concat(m,",0,1,").concat(v?0:1,`,
    `).concat(S.x,",").concat(S.y),k=Qi(e.id)?k1("recharts-radial-line-"):e.id;return x.createElement("text",Pd({},n,{dominantBaseline:"central",className:_i("recharts-radial-bar-label",o)}),x.createElement("defs",null,x.createElement("path",{id:k,d:j})),x.createElement("textPath",{xlinkHref:"#".concat(k)},r))},PAe=(e,t,r)=>{var{cx:n,cy:i,innerRadius:s,outerRadius:o,startAngle:l,endAngle:c}=e,u=(l+c)/2;if(r==="outside"){var{x:d,y:f}=vs(n,i,o+t,u);return{x:d,y:f,textAnchor:d>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"end"};var h=(s+o)/2,{x:p,y:m}=vs(n,i,h,u);return{x:p,y:m,textAnchor:"middle",verticalAnchor:"middle"}},e2=e=>e!=null&&"cx"in e&&En(e.cx),OAe={angle:0,offset:5,zIndex:Oa.label,position:"middle",textBreakAll:!1};function MAe(e){if(!e2(e))return e;var{cx:t,cy:r,outerRadius:n}=e,i=n*2;return{x:t-n,y:r-n,width:i,upperWidth:i,lowerWidth:i,height:i}}function Bf(e){var t=ka(e,OAe),{viewBox:r,parentViewBox:n,position:i,value:s,children:o,content:l,className:c="",textBreakAll:u,labelRef:d}=t,f=NAe(),h=_G(),p=i==="center"?h:f??h,m,g,y;r==null?m=p:e2(r)?m=r:m=KC(r);var b=MAe(m);if(!m||Qi(s)&&Qi(o)&&!x.isValidElement(l)&&typeof l!="function")return null;var v=yx(yx({},t),{},{viewBox:m});if(x.isValidElement(l)){var{labelRef:w}=v,S=RR(v,vAe);return x.cloneElement(l,S)}if(typeof l=="function"){var{content:j}=v,k=RR(v,wAe);if(g=x.createElement(l,k),x.isValidElement(g))return g}else g=CAe(t);var A=Vo(t);if(e2(m)){if(i==="insideStart"||i==="insideEnd"||i==="end")return TAe(t,i,g,A,m);y=PAe(m,t.offset,t.position)}else{if(!b)return null;var R=bAe({viewBox:b,position:i,offset:t.offset,parentViewBox:e2(n)?void 0:n});y=yx(yx({x:R.x,y:R.y,textAnchor:R.horizontalAnchor,verticalAnchor:R.verticalAnchor},R.width!==void 0?{width:R.width}:{}),R.height!==void 0?{height:R.height}:{})}return x.createElement(wo,{zIndex:t.zIndex},x.createElement(P_,Pd({ref:d,className:_i("recharts-label",c)},A,y,{textAnchor:dAe(A.textAnchor)?A.textAnchor:y.textAnchor,breakAll:u}),g))}Bf.displayName="Label";var LAe=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?x.createElement(Bf,Pd({key:"label-implicit"},n)):Hc(e)?x.createElement(Bf,Pd({key:"label-implicit",value:e},n)):x.isValidElement(e)?e.type===Bf?x.cloneElement(e,yx({key:"label-implicit"},n)):x.createElement(Bf,Pd({key:"label-implicit",content:e},n)):c6(e)?x.createElement(Bf,Pd({key:"label-implicit",content:e},n)):e&&typeof e=="object"?x.createElement(Bf,Pd({},e,{key:"label-implicit"},n)):null};function jG(e){var{label:t,labelRef:r}=e,n=_G();return LAe(t,n,r)||null}var kG={},AG={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(AG);var NG={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(NG);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=AG,r=NG,n=qS;function i(s){if(n.isArrayLike(s))return t.last(r.toArray(s))}e.last=i})(kG);var RAe=kG.last;const FAe=sf(RAe);var BAe=["valueAccessor"],IAe=["dataKey","clockWise","id","textBreakAll","zIndex"];function Uw(){return Uw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Uw.apply(null,arguments)}function BR(e,t){if(e==null)return{};var r,n,i=DAe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function DAe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var $Ae=e=>Array.isArray(e.value)?FAe(e.value):e.value,CG=x.createContext(void 0),u6=CG.Provider,EG=x.createContext(void 0),UAe=EG.Provider;function zAe(){return x.useContext(CG)}function WAe(){return x.useContext(EG)}function t2(e){var{valueAccessor:t=$Ae}=e,r=BR(e,BAe),{dataKey:n,clockWise:i,id:s,textBreakAll:o,zIndex:l}=r,c=BR(r,IAe),u=zAe(),d=WAe(),f=u||d;return!f||!f.length?null:x.createElement(wo,{zIndex:l??Oa.label},x.createElement(ja,{className:"recharts-label-list"},f.map((h,p)=>{var m,g=Qi(n)?t(h,p):Ti(h.payload,n),y=Qi(s)?{}:{id:"".concat(s,"-").concat(p)};return x.createElement(Bf,Uw({key:"label-".concat(p)},Vo(h),c,y,{fill:(m=r.fill)!==null&&m!==void 0?m:h.fill,parentViewBox:h.parentViewBox,value:g,textBreakAll:o,viewBox:h.viewBox,index:p,zIndex:0}))})))}t2.displayName="LabelList";function O_(e){var{label:t}=e;return t?t===!0?x.createElement(t2,{key:"labelList-implicit"}):x.isValidElement(t)||c6(t)?x.createElement(t2,{key:"labelList-implicit",content:t}):typeof t=="object"?x.createElement(t2,Uw({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function ZA(){return ZA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ZA.apply(null,arguments)}var TG=e=>{var{cx:t,cy:r,r:n,className:i}=e,s=_i("recharts-dot",i);return En(t)&&En(r)&&En(n)?x.createElement("circle",ZA({},cl(e),NC(e),{className:s,cx:t,cy:r,r:n})):null},PG=e=>e.graphicalItems.polarItems,qAe=Qt([Fa,ky],ME),M_=Qt([PG,Ya,qAe],LE),HAe=Qt([M_],RE),L_=Qt([HAe,y_],FE),VAe=Qt([L_,Ya,M_],IE);Qt([L_,Ya,M_],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(i=>{var s,o=Ti(n,(s=t.dataKey)!==null&&s!==void 0?s:i.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:Ti(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]})));var IR=()=>{},GAe=Qt([L_,Ya,M_,N_,Fa],zE),KAe=Qt([Ya,$E,UE,IR,GAe,IR,Oi,Fa],WE),OG=Qt([Ya,Oi,L_,VAe,jy,Fa,KAe],qE),YAe=Qt([OG,wg,Ph],GE),XAe=Qt([Ya,OG,YAe,Fa],YE);Qt([Ph,XAe],fV);var QAe={radiusAxis:{},angleAxis:{}},MG=Ll({name:"polarAxis",initialState:QAe,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:CMe,removeRadiusAxis:EMe,addAngleAxis:TMe,removeAngleAxis:PMe}=MG.actions,JAe=MG.reducer;function LG(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}function DR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function $R(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DR(Object(r),!0).forEach(function(n){ZAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZAe(e,t,r){return(t=eNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eNe(e){var t=tNe(e,"string");return typeof t=="symbol"?t:t+""}function tNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rNe=(e,t)=>t,d6=Qt([PG,rNe],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),nNe=[],f6=(e,t,r)=>(r==null?void 0:r.length)===0?nNe:r,RG=Qt([y_,d6,f6],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var i;if((t==null?void 0:t.data)!=null&&t.data.length>0?i=t.data:i=n,(!i||!i.length)&&r!=null&&(i=r.map(s=>$R($R({},t.presentationProps),s.props))),i!=null)return i}}),iNe=Qt([RG,d6,f6],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,i)=>{var s,o=Ti(n,t.nameKey,t.name),l;return r!=null&&(s=r[i])!==null&&s!==void 0&&(s=s.props)!==null&&s!==void 0&&s.fill?l=r[i].props.fill:typeof n=="object"&&n!=null&&"fill"in n?l=n.fill:l=t.fill,{value:Ch(o,t.dataKey),color:l,payload:n,type:t.legendType}})}),aNe=Qt([RG,d6,f6,Rs],(e,t,r,n)=>{if(!(t==null||e==null))return o3e({offset:n,pieSettings:t,displayedData:e,cells:r})}),FG={exports:{}},Ki={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var to=typeof Symbol=="function"&&Symbol.for,h6=to?Symbol.for("react.element"):60103,p6=to?Symbol.for("react.portal"):60106,R_=to?Symbol.for("react.fragment"):60107,F_=to?Symbol.for("react.strict_mode"):60108,B_=to?Symbol.for("react.profiler"):60114,I_=to?Symbol.for("react.provider"):60109,D_=to?Symbol.for("react.context"):60110,m6=to?Symbol.for("react.async_mode"):60111,$_=to?Symbol.for("react.concurrent_mode"):60111,U_=to?Symbol.for("react.forward_ref"):60112,z_=to?Symbol.for("react.suspense"):60113,sNe=to?Symbol.for("react.suspense_list"):60120,W_=to?Symbol.for("react.memo"):60115,q_=to?Symbol.for("react.lazy"):60116,oNe=to?Symbol.for("react.block"):60121,lNe=to?Symbol.for("react.fundamental"):60117,cNe=to?Symbol.for("react.responder"):60118,uNe=to?Symbol.for("react.scope"):60119;function mc(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case h6:switch(e=e.type,e){case m6:case $_:case R_:case B_:case F_:case z_:return e;default:switch(e=e&&e.$$typeof,e){case D_:case U_:case q_:case W_:case I_:return e;default:return t}}case p6:return t}}}function BG(e){return mc(e)===$_}Ki.AsyncMode=m6;Ki.ConcurrentMode=$_;Ki.ContextConsumer=D_;Ki.ContextProvider=I_;Ki.Element=h6;Ki.ForwardRef=U_;Ki.Fragment=R_;Ki.Lazy=q_;Ki.Memo=W_;Ki.Portal=p6;Ki.Profiler=B_;Ki.StrictMode=F_;Ki.Suspense=z_;Ki.isAsyncMode=function(e){return BG(e)||mc(e)===m6};Ki.isConcurrentMode=BG;Ki.isContextConsumer=function(e){return mc(e)===D_};Ki.isContextProvider=function(e){return mc(e)===I_};Ki.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===h6};Ki.isForwardRef=function(e){return mc(e)===U_};Ki.isFragment=function(e){return mc(e)===R_};Ki.isLazy=function(e){return mc(e)===q_};Ki.isMemo=function(e){return mc(e)===W_};Ki.isPortal=function(e){return mc(e)===p6};Ki.isProfiler=function(e){return mc(e)===B_};Ki.isStrictMode=function(e){return mc(e)===F_};Ki.isSuspense=function(e){return mc(e)===z_};Ki.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===R_||e===$_||e===B_||e===F_||e===z_||e===sNe||typeof e=="object"&&e!==null&&(e.$$typeof===q_||e.$$typeof===W_||e.$$typeof===I_||e.$$typeof===D_||e.$$typeof===U_||e.$$typeof===lNe||e.$$typeof===cNe||e.$$typeof===uNe||e.$$typeof===oNe)};Ki.typeOf=mc;FG.exports=Ki;var dNe=FG.exports,UR=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",zR=null,sk=null,IG=e=>{if(e===zR&&Array.isArray(sk))return sk;var t=[];return x.Children.forEach(e,r=>{Qi(r)||(dNe.isFragment(r)?t=t.concat(IG(r.props.children)):t.push(r))}),sk=t,zR=e,t};function H_(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(i=>UR(i)):n=[UR(t)],IG(e).forEach(i=>{var s=O0(i,"type.displayName")||O0(i,"type.name");s&&n.indexOf(s)!==-1&&r.push(i)}),r}var DG=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,$G={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var i;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const s=r[Symbol.toStringTag];return s==null||!((i=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&i.writable)?!1:r.toString()===`[object ${s}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})($G);var fNe=$G.isPlainObject;const hNe=sf(fNe);var WR,qR,HR,VR,GR;function KR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function YR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KR(Object(r),!0).forEach(function(n){pNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pNe(e,t,r){return(t=mNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mNe(e){var t=gNe(e,"string");return typeof t=="symbol"?t:t+""}function gNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zw(){return zw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zw.apply(null,arguments)}function rx(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var XR=(e,t,r,n,i)=>{var s=r-n,o;return o=za(WR||(WR=rx(["M ",",",""])),e,t),o+=za(qR||(qR=rx(["L ",",",""])),e+r,t),o+=za(HR||(HR=rx(["L ",",",""])),e+r-s/2,t+i),o+=za(VR||(VR=rx(["L ",",",""])),e+r-s/2-n,t+i),o+=za(GR||(GR=rx(["L ",","," Z"])),e,t),o},xNe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},yNe=e=>{var t=ka(e,xNe),{x:r,y:n,upperWidth:i,lowerWidth:s,height:o,className:l}=t,{animationEasing:c,animationDuration:u,animationBegin:d,isUpdateAnimationActive:f}=t,h=x.useRef(null),[p,m]=x.useState(-1),g=x.useRef(i),y=x.useRef(s),b=x.useRef(o),v=x.useRef(r),w=x.useRef(n),S=gg(e,"trapezoid-");if(x.useEffect(()=>{if(h.current&&h.current.getTotalLength)try{var G=h.current.getTotalLength();G&&m(G)}catch{}},[]),r!==+r||n!==+n||i!==+i||s!==+s||o!==+o||i===0&&s===0||o===0)return null;var j=_i("recharts-trapezoid",l);if(!f)return x.createElement("g",null,x.createElement("path",zw({},Vo(t),{className:j,d:XR(r,n,i,s,o)})));var k=g.current,A=y.current,R=b.current,M=v.current,B=w.current,E="0px ".concat(p===-1?1:p,"px"),P="".concat(p,"px 0px"),U=Zq(["strokeDasharray"],u,c);return x.createElement(mg,{animationId:S,key:S,canBegin:p>0,duration:u,easing:c,isActive:f,begin:d},G=>{var H=Xi(k,i,G),oe=Xi(A,s,G),de=Xi(R,o,G),W=Xi(M,r,G),V=Xi(B,n,G);h.current&&(g.current=H,y.current=oe,b.current=de,v.current=W,w.current=V);var ae=G>0?{transition:U,strokeDasharray:P}:{strokeDasharray:E};return x.createElement("path",zw({},Vo(t),{className:j,d:XR(W,V,H,oe,de),ref:h,style:YR(YR({},ae),t.style)}))})},bNe=["option","shapeType","activeClassName"];function vNe(e,t){if(e==null)return{};var r,n,i=wNe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function wNe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function QR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ww(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QR(Object(r),!0).forEach(function(n){SNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function SNe(e,t,r){return(t=_Ne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _Ne(e){var t=jNe(e,"string");return typeof t=="symbol"?t:t+""}function jNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kNe(e,t){return Ww(Ww({},t),e)}function ANe(e,t){return e==="symbols"}function JR(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return x.createElement(nH,r);case"trapezoid":return x.createElement(yNe,r);case"sector":return x.createElement(oH,r);case"symbols":if(ANe(t))return x.createElement(WS,r);break;case"curve":return x.createElement(u_,r);default:return null}}function NNe(e){return x.isValidElement(e)?e.props:e}function D1(e){var{option:t,shapeType:r,activeClassName:n="recharts-active-shape"}=e,i=vNe(e,bNe),s;if(x.isValidElement(t))s=x.cloneElement(t,Ww(Ww({},i),NNe(t)));else if(typeof t=="function")s=t(i,i.index);else if(hNe(t)&&typeof t!="boolean"){var o=kNe(t,i);s=x.createElement(JR,{shapeType:r,elementProps:o})}else{var l=i;s=x.createElement(JR,{shapeType:r,elementProps:l})}return i.isActive?x.createElement(ja,{className:n},s):s}var V_=(e,t,r)=>{var n=Zi();return(i,s)=>o=>{e==null||e(i,s,o),n(zV({activeIndex:String(s),activeDataKey:t,activeCoordinate:i.tooltipPosition,activeGraphicalItemId:r}))}},G_=e=>{var t=Zi();return(r,n)=>i=>{e==null||e(r,n,i),t(Rje())}},K_=(e,t,r)=>{var n=Zi();return(i,s)=>o=>{e==null||e(i,s,o),n(Fje({activeIndex:String(s),activeDataKey:t,activeCoordinate:i.tooltipPosition,activeGraphicalItemId:r}))}};function Y_(e){var{tooltipEntrySettings:t}=e,r=Zi(),n=Fs(),i=x.useRef(null);return x.useLayoutEffect(()=>{n||(i.current===null?r(Pje(t)):i.current!==t&&r(Oje({prev:i.current,next:t})),i.current=t)},[t,r,n]),x.useLayoutEffect(()=>()=>{i.current&&(r(Mje(i.current)),i.current=null)},[r]),null}function g6(e){var{legendPayload:t}=e,r=Zi(),n=Fs(),i=x.useRef(null);return x.useLayoutEffect(()=>{n||(i.current===null?r(Yq(t)):i.current!==t&&r(Xq({prev:i.current,next:t})),i.current=t)},[r,n,t]),x.useLayoutEffect(()=>()=>{i.current&&(r(Qq(i.current)),i.current=null)},[r]),null}function CNe(e){var{legendPayload:t}=e,r=Zi(),n=jn(Oi),i=x.useRef(null);return x.useLayoutEffect(()=>{n!=="centric"&&n!=="radial"||(i.current===null?r(Yq(t)):i.current!==t&&r(Xq({prev:i.current,next:t})),i.current=t)},[r,n,t]),x.useLayoutEffect(()=>()=>{i.current&&(r(Qq(i.current)),i.current=null)},[r]),null}var ok,ENe=()=>{var[e]=x.useState(()=>k1("uid-"));return e},TNe=(ok=hB.useId)!==null&&ok!==void 0?ok:ENe;function PNe(e,t){var r=TNe();return t||(e?"".concat(e,"-").concat(r):r)}var ONe=x.createContext(void 0),X_=e=>{var{id:t,type:r,children:n}=e,i=PNe("recharts-".concat(r),t);return x.createElement(ONe.Provider,{value:i},n(i))},MNe={cartesianItems:[],polarItems:[]},UG=Ll({name:"graphicalItems",initialState:MNe,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:wa()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:r,next:n}=t.payload,i=xu(e).cartesianItems.indexOf(r);i>-1&&(e.cartesianItems[i]=n)},prepare:wa()},removeCartesianGraphicalItem:{reducer(e,t){var r=xu(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},prepare:wa()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:wa()},removePolarGraphicalItem:{reducer(e,t){var r=xu(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)},prepare:wa()}}}),{addCartesianGraphicalItem:LNe,replaceCartesianGraphicalItem:RNe,removeCartesianGraphicalItem:FNe,addPolarGraphicalItem:BNe,removePolarGraphicalItem:INe}=UG.actions,DNe=UG.reducer,$Ne=e=>{var t=Zi(),r=x.useRef(null);return x.useLayoutEffect(()=>{r.current===null?t(LNe(e)):r.current!==e&&t(RNe({prev:r.current,next:e})),r.current=e},[t,e]),x.useLayoutEffect(()=>()=>{r.current&&(t(FNe(r.current)),r.current=null)},[t]),null},x6=x.memo($Ne);function UNe(e){var t=Zi();return x.useLayoutEffect(()=>(t(BNe(e)),()=>{t(INe(e))}),[t,e]),null}var zNe=["key"],WNe=["onMouseEnter","onClick","onMouseLeave"],qNe=["id"],HNe=["id"];function ZR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ha(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZR(Object(r),!0).forEach(function(n){VNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VNe(e,t,r){return(t=GNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GNe(e){var t=KNe(e,"string");return typeof t=="symbol"?t:t+""}function KNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bh(){return bh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bh.apply(null,arguments)}function Q_(e,t){if(e==null)return{};var r,n,i=YNe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function YNe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function XNe(e){var t=x.useMemo(()=>H_(e.children,cp),[e.children]),r=jn(n=>iNe(n,e.id,t));return r==null?null:x.createElement(CNe,{legendPayload:r})}var QNe=x.memo(e=>{var{dataKey:t,nameKey:r,sectors:n,stroke:i,strokeWidth:s,fill:o,name:l,hide:c,tooltipType:u,id:d}=e,f={dataDefinedOnItem:n.map(h=>h.tooltipPayload),getPosition:h=>{var p;return(p=n[Number(h)])===null||p===void 0?void 0:p.tooltipPosition},settings:{stroke:i,strokeWidth:s,fill:o,dataKey:t,nameKey:r,name:Ch(l,t),hide:c,type:u,color:o,unit:"",graphicalItemId:d}};return x.createElement(Y_,{tooltipEntrySettings:f})}),JNe=(e,t)=>e>t?"start":e<t?"end":"middle",ZNe=(e,t,r)=>Wo(typeof t=="function"?t(e):t,r,r*.8),e3e=(e,t,r)=>{var{top:n,left:i,width:s,height:o}=t,l=iH(s,o),c=i+Wo(e.cx,s,s/2),u=n+Wo(e.cy,o,o/2),d=Wo(e.innerRadius,l,0),f=ZNe(r,e.outerRadius,l),h=e.maxRadius||Math.sqrt(s*s+o*o)/2;return{cx:c,cy:u,innerRadius:d,outerRadius:f,maxRadius:h}},t3e=(e,t)=>{var r=Qs(t-e),n=Math.min(Math.abs(t-e),360);return r*n},r3e=(e,t)=>{if(x.isValidElement(e))return x.cloneElement(e,t);if(typeof e=="function")return e(t);var r=_i("recharts-pie-label-line",typeof e!="boolean"?e.className:""),{key:n}=t,i=Q_(t,zNe);return x.createElement(u_,bh({},i,{type:"linear",className:r}))},n3e=(e,t,r)=>{if(x.isValidElement(e))return x.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),x.isValidElement(n)))return n;var i=_i("recharts-pie-label-text",LG(e));return x.createElement(P_,bh({},t,{alignmentBaseline:"middle",className:i}),n)};function i3e(e){var{sectors:t,props:r,showLabels:n}=e,{label:i,labelLine:s,dataKey:o}=r;if(!n||!i||!t)return null;var l=cl(r),c=yh(i),u=yh(s),d=typeof i=="object"&&"offsetRadius"in i&&typeof i.offsetRadius=="number"&&i.offsetRadius||20,f=t.map((h,p)=>{var m=(h.startAngle+h.endAngle)/2,g=vs(h.cx,h.cy,h.outerRadius+d,m),y=Ha(Ha(Ha(Ha({},l),h),{},{stroke:"none"},c),{},{index:p,textAnchor:JNe(g.x,h.cx)},g),b=Ha(Ha(Ha(Ha({},l),h),{},{fill:"none",stroke:h.fill},u),{},{index:p,points:[vs(h.cx,h.cy,h.outerRadius,m),g],key:"line"});return x.createElement(wo,{zIndex:Oa.label,key:"label-".concat(h.startAngle,"-").concat(h.endAngle,"-").concat(h.midAngle,"-").concat(p)},x.createElement(ja,null,s&&r3e(s,b),n3e(i,y,Ti(h,o))))});return x.createElement(ja,{className:"recharts-pie-labels"},f)}function a3e(e){var{sectors:t,props:r,showLabels:n}=e,{label:i}=r;return typeof i=="object"&&i!=null&&"position"in i?x.createElement(O_,{label:i}):x.createElement(i3e,{sectors:t,props:r,showLabels:n})}function s3e(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:i,shape:s,id:o}=e,l=jn(nf),c=jn(i6),u=jn(wke),{onMouseEnter:d,onClick:f,onMouseLeave:h}=i,p=Q_(i,WNe),m=V_(d,i.dataKey,o),g=G_(h),y=K_(f,i.dataKey,o);return t==null||t.length===0?null:x.createElement(x.Fragment,null,t.map((b,v)=>{if((b==null?void 0:b.startAngle)===0&&(b==null?void 0:b.endAngle)===0&&t.length!==1)return null;var w=u==null||u===o,S=String(v)===l&&(c==null||i.dataKey===c)&&w,j=l?n:null,k=r&&S?r:j,A=Ha(Ha({},b),{},{stroke:b.stroke,tabIndex:-1,[Oq]:v,[HC]:o});return x.createElement(ja,bh({key:"sector-".concat(b==null?void 0:b.startAngle,"-").concat(b==null?void 0:b.endAngle,"-").concat(b.midAngle,"-").concat(v),tabIndex:-1,className:"recharts-pie-sector"},hg(p,b,v),{onMouseEnter:m(b,v),onMouseLeave:g(b,v),onClick:y(b,v)}),x.createElement(D1,bh({option:s??k,index:v,shapeType:"sector",isActive:S},A)))}))}function o3e(e){var t,{pieSettings:r,displayedData:n,cells:i,offset:s}=e,{cornerRadius:o,startAngle:l,endAngle:c,dataKey:u,nameKey:d,tooltipType:f}=r,h=Math.abs(r.minAngle),p=t3e(l,c),m=Math.abs(p),g=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,y=n.filter(k=>Ti(k,u,0)!==0).length,b=(m>=360?y:y-1)*g,v=m-y*h-b,w=n.reduce((k,A)=>{var R=Ti(A,u,0);return k+(En(R)?R:0)},0),S;if(w>0){var j;S=n.map((k,A)=>{var R=Ti(k,u,0),M=Ti(k,d,A),B=e3e(r,s,k),E=(En(R)?R:0)/w,P,U=Ha(Ha({},k),i&&i[A]&&i[A].props);A?P=j.endAngle+Qs(p)*g*(R!==0?1:0):P=l;var G=P+Qs(p)*((R!==0?h:0)+E*v),H=(P+G)/2,oe=(B.innerRadius+B.outerRadius)/2,de=[{name:M,value:R,payload:U,dataKey:u,type:f,graphicalItemId:r.id}],W=vs(B.cx,B.cy,oe,H);return j=Ha(Ha(Ha(Ha({},r.presentationProps),{},{percent:E,cornerRadius:typeof o=="string"?parseFloat(o):o,name:M,tooltipPayload:de,midAngle:H,middleRadius:oe,tooltipPosition:W},U),B),{},{value:R,dataKey:u,startAngle:P,endAngle:G,payload:U,paddingAngle:Qs(p)*g}),j})}return S}function l3e(e){var{showLabels:t,sectors:r,children:n}=e,i=x.useMemo(()=>!t||!r?[]:r.map(s=>({value:s.value,payload:s.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:s.cx,cy:s.cy,innerRadius:s.innerRadius,outerRadius:s.outerRadius,startAngle:s.startAngle,endAngle:s.endAngle,clockWise:!1},fill:s.fill})),[r,t]);return x.createElement(UAe,{value:t?i:void 0},n)}function c3e(e){var{props:t,previousSectorsRef:r,id:n}=e,{sectors:i,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:c,activeShape:u,inactiveShape:d,onAnimationStart:f,onAnimationEnd:h}=t,p=gg(t,"recharts-pie-"),m=r.current,[g,y]=x.useState(!1),b=x.useCallback(()=>{typeof h=="function"&&h(),y(!1)},[h]),v=x.useCallback(()=>{typeof f=="function"&&f(),y(!0)},[f]);return x.createElement(l3e,{showLabels:!g,sectors:i},x.createElement(mg,{animationId:p,begin:o,duration:l,isActive:s,easing:c,onAnimationStart:v,onAnimationEnd:b,key:p},w=>{var S,j=[],k=i&&i[0],A=(S=k==null?void 0:k.startAngle)!==null&&S!==void 0?S:0;return i==null||i.forEach((R,M)=>{var B=m&&m[M],E=M>0?O0(R,"paddingAngle",0):0;if(B){var P=Xi(B.endAngle-B.startAngle,R.endAngle-R.startAngle,w),U=Ha(Ha({},R),{},{startAngle:A+E,endAngle:A+P+E});j.push(U),A=U.endAngle}else{var{endAngle:G,startAngle:H}=R,oe=Xi(0,G-H,w),de=Ha(Ha({},R),{},{startAngle:A+E,endAngle:A+oe+E});j.push(de),A=de.endAngle}}),r.current=j,x.createElement(ja,null,x.createElement(s3e,{sectors:j,activeShape:u,inactiveShape:d,allOtherPieProps:t,shape:t.shape,id:n}))}),x.createElement(a3e,{showLabels:!g,sectors:i,props:t}),t.children)}var u3e={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:Oa.area};function d3e(e){var{id:t}=e,r=Q_(e,qNe),{hide:n,className:i,rootTabIndex:s}=e,o=x.useMemo(()=>H_(e.children,cp),[e.children]),l=jn(d=>aNe(d,t,o)),c=x.useRef(null),u=_i("recharts-pie",i);return n||l==null?(c.current=null,x.createElement(ja,{tabIndex:s,className:u})):x.createElement(wo,{zIndex:e.zIndex},x.createElement(QNe,{dataKey:e.dataKey,nameKey:e.nameKey,sectors:l,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType,id:t}),x.createElement(ja,{tabIndex:s,className:u},x.createElement(c3e,{props:Ha(Ha({},r),{},{sectors:l}),previousSectorsRef:c,id:t})))}function zG(e){var t=ka(e,u3e),{id:r}=t,n=Q_(t,HNe),i=cl(n);return x.createElement(X_,{id:r,type:"pie"},s=>x.createElement(x.Fragment,null,x.createElement(UNe,{type:"pie",id:s,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:i,maxRadius:t.maxRadius}),x.createElement(XNe,bh({},n,{id:s})),x.createElement(d3e,bh({},n,{id:s}))))}zG.displayName="Pie";var f3e=["points"];function eF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function lk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eF(Object(r),!0).forEach(function(n){h3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function h3e(e,t,r){return(t=p3e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p3e(e){var t=m3e(e,"string");return typeof t=="symbol"?t:t+""}function m3e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qw(){return qw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qw.apply(null,arguments)}function g3e(e,t){if(e==null)return{};var r,n,i=x3e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function x3e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function y3e(e){var{option:t,dotProps:r,className:n}=e;if(x.isValidElement(t))return x.cloneElement(t,r);if(typeof t=="function")return t(r);var i=_i(n,typeof t!="boolean"?t.className:""),s=r??{},{points:o}=s,l=g3e(s,f3e);return x.createElement(TG,qw({},l,{className:i}))}function b3e(e,t){return e==null?!1:t?!0:e.length===1}function v3e(e){var{points:t,dot:r,className:n,dotClassName:i,dataKey:s,baseProps:o,needClip:l,clipPathId:c,zIndex:u=Oa.scatter}=e;if(!b3e(t,r))return null;var d=DG(r),f=s1e(r),h=t.map((m,g)=>{var y,b,v=lk(lk(lk({r:3},o),f),{},{index:g,cx:(y=m.x)!==null&&y!==void 0?y:void 0,cy:(b=m.y)!==null&&b!==void 0?b:void 0,dataKey:s,value:m.value,payload:m.payload,points:t});return x.createElement(y3e,{key:"dot-".concat(g),option:r,dotProps:v,className:i})}),p={};return l&&c!=null&&(p.clipPath="url(#clipPath-".concat(d?"":"dots-").concat(c,")")),x.createElement(wo,{zIndex:u},x.createElement(ja,qw({className:n},p),h))}function tF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function rF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tF(Object(r),!0).forEach(function(n){w3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function w3e(e,t,r){return(t=S3e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S3e(e){var t=_3e(e,"string");return typeof t=="symbol"?t:t+""}function _3e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WG=0,j3e={xAxis:{},yAxis:{},zAxis:{}},qG=Ll({name:"cartesianAxis",initialState:j3e,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:wa()},replaceXAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.xAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.xAxis[r.id],e.xAxis[n.id]=n)},prepare:wa()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:wa()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:wa()},replaceYAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.yAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.yAxis[r.id],e.yAxis[n.id]=n)},prepare:wa()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:wa()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:wa()},replaceZAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.zAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.zAxis[r.id],e.zAxis[n.id]=n)},prepare:wa()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:wa()},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload,i=e.yAxis[r];if(i){var s,o=i.widthHistory||[];if(o.length===3&&o[0]===o[2]&&n===o[1]&&n!==i.width&&Math.abs(n-((s=o[0])!==null&&s!==void 0?s:0))<=1)return;var l=[...o,n].slice(-3);e.yAxis[r]=rF(rF({},i),{},{width:n,widthHistory:l})}}}}),{addXAxis:k3e,replaceXAxis:A3e,removeXAxis:N3e,addYAxis:C3e,replaceYAxis:E3e,removeYAxis:T3e,addZAxis:P3e,replaceZAxis:O3e,removeZAxis:M3e,updateYAxisWidth:L3e}=qG.actions,R3e=qG.reducer,F3e=Qt([Rs],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),B3e=Qt([F3e,pf,mf],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),y6=()=>jn(B3e),I3e=()=>jn(Ake);function nF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ck(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nF(Object(r),!0).forEach(function(n){D3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function D3e(e,t,r){return(t=$3e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $3e(e){var t=U3e(e,"string");return typeof t=="symbol"?t:t+""}function U3e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var z3e=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:i,dataKey:s,clipPath:o}=e;if(i===!1||t.x==null||t.y==null)return null;var l={index:r,dataKey:s,cx:t.x,cy:t.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},c=ck(ck(ck({},l),yh(i)),NC(i)),u;return x.isValidElement(i)?u=x.cloneElement(i,c):typeof i=="function"?u=i(c):u=x.createElement(TG,c),x.createElement(ja,{className:"recharts-active-dot",clipPath:o},u)};function W3e(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:i,clipPath:s,zIndex:o=Oa.activeDot}=e,l=jn(nf),c=I3e();if(t==null||c==null)return null;var u=t.find(d=>c.includes(d.payload));return Qi(u)?null:x.createElement(wo,{zIndex:o},x.createElement(z3e,{point:u,childIndex:Number(l),mainColor:r,dataKey:i,activeDot:n,clipPath:s}))}var iF=(e,t,r)=>{var n=r??e;if(!Qi(n))return Wo(n,t,0)},q3e=(e,t,r)=>{var n={},i=e.filter(__),s=e.filter(u=>u.stackId==null),o=i.reduce((u,d)=>{var f=u[d.stackId];return f==null&&(f=[]),f.push(d),u[d.stackId]=f,u},n),l=Object.entries(o).map(u=>{var d,[f,h]=u,p=h.map(g=>g.dataKey),m=iF(t,r,(d=h[0])===null||d===void 0?void 0:d.barSize);return{stackId:f,dataKeys:p,barSize:m}}),c=s.map(u=>{var d=[u.dataKey].filter(h=>h!=null),f=iF(t,r,u.barSize);return{stackId:void 0,dataKeys:d,barSize:f}});return[...l,...c]};function aF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function pv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aF(Object(r),!0).forEach(function(n){H3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function H3e(e,t,r){return(t=V3e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function V3e(e){var t=G3e(e,"string");return typeof t=="symbol"?t:t+""}function G3e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function K3e(e,t,r,n,i){var s,o=n.length;if(!(o<1)){var l=Wo(e,r,0,!0),c,u=[];if(pi((s=n[0])===null||s===void 0?void 0:s.barSize)){var d=!1,f=r/o,h=n.reduce((v,w)=>v+(w.barSize||0),0);h+=(o-1)*l,h>=r&&(h-=(o-1)*l,l=0),h>=r&&f>0&&(d=!0,f*=.9,h=o*f);var p=(r-h)/2>>0,m={offset:p-l,size:0};c=n.reduce((v,w)=>{var S,j={stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:m.offset+m.size+l,size:d?f:(S=w.barSize)!==null&&S!==void 0?S:0}},k=[...v,j];return m=j.position,k},u)}else{var g=Wo(t,r,0,!0);r-2*g-(o-1)*l<=0&&(l=0);var y=(r-2*g-(o-1)*l)/o;y>1&&(y>>=0);var b=pi(i)?Math.min(y,i):y;c=n.reduce((v,w,S)=>[...v,{stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:g+(y+l)*S+(y-b)/2,size:b}}],u)}return c}}var Y3e=(e,t,r,n,i,s,o)=>{var l=Qi(o)?t:o,c=K3e(r,n,i!==s?i:s,e,l);return i!==s&&c!=null&&(c=c.map(u=>pv(pv({},u),{},{position:pv(pv({},u.position),{},{offset:u.position.offset-i/2})}))),c},X3e=(e,t)=>{var r=PE(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var i=e[n];if(i){var{stackedData:s}=i;if(s)return s.find(o=>o.key===r)}}}},Q3e=(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}};function J3e(e,t){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&pi(e.zIndex)?e.zIndex:t}var HG=e=>{var{chartData:t}=e,r=Zi(),n=Fs();return x.useEffect(()=>n?()=>{}:(r(bR(t)),()=>{r(bR(void 0))}),[t,r,n]),null},sF={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},VG=Ll({name:"brush",initialState:sF,reducers:{setBrushSettings(e,t){return t.payload==null?sF:t.payload}}}),{setBrushSettings:OMe}=VG.actions,Z3e=VG.reducer,eCe=(e,t)=>{var{x:r,y:n}=e,{x:i,y:s}=t;return{x:Math.min(r,i),y:Math.min(n,s),width:Math.abs(i-r),height:Math.abs(s-n)}},tCe=e=>{var{x1:t,y1:r,x2:n,y2:i}=e;return eCe({x:t,y:r},{x:n,y:i})};function rCe(e){return(e%180+180)%180}var nCe=function(t){var{width:r,height:n}=t,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=rCe(i),o=s*Math.PI/180,l=Math.atan(n/r),c=o>l&&o<Math.PI-l?n/Math.sin(o):r/Math.cos(o);return Math.abs(c)},iCe={dots:[],areas:[],lines:[]},GG=Ll({name:"referenceElements",initialState:iCe,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=xu(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=xu(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=xu(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:MMe,removeDot:LMe,addArea:RMe,removeArea:FMe,addLine:aCe,removeLine:sCe}=GG.actions,oCe=GG.reducer,KG=x.createContext(void 0),lCe=e=>{var{children:t}=e,[r]=x.useState("".concat(k1("recharts"),"-clip")),n=y6();if(n==null)return null;var{x:i,y:s,width:o,height:l}=n;return x.createElement(KG.Provider,{value:r},x.createElement("defs",null,x.createElement("clipPath",{id:r},x.createElement("rect",{x:i,y:s,height:l,width:o}))),t)},cCe=()=>x.useContext(KG);class uCe{constructor(t){var{x:r,y:n}=t;this.xAxisScale=r,this.yAxisScale=n}map(t,r){var n,i,{position:s}=r;return{x:(n=this.xAxisScale.map(t.x,{position:s}))!==null&&n!==void 0?n:0,y:(i=this.yAxisScale.map(t.y,{position:s}))!==null&&i!==void 0?i:0}}mapWithFallback(t,r){var n,i,{position:s,fallback:o}=r,l,c;return o==="rangeMin"?l=this.yAxisScale.rangeMin():o==="rangeMax"?l=this.yAxisScale.rangeMax():l=0,o==="rangeMin"?c=this.xAxisScale.rangeMin():o==="rangeMax"?c=this.xAxisScale.rangeMax():c=0,{x:(n=this.xAxisScale.map(t.x,{position:s}))!==null&&n!==void 0?n:c,y:(i=this.yAxisScale.map(t.y,{position:s}))!==null&&i!==void 0?i:l}}isInRange(t){var{x:r,y:n}=t,i=r==null||this.xAxisScale.isInRange(r),s=n==null||this.yAxisScale.isInRange(n);return i&&s}}function oF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function lF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oF(Object(r),!0).forEach(function(n){dCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dCe(e,t,r){return(t=fCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fCe(e){var t=hCe(e,"string");return typeof t=="symbol"?t:t+""}function hCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hw(){return Hw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Hw.apply(null,arguments)}var pCe=(e,t)=>{var r;if(x.isValidElement(e))r=x.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{if(!pi(t.x1)||!pi(t.y1)||!pi(t.x2)||!pi(t.y2))return null;r=x.createElement("line",Hw({},t,{className:"recharts-reference-line-line"}))}return r},mCe=(e,t,r,n,i,s)=>{var{x:o,width:l}=s,c=i.map(e,{position:r});if(!pi(c)||t==="discard"&&!i.isInRange(c))return null;var u=[{x:o+l,y:c},{x:o,y:c}];return n==="left"?u.reverse():u},gCe=(e,t,r,n,i,s)=>{var{y:o,height:l}=s,c=i.map(e,{position:r});if(!pi(c)||t==="discard"&&!i.isInRange(c))return null;var u=[{x:c,y:o+l},{x:c,y:o}];return n==="top"?u.reverse():u},xCe=(e,t,r,n)=>{var i=[n.mapWithFallback(e[0],{position:r,fallback:"rangeMin"}),n.mapWithFallback(e[1],{position:r,fallback:"rangeMax"})];return t==="discard"&&i.some(s=>!n.isInRange(s))?null:i},yCe=(e,t,r,n,i,s,o)=>{var{x:l,y:c,segment:u,ifOverflow:d}=o,f=Hc(l),h=Hc(c);return h?mCe(c,d,n,s,t,r):f?gCe(l,d,n,i,e,r):u!=null&&u.length===2?xCe(u,d,n,new uCe({x:e,y:t})):null};function bCe(e){var t=Zi();return x.useEffect(()=>(t(aCe(e)),()=>{t(sCe(e))})),null}function vCe(e){var{xAxisId:t,yAxisId:r,shape:n,className:i,ifOverflow:s}=e,o=Fs(),l=cCe(),c=jn(A=>dd(A,t)),u=jn(A=>fd(A,r)),d=jn(A=>Qm(A,"xAxis",t,o)),f=jn(A=>Qm(A,"yAxis",r,o)),h=pg();if(!l||!h||c==null||u==null||d==null||f==null)return null;var p=yCe(d,f,h,e.position,c.orientation,u.orientation,e);if(!p)return null;var m=p[0],g=p[1];if(m==null||g==null)return null;var{x:y,y:b}=m,{x:v,y:w}=g,S=s==="hidden"?"url(#".concat(l,")"):void 0,j=lF(lF({clipPath:S},Vo(e)),{},{x1:y,y1:b,x2:v,y2:w}),k=tCe({x1:y,y1:b,x2:v,y2:w});return x.createElement(wo,{zIndex:e.zIndex},x.createElement(ja,{className:_i("recharts-reference-line",i)},pCe(n,j),x.createElement(SG,Hw({},k,{lowerWidth:k.width,upperWidth:k.width}),x.createElement(jG,{label:e.label}),e.children)))}var wCe={ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",label:!1,stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle",zIndex:Oa.line};function eN(e){var t=ka(e,wCe);return x.createElement(x.Fragment,null,x.createElement(bCe,{yAxisId:t.yAxisId,xAxisId:t.xAxisId,ifOverflow:t.ifOverflow,x:t.x,y:t.y,segment:t.segment}),x.createElement(vCe,t))}eN.displayName="ReferenceLine";function YG(e,t){if(t<1)return[];if(t===1)return e;for(var r=[],n=0;n<e.length;n+=t){var i=e[n];i!==void 0&&r.push(i)}return r}function SCe(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return nCe(n,r)}function _Ce(e,t,r){var n=r==="width",{x:i,y:s,width:o,height:l}=e;return t===1?{start:n?i:s,end:n?i+o:s+l}:{start:n?i+o:s+l,end:n?i:s}}function $1(e,t,r,n,i){if(e*t<e*n||e*t>e*i)return!1;var s=r();return e*(t-e*s/2-n)>=0&&e*(t+e*s/2-i)<=0}function jCe(e,t){return YG(e,t+1)}function kCe(e,t,r,n,i){for(var s=(n||[]).slice(),{start:o,end:l}=t,c=0,u=1,d=o,f=function(){var m=n==null?void 0:n[c];if(m===void 0)return{v:YG(n,u)};var g=c,y,b=()=>(y===void 0&&(y=r(m,g)),y),v=m.coordinate,w=c===0||$1(e,v,b,d,l);w||(c=0,d=o,u+=1),w&&(d=v+e*(b()/2+i),c+=u)},h;u<=s.length;)if(h=f(),h)return h.v;return[]}function ACe(e,t,r,n,i){var s=(n||[]).slice(),o=s.length;if(o===0)return[];for(var{start:l,end:c}=t,u=1;u<=o;u++){for(var d=(o-1)%u,f=l,h=!0,p=function(){var S=n[g];if(S==null)return 0;var j=g,k,A=()=>(k===void 0&&(k=r(S,j)),k),R=S.coordinate,M=g===d||$1(e,R,A,f,c);if(!M)return h=!1,1;M&&(f=R+e*(A()/2+i))},m,g=d;g<o&&(m=p(),!(m!==0&&m===1));g+=u);if(h){for(var y=[],b=d;b<o;b+=u){var v=n[b];v!=null&&y.push(v)}return y}}return[]}function cF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Mo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cF(Object(r),!0).forEach(function(n){NCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function NCe(e,t,r){return(t=CCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CCe(e){var t=ECe(e,"string");return typeof t=="symbol"?t:t+""}function ECe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function TCe(e,t,r,n,i){for(var s=(n||[]).slice(),o=s.length,{start:l}=t,{end:c}=t,u=function(h){var p=s[h];if(p==null)return 1;var m=p,g,y=()=>(g===void 0&&(g=r(p,h)),g);if(h===o-1){var b=e*(m.coordinate+e*y()/2-c);s[h]=m=Mo(Mo({},m),{},{tickCoord:b>0?m.coordinate-b*e:m.coordinate})}else s[h]=m=Mo(Mo({},m),{},{tickCoord:m.coordinate});if(m.tickCoord!=null){var v=$1(e,m.tickCoord,y,l,c);v&&(c=m.tickCoord-e*(y()/2+i),s[h]=Mo(Mo({},m),{},{isShow:!0}))}},d=o-1;d>=0;d--)u(d);return s}function PCe(e,t,r,n,i,s){var o=(n||[]).slice(),l=o.length,{start:c,end:u}=t;if(s){var d=n[l-1];if(d!=null){var f=r(d,l-1),h=e*(d.coordinate+e*f/2-u);if(o[l-1]=d=Mo(Mo({},d),{},{tickCoord:h>0?d.coordinate-h*e:d.coordinate}),d.tickCoord!=null){var p=$1(e,d.tickCoord,()=>f,c,u);p&&(u=d.tickCoord-e*(f/2+i),o[l-1]=Mo(Mo({},d),{},{isShow:!0}))}}}for(var m=s?l-1:l,g=function(v){var w=o[v];if(w==null)return 1;var S=w,j,k=()=>(j===void 0&&(j=r(w,v)),j);if(v===0){var A=e*(S.coordinate-e*k()/2-c);o[v]=S=Mo(Mo({},S),{},{tickCoord:A<0?S.coordinate-A*e:S.coordinate})}else o[v]=S=Mo(Mo({},S),{},{tickCoord:S.coordinate});if(S.tickCoord!=null){var R=$1(e,S.tickCoord,k,c,u);R&&(c=S.tickCoord+e*(k()/2+i),o[v]=Mo(Mo({},S),{},{isShow:!0}))}},y=0;y<m;y++)g(y);return o}function b6(e,t,r){var{tick:n,ticks:i,viewBox:s,minTickGap:o,orientation:l,interval:c,tickFormatter:u,unit:d,angle:f}=e;if(!i||!i.length||!n)return[];if(En(c)||d_.isSsr){var h;return(h=jCe(i,En(c)?c:0))!==null&&h!==void 0?h:[]}var p=[],m=l==="top"||l==="bottom"?"width":"height",g=d&&m==="width"?$x(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},y=(j,k)=>{var A=typeof u=="function"?u(j.value,k):j.value;return m==="width"?SCe($x(A,{fontSize:t,letterSpacing:r}),g,f):$x(A,{fontSize:t,letterSpacing:r})[m]},b=i[0],v=i[1],w=i.length>=2&&b!=null&&v!=null?Qs(v.coordinate-b.coordinate):1,S=_Ce(s,w,m);return c==="equidistantPreserveStart"?kCe(w,S,y,i,o):c==="equidistantPreserveEnd"?ACe(w,S,y,i,o):(c==="preserveStart"||c==="preserveStartEnd"?p=PCe(w,S,y,i,o,c==="preserveStartEnd"):p=TCe(w,S,y,i,o),p.filter(j=>j.isShow))}var OCe=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:i=0,tickMargin:s=0}=e,o=0;if(t){Array.from(t).forEach(d=>{if(d){var f=d.getBoundingClientRect();f.width>o&&(o=f.width)}});var l=r?r.getBoundingClientRect().width:0,c=i+s,u=o+c+l+(r?n:0);return Math.round(u)}return 0},MCe=["axisLine","width","height","className","hide","ticks","axisType"];function LCe(e,t){if(e==null)return{};var r,n,i=RCe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function RCe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function I0(){return I0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},I0.apply(null,arguments)}function uF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ua(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uF(Object(r),!0).forEach(function(n){FCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FCe(e,t,r){return(t=BCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BCe(e){var t=ICe(e,"string");return typeof t=="symbol"?t:t+""}function ICe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qd={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:Oa.axis};function DCe(e){var{x:t,y:r,width:n,height:i,orientation:s,mirror:o,axisLine:l,otherSvgProps:c}=e;if(!l)return null;var u=Ua(Ua(Ua({},c),cl(l)),{},{fill:"none"});if(s==="top"||s==="bottom"){var d=+(s==="top"&&!o||s==="bottom"&&o);u=Ua(Ua({},u),{},{x1:t,y1:r+d*i,x2:t+n,y2:r+d*i})}else{var f=+(s==="left"&&!o||s==="right"&&o);u=Ua(Ua({},u),{},{x1:t+f*n,y1:r,x2:t+f*n,y2:r+i})}return x.createElement("line",I0({},u,{className:_i("recharts-cartesian-axis-line",O0(l,"className"))}))}function $Ce(e,t,r,n,i,s,o,l,c){var u,d,f,h,p,m,g=l?-1:1,y=e.tickSize||o,b=En(e.tickCoord)?e.tickCoord:e.coordinate;switch(s){case"top":u=d=e.coordinate,h=r+ +!l*i,f=h-g*y,m=f-g*c,p=b;break;case"left":f=h=e.coordinate,d=t+ +!l*n,u=d-g*y,p=u-g*c,m=b;break;case"right":f=h=e.coordinate,d=t+ +l*n,u=d+g*y,p=u+g*c,m=b;break;default:u=d=e.coordinate,h=r+ +l*i,f=h+g*y,m=f+g*c,p=b;break}return{line:{x1:u,y1:f,x2:d,y2:h},tick:{x:p,y:m}}}function UCe(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function zCe(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function WCe(e){var{option:t,tickProps:r,value:n}=e,i,s=_i(r.className,"recharts-cartesian-axis-tick-value");if(x.isValidElement(t))i=x.cloneElement(t,Ua(Ua({},r),{},{className:s}));else if(typeof t=="function")i=t(Ua(Ua({},r),{},{className:s}));else{var o="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(o=_i(o,LG(t))),i=x.createElement(P_,I0({},r,{className:o}),n)}return i}var qCe=x.forwardRef((e,t)=>{var{ticks:r=[],tick:n,tickLine:i,stroke:s,tickFormatter:o,unit:l,padding:c,tickTextProps:u,orientation:d,mirror:f,x:h,y:p,width:m,height:g,tickSize:y,tickMargin:b,fontSize:v,letterSpacing:w,getTicksConfig:S,events:j,axisType:k}=e,A=b6(Ua(Ua({},S),{},{ticks:r}),v,w),R=UCe(d,f),M=zCe(d,f),B=cl(S),E=yh(n),P={};typeof i=="object"&&(P=i);var U=Ua(Ua({},B),{},{fill:"none"},P),G=A.map(de=>Ua({entry:de},$Ce(de,h,p,m,g,d,y,f,b))),H=G.map(de=>{var{entry:W,line:V}=de;return x.createElement(ja,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(W.value,"-").concat(W.coordinate,"-").concat(W.tickCoord)},i&&x.createElement("line",I0({},U,V,{className:_i("recharts-cartesian-axis-tick-line",O0(i,"className"))})))}),oe=G.map((de,W)=>{var V,ae,{entry:ee,tick:C}=de,Y=Ua(Ua(Ua(Ua({verticalAnchor:M},B),{},{textAnchor:R,stroke:"none",fill:s},C),{},{index:W,payload:ee,visibleTicksCount:A.length,tickFormatter:o,padding:c},u),{},{angle:(V=(ae=u==null?void 0:u.angle)!==null&&ae!==void 0?ae:B.angle)!==null&&V!==void 0?V:0}),q=Ua(Ua({},Y),E);return x.createElement(ja,I0({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(ee.value,"-").concat(ee.coordinate,"-").concat(ee.tickCoord)},hg(j,ee,W)),n&&x.createElement(WCe,{option:n,tickProps:q,value:"".concat(typeof o=="function"?o(ee.value,W):ee.value).concat(l||"")}))});return x.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(k,"-ticks")},oe.length>0&&x.createElement(wo,{zIndex:Oa.label},x.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(k,"-tick-labels"),ref:t},oe)),H.length>0&&x.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(k,"-tick-lines")},H))}),HCe=x.forwardRef((e,t)=>{var{axisLine:r,width:n,height:i,className:s,hide:o,ticks:l,axisType:c}=e,u=LCe(e,MCe),[d,f]=x.useState(""),[h,p]=x.useState(""),m=x.useRef(null);x.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var y;return OCe({ticks:m.current,label:(y=e.labelRef)===null||y===void 0?void 0:y.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var g=x.useCallback(y=>{if(y){var b=y.getElementsByClassName("recharts-cartesian-axis-tick-value");m.current=b;var v=b[0];if(v){var w=window.getComputedStyle(v),S=w.fontSize,j=w.letterSpacing;(S!==d||j!==h)&&(f(S),p(j))}}},[d,h]);return o||n!=null&&n<=0||i!=null&&i<=0?null:x.createElement(wo,{zIndex:e.zIndex},x.createElement(ja,{className:_i("recharts-cartesian-axis",s)},x.createElement(DCe,{x:e.x,y:e.y,width:n,height:i,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:cl(e)}),x.createElement(qCe,{ref:g,axisType:c,events:u,fontSize:d,getTicksConfig:e,height:e.height,letterSpacing:h,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:l,unit:e.unit,width:e.width,x:e.x,y:e.y}),x.createElement(SG,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},x.createElement(jG,{label:e.label,labelRef:e.labelRef}),e.children)))}),v6=x.forwardRef((e,t)=>{var r=ka(e,qd);return x.createElement(HCe,I0({},r,{ref:t}))});v6.displayName="CartesianAxis";var VCe=["x1","y1","x2","y2","key"],GCe=["offset"],KCe=["xAxisId","yAxisId"],YCe=["xAxisId","yAxisId"];function dF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Io(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dF(Object(r),!0).forEach(function(n){XCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XCe(e,t,r){return(t=QCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QCe(e){var t=JCe(e,"string");return typeof t=="symbol"?t:t+""}function JCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function e0(){return e0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e0.apply(null,arguments)}function Vw(e,t){if(e==null)return{};var r,n,i=ZCe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function ZCe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var eEe=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:i,width:s,height:o,ry:l}=e;return x.createElement("rect",{x:n,y:i,ry:l,width:s,height:o,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function XG(e){var{option:t,lineItemProps:r}=e,n;if(x.isValidElement(t))n=x.cloneElement(t,r);else if(typeof t=="function")n=t(r);else{var i,{x1:s,y1:o,x2:l,y2:c,key:u}=r,d=Vw(r,VCe),f=(i=cl(d))!==null&&i!==void 0?i:{},{offset:h}=f,p=Vw(f,GCe);n=x.createElement("line",e0({},p,{x1:s,y1:o,x2:l,y2:c,fill:"none",key:u}))}return n}function tEe(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:i}=e;if(!n||!i||!i.length)return null;var{xAxisId:s,yAxisId:o}=e,l=Vw(e,KCe),c=i.map((u,d)=>{var f=Io(Io({},l),{},{x1:t,y1:u,x2:t+r,y2:u,key:"line-".concat(d),index:d});return x.createElement(XG,{key:"line-".concat(d),option:n,lineItemProps:f})});return x.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function rEe(e){var{y:t,height:r,vertical:n=!0,verticalPoints:i}=e;if(!n||!i||!i.length)return null;var{xAxisId:s,yAxisId:o}=e,l=Vw(e,YCe),c=i.map((u,d)=>{var f=Io(Io({},l),{},{x1:u,y1:t,x2:u,y2:t+r,key:"line-".concat(d),index:d});return x.createElement(XG,{option:n,lineItemProps:f,key:"line-".concat(d)})});return x.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function nEe(e){var{horizontalFill:t,fillOpacity:r,x:n,y:i,width:s,height:o,horizontalPoints:l,horizontal:c=!0}=e;if(!c||!t||!t.length||l==null)return null;var u=l.map(f=>Math.round(f+i-i)).sort((f,h)=>f-h);i!==u[0]&&u.unshift(0);var d=u.map((f,h)=>{var p=u[h+1],m=p==null,g=m?i+o-f:p-f;if(g<=0)return null;var y=h%t.length;return x.createElement("rect",{key:"react-".concat(h),y:f,x:n,height:g,width:s,stroke:"none",fill:t[y],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return x.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function iEe(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:i,y:s,width:o,height:l,verticalPoints:c}=e;if(!t||!r||!r.length)return null;var u=c.map(f=>Math.round(f+i-i)).sort((f,h)=>f-h);i!==u[0]&&u.unshift(0);var d=u.map((f,h)=>{var p=u[h+1],m=p==null,g=m?i+o-f:p-f;if(g<=0)return null;var y=h%r.length;return x.createElement("rect",{key:"react-".concat(h),x:f,y:s,width:g,height:l,stroke:"none",fill:r[y],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return x.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var aEe=(e,t)=>{var{xAxis:r,width:n,height:i,offset:s}=e;return Eq(b6(Io(Io(Io({},qd),r),{},{ticks:Tq(r),viewBox:{x:0,y:0,width:n,height:i}})),s.left,s.left+s.width,t)},sEe=(e,t)=>{var{yAxis:r,width:n,height:i,offset:s}=e;return Eq(b6(Io(Io(Io({},qd),r),{},{ticks:Tq(r),viewBox:{x:0,y:0,width:n,height:i}})),s.top,s.top+s.height,t)},oEe={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:Oa.grid};function My(e){var t=YC(),r=XC(),n=Dq(),i=Io(Io({},ka(e,oEe)),{},{x:En(e.x)?e.x:n.left,y:En(e.y)?e.y:n.top,width:En(e.width)?e.width:n.width,height:En(e.height)?e.height:n.height}),{xAxisId:s,yAxisId:o,x:l,y:c,width:u,height:d,syncWithTicks:f,horizontalValues:h,verticalValues:p}=i,m=Fs(),g=jn(M=>lR(M,"xAxis",s,m)),y=jn(M=>lR(M,"yAxis",o,m));if(!id(u)||!id(d)||!En(l)||!En(c))return null;var b=i.verticalCoordinatesGenerator||aEe,v=i.horizontalCoordinatesGenerator||sEe,{horizontalPoints:w,verticalPoints:S}=i;if((!w||!w.length)&&typeof v=="function"){var j=h&&h.length,k=v({yAxis:y?Io(Io({},y),{},{ticks:j?h:y.ticks}):void 0,width:t??u,height:r??d,offset:n},j?!0:f);xw(Array.isArray(k),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof k,"]")),Array.isArray(k)&&(w=k)}if((!S||!S.length)&&typeof b=="function"){var A=p&&p.length,R=b({xAxis:g?Io(Io({},g),{},{ticks:A?p:g.ticks}):void 0,width:t??u,height:r??d,offset:n},A?!0:f);xw(Array.isArray(R),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof R,"]")),Array.isArray(R)&&(S=R)}return x.createElement(wo,{zIndex:i.zIndex},x.createElement("g",{className:"recharts-cartesian-grid"},x.createElement(eEe,{fill:i.fill,fillOpacity:i.fillOpacity,x:i.x,y:i.y,width:i.width,height:i.height,ry:i.ry}),x.createElement(nEe,e0({},i,{horizontalPoints:w})),x.createElement(iEe,e0({},i,{verticalPoints:S})),x.createElement(tEe,e0({},i,{offset:n,horizontalPoints:w,xAxis:g,yAxis:y})),x.createElement(rEe,e0({},i,{offset:n,verticalPoints:S,xAxis:g,yAxis:y}))))}My.displayName="CartesianGrid";var lEe={},QG=Ll({name:"errorBars",initialState:lEe,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:i}=t.payload;e[r]&&(e[r]=e[r].map(s=>s.dataKey===n.dataKey&&s.direction===n.direction?i:s))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(i=>i.dataKey!==n.dataKey||i.direction!==n.direction))}}}),{addErrorBar:BMe,replaceErrorBar:IMe,removeErrorBar:DMe}=QG.actions,cEe=QG.reducer,uEe=["children"];function dEe(e,t){if(e==null)return{};var r,n,i=fEe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function fEe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var hEe={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},pEe=x.createContext(hEe);function w6(e){var{children:t}=e,r=dEe(e,uEe);return x.createElement(pEe.Provider,{value:r},t)}function J_(e,t){var r,n,i=jn(u=>dd(u,e)),s=jn(u=>fd(u,t)),o=(r=i==null?void 0:i.allowDataOverflow)!==null&&r!==void 0?r:$s.allowDataOverflow,l=(n=s==null?void 0:s.allowDataOverflow)!==null&&n!==void 0?n:Us.allowDataOverflow,c=o||l;return{needClip:c,needClipX:o,needClipY:l}}function S6(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,i=y6(),{needClipX:s,needClipY:o,needClip:l}=J_(t,r);if(!l||!i)return null;var{x:c,y:u,width:d,height:f}=i;return x.createElement("clipPath",{id:"clipPath-".concat(n)},x.createElement("rect",{x:s?c:c-d/2,y:o?u:u-f/2,width:s?d:d*2,height:o?f:f*2}))}var JG=(e,t,r,n)=>od(e,"xAxis",t,n),ZG=(e,t,r,n)=>sd(e,"xAxis",t,n),eK=(e,t,r,n)=>od(e,"yAxis",r,n),tK=(e,t,r,n)=>sd(e,"yAxis",r,n),mEe=Qt([Oi,JG,eK,ZG,tK],(e,t,r,n,i)=>hf(e,"xAxis")?Hm(t,n,!1):Hm(r,i,!1)),gEe=(e,t,r,n,i)=>i;function xEe(e){return e.type==="line"}var yEe=Qt([Ay,gEe],(e,t)=>e.filter(xEe).find(r=>r.id===t)),bEe=Qt([Oi,JG,eK,ZG,tK,yEe,mEe,b_],(e,t,r,n,i,s,o,l)=>{var{chartData:c,dataStartIndex:u,dataEndIndex:d}=l;if(!(s==null||t==null||r==null||n==null||i==null||n.length===0||i.length===0||o==null||e!=="horizontal"&&e!=="vertical")){var{dataKey:f,data:h}=s,p;if(h!=null&&h.length>0?p=h:p=c==null?void 0:c.slice(u,d+1),p!=null)return u6e({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:i,dataKey:f,bandSize:o,displayedData:p})}});function vEe(e){var t=yh(e),r=3,n=2;if(t!=null){var{r:i,strokeWidth:s}=t,o=Number(i),l=Number(s);return(Number.isNaN(o)||o<0)&&(o=r),(Number.isNaN(l)||l<0)&&(l=n),{r:o,strokeWidth:l}}return{r,strokeWidth:n}}var wEe={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ly=x;function SEe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var _Ee=typeof Object.is=="function"?Object.is:SEe,jEe=Ly.useSyncExternalStore,kEe=Ly.useRef,AEe=Ly.useEffect,NEe=Ly.useMemo,CEe=Ly.useDebugValue;wEe.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var s=kEe(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=NEe(function(){function c(p){if(!u){if(u=!0,d=p,p=n(p),i!==void 0&&o.hasValue){var m=o.value;if(i(m,p))return f=m}return f=p}if(m=f,_Ee(d,p))return m;var g=n(p);return i!==void 0&&i(m,g)?(d=p,m):(d=p,f=g)}var u=!1,d,f,h=r===void 0?null:r;return[function(){return c(t())},h===null?void 0:function(){return c(h())}]},[t,r,n,i]);var l=jEe(e,s[0],s[1]);return AEe(function(){o.hasValue=!0,o.value=l},[l]),CEe(l),l};function EEe(e){e()}function TEe(){let e=null,t=null;return{clear(){e=null,t=null},notify(){EEe(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const i=t={callback:r,next:null,prev:t};return i.prev?i.prev.next=i:e=i,function(){!n||e===null||(n=!1,i.next?i.next.prev=i.prev:t=i.prev,i.prev?i.prev.next=i.next:e=i.next)}}}}var fF={notify(){},get:()=>[]};function PEe(e,t){let r,n=fF,i=0,s=!1;function o(g){d();const y=n.subscribe(g);let b=!1;return()=>{b||(b=!0,y(),f())}}function l(){n.notify()}function c(){m.onStateChange&&m.onStateChange()}function u(){return s}function d(){i++,r||(r=e.subscribe(c),n=TEe())}function f(){i--,r&&i===0&&(r(),r=void 0,n.clear(),n=fF)}function h(){s||(s=!0,d())}function p(){s&&(s=!1,f())}const m={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:h,tryUnsubscribe:p,getListeners:()=>n};return m}var OEe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",MEe=OEe(),LEe=()=>typeof navigator<"u"&&navigator.product==="ReactNative",REe=LEe(),FEe=()=>MEe||REe?x.useLayoutEffect:x.useEffect,BEe=FEe();function hF(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function IEe(e,t){if(hF(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(!Object.prototype.hasOwnProperty.call(t,r[i])||!hF(e[r[i]],t[r[i]]))return!1;return!0}var uk=Symbol.for("react-redux-context"),dk=typeof globalThis<"u"?globalThis:{};function DEe(){if(!x.createContext)return{};const e=dk[uk]??(dk[uk]=new Map);let t=e.get(x.createContext);return t||(t=x.createContext(null),e.set(x.createContext,t)),t}var $Ee=DEe();function UEe(e){const{children:t,context:r,serverState:n,store:i}=e,s=x.useMemo(()=>{const c=PEe(i);return{store:i,subscription:c,getServerState:n?()=>n:void 0}},[i,n]),o=x.useMemo(()=>i.getState(),[i]);BEe(()=>{const{subscription:c}=s;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==i.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[s,o]);const l=r||$Ee;return x.createElement(l.Provider,{value:s},t)}var zEe=UEe,WEe=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function qEe(e,t){return e==null&&t==null?!0:typeof e=="number"&&typeof t=="number"?e===t||e!==e&&t!==t:e===t}function Ry(e,t){var r=new Set([...Object.keys(e),...Object.keys(t)]);for(var n of r)if(WEe.has(n)){if(e[n]==null&&t[n]==null)continue;if(!IEe(e[n],t[n]))return!1}else if(!qEe(e[n],t[n]))return!1;return!0}var HEe=["id"],VEe=["type","layout","connectNulls","needClip","shape"],GEe=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function U1(){return U1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},U1.apply(null,arguments)}function pF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Hu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pF(Object(r),!0).forEach(function(n){KEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KEe(e,t,r){return(t=YEe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YEe(e){var t=XEe(e,"string");return typeof t=="symbol"?t:t+""}function XEe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _6(e,t){if(e==null)return{};var r,n,i=QEe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function QEe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var JEe=e=>{var{dataKey:t,name:r,stroke:n,legendType:i,hide:s}=e;return[{inactive:s,dataKey:t,type:i,color:n,value:Ch(r,t),payload:e}]},ZEe=x.memo(e=>{var{dataKey:t,data:r,stroke:n,strokeWidth:i,fill:s,name:o,hide:l,unit:c,tooltipType:u,id:d}=e,f={dataDefinedOnItem:r,getPosition:ap,settings:{stroke:n,strokeWidth:i,fill:s,dataKey:t,nameKey:void 0,name:Ch(o,t),hide:l,type:u,color:n,unit:c,graphicalItemId:d}};return x.createElement(Y_,{tooltipEntrySettings:f})}),rK=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function e6e(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],i=0;i<t;++i)n=[...n,...r];return n}var t6e=(e,t,r)=>{var n=r.reduce((p,m)=>p+m);if(!n)return rK(t,e);for(var i=Math.floor(e/n),s=e%n,o=t-e,l=[],c=0,u=0;c<r.length;u+=(d=r[c])!==null&&d!==void 0?d:0,++c){var d,f=r[c];if(f!=null&&u+f>s){l=[...r.slice(0,c),s-u];break}}var h=l.length%2===0?[0,o]:[o];return[...e6e(r,i),...l,...h].map(p=>"".concat(p,"px")).join(", ")};function r6e(e){var{clipPathId:t,points:r,props:n}=e,{dot:i,dataKey:s,needClip:o}=n,{id:l}=n,c=_6(n,HEe),u=cl(c);return x.createElement(v3e,{points:r,dot:i,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:s,baseProps:u,needClip:o,clipPathId:t})}function n6e(e){var{showLabels:t,children:r,points:n}=e,i=x.useMemo(()=>n==null?void 0:n.map(s=>{var o,l,c={x:(o=s.x)!==null&&o!==void 0?o:0,y:(l=s.y)!==null&&l!==void 0?l:0,width:0,lowerWidth:0,upperWidth:0,height:0};return Hu(Hu({},c),{},{value:s.value,payload:s.payload,viewBox:c,parentViewBox:void 0,fill:void 0})}),[n]);return x.createElement(u6,{value:t?i:void 0},r)}function mF(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:i,props:s}=e,{type:o,layout:l,connectNulls:c,needClip:u,shape:d}=s,f=_6(s,VEe),h=Hu(Hu({},Vo(f)),{},{fill:"none",className:"recharts-line-curve",clipPath:u?"url(#clipPath-".concat(t,")"):void 0,points:n,type:o,layout:l,connectNulls:c,strokeDasharray:i??s.strokeDasharray});return x.createElement(x.Fragment,null,(n==null?void 0:n.length)>1&&x.createElement(D1,U1({shapeType:"curve",option:d},h,{pathRef:r})),x.createElement(r6e,{points:n,clipPathId:t,props:s}))}function i6e(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function a6e(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:i,longestAnimatedLengthRef:s}=e,{points:o,strokeDasharray:l,isAnimationActive:c,animationBegin:u,animationDuration:d,animationEasing:f,animateNewValues:h,width:p,height:m,onAnimationEnd:g,onAnimationStart:y}=r,b=i.current,v=gg(o,"recharts-line-"),w=x.useRef(v),[S,j]=x.useState(!1),k=!S,A=x.useCallback(()=>{typeof g=="function"&&g(),j(!1)},[g]),R=x.useCallback(()=>{typeof y=="function"&&y(),j(!0)},[y]),M=i6e(n.current),B=x.useRef(0);w.current!==v&&(B.current=s.current,w.current=v);var E=B.current;return x.createElement(n6e,{points:o,showLabels:k},r.children,x.createElement(mg,{animationId:v,begin:u,duration:d,isActive:c,easing:f,onAnimationEnd:A,onAnimationStart:R,key:v},P=>{var U=Xi(E,M+E,P),G=Math.min(U,M),H;if(c)if(l){var oe="".concat(l).split(/[,\s]+/gim).map(V=>parseFloat(V));H=t6e(G,M,oe)}else H=rK(M,G);else H=l==null?void 0:String(l);if(P>0&&M>0&&(i.current=o,s.current=Math.max(s.current,G)),b){var de=b.length/o.length,W=P===1?o:o.map((V,ae)=>{var ee=Math.floor(ae*de);if(b[ee]){var C=b[ee];return Hu(Hu({},V),{},{x:Xi(C.x,V.x,P),y:Xi(C.y,V.y,P)})}return h?Hu(Hu({},V),{},{x:Xi(p*2,V.x,P),y:Xi(m/2,V.y,P)}):Hu(Hu({},V),{},{x:V.x,y:V.y})});return i.current=W,x.createElement(mF,{props:r,points:W,clipPathId:t,pathRef:n,strokeDasharray:H})}return x.createElement(mF,{props:r,points:o,clipPathId:t,pathRef:n,strokeDasharray:H})}),x.createElement(O_,{label:r.label}))}function s6e(e){var{clipPathId:t,props:r}=e,n=x.useRef(null),i=x.useRef(0),s=x.useRef(null);return x.createElement(a6e,{props:r,clipPathId:t,previousPointsRef:n,longestAnimatedLengthRef:i,pathRef:s})}var o6e=(e,t)=>{var r,n;return{x:(r=e.x)!==null&&r!==void 0?r:void 0,y:(n=e.y)!==null&&n!==void 0?n:void 0,value:e.value,errorVal:Ti(e.payload,t)}};class l6e extends x.Component{render(){var{hide:t,dot:r,points:n,className:i,xAxisId:s,yAxisId:o,top:l,left:c,width:u,height:d,id:f,needClip:h,zIndex:p}=this.props;if(t)return null;var m=_i("recharts-line",i),g=f,{r:y,strokeWidth:b}=vEe(r),v=DG(r),w=y*2+b,S=h?"url(#clipPath-".concat(v?"":"dots-").concat(g,")"):void 0;return x.createElement(wo,{zIndex:p},x.createElement(ja,{className:m},h&&x.createElement("defs",null,x.createElement(S6,{clipPathId:g,xAxisId:s,yAxisId:o}),!v&&x.createElement("clipPath",{id:"clipPath-dots-".concat(g)},x.createElement("rect",{x:c-w/2,y:l-w/2,width:u+w,height:d+w}))),x.createElement(w6,{xAxisId:s,yAxisId:o,data:n,dataPointFormatter:o6e,errorBarOffset:0},x.createElement(s6e,{props:this.props,clipPathId:g}))),x.createElement(W3e,{activeDot:this.props.activeDot,points:n,mainColor:this.props.stroke,itemDataKey:this.props.dataKey,clipPath:S}))}}var nK={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:"auto",label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:Oa.line,type:"linear"};function c6e(e){var t=ka(e,nK),{activeDot:r,animateNewValues:n,animationBegin:i,animationDuration:s,animationEasing:o,connectNulls:l,dot:c,hide:u,isAnimationActive:d,label:f,legendType:h,xAxisId:p,yAxisId:m,id:g}=t,y=_6(t,GEe),{needClip:b}=J_(p,m),v=y6(),w=sp(),S=Fs(),j=jn(B=>bEe(B,p,m,S,g));if(w!=="horizontal"&&w!=="vertical"||j==null||v==null)return null;var{height:k,width:A,x:R,y:M}=v;return x.createElement(l6e,U1({},y,{id:g,connectNulls:l,dot:c,activeDot:r,animateNewValues:n,animationBegin:i,animationDuration:s,animationEasing:o,isAnimationActive:d,hide:u,label:f,legendType:h,xAxisId:p,yAxisId:m,points:j,layout:w,height:k,width:A,left:R,top:M,needClip:b}))}function u6e(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:i,yAxisTicks:s,dataKey:o,bandSize:l,displayedData:c}=e;return c.map((u,d)=>{var f=Ti(u,o);if(t==="horizontal"){var h=gw({axis:r,ticks:i,bandSize:l,entry:u,index:d}),p=Qi(f)?null:n.scale.map(f);return{x:h,y:p??null,value:f,payload:u}}var m=Qi(f)?null:r.scale.map(f),g=gw({axis:n,ticks:s,bandSize:l,entry:u,index:d});return m==null||g==null?null:{x:m,y:g,value:f,payload:u}}).filter(Boolean)}function d6e(e){var t=ka(e,nK),r=Fs();return x.createElement(X_,{id:t.id,type:"line"},n=>x.createElement(x.Fragment,null,x.createElement(g6,{legendPayload:JEe(t)}),x.createElement(ZEe,{dataKey:t.dataKey,data:t.data,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:n}),x.createElement(x6,{type:"line",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:r}),x.createElement(c6e,U1({},t,{id:n}))))}var iK=x.memo(d6e,Ry);iK.displayName="Line";function up(e,t){var r,n;return(r=(n=e.graphicalItems.cartesianItems.find(i=>i.id===t))===null||n===void 0?void 0:n.xAxisId)!==null&&r!==void 0?r:WG}function dp(e,t){var r,n;return(r=(n=e.graphicalItems.cartesianItems.find(i=>i.id===t))===null||n===void 0?void 0:n.yAxisId)!==null&&r!==void 0?r:WG}var f6e="Invariant failed";function h6e(e,t){throw new Error(f6e)}function tN(){return tN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tN.apply(null,arguments)}function Gw(e){return x.createElement(D1,tN({shapeType:"rectangle",activeClassName:"recharts-active-bar"},e))}var p6e=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,i)=>{if(En(t))return t;var s=En(n)||Qi(n);return s?t(n,i):(s||h6e(),r)}},m6e=(e,t,r)=>r,g6e=(e,t)=>t,Fy=Qt([Ay,g6e],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),x6e=Qt([Fy],e=>e==null?void 0:e.maxBarSize),y6e=(e,t,r,n)=>n,b6e=Qt([Oi,Ay,up,dp,m6e],(e,t,r,n,i)=>t.filter(s=>e==="horizontal"?s.xAxisId===r:s.yAxisId===n).filter(s=>s.isPanorama===i).filter(s=>s.hide===!1).filter(s=>s.type==="bar")),v6e=(e,t,r)=>{var n=Oi(e),i=up(e,t),s=dp(e,t);if(!(i==null||s==null))return n==="horizontal"?GA(e,"yAxis",s,r):GA(e,"xAxis",i,r)},w6e=(e,t)=>{var r=Oi(e),n=up(e,t),i=dp(e,t);if(!(n==null||i==null))return r==="horizontal"?oR(e,"xAxis",n):oR(e,"yAxis",i)},S6e=Qt([b6e,w5e,w6e],q3e),_6e=(e,t,r)=>{var n,i,s=Fy(e,t);if(s==null)return 0;var o=up(e,t),l=dp(e,t);if(o==null||l==null)return 0;var c=Oi(e),u=rV(e),{maxBarSize:d}=s,f=Qi(d)?u:d,h,p;return c==="horizontal"?(h=od(e,"xAxis",o,r),p=sd(e,"xAxis",o,r)):(h=od(e,"yAxis",l,r),p=sd(e,"yAxis",l,r)),(n=(i=Hm(h,p,!0))!==null&&i!==void 0?i:f)!==null&&n!==void 0?n:0},aK=(e,t,r)=>{var n=Oi(e),i=up(e,t),s=dp(e,t);if(!(i==null||s==null)){var o,l;return n==="horizontal"?(o=od(e,"xAxis",i,r),l=sd(e,"xAxis",i,r)):(o=od(e,"yAxis",s,r),l=sd(e,"yAxis",s,r)),Hm(o,l)}},j6e=Qt([S6e,rV,v5e,nV,_6e,aK,x6e],Y3e),k6e=(e,t,r)=>{var n=up(e,t);if(n!=null)return od(e,"xAxis",n,r)},A6e=(e,t,r)=>{var n=dp(e,t);if(n!=null)return od(e,"yAxis",n,r)},N6e=(e,t,r)=>{var n=up(e,t);if(n!=null)return sd(e,"xAxis",n,r)},C6e=(e,t,r)=>{var n=dp(e,t);if(n!=null)return sd(e,"yAxis",n,r)},E6e=Qt([j6e,Fy],Q3e),T6e=Qt([v6e,Fy],X3e),P6e=Qt([Rs,VC,k6e,A6e,N6e,C6e,E6e,Oi,f5e,aK,T6e,Fy,y6e],(e,t,r,n,i,s,o,l,c,u,d,f,h)=>{var{chartData:p,dataStartIndex:m,dataEndIndex:g}=c;if(!(f==null||o==null||t==null||l!=="horizontal"&&l!=="vertical"||r==null||n==null||i==null||s==null||u==null)){var{data:y}=f,b;if(y!=null&&y.length>0?b=y:b=p==null?void 0:p.slice(m,g+1),b!=null)return aTe({layout:l,barSettings:f,pos:o,parentViewBox:t,bandSize:u,xAxis:r,yAxis:n,xAxisTicks:i,yAxisTicks:s,stackedData:d,displayedData:b,offset:e,cells:h,dataStartIndex:m})}}),O6e=["index"];function rN(){return rN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rN.apply(null,arguments)}function M6e(e,t){if(e==null)return{};var r,n,i=L6e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function L6e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var sK=x.createContext(void 0),R6e=e=>{var t=x.useContext(sK);if(t!=null)return t.stackId;if(e!=null)return pve(e)},F6e=(e,t)=>"recharts-bar-stack-clip-path-".concat(e,"-").concat(t),B6e=e=>{var t=x.useContext(sK);if(t!=null){var{stackId:r}=t;return"url(#".concat(F6e(r,e),")")}},oK=e=>{var{index:t}=e,r=M6e(e,O6e),n=B6e(t);return x.createElement(ja,rN({className:"recharts-bar-stack-layer",clipPath:n},r))},I6e=["onMouseEnter","onMouseLeave","onClick"],D6e=["value","background","tooltipPosition"],$6e=["id"],U6e=["onMouseEnter","onClick","onMouseLeave"];function af(){return af=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},af.apply(null,arguments)}function gF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function rl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gF(Object(r),!0).forEach(function(n){z6e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function z6e(e,t,r){return(t=W6e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W6e(e){var t=q6e(e,"string");return typeof t=="symbol"?t:t+""}function q6e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kw(e,t){if(e==null)return{};var r,n,i=H6e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function H6e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var V6e=e=>{var{dataKey:t,name:r,fill:n,legendType:i,hide:s}=e;return[{inactive:s,dataKey:t,type:i,color:n,value:Ch(r,t),payload:e}]},G6e=x.memo(e=>{var{dataKey:t,stroke:r,strokeWidth:n,fill:i,name:s,hide:o,unit:l,tooltipType:c,id:u}=e,d={dataDefinedOnItem:void 0,getPosition:ap,settings:{stroke:r,strokeWidth:n,fill:i,dataKey:t,nameKey:void 0,name:Ch(s,t),hide:o,type:c,color:i,unit:l,graphicalItemId:u}};return x.createElement(Y_,{tooltipEntrySettings:d})});function K6e(e){var t=jn(nf),{data:r,dataKey:n,background:i,allOtherBarProps:s}=e,{onMouseEnter:o,onMouseLeave:l,onClick:c}=s,u=Kw(s,I6e),d=V_(o,n,s.id),f=G_(l),h=K_(c,n,s.id);if(!i||r==null)return null;var p=yh(i);return x.createElement(wo,{zIndex:J3e(i,Oa.barBackground)},r.map((m,g)=>{var{value:y,background:b,tooltipPosition:v}=m,w=Kw(m,D6e);if(!b)return null;var S=d(m,g),j=f(m,g),k=h(m,g),A=rl(rl(rl(rl(rl({option:i,isActive:String(g)===t},w),{},{fill:"#eee"},b),p),hg(u,m,g)),{},{onMouseEnter:S,onMouseLeave:j,onClick:k,dataKey:n,index:g,className:"recharts-bar-background-rectangle"});return x.createElement(Gw,af({key:"background-bar-".concat(g)},A))}))}function Y6e(e){var{showLabels:t,children:r,rects:n}=e,i=n==null?void 0:n.map(s=>{var o={x:s.x,y:s.y,width:s.width,lowerWidth:s.width,upperWidth:s.width,height:s.height};return rl(rl({},o),{},{value:s.value,payload:s.payload,parentViewBox:s.parentViewBox,viewBox:o,fill:s.fill})});return x.createElement(u6,{value:t?i:void 0},r)}function X6e(e){var{shape:t,activeBar:r,baseProps:n,entry:i,index:s,dataKey:o}=e,l=jn(nf),c=jn(i6),u=r&&String(s)===l&&(c==null||o===c),d=u?r:t;return u?x.createElement(wo,{zIndex:Oa.activeBar},x.createElement(oK,{index:s},x.createElement(Gw,af({},n,{name:String(n.name)},i,{isActive:u,option:d,index:s,dataKey:o})))):x.createElement(Gw,af({},n,{name:String(n.name)},i,{isActive:u,option:d,index:s,dataKey:o}))}function Q6e(e){var{shape:t,baseProps:r,entry:n,index:i,dataKey:s}=e;return x.createElement(Gw,af({},r,{name:String(r.name)},n,{isActive:!1,option:t,index:i,dataKey:s}))}function J6e(e){var t,{data:r,props:n}=e,i=(t=cl(n))!==null&&t!==void 0?t:{},{id:s}=i,o=Kw(i,$6e),{shape:l,dataKey:c,activeBar:u}=n,{onMouseEnter:d,onClick:f,onMouseLeave:h}=n,p=Kw(n,U6e),m=V_(d,c,s),g=G_(h),y=K_(f,c,s);return r?x.createElement(x.Fragment,null,r.map((b,v)=>x.createElement(oK,af({index:v,key:"rectangle-".concat(b==null?void 0:b.x,"-").concat(b==null?void 0:b.y,"-").concat(b==null?void 0:b.value,"-").concat(v),className:"recharts-bar-rectangle"},hg(p,b,v),{onMouseEnter:m(b,v),onMouseLeave:g(b,v),onClick:y(b,v)}),u?x.createElement(X6e,{shape:l,activeBar:u,baseProps:o,entry:b,index:v,dataKey:c}):x.createElement(Q6e,{shape:l,baseProps:o,entry:b,index:v,dataKey:c})))):null}function Z6e(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:i,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:c,onAnimationEnd:u,onAnimationStart:d}=t,f=r.current,h=gg(t,"recharts-bar-"),[p,m]=x.useState(!1),g=!p,y=x.useCallback(()=>{typeof u=="function"&&u(),m(!1)},[u]),b=x.useCallback(()=>{typeof d=="function"&&d(),m(!0)},[d]);return x.createElement(Y6e,{showLabels:g,rects:n},x.createElement(mg,{animationId:h,begin:o,duration:l,isActive:s,easing:c,onAnimationEnd:y,onAnimationStart:b,key:h},v=>{var w=v===1?n:n==null?void 0:n.map((S,j)=>{var k=f&&f[j];if(k)return rl(rl({},S),{},{x:Xi(k.x,S.x,v),y:Xi(k.y,S.y,v),width:Xi(k.width,S.width,v),height:Xi(k.height,S.height,v)});if(i==="horizontal"){var A=Xi(0,S.height,v),R=Xi(S.stackedBarStart,S.y,v);return rl(rl({},S),{},{y:R,height:A})}var M=Xi(0,S.width,v),B=Xi(S.stackedBarStart,S.x,v);return rl(rl({},S),{},{width:M,x:B})});return v>0&&(r.current=w??null),w==null?null:x.createElement(ja,null,x.createElement(J6e,{props:t,data:w}))}),x.createElement(O_,{label:t.label}),t.children)}function eTe(e){var t=x.useRef(null);return x.createElement(Z6e,{previousRectanglesRef:t,props:e})}var lK=0,tTe=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:Ti(e,t)}};class rTe extends x.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:i,xAxisId:s,yAxisId:o,needClip:l,background:c,id:u}=this.props;if(t||r==null)return null;var d=_i("recharts-bar",i),f=u;return x.createElement(ja,{className:d,id:u},l&&x.createElement("defs",null,x.createElement(S6,{clipPathId:f,xAxisId:s,yAxisId:o})),x.createElement(ja,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(f,")"):void 0},x.createElement(K6e,{data:r,dataKey:n,background:c,allOtherBarProps:this.props}),x.createElement(eTe,this.props)))}}var nTe={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:lK,xAxisId:0,yAxisId:0,zIndex:Oa.bar};function iTe(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:i,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d}=e,{needClip:f}=J_(t,r),h=sp(),p=Fs(),m=H_(e.children,cp),g=jn(v=>P6e(v,e.id,p,m));if(h!=="vertical"&&h!=="horizontal")return null;var y,b=g==null?void 0:g[0];return b==null||b.height==null||b.width==null?y=0:y=h==="vertical"?b.height/2:b.width/2,x.createElement(w6,{xAxisId:t,yAxisId:r,data:g,dataPointFormatter:tTe,errorBarOffset:y},x.createElement(rTe,af({},e,{layout:h,needClip:f,data:g,xAxisId:t,yAxisId:r,hide:n,legendType:i,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d})))}function aTe(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:i,bandSize:s,xAxis:o,yAxis:l,xAxisTicks:c,yAxisTicks:u,stackedData:d,displayedData:f,offset:h,cells:p,parentViewBox:m,dataStartIndex:g}=e,y=t==="horizontal"?l:o,b=d?y.scale.domain():null,v=mve({numericAxis:y}),w=y.scale.map(v);return f.map((S,j)=>{var k,A,R,M,B,E;if(d){var P=d[j+g];if(P==null)return null;k=cve(P,b)}else k=Ti(S,r),Array.isArray(k)||(k=[v,k]);var U=p6e(n,lK)(k[1],j);if(t==="horizontal"){var G,H=l.scale.map(k[0]),oe=l.scale.map(k[1]);if(H==null||oe==null)return null;A=pL({axis:o,ticks:c,bandSize:s,offset:i.offset,entry:S,index:j}),R=(G=oe??H)!==null&&G!==void 0?G:void 0,M=i.size;var de=H-oe;if(B=nd(de)?0:de,E={x:A,y:h.top,width:M,height:h.height},Math.abs(U)>0&&Math.abs(B)<Math.abs(U)){var W=Qs(B||U)*(Math.abs(U)-Math.abs(B));R-=W,B+=W}}else{var V=o.scale.map(k[0]),ae=o.scale.map(k[1]);if(V==null||ae==null)return null;if(A=V,R=pL({axis:l,ticks:u,bandSize:s,offset:i.offset,entry:S,index:j}),M=ae-V,B=i.size,E={x:h.left,y:R,width:h.width,height:B},Math.abs(U)>0&&Math.abs(M)<Math.abs(U)){var ee=Qs(M||U)*(Math.abs(U)-Math.abs(M));M+=ee}}if(A==null||R==null||M==null||B==null)return null;var C=rl(rl({},S),{},{stackedBarStart:w,x:A,y:R,width:M,height:B,value:d?k:k[1],payload:S,background:E,tooltipPosition:{x:A+M/2,y:R+B/2},parentViewBox:m},p&&p[j]&&p[j].props);return C}).filter(Boolean)}function sTe(e){var t=ka(e,nTe),r=R6e(t.stackId),n=Fs();return x.createElement(X_,{id:t.id,type:"bar"},i=>x.createElement(x.Fragment,null,x.createElement(g6,{legendPayload:V6e(t)}),x.createElement(G6e,{dataKey:t.dataKey,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:i}),x.createElement(x6,{type:"bar",id:i,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:r,hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:n}),x.createElement(wo,{zIndex:t.zIndex},x.createElement(iTe,af({},t,{id:i})))))}var Ux=x.memo(sTe,Ry);Ux.displayName="Bar";var oTe=["option","isActive"];function zx(){return zx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zx.apply(null,arguments)}function lTe(e,t){if(e==null)return{};var r,n,i=cTe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function cTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function uTe(e){var{option:t,isActive:r}=e,n=lTe(e,oTe);return typeof t=="string"?x.createElement(D1,zx({option:x.createElement(WS,zx({type:t},n)),isActive:r,shapeType:"symbols"},n)):x.createElement(D1,zx({option:t,isActive:r,shapeType:"symbols"},n))}var dTe=(e,t,r,n,i,s,o)=>od(e,"xAxis",t,o),fTe=(e,t,r,n,i,s,o)=>sd(e,"xAxis",t,o),hTe=(e,t,r,n,i,s,o)=>od(e,"yAxis",r,o),pTe=(e,t,r,n,i,s,o)=>sd(e,"yAxis",r,o),mTe=(e,t,r,n)=>Aje(e,"zAxis",n,!1),gTe=(e,t,r,n,i)=>i,xTe=(e,t,r,n,i,s)=>s,yTe=(e,t,r,n,i,s,o)=>b_(e,void 0,void 0,o),bTe=Qt([Ay,gTe],(e,t)=>e.filter(r=>r.type==="scatter").find(r=>r.id===t)),vTe=Qt([yTe,dTe,fTe,hTe,pTe,mTe,bTe,xTe],(e,t,r,n,i,s,o,l)=>{var{chartData:c,dataStartIndex:u,dataEndIndex:d}=e;if(o!=null){var f;if((o==null?void 0:o.data)!=null&&o.data.length>0?f=o.data:f=c==null?void 0:c.slice(u,d+1),!(f==null||t==null||n==null||r==null||i==null||(r==null?void 0:r.length)===0||(i==null?void 0:i.length)===0))return LTe({displayedData:f,xAxis:t,yAxis:n,zAxis:s,scatterSettings:o,xAxisTicks:r,yAxisTicks:i,cells:l})}}),wTe=["id"],STe=["onMouseEnter","onClick","onMouseLeave"],_Te=["animationBegin","animationDuration","animationEasing","hide","isAnimationActive","legendType","lineJointType","lineType","shape","xAxisId","yAxisId","zAxisId"];function nN(e,t){if(e==null)return{};var r,n,i=jTe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function jTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function D0(){return D0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},D0.apply(null,arguments)}function xF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function kl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xF(Object(r),!0).forEach(function(n){kTe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kTe(e,t,r){return(t=ATe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ATe(e){var t=NTe(e,"string");return typeof t=="symbol"?t:t+""}function NTe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CTe=e=>{var{dataKey:t,name:r,fill:n,legendType:i,hide:s}=e;return[{inactive:s,dataKey:t,type:i,color:n,value:Ch(r,t),payload:e}]},ETe=x.memo(e=>{var{dataKey:t,points:r,stroke:n,strokeWidth:i,fill:s,name:o,hide:l,tooltipType:c,id:u}=e,d={dataDefinedOnItem:r==null?void 0:r.map(f=>f.tooltipPayload),getPosition:f=>{var h;return r==null||(h=r[Number(f)])===null||h===void 0?void 0:h.tooltipPosition},settings:{stroke:n,strokeWidth:i,fill:s,nameKey:void 0,dataKey:t,name:Ch(o,t),hide:l,type:c,color:s,unit:"",graphicalItemId:u}};return x.createElement(Y_,{tooltipEntrySettings:d})});function TTe(e){var{points:t,props:r}=e,{line:n,lineType:i,lineJointType:s}=r;if(!n)return null;var o=cl(r),l=yh(n),c,u;if(i==="joint")c=t.map(y=>{var b,v;return{x:(b=y.cx)!==null&&b!==void 0?b:null,y:(v=y.cy)!==null&&v!==void 0?v:null}});else if(i==="fitting"){var{xmin:d,xmax:f,a:h,b:p}=X1e(t),m=y=>h*y+p;c=[{x:d,y:m(d)},{x:f,y:m(f)}]}var g=kl(kl(kl({},o),{},{fill:"none",stroke:o&&o.fill},l),{},{points:c});return x.isValidElement(n)?u=x.cloneElement(n,g):typeof n=="function"?u=n(g):u=x.createElement(u_,D0({},g,{type:s})),x.createElement(ja,{className:"recharts-scatter-line",key:"recharts-scatter-line"},u)}function PTe(e){var{showLabels:t,points:r,children:n}=e,i=pg(),s=x.useMemo(()=>r==null?void 0:r.map(o=>{var l,c,u={x:(l=o.x)!==null&&l!==void 0?l:0,y:(c=o.y)!==null&&c!==void 0?c:0,width:o.width,height:o.height,lowerWidth:o.width,upperWidth:o.width};return kl(kl({},u),{},{value:void 0,payload:o.payload,viewBox:u,parentViewBox:i,fill:void 0})}),[i,r]);return x.createElement(u6,{value:t?s:void 0},n)}function OTe(e){var{points:t,allOtherScatterProps:r}=e,{shape:n,activeShape:i,dataKey:s}=r,{id:o}=r,l=nN(r,wTe),c=jn(nf),{onMouseEnter:u,onClick:d,onMouseLeave:f}=r,h=nN(r,STe),p=V_(u,s,o),m=G_(f),g=K_(d,s,o);if(!lye(t))return null;var y=cl(l);return x.createElement(x.Fragment,null,x.createElement(TTe,{points:t,props:l}),t.map((b,v)=>{var w=i!=null&&i!==!1,S=w&&c===String(v),j=w&&S?i:n,k=kl(kl(kl({},y),b),{},{index:v,[HC]:String(o)});return x.createElement(wo,{key:"symbol-".concat(b==null?void 0:b.cx,"-").concat(b==null?void 0:b.cy,"-").concat(b==null?void 0:b.size,"-").concat(v),zIndex:S?Oa.activeDot:void 0},x.createElement(ja,D0({className:"recharts-scatter-symbol"},hg(h,b,v),{onMouseEnter:p(b,v),onMouseLeave:m(b,v),onClick:g(b,v)}),x.createElement(uTe,D0({option:j,isActive:S},k))))}))}function MTe(e){var{previousPointsRef:t,props:r}=e,{points:n,isAnimationActive:i,animationBegin:s,animationDuration:o,animationEasing:l}=r,c=t.current,u=gg(r,"recharts-scatter-"),[d,f]=x.useState(!1),h=x.useCallback(()=>{f(!1)},[]),p=x.useCallback(()=>{f(!0)},[]),m=!d;return x.createElement(PTe,{showLabels:m,points:n},r.children,x.createElement(mg,{animationId:u,begin:s,duration:o,isActive:i,easing:l,onAnimationEnd:h,onAnimationStart:p,key:u},g=>{var y=g===1?n:n==null?void 0:n.map((b,v)=>{var w=c&&c[v];return w?kl(kl({},b),{},{cx:b.cx==null?void 0:Xi(w.cx,b.cx,g),cy:b.cy==null?void 0:Xi(w.cy,b.cy,g),size:Xi(w.size,b.size,g)}):kl(kl({},b),{},{size:Xi(0,b.size,g)})});return g>0&&(t.current=y),x.createElement(ja,null,x.createElement(OTe,{points:y,allOtherScatterProps:r,showLabels:m}))}),x.createElement(O_,{label:r.label}))}function LTe(e){var{displayedData:t,xAxis:r,yAxis:n,zAxis:i,scatterSettings:s,xAxisTicks:o,yAxisTicks:l,cells:c}=e,u=Qi(r.dataKey)?s.dataKey:r.dataKey,d=Qi(n.dataKey)?s.dataKey:n.dataKey,f=i&&i.dataKey,h=i?i.range:Id.range,p=h&&h[0],m=r.scale.bandwidth?r.scale.bandwidth():0,g=n.scale.bandwidth?n.scale.bandwidth():0;return t.map((y,b)=>{var v=Ti(y,u),w=Ti(y,d),S=!Qi(f)&&Ti(y,f)||"-",j=[{name:Qi(r.dataKey)?s.name:r.name||String(r.dataKey),unit:r.unit||"",value:v,payload:y,dataKey:u,type:s.tooltipType},{name:Qi(n.dataKey)?s.name:n.name||String(n.dataKey),unit:n.unit||"",value:w,payload:y,dataKey:d,type:s.tooltipType}];S!=="-"&&i!=null&&j.push({name:i.name||i.dataKey,unit:i.unit||"",value:S,payload:y,dataKey:f,type:s.tooltipType});var k=gw({axis:r,ticks:o,bandSize:m,entry:y,index:b,dataKey:u}),A=gw({axis:n,ticks:l,bandSize:g,entry:y,index:b,dataKey:d}),R=S!=="-"&&i!=null?i.scale.map(S):p,M=R==null?0:Math.sqrt(Math.max(R,0)/Math.PI);return kl(kl({},y),{},{cx:k,cy:A,x:k==null?void 0:k-M,y:A==null?void 0:A-M,width:2*M,height:2*M,size:R,node:{x:v,y:w,z:S},tooltipPayload:j,tooltipPosition:{x:k,y:A},payload:y},c&&c[b]&&c[b].props)})}var RTe=(e,t,r)=>({x:e.cx,y:e.cy,value:Number(r==="x"?e.node.x:e.node.y),errorVal:Ti(e,t)});function FTe(e){var{hide:t,points:r,className:n,needClip:i,xAxisId:s,yAxisId:o,id:l}=e,c=x.useRef(null);if(t)return null;var u=_i("recharts-scatter",n),d=l;return x.createElement(wo,{zIndex:e.zIndex},x.createElement(ja,{className:u,clipPath:i?"url(#clipPath-".concat(d,")"):void 0,id:l},i&&x.createElement("defs",null,x.createElement(S6,{clipPathId:d,xAxisId:s,yAxisId:o})),x.createElement(w6,{xAxisId:s,yAxisId:o,data:r,dataPointFormatter:RTe,errorBarOffset:0},x.createElement(ja,{key:"recharts-scatter-symbols"},x.createElement(MTe,{props:e,previousPointsRef:c})))))}var cK={xAxisId:0,yAxisId:0,zAxisId:0,label:!1,line:!1,legendType:"circle",lineType:"joint",lineJointType:"linear",shape:"circle",hide:!1,isAnimationActive:"auto",animationBegin:0,animationDuration:400,animationEasing:"linear",zIndex:Oa.scatter};function BTe(e){var t=ka(e,cK),{animationBegin:r,animationDuration:n,animationEasing:i,hide:s,isAnimationActive:o,legendType:l,lineJointType:c,lineType:u,shape:d,xAxisId:f,yAxisId:h,zAxisId:p}=t,m=nN(t,_Te),{needClip:g}=J_(f,h),y=x.useMemo(()=>H_(e.children,cp),[e.children]),b=Fs(),v=jn(w=>vTe(w,f,h,p,e.id,y,b));return g==null||v==null?null:x.createElement(x.Fragment,null,x.createElement(ETe,{dataKey:e.dataKey,points:v,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType,id:e.id}),x.createElement(FTe,D0({},m,{xAxisId:f,yAxisId:h,zAxisId:p,lineType:u,lineJointType:c,legendType:l,shape:d,hide:s,isAnimationActive:o,animationBegin:r,animationDuration:n,animationEasing:i,points:v,needClip:g})))}function ITe(e){var t=ka(e,cK),r=Fs();return x.createElement(X_,{id:t.id,type:"scatter"},n=>x.createElement(x.Fragment,null,x.createElement(g6,{legendPayload:CTe(t)}),x.createElement(x6,{type:"scatter",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:t.zAxisId,dataKey:t.dataKey,hide:t.hide,name:t.name,tooltipType:t.tooltipType,isPanorama:r}),x.createElement(BTe,D0({},t,{id:n}))))}var uK=x.memo(ITe,Ry);uK.displayName="Scatter";var DTe=["domain","range"],$Te=["domain","range"];function yF(e,t){if(e==null)return{};var r,n,i=UTe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function UTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function bF(e,t){return e===t?!0:Array.isArray(e)&&e.length===2&&Array.isArray(t)&&t.length===2?e[0]===t[0]&&e[1]===t[1]:!1}function dK(e,t){if(e===t)return!0;var{domain:r,range:n}=e,i=yF(e,DTe),{domain:s,range:o}=t,l=yF(t,$Te);return!bF(r,s)||!bF(n,o)?!1:Ry(i,l)}var zTe=["type"],WTe=["dangerouslySetInnerHTML","ticks","scale"],qTe=["id","scale"];function iN(){return iN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},iN.apply(null,arguments)}function vF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function wF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vF(Object(r),!0).forEach(function(n){HTe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HTe(e,t,r){return(t=VTe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VTe(e){var t=GTe(e,"string");return typeof t=="symbol"?t:t+""}function GTe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aN(e,t){if(e==null)return{};var r,n,i=KTe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function KTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function YTe(e){var t=Zi(),r=x.useRef(null),n=$q(),{type:i}=e,s=aN(e,zTe),o=w_(n,"xAxis",i),l=x.useMemo(()=>{if(o!=null)return wF(wF({},s),{},{type:o})},[s,o]);return x.useLayoutEffect(()=>{l!=null&&(r.current===null?t(k3e(l)):r.current!==l&&t(A3e({prev:r.current,next:l})),r.current=l)},[l,t]),x.useLayoutEffect(()=>()=>{r.current&&(t(N3e(r.current)),r.current=null)},[t]),null}var XTe=e=>{var{xAxisId:t,className:r}=e,n=jn(VC),i=Fs(),s="xAxis",o=jn(b=>FV(b,s,t,i)),l=jn(b=>OV(b,t)),c=jn(b=>vje(b,t)),u=jn(b=>hV(b,t));if(l==null||c==null||u==null)return null;var{dangerouslySetInnerHTML:d,ticks:f,scale:h}=e,p=aN(e,WTe),{id:m,scale:g}=u,y=aN(u,qTe);return x.createElement(v6,iN({},p,y,{x:c.x,y:c.y,width:l.width,height:l.height,className:_i("recharts-".concat(s," ").concat(s),r),viewBox:n,ticks:o,axisType:s}))},QTe={allowDataOverflow:$s.allowDataOverflow,allowDecimals:$s.allowDecimals,allowDuplicatedCategory:$s.allowDuplicatedCategory,angle:$s.angle,axisLine:qd.axisLine,height:$s.height,hide:!1,includeHidden:$s.includeHidden,interval:$s.interval,label:!1,minTickGap:$s.minTickGap,mirror:$s.mirror,orientation:$s.orientation,padding:$s.padding,reversed:$s.reversed,scale:$s.scale,tick:$s.tick,tickCount:$s.tickCount,tickLine:qd.tickLine,tickSize:qd.tickSize,type:$s.type,xAxisId:0},JTe=e=>{var t=ka(e,QTe);return x.createElement(x.Fragment,null,x.createElement(YTe,{allowDataOverflow:t.allowDataOverflow,allowDecimals:t.allowDecimals,allowDuplicatedCategory:t.allowDuplicatedCategory,angle:t.angle,dataKey:t.dataKey,domain:t.domain,height:t.height,hide:t.hide,id:t.xAxisId,includeHidden:t.includeHidden,interval:t.interval,minTickGap:t.minTickGap,mirror:t.mirror,name:t.name,orientation:t.orientation,padding:t.padding,reversed:t.reversed,scale:t.scale,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit}),x.createElement(XTe,t))},By=x.memo(JTe,dK);By.displayName="XAxis";var ZTe=["type"],e8e=["dangerouslySetInnerHTML","ticks","scale"],t8e=["id","scale"];function sN(){return sN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sN.apply(null,arguments)}function SF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function _F(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SF(Object(r),!0).forEach(function(n){r8e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function r8e(e,t,r){return(t=n8e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n8e(e){var t=i8e(e,"string");return typeof t=="symbol"?t:t+""}function i8e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oN(e,t){if(e==null)return{};var r,n,i=a8e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function a8e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function s8e(e){var t=Zi(),r=x.useRef(null),n=$q(),{type:i}=e,s=oN(e,ZTe),o=w_(n,"yAxis",i),l=x.useMemo(()=>{if(o!=null)return _F(_F({},s),{},{type:o})},[o,s]);return x.useLayoutEffect(()=>{l!=null&&(r.current===null?t(C3e(l)):r.current!==l&&t(E3e({prev:r.current,next:l})),r.current=l)},[l,t]),x.useLayoutEffect(()=>()=>{r.current&&(t(T3e(r.current)),r.current=null)},[t]),null}function o8e(e){var{yAxisId:t,className:r,width:n,label:i}=e,s=x.useRef(null),o=x.useRef(null),l=jn(VC),c=Fs(),u=Zi(),d="yAxis",f=jn(k=>MV(k,t)),h=jn(k=>Sje(k,t)),p=jn(k=>FV(k,d,t,c)),m=jn(k=>pV(k,t));if(x.useLayoutEffect(()=>{if(!(n!=="auto"||!f||c6(i)||x.isValidElement(i)||m==null)){var k=s.current;if(k){var A=k.getCalculatedWidth();Math.round(f.width)!==Math.round(A)&&u(L3e({id:t,width:A}))}}},[p,f,u,i,t,n,m]),f==null||h==null||m==null)return null;var{dangerouslySetInnerHTML:g,ticks:y,scale:b}=e,v=oN(e,e8e),{id:w,scale:S}=m,j=oN(m,t8e);return x.createElement(v6,sN({},v,j,{ref:s,labelRef:o,x:h.x,y:h.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:f.width,height:f.height,className:_i("recharts-".concat(d," ").concat(d),r),viewBox:l,ticks:p,axisType:d}))}var l8e={allowDataOverflow:Us.allowDataOverflow,allowDecimals:Us.allowDecimals,allowDuplicatedCategory:Us.allowDuplicatedCategory,angle:Us.angle,axisLine:qd.axisLine,hide:!1,includeHidden:Us.includeHidden,interval:Us.interval,label:!1,minTickGap:Us.minTickGap,mirror:Us.mirror,orientation:Us.orientation,padding:Us.padding,reversed:Us.reversed,scale:Us.scale,tick:Us.tick,tickCount:Us.tickCount,tickLine:qd.tickLine,tickSize:qd.tickSize,type:Us.type,width:Us.width,yAxisId:0},c8e=e=>{var t=ka(e,l8e);return x.createElement(x.Fragment,null,x.createElement(s8e,{interval:t.interval,id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:t.includeHidden,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:t.angle,minTickGap:t.minTickGap,tick:t.tick,tickFormatter:t.tickFormatter}),x.createElement(o8e,t))},Iy=x.memo(c8e,dK);Iy.displayName="YAxis";function u8e(e){var t=Zi(),r=x.useRef(null);return x.useLayoutEffect(()=>{r.current===null?t(P3e(e)):r.current!==e&&t(O3e({prev:r.current,next:e})),r.current=e},[e,t]),x.useLayoutEffect(()=>()=>{r.current&&(t(M3e(r.current)),r.current=null)},[t]),null}var d8e={zAxisId:0,range:Id.range,scale:Id.scale,type:Id.type};function fK(e){var t=ka(e,d8e);return x.createElement(u8e,{domain:t.domain,id:t.zAxisId,dataKey:t.dataKey,name:t.name,unit:t.unit,range:t.range,scale:t.scale,type:t.type,allowDuplicatedCategory:Id.allowDuplicatedCategory,allowDataOverflow:Id.allowDataOverflow,reversed:Id.reversed,includeHidden:Id.includeHidden})}fK.displayName="ZAxis";var f8e=(e,t)=>t,j6=Qt([f8e,Oi,uV,eo,ZV,yf,Dke,Rs],Vke),k6=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},hK=Vc("mouseClick"),pK=my();pK.startListening({actionCreator:hK,effect:(e,t)=>{var r=e.payload,n=j6(t.getState(),k6(r));(n==null?void 0:n.activeIndex)!=null&&t.dispatch(Bje({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var lN=Vc("mouseMove"),mK=my(),mv=null;mK.startListening({actionCreator:lN,effect:(e,t)=>{var r=e.payload;mv!==null&&cancelAnimationFrame(mv);var n=k6(r);mv=requestAnimationFrame(()=>{var i=t.getState(),s=JE(i,i.tooltip.settings.shared);if(s==="axis"){var o=j6(i,n);(o==null?void 0:o.activeIndex)!=null?t.dispatch(qV({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate})):t.dispatch(WV())}mv=null})}});function h8e(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":e==="children"&&typeof t=="object"&&t!==null?"<<CHILDREN>>":t}var jF={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},gK=Ll({name:"rootProps",initialState:jF,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:jF.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className,e.baseValue=t.payload.baseValue,e.reverseStackOrder=t.payload.reverseStackOrder}}}),p8e=gK.reducer,{updateOptions:m8e}=gK.actions,g8e=null,x8e={updatePolarOptions:(e,t)=>t.payload},xK=Ll({name:"polarOptions",initialState:g8e,reducers:x8e}),{updatePolarOptions:y8e}=xK.actions,b8e=xK.reducer,yK=Vc("keyDown"),bK=Vc("focus"),A6=my();A6.startListening({actionCreator:yK,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip,s=e.payload;if(!(s!=="ArrowRight"&&s!=="ArrowLeft"&&s!=="Enter")){var o=ZE(i,kg(r),Cy(r),Ty(r)),l=o==null?-1:Number(o);if(!(!Number.isFinite(l)||l<0)){var c=yf(r);if(s==="Enter"){var u=$w(r,"axis","hover",String(i.index));t.dispatch(YA({active:!i.active,activeIndex:i.index,activeCoordinate:u}));return}var d=Nje(r),f=d==="left-to-right"?1:-1,h=s==="ArrowRight"?1:-1,p=l+h*f;if(!(c==null||p>=c.length||p<0)){var m=$w(r,"axis","hover",String(p));t.dispatch(YA({active:!0,activeIndex:p.toString(),activeCoordinate:m}))}}}}}});A6.startListening({actionCreator:bK,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip;if(!i.active&&i.index==null){var s="0",o=$w(r,"axis","hover",String(s));t.dispatch(YA({active:!0,activeIndex:s,activeCoordinate:o}))}}}});var Ec=Vc("externalEvent"),vK=my(),fk=new Map;vK.startListening({actionCreator:Ec,effect:(e,t)=>{var{handler:r,reactEvent:n}=e.payload;if(r!=null){n.persist();var i=n.type,s=fk.get(i);s!==void 0&&cancelAnimationFrame(s);var o=requestAnimationFrame(()=>{try{var l=t.getState(),c={activeCoordinate:_ke(l),activeDataKey:i6(l),activeIndex:nf(l),activeLabel:rG(l),activeTooltipIndex:nf(l),isTooltipActive:jke(l)};r(c,n)}finally{fk.delete(i)}});fk.set(i,o)}}});var v8e=Qt([_g],e=>e.tooltipItemPayloads),w8e=Qt([v8e,(e,t)=>t,(e,t,r)=>r],(e,t,r)=>{if(t!=null){var n=e.find(s=>s.settings.graphicalItemId===r);if(n!=null){var{getPosition:i}=n;if(i!=null)return i(t)}}}),wK=Vc("touchMove"),SK=my();SK.startListening({actionCreator:wK,effect:(e,t)=>{var r=e.payload;if(!(r.touches==null||r.touches.length===0)){var n=t.getState(),i=JE(n,n.tooltip.settings.shared);if(i==="axis"){var s=r.touches[0];if(s==null)return;var o=j6(n,k6({clientX:s.clientX,clientY:s.clientY,currentTarget:r.currentTarget}));(o==null?void 0:o.activeIndex)!=null&&t.dispatch(qV({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if(i==="item"){var l,c=r.touches[0];if(document.elementFromPoint==null||c==null)return;var u=document.elementFromPoint(c.clientX,c.clientY);if(!u||!u.getAttribute)return;var d=u.getAttribute(Oq),f=(l=u.getAttribute(HC))!==null&&l!==void 0?l:void 0,h=jg(n).find(g=>g.id===f);if(d==null||h==null||f==null)return;var{dataKey:p}=h,m=w8e(n,d,f);t.dispatch(zV({activeDataKey:p,activeIndex:d,activeCoordinate:m,activeGraphicalItemId:f}))}}}});var S8e=eq({brush:Z3e,cartesianAxis:R3e,chartData:S4e,errorBars:cEe,graphicalItems:DNe,layout:ive,legend:o2e,options:x4e,polarAxis:JAe,polarOptions:b8e,referenceElements:oCe,rootProps:p8e,tooltip:Ije,zIndex:s4e}),_8e=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return Ebe({reducer:S8e,preloadedState:t,middleware:n=>{var i;return n({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((i="es6")!==null&&i!==void 0?i:"")}).concat([pK.middleware,mK.middleware,A6.middleware,vK.middleware,SK.middleware])},enhancers:n=>{var i=n;return typeof n=="function"&&(i=n()),i.concat(mq({type:"raf"}))},devTools:{serialize:{replacer:h8e},name:"recharts-".concat(r)}})};function _K(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,i=Fs(),s=x.useRef(null);if(i)return r;s.current==null&&(s.current=_8e(t,n));var o=FC;return x.createElement(zEe,{context:o,store:s.current},r)}function j8e(e){var{layout:t,margin:r}=e,n=Zi(),i=Fs();return x.useEffect(()=>{i||(n(tve(t)),n(eve(r)))},[n,i,t,r]),null}var jK=x.memo(j8e,Ry);function kK(e){var t=Zi();return x.useEffect(()=>{t(m8e(e))},[t,e]),null}function kF(e){var{zIndex:t,isPanorama:r}=e,n=x.useRef(null),i=Zi();return x.useLayoutEffect(()=>(n.current&&i(i4e({zIndex:t,element:n.current,isPanorama:r})),()=>{i(a4e({zIndex:t,isPanorama:r}))}),[i,t,r]),x.createElement("g",{tabIndex:-1,ref:n})}function AF(e){var{children:t,isPanorama:r}=e,n=jn(Kke);if(!n||n.length===0)return t;var i=n.filter(o=>o<0),s=n.filter(o=>o>0);return x.createElement(x.Fragment,null,i.map(o=>x.createElement(kF,{key:o,zIndex:o,isPanorama:r})),t,s.map(o=>x.createElement(kF,{key:o,zIndex:o,isPanorama:r})))}var k8e=["children"];function A8e(e,t){if(e==null)return{};var r,n,i=N8e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function N8e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Yw(){return Yw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yw.apply(null,arguments)}var C8e={width:"100%",height:"100%",display:"block"},E8e=x.forwardRef((e,t)=>{var r=YC(),n=XC(),i=Jq();if(!id(r)||!id(n))return null;var{children:s,otherAttributes:o,title:l,desc:c}=e,u,d;return o!=null&&(typeof o.tabIndex=="number"?u=o.tabIndex:u=i?0:void 0,typeof o.role=="string"?d=o.role:d=i?"application":void 0),x.createElement(SC,Yw({},o,{title:l,desc:c,role:d,tabIndex:u,width:r,height:n,style:C8e,ref:t}),s)}),T8e=e=>{var{children:t}=e,r=jn(s_);if(!r)return null;var{width:n,height:i,y:s,x:o}=r;return x.createElement(SC,{width:n,height:i,x:o,y:s},t)},NF=x.forwardRef((e,t)=>{var{children:r}=e,n=A8e(e,k8e),i=Fs();return i?x.createElement(T8e,null,x.createElement(AF,{isPanorama:!0},r)):x.createElement(E8e,Yw({ref:t},n),x.createElement(AF,{isPanorama:!1},r))});function P8e(){var e=Zi(),[t,r]=x.useState(null),n=jn(wve);return x.useEffect(()=>{if(t!=null){var i=t.getBoundingClientRect(),s=i.width/t.offsetWidth;pi(s)&&s!==n&&e(nve(s))}},[t,e,n]),r}function CF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function O8e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CF(Object(r),!0).forEach(function(n){M8e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function M8e(e,t,r){return(t=L8e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L8e(e){var t=R8e(e,"string");return typeof t=="symbol"?t:t+""}function R8e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lh(){return lh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lh.apply(null,arguments)}var F8e=()=>(P4e(),null);function Xw(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var B8e=x.forwardRef((e,t)=>{var r,n,i=x.useRef(null),[s,o]=x.useState({containerWidth:Xw((r=e.style)===null||r===void 0?void 0:r.width),containerHeight:Xw((n=e.style)===null||n===void 0?void 0:n.height)}),l=x.useCallback((u,d)=>{o(f=>{var h=Math.round(u),p=Math.round(d);return f.containerWidth===h&&f.containerHeight===p?f:{containerWidth:h,containerHeight:p}})},[]),c=x.useCallback(u=>{if(typeof t=="function"&&t(u),u!=null&&typeof ResizeObserver<"u"){var{width:d,height:f}=u.getBoundingClientRect();l(d,f);var h=m=>{var g=m[0];if(g!=null){var{width:y,height:b}=g.contentRect;l(y,b)}},p=new ResizeObserver(h);p.observe(u),i.current=p}},[t,l]);return x.useEffect(()=>()=>{var u=i.current;u!=null&&u.disconnect()},[l]),x.createElement(x.Fragment,null,x.createElement(yy,{width:s.containerWidth,height:s.containerHeight}),x.createElement("div",lh({ref:c},e)))}),I8e=x.forwardRef((e,t)=>{var{width:r,height:n}=e,[i,s]=x.useState({containerWidth:Xw(r),containerHeight:Xw(n)}),o=x.useCallback((c,u)=>{s(d=>{var f=Math.round(c),h=Math.round(u);return d.containerWidth===f&&d.containerHeight===h?d:{containerWidth:f,containerHeight:h}})},[]),l=x.useCallback(c=>{if(typeof t=="function"&&t(c),c!=null){var{width:u,height:d}=c.getBoundingClientRect();o(u,d)}},[t,o]);return x.createElement(x.Fragment,null,x.createElement(yy,{width:i.containerWidth,height:i.containerHeight}),x.createElement("div",lh({ref:l},e)))}),D8e=x.forwardRef((e,t)=>{var{width:r,height:n}=e;return x.createElement(x.Fragment,null,x.createElement(yy,{width:r,height:n}),x.createElement("div",lh({ref:t},e)))}),$8e=x.forwardRef((e,t)=>{var{width:r,height:n}=e;return typeof r=="string"||typeof n=="string"?x.createElement(I8e,lh({},e,{ref:t})):typeof r=="number"&&typeof n=="number"?x.createElement(D8e,lh({},e,{width:r,height:n,ref:t})):x.createElement(x.Fragment,null,x.createElement(yy,{width:r,height:n}),x.createElement("div",lh({ref:t},e)))});function U8e(e){return e?B8e:$8e}var z8e=x.forwardRef((e,t)=>{var{children:r,className:n,height:i,onClick:s,onContextMenu:o,onDoubleClick:l,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:f,onMouseUp:h,onTouchEnd:p,onTouchMove:m,onTouchStart:g,style:y,width:b,responsive:v,dispatchTouchEvents:w=!0}=e,S=x.useRef(null),j=Zi(),[k,A]=x.useState(null),[R,M]=x.useState(null),B=P8e(),E=GC(),P=(E==null?void 0:E.width)>0?E.width:b,U=(E==null?void 0:E.height)>0?E.height:i,G=x.useCallback(K=>{B(K),typeof t=="function"&&t(K),A(K),M(K),K!=null&&(S.current=K)},[B,t,A,M]),H=x.useCallback(K=>{j(hK(K)),j(Ec({handler:s,reactEvent:K}))},[j,s]),oe=x.useCallback(K=>{j(lN(K)),j(Ec({handler:u,reactEvent:K}))},[j,u]),de=x.useCallback(K=>{j(WV()),j(Ec({handler:d,reactEvent:K}))},[j,d]),W=x.useCallback(K=>{j(lN(K)),j(Ec({handler:f,reactEvent:K}))},[j,f]),V=x.useCallback(()=>{j(bK())},[j]),ae=x.useCallback(K=>{j(yK(K.key))},[j]),ee=x.useCallback(K=>{j(Ec({handler:o,reactEvent:K}))},[j,o]),C=x.useCallback(K=>{j(Ec({handler:l,reactEvent:K}))},[j,l]),Y=x.useCallback(K=>{j(Ec({handler:c,reactEvent:K}))},[j,c]),q=x.useCallback(K=>{j(Ec({handler:h,reactEvent:K}))},[j,h]),O=x.useCallback(K=>{j(Ec({handler:g,reactEvent:K}))},[j,g]),X=x.useCallback(K=>{w&&j(wK(K)),j(Ec({handler:m,reactEvent:K}))},[j,w,m]),F=x.useCallback(K=>{j(Ec({handler:p,reactEvent:K}))},[j,p]),Q=U8e(v);return x.createElement(cG.Provider,{value:k},x.createElement(Zz.Provider,{value:R},x.createElement(Q,{width:P??(y==null?void 0:y.width),height:U??(y==null?void 0:y.height),className:_i("recharts-wrapper",n),style:O8e({position:"relative",cursor:"default",width:P,height:U},y),onClick:H,onContextMenu:ee,onDoubleClick:C,onFocus:V,onKeyDown:ae,onMouseDown:Y,onMouseEnter:oe,onMouseLeave:de,onMouseMove:W,onMouseUp:q,onTouchEnd:F,onTouchMove:X,onTouchStart:O,ref:G},x.createElement(F8e,null),r)))}),W8e=["width","height","responsive","children","className","style","compact","title","desc"];function q8e(e,t){if(e==null)return{};var r,n,i=H8e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function H8e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var AK=x.forwardRef((e,t)=>{var{width:r,height:n,responsive:i,children:s,className:o,style:l,compact:c,title:u,desc:d}=e,f=q8e(e,W8e),h=cl(f);return c?x.createElement(x.Fragment,null,x.createElement(yy,{width:r,height:n}),x.createElement(NF,{otherAttributes:h,title:u,desc:d},s)):x.createElement(z8e,{className:o,style:l,width:r,height:n,responsive:i??!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},x.createElement(NF,{otherAttributes:h,title:u,desc:d,ref:t},x.createElement(lCe,null,s)))});function cN(){return cN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cN.apply(null,arguments)}var V8e={top:5,right:5,bottom:5,left:5},G8e={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:V8e,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},N6=x.forwardRef(function(t,r){var n,i=ka(t.categoricalChartProps,G8e),{chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,categoricalChartProps:u}=t,d={chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,eventEmitter:void 0};return x.createElement(_K,{preloadedState:{options:d},reduxStoreName:(n=u.id)!==null&&n!==void 0?n:s},x.createElement(HG,{chartData:u.data}),x.createElement(jK,{layout:i.layout,margin:i.margin}),x.createElement(kK,{baseValue:i.baseValue,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className,reverseStackOrder:i.reverseStackOrder}),x.createElement(AK,cN({},i,{ref:r})))}),K8e=["axis"],Y8e=x.forwardRef((e,t)=>x.createElement(N6,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:K8e,tooltipPayloadSearcher:T_,categoricalChartProps:e,ref:t})),X8e=["axis","item"],NK=x.forwardRef((e,t)=>x.createElement(N6,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:X8e,tooltipPayloadSearcher:T_,categoricalChartProps:e,ref:t}));function Q8e(e){var t=Zi();return x.useEffect(()=>{t(y8e(e))},[t,e]),null}var J8e=["layout"];function uN(){return uN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uN.apply(null,arguments)}function Z8e(e,t){if(e==null)return{};var r,n,i=ePe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function ePe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var tPe={top:5,right:5,bottom:5,left:5},CK={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:tPe,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},rPe=x.forwardRef(function(t,r){var n,i=ka(t.categoricalChartProps,CK),{layout:s}=i,o=Z8e(i,J8e),{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d}=t,f={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d,eventEmitter:void 0};return x.createElement(_K,{preloadedState:{options:f},reduxStoreName:(n=i.id)!==null&&n!==void 0?n:l},x.createElement(HG,{chartData:i.data}),x.createElement(jK,{layout:s,margin:i.margin}),x.createElement(kK,{baseValue:void 0,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className,reverseStackOrder:i.reverseStackOrder}),x.createElement(Q8e,{cx:i.cx,cy:i.cy,startAngle:i.startAngle,endAngle:i.endAngle,innerRadius:i.innerRadius,outerRadius:i.outerRadius}),x.createElement(AK,uN({},o,{ref:r})))});function EF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function TF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EF(Object(r),!0).forEach(function(n){nPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nPe(e,t,r){return(t=iPe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iPe(e){var t=aPe(e,"string");return typeof t=="symbol"?t:t+""}function aPe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sPe=["item"],oPe=TF(TF({},CK),{},{layout:"centric",startAngle:0,endAngle:360}),lPe=x.forwardRef((e,t)=>{var r=ka(e,oPe);return x.createElement(rPe,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:sPe,tooltipPayloadSearcher:T_,categoricalChartProps:r,ref:t})}),cPe=["item"],uPe=x.forwardRef((e,t)=>x.createElement(N6,{chartName:"ScatterChart",defaultTooltipEventType:"item",validateTooltipEventTypes:cPe,tooltipPayloadSearcher:T_,categoricalChartProps:e,ref:t}));function hk(e,t){try{const r=Zn(`${t}_${e}`);if(!r)return null;if(r.rowsByStudentId&&typeof r.rowsByStudentId=="object")return r.rowsByStudentId;if(Array.isArray(r.rows)){const n={};return r.rows.forEach(i=>{n[String(i.studentId||i.id||"")]=i}),n}if(Array.isArray(r)){const n={};return r.forEach(i=>{n[String(i.studentId||i.id||"")]=i}),n}return typeof r=="object"?r:null}catch{return null}}function pk(e){if(!e)return null;for(const t of["total","mark","score","marks"])if(typeof e[t]=="number")return e[t];return null}const dN=58;function nx({title:e,subtitle:t,children:r}){return a.jsxs("div",{className:"obe-card",style:{padding:"18px 18px 14px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline",marginBottom:14},children:[a.jsx("div",{style:{fontWeight:800,fontSize:15,color:"#0f172a"},children:e}),t&&a.jsx("div",{style:{fontSize:11,color:"#94a3b8",fontWeight:600},children:t})]}),r]})}function Dy(){return a.jsxs("div",{style:{textAlign:"center",padding:"32px 0",color:"#94a3b8",fontSize:13},children:[a.jsx("svg",{width:32,height:32,viewBox:"0 0 24 24",fill:"none",stroke:"#cbd5e1",strokeWidth:1.5,style:{margin:"0 auto 6px",display:"block"},children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 3v18h18M7 16l4-5 4 3 4-6"})}),"No marks saved yet"]})}function dPe(e){const t=hk(e,"cia1_sheet"),r=hk(e,"cia2_sheet"),n=hk(e,"model_sheet"),i=new Set;return[t,r,n].forEach(s=>s&&Object.keys(s).forEach(o=>i.add(o))),Array.from(i).map(s=>{const o=t!=null&&t[s]?pk(t[s]):null,l=r!=null&&r[s]?pk(r[s]):null,c=n!=null&&n[s]?pk(n[s]):null,u=[o,l,c].filter(f=>f!==null),d=u.length?u.reduce((f,h)=>f+h,0)/u.length:null;return{id:s,cia1:o??void 0,cia2:l??void 0,model:c??void 0,avg:d??void 0}})}function fPe({students:e}){const t=e.filter(c=>typeof c.avg=="number"),r=t.length,n=t.filter(c=>(c.avg??0)>=dN).length,i=r?t.reduce((c,u)=>c+(u.avg??0),0)/r:0,s=r?Math.max(...t.map(c=>c.avg??0)):0,o=r?Math.min(...t.map(c=>c.avg??0)):0,l=[{label:"Total Students",value:r,color:"#0b74b8"},{label:"Passed",value:n,color:"#10b981"},{label:"Class Avg",value:i.toFixed(1),color:"#f59e0b"},{label:"Highest",value:s.toFixed(1),color:"#8b5cf6"},{label:"Lowest",value:o.toFixed(1),color:"#ef4444"}];return a.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:12,marginBottom:14},children:l.map(c=>a.jsxs("div",{style:{flex:"1 1 120px",background:"#fff",borderRadius:12,padding:"14px 18px",boxShadow:"0 2px 8px rgba(0,0,0,0.07)",borderLeft:`4px solid ${c.color}`},children:[a.jsx("div",{style:{fontSize:22,fontWeight:900,color:c.color},children:c.value}),a.jsx("div",{style:{fontSize:12,color:"#64748b",marginTop:2,fontWeight:600},children:c.label})]},c.label))})}function hPe({students:e}){const t=n=>{const i=n.filter(s=>typeof s=="number");return i.length?Math.round(i.reduce((s,o)=>s+o,0)/i.length*10)/10:0},r=[{name:"CIA 1",average:t(e.map(n=>n.cia1))},{name:"CIA 2",average:t(e.map(n=>n.cia2))},{name:"Model",average:t(e.map(n=>n.model))}];return e.length===0?a.jsx(Dy,{}):a.jsx(xy,{width:"100%",height:220,children:a.jsxs(Y8e,{data:r,margin:{top:10,right:20,left:0,bottom:5},children:[a.jsx(My,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),a.jsx(By,{dataKey:"name",tick:{fontSize:12,fill:"#475569"}}),a.jsx(Iy,{domain:[0,100],tick:{fontSize:11,fill:"#94a3b8"}}),a.jsx(Oy,{contentStyle:{borderRadius:10,fontSize:13}}),a.jsx(iK,{type:"monotone",dataKey:"average",stroke:"#0b74b8",strokeWidth:3,dot:{r:6,fill:"#ff8c42",stroke:"#fff",strokeWidth:2},activeDot:{r:8}})]})})}const PF=["#ef4444","#f59e0b","#06b6d4","#10b981"];function pPe({students:e}){const t={"Fail (<58)":0,"5864":0,"6574":0,"75+":0};e.forEach(s=>{const o=s.avg??0;o<58?t["Fail (<58)"]+=1:o<65?t["5864"]+=1:o<75?t["6574"]+=1:t["75+"]+=1});const r=Object.entries(t).map(([s,o])=>({name:s,value:o})).filter(s=>s.value>0),n=e.filter(s=>typeof s.avg=="number").length,i=n?Math.round((n-t["Fail (<58)"])/n*100):0;return r.length===0?a.jsx(Dy,{}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{style:{textAlign:"center",marginBottom:4},children:[a.jsxs("span",{style:{fontSize:28,fontWeight:900,color:i>=75?"#10b981":"#f59e0b"},children:[i,"%"]}),a.jsx("span",{style:{fontSize:12,color:"#64748b",marginLeft:6},children:"Pass Rate"})]}),a.jsx(xy,{width:"100%",height:200,children:a.jsxs(lPe,{children:[a.jsx(zG,{data:r,cx:"50%",cy:"50%",innerRadius:50,outerRadius:80,paddingAngle:3,dataKey:"value",label:({name:s,percent:o})=>`${s} ${(o*100).toFixed(0)}%`,labelLine:!1,children:r.map((s,o)=>a.jsx(cp,{fill:PF[o%PF.length]},o))}),a.jsx(Oy,{}),a.jsx(ZC,{iconType:"circle",iconSize:10})]})})]})}function mPe({students:e}){const t=[...e].filter(n=>typeof n.avg=="number").sort((n,i)=>(i.avg??0)-(n.avg??0)),r=[...t.slice(0,5).map(n=>({id:n.id.slice(-6),avg:+(n.avg??0).toFixed(1),group:"Top"})),...t.slice(-5).reverse().map(n=>({id:n.id.slice(-6),avg:+(n.avg??0).toFixed(1),group:"Bottom"}))];return r.length===0?a.jsx(Dy,{}):a.jsx(xy,{width:"100%",height:260,children:a.jsxs(NK,{data:r,layout:"vertical",margin:{top:4,right:24,left:8,bottom:4},children:[a.jsx(My,{strokeDasharray:"3 3",horizontal:!1,stroke:"#e2e8f0"}),a.jsx(By,{type:"number",domain:[0,100],tick:{fontSize:11,fill:"#94a3b8"}}),a.jsx(Iy,{dataKey:"id",type:"category",tick:{fontSize:11,fill:"#475569"},width:56}),a.jsx(Oy,{contentStyle:{borderRadius:10,fontSize:13}}),a.jsx(Ux,{dataKey:"avg",radius:[0,6,6,0],children:r.map((n,i)=>a.jsx(cp,{fill:n.group==="Top"?"#0b74b8":"#ef4444"},i))})]})})}function gPe({students:e}){const t=e.filter(r=>r.cia1!=null||r.cia2!=null||r.model!=null).slice(0,25).map(r=>({id:r.id.slice(-5),CIA1:r.cia1!=null?+r.cia1.toFixed(1):null,CIA2:r.cia2!=null?+r.cia2.toFixed(1):null,Model:r.model!=null?+r.model.toFixed(1):null}));return t.length===0?a.jsx(Dy,{}):a.jsx(xy,{width:"100%",height:240,children:a.jsxs(NK,{data:t,margin:{top:10,right:10,left:0,bottom:20},children:[a.jsx(My,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),a.jsx(By,{dataKey:"id",tick:{fontSize:9,fill:"#475569"},angle:-45,textAnchor:"end",interval:0}),a.jsx(Iy,{domain:[0,100],tick:{fontSize:10,fill:"#94a3b8"}}),a.jsx(Oy,{contentStyle:{borderRadius:10,fontSize:12}}),a.jsx(ZC,{iconType:"circle",iconSize:9}),a.jsx(Ux,{dataKey:"CIA1",fill:"#0b74b8",radius:[3,3,0,0]}),a.jsx(Ux,{dataKey:"CIA2",fill:"#06b6d4",radius:[3,3,0,0]}),a.jsx(Ux,{dataKey:"Model",fill:"#f59e0b",radius:[3,3,0,0]})]})})}function xPe({students:e}){const t=e.filter(r=>r.cia1!=null&&r.cia2!=null).map(r=>({x:+(r.cia1??0).toFixed(1),y:+(r.cia2??0).toFixed(1),id:r.id}));return t.length===0?a.jsx(Dy,{}):a.jsx(xy,{width:"100%",height:220,children:a.jsxs(uPe,{margin:{top:10,right:20,left:0,bottom:10},children:[a.jsx(My,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),a.jsx(By,{type:"number",dataKey:"x",name:"CIA1",domain:[0,100],tick:{fontSize:11,fill:"#94a3b8"},label:{value:"CIA 1",position:"insideBottom",offset:-6,fontSize:11,fill:"#475569"}}),a.jsx(Iy,{type:"number",dataKey:"y",name:"CIA2",domain:[0,100],tick:{fontSize:11,fill:"#94a3b8"},label:{value:"CIA 2",angle:-90,position:"insideLeft",fontSize:11,fill:"#475569"}}),a.jsx(fK,{range:[40,40]}),a.jsx(Oy,{cursor:{strokeDasharray:"3 3"},contentStyle:{borderRadius:10,fontSize:12},content:({payload:r})=>{var n,i,s,o,l,c;return r!=null&&r.length?a.jsxs("div",{style:{background:"#fff",padding:"6px 10px",borderRadius:8,fontSize:12,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[a.jsx("div",{children:a.jsx("b",{children:(i=(n=r[0])==null?void 0:n.payload)==null?void 0:i.id})}),a.jsxs("div",{children:["CIA1: ",(o=(s=r[0])==null?void 0:s.payload)==null?void 0:o.x,"  CIA2: ",(c=(l=r[0])==null?void 0:l.payload)==null?void 0:c.y]})]}):null}}),a.jsx(eN,{x:dN,stroke:"#ef4444",strokeDasharray:"5 3",label:{value:"Fail",fill:"#ef4444",fontSize:10}}),a.jsx(eN,{y:dN,stroke:"#ef4444",strokeDasharray:"5 3"}),a.jsx(uK,{data:t,fill:"#0b74b8",opacity:.75})]})})}function yPe({subjectId:e}){const t=String(e||""),r=x.useMemo(()=>dPe(t),[t]);return a.jsxs("div",{style:{padding:"4px 0"},children:[a.jsx(fPe,{students:r}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(320px, 1fr))",gap:16},children:[a.jsx(nx,{title:"Trend Over Time",subtitle:"Class avg per assessment",children:a.jsx(hPe,{students:r})}),a.jsx(nx,{title:"Grade Distribution",subtitle:"Pass rate (fail < 58)",children:a.jsx(pPe,{students:r})}),a.jsx(nx,{title:"Top vs Bottom Performers",subtitle:"Avg marks (last 5 digits of ID)",children:a.jsx(mPe,{students:r})}),a.jsx(nx,{title:"CIA1 vs CIA2 Scatter",subtitle:"Each dot = one student",children:a.jsx(xPe,{students:r})}),a.jsx(nx,{title:"Per-Student Assessment Comparison",subtitle:"First 25 students  CIA1 / CIA2 / Model",children:a.jsx(gPe,{students:r})})]})]})}const bPe=["ssa1","formative1","ssa2","formative2","cia1","cia2"];function vPe({teachingAssignmentId:e,onSaved:t,onClose:r}){var E;const[n,i]=x.useState(!1),[s,o]=x.useState(!1),[l,c]=x.useState(new Set),[u,d]=x.useState(null),[f,h]=x.useState(!1),[p,m]=x.useState(null),g=x.useRef(null);x.useEffect(()=>{let P=!0;if(e)return(async()=>{i(!0);try{const U=await hm(Number(e));if(!P)return;c(new Set((U==null?void 0:U.enabled_assessments)||[])),d((U==null?void 0:U.meta)||null),m(null)}catch(U){m((U==null?void 0:U.message)||"Failed to load")}finally{P&&i(!1)}})(),()=>{P=!1}},[e]),x.useEffect(()=>{var G;if(!e||(u==null?void 0:u.mode)!=="SPECIAL_GLOBAL"||((G=u==null?void 0:u.edit_request)==null?void 0:G.status)!=="PENDING")return;let P=!1;const U=window.setInterval(async()=>{try{const H=await hm(Number(e));if(P)return;c(new Set((H==null?void 0:H.enabled_assessments)||[])),d((H==null?void 0:H.meta)||null)}catch{}},4e3);return()=>{P=!0,window.clearInterval(U)}},[e,u==null?void 0:u.mode,(E=u==null?void 0:u.edit_request)==null?void 0:E.status]);const y=!!(u!=null&&u.locked),b=(u==null?void 0:u.can_edit)!==!1,v=y&&!b,w=(u==null?void 0:u.edit_request)||null,j=String((w==null?void 0:w.status)||"").toUpperCase()==="PENDING";x.useEffect(()=>{if((u==null?void 0:u.mode)!=="SPECIAL_GLOBAL")return;const P=g.current;g.current=b,P===!1&&b===!0&&alert("IQAC approval granted. You can now edit and re-save the enabled exams.")},[b,u==null?void 0:u.mode]);const k=P=>{v||c(U=>{const G=new Set(U);return G.has(P)?G.delete(P):G.add(P),G})},A=async()=>{if(e){o(!0);try{const P=Array.from(l.values()),U=await d9(Number(e),P),G=(U==null?void 0:U.enabled_assessments)||[];c(new Set(G)),d((U==null?void 0:U.meta)||u),m(null),t&&t(G),alert("Saved enabled assessments.")}catch(P){m((P==null?void 0:P.message)||"Save failed"),alert("Save failed: "+((P==null?void 0:P.message)||""))}finally{o(!1)}}},R=async P=>{if(e){h(!0);try{const U=await f9(Number(e));d(G=>({...G||{},locked:!0,can_edit:!1,edit_request:U||{status:"PENDING"}})),alert(P?"Request is already pending. Synced status with server.":"Edit request sent to IQAC for approval.")}catch(U){m((U==null?void 0:U.message)||"Failed to request edit"),alert("Edit request failed: "+((U==null?void 0:U.message)||""))}finally{h(!1)}}},M=async()=>{await R(j),await B()},B=async()=>{if(e)try{i(!0);const P=await hm(Number(e));c(new Set((P==null?void 0:P.enabled_assessments)||[])),d((P==null?void 0:P.meta)||null),m(null)}catch(P){m((P==null?void 0:P.message)||"Failed to refresh")}finally{i(!1)}};return a.jsxs("div",{style:{border:"1px solid #e5e7eb",padding:12,borderRadius:8,background:"#ffffff",maxWidth:520},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[a.jsx("div",{style:{fontWeight:700},children:"Select Exams for this Assignment"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:(u==null?void 0:u.mode)==="SPECIAL_GLOBAL"?"Special course (global lock)":"Faculty override"})]}),(u==null?void 0:u.mode)==="SPECIAL_GLOBAL"&&y&&a.jsxs("div",{style:{fontSize:12,color:v?"#92400e":"#065f46",marginBottom:8},children:[v?"Locked after first save. Edit requires IQAC approval.":"Editing permitted (approved by IQAC/admin).",w!=null&&w.status?a.jsxs("span",{style:{marginLeft:8,color:"#6b7280"},children:["Request: ",String(w.status)]}):null]}),n?a.jsx("div",{style:{color:"#6b7280"},children:"Loading"}):a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, minmax(0,1fr))",gap:8},children:bPe.map(P=>a.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[a.jsx("input",{type:"checkbox",checked:l.has(P),onChange:()=>k(P),disabled:v||s}),a.jsx("span",{style:{textTransform:"uppercase",fontSize:13},children:P.toUpperCase()})]},P))}),p&&a.jsx("div",{style:{color:"#b91c1c",marginTop:8},children:p}),a.jsxs("div",{style:{display:"flex",gap:8,marginTop:12},children:[!v&&a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:A,disabled:s||n||!e,children:s?"Saving":"Save"}),v&&(u==null?void 0:u.mode)==="SPECIAL_GLOBAL"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn",onClick:M,disabled:f||s||n||!e,title:j?"Request already pending. Wait for IQAC approval.":void 0,children:f?"Requesting":j?"Edit Request Pending":"Edit (Request IQAC Approval)"}),a.jsx("button",{className:"obe-btn",onClick:B,disabled:s||n||!e,children:"Refresh"})]}),a.jsx("button",{className:"obe-btn",onClick:()=>r&&r(),disabled:s,children:"Close"})]})]})}function wPe({teachingAssignmentId:e,subjectId:t,onApplied:r}){var f,h,p;const[n,i]=x.useState([]),[s,o]=x.useState(!1),l=x.useMemo(()=>[...new Set(n.map(m=>String(m.assessment||"").trim().toLowerCase()).filter(Boolean))],[n]);x.useEffect(()=>{let m=!0;return(async()=>{try{const g=await c9(e);if(!m)return;const y=g.filter(b=>b.teaching_assignment_id===e);if(i(y),y.length===0){o(!0);return}try{for(const b of y)L2(String(t),String(b.assessment))}catch{}try{r&&r()}catch{}}catch(g){console.error("Failed to fetch reset notifications:",g),m&&o(!0)}})(),()=>{m=!1}},[e]);const c=async()=>{if(n.length!==0)try{const m=n.map(g=>g.id);await u9(m);try{for(const g of l)L2(String(t),String(g))}catch{}o(!0);try{r&&r()}catch{}}catch(m){console.error("Failed to dismiss notifications:",m),o(!0)}};if(s||n.length===0)return null;const u={ssa1:"SSA1",review1:"Review 1",ssa2:"SSA2",review2:"Review 2",cia1:"CIA1",cia2:"CIA2",formative1:"Formative 1",formative2:"Formative 2",model:"Model Exam"},d=l.map(m=>u[m]||m).join(", ");return a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},onClick:c,children:a.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:24,maxWidth:500,boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},onClick:m=>m.stopPropagation(),children:[a.jsx("h3",{style:{margin:0,marginBottom:12,color:"#dc2626",fontSize:18,fontWeight:800},children:" Course Reset by IQAC"}),a.jsx("p",{style:{margin:0,marginBottom:16,color:"#374151",lineHeight:1.6},children:"The following assessment(s) have been reset by the IQAC administrator:"}),a.jsxs("div",{style:{background:"#fef2f2",border:"1px solid #fecaca",borderRadius:8,padding:12,marginBottom:16},children:[a.jsxs("div",{style:{fontWeight:700,color:"#991b1b",marginBottom:6},children:[(f=n[0])==null?void 0:f.subject_code,"  ",(h=n[0])==null?void 0:h.subject_name]}),a.jsxs("div",{style:{fontSize:14,color:"#7f1d1d"},children:["Section: ",((p=n[0])==null?void 0:p.section_name)||""]}),a.jsxs("div",{style:{fontSize:14,color:"#7f1d1d",marginTop:4},children:["Assessments: ",d]})]}),a.jsx("p",{style:{margin:0,marginBottom:16,color:"#6b7280",fontSize:14},children:"All previously entered data for these assessment(s) has been cleared. You will need to re-enter the marks."}),a.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:c,style:{minWidth:80},children:"OK"})})]})})}function SPe(e){return String(e).startsWith("cqi_")?null:e==="ssa1"?"ssa1":e==="review1"?"review1":e==="ssa2"?"ssa2":e==="review2"?"review2":e==="formative1"?"formative1":e==="formative2"?"formative2":e==="cia1"?"cia1":e==="cia2"?"cia2":e==="model"?"model":null}const ix=[{key:"dashboard",label:"Dashboard"},{key:"ssa1",label:"SSA1"},{key:"formative1",label:"Formative 1"},{key:"cia1",label:"CIA 1"},{key:"ssa2",label:"SSA2"},{key:"formative2",label:"Formative 2"},{key:"cia2",label:"CIA 2"},{key:"model",label:"MODEL"}];function _Pe(e){const t=String(e||"").trim().toLowerCase();return t==="cia1_co1_co2"?{showAfter:"cia1",assessmentType:"cia1",cos:["CO1","CO2"]}:t==="cia2_co3_co4"?{showAfter:"cia2",assessmentType:"cia2",cos:["CO3","CO4"]}:t==="model_co1_co2_co3_co4_co5"?{showAfter:"model",assessmentType:"model",cos:["CO1","CO2","CO3","CO4","CO5"]}:t==="model_co3_co4_co5"?{showAfter:"model",assessmentType:"model",cos:["CO3","CO4","CO5"]}:t==="model_co5"?{showAfter:"model",assessmentType:"model",cos:["CO5"]}:null}function jPe(e){const t=Array.isArray(e)?e:[];return new Set(t.map(r=>String(r||"").trim().toLowerCase()).filter(Boolean))}function kPe(e,t){const r=ni(e),n=jPe(t);if(r==="SPECIAL"){const i=new Set(["dashboard"]);return["ssa1","ssa2","formative1","formative2","cia1","cia2"].forEach(s=>{n.has(s)&&i.add(s)}),ix.filter(s=>i.has(s.key))}return r==="PRACTICAL"?ix.filter(i=>["dashboard","cia1","cia2","model"].includes(i.key)).map(i=>i.key==="cia1"?{...i,label:"CIA 1 Review"}:i.key==="cia2"?{...i,label:"CIA 2 Review"}:i.key==="model"?{...i,label:"MODEL Review"}:i):r==="PROJECT"?[{key:"dashboard",label:"Dashboard"},{key:"review1",label:"Review 1"},{key:"review2",label:"Review 2"},{key:"model",label:"MODEL Review"}]:r==="TCPR"?[{key:"dashboard",label:"Dashboard"},{key:"ssa1",label:"SSA1"},{key:"review1",label:"Review 1"},{key:"cia1",label:"CIA 1"},{key:"ssa2",label:"SSA2"},{key:"review2",label:"Review 2"},{key:"cia2",label:"CIA 2"},{key:"model",label:"MODEL"}]:r==="TCPL"?ix.map(i=>i.key==="formative1"?{...i,label:"LAB 1"}:i.key==="formative2"?{...i,label:"LAB 2"}:i):r==="LAB"?ix.filter(i=>["dashboard","cia1","cia2","model"].includes(i.key)).map(i=>i.key==="cia1"?{...i,label:"CIA 1 LAB"}:i.key==="cia2"?{...i,label:"CIA 2 LAB"}:i.key==="model"?{...i,label:"MODEL LAB"}:i):ix}function EK(e,t){return`marks_${e}_${t}`}function APe(e,t){const r=`studentId,mark
`,n=t.map(l=>`${String(l.studentId||"").replace(/\n/g," ")},${Number(l.mark||0)}`).join(`
`),i=new Blob([r+n],{type:"text/csv"}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function NPe({active:e,label:t,onClick:r}){return a.jsx("button",{onClick:r,className:`obe-sidebar-btn ${e?"active":""}`,children:t})}function CPe({active:e,label:t,onClick:r,isCqi:n,uniqueId:i}){return a.jsx("button",{onClick:r,className:`obe-sidebar-btn ${e?"active":""} ${n?"cqi-floating-btn":""}`,...i?{"data-cqi-id":i}:{},children:t})}function EPe({subjectId:e,tab:t}){const r=x.useMemo(()=>EK(e,t),[e,t]),[n,i]=x.useState([]);x.useEffect(()=>{const d=Zn(r)||[];i(Array.isArray(d)?d:[])},[r]);const s=()=>i(d=>[...d,{studentId:"",mark:0}]),o=(d,f,h)=>{i(p=>{const m=[...p],g=m[d]||{studentId:"",mark:0};return m[d]={...g,[f]:h},m})},l=d=>{i(f=>f.filter((h,p)=>p!==d))},c=()=>{Kn(r,n),alert("Marks saved locally.")},u=()=>{APe(`${e}_${t}_marks.csv`,n)};return a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",gap:8,marginBottom:10,flexWrap:"wrap"},children:[a.jsx("button",{onClick:s,className:"obe-btn obe-btn-primary",children:"Add Row"}),a.jsx("button",{onClick:c,className:"obe-btn obe-btn-success",children:"Save Local"}),a.jsx("button",{onClick:u,className:"obe-btn obe-btn-secondary",disabled:!n.length,title:n.length?"Export as CSV":"Add at least one row to export",children:"Export CSV"})]}),n.length===0?a.jsx("div",{style:{color:"#6b7280",fontSize:14,padding:"12px 0"},children:"No rows yet. Click Add Row to start."}):a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:n.map((d,f)=>a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 120px 90px",gap:8,alignItems:"center"},children:[a.jsx("input",{value:d.studentId,onChange:h=>o(f,"studentId",h.target.value),placeholder:"Student ID",className:"obe-input"}),a.jsx("input",{type:"number",value:d.mark,onChange:h=>o(f,"mark",Number(h.target.value)),className:"obe-input"}),a.jsx("button",{onClick:()=>l(f),className:"obe-btn obe-btn-danger",children:"Remove"})]},f))}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Saved key: ",a.jsx("span",{style:{fontFamily:"monospace"},children:r})]})]})}function C6({subjectId:e,classType:t,questionPaperType:r,enabledAssessments:n,teachingAssignmentsOverride:i,fixedTeachingAssignmentId:s,iqacResetEnabled:o,viewerMode:l}){var ne,re;const[c,u]=x.useState("dashboard"),d=sn.useCallback(T=>{if(T!==c){try{window.dispatchEvent(new CustomEvent("obe:before-tab-switch",{detail:{from:c,to:T}}))}catch{}u(T),e&&Kn(`markEntry_activeTab_${e}`,T)}},[c,e]),[f,h]=x.useState([]),[p,m]=x.useState(null),[g,y]=x.useState(null),[b,v]=x.useState(void 0),[w,S]=x.useState(!1),[j,k]=x.useState(!1),[A,R]=x.useState(0),[M,B]=x.useState(null),E=x.useMemo(()=>SPe(c),[c]),[P,U]=x.useState({loading:!1,enabled:!0,open:!0,error:null});x.useEffect(()=>{let T=!0;return(async()=>{if(!E){if(!T)return;U({loading:!1,enabled:!0,open:!0,error:null});return}if(T){U({loading:!0,enabled:!0,open:!0,error:null});try{const I=await _3(E,String(e||""),g??void 0);if(!T)return;const ie=(I==null?void 0:I.assessment_enabled)??!0,D=(I==null?void 0:I.assessment_open)??!0;U({loading:!1,enabled:!!ie,open:!!D,error:null})}catch(I){if(!T)return;U({loading:!1,enabled:!0,open:!0,error:(I==null?void 0:I.message)||"Failed to check exam availability"})}}})(),()=>{T=!1}},[E,e,g]);const G=E?!!P.enabled:!0,H=!!l||(E?!P.open:!1),oe=x.useMemo(()=>g==null?null:(f||[]).find(T=>T.id===g)||null,[f,g]),[de,W]=x.useState(null),[V,ae]=x.useState(null);x.useEffect(()=>{let T=!0;return(async()=>{if(W(null),ae(null),g==null)return;const I=oe||null,ie=String((I==null?void 0:I.class_type)||"").trim(),D=!!String((I==null?void 0:I.academic_year)||"").trim(),Z=typeof(I==null?void 0:I.semester)<"u"&&(I==null?void 0:I.semester)!=null,me=!!(I!=null&&I.department||I!=null&&I.department_name),Te=!!String((I==null?void 0:I.section_name)||"").trim();if(ie&&D&&Z&&me&&Te){W(ie);return}const je=String(t||"").trim();try{const Le=await pc(Number(g));if(!T)return;const _e=(Le==null?void 0:Le.teaching_assignment)||{},He=String((_e==null?void 0:_e.class_type)||"").trim();W(He||ie||je||null),ae({academic_year:(_e==null?void 0:_e.academic_year)||(_e==null?void 0:_e.academic_year_name)||(_e==null?void 0:_e.year)||null,semester:typeof(_e==null?void 0:_e.semester)<"u"?_e==null?void 0:_e.semester:null,department:(_e==null?void 0:_e.department)||(_e==null?void 0:_e.department_name)||null,section_name:(_e==null?void 0:_e.section_name)||(_e==null?void 0:_e.section)||null})}catch{if(!T)return;W(ie||je||null),ae(null)}})(),()=>{T=!1}},[g,oe,t]);const ee=x.useMemo(()=>{const T=String((oe==null?void 0:oe.class_type)||"").trim();if(T)return T;const I=String(de||"").trim();return I||String(t||"").trim()||null},[oe,de,t]),C=x.useMemo(()=>{const T=ni(ee),I=T.replace(/[^A-Z0-9]/g,"");return I.includes("TCPR")?"TCPR":I.includes("TCPL")?"TCPL":String(r||"").trim().toUpperCase()==="QP2"&&!T?"TCPR":ee},[ee,r]),Y=x.useMemo(()=>ni(C),[C]);x.useEffect(()=>{let T=!0;return(async()=>{try{const I=await wS();if(!T)return;const D=(Array.isArray(I==null?void 0:I.options)?I.options:[]).map(Z=>typeof Z=="string"?String(Z||""):Z&&typeof Z=="object"&&Z.id?String(Z.id||""):"").map(Z=>Z.trim()).filter(Boolean);B({options:D,divider:Number.isFinite(Number(I==null?void 0:I.divider))?Number(I.divider):2,multiplier:Number.isFinite(Number(I==null?void 0:I.multiplier))?Number(I.multiplier):.15})}catch{if(!T)return;B(null)}})(),()=>{T=!1}},[]);const q=x.useMemo(()=>Y==="SPECIAL",[Y]),O=b===void 0?n:b,X=x.useMemo(()=>kPe(C,O),[C,n,b]),F=x.useMemo(()=>(Array.isArray(M==null?void 0:M.options)?M.options:[]).map(I=>_Pe(I)).filter(I=>!!I),[M]),Q=x.useMemo(()=>{const T=[...X];return F.length&&F.forEach((I,ie)=>{var Te,je,Le;const D=`CQI (${I.assessmentType.toUpperCase()} ${I.cos.join(", ")})`,Z={key:`cqi_${ie}`,label:D,cqi:I},me=T.findIndex(_e=>_e.key===I.showAfter);if(me>=0){let _e=me+1;for(;_e<T.length&&String(((Te=T[_e])==null?void 0:Te.key)||"").startsWith("cqi_")&&((Le=(je=T[_e])==null?void 0:je.cqi)==null?void 0:Le.showAfter)===I.showAfter;)_e+=1;T.splice(_e,0,Z)}else T.push(Z)}),T},[X,F]);x.useEffect(()=>{if(!e)return;const T=Zn(`markEntry_activeTab_${e}`);T&&Q.some(I=>I.key===T)&&u(T)},[e]),x.useEffect(()=>{Q.some(T=>T.key===c)||u("dashboard")},[Q,c]),x.useEffect(()=>{var ie;if(!e||!i)return;const T=(i||[]).filter(D=>String(D.subject_code)===String(e));h(T),m(null);const I=typeof s=="number"&&T.some(D=>D.id===s)&&s||(((ie=T[0])==null?void 0:ie.id)??null);y(I)},[e,i,s]),x.useEffect(()=>{let T=!0;if(!(i&&Array.isArray(i)))return(async()=>{var I;try{const ie=await hc();if(!T)return;let D=(ie||[]).filter(Te=>Te.subject_code===e);if(D.length===0)try{const Te=await mr(`/api/academics/teaching-assignments/?subject_code=${encodeURIComponent(String(e||""))}`);if(Te.ok){const je=await Te.json();D=(Array.isArray(je.results)?je.results:Array.isArray(je)?je:je.items||[])||[]}}catch(Te){console.warn("Server TA list fetch failed:",Te)}h(D),m(null);const Z=Zn(`markEntry_selectedTa_${e}`),me=typeof s=="number"&&D.some(Te=>Te.id===s)&&s||typeof Z=="number"&&D.some(Te=>Te.id===Z)&&Z||(((I=D[0])==null?void 0:I.id)??null);y(me)}catch(ie){if(!T)return;h([]),y(null),m((ie==null?void 0:ie.message)||"Failed to load teaching assignments")}})(),()=>{T=!1}},[e,i,s]),x.useEffect(()=>{e&&g!=null&&typeof s!="number"&&Kn(`markEntry_selectedTa_${e}`,g)},[e,g,s]),x.useEffect(()=>{let T=!0;if(e){if(g==null){v(void 0);return}if(!q){v(void 0);return}return(async()=>{try{const I=await hm(Number(g)),ie=I==null?void 0:I.enabled_assessments;if(!T)return;v(Array.isArray(ie)&&ie.length?ie:null)}catch(I){if(!T)return;v(void 0),m((I==null?void 0:I.message)||"Failed to load faculty enabled assessments")}})(),()=>{T=!1}}},[e,g,q]),x.useEffect(()=>{e&&Kn(`markEntry_activeTab_${e}`,c)},[e,c]);const K=x.useMemo(()=>{if(!e)return{};const T={};for(const I of Q){if(I.key==="dashboard"||String(I.key).startsWith("cqi_"))continue;if(I.key==="ssa1"){const D=Zn(`ssa1_sheet_${e}`),Z=D==null?void 0:D.rows;T[I.key]=Array.isArray(Z)?Z.length:0;continue}if(I.key==="review1"){const D=Zn(`review1_sheet_${e}`),Z=D==null?void 0:D.rows;T[I.key]=Array.isArray(Z)?Z.length:0;continue}if(I.key==="ssa2"){const D=Zn(`ssa2_sheet_${e}`),Z=D==null?void 0:D.rows;T[I.key]=Array.isArray(Z)?Z.length:0;continue}if(I.key==="review2"){const D=Zn(`review2_sheet_${e}`),Z=D==null?void 0:D.rows;T[I.key]=Array.isArray(Z)?Z.length:0;continue}if(I.key==="formative1"){const D=Zn(`formative1_sheet_${e}`),Z=D==null?void 0:D.rowsByStudentId;T[I.key]=Z&&typeof Z=="object"?Object.keys(Z).length:0;continue}if(I.key==="formative2"){const D=Zn(`formative2_sheet_${e}`),Z=D==null?void 0:D.rowsByStudentId;T[I.key]=Z&&typeof Z=="object"?Object.keys(Z).length:0;continue}if(I.key==="cia1"){const D=Zn(`cia1_sheet_${e}`),Z=D==null?void 0:D.rowsByStudentId;T[I.key]=Z&&typeof Z=="object"?Object.keys(Z).length:0;continue}if(I.key==="cia2"){const D=Zn(`cia2_sheet_${e}`),Z=D==null?void 0:D.rowsByStudentId;T[I.key]=Z&&typeof Z=="object"?Object.keys(Z).length:0;continue}if(I.key==="model"){const D=Zn(`model_sheet_${e}`),Z=D==null?void 0:D.rowsByStudentId;T[I.key]=Z&&typeof Z=="object"?Object.keys(Z).length:0;continue}const ie=Zn(EK(e,I.key))||[];T[I.key]=Array.isArray(ie)?ie.length:0}return T},[e,c,Q,A]);return a.jsxs("div",{children:[g!=null&&a.jsx(wPe,{teachingAssignmentId:g,subjectId:String(e),onApplied:()=>R(T=>T+1)}),a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-end",flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{style:{minWidth:260},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Teaching Assignment (Section)"}),f.length===0?a.jsx("div",{className:"obe-input",children:"No teaching assignments"}):a.jsxs("div",{style:{padding:"8px 10px",borderRadius:6,background:"#fff",border:"1px solid #e5e7eb"},children:[a.jsx("div",{style:{fontSize:14,fontWeight:600},children:((ne=oe||f[0])==null?void 0:ne.section_name)||(V==null?void 0:V.section_name)||""}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:(()=>{var Te,je,Le,_e,He,We,Pt,dt;const T=oe||f[0]||{},I=T.academic_year||(V==null?void 0:V.academic_year)||T.academic_year_name||T.year||"",ie=typeof T.semester<"u"&&T.semester!=null?T.semester:typeof(V==null?void 0:V.semester)<"u"?V==null?void 0:V.semester:(Te=f[0])==null?void 0:Te.semester,D=T.department||((je=T.section_details)==null?void 0:je.department)||((He=(_e=(Le=T.section_details)==null?void 0:Le.batch)==null?void 0:_e.course)==null?void 0:He.department)||(V==null?void 0:V.department)||(T.department_name?{name:T.department_name}:null)||((We=f[0])==null?void 0:We.department)||((dt=(Pt=f[0])==null?void 0:Pt.section_details)==null?void 0:dt.department),Z=(D==null?void 0:D.short_name)||(D==null?void 0:D.code)||(D==null?void 0:D.name)||T.department_name||"",me=[];return me.push(I||""),typeof ie<"u"&&ie!=null&&me.push(`Sem ${ie}`),Z&&me.push(Z),me.filter(Boolean).join("  ")})()})]}),p&&a.jsx("div",{style:{marginTop:6,fontSize:12,color:"#b91c1c"},children:p})]}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:"Student rows load from the selected section roster."}),a.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:q&&g?a.jsx("button",{className:"obe-btn",onClick:()=>S(T=>!T),children:"Show exams"}):null})]}),q&&w&&g?a.jsx("div",{style:{marginBottom:12},children:a.jsx(vPe,{teachingAssignmentId:g??void 0,onSaved:T=>{v(Array.isArray(T)&&T.length?T:null),S(!1)},onClose:()=>S(!1)})}):null,o&&E&&g!=null?a.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:10},children:a.jsx("button",{className:"obe-btn obe-btn-danger",disabled:j,onClick:async()=>{const T=E;if(window.confirm(`Reset ${T.toUpperCase()} for this section? This clears draft + published data for that exam.`))try{k(!0),await S3(T,String(e),Number(g)),L2(String(e),String(T)),R(ie=>ie+1),alert("Reset completed.")}catch(ie){alert((ie==null?void 0:ie.message)||"Reset failed")}finally{k(!1)}},children:j?"Resetting":"Reset This Exam"})}):null,a.jsxs("div",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #e0f2fe 100%)",borderRadius:12,padding:"16px",marginBottom:20,border:"1px solid #cbd5e1",boxShadow:"0 2px 8px rgba(2,6,23,0.04), inset 0 1px 0 rgba(255,255,255,0.5)"},children:[a.jsx("div",{style:{fontSize:12,fontWeight:700,color:"#64748b",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:12},children:"Assessment Exams"}),a.jsx("div",{className:"obe-sidebar-nav","aria-label":"Mark Entry sub-tabs",style:{display:"flex",flexWrap:"wrap",gap:8},children:Q.map((T,I)=>a.jsx(sn.Fragment,{children:T.cqi?a.jsx(CPe,{active:c===T.key,label:T.label,onClick:()=>d(T.key),isCqi:!0,uniqueId:String(T.key)}):a.jsx(NPe,{active:c===T.key,label:T.label,onClick:()=>d(T.key)})},T.key))})]}),c==="dashboard"&&a.jsxs("div",{children:[a.jsx("h3",{style:{margin:"0 0 6px 0"},children:"Dashboard"}),a.jsxs("div",{style:{color:"#6b7280",marginBottom:12,fontSize:14},children:["Quick overview for ",a.jsx("b",{children:e}),". Use the tabs to enter marks."]}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:12},children:Q.filter(T=>T.key!=="dashboard").map(T=>a.jsxs("div",{className:"obe-card",children:[a.jsx("div",{style:{fontWeight:700,color:"#0f172a"},children:T.label}),a.jsxs("div",{style:{marginTop:6,fontSize:13,color:"#6b7280"},children:["Rows saved: ",String(T.key).startsWith("cqi_")?"":K[T.key]??0]})]},T.key))}),a.jsx("div",{style:{marginTop:14},children:a.jsx(yPe,{subjectId:e})})]}),c!=="dashboard"&&a.jsxs("div",{children:[a.jsx("h3",{style:{margin:"0 0 6px 0"},children:(re=Q.find(T=>T.key===c))==null?void 0:re.label}),(()=>{const T=Q.find(ie=>ie.key===c)||null,I=(T==null?void 0:T.cqi)||null;return a.jsx("div",{style:{color:"#6b7280",marginBottom:12,fontSize:14},children:c==="formative1"?Y==="TCPL"?"Enter and manage LAB-1 marks (experiments + totals).":"Enter and manage Formative-1 assessment marks with BTL mapping.":c==="formative2"?Y==="TCPL"?"Enter and manage LAB-2 marks (experiments + totals).":"Enter and manage Formative-2 assessment marks with BTL mapping.":c==="ssa1"?"SSA1 sheet-style entry (CO + BTL attainment) matching the Excel layout.":c==="review1"?"Review 1 sheet-style entry (CO + BTL attainment) matching the Excel layout.":c==="ssa2"?"SSA2 sheet-style entry (CO + BTL attainment) matching the Excel layout.":c==="review2"?"Review 2 sheet-style entry (CO + BTL attainment) matching the Excel layout.":c==="cia1"?Y==="LAB"?"CIA 1 LAB entry (CO-1/CO-2 experiments + CIA exam)":Y==="PRACTICAL"?"CIA 1 Review (Practical) - enter review marks for practical content.":Y==="TCPR"?"CIA 1 Review (TCPR) - enter review marks for TCPR content.":"CIA 1 sheet-style entry (Q-wise + CO + BTL) matching the Excel layout.":c==="cia2"?Y==="LAB"?"CIA 2 LAB entry (CO-3/CO-4/CO-5 experiments + CIA exam).":Y==="PRACTICAL"?"CIA 2 Review (Practical) - enter review marks for practical content.":Y==="TCPR"?"CIA 2 Review (TCPR) - enter review marks for TCPR content.":"CIA 2 sheet-style entry (Q-wise + CO + BTL) matching the Excel layout.":c==="model"?Y==="LAB"?"MODEL LAB entry (CO-5 experiments + CIA exam).":Y==="PRACTICAL"?"MODEL Review (Practical) - enter review marks for practical content.":Y==="TCPR"?"MODEL Review (TCPR) - enter review marks for TCPR content.":"MODEL blank table template (same layout style as CIA sheets).":String(c).startsWith("cqi_")?`CQI view for ${((I==null?void 0:I.assessmentType)||"assessment").toUpperCase()} (${((I==null?void 0:I.cos)||[]).join(", ")})`:"Enter and save marks locally for this assessment."})})(),P.loading&&E?a.jsx("div",{style:{padding:"10px 0",color:"#6b7280",fontSize:13},children:"Checking availability"}):!G&&E?a.jsx("div",{style:{background:"#fff7ed",border:"1px solid #fdba7433",color:"#9a3412",padding:12,borderRadius:12,fontWeight:800},children:"This exam is disabled by IQAC. Please contact IQAC to enable it."}):a.jsx("fieldset",{disabled:!!H,style:{border:0,padding:0,margin:0},children:(()=>{const T=Q.find(ie=>ie.key===c)||null,I=(T==null?void 0:T.cqi)||null;return c==="formative1"?Y==="TCPL"?a.jsx(Z2,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"formative1",label:"LAB 1",coA:1,coB:2}):a.jsx(Gz,{subjectId:e,teachingAssignmentId:g??void 0}):c==="formative2"?Y==="TCPL"?a.jsx(Z2,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"formative2",label:"LAB 2",coA:2,coB:3}):a.jsx(kxe,{subjectId:e,teachingAssignmentId:g??void 0}):c==="ssa1"?a.jsx(Hxe,{subjectId:e,teachingAssignmentId:g??void 0}):c==="review1"?Y==="TCPR"?a.jsx(Kz,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"review1",label:"Review 1"}):a.jsx(Ixe,{subjectId:e,teachingAssignmentId:g??void 0}):c==="ssa2"?a.jsx(Xxe,{subjectId:e,teachingAssignmentId:g??void 0}):c==="review2"?Y==="TCPR"?a.jsx(Yz,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"review2",label:"Review 2"}):a.jsx(Dxe,{subjectId:e,teachingAssignmentId:g??void 0}):c==="cia1"?Y==="LAB"?a.jsx(Dx,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"cia1",label:"CIA 1 LAB",coA:1,coB:2,initialEnabledCos:[1,2],viewerMode:!!H}):Y==="PROJECT"?a.jsx($j,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"cia1",viewerMode:!!H,classType:ee??null}):Y==="PRACTICAL"?a.jsx(Dj,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"cia1",viewerMode:!!H}):a.jsx(Vz,{subjectId:e,teachingAssignmentId:g??void 0,classType:ee??null,questionPaperType:r??null}):c==="cia2"?Y==="LAB"?a.jsx(Dx,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"cia2",label:"CIA 2 LAB",coA:3,coB:4,initialEnabledCos:[3,4,5],viewerMode:!!H}):Y==="PROJECT"?a.jsx($j,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"cia2",viewerMode:!!H,classType:ee??null}):Y==="PRACTICAL"?a.jsx(Dj,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"cia2",viewerMode:!!H}):a.jsx(yxe,{subjectId:e,teachingAssignmentId:g??void 0,classType:ee??null,questionPaperType:r??null}):c==="model"?Y==="LAB"?a.jsx(Dx,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"model",label:"MODEL LAB",coA:5,coB:null,initialEnabledCos:[5],viewerMode:!!H}):Y==="PROJECT"?a.jsx($j,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"model",viewerMode:!!H,classType:ee??null}):Y==="PRACTICAL"?a.jsx(Dj,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"model",viewerMode:!!H}):a.jsx(Bxe,{subjectId:e,teachingAssignmentId:g??void 0,classType:ee??null,questionPaperType:r??null}):String(c).startsWith("cqi_")?a.jsx(r1e,{subjectId:e,teachingAssignmentId:g??void 0,classType:ee??null,enabledAssessments:O??null,assessmentType:(I==null?void 0:I.assessmentType)||"model",cos:(I==null?void 0:I.cos)||["CO1","CO2","CO3","CO4","CO5"],cqiDivider:Number(M==null?void 0:M.divider)||2,cqiMultiplier:Number(M==null?void 0:M.multiplier)||.15}):a.jsx(EPe,{subjectId:e,tab:c})})()})]},`${c}_${A}`)]})}function TPe(){var m,g,y,b;const{courseCode:e,taId:t}=z0(),r=x.useMemo(()=>decodeURIComponent(String(e||"")).trim(),[e]),n=x.useMemo(()=>t?Number(t):NaN,[t]),[i,s]=x.useState(null),[o,l]=x.useState(null),[c,u]=x.useState(null),[d,f]=x.useState(null);x.useEffect(()=>{let v=!0;return(async()=>{if(r)try{const[w,S]=await Promise.all([Sl(),Yd()]);if(!v)return;const k=(w||[]).filter(A=>String((A==null?void 0:A.course_code)||"").trim().toUpperCase()===r.toUpperCase())[0];if(k)if(l(k!=null&&k.class_type?String(k.class_type):null),u(k!=null&&k.question_paper_type?String(k.question_paper_type):null),String((k==null?void 0:k.class_type)||"").trim().toUpperCase()==="SPECIAL"){f([]);try{const R=await vS(r);f(Array.isArray(R)?R:[])}catch{const R=k==null?void 0:k.enabled_assessments;f(Array.isArray(R)?R.map(M=>String(M).trim().toLowerCase()).filter(Boolean):[])}}else f(null);else{const A=(S||[]).find(R=>String((R==null?void 0:R.course_code)||"").trim().toUpperCase()===r.toUpperCase());l(A!=null&&A.class_type?String(A.class_type):null),u(null),f(null)}}catch{}})(),()=>{v=!1}},[r]),x.useEffect(()=>{let v=!0;return(async()=>{if(!(!r||!Number.isFinite(n)))try{const w=await M2(r);if(!v)return;const S=(w||[]).find(j=>Number(j.teaching_assignment_id)===Number(n))||null;s(S)}catch{if(!v)return;s(null)}})(),()=>{v=!1}},[r,n]);const h=x.useMemo(()=>Number.isFinite(n)?[{id:n,subject_id:0,subject_code:r,subject_name:(i==null?void 0:i.course_name)||r,section_id:(i==null?void 0:i.section_id)||0,section_name:(i==null?void 0:i.section_name)||"Section",academic_year:(i==null?void 0:i.academic_year)||""}]:[],[n,r,i]),p=ni(o);return!r||!Number.isFinite(n)?a.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[a.jsx("div",{style:{color:"#b91c1c"},children:"Invalid teaching assignment."}),a.jsx("div",{style:{marginTop:10},children:a.jsx(es,{className:"obe-btn obe-btn-secondary",to:"/iqac/academic-controller?tab=courses",children:"Back"})})]}):a.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",gap:12,flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{children:[a.jsx("h2",{style:{margin:0,fontSize:20},children:"Mark Entry Viewer"}),a.jsx("div",{style:{color:"#374151",marginTop:6,fontWeight:800},children:r}),a.jsxs("div",{style:{color:"#6b7280",marginTop:4},children:[i?`${i.section_name}  ${i.academic_year}`:"",(m=i==null?void 0:i.staff)!=null&&m.name||(g=i==null?void 0:i.staff)!=null&&g.username?`    ${((y=i.staff)==null?void 0:y.name)||((b=i.staff)==null?void 0:b.username)}`:"",p?`    ${p}`:""]})]}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:a.jsx(es,{className:"obe-btn obe-btn-secondary",to:`/iqac/academic-controller/course/${encodeURIComponent(r)}`,children:"Back"})})]}),a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:a.jsx(C6,{subjectId:r,classType:o,questionPaperType:c,enabledAssessments:d,teachingAssignmentsOverride:h,fixedTeachingAssignmentId:n,iqacResetEnabled:!0,viewerMode:!1})})]})}function PPe(e){return e==="-"||e===null||e===void 0||e===""?" - ":String(e)}function Op(e,t){const r=Math.pow(10,t);return Math.round((e+Number.EPSILON)*r)/r}function fN({headers:e,rows:t}){return a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:10},children:a.jsxs("table",{style:{borderCollapse:"collapse",width:"100%",minWidth:900},children:[a.jsx("thead",{children:a.jsx("tr",{children:e.map(r=>a.jsx("th",{style:{textAlign:"left",fontSize:12,color:"#111827",background:"#f9fafb",padding:"10px 10px",borderBottom:"1px solid #e5e7eb",whiteSpace:"nowrap"},children:r},r))})}),a.jsx("tbody",{children:t.map((r,n)=>a.jsx("tr",{children:r.map((i,s)=>a.jsx("td",{style:{padding:"8px 10px",borderBottom:"1px solid #f3f4f6",fontSize:12,color:"#111827",whiteSpace:s===3?"normal":"nowrap",maxWidth:s===3?360:void 0},children:PPe(i)},s))},n))})]})})}function OF({title:e,headers:t,rows:r,collapsedByDefault:n=!1,showToggle:i=!0}){const[s,o]=x.useState(!n);return a.jsxs("section",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[a.jsx("h3",{style:{margin:"6px 0 10px 0",flex:1},children:e}),i?a.jsx("button",{"aria-label":s?"Collapse table":"Expand table",onClick:()=>o(l=>!l),style:{background:"transparent",border:"none",cursor:"pointer",fontSize:18,padding:6,color:"#374151"},children:s?"":""}):null]}),s&&a.jsx(fN,{headers:t,rows:r})]})}function OPe({subjectId:e,matrix:t}){var s,o,l;if(!e)return a.jsx("div",{style:{color:"#6b7280",fontSize:13},children:"Select a course to view the Articulation Matrix."});if(!t)return a.jsxs("div",{style:{border:"1px dashed #bbb",padding:16,borderRadius:8,color:"#666"},children:["No articulation matrix loaded yet for ",a.jsx("b",{children:e}),". Upload the Excel to parse page-2."]});const r=Array.isArray(t.units)?t.units:[],n=(s=t.summaries)==null?void 0:s.co_po_summary,i=["S. No","CO Mapped","Topic No.","Topic Name",...Array.from({length:11},(c,u)=>`PO${u+1}`),...Array.from({length:3},(c,u)=>`PSO${u+1}`),"Hours"];return Array.from({length:i.length},()=>""),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[((o=t.meta)==null?void 0:o.sheet_used)&&a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["Sheet: ",a.jsx("b",{children:t.meta.sheet_used})]}),r.map(c=>{const u=(c.rows||[]).map(d=>[d.s_no,d.co_mapped,d.topic_no,d.topic_name,...d.po||[],...d.pso||[],d.hours]);return a.jsxs("section",{children:[a.jsx("h3",{style:{margin:"6px 0 10px 0"},children:c.unit}),a.jsx(fN,{headers:i,rows:u})]},c.unit)}),(()=>{const c=[],u=(f,h)=>{const p=r[f];if(!p||!Array.isArray(p.rows)||p.rows.length===0)return[h,...Array.from({length:11},()=>""),...Array.from({length:3},()=>""),""];const m=p.rows,g=m.reduce((v,w)=>{const S=Number(w.hours);return v+(Number.isFinite(S)?S:0)},0),y=[];for(let v=0;v<11;v++){const w=m.reduce((S,j)=>{const k=Number((j.po&&j.po[v])??0);return S+(Number.isFinite(k)?k:0)},0);if(g>0){const S=w/g,j=Op(S,2);y.push(j.toFixed(2))}else y.push("")}const b=[];for(let v=0;v<3;v++){const w=m.reduce((S,j)=>{const k=Number((j.pso&&j.pso[v])??0);return S+(Number.isFinite(k)?k:0)},0);if(g>0){const S=w/g,j=Op(S,2);b.push(j.toFixed(2))}else b.push("")}return[h,...y,...b,g||""]};for(let f=0;f<5;f++)c.push(u(f,`CO${f+1}`));const d=(()=>{const f=[];c.forEach(y=>{const b=y[0],w=y.slice(1,15).map(k=>{if(k===""||k===null||k===void 0)return"";const A=Number(String(k));if(!Number.isFinite(A))return"";const R=A*3,M=Op(R,2);return M===0?"":M.toFixed(2)}),S=w.map(k=>k===""?null:Number(k)).filter(k=>k!==null),j=S.length?Op(S.reduce((k,A)=>k+A,0)/S.length,2).toFixed(2):"";f.push([b,...w,j])});const p=[];for(let y=0;y<14;y++){const b=[];for(let v=0;v<f.length;v++){const w=f[v][1+y];if(w===""||w===null||w===void 0)continue;const S=Number(w);Number.isFinite(S)&&b.push(S)}b.length?p.push(Op(b.reduce((v,w)=>v+w,0)/b.length,2).toFixed(2)):p.push("")}const m=f.map(y=>y[y.length-1]).filter(y=>y!=="").map(Number),g=m.length?Op(m.reduce((y,b)=>y+b,0)/m.length,2).toFixed(2):"";return f.push(["Average",...p,g]),f})();return a.jsxs(a.Fragment,{children:[a.jsx(OF,{title:"CO  PO/PSO (Course Delivery)",headers:["COs",...Array.from({length:11},(f,h)=>`PO${h+1}`),...Array.from({length:3},(f,h)=>`PSO${h+1}`),"Course delivery"],rows:c,collapsedByDefault:!0}),a.jsx(OF,{title:"CO  PO/PSO Summary",headers:["COs",...Array.from({length:11},(f,h)=>`PO${h+1}`),...Array.from({length:3},(f,h)=>`PSO${h+1}`),"Average"],rows:d,collapsedByDefault:!1,showToggle:!1})]})})(),(l=n==null?void 0:n.rows)!=null&&l.length?a.jsxs("section",{children:[a.jsx("h3",{style:{margin:"6px 0 10px 0"},children:"CO  PO/PSO Summary"}),a.jsx(fN,{headers:["CO",...Array.from({length:11},(c,u)=>`PO${u+1}`),...Array.from({length:3},(c,u)=>`PSO${u+1}`),"Average"],rows:[...n.rows.map(c=>[c.label,...c.po,...c.pso,c.average]),...n.average?[[n.average.label,...n.average.po,...n.average.pso,n.average.average]]:[]]})]}):null]})}const Da={container:{minHeight:"100vh",background:"linear-gradient(135deg, #f5f7fa 0%, #e9ecef 100%)",padding:"2rem"},card:{maxWidth:"1400px",margin:"0 auto",background:"#ffffff",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.07), 0 1px 3px rgba(0, 0, 0, 0.06)",overflow:"hidden"},header:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"2rem 2.5rem",borderBottom:"1px solid #e5e7eb"},title:{fontSize:"1.875rem",fontWeight:"700",color:"#ffffff",margin:"0",letterSpacing:"-0.025em"},subtitle:{fontSize:"0.95rem",color:"rgba(255, 255, 255, 0.9)",marginTop:"0.5rem",fontWeight:"400"},content:{padding:"2rem 2.5rem"},inputSection:{marginBottom:"1.5rem",padding:"1.25rem",background:"#f9fafb",borderRadius:"8px",border:"1px solid #e5e7eb"},label:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem",textTransform:"uppercase",letterSpacing:"0.025em"},input:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"2px solid #e5e7eb",borderRadius:"6px",outline:"none",transition:"all 0.2s ease",fontFamily:"inherit"},inputFocus:{borderColor:"#667eea",boxShadow:"0 0 0 3px rgba(102, 126, 234, 0.1)"},actionBar:{display:"flex",gap:"1rem",alignItems:"center",flexWrap:"wrap",marginBottom:"1.5rem",padding:"1.25rem",background:"#f9fafb",borderRadius:"8px"},button:{padding:"0.75rem 1.5rem",fontSize:"0.95rem",fontWeight:"600",color:"#ffffff",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:"6px",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 2px 4px rgba(102, 126, 234, 0.3)",outline:"none"},buttonHover:{transform:"translateY(-1px)",boxShadow:"0 4px 8px rgba(102, 126, 234, 0.4)"},buttonDisabled:{background:"#9ca3af",cursor:"not-allowed",boxShadow:"none",opacity:.6},infoText:{fontSize:"0.875rem",color:"#6b7280",display:"flex",alignItems:"center",gap:"0.5rem"},infoIcon:{width:"16px",height:"16px",borderRadius:"50%",background:"#667eea",color:"#ffffff",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:"700"},alert:{padding:"1rem 1.25rem",borderRadius:"8px",fontSize:"0.925rem",marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.75rem",fontWeight:"500"},alertSuccess:{background:"#d1fae5",color:"#065f46",border:"1px solid #6ee7b7"},alertError:{background:"#fee2e2",color:"#991b1b",border:"1px solid #fca5a5"},matrixContainer:{background:"#ffffff",borderRadius:"8px",border:"1px solid #e5e7eb",padding:"1.5rem",minHeight:"200px"},loadingSpinner:{display:"inline-block",width:"14px",height:"14px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTop:"2px solid #ffffff",borderRadius:"50%",animation:"spin 0.6s linear infinite",marginRight:"0.5rem"}};function MPe({courseId:e,embedded:t=!1}){const[r,n]=x.useState(e||""),[i,s]=x.useState(null),[o,l]=x.useState("idle"),[c,u]=x.useState(null),[d,f]=x.useState(!1),[h,p]=x.useState(!1);async function m(v){if(v){try{const w=new URLSearchParams(window.location.search),S=w.get("teaching_assignment_id")||w.get("teachingAssignmentId");if(S){const j=Number(S);if(Number.isFinite(j))return j}}catch{}try{const S=(await hc()||[]).find(k=>String(k==null?void 0:k.subject_code)===String(v)),j=(S==null?void 0:S.id)!=null?Number(S.id):NaN;if(Number.isFinite(j))return j}catch{}}}x.useEffect(()=>{r&&(async()=>{l("loading"),u(null);try{const v=await m(r),w=await I4(r,v);s(w),l("success")}catch(v){s(null),l("error"),u((v==null?void 0:v.message)||"Articulation Matrix fetch failed.")}})()},[r]);async function g(){if(r){l("loading"),u(null);try{const v=await m(r),w=await I4(r,v);s(w),l("success");const S=Array.isArray(w==null?void 0:w.units)?w.units.length:0;u(`Loaded articulation matrix from saved CDAP. Units: ${S}.`)}catch(v){l("error"),u((v==null?void 0:v.message)||"Articulation Matrix fetch failed.")}}}const y=t?{padding:0}:Da.container,b=t?{...Da.card,maxWidth:"100%",margin:0,borderRadius:12,boxShadow:"none"}:Da.card;return a.jsxs("div",{style:y,children:[a.jsx("style",{children:`
        @keyframes spin {
          to { transform: rotate(360deg); }
        }
      `}),a.jsxs("div",{style:b,children:[!t&&a.jsxs("div",{style:Da.header,children:[a.jsx("h1",{style:Da.title,children:"Articulation Matrix"}),a.jsx("p",{style:Da.subtitle,children:r?`Course: ${r}`:"Select a course to view the articulation matrix"})]}),a.jsxs("div",{style:t?{padding:0}:Da.content,children:[!e&&a.jsxs("div",{style:Da.inputSection,children:[a.jsx("label",{style:Da.label,children:"Course ID"}),a.jsx("input",{value:r,onChange:v=>n(v.target.value),placeholder:"Enter course identifier (e.g., CS101)",style:{...Da.input,...d?Da.inputFocus:{}},onFocus:()=>f(!0),onBlur:()=>f(!1)})]}),a.jsxs("div",{style:Da.actionBar,children:[a.jsxs("button",{onClick:g,disabled:o==="loading"||!r,style:{...Da.button,...o==="loading"||!r?Da.buttonDisabled:{},...h&&o!=="loading"&&r?Da.buttonHover:{}},onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),children:[o==="loading"&&a.jsx("span",{style:Da.loadingSpinner}),o==="loading"?"Loading...":"Refresh Matrix"]}),a.jsxs("span",{style:Da.infoText,children:[a.jsx("span",{style:Da.infoIcon,children:"i"}),"Uses saved CDAP ticks + hours (no upload required)"]})]}),c&&a.jsxs("div",{style:{...Da.alert,...o==="error"?Da.alertError:Da.alertSuccess},children:[a.jsx("span",{style:{fontSize:"1.25rem"},children:o==="error"?"":""}),c]}),a.jsx("div",{style:Da.matrixContainer,children:a.jsx(OPe,{subjectId:r,matrix:i})})]})]})]})}const LPe="https://db.krgi.co.in",RPe=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":LPe;function FPe(){const e=window.localStorage.getItem("access");return e?{Authorization:`Bearer ${e}`}:{}}function BPe(e,t){if(e===401)return"Authentication required. Please login and try again.";if(e===403)return"Permission required to upload CDAP Excel files.";if(e===400)return"Invalid file. Please upload a valid CDAP Excel template.";if(e===404)return"Upload endpoint not found. Please contact admin.";const r=(t||"").trim();return r&&!r.startsWith("<")?r:`Upload failed with status ${e}. Please try again.`}function IPe({subjectId:e,onUpload:t}){const[r,n]=x.useState(null),[i,s]=x.useState("idle"),[o,l]=x.useState(null),[c,u]=x.useState(null);async function d(){var y,b,v;if(!r){s("error"),l("Please choose an Excel file first.");return}s("uploading"),l(null);const p=new FormData;p.append("file",r),e&&p.append("subject_id",e);const m=new AbortController,g=setTimeout(()=>m.abort(),6e4);try{const w={...FPe()},S=await fetch(`${RPe}/api/obe/upload-cdap`,{method:"POST",headers:w,body:p,signal:m.signal});if(!S.ok){const R=await S.text();s("error"),l(BPe(S.status,R));return}const j=await S.json(),k={rows:Array.isArray(j==null?void 0:j.rows)?j.rows:[],textbook:((y=j==null?void 0:j.books)==null?void 0:y.textbook)??(j==null?void 0:j.textbook)??"",reference:((b=j==null?void 0:j.books)==null?void 0:b.reference)??(j==null?void 0:j.reference)??"",activeLearningOptionsByRow:((v=j==null?void 0:j.active_learning)==null?void 0:v.optionsByRow)??(j==null?void 0:j.activeLearningOptions)??[],articulationExtras:(j==null?void 0:j.articulation_extras)??{}};u(k);const A=Array.isArray(j==null?void 0:j.rows)?j.rows.length:0;A?(s("success"),l(`Upload complete. Parsed ${A} rows from the Excel file.`)):(s("success"),l("Upload completed, but no rows were parsed. Please check the Excel template format.")),t&&t({revision:k,uploadedAt:new Date().toISOString()})}catch(w){s("error"),(w==null?void 0:w.name)==="AbortError"?l("Upload timed out. The server took too long to respond. Please try again."):l((w==null?void 0:w.message)||"Upload failed. Please try again.")}finally{clearTimeout(g),s(w=>w==="uploading"?"error":w)}}function f(p,m){for(const g of m){if(p==null)continue;if(p[g]!=null)return p[g];const y=String(g).toLowerCase();for(const b of Object.keys(p||{}))if(String(b).toLowerCase()===y)return p[b]}return""}function h(p){if(!p||!Array.isArray(p.rows)||!p.rows.length)return;const m=p.rows,g=["#","Content type","PART NO.","TOPICS TO BE COVERED (SYLLBUS TOPICS)","SUB TOPICS (WHAT TO BE TAUGHT)","BT LEVEL"],y=m.map((w,S)=>{const j=f(w,["content_type","contentType","Content type","content"]),k=f(w,["part_no","partNo","PART NO","part"]),A=f(w,["topics","topics_to_be_covered","Topics","TOPICS TO BE COVERED"]),R=f(w,["sub_topics","subTopics","Sub Topics","SUB TOPICS","sub_topics_to_be_taught"]),M=f(w,["bt_level","bt","BT LEVEL","btLevel"]);return`<tr>
        <td style="padding:6px;border:1px solid #ccc;text-align:center;">${S+1}</td>
        <td style="padding:6px;border:1px solid #ccc">${String(j??"")}</td>
        <td style="padding:6px;border:1px solid #ccc">${String(k??"")}</td>
        <td style="padding:6px;border:1px solid #ccc">${String(A??"")}</td>
        <td style="padding:6px;border:1px solid #ccc">${String(R??"")}</td>
        <td style="padding:6px;border:1px solid #ccc;text-align:center;">${String(M??"")}</td>
      </tr>`}).join(`
`),b=`<!doctype html><html><head><meta charset="utf-8"><title>CDAP Export</title>
      <style>body{font-family:Arial,Helvetica,sans-serif;font-size:12px;padding:20px}table{border-collapse:collapse;width:100%}th{background:#f3f4f6;padding:8px;border:1px solid #ddd;text-align:left}td{vertical-align:top}</style>
      </head><body>
      <h2>CDAP Export</h2>
      <p>Exported rows: ${m.length}</p>
      <table>
        <thead><tr>${g.map(w=>`<th>${w}</th>`).join("")}</tr></thead>
        <tbody>
          ${y}
        </tbody>
      </table>
      </body></html>`,v=window.open("","_blank");if(!v){alert("Popup blocked  allow popups for this site to export PDF.");return}v.document.write(b),v.document.close(),v.focus(),setTimeout(()=>{v.print()},300)}return a.jsxs("div",{children:[a.jsx("div",{style:{marginBottom:8},children:a.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:p=>{var m;return n(((m=p.target.files)==null?void 0:m[0])||null)}})}),a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[a.jsx("button",{id:"cdap-upload-button",onClick:d,disabled:i==="uploading","aria-label":"Upload CDAP Excel file",title:"Upload parsed CDAP Excel",style:{background:"#1d4ed8",color:"#fff",padding:"8px 14px",borderRadius:8,border:"none",boxShadow:"0 8px 20px rgba(29,78,216,0.24)",fontWeight:600,cursor:i==="uploading"?"default":"pointer",transition:"transform 120ms ease, box-shadow 120ms ease, opacity 120ms ease",opacity:i==="uploading"?.65:1},onMouseDown:p=>{p.currentTarget.style.transform="translateY(1px)"},onMouseUp:p=>{p.currentTarget.style.transform="translateY(0)"},children:i==="uploading"?"Uploading...":"Upload Excel"}),r&&a.jsx("span",{style:{fontSize:12,color:"#555"},children:r.name})]}),i==="success"&&c&&Array.isArray(c.rows)&&c.rows.length>0&&a.jsx("div",{style:{marginTop:10},children:a.jsx("button",{onClick:()=>h(c),style:{background:"#047857",color:"#fff",padding:"8px 14px",borderRadius:8,border:"none",fontWeight:600,cursor:"pointer"},"aria-label":"Export PDF",title:"Export CDAP to PDF (will open print dialog)",children:"Export PDF"})}),o&&a.jsx("div",{style:{marginTop:8,fontSize:12,color:i==="error"?"#b91c1c":"#166534"},children:o})]})}const MF=[{key:"unit",label:"UNIT",type:"text"},{key:"unit_name",label:"SYLLABUS (UNIT NAME)",type:"text"},{key:"co",label:"OUTCOME (WRITE THE CO)",type:"text"},{key:"content_type",label:"Content type",type:"text"},{key:"part_no",label:"PART NO.",type:"text"},{key:"topics",label:"TOPICS TO BE COVERED (SYLLBUS TOPICS)",type:"text"},{key:"sub_topics",label:"SUB TOPICS (WHAT TO BE TAUGHT)",type:"text"},{key:"bt_level",label:"BT LEVEL",type:"text"}],LF=Array.from({length:11},(e,t)=>({key:`po${t+1}`,label:`PO${t+1}`,type:"checkbox",group:"po_pso"})),RF=Array.from({length:3},(e,t)=>({key:`pso${t+1}`,label:`PSO${t+1}`,type:"checkbox",group:"po_pso"})),co=["SSA1","SSA2","ACTIVE LEARNING 1 (SKILL)","ACTIVE LEARNING 2 (SKILL)","ACTIVE LEARNING 1 (ATTITUDE)","ACTIVE LEARNING 2 (ATTITUDE)","SPECIAL ACTIVITY"],Pf=Array.from({length:11},(e,t)=>`PO${t+1}`),gv={SSA1:["Technical magazine","Journal paper reading","Real time problems","Case study"],SSA2:["Technical magazine","Journal paper reading","Real time problems","Case study"],"ACTIVE LEARNING 1 (SKILL)":["Dipstick (Writing explanation content of CO)","Dipstick (Sketch Representation)","Real time Photography or Video Explanation","Course competition"],"ACTIVE LEARNING 2 (SKILL)":["Dipstick (Writing explanation content of CO)","Dipstick (Sketch Representation)","Real time Photography or Video Explanation","Course competition"],"ACTIVE LEARNING 1 (ATTITUDE)":["Active Learing Exercies (Group Discussion)","Active Learing Exercies (Technical Question and answering Session)","Technical Role play","Interview Assessment"],"ACTIVE LEARNING 2 (ATTITUDE)":["Active Learing Exercies (Group Discussion)","Active Learing Exercies (Technical Question and answering Session)","Technical Role play","Interview Assessment"],"SPECIAL ACTIVITY":["Active Projects","Journal Preparation"]};function DPe({subjectId:e,imported:t,onLockChange:r}){const n=x.useMemo(()=>{if(e)try{const be=localStorage.getItem(`markEntry_selectedTa_${e}`),ke=be==null?NaN:Number(be);return Number.isFinite(ke)?ke:void 0}catch{return}},[e]),i=(be,ke)=>{const ce=[...ke];for(let we=0;we<be.length;we++){const ht=be[we]??[];(!ce[we]||String(ce[we]).trim()==="")&&Array.isArray(ht)&&ht.length===1&&(ce[we]=String(ht[0]??"").trim())}return ce},s=x.useRef(null),[o,l]=x.useState(!0),[c,u]=x.useState(1),[d,f]=x.useState(()=>{if(!e)return 100;try{const be=localStorage.getItem(`cdap_zoom_${e}`);return be?parseInt(be,10):100}catch{return 100}}),[h,p]=x.useState(""),[m,g]=x.useState(""),[y,b]=x.useState(()=>co.map(()=>Pf.map(()=>!1))),[v,w]=x.useState(()=>co.map(()=>"")),[S,j]=x.useState(()=>rne()),[k,A]=x.useState(()=>co.map(be=>gv[be]??[])),[R,M]=x.useState({}),[B,E]=x.useState(!1),[P,U]=x.useState(null),[G,H]=x.useState(!1),{data:oe,loading:de,error:W,refresh:V}=lc({assessment:"cdap",subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:n,options:{poll:!0}}),ae=!!G,ee=!!(oe!=null&&oe.allowed_by_approval),C=!!(ae&&!ee),[Y,q]=x.useState(!1),[O,X]=x.useState(""),[F,Q]=x.useState(!1),[K,ne]=x.useState(null);x.useEffect(()=>{if(e)try{localStorage.setItem(`cdap_active_learning_draft_${e}`,JSON.stringify({dropdowns:v,grid:y,ts:Date.now()})),window.dispatchEvent(new CustomEvent("cdap-active-learning-changed",{detail:{subjectId:e}}))}catch{}},[e,v,y]),x.useEffect(()=>{if(e)try{localStorage.setItem(`cdap_zoom_${e}`,d.toString())}catch{}},[e,d]);const re=be=>String(be??"").replace(/\s+/g," ").trim().toUpperCase().includes("#N/A"),T=be=>be.filter(ke=>!re(ke==null?void 0:ke.content_type)),I=x.useMemo(()=>[...MF,...LF,...RF],[]),ie=x.useMemo(()=>{const be={};for(const ke of I)be[ke.key]=ke.type==="checkbox"?!1:"";return be},[I]),[D,Z]=x.useState(()=>[structuredClone(ie)]),me=be=>{const ke=Fc(be);if(ke===Fc("SPECIAL ACTIVITY")){const ce=Fc("Active Projects");if(Array.isArray(S==null?void 0:S[ce])&&S[ce].length===11)return S[ce]}if(Array.isArray(S==null?void 0:S[ke])&&S[ke].length===11)return S[ke];for(const ce of Dm){const we=Fc(ce);if(we===ke&&Array.isArray(S==null?void 0:S[we])&&S[we].length===11)return S[we]}for(const ce of Dm){const we=Fc(ce);if((we.includes(ke)||ke.includes(we))&&Array.isArray(S==null?void 0:S[we])&&S[we].length===11)return S[we]}return null},Te=(be,ke)=>{const ce=be.map(we=>[...we]);for(let we=0;we<co.length;we++){const ht=(ke==null?void 0:ke[we])??"";if(!ht)continue;const nt=me(ht);if(!(!Array.isArray(nt)||nt.length!==11))for(let Ie=0;Ie<Pf.length;Ie++)ce[we][Ie]=!!nt[Ie]}return ce};x.useEffect(()=>{if(!e)return;let be=!0;return(async()=>{try{U(null),E(!0);const ce=await D9(e,n);if(!be)return;const we=String((ce==null?void 0:ce.status)||"").toLowerCase()==="published";if(H(we),we&&(q(!1),ne(null)),!ce){Z([structuredClone(ie)]),p(""),g(""),b(co.map(()=>Pf.map(()=>!1))),w(co.map(()=>"")),A(co.map(Ur=>gv[Ur]??[])),H(!1);return}const ht=Array.isArray(ce.rows)?ce.rows:[];Z(ht.length?T(ht):[structuredClone(ie)]);const nt=ce.books&&typeof ce.books=="object"?ce.books:{};p(typeof nt.textbook=="string"?nt.textbook:""),g(typeof nt.reference=="string"?nt.reference:"");const Ie=ce.active_learning&&typeof ce.active_learning=="object"?ce.active_learning:{},It=Array.isArray(Ie.dropdowns)?Ie.dropdowns.map(Ur=>Ur==null?"":String(Ur)):[],ct=Array.isArray(Ie.grid)?Ie.grid:[],Mt=Array.isArray(Ie.optionsByRow)?Ie.optionsByRow:null,xr=Ie.articulation_extras&&typeof Ie.articulation_extras=="object"?Ie.articulation_extras:{};M(xr);const Pr=co.map((Ur,qr)=>Pf.map((cn,Pn)=>{var mn;const Lr=(mn=ct==null?void 0:ct[qr])==null?void 0:mn[Pn];return Lr===!0||Lr==="true"||Lr===1||Lr==="1"||String(Lr).trim().toLowerCase()==="x"?!0:!!Lr})),Nt=It.length===co.length?It.slice(0,co.length):co.map(()=>""),Jr=Mt&&Array.isArray(Mt)?i(Mt,Nt):Nt;if(w(Jr),b(Te(Pr,Jr)),Mt&&Array.isArray(Mt)){const Ur=co.map((qr,cn)=>{const Pn=Mt==null?void 0:Mt[cn];return Array.isArray(Pn)?Pn.map(Lr=>String(Lr??"")).map(Lr=>Lr.trim()).filter(Boolean):[]});A(Ur)}else A(co.map(Ur=>gv[Ur]??[]))}catch(ce){if(!be)return;U((ce==null?void 0:ce.message)||"Failed to load CDAP from cloud"),Z([structuredClone(ie)])}finally{be&&E(!1)}})(),()=>{be=!1}},[e,ie]),x.useEffect(()=>{r&&r(!!C)},[C,r]),x.useEffect(()=>{let be=!0;const ke=async()=>{try{const we=await N3();be&&j(we)}catch{}};ke();const ce=Vre(()=>ke());return()=>{be=!1,ce()}},[]),x.useEffect(()=>{if(t&&!C){if(Array.isArray(t.rows)&&t.rows.length&&Z(T(t.rows)),typeof t.textbook=="string"&&p(t.textbook),typeof t.reference=="string"&&g(t.reference),Array.isArray(t.activeLearningOptionsByRow)&&t.activeLearningOptionsByRow.length){const be=co.map((we,ht)=>{var Ie;const nt=(Ie=t.activeLearningOptionsByRow)==null?void 0:Ie[ht];return Array.isArray(nt)?nt.map(It=>String(It??"")).map(It=>It.trim()).filter(Boolean):[]}),ce=i(be,v);A(be),w(ce),b(we=>Te(we,ce))}t.articulationExtras&&typeof t.articulationExtras=="object"&&M(t.articulationExtras)}},[t,C]);const je=async()=>{if(!e)return;const be=String(O||"").trim();if(!be){ne("Reason is required.");return}Q(!0),ne(null);try{const ke=await sl({assessment:"cdap",subject_code:e,scope:"MARK_ENTRY",reason:be,teaching_assignment_id:n});alert(ol(ke)),q(!1)}catch(ke){const ce=ll(ke,"Failed to request edit");ne(ce),alert(`Edit request failed: ${ce}`)}finally{Q(!1),V()}};x.useEffect(()=>{b(be=>Te(be,v))},[S]);const Le=x.useMemo(()=>{const be=new Map;let ke=null;return D.forEach((ce,we)=>{const ht=ce.unit??"",nt=ht!==""?String(ht):"";nt&&(ke=nt);const Ie=nt||ke||String(Math.floor(we/9)+1),It=be.get(Ie)??{key:Ie,items:[]};It.items.push({row:ce,index:we}),be.set(Ie,It)}),Array.from(be.values()).sort((ce,we)=>{const ht=Number(ce.key),nt=Number(we.key);return!Number.isNaN(ht)&&!Number.isNaN(nt)?ht-nt:ce.key.localeCompare(we.key)})},[D]),_e=(be,ke,ce)=>{if(ke==="content_type"&&re(ce)){Z(we=>we.filter((ht,nt)=>nt!==be));return}Z(we=>{const ht=[...we];return ht[be]={...ht[be],[ke]:ce},ht})},He=()=>Z(be=>[...be,structuredClone(ie)]),We=be=>Z(ke=>ke.filter((ce,we)=>we!==be)),Pt=be=>{Z(ke=>{const ce=structuredClone(ie);ce.unit=be;let we=null,ht=-1,nt=-1;for(let It=0;It<ke.length;It++){const ct=ke[It].unit??"",Mt=ct!==""?String(ct):"";Mt&&(we=Mt),(Mt||we||String(Math.floor(It/9)+1))===String(be)&&(nt===-1&&(nt=It),ht=It)}return nt!==-1&&(ce.unit_name=ke[nt].unit_name??"",ce.co=ke[nt].co??""),ht===-1?[...ke,ce]:[...ke.slice(0,ht+1),ce,...ke.slice(ht+1)]})},dt=async()=>{if(!e){alert("No subject selected.");return}try{U(null),E(!0),await $9({subjectId:e,status:"published",teaching_assignment_id:n,rows:D,books:{textbook:h,reference:m},active_learning:{grid:y,dropdowns:v,optionsByRow:k,articulation_extras:R}}),H(!0),alert("Published to cloud.")}catch(be){alert((be==null?void 0:be.message)||"Failed to save to cloud")}finally{E(!1),V()}};x.useEffect(()=>{if(!o){u(1);return}const be=()=>{const we=s.current;if(!we)return;const ht=we.querySelector('table[data-cdap-table="1"]');if(!ht)return;const nt=we.clientWidth,Ie=ht.scrollWidth;if(!nt||!Ie)return;const ct=(nt-24)/Ie,Mt=Math.min(1,Math.max(.35,ct));u(Mt)};be();const ke=s.current;if(!ke)return;const ce=new ResizeObserver(()=>be());return ce.observe(ke),()=>ce.disconnect()},[o,D]);const Ye=MF.slice(3,8),lt=[...LF,...RF];return a.jsxs("div",{style:{border:"1px solid #dbe4f0",borderRadius:14,padding:"16px 18px",background:"#fff",boxShadow:"0 2px 12px rgba(15, 23, 42, 0.08)",width:"100%",boxSizing:"border-box",overflow:"hidden"},children:[a.jsx("style",{children:`
        .cdap-slider::-webkit-slider-thumb {
          appearance: none;
          height: 14px;
          width: 14px;
          border-radius: 50%;
          background: #2563eb;
          cursor: pointer;
          box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        .cdap-slider::-moz-range-thumb {
          height: 14px;
          width: 14px;
          border-radius: 50%;
          background: #2563eb;
          cursor: pointer;
          border: none;
        }
        .cdap-slider::-webkit-slider-track {
          background: #e5e7eb;
          height: 6px;
          border-radius: 999px;
        }
        .cdap-slider::-moz-range-track {
          background: #e5e7eb;
          height: 6px;
          border-radius: 999px;
          border: none;
        }
        .cdap-table-wrap { overflow-x: auto; border: 1px solid #e2e8f0; border-radius: 10px; }
        .cdap-table { border-collapse: collapse; width: 100%; font-size: 11px; table-layout: fixed; }
        .cdap-table thead th {
          position: sticky;
          top: 0;
          z-index: 2;
          border: 1px solid #e2e8f0;
          padding: 5px 4px;
          font-size: 10px;
          font-weight: 700;
          text-transform: uppercase;
          letter-spacing: 0.03em;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }
        .cdap-table tbody tr:hover td { background: #eff6ff !important; }
        .cdap-table tbody td { border: 1px solid #e2e8f0; padding: 3px 4px; vertical-align: top; }
        .cdap-cell-textarea {
          width: 100%;
          border: 1px solid #cbd5e1;
          border-radius: 4px;
          padding: 3px 5px;
          font-size: 11px;
          resize: none;
          font-family: inherit;
          line-height: 1.4;
        }
        .cdap-cell-textarea:focus { outline: none; border-color: #2563eb; box-shadow: 0 0 0 2px rgba(37,99,235,0.15); }
        .cdap-cell-textarea:disabled { background: #f3f4f6; cursor: not-allowed; color: #6b7280; }
        .cdap-unit-card {
          border: 1px solid #dbe4f0;
          border-radius: 12px;
          background: #fff;
          margin-bottom: 14px;
          overflow: hidden;
          box-shadow: 0 1px 4px rgba(15,23,42,0.05);
        }
        .cdap-unit-header {
          display: grid;
          grid-template-columns: 80px 1fr 1fr;
          gap: 0;
          border-bottom: 1px solid #dbe4f0;
          background: #f1f5f9;
        }
        .cdap-unit-header-cell {
          padding: 8px 10px;
          border-right: 1px solid #dbe4f0;
        }
        .cdap-unit-header-cell:last-child { border-right: none; }
        .cdap-unit-header-cell label {
          display: block;
          font-size: 10px;
          font-weight: 700;
          text-transform: uppercase;
          letter-spacing: 0.04em;
          color: #64748b;
          margin-bottom: 4px;
        }
        .cdap-unit-header-cell textarea {
          width: 100%;
          border: 1px solid #cbd5e1;
          border-radius: 6px;
          padding: 4px 6px;
          font-size: 12px;
          font-family: inherit;
          resize: none;
          background: #fff;
          line-height: 1.4;
        }
        .cdap-unit-header-cell textarea:focus { outline: none; border-color: #2563eb; }
        .cdap-unit-header-cell textarea:disabled { background: #f3f4f6; cursor: not-allowed; color: #6b7280; }
        .cdap-table-scale-wrap {
          transform-origin: left top;
        }
      `}),B?a.jsx("div",{style:{marginBottom:8,fontSize:12,color:"#64748b"},children:"Loading from cloud"}):P?a.jsx("div",{style:{marginBottom:8,fontSize:12,color:"#b91c1c"},children:P}):null,C?a.jsx("div",{style:{marginBottom:12,padding:"12px 16px",background:"linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)",border:"1px solid #fbbf24",borderRadius:10,color:"#92400e",fontSize:14,fontWeight:600,display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:a.jsx("span",{children:" Published  Document is read-only. Use Request Edit to make changes."})}):null,de||W?a.jsx("div",{style:{marginBottom:10,fontSize:12,color:W?"#b91c1c":"#64748b"},children:W||"Checking edit approval"}):ae&&ee&&(oe!=null&&oe.approval_until)?a.jsxs("div",{style:{marginBottom:10,fontSize:12,color:"#065f46"},children:["Edit approved until ",new Date(oe.approval_until).toLocaleString(),"."]}):null,a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",gap:10,padding:"10px 14px",background:"linear-gradient(to right, #f8fafc, #f1f5f9)",border:"1px solid #e2e8f0",borderRadius:12,marginBottom:14},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[a.jsx("div",{style:{width:36,height:36,borderRadius:9,background:"linear-gradient(135deg, #1e40af 0%, #2563eb 100%)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),a.jsx("line",{x1:"3",y1:"15",x2:"21",y2:"15"}),a.jsx("line",{x1:"9",y1:"3",x2:"9",y2:"21"})]})}),a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:700,color:"#0f172a",fontSize:13},children:"Revised CDP Editor"}),a.jsx("div",{style:{fontSize:11,color:"#64748b"},children:"Interactive spreadsheet interface"})]})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,background:"#fff",border:"1px solid #e2e8f0",borderRadius:8,padding:"5px 8px",boxShadow:"0 1px 2px rgba(0,0,0,0.04)"},children:[a.jsx("button",{type:"button",onClick:()=>f(be=>Math.max(50,be-10)),style:{background:"none",border:"none",cursor:"pointer",padding:"0 2px",display:"flex",alignItems:"center"},children:a.jsx(Zte,{size:14,color:"#64748b"})}),a.jsx("input",{type:"range",min:"50",max:"200",step:"10",value:d,onChange:be=>f(parseInt(be.target.value,10)),className:"cdap-slider",style:{width:80}}),a.jsx("button",{type:"button",onClick:()=>f(be=>Math.min(200,be+10)),style:{background:"none",border:"none",cursor:"pointer",padding:"0 2px",display:"flex",alignItems:"center"},children:a.jsx(Qte,{size:14,color:"#64748b"})}),a.jsxs("span",{style:{fontSize:11,color:"#334155",minWidth:32,textAlign:"right",fontVariantNumeric:"tabular-nums"},children:[d,"%"]})]}),a.jsxs("button",{onClick:()=>l(be=>!be),title:"Toggle fit-to-screen scaling",style:{padding:"6px 10px",borderRadius:8,border:o?"none":"1px solid #e2e8f0",background:o?"#111827":"#fff",color:o?"#fff":"#374151",cursor:"pointer",fontWeight:600,fontSize:11,display:"flex",alignItems:"center",gap:5,boxShadow:o?"0 2px 6px rgba(17,24,39,0.25)":"0 1px 2px rgba(0,0,0,0.04)",transition:"all 150ms ease"},children:[a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3"}),a.jsx("path",{d:"M21 8V5a2 2 0 0 0-2-2h-3"}),a.jsx("path",{d:"M3 16v3a2 2 0 0 0 2 2h3"}),a.jsx("path",{d:"M16 21h3a2 2 0 0 0 2-2v-3"})]}),"Fit Screen: ",o?"ON":"OFF"]}),a.jsxs("button",{onClick:He,disabled:C,style:{padding:"6px 12px",borderRadius:8,border:"none",background:C?"#d1d5db":"#059669",color:"#fff",cursor:C?"not-allowed":"pointer",fontWeight:600,fontSize:11,opacity:C?.5:1,display:"flex",alignItems:"center",gap:5,boxShadow:C?"none":"0 2px 6px rgba(5,150,105,0.28)"},children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Row"]}),a.jsx("button",{onClick:()=>{if(!C)return dt();q(be=>!be),ne(null)},disabled:F,style:{padding:"6px 14px",borderRadius:8,border:"none",background:C?"#16a34a":"#2563eb",color:"#fff",cursor:F?"not-allowed":"pointer",fontWeight:700,fontSize:11,opacity:F?.6:1,boxShadow:C?"0 2px 6px rgba(22,163,74,0.28)":"0 2px 6px rgba(37,99,235,0.28)"},children:C?" Request Edit":" Publish"})]})]}),C&&Y?a.jsxs("div",{style:{marginBottom:16,border:"1px solid #e2e8f0",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:800,color:"#0f172a",marginBottom:8},children:"Reason (required)"}),a.jsx("textarea",{value:O,onChange:be=>X(be.target.value),rows:3,style:{width:"100%",padding:10,border:"1px solid #cbd5e1",borderRadius:10,fontSize:13,background:"#fff"},placeholder:"Why do you need to edit this published CDAP?"}),K?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#b91c1c",fontWeight:700},children:K}):null,a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:10},children:[a.jsx("button",{type:"button",className:"obe-btn",onClick:()=>q(!1),disabled:F,children:"Cancel"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-success",onClick:je,disabled:F||!String(O||"").trim(),children:F?"Requesting":"Confirm Request"})]})]}):null,a.jsx("div",{ref:s,children:Le.map(be=>{var ce;const ke=(ce=be.items[0])==null?void 0:ce.row;return ke?a.jsxs("div",{className:"cdap-unit-card",children:[a.jsxs("div",{className:"cdap-unit-header",children:[a.jsxs("div",{className:"cdap-unit-header-cell",style:{background:"linear-gradient(135deg, #1e40af 0%, #2563eb 100%)"},children:[a.jsx("label",{style:{color:"rgba(255,255,255,0.75)"},children:"Unit #"}),a.jsx("textarea",{value:ke.unit??"",onChange:we=>be.items.forEach(ht=>_e(ht.index,"unit",we.target.value)),disabled:C,rows:2,style:{background:"rgba(255,255,255,0.15)",border:"1px solid rgba(255,255,255,0.3)",borderRadius:6,color:"#fff",padding:"4px 6px",fontSize:13,fontWeight:700,width:"100%",resize:"none",fontFamily:"inherit",cursor:C?"not-allowed":"text"}})]}),a.jsxs("div",{className:"cdap-unit-header-cell",children:[a.jsx("label",{children:"Syllabus (Unit Name)"}),a.jsx("textarea",{value:ke.unit_name??"",onChange:we=>be.items.forEach(ht=>_e(ht.index,"unit_name",we.target.value)),disabled:C,rows:2})]}),a.jsxs("div",{className:"cdap-unit-header-cell",children:[a.jsx("label",{children:"Course Outcome (CO)"}),a.jsx("textarea",{value:ke.co??"",onChange:we=>be.items.forEach(ht=>_e(ht.index,"co",we.target.value)),disabled:C,rows:2})]})]}),a.jsx("div",{className:"cdap-table-wrap",style:{margin:"0 0"},children:(()=>{const we=o?c*(d/100):d/100,ht=Math.max(1,100/we);return a.jsx("div",{className:"cdap-table-scale-wrap",style:{transform:`scale(${we})`,width:`${ht}%`},children:a.jsxs("table",{"data-cdap-table":"1",className:"cdap-table",style:{minWidth:1200},children:[a.jsxs("colgroup",{children:[a.jsx("col",{style:{width:34}}),a.jsx("col",{style:{width:90}}),a.jsx("col",{style:{width:70}}),a.jsx("col",{style:{width:190}}),a.jsx("col",{style:{width:190}}),a.jsx("col",{style:{width:62}}),lt.map(nt=>a.jsx("col",{style:{width:34}},nt.key)),a.jsx("col",{style:{width:82}}),a.jsx("col",{style:{width:66}})]}),a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{background:"#f1f5f9",textAlign:"center"},children:"#"}),Ye.map(nt=>a.jsx("th",{style:{background:"#f1f5f9",textAlign:"left"},children:nt.label},nt.key)),lt.map(nt=>a.jsx("th",{style:{background:nt.key.startsWith("pso")?"#fdf4ff":"#fff7ed",textAlign:"center"},children:nt.label},nt.key)),a.jsx("th",{style:{background:"#f0fdf4",textAlign:"center"},children:"HRS"}),a.jsx("th",{style:{background:"#f1f5f9",textAlign:"center"},children:"Act."})]})}),a.jsx("tbody",{children:be.items.map((nt,Ie)=>a.jsx(x.Fragment,{children:a.jsxs("tr",{style:{background:Ie%2===0?"#fff":"#f8fafc"},children:[a.jsx("td",{style:{textAlign:"center",color:"#94a3b8",fontWeight:600,fontSize:10},children:Ie+1}),Ye.map(It=>a.jsx("td",{children:a.jsx("textarea",{value:nt.row[It.key]??"",onChange:ct=>_e(nt.index,It.key,ct.target.value),disabled:C,className:"cdap-cell-textarea",rows:2})},It.key)),lt.map(It=>a.jsx("td",{style:{textAlign:"center",background:It.key.startsWith("pso")?"#fdf4ff":void 0},children:a.jsx("input",{type:"checkbox",checked:!!nt.row[It.key],onChange:ct=>_e(nt.index,It.key,ct.target.checked),disabled:C,style:{cursor:C?"not-allowed":"pointer",width:14,height:14,accentColor:"#2563eb"}})},It.key)),a.jsx("td",{style:{textAlign:"center"},children:a.jsx("input",{type:"text",value:nt.row.total_hours_required??"",onChange:It=>_e(nt.index,"total_hours_required",It.target.value),disabled:C,style:{width:"100%",border:"1px solid #cbd5e1",borderRadius:4,padding:"3px 4px",fontSize:11,background:C?"#f3f4f6":"#fff",cursor:C?"not-allowed":"text",textAlign:"center"}})}),a.jsx("td",{style:{textAlign:"center"},children:a.jsx("button",{type:"button",onClick:()=>We(nt.index),disabled:C,title:"Delete row",style:{padding:"3px 7px",background:C?"#d1d5db":"#fee2e2",color:C?"#9ca3af":"#dc2626",border:`1px solid ${C?"#d1d5db":"#fca5a5"}`,borderRadius:5,cursor:C?"not-allowed":"pointer",fontSize:11,fontWeight:600,opacity:C?.5:1},children:""})})]})},nt.index))})]})})})()}),a.jsx("div",{style:{padding:"10px 14px",borderTop:"1px solid #f1f5f9"},children:a.jsxs("button",{type:"button",onClick:()=>Pt(be.key),disabled:C,style:{padding:"6px 12px",background:C?"#e5e7eb":"#eff6ff",color:C?"#9ca3af":"#2563eb",border:`1px solid ${C?"#d1d5db":"#bfdbfe"}`,borderRadius:7,cursor:C?"not-allowed":"pointer",fontWeight:600,fontSize:12,opacity:C?.5:1,display:"flex",alignItems:"center",gap:5},children:[a.jsx("span",{style:{fontSize:14,lineHeight:1},children:"+"})," Add Row to Unit ",be.key]})})]},be.key):null})}),a.jsxs("section",{style:{marginTop:16,padding:16,border:"1px solid #e2e8f0",borderRadius:12,background:"#f8fafc"},children:[a.jsx("h4",{style:{marginBottom:10},children:"Reference Materials"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(260px, 1fr))",gap:16},children:[a.jsxs("div",{children:[a.jsx("label",{style:{fontSize:12,fontWeight:600},children:"Textbook Details"}),a.jsx("textarea",{value:h,onChange:be=>p(be.target.value),disabled:C,rows:4,style:{width:"100%",padding:8,border:"1px solid #cbd5e1",borderRadius:8,marginTop:6,background:C?"#f3f4f6":"#fff",cursor:C?"not-allowed":"text"},placeholder:"Textbook details (Excel: Column B, Row 64)"})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontSize:12,fontWeight:600},children:"Reference Book Details"}),a.jsx("textarea",{value:m,onChange:be=>g(be.target.value),disabled:C,rows:4,style:{width:"100%",padding:8,border:"1px solid #cbd5e1",borderRadius:8,marginTop:6,background:C?"#f3f4f6":"#fff",cursor:C?"not-allowed":"text"},placeholder:"Reference book details (Excel: Column B, Row 68)"})]})]})]}),a.jsxs("section",{style:{marginTop:16,padding:16,border:"1px solid #e2e8f0",borderRadius:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:[a.jsxs("div",{children:[a.jsx("h4",{style:{margin:0},children:"Active Learning Mapping"}),a.jsx("div",{style:{fontSize:12,color:"#64748b"},children:"7  11 PO mapping matrix"})]}),a.jsx("button",{type:"button",onClick:()=>{b(co.map(()=>Pf.map(()=>!1))),w(co.map(()=>""))},disabled:C,style:{padding:"6px 10px",borderRadius:8,border:"1px solid #e2e8f0",background:C?"#e5e7eb":"#f8fafc",cursor:C?"not-allowed":"pointer",opacity:C?.5:1},children:"Clear All"})]}),a.jsx("div",{style:{overflowX:"auto"},children:a.jsxs("table",{style:{borderCollapse:"collapse",minWidth:900,width:"100%"},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{border:"1px solid #e2e8f0",padding:8,background:"#f8fafc",textAlign:"left"},children:"Activity Type"}),a.jsx("th",{style:{border:"1px solid #e2e8f0",padding:8,background:"#f8fafc",textAlign:"left"},children:"Specific Activity"}),Pf.map(be=>a.jsx("th",{style:{border:"1px solid #e2e8f0",padding:8,background:"#fff7ed",textAlign:"center"},children:be},be))]})}),a.jsx("tbody",{children:co.map((be,ke)=>a.jsxs("tr",{style:{background:ke%2===0?"#fff":"#f9fafb"},children:[a.jsx("td",{style:{border:"1px solid #e2e8f0",padding:8,fontWeight:600},children:be}),a.jsx("td",{style:{border:"1px solid #e2e8f0",padding:8},children:a.jsxs("select",{value:v[ke]??"",onChange:ce=>{const we=ce.target.value;w(ht=>{const nt=[...ht];return nt[ke]=we,nt}),b(ht=>{const nt=ht.map(It=>[...It]),Ie=me(we);if(Array.isArray(Ie)&&Ie.length===11)for(let It=0;It<Pf.length;It++)nt[ke][It]=!!Ie[It];return nt})},disabled:C,style:{width:"100%",padding:6,border:"1px solid #cbd5e1",borderRadius:6,background:C?"#f3f4f6":"#fff",cursor:C?"not-allowed":"pointer"},children:[a.jsx("option",{value:"",children:"-- Select Activity --"}),(Array.isArray(k==null?void 0:k[ke])&&(k!=null&&k[ke].length)?k==null?void 0:k[ke]:gv[be]??[]).map(ht=>String(ht??"").trim()).filter(Boolean).filter((ht,nt,Ie)=>Ie.indexOf(ht)===nt).map(ht=>a.jsx("option",{value:ht,children:ht},ht))]})}),Pf.map((ce,we)=>a.jsx("td",{style:{border:"1px solid #e2e8f0",padding:8,textAlign:"center"},children:a.jsx("input",{type:"checkbox",checked:!!y[ke][we],disabled:C||(()=>{const ht=(v==null?void 0:v[ke])??"";if(!ht)return!1;const nt=me(ht);return Array.isArray(nt)&&nt.length===11})(),onChange:ht=>{const nt=ht.target.checked;b(Ie=>{const It=Ie.map(ct=>[...ct]);return It[ke][we]=nt,It})},style:{cursor:C?"not-allowed":"pointer"}})},ce))]},be))})]})})]})]})}function $Pe({courseId:e,showHeader:t=!0,showCourseInput:r=!0}){const[n,i]=x.useState(e||""),[s,o]=x.useState(null),[l,c]=x.useState("idle"),[u,d]=x.useState(null),[f,h]=x.useState(!1),p=sn.useMemo(()=>{if(n)try{const m=localStorage.getItem(`markEntry_selectedTa_${n}`),g=m==null?NaN:Number(m);return Number.isFinite(g)?g:void 0}catch{return}},[n]);return x.useEffect(()=>{e&&i(e)},[e]),a.jsxs("div",{children:[t&&a.jsxs("h2",{children:["CDAP - ",n||"No course selected"]}),r&&!e&&a.jsxs("div",{style:{marginBottom:12},children:[a.jsx("label",{style:{marginRight:8},children:"Course ID:"}),a.jsx("input",{value:n,onChange:m=>i(m.target.value),placeholder:"Enter course id",style:{padding:6,border:"1px solid #ccc",borderRadius:4}})]}),f?null:a.jsx("div",{style:{marginBottom:12},children:a.jsx(IPe,{subjectId:n,onUpload:async m=>{o(m);const g=(m==null?void 0:m.revision)||m;if(!(!n||!g)&&!(!Array.isArray(g==null?void 0:g.rows)||g.rows.length===0))try{c("saving"),d(null);const y=$9({subjectId:n,status:"draft",rows:g.rows,books:{textbook:g.textbook||"",reference:g.reference||""},teaching_assignment_id:p,active_learning:{grid:[],dropdowns:[],optionsByRow:g.activeLearningOptionsByRow||[],articulation_extras:g.articulationExtras||{}}}),b=new Promise((v,w)=>setTimeout(()=>w(new Error("Auto-save timed out. Server did not respond in time.")),6e4));await Promise.race([y,b]),c("saved"),d("Saved parsed CDAP to cloud (draft).")}catch(y){c("error"),d((y==null?void 0:y.message)||"Auto-save failed. You can still publish from the editor.")}}})}),u&&a.jsx("div",{style:{marginBottom:12,fontSize:12,color:l==="error"?"#b91c1c":"#166534"},children:u}),a.jsx("div",{style:{marginBottom:12},children:a.jsx(DPe,{subjectId:n,imported:(s==null?void 0:s.revision)||s,onLockChange:m=>h(!!m)})})]})}function Mp({value:e,onChange:t,min:r,max:n}){return a.jsx("input",{type:"number",value:e,onChange:i=>{const s=i.target.value;t(s===""?"":Number(s))},min:r,max:n,style:{width:76,padding:"6px 8px",borderRadius:8,border:"1px solid #e6eef8",outline:"none",fontSize:13}})}function FF(e){const t=typeof e.band1=="number"?e.band1:0,r=typeof e.band2=="number"?e.band2:0,n=typeof e.band3=="number"?e.band3:0;if(!(t+r+n))return"-";const s=Math.max(t,r,n);return s===t?1:s===r?2:3}function UPe(e){return e===1?{label:"LOW LEVEL",code:"LL"}:e===2?{label:"MEDIUM LEVEL",code:"ML"}:e===3?{label:"HIGH LEVEL",code:"HL"}:{label:"",code:"-"}}const or={page:{padding:20,width:"100%",boxSizing:"border-box",minHeight:"100vh",display:"flex",justifyContent:"center",alignItems:"flex-start",margin:0,fontFamily:"Inter, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial",color:"#1f3947",background:"transparent"},card:{background:"#fff",borderRadius:12,padding:18,border:"1px solid #e6eef8",boxShadow:"0 6px 20px rgba(13,60,100,0.04)",width:"100%",maxWidth:1200,margin:"18px",flex:"1 1 auto"},title:{margin:0,color:"#0b4a6f",fontSize:22,fontWeight:700},subtitle:{marginTop:6,color:"#3d5566",fontSize:13},sectionTitle:{margin:"0 0 10px 0",color:"#0b3b57",fontSize:16},table:{width:"100%",borderCollapse:"collapse",marginTop:8,tableLayout:"auto",display:"block",overflowX:"auto",WebkitOverflowScrolling:"touch"},th:{background:"#f3f8ff",color:"#0b4a6f",fontWeight:700,padding:"8px 10px",border:"1px solid #e6eef8",textAlign:"center",fontSize:13,whiteSpace:"nowrap"},thLeft:{background:"#f3f8ff",color:"#0b4a6f",fontWeight:700,padding:"8px 10px",border:"1px solid #e6eef8",textAlign:"left",fontSize:13,whiteSpace:"nowrap",minWidth:220},td:{padding:"8px 10px",border:"1px solid #eef6fb",color:"#234451",fontSize:13,textAlign:"center"},tdLeft:{padding:"8px 10px",border:"1px solid #eef6fb",color:"#234451",fontSize:13,textAlign:"left",minWidth:220},cellYellow:{background:"#fef9c3"},cellGreen:{background:"#ecfdf3"},link:{color:"#0b4a6f",textDecoration:"underline",fontWeight:700},btn:{border:"1px solid #e6eef8",background:"#fbfdff",padding:"8px 10px",borderRadius:10,cursor:"pointer",fontWeight:700,color:"#0b4a6f"},pill:{display:"inline-flex",alignItems:"center",gap:8,padding:"8px 10px",borderRadius:10,background:"#fbfdff",border:"1px solid #e6eef8",fontSize:13,color:"#234451"}};function mk(e){return String(e||"").trim().toLowerCase().replace(/\s+/g,"").replace(/[^a-z0-9]/g,"")}function zPe(e){if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=parseFloat(e.replace(/[^0-9.\-]/g,""));return Number.isFinite(t)?t:null}return null}function WPe(e){return e<=6?"HC":e<=8?"MC":"EC"}function qPe(e){return e==="EC"?"L1":e==="MC"?"L2":e==="HC"?"L3":"-"}async function HPe(e){var m;let t;try{t=await import("xlsx")}catch{throw new Error('Missing dependency "xlsx". Install it with: npm install xlsx  (or yarn add xlsx / pnpm add xlsx)')}const r=await e.arrayBuffer(),n=t.read(r,{type:"array"}),i=(m=n.SheetNames)==null?void 0:m[0];if(!i)throw new Error("No sheet found in the Excel file.");const s=n.Sheets[i],o=t.utils.sheet_to_json(s,{defval:""})||[];if(!o.length)throw new Error("Excel sheet is empty.");const l=Object.keys(o[0]||{}),c=new Map;l.forEach(g=>c.set(mk(g),g));const u=c.get("grade")||l.find(g=>mk(g).includes("grade"))||null,d=c.get("gpaconversion")||c.get("gpaconvert")||l.find(g=>{const y=mk(g);return y.includes("gpaconversion")||y.includes("gpaconvert")||y==="gpa"})||null;if(!u||!d)throw new Error('Excel must contain columns for "Grade" and "GPA conversion".');const f=[];for(const g of o){if(!String(g[u]??"").trim())continue;const b=zPe(g[d]);b!==null&&f.push(b)}if(!f.length)throw new Error('No numeric "GPA conversion" values found.');const h=f.reduce((g,y)=>g+y,0)/f.length,p=Number(h.toFixed(2));return{fileName:e.name,studentsCount:f.length,meanGpa:p,courseLevel:WPe(p)}}function VPe({courseId:e,courseCode:t,courseName:r,embedded:n}){const i=hl(),s=vo(),o=(i.pathname||"").toLowerCase().includes("/lca/pbr"),[l,c]=x.useState({courseCode:t??e??"",courseName:r??"",credit:"",courseModule:""});x.useEffect(()=>{c(ae=>({...ae,courseCode:t??e??ae.courseCode,courseName:r??ae.courseName}))},[e,t,r]);const[u,d]=x.useState({band1:"",band2:"",band3:""}),f=x.useMemo(()=>FF(u),[u]),[h,p]=x.useState([{name:"Prerequisite 1",band1:"",band2:"",band3:""}]),m=x.useMemo(()=>h.map(ae=>FF({band1:ae.band1,band2:ae.band2,band3:ae.band3})),[h]),g=x.useMemo(()=>{const ae=m.filter(C=>C!=="-");if(!ae.length)return"";const ee=ae.reduce((C,Y)=>C+Y,0);return Number((ee/ae.length).toFixed(2))},[m]),y=x.useMemo(()=>g===""?"":Math.floor(g),[g]),b=x.useMemo(()=>y===""||y===0?"-":y===1||y===2||y===3?y:"-",[y]),v=x.useMemo(()=>UPe(b),[b]),w=x.useMemo(()=>b==="-"?"-":`L${b}`,[b]),[S,j]=x.useState(null),[k,A]=x.useState(null),[R,M]=x.useState(null),[B,E]=x.useState(null),[P,U]=x.useState("-"),G=x.useMemo(()=>k?k.courseLevel:S?S.courseLevel:P&&P!=="-"?P:"-",[S,k,P]),H=x.useMemo(()=>qPe(G),[G]),oe=x.useMemo(()=>H!=="-"?H:w,[w,H]),de=e?`/obe/course/${encodeURIComponent(e)}`:"/obe/course",W=async(ae,ee)=>{if(M(null),!ee){ae==="cay1"?j(null):A(null);return}try{E(ae);const C=await HPe(ee);ae==="cay1"?j(C):A(C)}catch(C){M(String((C==null?void 0:C.message)||C||"Failed to parse Excel")),ae==="cay1"?j(null):A(null)}finally{E(null)}},V=ae=>n?a.jsx(a.Fragment,{children:ae}):a.jsx("div",{style:or.page,children:a.jsx("div",{style:or.card,children:ae})});return V(o?a.jsxs(a.Fragment,{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:12},children:[a.jsxs("div",{children:[a.jsx("h2",{style:or.title,children:"Previous Batch Result (PBR)"}),a.jsx("div",{style:or.subtitle,children:"Upload up to 2 Excel files (max 2)."})]}),a.jsx("button",{type:"button",onClick:()=>s(`${de}/lca`),style:or.btn,children:"Back"})]}),a.jsx("div",{style:{height:14}}),a.jsxs("div",{style:{marginBottom:8,display:"flex",gap:12,alignItems:"center"},children:[a.jsx("div",{style:{color:"#0b4a6f",fontWeight:700},children:"Fallback course level (if no Excel):"}),a.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[a.jsx("input",{type:"radio",name:"pbrManual",value:"HC",checked:P==="HC",onChange:()=>U("HC")}),"HARD COURSE (HC)"]}),a.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[a.jsx("input",{type:"radio",name:"pbrManual",value:"MC",checked:P==="MC",onChange:()=>U("MC")}),"MEDIUM COURSE (MC)"]}),a.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[a.jsx("input",{type:"radio",name:"pbrManual",value:"EC",checked:P==="EC",onChange:()=>U("EC")}),"EASY COURSE (EC)"]}),a.jsx("button",{type:"button",onClick:()=>U("-"),style:{marginLeft:8,...or.btn,padding:"6px 8px"},children:"Clear"})]}),a.jsx("table",{style:or.table,children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...or.tdLeft,fontWeight:800,width:220},children:"CAY-1 Excel"}),a.jsx("td",{style:{...or.tdLeft,...or.cellGreen},children:a.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:ae=>{var ee;return W("cay1",((ee=ae.target.files)==null?void 0:ee[0])||null)}})})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...or.tdLeft,fontWeight:800},children:"CAY-2 Excel"}),a.jsx("td",{style:{...or.tdLeft,...or.cellGreen},children:a.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:ae=>{var ee;return W("cay2",((ee=ae.target.files)==null?void 0:ee[0])||null)}})})]})]})}),B&&a.jsxs("div",{style:{marginTop:10,fontSize:13,color:"#3d5566"},children:["Parsing ",B.toUpperCase()," Excel"]}),R&&a.jsx("div",{style:{marginTop:10,fontSize:13,color:"#b42318",fontWeight:700},children:R}),a.jsx("div",{style:{height:14}}),a.jsxs("table",{style:or.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:or.thLeft,children:"DATASET"}),a.jsx("th",{style:or.th,children:"FILE"}),a.jsx("th",{style:or.th,children:"STUDENTS"}),a.jsx("th",{style:or.th,children:"MEAN GPA"}),a.jsx("th",{style:or.th,children:"COURSE LEVEL"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...or.tdLeft,fontWeight:900},children:"CAY-1"}),a.jsx("td",{style:or.tdLeft,children:(S==null?void 0:S.fileName)||""}),a.jsx("td",{style:or.td,children:(S==null?void 0:S.studentsCount)??""}),a.jsx("td",{style:or.td,children:S?S.meanGpa:""}),a.jsx("td",{style:{...or.td,...or.cellGreen,fontWeight:900},children:(S==null?void 0:S.courseLevel)||""})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...or.tdLeft,fontWeight:900},children:"CAY-2"}),a.jsx("td",{style:or.tdLeft,children:(k==null?void 0:k.fileName)||""}),a.jsx("td",{style:or.td,children:(k==null?void 0:k.studentsCount)??""}),a.jsx("td",{style:or.td,children:k?k.meanGpa:""}),a.jsx("td",{style:{...or.td,...or.cellGreen,fontWeight:900},children:(k==null?void 0:k.courseLevel)||""})]})]})]}),a.jsx("div",{style:{height:14}}),a.jsx("table",{style:or.table,children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...or.tdLeft,fontWeight:900,width:220},children:"PREVIOUS BATCH RESULT (PBR)"}),a.jsx("td",{style:{...or.td,...or.cellGreen,fontWeight:900},children:G==="-"?"":G}),a.jsx("td",{style:{...or.tdLeft,fontWeight:900},children:"Learner Centric Level"}),a.jsx("td",{style:{...or.td,...or.cellGreen,fontWeight:900},children:H==="-"?"":H})]}),a.jsx("tr",{children:a.jsx("td",{style:{...or.tdLeft,color:"#557085"},colSpan:4,children:"Course level rule: mean GPA 06 = HC, 68 = MC, >8 = EC. PBR uses CAY-2 when provided; otherwise CAY-1."})})]})})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:12,marginBottom:18},children:[a.jsxs("div",{children:[a.jsx("h2",{style:or.title,children:"Learner Centric Approach"}),a.jsx("div",{style:or.subtitle,children:"Enter values in the highlighted cells; levels are computed automatically."})]}),a.jsx("div",{style:{...or.pill,fontWeight:800},children:"INDEX"})]}),a.jsx("table",{style:or.table,children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...or.tdLeft,width:220,fontWeight:700},children:"COURSE CODE"}),a.jsx("td",{style:{...or.tdLeft,...or.cellGreen},children:a.jsx("input",{value:l.courseCode,readOnly:!0,disabled:!0,"aria-disabled":"true",title:"Course code is locked",style:{width:"100%",border:"none",background:"transparent",fontSize:13,outline:"none",cursor:"not-allowed",color:"#234451"}})})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...or.tdLeft,fontWeight:700},children:"COURSE NAME"}),a.jsx("td",{style:{...or.tdLeft,...or.cellGreen},children:a.jsx("input",{value:l.courseName,readOnly:!0,disabled:!0,"aria-disabled":"true",title:"Course name is locked",style:{width:"100%",border:"none",background:"transparent",fontSize:13,outline:"none",cursor:"not-allowed",color:"#234451"}})})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...or.tdLeft,fontWeight:700},children:"CREDIT OF THE COURSE"}),a.jsx("td",{style:{...or.tdLeft,...or.cellGreen},children:a.jsx("input",{value:l.credit,onChange:ae=>c(ee=>({...ee,credit:ae.target.value})),style:{width:"100%",border:"none",background:"transparent",fontSize:13,outline:"none"}})})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...or.tdLeft,fontWeight:700},children:"COURSE MODULE"}),a.jsx("td",{style:{...or.tdLeft,...or.cellGreen},children:a.jsx("input",{value:l.courseModule,onChange:ae=>c(ee=>({...ee,courseModule:ae.target.value})),style:{width:"100%",border:"none",background:"transparent",fontSize:13,outline:"none"}})})]})]})}),a.jsx("div",{style:{height:16}}),a.jsx("div",{style:or.sectionTitle,children:"STEP 1: Identifying Learner profile"}),a.jsxs("table",{style:or.table,children:[a.jsxs("colgroup",{children:[a.jsx("col",{style:{width:220}}),a.jsx("col",{style:{width:200}}),a.jsx("col",{style:{width:200}}),a.jsx("col",{style:{width:200}}),a.jsx("col",{style:{width:100}}),a.jsx("col",{style:{width:60}})]}),a.jsxs("thead",{children:[a.jsxs("tr",{children:[a.jsx("th",{style:or.thLeft,colSpan:4,children:"1.1 CURRENT GPA PROFILE (CGP)"}),a.jsx("th",{style:or.th,rowSpan:3,colSpan:2,children:"LEVEL"})]}),a.jsxs("tr",{children:[a.jsx("th",{style:or.thLeft,children:"Current batch mean GPA"}),a.jsx("th",{style:or.th,children:"1"}),a.jsx("th",{style:or.th,children:"2"}),a.jsx("th",{style:or.th,children:"3"})]}),a.jsxs("tr",{children:[a.jsx("th",{style:or.thLeft,children:"GPA"}),a.jsx("th",{style:or.th,children:"0 - 5"}),a.jsx("th",{style:or.th,children:"5 - 7.5"}),a.jsx("th",{style:or.th,children:"> 7.5"})]})]}),a.jsx("tbody",{children:a.jsxs("tr",{children:[a.jsx("td",{style:{...or.tdLeft,fontWeight:700},children:"NUMBER OF STUDENTS (CAY-1)"}),a.jsx("td",{style:{...or.td,...or.cellYellow},children:a.jsx(Mp,{value:u.band1,onChange:ae=>d(ee=>({...ee,band1:ae}))})}),a.jsx("td",{style:{...or.td,...or.cellYellow},children:a.jsx(Mp,{value:u.band2,onChange:ae=>d(ee=>({...ee,band2:ae}))})}),a.jsx("td",{style:{...or.td,...or.cellYellow},children:a.jsx(Mp,{value:u.band3,onChange:ae=>d(ee=>({...ee,band3:ae}))})}),a.jsx("td",{style:{...or.td,fontWeight:800,color:"#0b4a6f"},colSpan:2,children:f})]})})]}),a.jsx("div",{style:{height:14}}),a.jsxs("table",{style:or.table,children:[a.jsxs("colgroup",{children:[a.jsx("col",{style:{width:220}}),a.jsx("col",{style:{width:200}}),a.jsx("col",{style:{width:200}}),a.jsx("col",{style:{width:200}}),a.jsx("col",{style:{width:100}}),a.jsx("col",{style:{width:60}})]}),a.jsxs("thead",{children:[a.jsxs("tr",{children:[a.jsx("th",{style:or.thLeft,colSpan:4,children:"1.2 PRE REQUISITE PROFILE (PRP)"}),a.jsx("th",{style:or.th,children:"LEVEL"}),a.jsx("th",{style:or.th,children:" "})]}),a.jsxs("tr",{children:[a.jsx("th",{style:or.thLeft,children:" "}),a.jsx("th",{style:or.th,children:"1"}),a.jsx("th",{style:or.th,children:"2"}),a.jsx("th",{style:or.th,children:"3"}),a.jsx("th",{style:or.th,children:" "}),a.jsx("th",{style:or.th,children:" "})]}),a.jsxs("tr",{children:[a.jsx("th",{style:or.thLeft,children:" "}),a.jsx("th",{style:or.th,children:"0 - 5"}),a.jsx("th",{style:or.th,children:"5 - 7.5"}),a.jsx("th",{style:or.th,children:"> 7.5"}),a.jsx("th",{style:or.th,children:" "}),a.jsx("th",{style:or.th,children:" "})]})]}),a.jsxs("tbody",{children:[h.map((ae,ee)=>a.jsxs("tr",{children:[a.jsx("td",{style:{...or.tdLeft,fontWeight:700},children:ae.name}),a.jsx("td",{style:{...or.td,...or.cellYellow},children:a.jsx(Mp,{value:ae.band1,onChange:C=>p(Y=>{const q=[...Y];return q[ee]={...q[ee],band1:C},q})})}),a.jsx("td",{style:{...or.td,...or.cellYellow},children:a.jsx(Mp,{value:ae.band2,onChange:C=>p(Y=>{const q=[...Y];return q[ee]={...q[ee],band2:C},q})})}),a.jsx("td",{style:{...or.td,...or.cellYellow},children:a.jsx(Mp,{value:ae.band3,onChange:C=>p(Y=>{const q=[...Y];return q[ee]={...q[ee],band3:C},q})})}),a.jsx("td",{style:{...or.td,fontWeight:800,color:"#0b4a6f"},children:m[ee]}),a.jsx("td",{style:{...or.td},children:a.jsx("button",{type:"button",title:"Delete prerequisite","aria-label":`Delete ${ae.name}`,onClick:()=>p(C=>C.filter((Y,q)=>q!==ee)),style:{background:"transparent",border:"none",cursor:"pointer",fontSize:16},children:""})})]},ae.name)),a.jsx("tr",{children:a.jsxs("td",{style:{...or.tdLeft},colSpan:6,children:[a.jsx("button",{type:"button",style:{...or.btn,padding:"6px 10px"},onClick:()=>p(ae=>[...ae,{name:`Prerequisite ${ae.length+1}`,band1:"",band2:"",band3:""}]),"aria-label":"Add prerequisite",children:"+"}),a.jsx("span",{style:{marginLeft:10,fontSize:13,color:"#557085"},children:"Add next prerequisite"})]})}),a.jsxs("tr",{children:[a.jsx("td",{style:{...or.tdLeft,fontWeight:700},colSpan:5,children:"AVERAGE"}),a.jsx("td",{style:{...or.td,fontWeight:800},children:g===""?"-":g})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...or.tdLeft,fontWeight:700},colSpan:5,children:"Standardized level of Learner profile as per the above norms"}),a.jsx("td",{style:{...or.td,...or.cellGreen,fontWeight:900,color:"#0b4a6f"},children:b==="-"?"-":b})]})]})]}),a.jsx("div",{style:{height:14}}),a.jsx("table",{style:or.table,children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...or.tdLeft,...or.cellGreen,fontWeight:900},children:"LOW LEVEL"}),a.jsx("td",{style:{...or.td,...or.cellGreen,fontWeight:900},children:"LL"}),a.jsx("td",{style:{...or.td,...or.cellGreen,fontWeight:900},children:"1"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...or.tdLeft,...or.cellGreen,fontWeight:900},children:"MEDIUM LEVEL"}),a.jsx("td",{style:{...or.td,...or.cellGreen,fontWeight:900},children:"ML"}),a.jsx("td",{style:{...or.td,...or.cellGreen,fontWeight:900},children:"2"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...or.tdLeft,...or.cellGreen,fontWeight:900},children:"HIGH LEVEL"}),a.jsx("td",{style:{...or.td,...or.cellGreen,fontWeight:900},children:"HL"}),a.jsx("td",{style:{...or.td,...or.cellGreen,fontWeight:900},children:"3"})]})]})}),a.jsx("div",{style:{height:14}}),a.jsx("table",{style:or.table,children:a.jsx("tbody",{children:a.jsxs("tr",{children:[a.jsx("td",{style:{...or.tdLeft,fontWeight:800,width:220},children:"The Learners are at"}),a.jsx("td",{style:{...or.td,...or.cellGreen,fontWeight:900},children:v.label}),a.jsx("td",{style:{...or.td,...or.cellGreen,fontWeight:900},children:v.code})]})})}),a.jsx("div",{style:{height:14}}),a.jsx("table",{style:or.table,children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...or.tdLeft,fontWeight:900,width:260},children:a.jsx(es,{style:or.link,to:`${de}/lca/pbr`,children:"PREVIOUS BATCH RESULT (PBR)"})}),a.jsx("td",{style:{...or.td,...or.cellGreen,fontWeight:900},children:G==="-"?"":G}),a.jsx("td",{style:{...or.td,...or.cellGreen,fontWeight:900},children:k?"COURSE LEVEL (CAY-2)":"COURSE LEVEL (CAY-1)"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...or.tdLeft,fontWeight:700},children:" "}),a.jsx("td",{style:{...or.td,...or.cellGreen,fontWeight:900},children:S?`Mean GPA: ${S.meanGpa}`:""}),a.jsx("td",{style:{...or.td,...or.cellGreen,fontWeight:900},children:k?`Mean GPA: ${k.meanGpa}`:""})]})]})}),a.jsx("div",{style:{height:12}}),a.jsx("table",{style:or.table,children:a.jsx("tbody",{children:a.jsxs("tr",{children:[a.jsx("td",{style:{...or.tdLeft,fontWeight:900,width:260},children:"Learner Centric Level"}),a.jsx("td",{style:{...or.td,...or.cellGreen,fontWeight:900},children:oe})]})})})]}))}const In={page:{padding:28,maxWidth:1100,margin:"18px auto",fontFamily:"Inter, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial",color:"#1f3947"},card:{background:"#fff",borderRadius:12,padding:18,border:"1px solid #e6eef8",boxShadow:"0 6px 20px rgba(13,60,100,0.04)"},headerRow:{display:"flex",gap:12,alignItems:"center",flexWrap:"wrap",marginBottom:12},label:{color:"#557085",fontSize:12,fontWeight:700},codeBox:{background:"#fbfdff",border:"1px solid #e6eef8",padding:"10px 14px",borderRadius:8,fontWeight:800,color:"#0b4a6f",fontSize:18},nameBox:{background:"#fff",padding:"6px 10px",color:"#234451"},sectionTitle:{marginTop:8,marginBottom:12,color:"#0b3b57",fontSize:16,fontWeight:700},table:{width:"100%",borderCollapse:"collapse",marginTop:12},th:{background:"#f3f8ff",color:"#0b4a6f",fontWeight:700,padding:"12px",border:"1px solid #e6eef8",textAlign:"center",fontSize:13},td:{padding:"12px",border:"1px solid #eef6fb",color:"#234451",fontSize:13,textAlign:"center"},tdLeft:{padding:"10px",border:"1px solid #eef6fb",color:"#234451",fontSize:13,textAlign:"left"},checkbox:{transform:"scale(1.2)",cursor:"pointer",margin:"0"},inputNumber:{width:80,padding:"6px 8px",borderRadius:6,border:"1px solid #d1e3f0",textAlign:"center"}};function TK({courseCode:e=" ",courseName:t=" ",embedded:r=!1,onClose:n}){const i=hl(),s=vo(),o=r?{padding:12,maxWidth:980,width:"100%",margin:"0 auto"}:In.page,[l,c]=x.useState(""),[u,d]=x.useState(()=>{var de;const G=t&&t.trim()?t.trim():"",H=((de=i.state)==null?void 0:de.courseName)||"",oe=new URLSearchParams(i.search).get("name")||"";return G||H||oe||""}),f=u||l||"",[h,p]=x.useState(()=>{try{const G=new URLSearchParams(i.search),H=G.get("teaching_assignment_id")||G.get("teachingAssignmentId");if(!H)return null;const oe=Number(H);return Number.isFinite(oe)?oe:null}catch{return null}}),[m,g]=x.useState(null),[y,b]=x.useState(null),[v,w]=x.useState(()=>Array(5).fill(null)),[S,j]=x.useState({ico:.4,bco:.3,aco:.1,api:.1,iic:.1}),[k,A]=x.useState(Array.from({length:5},()=>({aco:null,api:null,iic:null})));function R(G,H){const oe=Math.pow(10,H);return Math.round((G+Number.EPSILON)*oe)/oe}function M(G,H=2,oe=!0){if(G==null||G==="")return oe?null:0;const de=Number(G);if(!Number.isFinite(de))return oe?null:0;const W=R(de,H);return W<0?0:W}x.useEffect(()=>{let G=!0;return(async()=>{try{if(!e)return;const H=await I4(e,typeof h=="number"?h:void 0);if(!G||!H)return;g(H);const oe=Array.isArray(H.units)?H.units:[],de=[],W=V=>{if(!Number.isFinite(V))return null;const ae=R(V,2),ee=R(ae*3,2);return ee===0?null:ee};for(let V=0;V<5;V++){const ae=oe[V];if(!ae||!Array.isArray(ae.rows)||ae.rows.length===0){de.push([]);continue}const ee=ae.rows,C=ee.reduce((X,F)=>{const Q=Number(F.hours);return X+(Number.isFinite(Q)?Q:0)},0),Y=11,q=3,O=[];for(let X=0;X<Y;X++){const F=ee.reduce((Q,K)=>{const ne=Number((K.po&&K.po[X])??0);return Q+(Number.isFinite(ne)?ne:0)},0);if(C>0){const Q=F/C,K=W(Q);K!=null&&O.push(K)}}for(let X=0;X<q;X++){const F=ee.reduce((Q,K)=>{const ne=Number((K.pso&&K.pso[X])??0);return Q+(Number.isFinite(ne)?ne:0)},0);if(C>0){const Q=F/C,K=W(Q);K!=null&&O.push(K)}}de.push(O)}b(de)}catch{}})(),()=>{G=!1}},[e,h]);const B=sn.useMemo(()=>y?y.map(G=>{if(!Array.isArray(G)||G.length===0)return{high:0,med:0,low:0,total:0,ico:0};let H=0,oe=0,de=0;G.forEach(ee=>{const C=Number(ee);Number.isFinite(C)&&(C>=1.98?H++:C>=.99?oe++:de++)});const W=H*3+oe*2+de*1,V=H+oe+de,ae=V?R(W/(V*3)*100,2):0;return{high:H,med:oe,low:de,total:W,ico:ae}}):null,[y]),E=sn.useMemo(()=>v.map(G=>G?G*10:null),[v]),P=sn.useMemo(()=>{var H,oe,de;const G=[];for(let W=0;W<5;W++){const V=B&&B[W]?B[W].ico:0,ae=E[W]??0,ee=((H=k[W])==null?void 0:H.aco)??0,C=((oe=k[W])==null?void 0:oe.api)??0,Y=((de=k[W])==null?void 0:de.iic)??0,q=V*S.ico+ae*S.bco+ee*S.aco+C*S.api+Y*S.iic,O=Math.round(q),X=R(O*.03,2);G.push({weightedRounded:O,final:X})}return G},[B,E,k,S]);x.useEffect(()=>{let G=!0;return(async()=>{try{if(!l&&e&&typeof h=="number"){const H=await D9(e,h);if(!G||!H)return;const oe=H.course_name||H.subject_name||H.courseName||H.revision&&(H.revision.course_name||H.revision.courseName||H.revision.subject_name)||"";oe&&c(String(oe))}}catch{}})(),()=>{G=!1}},[e,l,h]),x.useEffect(()=>{l&&!u&&d(l)},[l,u]),x.useEffect(()=>{let G=!0;return(async()=>{try{if(u||!e)return;try{const H=await hc();if(!G)return;const de=(H||[]).filter(W=>String(W.subject_code)===String(e))[0]||null;if(h==null&&de&&de.id!=null){const W=Number(de.id);Number.isFinite(W)&&p(W)}if(de&&de.subject_name){d(String(de.subject_name));return}}catch{}try{const H=await Sl();if(!G)return;const oe=String(e),de=oe.toUpperCase(),W=(H||[]).find(V=>String((V==null?void 0:V.course_code)||"").trim()===oe||String((V==null?void 0:V.course_code)||"").trim().toUpperCase()===de);if(W&&W.course_name){d(String(W.course_name));return}}catch{}}catch{}})(),()=>{G=!1}},[e,f,u,h]);const U=[{co:"CO1",ico:.4,bco:.3,aco:.1,api:.1,iic:.1,target:68,scale:2.03},{co:"CO2",ico:.4,bco:.3,aco:.1,api:.1,iic:.1,target:66,scale:1.99},{co:"CO3",ico:.4,bco:.3,aco:.1,api:.1,iic:.1,target:67,scale:2.01},{co:"CO4",ico:.4,bco:.3,aco:.1,api:.1,iic:.1,target:67,scale:2.02},{co:"CO5",ico:0,bco:.5,aco:0,api:0,iic:0,target:74,scale:2.22}];return a.jsx("div",{style:o,children:a.jsxs("div",{style:In.card,children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:12,marginBottom:12},children:[a.jsxs("div",{style:In.headerRow,children:[a.jsxs("div",{children:[a.jsx("div",{style:In.label,children:"COURSE CODE"}),a.jsx("div",{style:In.codeBox,children:e})]}),a.jsxs("div",{style:{marginLeft:12},children:[a.jsx("div",{style:In.label,children:"COURSE NAME"}),a.jsx("div",{style:In.nameBox,children:f})]})]}),a.jsx("div",{children:r?n?a.jsx("button",{onClick:n,style:{padding:"8px 12px",borderRadius:8,border:"1px solid #e6eef8",background:"#fff",cursor:"pointer",fontWeight:700},children:"Close"}):null:a.jsx("button",{onClick:()=>s(-1),style:{padding:"8px 12px",borderRadius:8,border:"1px solid #e6eef8",background:"#fff",cursor:"pointer",fontWeight:700},children:" Back"})})]}),a.jsxs("div",{style:{...In.card,padding:14,marginTop:0},children:[a.jsx("div",{style:In.sectionTitle,children:"Course Outcome Attainment  Targets"}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16,marginTop:12},children:[a.jsxs("div",{style:{...In.card,padding:16,minHeight:140},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"1. Rubrics for Impact (ICO)"}),a.jsxs("table",{style:In.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:In.th,children:"CO"}),a.jsx("th",{style:In.th,children:"High (3)"}),a.jsx("th",{style:In.th,children:"Medium (2)"}),a.jsx("th",{style:In.th,children:"Low (1)"}),a.jsx("th",{style:In.th,children:"Total"}),a.jsx("th",{style:In.th,children:"ICO"})]})}),a.jsx("tbody",{children:["CO1","CO2","CO3","CO4","CO5"].map((G,H)=>{const oe=B&&B[H]?B[H]:{high:0,med:0,low:0,total:0,ico:0};return a.jsxs("tr",{children:[a.jsx("td",{style:In.tdLeft,children:G}),a.jsx("td",{style:In.td,children:oe.high}),a.jsx("td",{style:In.td,children:oe.med}),a.jsx("td",{style:In.td,children:oe.low}),a.jsx("td",{style:In.td,children:oe.total}),a.jsxs("td",{style:In.td,children:[oe.ico.toFixed(2),"%"]})]},G)})})]})]}),a.jsxs("div",{style:{...In.card,padding:16,minHeight:140},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"2. BTL Level (BCO)"}),a.jsxs("table",{style:In.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:In.th,children:"CO"}),a.jsx("th",{style:In.th,children:"BTL-1"}),a.jsx("th",{style:In.th,children:"BTL-2"}),a.jsx("th",{style:In.th,children:"BTL-3"}),a.jsx("th",{style:In.th,children:"BTL-4"}),a.jsx("th",{style:In.th,children:"BTL-5"}),a.jsx("th",{style:In.th,children:"BTL-6"}),a.jsx("th",{style:In.th,children:"BCO"})]})}),a.jsx("tbody",{children:["CO1","CO2","CO3","CO4","CO5"].map((G,H)=>a.jsxs("tr",{children:[a.jsx("td",{style:In.tdLeft,children:G}),Array.from({length:6},(oe,de)=>{const W=de+1,V=v[H]===W;return a.jsx("td",{style:In.td,children:a.jsx("input",{type:"checkbox","aria-label":`BTL-${W} for ${G}`,style:In.checkbox,checked:!!V,onChange:()=>{w(ae=>{const ee=[...ae];return ee[H]===W?ee[H]=null:ee[H]=W,ee})},disabled:v[H]!=null&&v[H]!==W,title:v[H]!=null&&v[H]!==W?"Disabled while another BTL is selected":`Select BTL-${W}`})},W)}),a.jsx("td",{style:In.td,children:E[H]??""})]},G))})]})]}),a.jsxs("div",{style:{...In.card,padding:16,minHeight:120},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"3. Last year's Average CO attainment (ACO)"}),a.jsxs("table",{style:In.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:In.th,children:"COs"}),a.jsx("th",{style:In.th,children:"SUB"})]})}),a.jsx("tbody",{children:U.map((G,H)=>{var oe;return a.jsxs("tr",{children:[a.jsx("td",{style:In.tdLeft,children:G.co}),a.jsx("td",{style:In.td,children:a.jsx("input",{min:0,step:"any",style:In.inputNumber,type:"number",value:((oe=k[H])==null?void 0:oe.aco)??"",onChange:de=>{const W=de.target.value===""?null:de.target.value;A(V=>{const ae=[...V];return ae[H]={...ae[H],aco:W===null?null:Number(W)},ae})},onBlur:de=>{const W=M(de.target.value,2,!0);A(V=>{const ae=[...V];return ae[H]={...ae[H],aco:W},ae})}})})]},G.co)})})]})]}),a.jsxs("div",{style:{...In.card,padding:16,minHeight:120},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"4. Average Performance Index (API)"}),a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[a.jsx("div",{style:{border:"1px solid #94a3b8",borderRadius:4,overflow:"hidden",flex:1},children:a.jsx("table",{style:{borderCollapse:"collapse",width:"100%"},children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{padding:8,minWidth:220,background:"#fff",fontWeight:700,borderRight:"1px solid #94a3b8"},children:"BATCH (CAY)"}),a.jsx("td",{style:{padding:8,background:"#fde68a",fontWeight:800,textAlign:"center"}})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:8,background:"#fff",borderTop:"1px solid #94a3b8",borderRight:"1px solid #94a3b8"},children:"NO OF SUCCESSFUL"}),a.jsx("td",{style:{padding:8,background:"#fde68a",fontWeight:800,textAlign:"center"}})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:8,background:"#fff",borderTop:"1px solid #94a3b8",borderRight:"1px solid #94a3b8"},children:"MEAN CGPA"}),a.jsx("td",{style:{padding:8,background:"#fde68a",fontWeight:800,textAlign:"center"}})]})]})})}),a.jsxs("div",{style:{flex:1},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"Per-CO API (manual)"}),a.jsxs("table",{style:In.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:In.th,children:"CO"}),a.jsx("th",{style:In.th,children:"API"})]})}),a.jsx("tbody",{children:["CO1","CO2","CO3","CO4","CO5"].map((G,H)=>{var oe;return a.jsxs("tr",{children:[a.jsx("td",{style:In.tdLeft,children:G}),a.jsx("td",{style:In.td,children:a.jsx("input",{min:0,step:"any",style:In.inputNumber,type:"number",value:((oe=k[H])==null?void 0:oe.api)??"",onChange:de=>{const W=de.target.value===""?null:de.target.value;A(V=>{const ae=[...V];return ae[H]={...ae[H],api:W===null?null:Number(W)},ae})},onBlur:de=>{const W=M(de.target.value,2,!0);A(V=>{const ae=[...V];return ae[H]={...ae[H],api:W},ae})}})})]},G)})})]})]})]}),a.jsxs("div",{style:{marginTop:12,display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[a.jsx("div",{style:{color:"#234451",fontWeight:700},children:"Average Performance Index of the student's batch (API) - GPA ="}),a.jsx("div",{style:{border:"2px solid #0b4a6f",padding:"6px 10px",fontWeight:900}}),a.jsx("div",{children:"/100"})]})]}),a.jsxs("div",{style:{...In.card,padding:18,minHeight:180},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"5. The Improvement Index on CO attainment (IIC)"}),a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[a.jsx("div",{style:{border:"2px solid #0b3b57",borderRadius:4,overflow:"hidden",width:360,background:"#fff"},children:a.jsx("table",{style:{borderCollapse:"collapse",width:"100%"},children:a.jsxs("tbody",{children:[a.jsx("tr",{children:a.jsx("td",{colSpan:2,style:{padding:12,background:"#f8fafc",fontWeight:800,color:"#0b3b57"},children:"Learner Centric Approach (LCA)"})}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"right",paddingRight:20,fontWeight:700},children:"L3"}),a.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"center",fontWeight:800}})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"right",paddingRight:20,fontWeight:700},children:"L2"}),a.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"center",fontWeight:800}})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"right",paddingRight:20,fontWeight:700},children:"L1"}),a.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"center",fontWeight:800}})]})]})})}),a.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:12,alignItems:"stretch"},children:[a.jsxs("div",{style:{width:"100%"},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:8,textAlign:"center",color:"#0b3b57"},children:"The Course Outcome Attainment Targets"}),a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",border:"2px solid #0b3b57"},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#e6f2ff",color:"#0b3b57"},children:"COs"}),a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#e6f8ff",color:"#0b4a6f"},children:"ICO"}),a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#e6f8ff",color:"#0b4a6f"},children:"BCO"}),a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#fde8f0",color:"#6b213f"},children:"ACO"}),a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#fde8f0",color:"#6b213f"},children:"API"}),a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#fde8f0",color:"#6b213f"},children:"IIC"}),a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#fff7d6",color:"#6b4a00"},children:"COs Targets"}),a.jsx("th",{style:{padding:10,background:"#fff7d6",color:"#6b4a00"},children:"CO TARGET IN 3 POINT SCALE"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderTop:"1px solid #e6eef8",background:"#f3f8ff",fontWeight:700},children:"Weight Values"}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:In.inputNumber,type:"number",value:S.ico,onChange:G=>j(H=>({...H,ico:Number(G.target.value||0)})),onBlur:G=>j(H=>({...H,ico:M(G.target.value,2,!1)}))})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:In.inputNumber,type:"number",value:S.bco,onChange:G=>j(H=>({...H,bco:Number(G.target.value||0)})),onBlur:G=>j(H=>({...H,bco:M(G.target.value,2,!1)}))})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:In.inputNumber,type:"number",value:S.aco,onChange:G=>j(H=>({...H,aco:Number(G.target.value||0)})),onBlur:G=>j(H=>({...H,aco:M(G.target.value,2,!1)}))})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:In.inputNumber,type:"number",value:S.api,onChange:G=>j(H=>({...H,api:Number(G.target.value||0)})),onBlur:G=>j(H=>({...H,api:M(G.target.value,2,!1)}))})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:In.inputNumber,type:"number",value:S.iic,onChange:G=>j(H=>({...H,iic:Number(G.target.value||0)})),onBlur:G=>j(H=>({...H,iic:M(G.target.value,2,!1)}))})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"}}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"}})]}),["CO-1","CO-2","CO-3","CO-4","CO-5"].map((G,H)=>{var oe,de,W,V,ae;return a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb",textAlign:"left",fontWeight:700},children:G}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:B&&B[H]?B[H].ico.toFixed(2)+"%":""}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:E[H]??""}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:In.inputNumber,type:"number",value:((oe=k[H])==null?void 0:oe.aco)??"",onChange:ee=>{const C=ee.target.value===""?null:ee.target.value;A(Y=>{const q=[...Y];return q[H]={...q[H],aco:C===null?null:Number(C)},q})},onBlur:ee=>{const C=M(ee.target.value,2,!0);A(Y=>{const q=[...Y];return q[H]={...q[H],aco:C},q})}})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:In.inputNumber,type:"number",value:((de=k[H])==null?void 0:de.api)??"",onChange:ee=>{const C=ee.target.value===""?null:ee.target.value;A(Y=>{const q=[...Y];return q[H]={...q[H],api:C===null?null:Number(C)},q})},onBlur:ee=>{const C=M(ee.target.value,2,!0);A(Y=>{const q=[...Y];return q[H]={...q[H],api:C},q})}})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:In.inputNumber,type:"number",value:((W=k[H])==null?void 0:W.iic)??"",onChange:ee=>{const C=ee.target.value===""?null:ee.target.value;A(Y=>{const q=[...Y];return q[H]={...q[H],iic:C===null?null:Number(C)},q})},onBlur:ee=>{const C=M(ee.target.value,2,!0);A(Y=>{const q=[...Y];return q[H]={...q[H],iic:C},q})}})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:((V=P[H])==null?void 0:V.weightedRounded)??""}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:((ae=P[H])==null?void 0:ae.final)??""})]},G)})]})]})]}),a.jsx("div",{style:{width:"100%",background:"#86efac",padding:12,borderRadius:6,border:"2px solid #16a34a",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",fontWeight:700},children:"TARGET TABLE WILL BE GENERATED AUTOMATICALLY"})]})]})]})]})]})]})})}const on={page:{padding:28,maxWidth:1100,margin:"18px auto",fontFamily:"Inter, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial",color:"#1f3947"},card:{background:"#fff",borderRadius:12,padding:18,border:"1px solid #e6eef8",boxShadow:"0 6px 20px rgba(13,60,100,0.04)"},header:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:12,marginBottom:18},titleBlock:{display:"flex",flexDirection:"column"},title:{margin:0,color:"#0b4a6f",fontSize:22,fontWeight:700},subtitle:{marginTop:6,color:"#3d5566",fontSize:13},grid:{display:"grid",gap:16},sectionTitle:{margin:"0 0 10px 0",color:"#0b3b57",fontSize:16},paragraph:{color:"#334e68",lineHeight:1.45,margin:0},table:{width:"100%",borderCollapse:"collapse",marginTop:8},th:{background:"#f3f8ff",color:"#0b4a6f",fontWeight:700,padding:"8px 10px",border:"1px solid #e6eef8",textAlign:"center",fontSize:13},td:{padding:"8px 10px",border:"1px solid #eef6fb",color:"#234451",fontSize:13,textAlign:"center"},note:{color:"#6b8190",fontSize:13},kv:{background:"#fbfdff",padding:10,borderRadius:8,border:"1px solid #e9f3fb",minWidth:160},kvLabel:{fontSize:12,color:"#557085",marginBottom:6},kvValue:{fontWeight:700,color:"#0b4a6f"}};function GPe({title:e,columns:t,rows:r}){return a.jsxs("div",{children:[e&&a.jsx("div",{style:on.sectionTitle,children:e}),a.jsxs("table",{style:on.table,children:[a.jsx("thead",{children:a.jsx("tr",{children:t.map(n=>a.jsx("th",{style:on.th,children:n},n))})}),a.jsx("tbody",{children:r.map((n,i)=>a.jsx("tr",{children:n.map((s,o)=>a.jsx("td",{style:on.td,children:s},o))},i))})]})]})}function PK({courseCode:e,courseName:t,initialTab:r,viewerMode:n}){const i=x.useMemo(()=>e?String(e):"",[e]);vo();const[s,o]=x.useState(r||"instructions");x.useEffect(()=>{r&&o(r)},[r]);const l=[{key:"instructions",label:"LCA Instructions"},{key:"lca",label:"LCA"},{key:"cdap",label:"CDAP"},{key:"articulation",label:"Articulation Matrix"},{key:"cotarget",label:"CO Target"}],c={display:"flex",gap:8,flexWrap:"wrap",marginBottom:12},u=(d,f)=>{const h=s===d,p=()=>{if(d==="cotarget"){o(d);return}o(d)};return a.jsx("button",{onClick:p,style:{padding:"8px 12px",borderRadius:8,border:h?"2px solid #0b4a6f":"1px solid #e6eef8",background:h?"#0b4a6f":"#fbfdff",color:h?"#fff":"#0b4a6f",fontWeight:700,cursor:"pointer"},children:f},f)};return a.jsx("div",{style:on.page,children:a.jsxs("div",{style:{...on.card},children:[a.jsx("div",{style:on.header,children:a.jsxs("div",{style:on.titleBlock,children:[a.jsx("h2",{style:on.title,children:"Learner Centric Approach  Instructions"}),a.jsx("div",{style:on.subtitle,children:"Default LCA planning matrix and instruction-level guidance for course design and assessment."})]})}),a.jsxs("div",{style:{padding:12},children:[a.jsx("div",{style:c,children:l.map(d=>u(d.key,d.label))}),a.jsx("div",{style:{display:"flex",justifyContent:"flex-start",gap:12,flexWrap:"wrap",marginBottom:12},children:a.jsxs("div",{style:on.kv,children:[a.jsx("div",{style:on.kvLabel,children:"Course"}),a.jsx("div",{style:on.kvValue,children:(e||"")+(t?`  ${t}`:"")})]})}),s==="instructions"&&a.jsxs("div",{style:on.grid,children:[a.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:16,alignItems:"start"},children:a.jsxs("div",{style:{...on.card,padding:14,gridColumn:"1 / -1"},children:[a.jsx("div",{style:on.sectionTitle,children:"Overview"}),a.jsx("p",{style:on.paragraph,children:"Use this page to map learner profiles (L1L3) to instruction levels (IL-1..IL-3) and to define assessment distribution. The tables below provide recommended mappings and a sample distribution for course planning."}),a.jsx("div",{style:{marginTop:12},children:a.jsx(GPe,{title:"Learner Profile  Quick Guide",columns:["Profile","Description"],rows:[["L1","Lower CGPA / limited prerequisites"],["L2","Average preparedness"],["L3","High CGPA / strong prerequisites"]]})})]})}),a.jsxs("div",{style:{...on.card,padding:14},children:[a.jsx("div",{style:on.sectionTitle,children:"Instruction Steps (recommended)"}),a.jsxs("ol",{style:{margin:0,paddingLeft:18,color:"#334e68"},children:[a.jsx("li",{style:{marginBottom:8},children:"Identify learner profile (L1 / L2 / L3) for the target offering."}),a.jsx("li",{style:{marginBottom:8},children:"Use IL mapping to determine instruction emphasis across IL-1..IL-3."}),a.jsx("li",{style:{marginBottom:8},children:"Apply distribution when preparing teaching plan and question banks (map PT / CO / BTL)."})]})]}),a.jsxs("div",{style:{display:"grid",gap:12},children:[a.jsxs("div",{style:{...on.card,padding:12},children:[a.jsx("div",{style:on.sectionTitle,children:"Sample Assessment Distribution by Learner Profile"}),a.jsxs("table",{style:on.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:on.th,children:"Learner Profile"}),a.jsx("th",{style:on.th,children:"IL-1 %"}),a.jsx("th",{style:on.th,children:"IL-2 %"}),a.jsx("th",{style:on.th,children:"IL-3 %"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:on.td,children:"L1"}),a.jsx("td",{style:on.td,children:"60"}),a.jsx("td",{style:on.td,children:"30"}),a.jsx("td",{style:on.td,children:"10"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:on.td,children:"L2"}),a.jsx("td",{style:on.td,children:"30"}),a.jsx("td",{style:on.td,children:"50"}),a.jsx("td",{style:on.td,children:"20"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:on.td,children:"L3"}),a.jsx("td",{style:on.td,children:"10"}),a.jsx("td",{style:on.td,children:"40"}),a.jsx("td",{style:on.td,children:"50"})]})]})]})]}),a.jsxs("div",{style:{...on.card,padding:12},children:[a.jsx("div",{style:on.sectionTitle,children:"Current Course  Example Breakdown"}),a.jsxs("table",{style:on.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:on.th,children:"Component"}),a.jsx("th",{style:on.th,children:"IL-1"}),a.jsx("th",{style:on.th,children:"IL-2"}),a.jsx("th",{style:on.th,children:"IL-3"}),a.jsx("th",{style:on.th,children:"Notes"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:on.td,children:"Teaching Hours"}),a.jsx("td",{style:on.td,children:"40%"}),a.jsx("td",{style:on.td,children:"40%"}),a.jsx("td",{style:on.td,children:"20%"}),a.jsx("td",{style:on.td,children:"Blend of lectures and labs"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:on.td,children:"Question Bank"}),a.jsx("td",{style:on.td,children:"50%"}),a.jsx("td",{style:on.td,children:"30%"}),a.jsx("td",{style:on.td,children:"20%"}),a.jsx("td",{style:on.td,children:"Adjust difficulty by profile"})]})]})]}),a.jsx("div",{style:{marginTop:10},children:a.jsx("div",{style:on.note,children:"Tip: Use these templates as starting points and adapt percentages to the specific cohort."})})]}),a.jsxs("div",{style:{...on.card,padding:12},children:[a.jsx("div",{style:on.sectionTitle,children:"IL Mapping"}),a.jsxs("table",{style:on.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:on.th,children:"IL"}),a.jsx("th",{style:on.th,children:"Instruction Focus"}),a.jsx("th",{style:on.th,children:"Typical Assessment Emphasis"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:on.td,children:"IL-1"}),a.jsx("td",{style:on.td,children:"Foundation, concepts, scaffolding"}),a.jsx("td",{style:on.td,children:"More formative; MCQ / guided tasks"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:on.td,children:"IL-2"}),a.jsx("td",{style:on.td,children:"Application and practice"}),a.jsx("td",{style:on.td,children:"Mixture of practical and theory"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:on.td,children:"IL-3"}),a.jsx("td",{style:on.td,children:"Advanced, synthesis, independent work"}),a.jsx("td",{style:on.td,children:"Problem-solving, projects, high-level questions"})]})]})]})]})]})]}),s==="lca"&&a.jsx("fieldset",{disabled:!!n,style:{border:0,padding:0,margin:0},children:i?a.jsx(VPe,{embedded:!0,courseId:i,courseCode:i,courseName:t??void 0}):a.jsxs("div",{style:{...on.card,padding:16},children:[a.jsx("div",{style:on.sectionTitle,children:"LCA"}),a.jsx("div",{style:on.paragraph,children:"Select a course to view the LCA worksheet."})]})}),s==="cdap"&&a.jsx("fieldset",{disabled:!!n,style:{border:0,padding:0,margin:0},children:i?a.jsx("div",{style:{...on.card,padding:12},children:a.jsx($Pe,{courseId:i,showHeader:!1,showCourseInput:!1})}):a.jsxs("div",{style:{...on.card,padding:16},children:[a.jsx("div",{style:on.sectionTitle,children:"CDAP"}),a.jsx("div",{style:on.paragraph,children:"Select a course to open CDAP."})]})}),s==="articulation"&&a.jsx("fieldset",{disabled:!!n,style:{border:0,padding:0,margin:0},children:i?a.jsx(MPe,{embedded:!0,courseId:i}):a.jsxs("div",{style:{...on.card,padding:16},children:[a.jsx("div",{style:on.sectionTitle,children:"Articulation Matrix"}),a.jsx("div",{style:on.paragraph,children:"Select a course to view the articulation matrix."})]})}),s==="cotarget"&&a.jsx("fieldset",{disabled:!!n,style:{border:0,padding:0,margin:0},children:i?a.jsx("div",{style:{...on.card,padding:12},children:a.jsx(TK,{embedded:!0,courseCode:i,courseName:t??void 0,onClose:()=>o("instructions")})}):a.jsxs("div",{style:{...on.card,padding:16},children:[a.jsx("div",{style:on.sectionTitle,children:"CO Target"}),a.jsx("div",{style:on.paragraph,children:"Select a course to view CO Targets."})]})})]})]})})}const KPe=[{key:"q1",label:"Q1",max:2,co:1,btl:1},{key:"q2",label:"Q2",max:2,co:1,btl:3},{key:"q3",label:"Q3",max:2,co:1,btl:4},{key:"q4",label:"Q4",max:2,co:2,btl:1},{key:"q5",label:"Q5",max:2,co:2,btl:1},{key:"q6",label:"Q6",max:2,co:2,btl:2},{key:"q7",label:"Q7",max:16,co:1,btl:2},{key:"q8",label:"Q8",max:16,co:2,btl:3},{key:"q9",label:"Q9",max:16,co:"1&2",btl:5}],YPe=[{key:"q1",label:"Q1",max:2,co:3,btl:1},{key:"q2",label:"Q2",max:2,co:3,btl:3},{key:"q3",label:"Q3",max:2,co:3,btl:4},{key:"q4",label:"Q4",max:2,co:4,btl:1},{key:"q5",label:"Q5",max:2,co:4,btl:1},{key:"q6",label:"Q6",max:2,co:4,btl:2},{key:"q7",label:"Q7",max:16,co:3,btl:2},{key:"q8",label:"Q8",max:16,co:4,btl:3},{key:"q9",label:"Q9",max:16,co:"3&4",btl:5}],gk=30,ax={co1:42,co2:42,co3:58,co4:42,co5:42},hN=[{key:"q1",max:2},{key:"q2",max:2},{key:"q3",max:2},{key:"q4",max:2},{key:"q5",max:2},{key:"q6",max:2},{key:"q7",max:2},{key:"q8",max:2},{key:"q9",max:2},{key:"q10",max:2},{key:"q11",max:14},{key:"q12",max:14},{key:"q13",max:14},{key:"q14",max:14},{key:"q15",max:14},{key:"q16",max:10}],OK=[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5,5],xk=hN.reduce((e,t,r)=>e+(OK[r]===5?t.max:0),0),BF=10;function XPe(e,t,r){if(t)return 5;const n=ni(e);return r.includes("model")&&(n==="THEORY"||n==="TCPL"||n==="TCPR")?5:4}function QPe(e){return Array.from({length:e},(t,r)=>r+1)}const am={ssa1:1.5,cia1:3,formative1:2.5},JPe={THEORY:{ssa1:1.5,cia1:3,formative1:2.5},TCPR:{ssa1:2,cia1:2.5,formative1:2},TCPL:{ssa1:1,cia1:2,formative1:3},LAB:{ssa1:1,cia1:1,formative1:1},PRACTICAL:{ssa1:1,cia1:1,formative1:1},SPECIAL:{ssa1:1.5,cia1:3,formative1:2.5},AUDIT:{ssa1:1.5,cia1:3,formative1:2.5}};function xv(e){if(!e)return am;const t=ni(e);return JPe[t]||am}function vi(e,t,r){return Math.max(t,Math.min(r,e))}function fs(e){return Math.round(e*10)/10}function Of(e){return Math.round(e*100)/100}function Gl(e){if(e===""||e==null)return null;const t=Number(e);return Number.isFinite(t)?t:null}function sx(e,t){const r=Array.isArray(e)?e:[],n=[];for(let i=0;i<t;i++){const s=r[i];if(s===""||s==null){n.push("");continue}const o=typeof s=="number"?s:Number(s);n.push(Number.isFinite(o)?o:"")}return n}function yv(e){const t=e.filter(r=>typeof r=="number"&&Number.isFinite(r));return t.length?t.reduce((r,n)=>r+n,0)/t.length:null}function yk(e){const t=typeof e=="number"?e:Number(e);if(!Number.isFinite(t))return null;const r=Math.trunc(t);return r>=1&&r<=6?r:null}function IF(e){if(e==="1&2"||e==="both")return"1&2";if(typeof e=="string"){const r=e.trim();if(r==="1&2"||r==="1,2"||r==="1/2"||r==="2/1")return"1&2";if(r==="2")return 2;if(r==="1")return 1}if(Array.isArray(e)){const r=e.map(n=>Number(n)).filter(n=>Number.isFinite(n));if(r.includes(1)&&r.includes(2))return"1&2";if(r.includes(2))return 2;if(r.includes(1))return 1}const t=Number(e);return t===2?2:t===12?"1&2":1}function DF(e){if(e==="3&4"||e==="both")return"3&4";if(typeof e=="string"){const r=e.trim();if(r==="3&4"||r==="3,4"||r==="3/4"||r==="4/3")return"3&4";if(r==="4")return 4;if(r==="3")return 3}if(Array.isArray(e)){const r=e.map(n=>Number(n)).filter(n=>Number.isFinite(n));if(r.includes(3)&&r.includes(4))return"3&4";if(r.includes(4))return 4;if(r.includes(3))return 3}const t=Number(e);return t===4?4:t===3?3:t===34?"3&4":3}function ZPe(e){return e==="1&2"?{co1:.5,co2:.5}:e===2?{co1:0,co2:1}:{co1:1,co2:0}}function $F(e,t){const r=e[t];if(!r)return{co1:0,co2:0};if(r.co==="1&2")return{co1:.5,co2:.5};const n=e.some(o=>o.co==="1&2"),i=t===e.length-1,s=String(r.key||"").toLowerCase()==="q9"||String(r.label||"").toLowerCase().includes("q9");return!n&&i&&s?{co1:.5,co2:.5}:ZPe(r.co)}function eOe(e){return e==="3&4"?{co3:.5,co4:.5}:e===4?{co3:0,co4:1}:{co3:1,co4:0}}function UF(e,t){const r=e[t];if(!r)return{co3:0,co4:0};if(r.co==="3&4")return{co3:.5,co4:.5};const n=e.some(o=>o.co==="3&4"),i=t===e.length-1,s=String(r.key||"").toLowerCase()==="q9"||String(r.label||"").toLowerCase().includes("q9");return!n&&i&&s?{co3:.5,co4:.5}:eOe(r.co)}function zF(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const o=r.localeCompare(n);if(o)return o}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim();return i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}function bv(e){const{ssaMark:t,ciaMark:r,f1Mark:n,ssaMax:i,ciaMax:s,f1Max:o,ssaW:l,ciaW:c,f1W:u,outOf:d}=e,f=[{mark:t,max:i,w:l},{mark:r,max:s,w:c},{mark:n,max:o,w:u}].filter(g=>Number(g.w||0)>0);if(!f.length||!d||!Number.isFinite(Number(d))||f.some(g=>g.mark==null)||f.some(g=>!g.max||!Number.isFinite(Number(g.max))))return null;const h=f.reduce((g,y)=>g+y.w,0);if(!h)return null;const m=f.reduce((g,y)=>g+y.mark/y.max*y.w,0)/h*d;return Number.isFinite(m)?vi(m,0,d):null}function MK({courseId:e,enabledAssessments:t,classType:r}){const[n,i]=x.useState(null),[s,o]=x.useState(r??null),l=x.useMemo(()=>Array.isArray(t),[t]),c=x.useMemo(()=>{const Me=Array.isArray(t)?t:[];return new Set(Me.map(qe=>String(qe||"").trim().toLowerCase()).filter(Boolean))},[t]),u=x.useMemo(()=>c.has("model"),[c]),[d,f]=x.useState(null),[h,p]=x.useState(null),m=x.useMemo(()=>l||Kre(s),[l,s]),g=x.useMemo(()=>({ssa1:!m||c.has("ssa1"),ssa2:!m||c.has("ssa2"),formative1:!m||c.has("formative1"),formative2:!m||c.has("formative2"),cia1:!m||c.has("cia1"),cia2:!m||c.has("cia2"),model:!m||c.has("model")}),[m,c]),y=x.useMemo(()=>C3(s)&&!l,[s,l]),b=x.useMemo(()=>ni(s)==="TCPL",[s]),v=x.useMemo(()=>{const Me=ni(s);return(Me==="THEORY"||Me==="TCPL"||Me==="TCPR")&&!!g.model},[s,g.model]),w=x.useMemo(()=>{const Me=Object.entries(g).filter(([qe,ut])=>ut).map(([qe])=>qe);return XPe(s,y,Me)},[s,y,g]),S=x.useMemo(()=>QPe(w),[w]),[j,k]=x.useState([]),[A,R]=x.useState(null),[M,B]=x.useState(null);x.useEffect(()=>{if(!e||M==null||!u){f(null),p(null);return}let Me=!0;return(async()=>{try{const qe=await bS("model",String(e),Number(M));if(!Me)return;f(qe),p(null)}catch(qe){if(!Me)return;f(null),p((qe==null?void 0:qe.message)||"Failed to fetch MODEL publish status")}})(),()=>{Me=!1}},[e,M,u]);const[E,P]=x.useState(!1),[U,G]=x.useState(null),[H,oe]=x.useState([]),[de,W]=x.useState(!1),[V,ae]=x.useState(null),[ee,C]=x.useState({ssa1:{},ssa2:{},f1:{},f2:{},cia1:null,cia2:null}),[Y,q]=x.useState({}),[O,X]=x.useState({cia1:null,cia2:null,model:null}),[F,Q]=x.useState({lab1:null,lab2:null}),K=x.useMemo(()=>`co_attainment_cfg_${e}`,[e]),[ne,re]=x.useState(!1),[T,I]=x.useState(()=>({ssa1:am.ssa1,cia1:am.cia1,formative1:am.formative1})),[ie,D]=x.useState(BF),Z=!!(u&&d&&d.is_published);x.useEffect(()=>{v&&D(Z?30:BF)},[v,Z]);const[me,Te]=x.useState("default"),je=sn.useRef(null),Le=sn.useRef(null),[_e,He]=x.useState(null),[We,Pt]=x.useState(null),[dt,Ye]=x.useState(null),[lt,be]=x.useState(!1),[ke,ce]=x.useState(!1),[we,ht]=x.useState({});x.useEffect(()=>{try{const Me=localStorage.getItem("roles"),qe=localStorage.getItem("permissions"),ut=Me?JSON.parse(Me):[],wt=qe?JSON.parse(qe):[],At=Array.isArray(ut)?ut.map(se=>String(se||"").toUpperCase()):[],sr=Array.isArray(wt)?wt.map(se=>String(se||"").toLowerCase()):[],Zt=At.includes("IQAC"),Cr=sr.includes("obe.master.manage");re(Zt||Cr)}catch{re(!1)}},[]),x.useEffect(()=>{let Me=!0;const qe=async ut=>{Me&&He("Loading IQAC weights");try{const At=await SS();if(!Me)return;if(At&&typeof At=="object"){const sr={...At};try{Object.defineProperty(sr,"__source",{value:"server",enumerable:!1})}catch{}je.current=sr,Ye(Object.keys(sr||{}).length||0),Pt(null),He(`Server weights loaded (${Object.keys(sr||{}).length} class-types)`);const Zt=ut??s;if(Zt){const Cr=ni(Zt),se=sr[Cr];if(se&&typeof se=="object"){const ue=xv(Zt);I({ssa1:Number.isFinite(Number(se.ssa1))?Number(se.ssa1):ue.ssa1,cia1:Number.isFinite(Number(se.cia1))?Number(se.cia1):ue.cia1,formative1:Number.isFinite(Number(se.formative1))?Number(se.formative1):ue.formative1}),Te("server"),He(`Applied server weights for ${Cr}`);return}else He(`Server weights loaded (${Object.keys(sr||{}).length} keys) but no entry for ${Cr}`)}}}catch(At){const sr=String((At==null?void 0:At.message)||At||"Unknown error");Pt(sr),He(`Server fetch failed: ${sr}`)}try{const At=Zn("iqac_class_type_weights");if(At&&typeof At=="object"){const sr={...At};try{Object.defineProperty(sr,"__source",{value:"local",enumerable:!1})}catch{}je.current=sr,Ye(Object.keys(sr||{}).length||0);const Zt=ut??s;if(Zt){const Cr=ni(Zt),se=sr[Cr];if(se&&typeof se=="object"){const ue=xv(Zt);I({ssa1:Number.isFinite(Number(se.ssa1))?Number(se.ssa1):ue.ssa1,cia1:Number.isFinite(Number(se.cia1))?Number(se.cia1):ue.cia1,formative1:Number.isFinite(Number(se.formative1))?Number(se.formative1):ue.formative1}),Te("local"),He(`Applied local weights for ${Cr}`);return}else He(`Local weights loaded (${Object.keys(sr||{}).length} keys) but no entry for ${Cr}`)}}}catch(At){const sr=String((At==null?void 0:At.message)||At||"Unknown error");Pt(sr),He(`Local weights read failed: ${sr}`)}const wt=ut??s;if(wt){const At=xv(wt);I(At),Te("default"),He(`Applied class-type defaults for ${ni(wt)}`)}else I(am),Te("default"),He("Applied general defaults (no class type detected)")};return qe(),Le.current=qe,()=>{Me=!1}},[s]),x.useEffect(()=>{try{const Me=Le.current;typeof Me=="function"&&Me()}catch{}},[M]),x.useEffect(()=>{try{const Me=je.current;if(s&&Me&&typeof Me=="object"){const qe=ni(s),ut=Me[qe];if(ut&&typeof ut=="object"){const wt=xv(s);I({ssa1:Number.isFinite(Number(ut.ssa1))?Number(ut.ssa1):wt.ssa1,cia1:Number.isFinite(Number(ut.cia1))?Number(ut.cia1):wt.cia1,formative1:Number.isFinite(Number(ut.formative1))?Number(ut.formative1):wt.formative1}),Te(Me.__source==="server"?"server":"local"),He(`Applied cached mapping for ${qe}`),Pt(null)}}}catch{}},[s]),x.useEffect(()=>{let Me=!0;return(async()=>{try{const qe=await oc();if(!Me)return;i(qe||null)}catch{}})(),()=>{Me=!1}},[e]),x.useEffect(()=>{let Me=!0;return(async()=>{var qe;try{const ut=await hc();if(!Me)return;let wt=(ut||[]).filter(Zt=>Zt.subject_code===e);if(wt.length===0)try{const Zt=await mr(`/api/academics/teaching-assignments/?subject_code=${encodeURIComponent(String(e||""))}`);if(Zt.ok){const Cr=await Zt.json();wt=(Array.isArray(Cr.results)?Cr.results:Array.isArray(Cr)?Cr:Cr.items||[])||[]}}catch(Zt){console.warn("Server TA list fetch failed:",Zt)}k(wt),R(null);const At=Zn(`coAttainment_selectedTa_${e}`),sr=typeof At=="number"&&wt.some(Zt=>Zt.id===At)&&At||(((qe=wt[0])==null?void 0:qe.id)??null);B(sr)}catch(ut){if(!Me)return;k([]),B(null),R((ut==null?void 0:ut.message)||"Failed to load teaching assignments")}})(),()=>{Me=!1}},[e]),x.useEffect(()=>{!e||M==null||Kn(`coAttainment_selectedTa_${e}`,M)},[e,M]),x.useEffect(()=>{if(r){o(r);return}let Me=!0;return(async()=>{try{const qe=(j||[]).find(Cr=>Cr.id===M)||null,ut=(qe==null?void 0:qe.class_type)??null;if(ut){if(!Me)return;o(ut);return}const wt=qe==null?void 0:qe.elective_subject_id;if(wt&&!(qe!=null&&qe.section_id)){console.log("[COAttainment] Detected elective TA, fetching elective subject details for:",wt);try{const Cr=await mr(`/api/curriculum/elective-subjects/${wt}/`);if(Cr.ok){const se=await Cr.json(),ue=se==null?void 0:se.class_type;if(console.log("[COAttainment] Elective subject class_type:",ue),ue){if(!Me)return;o(ue);return}}else console.warn("[COAttainment] Elective subject API returned error:",Cr.status)}catch(Cr){console.warn("[COAttainment] Failed to fetch elective subject:",Cr)}}const At=qe==null?void 0:qe.curriculum_row_id;if(!At)try{const Cr=String(e).trim().toUpperCase(),se=await Sl();if(!Me)return;const ue=(se||[]).find(Ne=>String(Ne.course_code||"").trim().toUpperCase()===Cr),J=(ue==null?void 0:ue.class_type)??null;if(J){o(J);return}const pe=await Yd();if(!Me)return;const xe=(pe||[]).find(Ne=>String(Ne.course_code||"").trim().toUpperCase()===Cr);o((xe==null?void 0:xe.class_type)??null);return}catch{Me&&o(null);return}const sr=await A3(Number(At));if(!Me)return;const Zt=(sr==null?void 0:sr.class_type)??null;if(Zt){o(Zt);return}try{const Cr=String(e).trim().toUpperCase(),se=await Yd();if(!Me)return;const ue=(se||[]).find(J=>String(J.course_code||"").trim().toUpperCase()===Cr);o((ue==null?void 0:ue.class_type)??null)}catch{o(null)}}catch{Me&&o(null)}})(),()=>{Me=!1}},[j,M,r]),x.useEffect(()=>{Kn(K,{weights:T})},[K,T]),x.useEffect(()=>{let Me=!0;return(async()=>{if(M){P(!0),G(null);try{const ut=(j||[]).find(At=>At.id===M)||null,wt=[];if(ut&&ut.elective_subject_id&&!ut.section_id){const At=ut.elective_subject_id,sr=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(At))}`);if(!sr.ok)throw new Error(`Elective-choices fetch failed: ${sr.status}`);const Zt=await sr.json();if(!Me)return;const se=((Array.isArray(Zt.results)?Zt.results:Array.isArray(Zt)?Zt:Zt.items||[])||[]).map(ue=>({id:Number(ue.student_id??ue.id),reg_no:String(ue.reg_no??ue.registration_no??ue.regno??""),name:String(ue.name??ue.full_name??ue.username??ue.student_name??""),section:ue.section_name??ue.section??null,section_id:ue.section_id??null}));if(!Me)return;oe(se.filter(ue=>Number.isFinite(ue.id)).sort(zF))}else{const At=await pc(M);if(!Me)return;const sr=(At.students||[]).map(Zt=>({id:Number(Zt.id),reg_no:String(Zt.reg_no??""),name:String(Zt.name??""),section:Zt.section??null})).filter(Zt=>Number.isFinite(Zt.id)).sort(zF);oe(sr)}}catch(ut){if(!Me)return;oe([]),G((ut==null?void 0:ut.message)||"Failed to load roster")}finally{Me&&P(!1)}}})(),()=>{Me=!1}},[M,j]);const nt=x.useMemo(()=>{var qe,ut;const Me=(ut=(qe=n==null?void 0:n.assessments)==null?void 0:qe.cia1)==null?void 0:ut.questions;return Array.isArray(Me)&&Me.length?Me.map(wt=>({key:String((wt==null?void 0:wt.key)||""),label:String((wt==null?void 0:wt.label)||(wt==null?void 0:wt.key)||""),max:Number((wt==null?void 0:wt.max)||0),co:IF(wt==null?void 0:wt.co),btl:Math.min(6,Math.max(1,Number((wt==null?void 0:wt.btl)||1)))})).filter(wt=>wt.key):KPe},[n]),Ie=x.useMemo(()=>{var qe,ut;const Me=(ut=(qe=n==null?void 0:n.assessments)==null?void 0:qe.cia2)==null?void 0:ut.questions;return Array.isArray(Me)&&Me.length?Me.map(wt=>({key:String((wt==null?void 0:wt.key)||""),label:String((wt==null?void 0:wt.label)||(wt==null?void 0:wt.key)||""),max:Number((wt==null?void 0:wt.max)||0),co:DF(wt==null?void 0:wt.co),btl:Math.min(6,Math.max(1,Number((wt==null?void 0:wt.btl)||1)))})).filter(wt=>wt.key):YPe},[n]),It=x.useMemo(()=>{let Me=0,qe=0;const ut=nt||[];return ut.forEach((wt,At)=>{const sr=$F(ut,At);Me+=(Number(wt.max)||0)*sr.co1,qe+=(Number(wt.max)||0)*sr.co2}),{co1:Me,co2:qe}},[nt]),ct=x.useMemo(()=>{let Me=0,qe=0;const ut=Ie||[];return ut.forEach((wt,At)=>{const sr=UF(ut,At);Me+=(Number(wt.max)||0)*sr.co3,qe+=(Number(wt.max)||0)*sr.co4}),{co3:Me,co4:qe}},[Ie]),Mt=x.useMemo(()=>{var De,Re,xt,Vt,qt,zt,vt,Lt,er,yr,Br,cr,ur,en,nn,gn,nr,Tr;const Me=((De=n==null?void 0:n.assessments)==null?void 0:De.ssa1)||{},qe=((Re=n==null?void 0:n.assessments)==null?void 0:Re.ssa2)||{},ut=((xt=n==null?void 0:n.assessments)==null?void 0:xt.formative1)||{},wt=((Vt=n==null?void 0:n.assessments)==null?void 0:Vt.formative2)||{},At=((qt=n==null?void 0:n.assessments)==null?void 0:qt.cia1)||{},sr=((zt=n==null?void 0:n.assessments)==null?void 0:zt.cia2)||{},Zt=Number((vt=Me==null?void 0:Me.coMax)==null?void 0:vt.co1),Cr=Number((Lt=Me==null?void 0:Me.coMax)==null?void 0:Lt.co2),se=Number(((er=qe==null?void 0:qe.coMax)==null?void 0:er.co3)??((yr=qe==null?void 0:qe.coMax)==null?void 0:yr.co1)),ue=Number(((Br=qe==null?void 0:qe.coMax)==null?void 0:Br.co4)??((cr=qe==null?void 0:qe.coMax)==null?void 0:cr.co2)),J=Number((ur=At==null?void 0:At.coMax)==null?void 0:ur.co1),pe=Number((en=At==null?void 0:At.coMax)==null?void 0:en.co2),xe=Number(((nn=sr==null?void 0:sr.coMax)==null?void 0:nn.co3)??((gn=sr==null?void 0:sr.coMax)==null?void 0:gn.co1)),Ne=Number(((nr=sr==null?void 0:sr.coMax)==null?void 0:nr.co4)??((Tr=sr==null?void 0:sr.coMax)==null?void 0:Tr.co2)),St=Number(ut==null?void 0:ut.maxCo),Ve=Number(wt==null?void 0:wt.maxCo);return{ssa1:{co1:Number.isFinite(Zt)?Math.max(0,Zt):10,co2:Number.isFinite(Cr)?Math.max(0,Cr):10},ssa2:{co3:Number.isFinite(se)?Math.max(0,se):10,co4:Number.isFinite(ue)?Math.max(0,ue):10},cia1:{co1:Number.isFinite(J)?Math.max(0,J):It.co1,co2:Number.isFinite(pe)?Math.max(0,pe):It.co2},cia2:{co3:Number.isFinite(xe)?Math.max(0,xe):ct.co3,co4:Number.isFinite(Ne)?Math.max(0,Ne):ct.co4},f1:{co1:Number.isFinite(St)?Math.max(0,St):10,co2:Number.isFinite(St)?Math.max(0,St):10},f2:{co3:Number.isFinite(Ve)?Math.max(0,Ve):10,co4:Number.isFinite(Ve)?Math.max(0,Ve):10}}},[n,It,ct]),xr=x.useMemo(()=>{if(!y)return null;const Me=ax.co1,qe=ax.co2,ut=ax.co3,wt=ax.co4,At=ax.co5;return{co1:Me,co2:qe,co3:ut,co4:wt,co5:At,total:fs(Me+qe+ut+wt+At)}},[y]),Pr=async()=>{W(!0),ae(null);const Me=typeof M=="number"?M:void 0;try{if(q({}),Q({lab1:null,lab2:null}),y){let qe=null,ut=null,wt=null;try{qe=await Ys("cia1",e,Me)}catch(At){q(sr=>({...sr,lab_cia1:String((At==null?void 0:At.message)||At)}))}try{ut=await Ys("cia2",e,Me)}catch(At){q(sr=>({...sr,lab_cia2:String((At==null?void 0:At.message)||At)}))}try{wt=await Im(e,Me)}catch(At){q(sr=>({...sr,lab_model:String((At==null?void 0:At.message)||At)}))}X({cia1:(qe==null?void 0:qe.data)??null,cia2:(ut==null?void 0:ut.data)??null,model:(wt==null?void 0:wt.data)??null});try{if(!(qe!=null&&qe.data))try{const At=await ri("cia1",e,Me);At&&At.draft&&X(sr=>({...sr,cia1:At.draft.data??At.draft}))}catch(At){q(sr=>({...sr,lab_cia1_draft:String((At==null?void 0:At.message)||At)}))}if(!(ut!=null&&ut.data))try{const At=await ri("cia2",e,Me);At&&At.draft&&X(sr=>({...sr,cia2:At.draft.data??At.draft}))}catch(At){q(sr=>({...sr,lab_cia2_draft:String((At==null?void 0:At.message)||At)}))}if(!(wt!=null&&wt.data))try{const At=await ri("model",e,Me);At&&At.draft&&X(sr=>({...sr,model:At.draft.data??At.draft}))}catch(At){q(sr=>({...sr,lab_model_draft:String((At==null?void 0:At.message)||At)}))}}catch{}}if(y)C({ssa1:{},ssa2:{},f1:{},f2:{},cia1:null,cia2:null});else{const qe=ni(s)==="TCPL";let ut=null,wt=null,At=null,sr=null,Zt=null,Cr=null,se=null,ue=null;if(g.ssa1)try{ut=await ag(e,Me)}catch(J){q(pe=>({...pe,ssa1:String((J==null?void 0:J.message)||J)}))}if(g.ssa2)try{wt=await ey(e,Me)}catch(J){q(pe=>({...pe,ssa2:String((J==null?void 0:J.message)||J)}))}if(g.formative1)if(qe)try{Zt=await Ys("formative1",e,Me)}catch(J){q(pe=>({...pe,tcpl_lab1:String((J==null?void 0:J.message)||J)}))}else try{At=await kS(e,Me)}catch(J){q(pe=>({...pe,formative1:String((J==null?void 0:J.message)||J)}))}if(g.formative2)if(qe)try{Cr=await Ys("formative2",e,Me)}catch(J){q(pe=>({...pe,tcpl_lab2:String((J==null?void 0:J.message)||J)}))}else try{sr=await v0("formative2",e,Me)}catch(J){q(pe=>({...pe,formative2:String((J==null?void 0:J.message)||J)}))}if(g.cia1)try{se=await ty(e,Me)}catch(J){q(pe=>({...pe,cia1:String((J==null?void 0:J.message)||J)}))}if(g.cia2)try{ue=await w0("cia2",e,Me)}catch(J){q(pe=>({...pe,cia2:String((J==null?void 0:J.message)||J)}))}try{if(g.ssa1&&(!ut||!(ut.marks&&Object.keys(ut.marks||{}).length)))try{const J=await ri("ssa1",e,Me);J&&J.draft&&J.draft.marks&&(ut={marks:J.draft.marks})}catch(J){q(pe=>({...pe,ssa1_draft:String((J==null?void 0:J.message)||J)}))}if(g.ssa2&&(!wt||!(wt.marks&&Object.keys(wt.marks||{}).length)))try{const J=await ri("ssa2",e,Me);J&&J.draft&&J.draft.marks&&(wt={marks:J.draft.marks})}catch(J){q(pe=>({...pe,ssa2_draft:String((J==null?void 0:J.message)||J)}))}if(g.formative1){if(qe){if(!(Zt!=null&&Zt.data))try{const J=await ri("formative1",e,Me);J&&J.draft&&(Zt={data:J.draft.data??J.draft})}catch(J){q(pe=>({...pe,tcpl_lab1_draft:String((J==null?void 0:J.message)||J)}))}}else if(!At||!(At.marks&&Object.keys(At.marks||{}).length))try{const J=await ri("formative1",e,Me);J&&J.draft&&J.draft.marks&&(At={marks:J.draft.marks})}catch(J){q(pe=>({...pe,formative1_draft:String((J==null?void 0:J.message)||J)}))}}if(g.formative2){if(qe){if(!(Cr!=null&&Cr.data))try{const J=await ri("formative2",e,Me);J&&J.draft&&(Cr={data:J.draft.data??J.draft})}catch(J){q(pe=>({...pe,tcpl_lab2_draft:String((J==null?void 0:J.message)||J)}))}}else if(!sr||!(sr.marks&&Object.keys(sr.marks||{}).length))try{const J=await ri("formative2",e,Me);J&&J.draft&&J.draft.marks&&(sr={marks:J.draft.marks})}catch(J){q(pe=>({...pe,formative2_draft:String((J==null?void 0:J.message)||J)}))}}if(g.cia1&&(!se||!se.data))try{const J=await ri("cia1",e,Me);J&&J.draft&&(se={data:J.draft.data??J.draft})}catch(J){q(pe=>({...pe,cia1_draft:String((J==null?void 0:J.message)||J)}))}if(g.cia2&&(!ue||!ue.data))try{const J=await ri("cia2",e,Me);J&&J.draft&&(ue={data:J.draft.data??J.draft})}catch(J){q(pe=>({...pe,cia2_draft:String((J==null?void 0:J.message)||J)}))}}catch{}qe&&Q({lab1:(Zt==null?void 0:Zt.data)??null,lab2:(Cr==null?void 0:Cr.data)??null}),C({ssa1:ut!=null&&ut.marks&&typeof ut.marks=="object"?ut.marks:{},ssa2:wt!=null&&wt.marks&&typeof wt.marks=="object"?wt.marks:{},f1:!qe&&(At!=null&&At.marks)&&typeof At.marks=="object"?At.marks:{},f2:!qe&&(sr!=null&&sr.marks)&&typeof sr.marks=="object"?sr.marks:{},cia1:(se==null?void 0:se.data)??null,cia2:(ue==null?void 0:ue.data)??null})}}catch(qe){C({ssa1:{},ssa2:{},f1:{},f2:{},cia1:null,cia2:null}),X({cia1:null,cia2:null,model:null}),Q({lab1:null,lab2:null}),ae((qe==null?void 0:qe.message)||"Failed to load published marks")}finally{W(!1)}};x.useEffect(()=>{e&&Pr()},[e,M,y,g,s]),x.useEffect(()=>{const Me=qe=>{try{const ut=(qe==null?void 0:qe.detail)||{},wt=ut.subjectId,At=ut.assessment;if(!wt||String(wt)!==String(e)||At&&!["ssa1","formative1","cia1"].includes(String(At)))return;Pr()}catch{}};return window.addEventListener("obe:published",Me),()=>window.removeEventListener("obe:published",Me)},[e]);const Nt=x.useMemo(()=>{const Me=new Map;if(y){const Ve=gk/2,De=(qt,zt,vt)=>{const Lt=qt!=null&&qt.sheet&&typeof qt.sheet=="object"?qt.sheet:{},er=Lt!=null&&Lt.rowsByStudentId&&typeof Lt.rowsByStudentId=="object"?Lt.rowsByStudentId:{},yr=vi(Number((Lt==null?void 0:Lt.expCountA)??0),0,12),Br=vi(Number((Lt==null?void 0:Lt.expCountB)??0),0,12),cr=!!(Lt!=null&&Lt.coAEnabled),ur=!!(Lt!=null&&Lt.coBEnabled),en=!!(Lt!=null&&Lt.ciaExamEnabled),nn=Lt!=null&&Lt.coConfigs&&typeof Lt.coConfigs=="object"?Lt.coConfigs:null,gn=nn?nn[String(zt)]:null,nr=vt!=null&&nn?nn[String(vt)]:null,Tr=gn?!!gn.enabled:cr,Dr=vt!=null?nr?!!nr.enabled:ur:!1,Rr=gn?vi(Number(gn.expCount??0),0,12):yr,tt=vt!=null?nr?vi(Number(nr.expCount??0),0,12):Br:0,Xe=gn&&Number.isFinite(Number(gn.expMax))?Number(gn.expMax):Number.isFinite(Number(Lt==null?void 0:Lt.expMaxA))?Number(Lt.expMaxA):25,ot=vt!=null?nr&&Number.isFinite(Number(nr.expMax))?Number(nr.expMax):Number.isFinite(Number(Lt==null?void 0:Lt.expMaxB))?Number(Lt.expMaxB):25:0,Wt=Xe+(en?Ve:0),pr=vt!=null?ot+(en?Ve:0):0;return{get:br=>{const Je=er[String(br)]||{},Ht=Je!=null&&Je.marksByCo&&typeof Je.marksByCo=="object"?Je.marksByCo:{},it=(Ht==null?void 0:Ht[String(zt)])??Je.marksA,bt=vt!=null?(Ht==null?void 0:Ht[String(vt)])??Je.marksB:[],_t=sx(it,Rr).slice(0,Tr?Rr:0),Tt=sx(bt,tt).slice(0,Dr?tt:0),Dt=yv(_t),Gt=yv(Tt),$t=Je==null?void 0:Je.ciaExam,ze=typeof $t=="number"&&Number.isFinite($t)?$t:null,Ze=Dt!=null||Gt!=null||ze!=null,jt=Ze?(Dt??0)+(en?(ze??0)/2:0):null,Bt=Ze?(Gt??0)+(en?(ze??0)/2:0):null;return{a:jt==null?null:vi(jt,0,Wt),b:Bt==null?null:vi(Bt,0,pr)}},coA:zt,coB:vt,CO_MAX_A:Wt,CO_MAX_B:pr,expMaxA:Xe,expMaxB:ot,expCountA:Rr,expCountB:tt}},Re=De(O.cia1,1,2),xt=De(O.cia2,3,4),Vt=De(O.model,5,null);for(const qt of H){const zt=Re.get(qt.id),vt=xt.get(qt.id),Lt=Vt.get(qt.id);Me.set(qt.id,{co1:zt.a,co2:zt.b,co3:vt.a,co4:vt.b,co5:Lt.a,coMax1:Re.CO_MAX_A,coMax2:Re.CO_MAX_B,coMax3:xt.CO_MAX_A,coMax4:xt.CO_MAX_B,coMax5:Vt.CO_MAX_A})}return Me}const qe=ni(s)==="TCPL",ut=Ve=>{const De=Ve!=null&&Ve.sheet&&typeof Ve.sheet=="object"?Ve.sheet:{},Re=De!=null&&De.rowsByStudentId&&typeof De.rowsByStudentId=="object"?De.rowsByStudentId:{},xt=vi(Number((De==null?void 0:De.expCountA)??0),0,12),Vt=vi(Number((De==null?void 0:De.expCountB)??0),0,12),qt=Number.isFinite(Number(De==null?void 0:De.expMaxA))?Number(De.expMaxA):25,zt=Number.isFinite(Number(De==null?void 0:De.expMaxB))?Number(De.expMaxB):25,vt=(De==null?void 0:De.ciaExamEnabled)!==!1,Lt=gk/2,er=qt+(vt?Lt:0),yr=zt+(vt?Lt:0);return{get:cr=>{const ur=Re[String(cr)]||{},en=sx(ur==null?void 0:ur.marksA,xt),nn=sx(ur==null?void 0:ur.marksB,Vt),gn=yv(en),nr=yv(nn),Tr=ur==null?void 0:ur.ciaExam,Dr=typeof Tr=="number"&&Number.isFinite(Tr)?Tr:null,Rr=gn!=null||nr!=null||Dr!=null,tt=Rr?(gn??0)+(vt?(Dr??0)/2:0):null,Xe=Rr?(nr??0)+(vt?(Dr??0)/2:0):null;return{a:tt==null?null:vi(tt,0,er),b:Xe==null?null:vi(Xe,0,yr)}},CO_MAX_A:er,CO_MAX_B:yr}},wt=qe?ut(F.lab1):null,At=qe?ut(F.lab2):null,sr=(()=>{if(!v)return null;const Ve=String(M??"none"),De=ni(s),Re=[];De==="THEORY"?(Re.push(`model_theory_sheet_${e}_${Ve}`),Re.push(`model_theory_sheet_${e}_none`)):De==="TCPL"?(Re.push(`model_tcpl_sheet_${e}_${Ve}`),Re.push(`model_tcpl_sheet_${e}_none`)):De==="TCPR"&&(Re.push(`model_tcpr_sheet_${e}_${Ve}`),Re.push(`model_tcpr_sheet_${e}_none`)),Re.push(`model_sheet_${e}`);for(const xt of Re){const Vt=Zn(xt);if(Vt&&typeof Vt=="object")return Vt}return null})(),Zt=Ve=>{const De=ni(s),Re=sr&&typeof sr=="object"?sr:null,qt=De==="THEORY"?xk:0;if(!v)return{mark:null,max:qt};if(!Re)return{mark:null,max:qt};let zt=qt;const vt=`id:${String(Ve.id)}`,Lt=Ve.reg_no?`reg:${String(Ve.reg_no).trim()}`:"",er=Re[vt]||(Lt?Re[Lt]:null)||null;if(!er||typeof er!="object")return{mark:null,max:zt};const yr=!!er.absent,Br=String(er.absentKind||"AL").toUpperCase(),cr=er.q&&typeof er.q=="object"?er.q:{};let ur=!1,en=0;if(zt=0,De==="THEORY"){zt=xk;for(let nn=0;nn<hN.length;nn++){const gn=hN[nn],nr=cr[gn.key],Tr=Gl(nr);if(Tr==null)continue;ur=!0;const Dr=vi(Tr,0,gn.max);OK[nn]===5&&(en+=Dr)}}else if(De==="TCPL"||De==="TCPR"){const nn=De==="TCPR",gn=nn?12:15,nr=nn?8:10,Tr=nn?[1,1,2,2,3,3,4,4,1,2,3,4]:[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5];for(let tt=0;tt<gn;tt++){const Xe=tt+1,ot=`q${Xe}`,Wt=Xe<=nr?2:16,pr=Tr[tt]??1;pr===5&&(zt+=Wt);const Nr=cr[ot],br=Gl(Nr);if(br==null)continue;ur=!0;const Je=vi(br,0,Wt);pr===5&&(en+=Je)}const Dr=Gl(er.lab);Dr!=null&&(ur=!0);const Rr=Dr==null?null:vi(Dr,0,30);nn?(zt+=30,Rr!=null&&(en+=Rr)):(zt+=30/5,Rr!=null&&(en+=Rr/5))}return ur?yr&&Br==="AL"?{mark:0,max:zt}:{mark:vi(en,0,zt),max:zt}:yr&&Br==="AL"?{mark:0,max:zt}:{mark:null,max:zt}},Cr=ee.f1&&typeof ee.f1=="object"?ee.f1:{},se=ee.f2&&typeof ee.f2=="object"?ee.f2:{},ue=ee.cia1&&typeof ee.cia1=="object"?ee.cia1:null,J=Array.isArray(ue==null?void 0:ue.questions)?ue.questions.map(Ve=>({key:String((Ve==null?void 0:Ve.key)||""),label:String((Ve==null?void 0:Ve.label)||(Ve==null?void 0:Ve.key)||""),max:Number((Ve==null?void 0:Ve.max)||0),co:IF(Ve==null?void 0:Ve.co),btl:Math.min(6,Math.max(1,Number((Ve==null?void 0:Ve.btl)||1)))})).filter(Ve=>Ve.key):nt,pe=ue!=null&&ue.rowsByStudentId&&typeof ue.rowsByStudentId=="object"?ue.rowsByStudentId:{},xe=ee.cia2&&typeof ee.cia2=="object"?ee.cia2:null,Ne=Array.isArray(xe==null?void 0:xe.questions)?xe.questions.map(Ve=>({key:String((Ve==null?void 0:Ve.key)||""),label:String((Ve==null?void 0:Ve.label)||(Ve==null?void 0:Ve.key)||""),max:Number((Ve==null?void 0:Ve.max)||0),co:DF(Ve==null?void 0:Ve.co),btl:Math.min(6,Math.max(1,Number((Ve==null?void 0:Ve.btl)||1)))})).filter(Ve=>Ve.key):Ie,St=xe!=null&&xe.rowsByStudentId&&typeof xe.rowsByStudentId=="object"?xe.rowsByStudentId:{};for(const Ve of H){const De=(ee.ssa1&&typeof ee.ssa1=="object"?ee.ssa1[String(Ve.id)]:null)??null,Re=De==null?null:Number(De)/2,xt=Re==null?null:vi(Re,0,Mt.ssa1.co1),Vt=Re==null?null:vi(Re,0,Mt.ssa1.co2),qt=(ee.ssa2&&typeof ee.ssa2=="object"?ee.ssa2[String(Ve.id)]:null)??null,zt=qt==null?null:Number(qt)/2,vt=zt==null?null:vi(zt,0,Mt.ssa2.co3),Lt=zt==null?null:vi(zt,0,Mt.ssa2.co4),er=qe&&wt?wt.get(Ve.id):null,yr=qe&&At?At.get(Ve.id):null,Br=Cr[String(Ve.id)]||{},cr=Gl(Br==null?void 0:Br.skill1),ur=Gl(Br==null?void 0:Br.skill2),en=Gl(Br==null?void 0:Br.att1),nn=Gl(Br==null?void 0:Br.att2),gn=qe?(er==null?void 0:er.a)??null:cr!=null&&en!=null?vi(cr+en,0,Mt.f1.co1):null,nr=qe?(er==null?void 0:er.b)??null:ur!=null&&nn!=null?vi(ur+nn,0,Mt.f1.co2):null,Tr=se[String(Ve.id)]||{},Dr=Gl(Tr==null?void 0:Tr.skill1),Rr=Gl(Tr==null?void 0:Tr.skill2),tt=Gl(Tr==null?void 0:Tr.att1),Xe=Gl(Tr==null?void 0:Tr.att2),ot=qe?(yr==null?void 0:yr.a)??null:Dr!=null&&tt!=null?vi(Dr+tt,0,Mt.f2.co3):null,Wt=qe?(yr==null?void 0:yr.b)??null:Rr!=null&&Xe!=null?vi(Rr+Xe,0,Mt.f2.co4):null,pr=pe[String(Ve.id)]||{},Nr=!!(pr!=null&&pr.absent),br=pr!=null&&pr.q&&typeof pr.q=="object"?pr.q:{};let Je=null,Ht=null;if(!Nr){let $t=0,ze=0,Ze=!1;J.forEach((jt,Bt)=>{const gr=br==null?void 0:br[jt.key],dr=Gl(gr);if(dr==null)return;Ze=!0;const Kt=vi(dr,0,Number(jt.max)||dr),ye=$F(J,Bt);$t+=Kt*ye.co1,ze+=Kt*ye.co2}),Ze&&(Je=vi($t,0,Mt.cia1.co1),Ht=vi(ze,0,Mt.cia1.co2))}const it=St[String(Ve.id)]||{},bt=!!(it!=null&&it.absent),_t=it!=null&&it.q&&typeof it.q=="object"?it.q:{};let Tt=null,Dt=null;if(!bt){let $t=0,ze=0,Ze=!1;Ne.forEach((jt,Bt)=>{const gr=_t==null?void 0:_t[jt.key],dr=Gl(gr);if(dr==null)return;Ze=!0;const Kt=vi(dr,0,Number(jt.max)||dr),ye=UF(Ne,Bt);$t+=Kt*ye.co3,ze+=Kt*ye.co4}),Ze&&(Tt=vi($t,0,Mt.cia2.co3),Dt=vi(ze,0,Mt.cia2.co4))}const Gt=v?Zt(Ve):{mark:null,max:0};Me.set(Ve.id,{ssaCo1:xt,ssaCo2:Vt,ssaCo3:vt,ssaCo4:Lt,ciaCo1:Je,ciaCo2:Ht,ciaCo3:Tt,ciaCo4:Dt,f1Co1:gn,f1Co2:nr,f2Co3:ot,f2Co4:Wt,modelCo5:Gt.mark,modelCo5Max:Gt.max})}return Me},[ee,O,F,H,Mt,nt,y,s,e,M,v]),Jr=x.useMemo(()=>{if(!b)return null;const Me=qe=>{const ut=qe!=null&&qe.sheet&&typeof qe.sheet=="object"?qe.sheet:{},wt=Number.isFinite(Number(ut==null?void 0:ut.expMaxA))?Number(ut.expMaxA):25,At=Number.isFinite(Number(ut==null?void 0:ut.expMaxB))?Number(ut.expMaxB):25,sr=(ut==null?void 0:ut.ciaExamEnabled)!==!1,Zt=gk/2;return{a:wt+(sr?Zt:0),b:At+(sr?Zt:0)}};return{lab1:Me(F.lab1),lab2:Me(F.lab2)}},[b,F]),Ur=x.useMemo(()=>{var J,pe,xe,Ne;const Me=b?((J=Jr==null?void 0:Jr.lab1)==null?void 0:J.a)??Mt.f1.co1:Mt.f1.co1,qe=b?((pe=Jr==null?void 0:Jr.lab1)==null?void 0:pe.b)??Mt.f1.co2:Mt.f1.co2,ut=b?((xe=Jr==null?void 0:Jr.lab2)==null?void 0:xe.a)??Mt.f2.co3:Mt.f2.co3,wt=b?((Ne=Jr==null?void 0:Jr.lab2)==null?void 0:Ne.b)??Mt.f2.co4:Mt.f2.co4,At=(g.ssa1?Mt.ssa1.co1:0)+(g.cia1?Mt.cia1.co1:0)+(g.formative1?Me:0),sr=(g.ssa1?Mt.ssa1.co2:0)+(g.cia1?Mt.cia1.co2:0)+(g.formative1?qe:0),Zt=(g.ssa2?Mt.ssa2.co3:0)+(g.cia2?Mt.cia2.co3:0)+(g.formative2?ut:0),Cr=(g.ssa2?Mt.ssa2.co4:0)+(g.cia2?Mt.cia2.co4:0)+(g.formative2?wt:0),se=v?ie:0,ue=At+sr+Zt+Cr+se;return{f1MaxCo1:Me,f1MaxCo2:qe,f2MaxCo3:ut,f2MaxCo4:wt,co1:At,co2:sr,co3:Zt,co4:Cr,co5:se,total:ue}},[b,Jr,Mt,g,v,ie]),qr=x.useMemo(()=>{if(y){const Ve=xr||{co1:55,co2:55,co3:55,co4:55,co5:55},De=(qt,zt)=>qt==null||!zt?null:fs(qt/zt*100),Re=(qt,zt)=>qt==null||!zt?null:Of(qt/zt*3),xt=[O.cia1,O.cia2,O.model].filter(Boolean),Vt=qt=>{const zt=[0,0,0,0,0,0,0],vt=[0,0,0,0,0,0,0];for(const er of xt){const yr=er!=null&&er.sheet&&typeof er.sheet=="object"?er.sheet:{},cr=(yr!=null&&yr.rowsByStudentId&&typeof yr.rowsByStudentId=="object"?yr.rowsByStudentId:{})[String(qt)]||{},ur=yr!=null&&yr.coConfigs&&typeof yr.coConfigs=="object"?yr.coConfigs:null,en=cr!=null&&cr.marksByCo&&typeof cr.marksByCo=="object"?cr.marksByCo:{},nn=!!(yr!=null&&yr.coAEnabled),gn=!!(yr!=null&&yr.coBEnabled),nr=vi(Number((yr==null?void 0:yr.expCountA)??0),0,12),Tr=vi(Number((yr==null?void 0:yr.expCountB)??0),0,12),Dr=Number.isFinite(Number(yr==null?void 0:yr.expMaxA))?Number(yr.expMaxA):25,Rr=Number.isFinite(Number(yr==null?void 0:yr.expMaxB))?Number(yr.expMaxB):25,tt=Array.isArray(yr==null?void 0:yr.btlA)?yr.btlA:[],Xe=Array.isArray(yr==null?void 0:yr.btlB)?yr.btlB:[],ot=(Wt,pr,Nr,br,Je,Ht)=>{if(!pr||Nr<=0||!br)return;const it=sx(Ht,Nr);for(let bt=0;bt<Nr;bt++){const _t=yk(Je[bt]),Tt=typeof it[bt]=="number"&&Number.isFinite(it[bt])?it[bt]:null;if(!_t||Tt==null)continue;const Dt=vi(Tt,0,br)*(10/br);zt[_t]+=Dt,vt[_t]+=1}};if(ur)for(const[Wt,pr]of Object.entries(ur)){const Nr=Number(Wt);if(!Number.isFinite(Nr)||!pr||typeof pr!="object")continue;const br=!!pr.enabled,Je=vi(Number(pr.expCount??0),0,12),Ht=Number.isFinite(Number(pr.expMax))?Number(pr.expMax):25,it=Array.isArray(pr.btl)?pr.btl:[],bt=(en==null?void 0:en[String(Nr)])??[];ot(Nr,br,Je,Ht,it,bt)}else ot(0,nn,nr,Dr,tt,cr.marksA),ot(0,gn,Tr,Rr,Xe,cr.marksB)}const Lt={};for(let er=1;er<=6;er++)Lt[`btl${er}`]=vt[er]?fs(zt[er]/vt[er]):null,Lt[`btl${er}Pct`]=vt[er]?fs(zt[er]/vt[er]/10*100):null;return Lt};return H.map((qt,zt)=>{const vt=Nt.get(qt.id)||{},Lt=typeof vt.co1=="number"?vt.co1:null,er=typeof vt.co2=="number"?vt.co2:null,yr=typeof vt.co3=="number"?vt.co3:null,Br=typeof vt.co4=="number"?vt.co4:null,cr=typeof vt.co5=="number"?vt.co5:null,ur=Vt(qt.id),en=[Lt,er,yr,Br,cr].every(nn=>typeof nn=="number")?fs(Lt+er+yr+Br+cr):null;return{sno:zt+1,...qt,co1:Lt,co1Pct:De(Lt,Ve.co1),co1_3pt:Re(Lt,Ve.co1),co2:er,co2Pct:De(er,Ve.co2),co2_3pt:Re(er,Ve.co2),co3:yr,co3Pct:De(yr,Ve.co3),co3_3pt:Re(yr,Ve.co3),co4:Br,co4Pct:De(Br,Ve.co4),co4_3pt:Re(Br,Ve.co4),co5:cr,co5Pct:De(cr,Ve.co5),co5_3pt:Re(cr,Ve.co5),...ur,total:en}})}const Me=g.ssa1?T.ssa1:0,qe=g.cia1?T.cia1:0,ut=g.formative1?T.formative1:0,wt=g.ssa2?T.ssa1:0,At=g.cia2?T.cia1:0,sr=g.formative2?T.formative1:0,{f1MaxCo1:Zt,f1MaxCo2:Cr,f2MaxCo3:se,f2MaxCo4:ue}=Ur,J=Ur.co1,pe=Ur.co2,xe=Ur.co3,Ne=Ur.co4,St=Ur.co5;return H.map((Ve,De)=>{const Re=Nt.get(Ve.id),xt=bv({ssaMark:(Re==null?void 0:Re.ssaCo1)??null,ciaMark:(Re==null?void 0:Re.ciaCo1)??null,f1Mark:(Re==null?void 0:Re.f1Co1)??null,ssaMax:Mt.ssa1.co1,ciaMax:Mt.cia1.co1,f1Max:Zt,ssaW:Me,ciaW:qe,f1W:ut,outOf:J}),Vt=bv({ssaMark:(Re==null?void 0:Re.ssaCo2)??null,ciaMark:(Re==null?void 0:Re.ciaCo2)??null,f1Mark:(Re==null?void 0:Re.f1Co2)??null,ssaMax:Mt.ssa1.co2,ciaMax:Mt.cia1.co2,f1Max:Cr,ssaW:Me,ciaW:qe,f1W:ut,outOf:pe}),qt=bv({ssaMark:(Re==null?void 0:Re.ssaCo3)??null,ciaMark:(Re==null?void 0:Re.ciaCo3)??null,f1Mark:(Re==null?void 0:Re.f2Co3)??null,ssaMax:Mt.ssa2.co3,ciaMax:Mt.cia2.co3,f1Max:se,ssaW:wt,ciaW:At,f1W:sr,outOf:xe}),zt=bv({ssaMark:(Re==null?void 0:Re.ssaCo4)??null,ciaMark:(Re==null?void 0:Re.ciaCo4)??null,f1Mark:(Re==null?void 0:Re.f2Co4)??null,ssaMax:Mt.ssa2.co4,ciaMax:Mt.cia2.co4,f1Max:ue,ssaW:wt,ciaW:At,f1W:sr,outOf:Ne}),vt=xt==null||!J?null:fs(xt/J*100),Lt=Vt==null||!pe?null:fs(Vt/pe*100),er=qt==null||!xe?null:fs(qt/xe*100),yr=zt==null||!Ne?null:fs(zt/Ne*100),Br=typeof(Re==null?void 0:Re.modelCo5)=="number"&&Number.isFinite(Re.modelCo5)?Re.modelCo5:null,cr=typeof(Re==null?void 0:Re.modelCo5Max)=="number"&&Number.isFinite(Re.modelCo5Max)?Math.max(0,Re.modelCo5Max):xk,ur=!v||Br==null||!cr||!St?null:vi(Br/cr*St,0,St),en=ur==null||!St?null:fs(ur/St*100),nn=xt==null||!J?null:Of(xt/J*3),gn=Vt==null||!pe?null:Of(Vt/pe*3),nr=qt==null||!xe?null:Of(qt/xe*3),Tr=zt==null||!Ne?null:Of(zt/Ne*3),Dr=ur==null||!St?null:Of(ur/St*3),Rr=[{enabled:J>0,v:xt},{enabled:pe>0,v:Vt},{enabled:xe>0,v:qt},{enabled:Ne>0,v:zt},...v?[{enabled:St>0,v:ur}]:[]];let tt=!1,Xe=!1,ot=0;for(const pr of Rr)if(pr.enabled){if(tt=!0,typeof pr.v!="number"||!Number.isFinite(pr.v)){Xe=!0;break}ot+=pr.v}const Wt=!tt||Xe?null:fs(ot);return{sno:De+1,...Ve,co1:xt,co1Pct:vt,co1_3pt:nn,co2:Vt,co2Pct:Lt,co2_3pt:gn,co3:qt,co3Pct:er,co3_3pt:nr,co4:zt,co4Pct:yr,co4_3pt:Tr,co5:ur,co5Pct:en,co5_3pt:Dr,total:Wt}})},[H,Nt,Mt,T,g,v,ie,Ur,y,xr,O]),cn=x.useMemo(()=>{if(y){const Zt=Cr=>{const se=qr.map(ue=>ue==null?void 0:ue[Cr]).filter(ue=>typeof ue=="number");return se.length?Of(se.reduce((ue,J)=>ue+J,0)/se.length):null};return{strength:H.length,co1Avg3pt:Zt("co1_3pt"),co2Avg3pt:Zt("co2_3pt"),co3Avg3pt:Zt("co3_3pt"),co4Avg3pt:Zt("co4_3pt"),co5Avg3pt:Zt("co5_3pt")}}const Me=qr.map(Zt=>Zt.co1_3pt).filter(Zt=>typeof Zt=="number"),qe=qr.map(Zt=>Zt.co2_3pt).filter(Zt=>typeof Zt=="number"),ut=qr.map(Zt=>Zt.co3_3pt).filter(Zt=>typeof Zt=="number"),wt=qr.map(Zt=>Zt.co4_3pt).filter(Zt=>typeof Zt=="number"),At=qr.map(Zt=>Zt.co5_3pt).filter(Zt=>typeof Zt=="number"),sr=Zt=>Zt.length?Of(Zt.reduce((Cr,se)=>Cr+se,0)/Zt.length):null;return{strength:H.length,co1Avg3pt:sr(Me),co2Avg3pt:sr(qe),co3Avg3pt:sr(ut),co4Avg3pt:sr(wt),...v?{co5Avg3pt:sr(At)}:{}}},[qr,H.length,y,v]),Pn=x.useMemo(()=>{const Me=Number(xr==null?void 0:xr.co1);return Number.isFinite(Me)&&Me>0?Me:55},[xr]),Lr=x.useMemo(()=>{if(!y)return{1:0,2:0,3:0,4:0,5:0,6:0};const Me={1:!1,2:!1,3:!1,4:!1,5:!1,6:!1},qe=[O.cia1,O.cia2,O.model].filter(Boolean);for(const ut of qe){const wt=ut!=null&&ut.sheet&&typeof ut.sheet=="object"?ut.sheet:{},At=vi(Number((wt==null?void 0:wt.expCountA)??0),0,12),sr=vi(Number((wt==null?void 0:wt.expCountB)??0),0,12),Zt=!!(wt!=null&&wt.coAEnabled),Cr=!!(wt!=null&&wt.coBEnabled),se=Array.isArray(wt==null?void 0:wt.btlA)?wt.btlA:[],ue=Array.isArray(wt==null?void 0:wt.btlB)?wt.btlB:[];if(Zt)for(let J=0;J<At;J++){const pe=yk(se[J]);pe&&(Me[pe]=!0)}if(Cr)for(let J=0;J<sr;J++){const pe=yk(ue[J]);pe&&(Me[pe]=!0)}}return{1:Me[1]?10:0,2:Me[2]?10:0,3:Me[3]?10:0,4:Me[4]?10:0,5:Me[5]?10:0,6:Me[6]?10:0}},[y,O]),mn={padding:"8px 10px",borderRadius:10,border:"1px solid #e5e7eb",width:90};return a.jsxs("div",{style:{display:"grid",gap:14},children:[(de||V)&&a.jsx("div",{style:{fontSize:12,color:V?"#b91c1c":"#6b7280"},children:de?"Loading published marks":V}),Y&&Object.keys(Y).length>0&&a.jsx("div",{style:{marginTop:6,fontSize:12},children:Object.entries(Y).map(([Me,qe])=>qe?a.jsxs("div",{style:{color:"#b91c1c"},children:[Me,": ",String(qe)]},Me):null)}),a.jsxs("div",{style:{padding:16,borderRadius:12,background:"linear-gradient(180deg,#ffffff, #f6fbff)",border:"1px solid #e6eef8",boxShadow:"0 6px 20px rgba(13, 60, 100, 0.06)"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:18,fontWeight:800,color:"#0b4a6f"},children:y?"CO Attainment (LAB)":"CO Attainment (Summative + Formative)"}),a.jsx("div",{style:{marginTop:6,color:"#264653",fontSize:13},children:y?"Uses published LAB sheets: CIA1 LAB (CO1/CO2) + CIA2 LAB (CO3/CO4) + MODEL LAB (CO5).":"Uses weighted blending per CO: SSA1 + CIA1 + Formative1 (based on your Excel formula)."})]}),a.jsx("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"flex-end"},children:a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"Teaching Assignment / Section"}),a.jsxs("select",{value:M??"",onChange:Me=>B(Me.target.value?Number(Me.target.value):null),style:{padding:"10px 12px",borderRadius:10,border:"1px solid #e5e7eb",minWidth:320},children:[a.jsx("option",{value:"",children:"Select"}),j.map(Me=>{const qe=Me.department,ut=(qe==null?void 0:qe.short_name)||(qe==null?void 0:qe.code)||(qe==null?void 0:qe.name)||Me.department_name||"",wt=Me.semester;return a.jsxs("option",{value:Me.id,children:[Me.section_name," ",wt?` Sem ${wt}`:""," ",Me.academic_year?` ${Me.academic_year}`:""," ",ut?` ${ut}`:""]},Me.id)})]})]})})]}),A&&a.jsx("div",{style:{marginTop:10,background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10},children:A}),y?a.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:12,marginTop:12},children:a.jsxs("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #e9f0f7",padding:12},children:[a.jsx("div",{style:{fontWeight:800,color:"#0b3b57",marginBottom:8},children:"LAB CO max"}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["CO max values are pulled from published LAB sheets only.",xr?a.jsx(a.Fragment,{children:S.map((Me,qe)=>{const ut=`co${Me}`;return a.jsxs(sn.Fragment,{children:[qe>0&&" | ","CO",Me,": ",a.jsx("b",{children:xr[ut]})]},Me)})}):a.jsxs(a.Fragment,{children:[" Each CO max is ",a.jsx("b",{children:Pn}),"."]})]}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Batch strength: ",a.jsx("b",{children:cn.strength}),S.map(Me=>{const qe=`co${Me}Avg3pt`;return a.jsxs(sn.Fragment,{children:["| CO",Me," avg (3pt): ",a.jsx("b",{children:cn[qe]??"-"})]},Me)})]})]})}):a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1.2fr 1fr",gap:12,marginTop:12},children:[a.jsxs("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #e9f0f7",padding:12},children:[a.jsx("div",{style:{fontWeight:800,color:"#0b3b57",marginBottom:8},children:"Max marks per CO (P4:P6)"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 120px 120px 120px",gap:8,alignItems:"center"},children:[a.jsx("div",{}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",fontWeight:700},children:"SSA1"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",fontWeight:700},children:"CIA1"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",fontWeight:700},children:"Formative1"}),a.jsx("div",{style:{fontSize:12,fontWeight:700},children:"CO1"}),a.jsx("div",{children:Mt.ssa1.co1}),a.jsx("div",{children:Mt.cia1.co1}),a.jsx("div",{children:Mt.f1.co1}),a.jsx("div",{style:{fontSize:12,fontWeight:700},children:"CO2"}),a.jsx("div",{children:Mt.ssa1.co2}),a.jsx("div",{children:Mt.cia1.co2}),a.jsx("div",{children:Mt.f1.co2})]}),a.jsx("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:S.filter(Me=>Me<=4||v).map((Me,qe)=>{const ut=`co${Me}`,wt=Me===5?ie:Ur[ut];return a.jsxs(sn.Fragment,{children:[qe>0&&a.jsx(a.Fragment,{children:"|"}),"CO",Me," total max: ",a.jsx("b",{children:wt})]},Me)})})]}),a.jsxs("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #e9f0f7",padding:12},children:[a.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[a.jsx("div",{style:{fontWeight:800,color:"#0b3b57",marginBottom:8},children:"Weights (R4:R6)"}),a.jsxs("div",{style:{fontSize:12,color:"#475569"},children:["Source: ",a.jsx("b",{children:me==="server"?"IQAC (server)":me==="local"?"IQAC (local)":"Defaults"})]})]}),_e&&a.jsx("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:_e}),We&&a.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#b91c1c"},children:["Weights load error: ",We]}),dt!=null&&a.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#475569"},children:["Known class-types on server/local: ",dt]}),a.jsx("div",{style:{marginTop:6},children:a.jsxs("button",{onClick:()=>be(Me=>!Me),style:{background:"transparent",border:"none",color:"#0b66a3",cursor:"pointer",padding:0,fontSize:12},children:[lt?"Hide":"Show"," raw IQAC mapping"]})}),lt&&a.jsx("pre",{style:{marginTop:8,maxHeight:220,overflow:"auto",background:"#0f1724",color:"#e6eef8",padding:10,borderRadius:8},children:JSON.stringify(je.current||{},null,2).slice(0,3200)}),a.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["SSA1",a.jsx("input",{type:"number",step:"0.1",value:T.ssa1,onChange:Me=>I(qe=>({...qe,ssa1:Number(Me.target.value)})),disabled:!ne,style:mn})]}),a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["CIA1",a.jsx("input",{type:"number",step:"0.1",value:T.cia1,onChange:Me=>I(qe=>({...qe,cia1:Number(Me.target.value)})),disabled:!ne,style:mn})]}),a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["Formative1",a.jsx("input",{type:"number",step:"0.1",value:T.formative1,onChange:Me=>I(qe=>({...qe,formative1:Number(Me.target.value)})),disabled:!ne,style:mn})]})]}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Batch strength: ",a.jsx("b",{children:cn.strength})," | CO1 avg (3pt): ",a.jsx("b",{children:cn.co1Avg3pt??"-"})," | CO2 avg (3pt): ",a.jsx("b",{children:cn.co2Avg3pt??"-"})]}),a.jsx("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:"Note: CIA1 CO marks are computed from the locally saved CIA1 question-wise sheet."})]})]}),a.jsx("div",{style:{marginTop:12},children:a.jsxs("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #e9f0f7",padding:12},children:[a.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[a.jsx("div",{style:{fontWeight:800,color:"#0b3b57",marginBottom:8},children:"Assessment Weights"}),a.jsxs("div",{style:{fontSize:12,color:"#475569"},children:["Class Type: ",a.jsx("b",{children:s||"Unknown"})," | Source: ",a.jsx("b",{children:me==="server"?"IQAC (server)":me==="local"?"IQAC (local)":"Defaults"})]})]}),_e&&a.jsx("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:_e}),We&&a.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#b91c1c"},children:["Weights load error: ",We]}),a.jsx("div",{style:{marginTop:6},children:a.jsxs("button",{onClick:()=>be(Me=>!Me),style:{background:"transparent",border:"none",color:"#0b66a3",cursor:"pointer",padding:0,fontSize:12},children:[lt?"Hide":"Show"," raw IQAC mapping"]})}),lt&&a.jsx("pre",{style:{marginTop:8,maxHeight:220,overflow:"auto",background:"#0f1724",color:"#e6eef8",padding:10,borderRadius:8},children:JSON.stringify(je.current||{},null,2).slice(0,3200)}),a.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap",marginTop:12},children:[a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["SSA1 Weight",a.jsx("input",{type:"number",step:"0.1",value:T.ssa1,onChange:Me=>I(qe=>({...qe,ssa1:Number(Me.target.value)})),disabled:!ne,style:mn})]}),a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["CIA1 Weight",a.jsx("input",{type:"number",step:"0.1",value:T.cia1,onChange:Me=>I(qe=>({...qe,cia1:Number(Me.target.value)})),disabled:!ne,style:mn})]}),a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["Formative1 Weight",a.jsx("input",{type:"number",step:"0.1",value:T.formative1,onChange:Me=>I(qe=>({...qe,formative1:Number(Me.target.value)})),disabled:!ne,style:mn})]}),v&&a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["CO5 Weightage (MODEL)",a.jsx("input",{type:"number",step:"1",value:ie,onChange:Me=>D(Number(Me.target.value)),disabled:!ne,style:mn})]})]}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["These weights determine how SSA1, CIA1, and Formative1 assessments contribute to CO attainment calculations.",!ne&&a.jsxs("span",{style:{color:"#059669",fontWeight:600},children:[" Values shown are appropriate defaults for ",s||"this"," class type."]})]})]})})]}),U&&a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10},children:U}),a.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:10},children:a.jsx("button",{onClick:()=>ce(!ke),style:{padding:"8px 16px",backgroundColor:ke?"#059669":"#0ea5e9",color:"#fff",border:"none",borderRadius:8,cursor:"pointer",fontWeight:600,fontSize:13},children:ke?"Show CO Columns":"Hide CO Columns"})}),E?a.jsx("div",{style:{color:"#6b7280"},children:"Loading roster"}):a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,overflow:"auto",background:"#fff"},children:y?a.jsxs("table",{style:{borderCollapse:"collapse",width:"100%",minWidth:2100},children:[a.jsxs("thead",{children:[a.jsxs("tr",{children:[a.jsx("th",{rowSpan:2,style:Ri,children:"S.No"}),a.jsx("th",{rowSpan:2,style:Ri,children:"Section"}),a.jsx("th",{rowSpan:2,style:Ri,children:"Register No"}),a.jsx("th",{rowSpan:2,style:Ri,children:"Name"}),!ke&&a.jsx(a.Fragment,{children:S.map(Me=>a.jsxs("th",{colSpan:3,style:Mf,children:["CO",Me]},`co${Me}`))}),a.jsx("th",{rowSpan:2,style:Ri,children:"CQI Entry"}),a.jsx("th",{colSpan:2,style:Mf,children:"BTL-1"}),a.jsx("th",{colSpan:2,style:Mf,children:"BTL-2"}),a.jsx("th",{colSpan:2,style:Mf,children:"BTL-3"}),a.jsx("th",{colSpan:2,style:Mf,children:"BTL-4"}),a.jsx("th",{colSpan:2,style:Mf,children:"BTL-5"}),a.jsx("th",{colSpan:2,style:Mf,children:"BTL-6"}),a.jsxs("th",{rowSpan:2,style:Ri,children:["Total / ",fs((xr==null?void 0:xr.total)??Pn*5)]})]}),a.jsxs("tr",{children:[!ke&&a.jsx(a.Fragment,{children:S.map(Me=>{const qe=`co${Me}`,ut=(xr==null?void 0:xr[qe])??Pn;return a.jsxs(sn.Fragment,{children:[a.jsx("th",{style:Ri,children:ut}),a.jsx("th",{style:Ri,children:"%"}),a.jsx("th",{style:Ri,children:"3pt"})]},`co${Me}-cells`)})}),a.jsx("th",{style:Ri,children:Lr[1]}),a.jsx("th",{style:Ri,children:"%"}),a.jsx("th",{style:Ri,children:Lr[2]}),a.jsx("th",{style:Ri,children:"%"}),a.jsx("th",{style:Ri,children:Lr[3]}),a.jsx("th",{style:Ri,children:"%"}),a.jsx("th",{style:Ri,children:Lr[4]}),a.jsx("th",{style:Ri,children:"%"}),a.jsx("th",{style:Ri,children:Lr[5]}),a.jsx("th",{style:Ri,children:"%"}),a.jsx("th",{style:Ri,children:Lr[6]}),a.jsx("th",{style:Ri,children:"%"})]})]}),a.jsx("tbody",{children:qr.map(Me=>a.jsxs("tr",{children:[a.jsx("td",{style:Di,children:Me.sno}),a.jsx("td",{style:Di,children:Me.section??""}),a.jsx("td",{style:Di,children:Me.reg_no}),a.jsx("td",{style:Di,children:Me.name}),!ke&&a.jsx(a.Fragment,{children:S.map(qe=>{const ut=`co${qe}`,wt=`co${qe}Pct`,At=`co${qe}_3pt`;return a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...Di,textAlign:"center"},children:Me[ut]==null?"":fs(Me[ut])}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Me[wt]==null?"":Me[wt]}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Me[At]==null?"":Me[At]})]},`co${qe}-row`)})}),a.jsx("td",{style:{...Di,textAlign:"center"},children:a.jsx("input",{type:"text",value:we[Me.id]||"",onChange:qe=>ht({...we,[Me.id]:qe.target.value}),style:{width:"100%",minWidth:100,padding:"4px 6px",border:"1px solid #d1d5db",borderRadius:4,fontSize:12},placeholder:"Enter CQI"})}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Me.btl1==null?"":fs(Me.btl1)}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Me.btl1Pct==null?"":Me.btl1Pct}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Me.btl2==null?"":fs(Me.btl2)}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Me.btl2Pct==null?"":Me.btl2Pct}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Me.btl3==null?"":fs(Me.btl3)}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Me.btl3Pct==null?"":Me.btl3Pct}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Me.btl4==null?"":fs(Me.btl4)}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Me.btl4Pct==null?"":Me.btl4Pct}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Me.btl5==null?"":fs(Me.btl5)}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Me.btl5Pct==null?"":Me.btl5Pct}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Me.btl6==null?"":fs(Me.btl6)}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Me.btl6Pct==null?"":Me.btl6Pct}),a.jsx("td",{style:{...Di,textAlign:"center",fontWeight:700},children:Me.total==null?"":Me.total})]},Me.id))})]}):a.jsxs("table",{style:{borderCollapse:"collapse",width:"100%",minWidth:980},children:[a.jsxs("thead",{children:[a.jsxs("tr",{children:[a.jsx("th",{rowSpan:2,style:Ri,children:"S.No"}),a.jsx("th",{rowSpan:2,style:Ri,children:"Section"}),a.jsx("th",{rowSpan:2,style:Ri,children:"Register No"}),a.jsx("th",{rowSpan:2,style:Ri,children:"Name"}),!ke&&a.jsx(a.Fragment,{children:S.map(Me=>Me===5&&!v?null:a.jsxs("th",{colSpan:3,style:Mf,children:["CO",Me]},`co${Me}`))}),a.jsx("th",{rowSpan:2,style:Ri,children:"CQI Entry"}),a.jsxs("th",{rowSpan:2,style:Ri,children:["Total / ",Ur.total]})]}),a.jsx("tr",{children:!ke&&a.jsx(a.Fragment,{children:S.map(Me=>{if(Me===5&&!v)return null;const qe=`co${Me}`,ut=Me===5?ie:Ur[qe];return a.jsxs(sn.Fragment,{children:[a.jsx("th",{style:Ri,children:ut}),a.jsx("th",{style:Ri,children:"%"}),a.jsx("th",{style:Ri,children:"3pt"})]},`co${Me}-cells`)})})})]}),a.jsx("tbody",{children:qr.map(Me=>a.jsxs("tr",{children:[a.jsx("td",{style:Di,children:Me.sno}),a.jsx("td",{style:Di,children:Me.section??""}),a.jsx("td",{style:Di,children:Me.reg_no}),a.jsx("td",{style:Di,children:Me.name}),!ke&&a.jsx(a.Fragment,{children:S.map(qe=>{if(qe===5&&!v)return null;const ut=`co${qe}`,wt=`co${qe}Pct`,At=`co${qe}_3pt`;return a.jsxs(sn.Fragment,{children:[a.jsx("td",{style:{...Di,textAlign:"center"},children:Me[ut]==null?"":fs(Me[ut])}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Me[wt]==null?"":Me[wt]}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Me[At]==null?"":Me[At]})]},`co${qe}-row`)})}),a.jsx("td",{style:{...Di,textAlign:"center"},children:a.jsx("input",{type:"text",value:we[Me.id]||"",onChange:qe=>ht({...we,[Me.id]:qe.target.value}),style:{width:"100%",minWidth:100,padding:"4px 6px",border:"1px solid #d1d5db",borderRadius:4,fontSize:12},placeholder:"Enter CQI"})}),a.jsx("td",{style:{...Di,textAlign:"center",fontWeight:700},children:Me.total==null?"":Me.total})]},Me.id))})]})})]})}const Ri={border:"1px solid #111827",padding:"8px 8px",background:"#f3f4f6",textAlign:"center",fontWeight:800,fontSize:12,whiteSpace:"nowrap"},Mf={...Ri,background:"#eaf2ff",color:"#0b4a6f"},Di={border:"1px solid #111827",padding:"7px 8px",fontSize:12,whiteSpace:"nowrap"},Ca=[1,2,3,4,5];function Ds(e){return`co${e}`}function fo(e){return{co1:e,co2:e,co3:e,co4:e,co5:e}}const tOe=[{key:"q1",label:"Q1",max:2,co:1,btl:1},{key:"q2",label:"Q2",max:2,co:1,btl:3},{key:"q3",label:"Q3",max:2,co:1,btl:4},{key:"q4",label:"Q4",max:2,co:2,btl:1},{key:"q5",label:"Q5",max:2,co:2,btl:1},{key:"q6",label:"Q6",max:2,co:2,btl:2},{key:"q7",label:"Q7",max:16,co:1,btl:2},{key:"q8",label:"Q8",max:16,co:2,btl:3},{key:"q9",label:"Q9",max:16,co:"1&2",btl:5}],kd={ssa1:1.5,cia1:3,formative1:2.5},bk=1.74;function Uu(e,t,r){return Math.max(t,Math.min(r,e))}function WF(e){return Math.round(e*100)/100}function vv(e){if(e===""||e==null)return null;const t=Number(e);return Number.isFinite(t)?t:null}function qF(e){const t=s=>!Number.isFinite(s)||s<1||s>5?null:s;if(e==null||e==="")return[1];if(Array.isArray(e)){const s=[];for(const o of e){const l=t(Number(o));l&&!s.includes(l)&&s.push(l)}return s.length?s:[1]}if(typeof e=="number")return[t(e)||1];const r=String(e).trim().toLowerCase();if(!r)return[1];if(r==="both")return[1,2];const n=r.replace(/[^0-9,\/\+&]+/g,"").split(/[,\/\+&]+/g).map(s=>s.trim()).filter(Boolean);if(n.length>1){const s=[];for(const o of n){const l=t(Number(o));l&&!s.includes(l)&&s.push(l)}return s.length?s:[1]}return r==="12"?[1,2]:[t(Number(r))||1]}function rOe(e){const t=fo(0),n=Array.from(new Set((e||[]).filter(Boolean))).filter(s=>Ca.includes(s)),i=n.length||1;for(const s of n.length?n:[1])t[Ds(s)]=1/i;return t}function HF(e,t){const r=e[t];if(!r)return fo(0);const n=qF(r.co),i=e.some(c=>qF(c.co).length>1),s=t===e.length-1,o=String(r.key||"").toLowerCase()==="q9"||String(r.label||"").toLowerCase().includes("q9");return rOe(!i&&s&&o?[1,2]:n)}function VF(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const o=r.localeCompare(n);if(o)return o}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim();return i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}function nOe(e){const{ssaMark:t,ciaMark:r,f1Mark:n,ssaMax:i,ciaMax:s,f1Max:o,ssaW:l,ciaW:c,f1W:u}=e;if(t==null||r==null||n==null||!i||!s||!o)return null;const d=l+c+u,f=i+s+o;if(!d||!f)return null;const p=(t/i*l+r/s*c+n/o*u)/d*f;return Number.isFinite(p)?Uu(p,0,f):null}function iOe({courseId:e}){const[t,r]=x.useState(null),n=x.useMemo(()=>`cqi_visible_cos_${e}`,[e]),[i,s]=x.useState(()=>{try{const I=Zn(`cqi_visible_cos_${e}`);if(Array.isArray(I)){const ie=I.map(Z=>Number(Z)).filter(Z=>Ca.includes(Z)),D=Array.from(new Set(ie));return D.length?D:[...Ca]}}catch{}return[...Ca]});x.useEffect(()=>{try{Kn(n,i)}catch{}},[n,i]);const[o,l]=x.useState(null);x.useMemo(()=>ni(o),[o]);const c=x.useMemo(()=>C3(o),[o]),[u,d]=x.useState([]),[f,h]=x.useState(null),[p,m]=x.useState(null),[g,y]=x.useState(!1),[b,v]=x.useState(null),[w,S]=x.useState([]),[j,k]=x.useState(!1),[A,R]=x.useState(null),[M,B]=x.useState({ssa:{},f1:{},cia:null}),[E,P]=x.useState({cia1:null}),[U,G]=x.useState(""),H=x.useMemo(()=>`co_attainment_cfg_${e}`,[e]),[oe,de]=x.useState(()=>{const I=Zn(`co_attainment_cfg_${e}`),ie=I==null?void 0:I.weights;return{ssa1:Number.isFinite(Number(ie==null?void 0:ie.ssa1))?Number(ie.ssa1):kd.ssa1,cia1:Number.isFinite(Number(ie==null?void 0:ie.cia1))?Number(ie.cia1):kd.cia1,formative1:Number.isFinite(Number(ie==null?void 0:ie.formative1))?Number(ie.formative1):kd.formative1}}),[W,V]=x.useState("default"),[ae,ee]=x.useState(null);x.useEffect(()=>{let I=!0;return(async()=>{try{const ie=await oc();if(!I)return;r(ie||null)}catch{}})(),()=>{I=!1}},[e]),x.useEffect(()=>{let I=!0;return(async()=>{var ie;try{const D=await hc();if(!I)return;const Z=(D||[]).filter(je=>je.subject_code===e);d(Z),h(null);const me=Zn(`coAttainment_selectedTa_${e}`),Te=typeof me=="number"&&Z.some(je=>je.id===me)&&me||(((ie=Z[0])==null?void 0:ie.id)??null);m(Te)}catch(D){if(!I)return;d([]),m(null),h((D==null?void 0:D.message)||"Failed to load teaching assignments")}})(),()=>{I=!1}},[e]),x.useEffect(()=>{!e||p==null||Kn(`coAttainment_selectedTa_${e}`,p)},[e,p]),x.useEffect(()=>{let I=!0;return(async()=>{try{const ie=(u||[]).find(je=>je.id===p)||null,D=String((ie==null?void 0:ie.class_type)||"").trim();if(D){I&&l(D);return}const Z=ie==null?void 0:ie.curriculum_row_id;if(!Z){I&&l(null);return}const me=await A3(Number(Z));if(!I)return;const Te=String((me==null?void 0:me.class_type)||"").trim();l(Te||null)}catch{I&&l(null)}})(),()=>{I=!1}},[p,u]),x.useEffect(()=>{let I=!0;return(async()=>{if(o){ee("Loading IQAC weights");try{const ie=await SS();if(!I)return;if(ie&&typeof ie=="object"){const D=ni(o),Z=ie[D];if(Z&&typeof Z=="object"){const me={ssa1:Number.isFinite(Number(Z.ssa1))?Number(Z.ssa1):kd.ssa1,cia1:Number.isFinite(Number(Z.cia1))?Number(Z.cia1):kd.cia1,formative1:Number.isFinite(Number(Z.formative1))?Number(Z.formative1):kd.formative1};de(me),V("server"),ee(`Applied server weights for ${D}`);try{Kn(H,{weights:me})}catch{}return}ee(`Server weights loaded but no entry for ${ni(o)}`)}}catch(ie){ee(`Server fetch failed: ${String((ie==null?void 0:ie.message)||ie)}`)}try{const ie=Zn("iqac_class_type_weights");if(ie&&typeof ie=="object"){const D=ni(o),Z=ie[D];if(Z&&typeof Z=="object"){const me={ssa1:Number.isFinite(Number(Z.ssa1))?Number(Z.ssa1):kd.ssa1,cia1:Number.isFinite(Number(Z.cia1))?Number(Z.cia1):kd.cia1,formative1:Number.isFinite(Number(Z.formative1))?Number(Z.formative1):kd.formative1};de(me),V("local"),ee(`Applied local weights for ${D}`);try{Kn(H,{weights:me})}catch{}return}}}catch(ie){ee(`Local read failed: ${String((ie==null?void 0:ie.message)||ie)}`)}}})(),()=>{I=!1}},[o,H]);const C=x.useMemo(()=>{var ie,D;const I=(D=(ie=t==null?void 0:t.assessments)==null?void 0:ie.cia1)==null?void 0:D.questions;return Array.isArray(I)&&I.length?I.map(Z=>({key:String((Z==null?void 0:Z.key)||""),label:String((Z==null?void 0:Z.label)||(Z==null?void 0:Z.key)||""),max:Number((Z==null?void 0:Z.max)||0),co:Z==null?void 0:Z.co,btl:Math.min(6,Math.max(1,Number((Z==null?void 0:Z.btl)||1)))})).filter(Z=>Z.key):tOe},[t]),Y=x.useMemo(()=>{const I=fo(0);return C.forEach((ie,D)=>{const Z=HF(C,D);for(const me of Ca)I[Ds(me)]+=(Number(ie.max)||0)*(Z[Ds(me)]||0)}),I},[C]),q=x.useMemo(()=>{var _e,He,We;const I=((_e=t==null?void 0:t.assessments)==null?void 0:_e.ssa1)||{},ie=((He=t==null?void 0:t.assessments)==null?void 0:He.formative1)||{},D=((We=t==null?void 0:t.assessments)==null?void 0:We.cia1)||{},Z=(Pt,dt)=>{var lt;const Ye=fo(0);for(const be of Ca){const ke=Ds(be),ce=Number((lt=Pt==null?void 0:Pt.coMax)==null?void 0:lt[ke]);Ye[ke]=Number.isFinite(ce)?Math.max(0,ce):dt[ke]}return Ye},me={...fo(0),co1:10,co2:10},Te=Number(ie==null?void 0:ie.maxCo),je={...fo(0),co1:Number.isFinite(Te)?Math.max(0,Te):10,co2:Number.isFinite(Te)?Math.max(0,Te):10},Le=Y;return{ssa:Z(I,me),cia:Z(D,Le),f1:Z(ie,je)}},[t,Y]),O=async()=>{k(!0),R(null);try{if(c){const I=await Ys("cia1",e);B({ssa:{},f1:{},cia:null}),P({cia1:(I==null?void 0:I.data)??null})}else{const[I,ie,D]=await Promise.all([ag(e),kS(e),ty(e)]);B({ssa:I!=null&&I.marks&&typeof I.marks=="object"?I.marks:{},f1:ie!=null&&ie.marks&&typeof ie.marks=="object"?ie.marks:{},cia:(D==null?void 0:D.data)??null}),P({cia1:null})}}catch(I){B({ssa:{},f1:{},cia:null}),P({cia1:null}),R((I==null?void 0:I.message)||"Failed to load published marks")}finally{k(!1)}};x.useEffect(()=>{e&&O()},[e,c]),x.useEffect(()=>{const I=ie=>{try{const D=(ie==null?void 0:ie.detail)||{},Z=D.subjectId,me=D.assessment;if(!Z||String(Z)!==String(e)||me&&!["ssa1","formative1","cia1"].includes(String(me)))return;O()}catch{}};return window.addEventListener("obe:published",I),()=>window.removeEventListener("obe:published",I)},[e]),x.useEffect(()=>{let I=!0;return(async()=>{if(p){y(!0),v(null);try{const D=(u||[]).find(Z=>Z.id===p)||null;if(D&&D.elective_subject_id&&!D.section_id){const Z=D.elective_subject_id,me=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(Z))}`);if(!me.ok)throw new Error(`Elective-choices fetch failed: ${me.status}`);const Te=await me.json();if(!I)return;const Le=((Array.isArray(Te.results)?Te.results:Array.isArray(Te)?Te:Te.items||[])||[]).map(_e=>({id:Number(_e.student_id??_e.id),reg_no:String(_e.reg_no??_e.registration_no??_e.regno??""),name:String(_e.name??_e.full_name??_e.username??""),section:_e.section_name??_e.section??null}));if(!I)return;S(Le.filter(_e=>Number.isFinite(_e.id)).sort(VF))}else{const Z=await pc(p);if(!I)return;const me=(Z.students||[]).map(Te=>({id:Number(Te.id),reg_no:String(Te.reg_no??""),name:String(Te.name??""),section:Te.section??null})).filter(Te=>Number.isFinite(Te.id)).sort(VF);S(me)}}catch(D){if(!I)return;S([]),v((D==null?void 0:D.message)||"Failed to load roster")}finally{I&&y(!1)}}})(),()=>{I=!1}},[p,u]);const X=x.useMemo(()=>{const I=new Map;if(c){const Le=E.cia1,_e=Le!=null&&Le.sheet&&typeof Le.sheet=="object"?Le.sheet:{},He=_e!=null&&_e.rowsByStudentId&&typeof _e.rowsByStudentId=="object"?_e.rowsByStudentId:{},We=Uu(Number((_e==null?void 0:_e.expCountA)??0),0,12),Pt=Uu(Number((_e==null?void 0:_e.expCountB)??0),0,12),dt=!!(_e!=null&&_e.coAEnabled),Ye=!!(_e!=null&&_e.coBEnabled),lt=(ke,ce)=>{const we=Array.isArray(ke)?ke:[],ht=[];for(let nt=0;nt<ce;nt++){const Ie=we[nt];if(Ie===""||Ie==null){ht.push("");continue}const It=typeof Ie=="number"?Ie:Number(Ie);ht.push(Number.isFinite(It)?It:"")}return ht},be=ke=>{const ce=ke.filter(we=>typeof we=="number"&&Number.isFinite(we));return ce.length?ce.reduce((we,ht)=>we+ht,0)/ce.length:null};for(const ke of w){const ce=He[String(ke.id)]||{},we=lt(ce.marksA,We).slice(0,dt?We:0),ht=lt(ce.marksB,Pt).slice(0,Ye?Pt:0),nt=be(we),Ie=be(ht),It=ce==null?void 0:ce.ciaExam,ct=typeof It=="number"&&Number.isFinite(It)?It:null,Mt=nt!=null||Ie!=null||ct!=null,xr=Mt?(nt??0)+(ct??0)/2:null,Pr=Mt?(Ie??0)+(ct??0)/2:null;I.set(ke.id,{ssaCo1:null,ssaCo2:null,ciaCo1:xr==null?null:Uu(xr,0,40),ciaCo2:Pr==null?null:Uu(Pr,0,40),f1Co1:null,f1Co2:null,__labCoMax:40})}return I}const ie=new Map;for(const[je,Le]of Object.entries(M.ssa||{})){const _e=Number(je);Number.isFinite(_e)&&ie.set(_e,vv(Le))}const D=M.f1&&typeof M.f1=="object"?M.f1:{},Z=M.cia&&typeof M.cia=="object"?M.cia:null,me=Array.isArray(Z==null?void 0:Z.questions)?Z.questions.map(je=>({key:String((je==null?void 0:je.key)||""),label:String((je==null?void 0:je.label)||(je==null?void 0:je.key)||""),max:Number((je==null?void 0:je.max)||0),co:je==null?void 0:je.co,btl:Math.min(6,Math.max(1,Number((je==null?void 0:je.btl)||1)))})).filter(je=>je.key):C,Te=Z!=null&&Z.rowsByStudentId&&typeof Z.rowsByStudentId=="object"?Z.rowsByStudentId:{};for(const je of w){const Le=ie.get(je.id)??null,_e=Ca.reduce((ce,we)=>ce+(q.ssa[Ds(we)]||0),0),He=fo(null);for(const ce of Ca){const we=Ds(ce),ht=q.ssa[we]||0;if(Le==null||!_e||!ht){He[we]=null;continue}const nt=Le/_e*ht;He[we]=Uu(nt,0,ht)}const We=D[String(je.id)]||{},Pt=fo(null);for(const ce of Ca){const we=Ds(ce),ht=q.f1[we]||0,nt=vv(We==null?void 0:We[`skill${ce}`]),Ie=vv(We==null?void 0:We[`att${ce}`]);ht&&nt!=null&&Ie!=null?Pt[we]=Uu(nt+Ie,0,ht):Pt[we]=null}const dt=Te[String(je.id)]||{},Ye=!!(dt!=null&&dt.absent),lt=dt!=null&&dt.q&&typeof dt.q=="object"?dt.q:{},be=fo(null);if(!Ye){const ce=fo(0);let we=!1;if(me.forEach((ht,nt)=>{const Ie=lt==null?void 0:lt[ht.key],It=vv(Ie);if(It==null)return;we=!0;const ct=Uu(It,0,Number(ht.max)||It),Mt=HF(me,nt);for(const xr of Ca){const Pr=Ds(xr);ce[Pr]+=ct*(Mt[Pr]||0)}}),we)for(const ht of Ca){const nt=Ds(ht),Ie=q.cia[nt]||0;be[nt]=Ie?Uu(ce[nt],0,Ie):null}}const ke={};for(const ce of Ca){const we=Ds(ce);ke[`ssaCo${ce}`]=He[we],ke[`f1Co${ce}`]=Pt[we],ke[`ciaCo${ce}`]=be[we]}I.set(je.id,ke)}return I},[M,E,w,q,C,c]),F=x.useMemo(()=>{var me;if(c){const Te=((me=w[0])==null?void 0:me.id)!=null?X.get(w[0].id):null,je=Number(Te==null?void 0:Te.__labCoMax),Le=Number.isFinite(je)&&je>0?je:40,_e=We=>We==null||!Le?null:WF(We/Le*3),He=(We,Pt)=>{if(We==null||Pt==null||!Le)return null;const dt=(We+Pt)/(2*Le)*100;return Number.isFinite(dt)?Math.round(Uu(dt,0,100)):null};return w.map((We,Pt)=>{const dt=X.get(We.id)||{},Ye=fo(null);Ye.co1=typeof dt.ciaCo1=="number"?dt.ciaCo1:null,Ye.co2=typeof dt.ciaCo2=="number"?dt.ciaCo2:null;const lt=fo(null),be=fo(!1);for(const ht of Ca){const nt=Ds(ht);lt[nt]=_e(Ye[nt]),be[nt]=typeof lt[nt]=="number"&&lt[nt]<bk}const ke=He(Ye.co1,Ye.co2),ce=Ca.map(ht=>be[Ds(ht)]?`CO${ht}`:null).filter(Boolean).join("+"),we={sno:Pt+1,...We,total:ke,cos:ce};for(const ht of Ca){const nt=Ds(ht);we[`${nt}_3pt`]=lt[nt],we[`flagCO${ht}`]=be[nt]}return we})}const I=oe.ssa1,ie=oe.cia1,D=oe.formative1,Z=fo(0);for(const Te of Ca){const je=Ds(Te);Z[je]=(q.ssa[je]||0)+(q.cia[je]||0)+(q.f1[je]||0)}return w.map((Te,je)=>{const Le=X.get(Te.id),_e=fo(null),He=fo(null),We=fo(!1);for(const lt of Ca){const be=Ds(lt),ke=nOe({ssaMark:(Le==null?void 0:Le[`ssaCo${lt}`])??null,ciaMark:(Le==null?void 0:Le[`ciaCo${lt}`])??null,f1Mark:(Le==null?void 0:Le[`f1Co${lt}`])??null,ssaMax:q.ssa[be]||0,ciaMax:q.cia[be]||0,f1Max:q.f1[be]||0,ssaW:I,ciaW:ie,f1W:D});_e[be]=ke;const ce=Z[be]||0;He[be]=ke==null||!ce?null:WF(ke/ce*3),We[be]=typeof He[be]=="number"&&He[be]<bk}const Pt=(()=>{const lt=Ca.map(be=>_e[Ds(be)]).filter(be=>typeof be=="number"&&Number.isFinite(be));return lt.length?Math.round(lt.reduce((be,ke)=>be+ke,0)):null})(),dt=Ca.map(lt=>We[Ds(lt)]?`CO${lt}`:null).filter(Boolean).join("+"),Ye={sno:je+1,...Te,total:Pt,cos:dt};for(const lt of Ca){const be=Ds(lt);Ye[`${be}_3pt`]=He[be],Ye[`flagCO${lt}`]=We[be]}return Ye})},[w,X,q,oe,c]),Q=x.useMemo(()=>{const I=U.trim().toLowerCase();return I?F.filter(ie=>{const D=String(ie.reg_no||"").toLowerCase(),Z=String(ie.name||"").toLowerCase(),me=String(ie.section||"").toLowerCase();return D.includes(I)||Z.includes(I)||me.includes(I)}):F},[F,U]),K=x.useMemo(()=>{const I=Z=>i.some(me=>!!(Z!=null&&Z[`flagCO${me}`])),ie=F.filter(Z=>I(Z)).length,D={strength:F.length,flagged:ie};for(const Z of Ca)D[`co${Z}`]=F.filter(me=>!!me[`flagCO${Z}`]).length;return D},[F,i]),ne={position:"sticky",top:0,zIndex:2,textAlign:"left",padding:"10px 12px",fontSize:12,letterSpacing:.2,textTransform:"uppercase",color:"#0f172a",background:"linear-gradient(180deg,#eaf6ff,#ffffff)",borderBottom:"1px solid rgba(148, 163, 184, 0.5)",whiteSpace:"nowrap"},re={padding:"10px 12px",borderBottom:"1px solid rgba(226, 232, 240, 0.9)",fontSize:13,color:"#0f172a",verticalAlign:"middle",whiteSpace:"nowrap"},T=(I,ie)=>{const D=ie==="danger"?{background:"rgba(239, 68, 68, 0.12)",border:"1px solid rgba(239, 68, 68, 0.35)",color:"#991b1b"}:{background:"rgba(2, 132, 199, 0.08)",border:"1px solid rgba(2, 132, 199, 0.25)",color:"#0b4a6f"};return a.jsx("span",{style:{display:"inline-flex",alignItems:"center",height:24,padding:"0 10px",borderRadius:999,fontSize:12,fontWeight:800,...D},children:I})};return a.jsxs("div",{style:{display:"grid",gap:14},children:[a.jsxs("div",{style:{padding:16,borderRadius:14,background:"linear-gradient(135deg,#ffffff,#f0f9ff)",border:"1px solid rgba(226, 232, 240, 0.9)",boxShadow:"0 10px 28px rgba(2, 6, 23, 0.06)"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",alignItems:"flex-end"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:18,fontWeight:950,color:"#0b4a6f"},children:"C1-CQI"}),a.jsxs("div",{style:{marginTop:6,fontSize:13,color:"#334155"},children:["Flags CO1CO5 when 3pt attainment is below ",a.jsx("b",{children:bk}),"."]})]}),a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"flex-end"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"Teaching Assignment / Section"}),a.jsxs("select",{value:p??"",onChange:I=>m(I.target.value?Number(I.target.value):null),style:{padding:"10px 12px",borderRadius:12,border:"1px solid #e2e8f0",minWidth:320,background:"#fff"},children:[a.jsx("option",{value:"",children:"Select"}),u.map(I=>{const ie=I.department,D=(ie==null?void 0:ie.short_name)||(ie==null?void 0:ie.code)||(ie==null?void 0:ie.name)||I.department_name||"",Z=I.semester;return a.jsxs("option",{value:I.id,children:[I.section_name," ",Z?` Sem ${Z}`:""," ",I.academic_year?` ${I.academic_year}`:""," ",D?` ${D}`:""]},I.id)})]})]}),a.jsxs("div",{style:{minWidth:320},children:[a.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"Show CO columns"}),a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center",padding:"10px 12px",borderRadius:12,border:"1px solid #e2e8f0",background:"#fff"},children:[Ca.map(I=>{const ie=i.includes(I);return a.jsxs("label",{style:{display:"inline-flex",gap:8,alignItems:"center",cursor:"pointer",userSelect:"none"},children:[a.jsx("input",{type:"checkbox",checked:ie,onChange:D=>{const Z=D.target.checked?Array.from(new Set([...i,I])):i.filter(me=>me!==I);s(Z)}}),a.jsx("span",{style:{fontSize:12,fontWeight:800,color:"#0f172a"},children:`CO${I}`})]},I)}),a.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:[a.jsx("button",{type:"button",onClick:()=>s([...Ca]),style:{padding:"6px 10px",borderRadius:10,border:"1px solid #e2e8f0",background:"#f8fafc",fontSize:12,fontWeight:800,color:"#0f172a"},children:"All"}),a.jsx("button",{type:"button",onClick:()=>s([]),style:{padding:"6px 10px",borderRadius:10,border:"1px solid #e2e8f0",background:"#fff",fontSize:12,fontWeight:800,color:"#0f172a"},children:"None"})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"Search"}),a.jsx("input",{value:U,onChange:I=>G(I.target.value),placeholder:"Reg no / name / section",style:{padding:"10px 12px",borderRadius:12,border:"1px solid #e2e8f0",width:260}})]})]})]}),(j||A||g||b||f)&&a.jsxs("div",{style:{marginTop:12,display:"grid",gap:8},children:[(j||A)&&a.jsx("div",{style:{fontSize:12,color:A?"#b91c1c":"#64748b"},children:j?"Loading published marks":A}),(g||b)&&a.jsx("div",{style:{fontSize:12,color:b?"#b91c1c":"#64748b"},children:g?"Loading roster":b}),f&&a.jsx("div",{style:{marginTop:4,background:"#fef2f2",border:"1px solid rgba(239, 68, 68, 0.25)",color:"#991b1b",padding:10,borderRadius:12},children:f})]}),a.jsxs("div",{style:{display:"flex",gap:10,marginTop:12,flexWrap:"wrap"},children:[T(`Strength: ${K.strength}`,"neutral"),T(`Flagged: ${K.flagged}`,K.flagged?"danger":"neutral"),i.map(I=>a.jsx(sn.Fragment,{children:T(`CO${I} below: ${K[`co${I}`]??0}`,K[`co${I}`]?"danger":"neutral")},I))]})]}),a.jsx("div",{style:{borderRadius:14,border:"1px solid rgba(226, 232, 240, 0.9)",overflow:"hidden",background:"#fff",boxShadow:"0 10px 28px rgba(2, 6, 23, 0.06)"},children:a.jsx("div",{style:{maxHeight:"70vh",overflow:"auto"},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"separate",borderSpacing:0},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{...ne,width:70},children:"slno"}),a.jsx("th",{style:{...ne,width:70},children:"SEC"}),a.jsx("th",{style:{...ne,width:160},children:"Reg number"}),a.jsx("th",{style:{...ne,minWidth:260},children:"NAME"}),a.jsx("th",{style:{...ne,width:140},children:"CO's"}),a.jsx("th",{style:{...ne,width:90,textAlign:"center"},children:"100"}),i.map(I=>a.jsx("th",{style:{...ne,width:90,textAlign:"center"},children:`CO${I} (3pt)`},I))]})}),a.jsxs("tbody",{children:[Q.map((I,ie)=>{const D=i.some(Le=>!!I[`flagCO${Le}`]),Z=ie%2===0,me=D?"rgba(239, 68, 68, 0.10)":Z?"#ffffff":"#f8fafc",Te=Le=>({...re,textAlign:"center",fontWeight:900,color:Le?"#991b1b":"#065f46",background:Le?"rgba(239, 68, 68, 0.10)":"rgba(34, 197, 94, 0.10)",borderBottom:"1px solid rgba(226, 232, 240, 0.9)"}),je=I.total!=null&&I.total<=58;return a.jsxs("tr",{style:{background:me},children:[a.jsx("td",{style:{...re,width:70,borderLeft:D?"4px solid rgba(239, 68, 68, 0.55)":"4px solid transparent"},children:I.sno}),a.jsx("td",{style:{...re,width:70},children:I.section??""}),a.jsx("td",{style:{...re,width:160,fontFamily:'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace'},children:I.reg_no}),a.jsx("td",{style:{...re,minWidth:260,fontWeight:800},children:I.name}),a.jsx("td",{style:{...re,width:140},children:i.some(Le=>!!I[`flagCO${Le}`])?a.jsx("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:i.filter(Le=>!!I[`flagCO${Le}`]).map(Le=>a.jsx(sn.Fragment,{children:T(`CO${Le}`,"danger")},Le))}):""}),a.jsx("td",{style:{...re,width:90,textAlign:"center",fontWeight:900,color:je?"#991b1b":"#0f172a",background:je?"rgba(239, 68, 68, 0.12)":"transparent"},children:I.total==null?"":Number.isFinite(Number(I.total))?String(Math.round(Number(I.total))):I.total}),i.map(Le=>a.jsx("td",{style:Te(!!I[`flagCO${Le}`]),children:I[`co${Le}_3pt`]==null?"":I[`co${Le}_3pt`]},Le))]},I.id)}),!Q.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:6+i.length,style:{padding:18,textAlign:"center",color:"#64748b"},children:"No rows."})})]})]})})})]})}function LK({courseId:e}){return a.jsx(iOe,{courseId:e})}function Bh(e){return String(e||"").trim()}function aOe(){var j,k;const{courseCode:e,taId:t}=z0(),r=vo(),n=hl(),i=x.useMemo(()=>decodeURIComponent(String(e||"")).trim(),[e]),s=x.useMemo(()=>t?Number(t):NaN,[t]),[o,l]=x.useState("marks"),[c,u]=x.useState(null),[d,f]=x.useState(null),[h,p]=x.useState(null),[m,g]=x.useState(null);x.useEffect(()=>{if(!(n!=null&&n.pathname))return;const A=n.pathname.toLowerCase();A.includes("/lca/instructions")||A.includes("/lca_instructions")||A.includes("/lca")||A.includes("/cdap")||A.includes("/articulation")?l("lca_instructions"):A.includes("/marks")?l("marks"):A.includes("/co_attainment")?l("co_attainment"):A.includes("/cqi")?l("cqi"):l("marks")},[n]);const y=x.useMemo(()=>{const A=String((n==null?void 0:n.pathname)||"").toLowerCase();return A.includes("/cdap")?"cdap":A.includes("/articulation")?"articulation":A.includes("/lca")&&!(A.includes("/lca/instructions")||A.includes("/lca_instructions"))?"lca":"instructions"},[n==null?void 0:n.pathname]);x.useEffect(()=>{let A=!0;return(async()=>{if(i)try{const R=await M2(i);if(!A)return;const M=(R||[]).find(B=>Number(B.teaching_assignment_id)===Number(s))||null;u(M)}catch{if(!A)return;u(null)}})(),()=>{A=!1}},[i,s]),x.useEffect(()=>{let A=!0;return(async()=>{if(i)try{const[R,M]=await Promise.all([Sl(),Yd()]);if(!A)return;const B=i.toUpperCase(),E=(R||[]).filter(H=>Bh(H==null?void 0:H.course_code).toUpperCase()===B),P=H=>Bh(H).toUpperCase(),U=E.find(H=>{const oe=P(H==null?void 0:H.question_paper_type);return oe&&oe!=="QP1"})||E.find(H=>P(H==null?void 0:H.question_paper_type))||E.find(H=>Bh(H==null?void 0:H.class_type))||E[0];if(U){if(f(U!=null&&U.class_type?Bh(U.class_type):null),p(U!=null&&U.question_paper_type?Bh(U.question_paper_type):null),ni(U==null?void 0:U.class_type)==="SPECIAL"){g([]);try{const H=await vS(i);g(Array.isArray(H)?H:[])}catch{const H=U==null?void 0:U.enabled_assessments;g(Array.isArray(H)?H.map(oe=>String(oe).trim().toLowerCase()).filter(Boolean):[])}}else g(null);return}const G=(M||[]).find(H=>Bh(H==null?void 0:H.course_code).toUpperCase()===B);f(G!=null&&G.class_type?Bh(G.class_type):null),p(null),g(null)}catch{}})(),()=>{A=!1}},[i]);const b=x.useMemo(()=>Number.isFinite(s)?[{id:s,subject_id:0,subject_code:i,subject_name:(c==null?void 0:c.course_name)||i,section_id:(c==null?void 0:c.section_id)||0,section_name:(c==null?void 0:c.section_name)||"Section",academic_year:(c==null?void 0:c.academic_year)||""}]:[],[s,i,c]);if(!i||!Number.isFinite(s))return a.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[a.jsx("div",{style:{color:"#b91c1c"},children:"Invalid teaching assignment."}),a.jsx("div",{style:{marginTop:10},children:a.jsx(es,{className:"obe-btn obe-btn-secondary",to:"/iqac/academic-controller?tab=courses",children:"Back"})})]});const v=(c==null?void 0:c.course_name)||i,w=[c==null?void 0:c.section_name,c==null?void 0:c.academic_year].filter(Boolean).join("  "),S=((j=c==null?void 0:c.staff)==null?void 0:j.name)||((k=c==null?void 0:c.staff)==null?void 0:k.username)||"";return a.jsx("main",{className:"obe-course-page",style:{padding:0,fontFamily:"Arial, sans-serif",minHeight:"100vh",background:"#fff"},children:a.jsxs("div",{style:{padding:"0px",width:"100%",minWidth:0,boxSizing:"border-box"},children:[a.jsx("div",{style:{marginBottom:12,padding:18},children:a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{children:[a.jsxs("h2",{style:{margin:0},children:["OBE Viewer - ",i]}),a.jsx("div",{style:{color:"#666",marginTop:6},children:"View-only (IQAC)"}),a.jsx("div",{style:{color:"#222",marginTop:6,fontWeight:800},children:v}),a.jsxs("div",{style:{color:"#374151",marginTop:4},children:[w||"",S?`    ${S}`:"",d?`    ${String(d).toUpperCase()}`:""]}),h?a.jsxs("div",{style:{color:"#374151",marginTop:2},children:["QP Type: ",a.jsx("strong",{style:{color:"#111827"},children:String(h)})]}):null]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx(es,{className:"obe-btn obe-btn-secondary",to:`/iqac/academic-controller/course/${encodeURIComponent(i)}`,children:"Back"}),a.jsx("button",{onClick:()=>r(`/iqac/academic-controller/course/${encodeURIComponent(i)}/marks/${encodeURIComponent(String(s))}`),className:"obe-btn",children:"Mark Entry Only"})]})]})}),a.jsx("div",{className:"obe-tab-nav","aria-label":"OBE Tabs",style:{padding:"0 18px"},children:[{key:"lca_instructions",label:"LCA Instructions"},{key:"marks",label:"Mark Entry"},{key:"co_attainment",label:"CO ATTAINMENT"},{key:"cqi",label:"CQI"}].map(A=>{const R=o===A.key;return a.jsx("button",{onClick:()=>{l(A.key);const M=encodeURIComponent(i),B=encodeURIComponent(String(s)),E=A.key==="lca_instructions"?"lca/instructions":String(A.key);r(`/iqac/academic-controller/course/${M}/obe/${B}/${E}`)},className:`obe-tab-btn ${R?"active":""}`,children:A.label},A.key)})}),a.jsxs("div",{style:{border:"1px solid #eee",borderRadius:10,padding:12,margin:18},children:[o==="lca_instructions"&&a.jsx(PK,{courseCode:i,courseName:(c==null?void 0:c.course_name)||null,initialTab:y,viewerMode:!0}),o!=="lca_instructions"?a.jsxs("fieldset",{disabled:!0,style:{border:0,padding:0,margin:0},children:[o==="co_attainment"&&a.jsx(MK,{courseId:i,enabledAssessments:m}),o==="cqi"&&a.jsx(LK,{courseId:i})]}):null,o==="marks"?a.jsx("div",{children:a.jsx(C6,{subjectId:i,classType:d,questionPaperType:h,enabledAssessments:m,teachingAssignmentsOverride:b,fixedTeachingAssignmentId:s,iqacResetEnabled:!0,viewerMode:!1})}):null]})]})})}function sOe(){const{courseCode:e,taId:t}=z0(),r=String(e||""),n=vo(),[i,s]=x.useState(!0),[o,l]=x.useState(!1),[c,u]=x.useState(null),[d,f]=x.useState(null),h={header:["CO1","CO1","CO1","CO2","CO2","CO2","CO3","CO3","CO3","CO4","CO4","CO4","CO1","CO2","CO3","CO4","CO5"],weights:[1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,2,2,2,2,4],cycles:["ssa","cia","fa","ssa","cia","fa","ssa","cia","fa","ssa","cia","fa","ME","ME","ME","ME","ME"]},p=k=>{const A=Number(k);if(!Number.isFinite(A)||A<=0)return[0,0,0];const R=1.5,M=3,B=2.5,E=R+M+B,P=Math.round(A*R/E*100)/100,U=Math.round(A*M/E*100)/100,G=Math.round(A*B/E*100)/100;return[P,U,G]},m=k=>{const A=k&&typeof k=="object"?k:{};let R=Array.isArray(A.weights)?[...A.weights]:[];if(R=R.map(M=>{const B=Number(M);return Number.isFinite(B)?B:0}),R.length===13){const[M,B,E]=p(R[0]??0),[P,U,G]=p(R[1]??0);R=[M,B,E,P,U,G,...R.slice(2)]}for(;R.length<h.weights.length;)R.push(h.weights[R.length]??0);return R=R.slice(0,h.weights.length),{...A,header:h.header,cycles:h.cycles,weights:R}};x.useEffect(()=>{let k=!0;return(async()=>{s(!0);try{const A=await j9(r);if(!k)return;f(A!=null&&A.mapping?m(A.mapping):null)}catch(A){if(!k)return;u((A==null?void 0:A.message)||String(A))}finally{k&&s(!1)}})(),()=>{k=!1}},[r]);const g=()=>d?m(d):(f(h),h),y=(k,A)=>{const R=A===""?"":Number(A);f(M=>{const B={...M||g()},E=Array.isArray(B.weights)?[...B.weights]:[];return E[k]=R,B.weights=E,B})},b=async()=>{l(!0),u(null);try{const k=m(d??g());await k9(r,k);try{window.dispatchEvent(new CustomEvent("internal-mark:updated",{detail:{subjectId:r}}))}catch{}n(-1)}catch(k){u((k==null?void 0:k.message)||String(k))}finally{l(!1)}};if(i)return a.jsx("div",{style:{padding:18},children:"Loading"});const v=m(d??g()),w=v.header,S=v.weights,j=v.cycles;return a.jsxs("main",{style:{padding:18},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[a.jsxs("h2",{style:{margin:0},children:["Internal Mark Mapping - ",r]}),a.jsxs("div",{style:{display:"flex",gap:8},children:[a.jsx("button",{className:"obe-btn",onClick:()=>n(-1),children:"Back"}),a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:b,disabled:o,children:o?"Saving...":"Save"})]})]}),a.jsx("div",{style:{overflowX:"auto"},children:a.jsxs("table",{style:{borderCollapse:"collapse",width:"100%"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:w.map((k,A)=>a.jsx("th",{style:{border:"1px solid #d1d5db",padding:8,background:"#f3f4f6"},children:k},A))}),a.jsx("tr",{children:j.map((k,A)=>a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb",fontWeight:600},children:k},`cy-${A}`))})]}),a.jsx("tbody",{children:a.jsx("tr",{children:S.map((k,A)=>a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6,background:"#f3f4f6"},children:a.jsx("input",{type:"number",step:"0.1",value:k===""?"":String(k),onChange:R=>y(A,R.target.value),style:{width:70,padding:6}})},A))})})]})}),c?a.jsx("div",{style:{color:"red",marginTop:12},children:c}):null]})}function oOe(){return a.jsx(I9,{})}function da({user:e,element:t,requiredRoles:r,requiredPermissions:n,requiredProfile:i}){if(!e)return a.jsx(Zp,{to:"/login",replace:!0});const s=(e.roles||[]).map(u=>(u||"").toString().toUpperCase()),o=(e.permissions||[]).map(u=>(u||"").toString().toLowerCase()),l=(e.profile_type||"").toString().toUpperCase();let c=!1;return i&&(i==="STUDENT"&&l==="STUDENT"&&(c=!0),i==="STAFF"&&l==="STAFF"&&(c=!0)),!c&&r&&r.length&&r.map(d=>d.toString().toUpperCase()).some(d=>s.includes(d))&&(c=!0),!c&&n&&n.length&&n.map(d=>d.toString().toLowerCase()).some(d=>o.includes(d))&&(c=!0),!i&&(!r||r.length===0)&&(!n||n.length===0)&&(c=!0),c?t:a.jsx(Zp,{to:"/dashboard",replace:!0})}function vk({user:e}){return a.jsx("div",{className:"fixed inset-0 overflow-hidden bg-gradient-to-br from-blue-50 to-slate-100",children:a.jsx("section",{className:"relative h-full flex items-center justify-center bg-gradient-to-b from-indigo-50 to-white py-0 px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[a.jsx("h1",{className:"text-4xl sm:text-5xl lg:text-6xl font-bold text-gray-900 mb-6",children:"Welcome to IDCS"}),a.jsx("p",{className:"text-lg sm:text-xl text-gray-600 mb-8 max-w-2xl mx-auto",children:"Streamline your academic management with our comprehensive Education Resource Planning system"}),e?a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 max-w-md mx-auto",children:[a.jsxs("p",{className:"text-lg text-gray-700 mb-2",children:["Hello, ",a.jsx("strong",{className:"text-blue-600",children:e.username}),"!"]}),e.roles&&e.roles.length>0&&a.jsxs("p",{className:"text-sm text-gray-500",children:["Role: ",a.jsx("span",{className:"font-semibold text-indigo-600",children:e.roles.join(", ")})]})]}):a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[a.jsx("a",{href:"/login",className:"px-8 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105",children:"Get Started"}),a.jsx("a",{href:"#features",className:"px-8 py-3 bg-white text-blue-600 border-2 border-blue-600 rounded-lg font-semibold hover:bg-blue-50 transition-all duration-200",children:"Learn More"})]})]})})})}function lOe(){return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 sm:p-8 shadow-md",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(W0,{className:"w-7 h-7 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Welcome back"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Welcome to the dashboard."})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md hover:shadow-lg transition-shadow",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center",children:a.jsx(gs,{className:"w-5 h-5 text-emerald-600"})}),a.jsx("h3",{className:"font-semibold text-gray-900",children:"Courses"})]}),a.jsx("p",{className:"text-sm text-gray-600",children:"View your enrolled courses"})]}),a.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md hover:shadow-lg transition-shadow",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:a.jsx(Lm,{className:"w-5 h-5 text-purple-600"})}),a.jsx("h3",{className:"font-semibold text-gray-900",children:"Academics"})]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Access academic resources"})]}),a.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md hover:shadow-lg transition-shadow sm:col-span-2 lg:col-span-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(xs,{className:"w-5 h-5 text-blue-600"})}),a.jsx("h3",{className:"font-semibold text-gray-900",children:"Schedule"})]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Check your timetable"})]})]})]})}function t0({children:e}){return a.jsx(a.Fragment,{children:e})}function cOe(){return a.jsx(t0,{children:a.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 pb-6",children:[a.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-6",children:"Dashboard"}),a.jsx(lOe,{})]})})}function uOe(e){return String(e??"").trim()}function dOe({user:e}){const[t,r]=x.useState(e===void 0?null:e),[n,i]=x.useState(!e),[s,o]=x.useState(null),l=x.useMemo(()=>{var F;return uOe((F=t==null?void 0:t.profile)==null?void 0:F.mobile_number)},[t]),c=x.useMemo(()=>{var F;return!!((F=t==null?void 0:t.profile)!=null&&F.mobile_verified)},[t]),[u,d]=x.useState(""),[f,h]=x.useState(!1),[p,m]=x.useState(!1),[g,y]=x.useState(""),[b,v]=x.useState(!1),[w,S]=x.useState(null),[j,k]=x.useState(null),[A,R]=x.useState(null),[M,B]=x.useState(0),[E,P]=x.useState(!1),[U,G]=x.useState(!1),[H,oe]=x.useState(null),[de,W]=x.useState(""),[V,ae]=x.useState(!1);if(x.useEffect(()=>{const F=l||"",Q=F.trim()?F.startsWith("+91")?F:`+91${F.replace(/^\+91\s*/,"")}`:"";d(Q),h(!c||!F),m(!1),y(""),S(null),k(null),R(null),B(0),ae(!1)},[l,c]),x.useEffect(()=>{if(!p||!A)return;const F=()=>{const K=Math.max(0,Math.ceil((A-Date.now())/1e3));B(K)};F();const Q=window.setInterval(F,1e3);return()=>window.clearInterval(Q)},[p,A]),x.useEffect(()=>{if(e)return;let F=!0;return i(!0),ah().then(Q=>{if(!F)return;const K={...Q,roles:Array.isArray(Q.roles)?Q.roles.map(ne=>typeof ne=="string"?ne:ne.name):[]};r(K)}).catch(Q=>o(String(Q))).finally(()=>i(!1)),()=>{F=!1}},[e]),n)return a.jsx(t0,{children:a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading profile"})]})})});if(s)return a.jsx(t0,{children:a.jsx("div",{className:"px-4 sm:px-6 lg:px-8 pb-6",children:a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-800",children:["Error loading profile: ",s]})})});if(!t)return a.jsx(t0,{children:a.jsx("div",{className:"px-4 sm:px-6 lg:px-8 pb-6",children:a.jsx("div",{className:"text-center text-gray-500",children:"No profile available"})})});const ee=(t.username||"U").slice(0,2).toUpperCase(),C=!!(c&&!f&&l);async function Y(){var Q,K,ne;S(null),k(null);let F=String(u||"").trim();if(F&&!F.startsWith("+91")&&(F=`+91${F}`),!F||F==="+91"){S("Enter mobile number.");return}try{v(!0);const re=await e9(F);m(!0);const T=Number((re==null?void 0:re.expires_in_seconds)??0);if(Number.isFinite(T)&&T>0){R(Date.now()+T*1e3),B(Math.ceil(T));const I=Math.ceil(T/60);k(`OTP sent. Valid for ${I} minute${I===1?"":"s"}.`)}else R(null),B(0),k("OTP sent.")}catch(re){const I=Number(((Q=re==null?void 0:re.response)==null?void 0:Q.status)||0)===401?"Session expired. Please login again and retry OTP request.":String(((ne=(K=re==null?void 0:re.response)==null?void 0:K.data)==null?void 0:ne.detail)||(re==null?void 0:re.message)||re||"Failed to send OTP");S(I)}finally{v(!1)}}async function q(){var K,ne,re;S(null),k(null);let F=String(u||"").trim();F&&!F.startsWith("+91")&&(F=`+91${F}`);const Q=String(g||"").trim();if(!F||F==="+91"){S("Enter mobile number.");return}if(!Q){S("Enter OTP.");return}try{v(!0);const T=await t9(F,Q),I=T&&T.me||null;if(I){const ie={...I,roles:Array.isArray(I.roles)?I.roles.map(D=>typeof D=="string"?D:D.name):[]};r(ie)}else{const ie=await ah(),D={...ie,roles:Array.isArray(ie.roles)?ie.roles.map(Z=>typeof Z=="string"?Z:Z.name):[]};r(D)}m(!1),y(""),k(null),S(null),h(!1),R(null),B(0),ae(!0),setTimeout(()=>ae(!1),8e3)}catch(T){const ie=Number(((K=T==null?void 0:T.response)==null?void 0:K.status)||0)===401?"Session expired. Please login again and retry OTP verification.":String(((re=(ne=T==null?void 0:T.response)==null?void 0:ne.data)==null?void 0:re.detail)||(T==null?void 0:T.message)||T||"OTP verification failed");S(ie)}finally{v(!1)}}const O=p&&A!=null&&M<=0;async function X(){var Q,K,ne;oe(null);const F=String(de||"").trim();if(!F){oe("Password is required.");return}try{G(!0);const re=await r9(F),T=re&&re.me||null;if(T){const I={...T,roles:Array.isArray(T.roles)?T.roles.map(ie=>typeof ie=="string"?ie:ie.name):[]};r(I)}else{const I=await ah(),ie={...I,roles:Array.isArray(I.roles)?I.roles.map(D=>typeof D=="string"?D:D.name):[]};r(ie)}P(!1),W(""),oe(null)}catch(re){const I=Number(((Q=re==null?void 0:re.response)==null?void 0:Q.status)||0)===401?"Session expired or incorrect password.":String(((ne=(K=re==null?void 0:re.response)==null?void 0:K.data)==null?void 0:ne.detail)||(re==null?void 0:re.message)||re||"Failed to remove mobile number");oe(I)}finally{G(!1)}}return a.jsxs(t0,{children:[a.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 pb-6 space-y-6",children:[a.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 sm:p-8 shadow-md",children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx("span",{className:"text-2xl sm:text-3xl font-bold text-white",children:ee})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:t.username}),a.jsx("p",{className:"text-gray-600 mt-1",children:t.email||"No email provided"})]})]}),a.jsxs("div",{className:"bg-white rounded-lg px-4 py-2 shadow-sm",children:[a.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Profile Type"}),a.jsx("div",{className:"font-bold text-gray-900",children:t.profile_type||""})]})]})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Details"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(W0,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"Account"}),a.jsxs("div",{className:"text-gray-900 font-medium truncate",children:["ID: ",t.id]})]})]})}),a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(v3,{className:"w-5 h-5 text-emerald-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"Email"}),a.jsx("div",{className:"text-gray-900 font-medium truncate",children:t.email||""})]})]})}),a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Fte,{className:"w-5 h-5 text-purple-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"Roles"}),a.jsx("div",{className:"text-gray-900 font-medium truncate",children:(t.roles||[]).join(", ")||""})]})]})}),a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx($ee,{className:"w-5 h-5 text-orange-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"Department"}),a.jsx("div",{className:"text-gray-900 font-medium truncate",children:t.profile&&t.profile.department&&(t.profile.department.short_name||t.profile.department.code)||""})]})]})}),a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Iee,{className:"w-5 h-5 text-indigo-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"Designation"}),a.jsx("div",{className:"text-gray-900 font-medium truncate",children:t.profile&&t.profile.designation||""})]})]})}),a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-pink-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Ote,{className:"w-5 h-5 text-pink-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"College"}),a.jsx("div",{className:"text-gray-900 font-medium truncate",children:t.college&&(t.college.short_name||t.college.name)||""})]})]})}),a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-teal-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Nte,{className:"w-5 h-5 text-teal-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-2",children:"Mobile Number"}),V&&a.jsxs("div",{className:"mb-3 bg-emerald-50 border border-emerald-200 rounded-lg p-3 flex items-start gap-2",children:[a.jsx(Ld,{className:"w-5 h-5 text-emerald-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"text-sm text-emerald-800 leading-relaxed",children:[a.jsx("strong",{children:"Mobile number verified successfully!"})," You can now access your Academic panel and submit requests through IDCS."]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative flex-1 flex",children:[a.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-2 bg-gray-100 border border-gray-200 rounded-l-md border-r-0",children:[a.jsx("span",{className:"text-base leading-none",children:""}),a.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"+91"})]}),a.jsx("input",{className:"flex-1 rounded-r-md rounded-l-none border border-gray-200 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-teal-200",value:u.replace(/^\+91\s*/,""),onChange:F=>{const Q=F.target.value.replace(/^\+91\s*/,"").replace(/[^\d]/g,"");d(Q?`+91${Q}`:""),m(!1),y(""),S(null),k(null),R(null),B(0)},readOnly:C,placeholder:"Enter 10-digit mobile number",maxLength:10}),C&&a.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2",children:a.jsx(Ld,{className:"w-5 h-5 text-emerald-600"})})]}),!C&&a.jsx("button",{type:"button",className:"px-3 py-2 rounded-md bg-teal-600 text-white text-sm font-semibold disabled:opacity-60",onClick:Y,disabled:b||p&&A!=null&&!O,children:p?O?"Resend OTP":"OTP Sent":"Verify"})]}),j&&a.jsx("div",{className:"mt-2 text-xs text-gray-500",children:j}),w&&a.jsx("div",{className:"mt-2 text-xs text-red-600 font-semibold",children:w}),p&&A!=null&&!C&&a.jsx("div",{className:"mt-2 text-xs text-gray-600",children:M>0?a.jsxs("span",{children:["OTP expires in"," ",String(Math.floor(M/60)).padStart(2,"0"),":",String(M%60).padStart(2,"0")]}):a.jsx("span",{className:"text-amber-700 font-semibold",children:"OTP expired. You can resend now."})}),p&&!C&&a.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[a.jsx("input",{className:"flex-1 rounded-md border border-gray-200 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-teal-200",value:g,onChange:F=>y(F.target.value),placeholder:"Enter OTP"}),a.jsx("button",{type:"button",className:"px-3 py-2 rounded-md bg-emerald-600 text-white text-sm font-semibold disabled:opacity-60",onClick:q,disabled:b,children:"Submit"})]}),C&&a.jsxs("div",{className:"mt-2 flex items-center gap-3",children:[a.jsx("button",{type:"button",className:"text-xs text-blue-700 underline font-semibold",onClick:()=>{h(!0),m(!1),y(""),S(null),k(null)},children:"Change number"}),a.jsxs("button",{type:"button",className:"text-xs text-red-700 underline font-semibold flex items-center gap-1",onClick:()=>{W(""),oe(null),P(!0)},children:[a.jsx(Fm,{className:"w-3 h-3"}),"Remove"]})]})]})]})})]})]})]}),E?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",display:"flex",alignItems:"center",justifyContent:"center",overflowY:"auto",padding:16,zIndex:80},onClick:()=>{U||(P(!1),W(""),oe(null))},children:a.jsxs("div",{style:{width:"min(420px, 96vw)",background:"#fff",borderRadius:16,border:"2px solid #fca5a5",boxShadow:"0 8px 32px rgba(220,38,38,0.12), 0 2px 8px rgba(0,0,0,0.10)",overflow:"hidden"},onClick:F=>F.stopPropagation(),children:[a.jsxs("div",{style:{background:"linear-gradient(135deg, #fff1f2 0%, #ffe4e6 100%)",borderBottom:"1px solid #fecaca",padding:"16px 20px",display:"flex",alignItems:"center",gap:12},children:[a.jsx("img",{src:n9,alt:"IDCS Logo",style:{width:36,height:36,objectFit:"contain",flexShrink:0}}),a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:700,fontSize:15,color:"#991b1b",lineHeight:1.2},children:"Remove Mobile Number"}),a.jsx("div",{style:{fontSize:11,color:"#b91c1c",marginTop:2},children:"This action cannot be undone"})]})]}),a.jsxs("div",{style:{padding:"20px 20px 16px"},children:[a.jsx("div",{style:{fontSize:13,color:"#374151",marginBottom:18,lineHeight:1.55,background:"#fef9c3",border:"1px solid #fde68a",borderRadius:8,padding:"10px 12px"},children:"Your verified mobile number will be removed. You will need to re-verify to access features that require it."}),a.jsx("label",{style:{display:"block",fontSize:12,fontWeight:700,color:"#374151",marginBottom:6,letterSpacing:"0.03em"},children:"IDCS PASSWORD"}),a.jsx("input",{autoFocus:!0,type:"password",className:"obe-input",style:{borderColor:de.trim()?"#dc2626":"#fca5a5",outline:"none",boxShadow:de.trim()?"0 0 0 3px rgba(220,38,38,0.15)":"0 0 0 3px rgba(252,165,165,0.25)",borderWidth:2,fontSize:14,padding:"10px 12px",transition:"box-shadow 0.15s, border-color 0.15s"},value:de,onChange:F=>W(F.target.value),onKeyDown:F=>{F.key==="Enter"&&de.trim()&&!U&&X()},placeholder:"Enter your IDCS password"}),H?a.jsx("div",{className:"obe-danger-pill",style:{marginTop:10,fontSize:13},children:H}):null]}),a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",padding:"12px 20px 16px",borderTop:"1px solid #fee2e2",background:"#fff7f7"},children:[a.jsx("button",{type:"button",className:"obe-btn",disabled:U,style:{minWidth:80},onClick:()=>{P(!1),W(""),oe(null)},children:"Cancel"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-danger",disabled:U||!de.trim(),style:{minWidth:100},onClick:X,children:U?"Removing":" Remove"})]})]})})}):null]})}function z1({children:e}){return a.jsx(t0,{children:a.jsx("div",{className:"flex flex-col w-full max-w-full overflow-x-hidden",children:e})})}function fOe(){const[e,t]=x.useState([]),[r,n]=x.useState(!0),[i,s]=x.useState(null),o=hl(),l=vo(),c=e&&e.length?Array.from(new Set(e.map(b=>b.regulation))):[],u=e&&e.length?Array.from(new Set(e.map(b=>b.semester))).sort((b,v)=>b-v):[],[d,f]=x.useState(c.length===1?c[0]:c[0]??null),[h,p]=x.useState(u.length===1?u[0]:u[0]??null);x.useEffect(()=>{const b=e&&e.length?Array.from(new Set(e.map(w=>w.regulation))):[];b.length===1?f(b[0]):b.includes(d||"")||f(b[0]??null);const v=e&&e.length?Array.from(new Set(e.map(w=>w.semester))).sort((w,S)=>w-S):[];v.length===1?p(v[0]):v.includes(h||-1)||p(v[0]??null)},[e]),x.useEffect(()=>{Yd().then(b=>t(b)).catch(b=>console.error(b)).finally(()=>n(!1))},[]);function m(b){if(b==null)return"";const v=String(b);return v.includes(",")||v.includes('"')||v.includes(`
`)?'"'+v.replace(/"/g,'""')+'"':v}function g(){const b=e.filter(A=>(!d||A.regulation===d)&&(!h||A.semester===h)&&A.editable===!0);if(!b.length){alert("No editable subjects in current view");return}const w=[["regulation","semester","course_code","course_name","category","class_type","l","t","p","s","c","internal_mark","external_mark","for_all_departments","editable","departments"].join(",")];for(const A of b){const R=A.for_all_departments?"":(A.departments_display||[]).map(B=>B.short_name||B.shortname||B.code||B.name).join(","),M=[A.regulation,A.semester,A.course_code||"",A.course_name||"",A.category||"",A.class_type||"",A.l??0,A.t??0,A.p??0,A.s??0,A.c??0,A.internal_mark??"",A.external_mark??"",A.for_all_departments?"True":"False",A.editable?"True":"False",R];w.push(M.map(m).join(","))}const S=new Blob([w.join(`
`)],{type:"text/csv"}),j=URL.createObjectURL(S),k=document.createElement("a");k.href=j,k.download=`department_curriculum_editable_${d||"all"}_${h||"all"}.csv`,document.body.appendChild(k),k.click(),k.remove(),URL.revokeObjectURL(j)}async function y(b){const v=b.target.files&&b.target.files[0];if(v){if(!confirm(`Upload ${v.name} to import masters?`)){b.currentTarget.value="";return}try{const w=new FormData;w.append("csv_file",v,v.name);const S=await mr("/api/curriculum/master/import/",{method:"POST",body:w});if(S.status===401){alert("Your session has expired. Please refresh the page and try again.");return}if(S.ok)alert("Import request submitted; refresh to see changes."),n(!0),Yd().then(j=>t(j)).catch(()=>{}).finally(()=>n(!1));else{let j="";try{j=await S.text()}catch{j=S.statusText}alert("Import failed: "+(j||S.statusText))}}catch(w){console.error(w),alert("Import failed: "+(w.message||w))}try{const w=document.getElementById("master-import-file");w&&(w.value="")}catch{}}}return x.useEffect(()=>{const b=o.state;b&&b.savedMessage&&(s(b.savedMessage),l(location.pathname,{replace:!0,state:{}}),setTimeout(()=>s(null),2500))},[o,l]),r?a.jsx(z1,{children:a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading masters"})]})})}):a.jsx(z1,{children:a.jsxs("div",{className:"px-4 pb-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-indigo-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(gs,{className:"w-6 h-6 text-indigo-600"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Master Curriculum"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View and manage all master curriculum entries."})]})]}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[(()=>{try{const b=JSON.parse(localStorage.getItem("roles")||"[]");if(Array.isArray(b)&&b.some(w=>String(w).toLowerCase()==="iqac"))return a.jsx(es,{to:"/curriculum/master/new",className:"px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md",children:"New Master"})}catch{}return null})(),a.jsxs("button",{onClick:()=>g(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-all duration-200 shadow-sm hover:shadow-md",children:[a.jsx(P4,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Download"})]}),a.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition-all duration-200 shadow-sm hover:shadow-md cursor-pointer",children:[a.jsx(P2,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Import CSV"}),a.jsx("input",{id:"master-import-file",type:"file",accept:".csv",className:"hidden",onChange:b=>y(b)})]})]})]}),c.length>0&&a.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-6 bg-white rounded-lg shadow-sm p-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Regulation:"}),a.jsx("select",{value:d??"",onChange:b=>f(b.target.value||null),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500",children:c.map(b=>a.jsx("option",{value:b,children:b},b))})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Semester:"}),a.jsx("select",{value:h??"",onChange:b=>p(b.target.value?Number(b.target.value):null),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500",children:u.map(b=>a.jsx("option",{value:b,children:b},b))})]})]}),i&&a.jsx("div",{className:"mb-4 inline-block bg-green-100 text-green-800 px-4 py-2 rounded-lg font-semibold",children:i}),a.jsx("div",{className:"w-full overflow-x-auto bg-white rounded-lg shadow-md",children:a.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Code"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Course"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"CAT"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Class"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Elective"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"L"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"T"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"P"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"S"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"C"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"INT"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"EXT"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"TTL"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Depts"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Editable"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.filter(b=>(!d||b.regulation===d)&&(!h||b.semester===h)).length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:16,className:"px-4 py-8 text-center text-gray-500",children:"No curriculum entries found for the selected filters."})}):e.filter(b=>(!d||b.regulation===d)&&(!h||b.semester===h)).map(b=>a.jsxs("tr",{className:`hover:bg-gray-50 transition-colors ${b.editable?"bg-blue-50/30":""}`,children:[a.jsx("td",{className:"px-3 py-3 text-sm text-gray-900 whitespace-nowrap",children:b.course_code||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-gray-900 font-medium min-w-[200px]",children:b.course_name||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-gray-700 whitespace-nowrap",children:b.category||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-gray-700 whitespace-nowrap",children:b.class_type||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-center whitespace-nowrap",children:b.is_elective?a.jsx("span",{className:"text-green-700 font-semibold",children:"Yes"}):a.jsx("span",{className:"text-gray-400",children:"No"})}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.l??0}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.t??0}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.p??0}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.s??0}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.c??0}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.internal_mark??"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.external_mark??"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 font-semibold whitespace-nowrap",children:b.total_mark??"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-gray-700 whitespace-nowrap",children:b.for_all_departments?"ALL":b.departments_display&&b.departments_display.length>0?b.departments_display.map(v=>v.short_name||v.shortname||v.code||v.name).join(", "):"No Depts"}),a.jsx("td",{className:"px-3 py-3 text-sm text-center whitespace-nowrap",children:b.editable?a.jsx("span",{className:"text-green-700 font-semibold",children:"Yes"}):a.jsx("span",{className:"text-gray-400",children:"No"})}),a.jsx("td",{className:"px-3 py-3 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx(es,{to:`/curriculum/master/${b.id}`,className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:a.jsx(dh,{className:"w-4 h-4"})}),b.status==="PENDING"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",className:"px-3 py-1.5 text-green-600 hover:bg-green-50 text-xs font-medium rounded-lg transition-colors",children:"Approve"}),a.jsx("button",{type:"button",className:"px-3 py-1.5 text-red-600 hover:bg-red-50 text-xs font-medium rounded-lg transition-colors",children:"Reject"})]})]})})]},b.id))})]})})]})})}function GF(){const{id:e}=z0(),t=e??(window.location.pathname.endsWith("/new")?"new":void 0),r=vo(),[n,i]=x.useState({regulation:"",semester:1,for_all_departments:!0,editable:!1,is_elective:!1}),[s,o]=x.useState(!1),[l,c]=x.useState([]),[u,d]=x.useState(null);x.useEffect(()=>{t&&t!=="new"&&(o(!0),Yd().then(h=>{const p=h.find(m=>String(m.id)===String(t));p&&i(p)}).finally(()=>o(!1)))},[t]),x.useEffect(()=>{Sl().then(h=>{const p=new Map;h.forEach(m=>p.set(m.department.id,m.department)),c(Array.from(p.values()))}).catch(()=>c([]))},[]);async function f(){o(!0);try{if(!n.regulation)throw new Error("Regulation is required");if(!n.semester||n.semester<=0)throw new Error("Semester must be a positive number");if(!n.course_name)throw new Error("Course Name is required");if(n.internal_mark!==""&&n.internal_mark!=null&&n.internal_mark<0||n.external_mark!==""&&n.external_mark!=null&&n.external_mark<0)throw new Error("Marks cannot be negative");const h={...n};if(n.for_all_departments?h.departments=[]:h.departments=Array.isArray(n.departments)?n.departments:[],h.internal_mark=n.internal_mark===""||n.internal_mark==null?0:Number(n.internal_mark),h.external_mark=n.external_mark===""||n.external_mark==null?0:Number(n.external_mark),h.course_code=n.course_code===""||n.course_code==null?null:n.course_code,t==="new"){const p=await Dre(h);r("/curriculum/master",{state:{savedMessage:"Saved",newId:p.id}})}else{const p=Number(t);if(Number.isNaN(p))throw new Error("Invalid master id");const m=await $re(p,h);i(m),d("Saved"),setTimeout(()=>d(null),2500)}}catch(h){alert(`Error: ${h.message}`)}finally{o(!1)}}return a.jsxs(z1,{children:[a.jsxs("div",{className:"px-2 sm:px-4 pb-4",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-indigo-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(gs,{className:"w-5 h-5 sm:w-6 sm:h-6 text-indigo-600"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:e==="new"?"New Master":"Edit Master"}),a.jsx("p",{className:"text-gray-600 text-xs sm:text-sm mt-1",children:e==="new"?"Create a new master curriculum entry.":"Edit the selected master curriculum entry."})]})]}),a.jsxs("form",{onSubmit:h=>{h.preventDefault(),f()},className:"bg-white rounded-lg shadow-md p-3 sm:p-4 lg:p-6 space-y-4",autoComplete:"off",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Regulation"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:n.regulation||"",onChange:h=>i({...n,regulation:h.target.value}),required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Semester"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",type:"number",min:1,value:n.semester||1,onChange:h=>i({...n,semester:Number(h.target.value)}),required:!0})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Course Code"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:n.course_code??"",onChange:h=>i({...n,course_code:h.target.value}),placeholder:"Optional"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Course Name"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:n.course_name||"",onChange:h=>i({...n,course_name:h.target.value}),required:!0})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"CAT"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:n.category||"",onChange:h=>i({...n,category:h.target.value}),placeholder:"e.g. CORE"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Class"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:n.class_type||"",onChange:h=>i({...n,class_type:h.target.value}),placeholder:"e.g. Theory"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"L"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-sm",type:"number",min:0,value:n.l||0,onChange:h=>i({...n,l:Number(h.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"T"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-sm",type:"number",min:0,value:n.t||0,onChange:h=>i({...n,t:Number(h.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"P"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-sm",type:"number",min:0,value:n.p||0,onChange:h=>i({...n,p:Number(h.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"S"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-sm",type:"number",min:0,value:n.s||0,onChange:h=>i({...n,s:Number(h.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"C"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-sm",type:"number",min:0,value:n.c||0,onChange:h=>i({...n,c:Number(h.target.value)})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Internal Mark"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",type:"number",min:0,value:n.internal_mark??"",onChange:h=>i({...n,internal_mark:h.target.value===""?"":Number(h.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"External Mark"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",type:"number",min:0,value:n.external_mark??"",onChange:h=>i({...n,external_mark:h.target.value===""?"":Number(h.target.value)})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[a.jsx("input",{type:"checkbox",checked:!!n.for_all_departments,onChange:h=>i({...n,for_all_departments:h.target.checked}),id:"forAllDepts",className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),a.jsx("label",{htmlFor:"forAllDepts",className:"text-xs sm:text-sm font-semibold text-indigo-900",children:"For All Departments"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Departments"}),n.for_all_departments?a.jsx("div",{className:"text-gray-600 text-xs sm:text-sm p-2 bg-gray-50 rounded-lg",children:"Applies to all departments"}):a.jsxs("div",{className:"max-h-32 overflow-y-auto p-2 border border-gray-300 rounded-lg bg-white",children:[l.length===0&&a.jsx("div",{className:"text-gray-400 text-xs",children:"No departments available"}),l.map(h=>a.jsxs("div",{className:"flex items-center gap-1.5 mb-1.5",children:[a.jsx("input",{type:"checkbox",checked:Array.isArray(n.departments)?n.departments.includes(h.id):!1,onChange:p=>{const m=Array.isArray(n.departments)?[...n.departments]:[];if(p.target.checked)m.includes(h.id)||m.push(h.id);else{const g=m.indexOf(h.id);g>=0&&m.splice(g,1)}i({...n,departments:m})},id:`dept-${h.id}`,className:"w-3.5 h-3.5 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),a.jsxs("label",{htmlFor:`dept-${h.id}`,className:"text-xs sm:text-sm text-gray-700",children:[h.code,"  ",h.name]})]},h.id))]})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[a.jsx("input",{type:"checkbox",checked:!!n.editable,onChange:h=>i({...n,editable:h.target.checked}),id:"editable",className:"w-3.5 h-3.5 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),a.jsx("label",{htmlFor:"editable",className:"text-xs sm:text-sm font-semibold text-indigo-900",children:"Editable"})]}),a.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[a.jsx("input",{type:"checkbox",checked:!!n.is_elective,onChange:h=>i({...n,is_elective:h.target.checked}),id:"is_elective",className:"w-3.5 h-3.5 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),a.jsx("label",{htmlFor:"is_elective",className:"text-xs sm:text-sm font-semibold text-indigo-900",children:"Is Elective"})]})]}),u&&a.jsx("div",{className:"bg-green-100 text-green-800 px-3 py-1.5 rounded-lg font-semibold text-sm inline-block",children:u}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[a.jsxs("button",{type:"submit",className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors shadow-sm disabled:opacity-50 disabled:cursor-not-allowed text-sm",disabled:s,children:[a.jsx(rd,{className:"w-4 h-4"}),s?"Saving":"Save"]}),a.jsxs("button",{type:"button",className:"flex items-center justify-center gap-2 px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg font-semibold hover:bg-gray-50 transition-colors text-sm",onClick:()=>r("/curriculum/master"),children:[a.jsx(bu,{className:"w-4 h-4"}),"Cancel"]})]})]})]}),a.jsxs("form",{onSubmit:h=>{h.preventDefault(),f()},style:{background:"#fff",borderRadius:10,boxShadow:"0 2px 8px #e5e7eb",padding:32,maxWidth:700,margin:"0 auto",display:"grid",gap:22},autoComplete:"off",children:[a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:18},children:[a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Regulation"}),a.jsx("input",{className:"input",value:n.regulation||"",onChange:h=>i({...n,regulation:h.target.value}),required:!0,style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Semester"}),a.jsx("input",{className:"input",type:"number",min:1,value:n.semester||1,onChange:h=>i({...n,semester:Number(h.target.value)}),required:!0,style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:18},children:[a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Course Code"}),a.jsx("input",{className:"input",value:n.course_code??"",onChange:h=>i({...n,course_code:h.target.value}),placeholder:"Optional",style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Course Name"}),a.jsx("input",{className:"input",value:n.course_name||"",onChange:h=>i({...n,course_name:h.target.value}),required:!0,style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:18},children:[a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"CAT"}),a.jsx("input",{className:"input",value:n.category||"",onChange:h=>i({...n,category:h.target.value}),placeholder:"e.g. CORE",style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Class"}),a.jsxs("select",{className:"input",value:n.class_type||"",onChange:h=>i({...n,class_type:h.target.value}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4},children:[a.jsx("option",{value:"",children:"Select class type"}),em.map(h=>{const p=ni(String(h)),m=String(h).charAt(0).toUpperCase()+String(h).slice(1);return a.jsx("option",{value:p,children:m},p)})]})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:18},children:[a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"L"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.l||0,onChange:h=>i({...n,l:Number(h.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"T"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.t||0,onChange:h=>i({...n,t:Number(h.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"P"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.p||0,onChange:h=>i({...n,p:Number(h.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"S"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.s||0,onChange:h=>i({...n,s:Number(h.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"C"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.c||0,onChange:h=>i({...n,c:Number(h.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:18},children:[a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Internal Mark"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.internal_mark??"",onChange:h=>i({...n,internal_mark:h.target.value===""?"":Number(h.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"External Mark"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.external_mark??"",onChange:h=>i({...n,external_mark:h.target.value===""?"":Number(h.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:18},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginTop:8},children:[a.jsx("input",{type:"checkbox",checked:!!n.for_all_departments,onChange:h=>i({...n,for_all_departments:h.target.checked}),id:"forAllDepts"}),a.jsx("label",{htmlFor:"forAllDepts",style:{fontWeight:600,color:"#3730a3",marginBottom:0},children:"For All Departments"})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Departments"}),n.for_all_departments?a.jsx("div",{style:{marginTop:6,color:"#6b7280"},children:"Applies to all departments"}):a.jsxs("div",{style:{marginTop:6,maxHeight:220,overflowY:"auto",padding:6,border:"1px solid #e5e7eb",borderRadius:6},children:[l.length===0&&a.jsx("div",{style:{color:"#9ca3af"},children:"No departments available"}),l.map(h=>a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6},children:[a.jsx("input",{type:"checkbox",checked:Array.isArray(n.departments)?n.departments.includes(h.id):!1,onChange:p=>{const m=Array.isArray(n.departments)?[...n.departments]:[];if(p.target.checked)m.includes(h.id)||m.push(h.id);else{const g=m.indexOf(h.id);g>=0&&m.splice(g,1)}i({...n,departments:m})},id:`dept-${h.id}`}),a.jsxs("label",{htmlFor:`dept-${h.id}`,style:{marginBottom:0},children:[h.code,"  ",h.name]})]},h.id))]})]})]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginTop:8},children:[a.jsx("input",{type:"checkbox",checked:!!n.editable,onChange:h=>i({...n,editable:h.target.checked}),id:"editable"}),a.jsx("label",{htmlFor:"editable",style:{fontWeight:600,color:"#3730a3",marginBottom:0},children:"Editable"})]}),u&&a.jsx("div",{style:{background:"#ecfccb",color:"#365314",padding:"8px 12px",borderRadius:8,fontWeight:600,display:"inline-block"},children:u}),a.jsxs("div",{style:{display:"flex",gap:10,marginTop:8},children:[a.jsx("button",{type:"submit",className:"btn-primary",style:{padding:"6px 18px",borderRadius:8,fontWeight:600,fontSize:16,minWidth:100},disabled:s,children:s?"Saving":"Save"}),a.jsx("button",{type:"button",className:"btn-secondary",style:{padding:"6px 18px",borderRadius:8,fontWeight:600,fontSize:16,minWidth:100},onClick:()=>r("/curriculum/master"),children:"Cancel"})]})]})]})}function hOe(){const[e,t]=x.useState([]),[r,n]=x.useState(!0),i=e&&e.length?Array.from(new Set(e.map(W=>W.regulation))):[],s=e&&e.length?Array.from(new Set(e.map(W=>W.semester))).sort((W,V)=>W-V):[],[o,l]=x.useState(i.length===1?i[0]:i[0]??null),[c,u]=x.useState(s.length===1?s[0]:s[0]??null),d=e&&e.length?Array.from(new Set(e.map(W=>W.department.id))):[];x.useEffect(()=>{const W=e&&e.length?Array.from(new Set(e.map(ae=>ae.regulation))):[];W.length===1?l(W[0]):W.includes(o||"")||l(W[0]??null);const V=e&&e.length?Array.from(new Set(e.map(ae=>ae.semester))).sort((ae,ee)=>ae-ee):[];V.length===1?u(V[0]):V.includes(c||-1)||u(V[0]??null)},[e]),x.useEffect(()=>{Sl().then(W=>t(W)).catch(console.error).finally(()=>n(!1))},[]);async function f(W){try{const V=await zre(W.id,W);t(ae=>ae.map(ee=>ee.id===V.id?V:ee)),p(null),alert("Row updated successfully")}catch(V){alert(String(V))}}const[h,p]=x.useState(null),m=(()=>{try{return JSON.parse(localStorage.getItem("permissions")||"[]")}catch{return[]}})(),g=Array.isArray(m)&&(m.includes("curriculum.department.approve")||m.includes("CURRICULUM_DEPARTMENT_APPROVE"));async function y(W,V){try{await Wre(W,V);const ae=await Sl();t(ae),alert("OK")}catch(ae){alert(String(ae))}}const[b,v]=x.useState(null);x.useEffect(()=>{d.length===1?v(d[0]):d.includes(b||-1)||v(d[0]??null)},[e]);const w=e.filter(W=>W.is_elective&&(!b||W.department.id===b)&&(!o||W.regulation===o)&&(!c||W.semester===c)),[S,j]=x.useState([]);x.useEffect(()=>{pm({department_id:b??void 0,regulation:o??void 0,semester:c??void 0}).then(j).catch(()=>j([]))},[b,o,c,e]);const[k,A]=x.useState(!1),[R,M]=x.useState({parent:null,department_id:b||null,regulation:o||null,semester_id:c||null,course_code:"",course_name:"",class_type:"THEORY",category:"",is_elective:!0,l:0,t:0,p:0,s:0,c:0,internal_mark:null,external_mark:null,total_mark:null,total_hours:null,question_paper_type:"",editable:!1});function B(W){M(V=>({...V,parent:W.id,department_id:b||V.department_id,regulation:o||V.regulation,semester_id:c||V.semester_id,course_name:"",course_code:""})),A(!0)}async function E(){try{const W={...R};if(!W.parent)throw new Error("Parent curriculum id missing");W.course_code||delete W.course_code,W.course_name||delete W.course_name,await Ure(W);const V=await Sl();t(V);const ae=await pm({department_id:b??void 0,regulation:o??void 0,semester:c??void 0});j(ae),A(!1),alert("Elective subject added")}catch(W){alert(String(W))}}const[P,U]=x.useState(!1),[G,H]=x.useState(null);function oe(W){H({...W}),U(!0)}async function de(){if(!(!G||!G.id))try{const W=await mr(`/api/curriculum/elective/${G.id}/`,{method:"PATCH",body:JSON.stringify(G)});if(!W.ok)throw new Error(await W.text());const V=await Sl();t(V);const ae=await pm({department_id:b??void 0,regulation:o??void 0,semester:c??void 0});j(ae),U(!1),alert("Elective updated")}catch(W){alert(String(W))}}return r?a.jsx(z1,{children:a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading department curriculum"})]})})}):a.jsx(z1,{children:a.jsxs("div",{className:"px-4 pb-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("div",{className:"w-12 h-12 bg-indigo-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsxs("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 48 48",children:[a.jsx("rect",{width:"48",height:"48",rx:"12",fill:"#e0e7ff"}),a.jsx("path",{d:"M16 32V16h16v16H16zm2-2h12V18H18v12zm2-2v-8h8v8h-8z",fill:"#6366f1"})]})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Department Curriculum"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View and manage department-specific curriculum entries."})]})]}),i.length>0&&a.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-6 bg-white rounded-lg shadow-sm p-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Regulation:"}),a.jsx("select",{value:o??"",onChange:W=>l(W.target.value||null),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500",children:i.map(W=>a.jsx("option",{value:W,children:W},W))})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Semester:"}),a.jsx("select",{value:c??"",onChange:W=>u(W.target.value?Number(W.target.value):null),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500",children:s.map(W=>a.jsx("option",{value:W,children:W},W))})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Filter by Department"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:d.map(W=>{var C;const V=b===W,ae=(C=e.find(Y=>Y.department.id===W))==null?void 0:C.department,ee=(ae==null?void 0:ae.short_name)||(ae==null?void 0:ae.shortname)||(ae==null?void 0:ae.code)||(ae==null?void 0:ae.name)||`Dept ${W}`;return a.jsx("button",{onClick:()=>v(W),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${V?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:ee},W)})})]}),a.jsx("div",{className:"w-full overflow-x-auto bg-white rounded-lg shadow-md",children:a.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-indigo-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Code"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap min-w-[200px]",children:"Course"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"CAT"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Class"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Elective"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"L"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"T"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"P"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"S"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"C"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"INT"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"EXT"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"TTL"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Hours"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"QP Type"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Editable"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.filter(W=>(!b||W.department.id===b)&&(!o||W.regulation===o)&&(!c||W.semester===c)).map(W=>a.jsx("tr",{className:`hover:bg-gray-50 transition-colors ${W.editable?"bg-slate-50":""}`,children:h===W.id?a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{value:W.course_code||"",onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,course_code:V.target.value}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("textarea",{value:W.course_name||"",onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,course_name:V.target.value}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",style:{minHeight:"32px"},placeholder:"Course Name",rows:1,onInput:V=>{const ae=V.target;ae.style.height="32px",ae.style.height=ae.scrollHeight+"px"}})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{value:W.category||"",onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,category:V.target.value}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 edit-cell-input"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("select",{value:W.class_type||"THEORY",onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,class_type:V.target.value}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 edit-cell-input",style:{minWidth:90},children:em.map(V=>{const ae=ni(String(V)),ee=String(V).charAt(0).toUpperCase()+String(V).slice(1).toLowerCase();return a.jsx("option",{value:ae,children:ee},ae)})})}),a.jsx("td",{className:"px-3 py-2 text-center whitespace-nowrap",children:a.jsx("input",{type:"checkbox",checked:!!W.is_elective,onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,is_elective:V.target.checked}:ee)),className:"w-4 h-4"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:W.l||0,onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,l:Number(V.target.value)}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:W.t||0,onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,t:Number(V.target.value)}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:W.p||0,onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,p:Number(V.target.value)}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:W.s||0,onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,s:Number(V.target.value)}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:W.c||0,onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,c:Number(V.target.value)}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:W.internal_mark||"",onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,internal_mark:Number(V.target.value)}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:W.external_mark||"",onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,external_mark:Number(V.target.value)}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:W.total_mark||"",onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,total_mark:Number(V.target.value)}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:W.total_hours||"",onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,total_hours:Number(V.target.value)}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{value:W.question_paper_type||"",onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,question_paper_type:V.target.value}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:W.editable?a.jsx("span",{className:"text-emerald-600 font-semibold",children:"Yes"}):a.jsx("span",{className:"text-gray-400",children:"No"})}),a.jsxs("td",{className:"px-3 py-2 whitespace-nowrap",children:[a.jsx("button",{className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors mr-2",onClick:()=>f(W),title:"Save",children:a.jsx(rd,{className:"w-4 h-4"})}),a.jsx("button",{className:"p-2 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors",onClick:()=>p(null),title:"Cancel",children:a.jsx(bu,{className:"w-4 h-4"})})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.course_code||"-"}),a.jsx("td",{className:"px-3 py-2.5 text-sm text-gray-900 font-medium",children:W.course_name||"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.category||"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.class_type||"-"}),a.jsx("td",{className:"px-3 py-2.5 text-center whitespace-nowrap text-sm",children:W.is_elective?a.jsx("span",{className:"text-emerald-600 font-semibold",children:"Yes"}):a.jsx("span",{className:"text-gray-400",children:"No"})}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.l??0}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.t??0}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.p??0}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.s??0}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.c??0}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.internal_mark??"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.external_mark??"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.total_mark??"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.total_hours??"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.question_paper_type||"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.editable?a.jsx("span",{className:"text-emerald-600 font-semibold",children:"Yes"}):a.jsx("span",{className:"text-gray-400",children:"No"})}),a.jsxs("td",{className:"px-3 py-2.5 whitespace-nowrap",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[W.editable?a.jsx("button",{className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",onClick:()=>p(W.id),title:"Edit",children:a.jsx(dh,{className:"w-4 h-4"})}):a.jsx("div",{className:"w-8 h-8"}),g&&W.approval_status==="PENDING"?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>y(W.id,"approve"),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Approve",children:a.jsx(qee,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>y(W.id,"reject"),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Reject",children:a.jsx(bu,{className:"w-4 h-4"})})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-8 h-8"}),a.jsx("div",{className:"w-8 h-8"})]})]}),a.jsxs("div",{className:"text-xs mt-1 text-gray-600",children:["Status: ",a.jsx("strong",{className:"text-gray-900",children:W.approval_status||"APPROVED"})]})]})]})},W.id))})]})}),a.jsxs("div",{className:"mt-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Elective Options"}),w.length===0?a.jsx("div",{className:"text-gray-400 py-4",children:"No elective options for selected department/semester."}):a.jsx("div",{className:"space-y-6",children:w.map(W=>{const V=S.filter(ae=>ae.parent===W.id);return a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("div",{className:"text-lg font-bold text-gray-900",children:W.course_name||W.course_code||"Elective"}),a.jsx("button",{onClick:()=>B(W),className:"px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors",children:"Add Subject"})]}),a.jsx("div",{className:"w-full overflow-x-auto",children:a.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"Code"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"Course"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"CAT"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"Class"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"L"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"T"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"P"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"S"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"C"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"INT"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"EXT"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"TTL"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"Hours"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"QP Type"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:V.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:15,className:"px-3 py-4 text-gray-400 text-center",children:"No subjects added yet."})}):V.map(ae=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.course_code||"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.course_name||"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.category||"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.class_type||"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.l??0}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.t??0}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.p??0}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.s??0}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.c??0}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.internal_mark??"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.external_mark??"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.total_mark??"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.total_hours??"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.question_paper_type||"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm",children:ae.editable?a.jsx("span",{className:"text-emerald-600 font-semibold",children:"Yes"}):a.jsx("span",{className:"text-gray-400",children:"No"})}),a.jsx("button",{onClick:()=>oe(ae),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:a.jsx(dh,{className:"w-4 h-4"})})]})})]},ae.id))})]})})]},W.id)})})]}),k&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"w-full max-w-3xl mx-4 bg-white rounded-lg shadow-2xl p-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Add Elective Subject"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Course Name"}),a.jsx("input",{value:R.course_name||"",onChange:W=>M(V=>({...V,course_name:W.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Course Code"}),a.jsx("input",{value:R.course_code||"",onChange:W=>M(V=>({...V,course_code:W.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Class Type"}),a.jsxs("select",{value:R.class_type,onChange:W=>M(V=>({...V,class_type:W.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"THEORY",children:"THEORY"}),a.jsx("option",{value:"LAB",children:"LAB"}),a.jsx("option",{value:"TCPL",children:"TCPL"}),a.jsx("option",{value:"TCPR",children:"TCPR"}),a.jsx("option",{value:"PRACTICAL",children:"PRACTICAL"}),a.jsx("option",{value:"AUDIT",children:"AUDIT"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Category"}),a.jsx("input",{value:R.category||"",onChange:W=>M(V=>({...V,category:W.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"L"}),a.jsx("input",{type:"number",value:R.l??0,onChange:W=>M(V=>({...V,l:Number(W.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"T"}),a.jsx("input",{type:"number",value:R.t??0,onChange:W=>M(V=>({...V,t:Number(W.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"P"}),a.jsx("input",{type:"number",value:R.p??0,onChange:W=>M(V=>({...V,p:Number(W.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"S"}),a.jsx("input",{type:"number",value:R.s??0,onChange:W=>M(V=>({...V,s:Number(W.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"C"}),a.jsx("input",{type:"number",value:R.c??0,onChange:W=>M(V=>({...V,c:Number(W.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Internal Mark"}),a.jsx("input",{type:"number",value:R.internal_mark??"",onChange:W=>M(V=>({...V,internal_mark:W.target.value?Number(W.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"External Mark"}),a.jsx("input",{type:"number",value:R.external_mark??"",onChange:W=>M(V=>({...V,external_mark:W.target.value?Number(W.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Total Mark"}),a.jsx("input",{type:"number",value:R.total_mark??"",onChange:W=>M(V=>({...V,total_mark:W.target.value?Number(W.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Total Hours"}),a.jsx("input",{type:"number",value:R.total_hours??"",onChange:W=>M(V=>({...V,total_hours:W.target.value?Number(W.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Question Paper Type"}),a.jsx("input",{value:R.question_paper_type||"",onChange:W=>M(V=>({...V,question_paper_type:W.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{id:"add-editable",type:"checkbox",checked:!!R.editable,onChange:W=>M(V=>({...V,editable:W.target.checked})),className:"w-4 h-4"}),a.jsx("label",{htmlFor:"add-editable",className:"text-sm font-medium text-gray-700",children:"Editable"})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[a.jsx("button",{onClick:()=>A(!1),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-700 hover:bg-gray-50 font-medium transition-colors",children:"Cancel"}),a.jsx("button",{onClick:E,className:"px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors",children:"Save"})]})]})}),P&&G&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"w-full max-w-3xl mx-4 bg-white rounded-lg shadow-2xl p-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Edit Elective Subject"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Course Name"}),a.jsx("input",{value:G.course_name||"",onChange:W=>H(V=>({...V,course_name:W.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Course Code"}),a.jsx("input",{value:G.course_code||"",onChange:W=>H(V=>({...V,course_code:W.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Class Type"}),a.jsxs("select",{value:G.class_type||"THEORY",onChange:W=>H(V=>({...V,class_type:W.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"THEORY",children:"THEORY"}),a.jsx("option",{value:"LAB",children:"LAB"}),a.jsx("option",{value:"TCPL",children:"TCPL"}),a.jsx("option",{value:"TCPR",children:"TCPR"}),a.jsx("option",{value:"PRACTICAL",children:"PRACTICAL"}),a.jsx("option",{value:"AUDIT",children:"AUDIT"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Category"}),a.jsx("input",{value:G.category||"",onChange:W=>H(V=>({...V,category:W.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"L"}),a.jsx("input",{type:"number",value:G.l??0,onChange:W=>H(V=>({...V,l:Number(W.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"T"}),a.jsx("input",{type:"number",value:G.t??0,onChange:W=>H(V=>({...V,t:Number(W.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"P"}),a.jsx("input",{type:"number",value:G.p??0,onChange:W=>H(V=>({...V,p:Number(W.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"S"}),a.jsx("input",{type:"number",value:G.s??0,onChange:W=>H(V=>({...V,s:Number(W.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"C"}),a.jsx("input",{type:"number",value:G.c??0,onChange:W=>H(V=>({...V,c:Number(W.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Internal Mark"}),a.jsx("input",{type:"number",value:G.internal_mark??"",onChange:W=>H(V=>({...V,internal_mark:W.target.value?Number(W.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"External Mark"}),a.jsx("input",{type:"number",value:G.external_mark??"",onChange:W=>H(V=>({...V,external_mark:W.target.value?Number(W.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Total Mark"}),a.jsx("input",{type:"number",value:G.total_mark??"",onChange:W=>H(V=>({...V,total_mark:W.target.value?Number(W.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Total Hours"}),a.jsx("input",{type:"number",value:G.total_hours??"",onChange:W=>H(V=>({...V,total_hours:W.target.value?Number(W.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Question Paper Type"}),a.jsx("input",{value:G.question_paper_type||"",onChange:W=>H(V=>({...V,question_paper_type:W.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{id:"edit-editable",type:"checkbox",checked:!!G.editable,onChange:W=>H(V=>({...V,editable:W.target.checked})),className:"w-4 h-4"}),a.jsx("label",{htmlFor:"edit-editable",className:"text-sm font-medium text-gray-700",children:"Editable"})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[a.jsx("button",{onClick:()=>U(!1),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-700 hover:bg-gray-50 font-medium transition-colors",children:"Cancel"}),a.jsx("button",{onClick:de,className:"px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors",children:"Save"})]})]})})]})})}function pOe(){const[e,t]=x.useState(null),[r,n]=x.useState(!1),[i,s]=x.useState(null),[o,l]=x.useState([]),[c,u]=x.useState([]),[d,f]=x.useState([]),[h,p]=x.useState(""),[m,g]=x.useState(""),[y,b]=x.useState(""),[v,w]=x.useState([]),[S,j]=x.useState(!1);x.useEffect(()=>{k()},[h,m,y]),x.useEffect(()=>{A()},[]);const k=async()=>{j(!0);try{const U={};h&&(U.regulation=h),m&&(U.semester=m),y&&(U.department_id=y);const G=await pm(U);w(G||[])}catch(U){console.error("Failed to load electives:",U),w([])}finally{j(!1)}},A=async()=>{try{const U=await pm();if(!U||!Array.isArray(U))return;const G=[...new Set(U.map(de=>de.regulation))].filter(Boolean).sort(),H=[...new Set(U.map(de=>de.semester))].filter(Boolean).sort((de,W)=>de-W),oe=Array.from(new Map(U.map(de=>de.department).filter(Boolean).map(de=>[de.id,de])).values()).sort((de,W)=>(de.code||"").localeCompare(W.code||""));l(G),u(H),f(oe)}catch(U){console.error("Failed to load filter options:",U)}},R=async()=>{try{const U=await mr("/api/curriculum/elective-choices/template/");if(!U.ok){alert("Failed to download template");return}const G=await U.blob(),H=window.URL.createObjectURL(G),oe=document.createElement("a");oe.href=H,oe.download="elective_choices_template.csv",document.body.appendChild(oe),oe.click(),window.URL.revokeObjectURL(H),document.body.removeChild(oe)}catch(U){console.error("Download error:",U),alert("Failed to download template")}},M=async()=>{try{const U=await mr("/api/curriculum/elective-choices/template/?format=excel");if(!U.ok){alert("Failed to download Excel template");return}const G=await U.blob(),H=window.URL.createObjectURL(G),oe=document.createElement("a");oe.href=H,oe.download="elective_choices_template.xlsx",document.body.appendChild(oe),oe.click(),window.URL.revokeObjectURL(H),document.body.removeChild(oe)}catch(U){console.error("Download error:",U),alert("Failed to download Excel template")}},B=U=>{var H;const G=(H=U.target.files)==null?void 0:H[0];if(G){if(![".csv",".xlsx",".xls"].some(W=>G.name.toLowerCase().endsWith(W))){alert("Please select a CSV or Excel file (.csv, .xlsx, .xls)");return}t(G),s(null)}},E=async()=>{if(!e){alert("Please select a file first");return}n(!0),s(null);try{const U=new FormData;U.append("csv_file",e);const G=await mr("/api/curriculum/elective-choices/import/",{method:"POST",body:U});if(G.status===401){alert("Your session has expired. Please refresh the page and try again.");return}let H;try{H=await G.json()}catch(oe){console.error("Failed to parse response:",oe),alert("Import failed: Invalid response from server");return}if(G.ok){s(H),t(null);const oe=document.getElementById("file-input");oe&&(oe.value=""),k()}else{const oe=H.error||H.detail||H.message||"Import failed";alert(typeof oe=="string"?oe:"Import failed: "+JSON.stringify(oe).substring(0,200))}}catch(U){console.error("Upload error:",U),alert("Failed to upload file. Please check your connection and try again.")}finally{n(!1)}},P=v.filter(U=>{var G;return!(h&&U.regulation!==h||m&&U.semester!==m||y&&((G=U.department)==null?void 0:G.id)!==y)});return a.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-indigo-50 rounded-lg",children:a.jsx(ste,{className:"h-6 w-6 text-indigo-600"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Elective Import"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Import student elective choices from CSV or Excel"})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:R,className:"inline-flex items-center gap-2 px-4 py-2 bg-green-600 text-white font-medium rounded-lg hover:bg-green-700 transition-colors",children:[a.jsx(P4,{className:"h-5 w-5"}),"CSV Template"]}),a.jsxs("button",{onClick:M,className:"inline-flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white font-medium rounded-lg hover:bg-emerald-700 transition-colors",children:[a.jsx(P4,{className:"h-5 w-5"}),"Excel Template"]})]})]}),a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Upload File"}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{children:a.jsxs("label",{htmlFor:"file-input",className:"flex flex-col items-center justify-center w-full h-24 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100 transition-colors",children:[a.jsxs("div",{className:"flex flex-col items-center justify-center",children:[a.jsx(P2,{className:"h-8 w-8 text-gray-400 mb-2"}),a.jsx("p",{className:"text-sm text-gray-600",children:e?a.jsx("span",{className:"font-medium text-indigo-600",children:e.name}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]})}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"CSV or Excel files (.csv, .xlsx, .xls)"})]}),a.jsx("input",{id:"file-input",type:"file",className:"hidden",accept:".csv,.xlsx,.xls",onChange:B})]})}),a.jsxs("button",{onClick:E,disabled:!e||r,className:`w-full inline-flex items-center justify-center gap-2 px-6 py-3 font-medium rounded-lg transition-colors ${!e||r?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-indigo-600 text-white hover:bg-indigo-700"}`,children:[a.jsx(P2,{className:"h-5 w-5"}),r?"Uploading...":"Upload and Import"]})]})]}),i&&a.jsx("div",{className:`rounded-lg shadow-sm p-6 mb-6 ${i.errors&&i.errors.length>0?"bg-yellow-50 border border-yellow-200":"bg-green-50 border border-green-200"}`,children:a.jsxs("div",{className:"flex items-start gap-3",children:[i.errors&&i.errors.length>0?a.jsx(ed,{className:"h-6 w-6 text-yellow-600 flex-shrink-0 mt-0.5"}):a.jsx(y3,{className:"h-6 w-6 text-green-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:`text-lg font-semibold mb-2 ${i.errors&&i.errors.length>0?"text-yellow-900":"text-green-900"}`,children:i.message}),a.jsxs("div",{className:`space-y-1 text-sm ${i.errors&&i.errors.length>0?"text-yellow-800":"text-green-800"}`,children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Created:"})," ",i.created," entries"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Updated:"})," ",i.updated," entries"]}),i.errors&&i.errors.length>0&&a.jsxs("div",{className:"mt-3",children:[a.jsxs("p",{className:"font-semibold text-red-700 mb-2",children:["Errors (",i.errors.length,"):"]}),a.jsx("ul",{className:"list-disc list-inside space-y-1 text-red-600 max-h-40 overflow-y-auto",children:i.errors.map((U,G)=>a.jsx("li",{className:"text-xs",children:U},G))})]})]})]})]})}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(ute,{className:"h-5 w-5 text-gray-600"}),a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Elective Subjects"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Regulation"}),a.jsxs("select",{value:h,onChange:U=>p(U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"All Regulations"}),o.map(U=>a.jsx("option",{value:U,children:U},U))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Semester"}),a.jsxs("select",{value:m,onChange:U=>g(U.target.value?Number(U.target.value):""),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"All Semesters"}),c.map(U=>a.jsxs("option",{value:U,children:["Semester ",U]},U))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),a.jsxs("select",{value:y,onChange:U=>b(U.target.value?Number(U.target.value):""),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"All Departments"}),d.map(U=>a.jsxs("option",{value:U.id,children:[U.code," - ",U.short_name||U.name]},U.id))]})]})]}),S?a.jsx("div",{className:"text-center py-8 text-gray-600",children:"Loading electives..."}):P.length===0?a.jsx("div",{className:"text-center py-8 text-gray-500",children:"No electives found"}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Course Code"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Course Name"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Regulation"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Semester"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[a.jsx(ys,{className:"h-4 w-4"}),"Students"]})})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:P.map(U=>{var G;return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:U.course_code||""}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:U.course_name||""}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600",children:U.regulation||""}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600",children:U.semester||""}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600",children:((G=U.department)==null?void 0:G.code)||""}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:a.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${U.student_count>0?"bg-indigo-100 text-indigo-800":"bg-gray-100 text-gray-600"}`,children:U.student_count})})]},U.id)})})]})})]})]})})}function mOe(){var e;if(typeof window<"u"&&((e=window.location)!=null&&e.origin)){const t=String(window.location.hostname||"").trim().toLowerCase();return t==="localhost"||t==="127.0.0.1"?"http://localhost:8000":String(window.location.origin).replace(/\/+$/,"")}return"https://db.krgi.co.in"}const Lp=mOe();function ox(){const e=window.localStorage.getItem("access");return e?{Authorization:`Bearer ${e}`}:{}}function RK(){var ke;const[e,t]=x.useState([]),[r,n]=x.useState("courses"),[i,s]=x.useState(null),[o,l]=x.useState([]),[c,u]=x.useState(!1),[d,f]=x.useState(!1),[h,p]=x.useState(1),[m,g]=x.useState("idle"),[y,b]=x.useState(null),[v,w]=x.useState([]),[S,j]=x.useState(null),[k,A]=x.useState(""),[R,M]=x.useState(""),[B,E]=x.useState(""),[P,U]=x.useState(""),[G,H]=x.useState(""),[oe,de]=x.useState(!1),[W,V]=x.useState(null),[ae,ee]=x.useState(null),[C,Y]=x.useState([]),[q,O]=x.useState(!1),[X,F]=x.useState(0),[Q,K]=x.useState([]),[ne,re]=x.useState(null),[T,I]=x.useState(null),[ie,D]=x.useState(null);function Z(ce){try{if(typeof ce=="string"){let we=ce;return!we.startsWith("data:")&&/^[A-Za-z0-9+/=\n\r]+$/.test(we)&&we.length>100&&(we=`data:image/png;base64,${we.replace(/\s+/g,"")}`),we}if(ce&&typeof ce=="object"){if(typeof ce.url=="string"&&ce.url)return ce.url;if(typeof ce.base64=="string"&&ce.base64)return ce.base64.startsWith("data:")?ce.base64:`data:image/png;base64,${ce.base64}`;if(ce.binary&&ce.binary instanceof Uint8Array){const we=new Blob([ce.binary],{type:"image/png"});return URL.createObjectURL(we)}}if(ce instanceof Uint8Array){const we=new Blob([ce],{type:"image/png"});return URL.createObjectURL(we)}return null}catch{return null}}x.useEffect(()=>{ah().then(ce=>s(ce)).catch(()=>s(null)),(async()=>{try{u(!0);const ce=await hc();Array.isArray(ce)&&l(ce)}catch(ce){console.warn("Failed to load teaching assignments",ce),l([])}finally{u(!1)}})(),(async()=>{try{const ce=await fetch(`${Lp}/api/obe/list-uploads`,{headers:{...ox()}});if(!ce.ok)return;const we=await ce.json();Array.isArray(we==null?void 0:we.files)&&K(we.files||[])}catch{}})()},[]);const me=x.useMemo(()=>i?i.faculty_id??i.staff_id??i.employee_id??i.id??null:null,[i]),Te=ce=>{const we=parseFloat(ce.replace(/[^0-9.\-]/g,""));return Number.isFinite(we)?we:0},je=ce=>{const we=`/obe/course/${encodeURIComponent(ce)}`;window.location.href=we},Le=x.useMemo(()=>(v||[]).filter(ce=>{const we=String((ce==null?void 0:ce.marks)??"").trim().toUpperCase(),ht=String((ce==null?void 0:ce.btl)??"").trim().toUpperCase(),nt=String((ce==null?void 0:ce.course_outcomes)??"").trim().toUpperCase();return!(we==="(OR)"&&ht==="(OR)"&&nt==="(OR)")}),[v]),[_e,He]=x.useState("idle"),[We,Pt]=x.useState(null);async function dt(ce){He("uploading"),Pt(null),g("idle"),b(null),V(null),ee(null);const we=new FormData;we.append("file",ce);try{const ht=await fetch(`${Lp}/api/obe/upload-docx`,{method:"POST",headers:{...ox()},body:we});if(!ht.ok){const Nt=await ht.text();He("error"),Pt(Nt||`Upload failed (${ht.status})`);return}const nt=await ht.json();He("success");const Ie=(nt==null?void 0:nt.file_url)||(nt==null?void 0:nt.saved_path)||"";j(Ie||null),Pt(`Uploaded: ${Ie}`),f(!0),p(1),w([]),g("scanning"),b("Scanning DOCX");const It=new FormData;It.append("file",ce);const ct=await fetch(`${Lp}/api/template/scan-docx`,{method:"POST",headers:{...ox()},body:It});if(!ct.ok){const Nt=await ct.text();g("error"),b(Nt||`Scan failed (${ct.status})`),w([]);return}const Mt=await ct.json(),Pr=(Array.isArray(Mt==null?void 0:Mt.questions)?Mt.questions:[]).map(Nt=>({...Nt,source_file_path:Ie||Nt.source_file_path||null}));if(w(Pr),g("success"),b(`Scanned ${Pr.length} question(s).`),!k.trim()){const Nt=ce.name.replace(/\.docx$/i,"");A(Nt)}}catch(ht){He("error"),Pt((ht==null?void 0:ht.message)||"Upload failed"),g("error"),b((ht==null?void 0:ht.message)||"Scan failed")}}function Ye(){f(!1),p(1)}async function lt(){if(!k.trim()){ee("Exam name is required."),p(2);return}if(!B.trim()){ee("Exam type is required."),p(2);return}if(!P.trim()){ee("Exam date is required."),p(2);return}de(!0),ee(null),V(null);try{const ce=G.split(/\r?\n/).map(It=>It.trim()).filter(Boolean),we=Le.map(It=>({...It,excel_type:It.excel_type||B,source_file_path:It.source_file_path||S||null})),ht=await fetch(`${Lp}/api/import/questions`,{method:"POST",headers:{"Content-Type":"application/json",...ox()},body:JSON.stringify({title:k.trim(),status:"pending",exam_type:B.trim(),exam_date:P.trim(),sections:ce,faculty_id:me,questions:we})});if(!ht.ok){const It=await ht.text();ee(It||`Import failed (${ht.status})`);return}const nt=await ht.json();V(nt);const Ie={title:k.trim(),inserted:nt.inserted||0,failed:Array.isArray(nt.failed)?nt.failed.length:0,source_file_path:S||null,title_id:nt.title_id||null,exam_date:P||null,exam_type:B||null,faculty_id:me||null,created_at:new Date().toISOString()};Y(It=>[Ie,...It]),O(!0),setTimeout(()=>O(!1),4e3),setTimeout(()=>Ye(),600)}catch(ce){ee((ce==null?void 0:ce.message)||"Import failed")}finally{de(!1)}}const be=e.length;return be&&(e.reduce((ce,we)=>ce+Te(we.achieved),0)/be).toFixed(1)+"",a.jsxs("main",{className:"obe-page",style:{padding:"32px 48px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',minHeight:"100vh",background:"linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)"},children:[a.jsx("header",{style:{marginBottom:32,background:"#fff",padding:"28px 32px",borderRadius:16,boxShadow:"0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04)"},children:a.jsx("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"flex-end",width:"100%"},children:a.jsxs("div",{style:{textAlign:"left"},children:[a.jsx("h1",{style:{margin:0,fontSize:32,fontWeight:700,color:"#0f172a",letterSpacing:"-0.02em"},children:"Outcome Based Education (OBE)"}),a.jsx("div",{style:{marginTop:8,color:"#64748b",fontSize:16,fontWeight:400},children:"Select a course, then work through CDAP, Articulation Matrix and Mark Entry."})]})})}),a.jsxs("div",{style:{display:"flex",gap:6,marginBottom:24,background:"#fff",padding:"8px",borderRadius:12,boxShadow:"0 1px 3px rgba(0,0,0,0.06)"},children:[a.jsx("button",{onClick:()=>n("courses"),style:{padding:"10px 24px",borderRadius:8,border:"none",background:r==="courses"?"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)":"transparent",color:r==="courses"?"#fff":"#64748b",cursor:"pointer",fontWeight:r==="courses"?600:500,fontSize:15,transition:"all 0.2s ease",boxShadow:r==="courses"?"0 2px 8px rgba(37,99,235,0.2)":"none"},children:" Courses"}),a.jsx("button",{onClick:()=>n("exam"),style:{padding:"10px 24px",borderRadius:8,border:"none",background:r==="exam"?"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)":"transparent",color:r==="exam"?"#fff":"#64748b",cursor:"pointer",fontWeight:r==="exam"?600:500,fontSize:15,transition:"all 0.2s ease",boxShadow:r==="exam"?"0 2px 8px rgba(37,99,235,0.2)":"none"},children:" Exam Management"})]}),r==="courses"&&a.jsxs("section",{"aria-label":"Course selector",style:{marginBottom:32},children:[a.jsx("div",{style:{fontSize:14,color:"#475569",marginBottom:20,fontWeight:500},children:"Select a course to work on:"}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(320px, 1fr))",gap:24,marginBottom:32},children:c?a.jsx("div",{style:{gridColumn:"1/-1",color:"#64748b",fontSize:16,textAlign:"center",padding:60,background:"#fff",borderRadius:12},children:" Loading courses"}):o.length===0?a.jsxs("div",{style:{gridColumn:"1/-1",color:"#94a3b8",fontSize:18,textAlign:"center",padding:60,background:"#fff",borderRadius:12,border:"2px dashed #e2e8f0"},children:[" No courses found. You have no teaching assignments.",a.jsx("br",{}),a.jsx("span",{style:{fontSize:14,marginTop:12,display:"block"},children:"(If you expect to see courses here, please check with your backend/API or contact admin.)"})]}):o.reduce((ce,we)=>(ce.some(ht=>ht.subject_code===we.subject_code)||ce.push(we),ce),[]).map(ce=>a.jsxs("div",{onClick:()=>je(ce.subject_code),role:"button",tabIndex:0,onKeyDown:we=>{we.key==="Enter"&&je(ce.subject_code)},onMouseEnter:we=>{we.currentTarget.style.transform="translateY(-4px)",we.currentTarget.style.boxShadow="0 12px 24px rgba(0,0,0,0.1), 0 4px 8px rgba(0,0,0,0.06)",we.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:we=>{we.currentTarget.style.transform="translateY(0)",we.currentTarget.style.boxShadow="0 4px 6px rgba(0,0,0,0.07), 0 2px 4px rgba(0,0,0,0.05)",we.currentTarget.style.borderColor="#e2e8f0"},style:{border:"1px solid #e2e8f0",borderRadius:12,padding:24,background:"#fff",boxShadow:"0 4px 6px rgba(0,0,0,0.07), 0 2px 4px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",alignItems:"flex-start",minHeight:140,position:"relative",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",cursor:"pointer"},children:[a.jsx("div",{style:{fontWeight:700,fontSize:19,marginBottom:6,color:"#0f172a",lineHeight:1.3},children:ce.subject_name}),a.jsx("div",{style:{fontSize:14,color:"#3b82f6",marginBottom:16,fontWeight:600,background:"#eff6ff",padding:"4px 10px",borderRadius:6},children:ce.subject_code}),a.jsxs("div",{style:{marginTop:"auto",display:"flex",gap:10,alignItems:"center",flexWrap:"wrap"},children:[a.jsx("button",{onClick:we=>{we.stopPropagation(),je(ce.subject_code)},onMouseEnter:we=>{we.currentTarget.style.background="linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%)",we.currentTarget.style.transform="scale(1.05)"},onMouseLeave:we=>{we.currentTarget.style.background="linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",we.currentTarget.style.transform="scale(1)"},style:{padding:"8px 18px",borderRadius:8,border:"none",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"#fff",fontWeight:600,fontSize:14,cursor:"pointer",boxShadow:"0 2px 4px rgba(37,99,235,0.2)",transition:"all 0.2s ease"},children:"Open Course"}),a.jsx("button",{onClick:we=>{we.stopPropagation(),window.location.href=`/obe/course/${encodeURIComponent(ce.subject_code)}/lca`},onMouseEnter:we=>{we.currentTarget.style.background="#f8fafc",we.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:we=>{we.currentTarget.style.background="#fff",we.currentTarget.style.borderColor="#e2e8f0"},style:{padding:"8px 14px",borderRadius:8,border:"1px solid #e2e8f0",background:"#fff",color:"#475569",fontWeight:600,fontSize:13,cursor:"pointer",transition:"all 0.2s ease"},children:"LCA"}),a.jsx("button",{onClick:we=>{we.stopPropagation(),window.location.href=`/obe/course/${encodeURIComponent(ce.subject_code)}/co_attainment`},onMouseEnter:we=>{we.currentTarget.style.background="#f8fafc",we.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:we=>{we.currentTarget.style.background="#fff",we.currentTarget.style.borderColor="#e2e8f0"},style:{padding:"8px 14px",borderRadius:8,border:"1px solid #e2e8f0",background:"#fff",color:"#475569",fontWeight:600,fontSize:13,cursor:"pointer",transition:"all 0.2s ease"},children:"CO"})]})]},ce.subject_code))})]}),r==="exam"&&a.jsx("section",{"aria-label":"Exam management",style:{background:"#fff",padding:28,borderRadius:16,boxShadow:"0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04)"},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20},children:[a.jsx("div",{style:{background:"#f8fafc",padding:20,borderRadius:12,border:"2px dashed #cbd5e1"},children:a.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center"},children:[a.jsx("input",{id:"exam-upload-input",type:"file",accept:".docx",style:{display:"none"},onChange:ce=>{const we=ce.target.files&&ce.target.files[0];we&&dt(we),ce.currentTarget.value=""}}),a.jsx("label",{htmlFor:"exam-upload-input",style:{display:"inline-flex",alignItems:"center",gap:10,padding:"12px 20px",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"#fff",borderRadius:10,cursor:"pointer",fontWeight:600,fontSize:15,boxShadow:"0 2px 8px rgba(37,99,235,0.25)",transition:"all 0.2s ease"},children:_e==="uploading"?" Uploading...":" Upload .docx"}),a.jsx("div",{style:{color:"#64748b",fontSize:14},children:"Upload exam spreadsheets or related files here."})]})}),a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[a.jsx("input",{type:"search",placeholder:" Search exams, courses, entries...",style:{flex:1,padding:"12px 16px",borderRadius:10,border:"1px solid #e2e8f0",fontSize:15,background:"#fff",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},onChange:()=>{}}),a.jsx("button",{style:{padding:"12px 20px",borderRadius:10,border:"1px solid #e2e8f0",background:"#fff",cursor:"pointer",fontWeight:600,fontSize:14,color:"#475569",transition:"all 0.2s ease",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:"Search"})]}),a.jsxs("div",{style:{marginTop:8},children:[a.jsx("h3",{style:{margin:"12px 0 16px 0",fontSize:18,fontWeight:700,color:"#0f172a"},children:" Recent"}),C.length===0?a.jsxs("div",{style:{color:"#666"},children:[a.jsx("div",{style:{marginBottom:8,fontSize:13},children:"Uploaded DOCX files"}),Q.length===0?a.jsx("div",{style:{color:"#666"},children:"No uploaded DOCX files found."}):a.jsx("div",{style:{display:"grid",gap:8},children:Q.map((ce,we)=>a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:8,padding:10,background:"#fff",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:700},children:ce.name}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:ce.path})]}),a.jsx("div",{children:a.jsx("button",{onClick:()=>re(ce),style:{background:"none",border:"none",color:"#2563eb",cursor:"pointer",padding:6},children:"Open"})})]},we))})]}):a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"320px 1fr",gap:12},children:[a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:C.slice(0,12).map((ce,we)=>{const ht=we===X;return a.jsxs("div",{onClick:()=>F(we),role:"button",tabIndex:0,style:{border:ht?"2px solid #2563eb":"1px solid #e5e7eb",borderRadius:8,padding:10,background:"#fff",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer"},children:[a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,children:[a.jsx("path",{d:"M6 2h7l5 5v13a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1z",fill:"#e6f0ff",stroke:"#2563eb",strokeWidth:"0.5"}),a.jsx("path",{d:"M13 2v6h6",fill:"#fff"}),a.jsx("rect",{x:"7",y:"11",width:"10",height:"2.2",rx:"0.6",fill:"#2563eb"}),a.jsx("rect",{x:"7",y:"14",width:"6",height:"2.2",rx:"0.6",fill:"#2563eb"}),a.jsx("text",{x:"7",y:"18.8",fontSize:"2.8",fill:"#2563eb",fontFamily:"Arial, Helvetica, sans-serif",children:"DOCX"})]}),a.jsx("div",{style:{fontWeight:700},children:ce.title})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[ce.exam_type||"","  ",ce.exam_date||""]})]}),a.jsxs("div",{style:{textAlign:"right"},children:[a.jsx("div",{style:{fontWeight:800,color:"#16a34a"},children:ce.inserted}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"questions"})]})]},we)})}),a.jsx("div",{children:C[X]&&a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"Preview"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"240px 1fr",gap:12},children:[a.jsxs("div",{children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,marginBottom:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[a.jsx("div",{style:{width:64,height:64,borderRadius:8,background:"#f3f4f6",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,color:"#6b7280"},children:i!=null&&i.username?String(i.username).slice(0,1).toUpperCase():"U"}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:16,fontWeight:800,color:"#111827"},children:(i==null?void 0:i.username)||""}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Faculty"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:""})]})]}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Faculty ID: ",a.jsx("strong",{style:{color:"#111827"},children:me??""})]})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:13,color:"#6b7280",marginBottom:8},children:"Course details"}),a.jsx("div",{style:{fontWeight:700},children:""}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:""}),a.jsxs("div",{style:{marginTop:8,fontSize:12,color:"#6b7280"},children:["Assignments: ",a.jsx("strong",{style:{color:"#111827"},children:""})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,marginBottom:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Questions imported"}),a.jsx("div",{style:{fontSize:20,fontWeight:900,color:"#111827"},children:C[X].inserted})]}),a.jsxs("div",{style:{textAlign:"right"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Title"}),a.jsx("div",{style:{fontWeight:700},children:C[X].title||""}),a.jsx("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:"Assessment"}),a.jsx("div",{style:{fontWeight:700},children:C[X].exam_type||""})]})]}),a.jsxs("div",{style:{marginTop:12,display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[a.jsxs("div",{children:[a.jsx("span",{style:{color:"#6b7280",fontSize:12},children:"Exam Type"}),a.jsx("div",{style:{fontWeight:700},children:C[X].exam_type||""})]}),a.jsxs("div",{children:[a.jsx("span",{style:{color:"#6b7280",fontSize:12},children:"Exam date"}),a.jsx("div",{style:{fontWeight:700},children:C[X].exam_date||""})]}),a.jsxs("div",{style:{gridColumn:"1 / -1"},children:[a.jsx("span",{style:{color:"#6b7280",fontSize:12},children:"Uploaded file"}),a.jsx("div",{style:{fontWeight:700,whiteSpace:"pre-wrap"},children:C[X].source_file_path||""})]})]})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Questions preview"}),a.jsx("div",{children:a.jsx("button",{onClick:async()=>{var ce,we;I(null);try{const ht=(ce=C[X])==null?void 0:ce.title_id;let nt="";ht?nt=`${Lp}/api/import/questions/list?title_id=${ht}`:nt=`${Lp}/api/import/questions/list?title=${encodeURIComponent(((we=C[X])==null?void 0:we.title)||"")}`;const Ie=await fetch(nt,{headers:{...ox()}});if(!Ie.ok){I([]);return}const It=await Ie.json();I(Array.isArray(It==null?void 0:It.questions)?It.questions:[])}catch{I([])}},style:{padding:"6px 10px",borderRadius:8,border:"1px solid #e5e7eb",background:"#fff",cursor:"pointer"},children:"Load questions"})})]}),a.jsx("div",{style:{maxHeight:220,overflow:"auto"},children:T===null?a.jsx("div",{style:{color:"#6b7280"},children:'Click "Load questions" to fetch saved questions for this import.'}):T.length===0?a.jsx("div",{style:{color:"#6b7280"},children:"No saved questions found for this title."}):T.slice(0,20).map((ce,we)=>a.jsxs("div",{style:{padding:"8px 6px",borderBottom:"1px solid #f3f4f6"},children:[a.jsxs("div",{style:{fontWeight:700,color:"#111827"},children:[we+1,"."]}),a.jsx("div",{style:{color:"#111827"},children:String(ce.question_text).slice(0,300)})]},we))})]})]})]})]})})]})]}),We&&a.jsx("div",{style:{marginTop:12,fontSize:14,color:_e==="error"?"#dc2626":"#16a34a",background:_e==="error"?"#fef2f2":"#f0fdf4",padding:"12px 16px",borderRadius:10,border:`1px solid ${_e==="error"?"#fecaca":"#bbf7d0"}`},children:We})]})}),d&&a.jsx("div",{role:"dialog","aria-modal":"true",onClick:Ye,style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",backdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50,padding:20},children:a.jsxs("div",{onClick:ce=>ce.stopPropagation(),style:{width:"min(1000px, 100%)",background:"#fff",borderRadius:16,boxShadow:"0 20px 50px rgba(0,0,0,0.3)",overflow:"hidden",border:"1px solid #e2e8f0"},children:[a.jsxs("div",{style:{padding:"20px 24px",borderBottom:"1px solid #e2e8f0",display:"flex",alignItems:"center",justifyContent:"space-between",background:"linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:700,fontSize:20,color:"#0f172a"},children:" Question Import"}),a.jsxs("div",{style:{color:"#64748b",fontSize:14,marginTop:4},children:["Step ",h," of 3  ",m==="scanning"?"Scanning":m==="error"?"Scan failed":"Ready"]})]}),a.jsx("button",{onClick:Ye,onMouseEnter:ce=>{ce.currentTarget.style.background="#fee2e2"},onMouseLeave:ce=>{ce.currentTarget.style.background="#fff"},style:{padding:"8px 14px",borderRadius:8,border:"1px solid #e2e8f0",background:"#fff",cursor:"pointer",fontWeight:600,fontSize:14,color:"#64748b",transition:"all 0.2s ease"},children:" Close"})]}),a.jsx("div",{style:{overflow:"hidden",background:"#fafbfc"},children:a.jsxs("div",{style:{display:"flex",width:"300%",transform:`translateX(-${(h-1)*33.3333333}%)`,transition:"transform 360ms cubic-bezier(0.4, 0, 0.2, 1)"},children:[a.jsxs("div",{style:{width:"33.3333333%",padding:24},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,marginBottom:16},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:700,fontSize:18,color:"#0f172a"},children:" Preview"}),a.jsx("div",{style:{fontSize:13,color:"#64748b",marginTop:2},children:S?`Source: ${S}`:"Source: (not available)"})]}),a.jsxs("div",{style:{fontSize:14,color:"#0f172a",background:"#eff6ff",padding:"6px 12px",borderRadius:8,fontWeight:600},children:["Questions: ",a.jsx("b",{style:{color:"#3b82f6"},children:Le.length})]})]}),y&&a.jsx("div",{style:{marginBottom:12,fontSize:14,color:m==="error"?"#dc2626":"#16a34a",background:m==="error"?"#fef2f2":"#f0fdf4",padding:"12px 16px",borderRadius:10,border:`1px solid ${m==="error"?"#fecaca":"#bbf7d0"}`},children:y}),a.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:16,maxHeight:420,overflow:"auto",background:"#fff",boxShadow:"0 2px 8px rgba(0,0,0,0.05)"},children:[m==="scanning"&&a.jsx("div",{style:{color:"#64748b",textAlign:"center",padding:40},children:" Scanning your DOCX"}),m!=="scanning"&&Le.length===0&&a.jsx("div",{style:{color:"#94a3b8",textAlign:"center",padding:40},children:" No questions to preview yet."}),Le.map((ce,we)=>a.jsxs("div",{style:{padding:"14px 12px",borderBottom:we<Le.length-1?"1px solid #f1f5f9":"none"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:10,marginBottom:8},children:[a.jsxs("div",{style:{fontWeight:700,color:"#3b82f6",fontSize:15,background:"#eff6ff",padding:"4px 10px",borderRadius:6},children:["Q",we+1]}),a.jsxs("div",{style:{fontSize:12,color:"#64748b",background:"#f8fafc",padding:"4px 10px",borderRadius:6},children:["Marks: ",String((ce==null?void 0:ce.marks)??"-")," "," BTL: ",String((ce==null?void 0:ce.btl)??"-")," "," CO: ",String((ce==null?void 0:ce.course_outcomes)??"-")]})]}),a.jsxs("div",{style:{marginTop:8,color:"#1e293b",whiteSpace:"pre-wrap",fontSize:14,lineHeight:1.6},children:[String((ce==null?void 0:ce.question_text)??"").slice(0,500),String((ce==null?void 0:ce.question_text)??"").length>500?"":""]}),Array.isArray(ce==null?void 0:ce.images)&&ce.images.length?a.jsx("div",{style:{marginTop:12,display:"flex",gap:12,flexWrap:"wrap"},children:ce.images.slice(0,4).map((ht,nt)=>{const Ie=Z(ht);return Ie?a.jsx("img",{src:Ie,alt:`q${we+1}-img${nt+1}`,onClick:()=>D(Ie),style:{maxHeight:140,borderRadius:10,border:"2px solid #e2e8f0",cursor:"pointer",objectFit:"contain",background:"#fff",transition:"all 0.2s ease",boxShadow:"0 2px 6px rgba(0,0,0,0.08)"}},nt):null})}):null]},we))]})]}),a.jsxs("div",{style:{width:"33.3333333%",padding:24},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:16,fontSize:18,color:"#0f172a"},children:" Save details"}),ae&&a.jsx("div",{style:{marginBottom:12,fontSize:14,color:"#dc2626",background:"#fef2f2",padding:"12px 16px",borderRadius:10,border:"1px solid #fecaca"},children:ae}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"Exam name"}),a.jsx("input",{value:k,onChange:ce=>A(ce.target.value),placeholder:"e.g., Unit 1 - Introduction",style:{width:"100%",padding:"12px 14px",borderRadius:10,border:"1px solid #e6eef8",boxShadow:"inset 0 1px 2px #00000008"}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"Exam (CIA / Model / ESE)"}),a.jsxs("select",{value:R,onChange:ce=>M(ce.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:10,border:"1px solid #e6eef8",background:"#fff"},children:[a.jsx("option",{value:"",children:"Select assessment"}),a.jsx("option",{value:"CIA1",children:"CIA1"}),a.jsx("option",{value:"CIA2",children:"CIA2"}),a.jsx("option",{value:"MODEL",children:"MODEL"}),a.jsx("option",{value:"ESE",children:"ESE"})]})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"Exam Type"}),a.jsxs("select",{value:B,onChange:ce=>E(ce.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:10,border:"1px solid #e6eef8",background:"#fff"},children:[a.jsx("option",{value:"",children:"Select paper"}),a.jsx("option",{value:"QP1",children:"QP1"}),a.jsx("option",{value:"QP2",children:"QP2"})]})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"Exam date"}),a.jsx("input",{type:"date",value:P,onChange:ce=>U(ce.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:10,border:"1px solid #e6eef8"}})]}),a.jsxs("div",{style:{gridColumn:"1 / -1"},children:[a.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"Sections"}),a.jsx("textarea",{value:G,onChange:ce=>H(ce.target.value),placeholder:"e.g., Part A\\nPart B\\nSection 1",rows:3,style:{width:"100%",padding:"12px 14px",borderRadius:10,border:"1px solid #e6eef8",resize:"vertical"}})]})]}),a.jsx("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:"This metadata is shown for confirmation. (Currently, only the exam name is used as the imported title.)"})]}),a.jsxs("div",{style:{width:"33.3333333%",padding:24},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:16,fontSize:18,color:"#0f172a"},children:" Confirmation"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr",gap:16},children:[a.jsxs("div",{children:[a.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:16,marginBottom:16,background:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[a.jsx("div",{style:{width:64,height:64,borderRadius:10,background:"linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%)",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,color:"#3b82f6",fontSize:24},children:i!=null&&i.username?String(i.username).slice(0,1).toUpperCase():""}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#0f172a"},children:(i==null?void 0:i.username)||""}),a.jsx("div",{style:{fontSize:13,color:"#64748b"},children:"Faculty"})]})]}),a.jsxs("div",{style:{marginTop:12,fontSize:13,color:"#475569",background:"#f8fafc",padding:"8px 12px",borderRadius:8},children:["Faculty ID: ",a.jsx("strong",{style:{color:"#0f172a"},children:me??""})]})]}),a.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:16,background:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[a.jsx("div",{style:{fontSize:13,color:"#64748b",marginBottom:10,fontWeight:600},children:" Course details"}),a.jsx("div",{style:{fontWeight:700,color:"#0f172a"},children:""}),a.jsx("div",{style:{fontSize:13,color:"#64748b",marginTop:2},children:""}),a.jsxs("div",{style:{marginTop:12,fontSize:13,color:"#475569"},children:["Assignments: ",a.jsx("strong",{style:{color:"#0f172a"},children:""})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:16,marginBottom:16,background:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:16,flexWrap:"wrap"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:13,color:"#64748b",fontWeight:600},children:"Questions to import"}),a.jsx("div",{style:{fontSize:28,fontWeight:900,color:"#3b82f6",marginTop:4},children:Le.length})]}),a.jsxs("div",{style:{textAlign:"right"},children:[a.jsx("div",{style:{fontSize:13,color:"#64748b",fontWeight:600},children:"Exam name"}),a.jsx("div",{style:{fontWeight:700,color:"#0f172a",fontSize:16,marginTop:2},children:k||""}),a.jsx("div",{style:{marginTop:8,fontSize:13,color:"#64748b",fontWeight:600},children:"Assessment"}),a.jsx("div",{style:{fontWeight:700,color:"#0f172a",marginTop:2},children:R||""})]})]}),a.jsxs("div",{style:{marginTop:16,display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,background:"#f8fafc",padding:12,borderRadius:8},children:[a.jsxs("div",{children:[a.jsx("span",{style:{color:"#64748b",fontSize:13,fontWeight:600},children:"Exam Type"}),a.jsx("div",{style:{fontWeight:700,color:"#0f172a",marginTop:4},children:B||""})]}),a.jsxs("div",{children:[a.jsx("span",{style:{color:"#64748b",fontSize:13,fontWeight:600},children:"Exam date"}),a.jsx("div",{style:{fontWeight:700,color:"#0f172a",marginTop:4},children:P||""})]}),a.jsxs("div",{style:{gridColumn:"1 / -1"},children:[a.jsx("span",{style:{color:"#64748b",fontSize:13,fontWeight:600},children:"Sections"}),a.jsx("div",{style:{fontWeight:700,color:"#0f172a",whiteSpace:"pre-wrap",marginTop:4},children:G||""})]})]})]}),a.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:16,background:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[a.jsx("div",{style:{fontSize:14,color:"#64748b",marginBottom:10,fontWeight:600},children:" Questions preview"}),a.jsx("div",{style:{maxHeight:240,overflow:"auto"},children:Le.slice(0,10).map((ce,we)=>a.jsxs("div",{style:{padding:"10px 8px",borderBottom:we<Math.min(Le.length,10)-1?"1px solid #f1f5f9":"none",display:"flex",gap:12,alignItems:"flex-start"},children:[a.jsx("div",{style:{fontWeight:700,color:"#3b82f6",minWidth:40,background:"#eff6ff",padding:"4px 8px",borderRadius:6,textAlign:"center"},children:we+1}),a.jsxs("div",{style:{flex:1},children:[a.jsx("div",{style:{color:"#1e293b",fontSize:14,lineHeight:1.5},children:String(ce.question_text).slice(0,260)}),Array.isArray(ce.images)&&ce.images.length?a.jsx("div",{style:{display:"flex",gap:10,marginTop:8},children:ce.images.slice(0,2).map((ht,nt)=>{const Ie=Z(ht);return Ie?a.jsx("img",{src:Ie,style:{width:90,height:70,objectFit:"cover",borderRadius:8,border:"2px solid #e2e8f0",cursor:"pointer",transition:"all 0.2s ease"},onClick:()=>D(Ie)},nt):null})}):null]})]},we))})]})]})]}),ae&&a.jsxs("div",{style:{marginTop:16,fontSize:14,color:"#dc2626",background:"#fef2f2",padding:"12px 16px",borderRadius:10,border:"1px solid #fecaca"},children:[" ",ae]}),W&&a.jsxs("div",{style:{marginTop:16,fontSize:14,color:"#16a34a",background:"#f0fdf4",padding:"12px 16px",borderRadius:10,border:"1px solid #bbf7d0"},children:[" Imported ",W.inserted," question(s)",(ke=W.failed)!=null&&ke.length?`, failed ${W.failed.length}.`:"."]})]})]})}),a.jsxs("div",{style:{padding:"16px 24px",borderTop:"1px solid #e2e8f0",display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,background:"#fafbfc"},children:[a.jsx("button",{onClick:()=>p(ce=>ce===1?1:ce-1),disabled:h===1,onMouseEnter:ce=>{h!==1&&(ce.currentTarget.style.background="#f8fafc")},onMouseLeave:ce=>{h!==1&&(ce.currentTarget.style.background="#fff")},style:{padding:"10px 18px",borderRadius:10,border:"1px solid #e2e8f0",background:h===1?"#f1f5f9":"#fff",cursor:h===1?"not-allowed":"pointer",fontWeight:600,fontSize:14,color:h===1?"#94a3b8":"#475569",transition:"all 0.2s ease"},children:" Back"}),a.jsx("div",{style:{display:"flex",gap:10,alignItems:"center"},children:h<3?a.jsx("button",{onClick:()=>{if(ee(null),h===2){if(!k.trim()){ee("Exam name is required.");return}if(!B.trim()){ee("Exam type is required.");return}if(!P.trim()){ee("Exam date is required.");return}}p(ce=>ce+1)},disabled:h===1&&m==="scanning",onMouseEnter:ce=>{h===1&&m==="scanning"||(ce.currentTarget.style.background="linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%)")},onMouseLeave:ce=>{h===1&&m==="scanning"||(ce.currentTarget.style.background="linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)")},style:{padding:"10px 24px",borderRadius:10,border:"none",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"#fff",fontWeight:700,cursor:"pointer",fontSize:15,boxShadow:"0 2px 8px rgba(37,99,235,0.25)",transition:"all 0.2s ease"},children:"Next "}):a.jsx("button",{onClick:lt,disabled:oe||m==="scanning"||Le.length===0,onMouseEnter:ce=>{!oe&&m!=="scanning"&&Le.length>0&&(ce.currentTarget.style.background="linear-gradient(135deg, #15803d 0%, #166534 100%)")},onMouseLeave:ce=>{!oe&&m!=="scanning"&&Le.length>0&&(ce.currentTarget.style.background="linear-gradient(135deg, #16a34a 0%, #15803d 100%)")},style:{padding:"10px 24px",borderRadius:10,border:"none",background:oe?"#cbd5e1":"linear-gradient(135deg, #16a34a 0%, #15803d 100%)",color:"#fff",fontWeight:800,fontSize:15,cursor:oe?"not-allowed":"pointer",boxShadow:oe?"none":"0 2px 8px rgba(22,163,74,0.25)",transition:"all 0.2s ease"},children:oe?" Importing":" Confirm & Import"})})]})]})}),ie&&a.jsx("div",{role:"dialog",onClick:()=>{D(null)},style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.85)",backdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:80},children:a.jsx("div",{onClick:ce=>ce.stopPropagation(),style:{maxWidth:"95%",maxHeight:"95%",padding:16,background:"#fff",borderRadius:16,boxShadow:"0 20px 50px rgba(0,0,0,0.5)"},children:a.jsx("img",{src:ie,alt:"preview",style:{maxWidth:"100%",maxHeight:"100%",borderRadius:12}})})}),ne&&a.jsx("div",{role:"dialog",onClick:()=>{re(null)},style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:80,padding:16},children:a.jsxs("div",{onClick:ce=>ce.stopPropagation(),style:{width:"min(900px, 100%)",background:"#fff",borderRadius:12,boxShadow:"0 12px 40px rgba(0,0,0,0.25)",overflow:"hidden",border:"1px solid #e5e7eb"},children:[a.jsxs("div",{style:{padding:"14px 16px",borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:800,fontSize:16},children:"Uploaded file preview"}),a.jsxs("div",{style:{color:"#6b7280",fontSize:12},children:["Preview of uploaded DOCX  ",ne.name]})]}),a.jsx("button",{onClick:()=>re(null),style:{padding:"6px 10px",borderRadius:8,border:"1px solid #e5e7eb",background:"#fff",cursor:"pointer"},children:"Close"})]}),a.jsx("div",{style:{padding:16},children:a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr",gap:12},children:[a.jsxs("div",{children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,marginBottom:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[a.jsx("div",{style:{width:64,height:64,borderRadius:8,background:"#f3f4f6",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,color:"#6b7280"},children:i!=null&&i.username?String(i.username).slice(0,1).toUpperCase():"U"}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:16,fontWeight:800,color:"#111827"},children:(i==null?void 0:i.username)||""}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Faculty"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:""})]})]}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Faculty ID: ",a.jsx("strong",{style:{color:"#111827"},children:me??""})]})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:13,color:"#6b7280",marginBottom:8},children:"File details"}),a.jsx("div",{style:{fontWeight:700},children:ne.name}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:ne.path}),a.jsx("div",{style:{marginTop:8},children:a.jsx("a",{href:ne.url,target:"_blank",rel:"noreferrer",style:{color:"#2563eb"},children:"Download file"})})]})]}),a.jsxs("div",{children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,marginBottom:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Uploaded file"}),a.jsx("div",{style:{fontSize:20,fontWeight:900,color:"#111827"},children:ne.name})]}),a.jsxs("div",{style:{textAlign:"right"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Uploaded path"}),a.jsx("div",{style:{fontWeight:700},children:ne.path})]})]}),a.jsx("div",{style:{marginTop:12,display:"grid",gridTemplateColumns:"1fr",gap:10},children:a.jsxs("div",{children:[a.jsx("span",{style:{color:"#6b7280",fontSize:12},children:"Notes"}),a.jsx("div",{style:{fontWeight:700},children:"This preview shows file metadata. Open the file to view full content or import to parse questions."})]})})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:13,color:"#6b7280",marginBottom:8},children:"Importer preview"}),a.jsx("div",{style:{maxHeight:260,overflow:"auto"},children:a.jsx("div",{style:{color:"#6b7280"},children:"To see a full questions preview, upload and scan this DOCX using the importer  then the Step 3 confirmation contains the parsed question list."})})]})]})]})})]})}),q&&a.jsx("div",{style:{position:"fixed",left:24,bottom:24,zIndex:120,animation:"slideIn 0.3s ease"},children:a.jsxs("div",{style:{background:"linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%)",color:"#065f46",border:"1px solid #6ee7b7",padding:"16px 20px",borderRadius:12,boxShadow:"0 10px 30px rgba(0,0,0,0.15)"},children:[a.jsx("div",{style:{fontWeight:800,fontSize:16,marginBottom:4},children:" Imported"}),a.jsxs("div",{style:{fontSize:14,color:"#047857"},children:[(W==null?void 0:W.inserted)??0," question(s) imported successfully."]})]})})]})}const qu=[{key:"q1",label:"Q1",max:2,co:1,btl:1},{key:"q2",label:"Q2",max:2,co:1,btl:3},{key:"q3",label:"Q3",max:2,co:1,btl:4},{key:"q4",label:"Q4",max:2,co:2,btl:1},{key:"q5",label:"Q5",max:2,co:2,btl:1},{key:"q6",label:"Q6",max:2,co:2,btl:2},{key:"q7",label:"Q7",max:16,co:1,btl:2},{key:"q8",label:"Q8",max:16,co:2,btl:3},{key:"q9",label:"Q9",max:16,co:"1&2",btl:5}];function km(e){let t=0,r=0;for(const n of e||[]){const i=Number(n.max||0);n.co==="1&2"?(t+=i/2,r+=i/2):n.co===2?r+=i:t+=i}return{co1:t,co2:r}}function W1(e){const t={1:0,2:0,3:0,4:0,5:0,6:0};for(const r of e||[]){const n=String(r.btl);n in t&&(t[n]+=Number(r.max||0))}return t}function wv(e){var d,f;const t=km(e.prevQuestions),r=km(e.nextQuestions),n=W1(e.prevQuestions),i=W1(e.nextQuestions),s=Number((d=e.existingCoMax)==null?void 0:d.co1),o=Number((f=e.existingCoMax)==null?void 0:f.co2),l=!Number.isFinite(s)||s===t.co1?r.co1:Math.max(0,s),c=!Number.isFinite(o)||o===t.co2?r.co2:Math.max(0,o),u={...i};return["1","2","3","4","5","6"].forEach(h=>{var m;const p=Number((m=e.existingBtlMax)==null?void 0:m[h]);Number.isFinite(p)&&p!==n[h]&&(u[h]=Math.max(0,p))}),{coMax:{co1:l,co2:c},btlMax:u}}const wk={termLabel:"KRCT AY25-26",assessments:{ssa1:{maxTotal:20,coMax:{co1:10,co2:10},btlMax:{1:0,2:0,3:10,4:10,5:0,6:0}},formative1:{maxPart:5,maxTotal:20,maxCo:10,btlMax:{1:0,2:0,3:10,4:10,5:0,6:0}},cia1:{questions:qu,coMax:km(qu),btlMax:W1(qu)}}},gOe=Array.from({length:11},(e,t)=>`PO${t+1}`);function xOe(e,t){const r=Fc(t),n=e==null?void 0:e[r];return Array.isArray(n)&&n.length===11?n:Array.from({length:11},()=>!1)}function yOe(){var R,M,B,E,P,U,G,H,oe,de,W,V,ae,ee,C,Y,q,O,X,F;const[e,t]=x.useState({}),[r,n]=x.useState(wk),[i,s]=x.useState(!1),[o,l]=x.useState(null),[c,u]=x.useState("assessments"),[d,f]=x.useState({}),[h,p]=x.useState(""),[m,g]=x.useState(""),[y,b]=x.useState("");x.useEffect(()=>{let Q=!0;return(async()=>{try{const K=await N3();Q&&t(K||{})}catch(K){Q&&l((K==null?void 0:K.message)||"Failed to load global mapping")}})(),()=>{Q=!1}},[]),x.useEffect(()=>{let Q=!0;return(async()=>{var K,ne,re,T,I,ie,D;try{const Z=await oc();if(!Q)return;const me={...wk,...Z||{},assessments:{...wk.assessments||{},...(Z==null?void 0:Z.assessments)||{}}},Te=((ne=(K=me.assessments)==null?void 0:K.cia1)==null?void 0:ne.questions)||[],je=Array.isArray(Te)&&Te.length?Te:qu,Le=km(je),_e=W1(je),He=(T=(re=me.assessments)==null?void 0:re.cia1)==null?void 0:T.coMax,We=Number(He==null?void 0:He.co1),Pt=Number(He==null?void 0:He.co2),dt=(ie=(I=me.assessments)==null?void 0:I.cia1)==null?void 0:ie.btlMax,Ye=lt=>{const be=Number(dt==null?void 0:dt[lt]);return Number.isFinite(be)?Math.max(0,be):_e[lt]};me.assessments={...me.assessments||{},cia1:{...((D=me.assessments)==null?void 0:D.cia1)||{},questions:je,coMax:{co1:Number.isFinite(We)?Math.max(0,We):Le.co1,co2:Number.isFinite(Pt)?Math.max(0,Pt):Le.co2},btlMax:{1:Ye("1"),2:Ye("2"),3:Ye("3"),4:Ye("4"),5:Ye("5"),6:Ye("6")}}},n(me)}catch(Z){Q&&l((Z==null?void 0:Z.message)||"Failed to load assessment master config")}})(),()=>{Q=!1}},[]);const v=x.useMemo(()=>Dm.map(Q=>({label:Q,key:Fc(Q),values:xOe(e,Q)})),[e]),w=(Q,K,ne)=>{const re=Fc(Q);t(T=>{const I=Array.isArray(T==null?void 0:T[re])?[...T[re]]:Array.from({length:11},()=>!1);return I[K]=ne,{...T,[re]:I}})},S=async()=>{s(!0),l(null);try{c==="po"?(await U9(e),l("Saved global mapping.")):(await z9(r),l("Saved assessment master config."))}catch(Q){l((Q==null?void 0:Q.message)||"Failed to save global mapping")}finally{s(!1)}},j=x.useMemo(()=>{var K,ne;const Q=(ne=(K=r==null?void 0:r.assessments)==null?void 0:K.cia1)==null?void 0:ne.questions;return Array.isArray(Q)&&Q.length?Q:qu},[r]),k=x.useMemo(()=>j.filter(Q=>d[Q.key]),[j,d]),A=()=>{k.length&&n(Q=>{var T,I,ie,D,Z,me,Te;const K=(((I=(T=Q.assessments)==null?void 0:T.cia1)==null?void 0:I.questions)||qu).slice(),ne=K.map(je=>{if(!d[je.key])return je;const Le={...je};return h!==""&&Number.isFinite(Number(h))&&(Le.max=Math.max(0,Number(h))),(m==="1"||m==="2")&&(Le.co=Number(m)),m==="1&2"&&(Le.co="1&2"),y&&["1","2","3","4","5","6"].includes(y)&&(Le.btl=Number(y)),Le}),re=wv({prevQuestions:K,nextQuestions:ne,existingCoMax:(D=(ie=Q.assessments)==null?void 0:ie.cia1)==null?void 0:D.coMax,existingBtlMax:(me=(Z=Q.assessments)==null?void 0:Z.cia1)==null?void 0:me.btlMax});return{...Q,assessments:{...Q.assessments||{},cia1:{...((Te=Q.assessments)==null?void 0:Te.cia1)||{},questions:ne,coMax:re.coMax,btlMax:re.btlMax}}}})};return a.jsx("main",{className:"obe-master-page",style:{padding:0,fontFamily:"Arial, sans-serif",minHeight:"100vh",background:"#fff"},children:a.jsxs("div",{style:{padding:"0px",width:"100%",minWidth:0,boxSizing:"border-box"},children:[a.jsxs("div",{style:{marginBottom:16},children:[a.jsx("h2",{style:{margin:0},children:"OBE Master"}),a.jsx("div",{style:{color:"#666",marginTop:4},children:"Global settings for OBE pages"})]}),a.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12,flexWrap:"wrap"},children:[a.jsx("button",{onClick:()=>u("assessments"),style:{padding:"8px 10px",borderRadius:8,border:"1px solid #e5e7eb",background:c==="assessments"?"#111827":"#fff",color:c==="assessments"?"#fff":"#111827"},children:"Assessment Headers"}),a.jsx("button",{onClick:()=>u("po"),style:{padding:"8px 10px",borderRadius:8,border:"1px solid #e5e7eb",background:c==="po"?"#111827":"#fff",color:c==="po"?"#fff":"#111827"},children:"Active Learning PO Mapping"})]}),o&&a.jsx("div",{style:{marginBottom:12,fontSize:12,color:o.startsWith("Saved")?"#166534":"#b91c1c"},children:o}),c==="po"?a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12,background:"#fff"},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:900},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,textAlign:"left",background:"#f8fafc"},children:"Activity"}),gOe.map(Q=>a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,textAlign:"center",background:"#fff7ed"},children:Q},Q))]})}),a.jsx("tbody",{children:v.map((Q,K)=>a.jsxs("tr",{style:{background:K%2===0?"#fff":"#f9fafb"},children:[a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,fontWeight:600},children:Q.label}),Q.values.map((ne,re)=>a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,textAlign:"center"},children:a.jsx("input",{type:"checkbox",checked:!!ne,onChange:T=>w(Q.label,re,T.target.checked)})},`${Q.key}-${re}`))]},Q.key))})]})}):a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:12},children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"Global Term Label"}),a.jsx("input",{value:r.termLabel??"",onChange:Q=>n(K=>({...K,termLabel:Q.target.value})),style:{padding:8,borderRadius:8,border:"1px solid #d1d5db",width:260}})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"SSA1 Headers"}),a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center"},children:[a.jsxs("label",{style:{fontSize:12},children:["Total Max",a.jsx("input",{type:"number",value:String(((M=(R=r.assessments)==null?void 0:R.ssa1)==null?void 0:M.maxTotal)??20),onChange:Q=>n(K=>{var ne;return{...K,assessments:{...K.assessments||{},ssa1:{...((ne=K.assessments)==null?void 0:ne.ssa1)||{},maxTotal:Number(Q.target.value||0)}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]}),a.jsxs("label",{style:{fontSize:12},children:["CO1 Max",a.jsx("input",{type:"number",value:String(((P=(E=(B=r.assessments)==null?void 0:B.ssa1)==null?void 0:E.coMax)==null?void 0:P.co1)??10),onChange:Q=>n(K=>{var ne,re,T;return{...K,assessments:{...K.assessments||{},ssa1:{...((ne=K.assessments)==null?void 0:ne.ssa1)||{},coMax:{...((T=(re=K.assessments)==null?void 0:re.ssa1)==null?void 0:T.coMax)||{},co1:Number(Q.target.value||0)}}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]}),a.jsxs("label",{style:{fontSize:12},children:["CO2 Max",a.jsx("input",{type:"number",value:String(((H=(G=(U=r.assessments)==null?void 0:U.ssa1)==null?void 0:G.coMax)==null?void 0:H.co2)??10),onChange:Q=>n(K=>{var ne,re,T;return{...K,assessments:{...K.assessments||{},ssa1:{...((ne=K.assessments)==null?void 0:ne.ssa1)||{},coMax:{...((T=(re=K.assessments)==null?void 0:re.ssa1)==null?void 0:T.coMax)||{},co2:Number(Q.target.value||0)}}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]})]})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"Formative 1 Headers"}),a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center"},children:[a.jsxs("label",{style:{fontSize:12},children:["Part Max",a.jsx("input",{type:"number",value:String(((de=(oe=r.assessments)==null?void 0:oe.formative1)==null?void 0:de.maxPart)??5),onChange:Q=>n(K=>{var ne;return{...K,assessments:{...K.assessments||{},formative1:{...((ne=K.assessments)==null?void 0:ne.formative1)||{},maxPart:Number(Q.target.value||0)}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]}),a.jsxs("label",{style:{fontSize:12},children:["Total Max",a.jsx("input",{type:"number",value:String(((V=(W=r.assessments)==null?void 0:W.formative1)==null?void 0:V.maxTotal)??20),onChange:Q=>n(K=>{var ne;return{...K,assessments:{...K.assessments||{},formative1:{...((ne=K.assessments)==null?void 0:ne.formative1)||{},maxTotal:Number(Q.target.value||0)}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]}),a.jsxs("label",{style:{fontSize:12},children:["CO Max",a.jsx("input",{type:"number",value:String(((ee=(ae=r.assessments)==null?void 0:ae.formative1)==null?void 0:ee.maxCo)??10),onChange:Q=>n(K=>{var ne;return{...K,assessments:{...K.assessments||{},formative1:{...((ne=K.assessments)==null?void 0:ne.formative1)||{},maxCo:Number(Q.target.value||0)}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]})]})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:10},children:"CIA 1"}),a.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap",alignItems:"stretch",marginBottom:12},children:[a.jsxs("div",{style:{flex:"1 1 360px",border:"1px solid #eef2f7",borderRadius:12,padding:12,background:"#fbfdff"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"CIA1 Limits"}),a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center",marginBottom:10},children:[a.jsxs("label",{style:{fontSize:12},children:["CO-1 Max",a.jsx("input",{type:"number",value:String(((q=(Y=(C=r.assessments)==null?void 0:C.cia1)==null?void 0:Y.coMax)==null?void 0:q.co1)??km(j).co1),onChange:Q=>n(K=>{var ne,re,T;return{...K,assessments:{...K.assessments||{},cia1:{...((ne=K.assessments)==null?void 0:ne.cia1)||{},coMax:{...(T=(re=K.assessments)==null?void 0:re.cia1)==null?void 0:T.coMax,co1:Math.max(0,Number(Q.target.value||0))}}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90,textAlign:"center"}})]}),a.jsxs("label",{style:{fontSize:12},children:["CO-2 Max",a.jsx("input",{type:"number",value:String(((F=(X=(O=r.assessments)==null?void 0:O.cia1)==null?void 0:X.coMax)==null?void 0:F.co2)??km(j).co2),onChange:Q=>n(K=>{var ne,re,T;return{...K,assessments:{...K.assessments||{},cia1:{...((ne=K.assessments)==null?void 0:ne.cia1)||{},coMax:{...(T=(re=K.assessments)==null?void 0:re.cia1)==null?void 0:T.coMax,co2:Math.max(0,Number(Q.target.value||0))}}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90,textAlign:"center"}})]})]}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"BTL Max Marks (1 to 6)"}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(6, minmax(70px, 1fr))",gap:8},children:["1","2","3","4","5","6"].map(Q=>{var K,ne,re;return a.jsxs("label",{style:{fontSize:12,display:"flex",flexDirection:"column",gap:4},children:[a.jsxs("span",{style:{color:"#111827"},children:["BTL-",Q]}),a.jsx("input",{type:"number",value:String(((re=(ne=(K=r.assessments)==null?void 0:K.cia1)==null?void 0:ne.btlMax)==null?void 0:re[Q])??W1(j)[Q]),onChange:T=>n(I=>{var ie,D,Z;return{...I,assessments:{...I.assessments||{},cia1:{...((ie=I.assessments)==null?void 0:ie.cia1)||{},btlMax:{...((Z=(D=I.assessments)==null?void 0:D.cia1)==null?void 0:Z.btlMax)||{},[Q]:Math.max(0,Number(T.target.value||0))}}}}}),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db",textAlign:"center"}})]},Q)})})]}),a.jsxs("div",{style:{flex:"2 1 520px",border:"1px solid #eef2f7",borderRadius:12,padding:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",alignItems:"center"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:700},children:"CIA1 Question Headers"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Select question rows and apply Max / CO / BTL in bulk."})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("input",{placeholder:"Max",value:h,onChange:Q=>p(Q.target.value),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}}),a.jsxs("select",{value:m,onChange:Q=>g(Q.target.value),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db"},children:[a.jsx("option",{value:"",children:"CO"}),a.jsx("option",{value:"1",children:"CO-1"}),a.jsx("option",{value:"2",children:"CO-2"}),a.jsx("option",{value:"1&2",children:"CO-1&CO-2 (split)"})]}),a.jsxs("select",{value:y,onChange:Q=>b(Q.target.value),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db"},children:[a.jsx("option",{value:"",children:"BTL"}),[1,2,3,4,5,6].map(Q=>a.jsxs("option",{value:String(Q),children:["BTL-",Q]},Q))]}),a.jsxs("button",{onClick:A,disabled:!k.length,style:{padding:"8px 10px"},children:["Apply to Selected (",k.length,")"]})]})]}),a.jsx("div",{style:{overflowX:"auto",marginTop:10,border:"1px solid #e5e7eb",borderRadius:10},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:720},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"center"},children:"Sel"}),a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"left"},children:"Key"}),a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"left"},children:"Label"}),a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"center"},children:"Max"}),a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"center"},children:"CO"}),a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"center"},children:"BTL"})]})}),a.jsx("tbody",{children:j.map((Q,K)=>a.jsxs("tr",{style:{background:K%2===0?"#fff":"#f9fafb"},children:[a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,textAlign:"center"},children:a.jsx("input",{type:"checkbox",checked:!!d[Q.key],onChange:ne=>f(re=>({...re,[Q.key]:ne.target.checked}))})}),a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10},children:Q.key}),a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10},children:a.jsx("input",{value:Q.label,onChange:ne=>n(re=>{var ie,D,Z;const I=(((D=(ie=re.assessments)==null?void 0:ie.cia1)==null?void 0:D.questions)||qu).slice().map(me=>me.key===Q.key?{...me,label:ne.target.value}:me);return{...re,assessments:{...re.assessments||{},cia1:{...((Z=re.assessments)==null?void 0:Z.cia1)||{},questions:I}}}}),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db",width:"100%"}})}),a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,textAlign:"center"},children:a.jsx("input",{type:"number",value:String(Q.max),onChange:ne=>n(re=>{var Z,me,Te,je,Le,_e,He;const T=Math.max(0,Number(ne.target.value||0)),I=(((me=(Z=re.assessments)==null?void 0:Z.cia1)==null?void 0:me.questions)||qu).slice(),ie=I.map(We=>We.key===Q.key?{...We,max:T}:We),D=wv({prevQuestions:I,nextQuestions:ie,existingCoMax:(je=(Te=re.assessments)==null?void 0:Te.cia1)==null?void 0:je.coMax,existingBtlMax:(_e=(Le=re.assessments)==null?void 0:Le.cia1)==null?void 0:_e.btlMax});return{...re,assessments:{...re.assessments||{},cia1:{...((He=re.assessments)==null?void 0:He.cia1)||{},questions:ie,coMax:D.coMax,btlMax:D.btlMax}}}}),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90,textAlign:"center"}})}),a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,textAlign:"center"},children:a.jsxs("select",{value:String(Q.co),onChange:ne=>n(re=>{var me,Te,je,Le,_e,He,We;const T=String(ne.target.value),I=T==="1&2"?"1&2":Number(T)===2?2:1,ie=(((Te=(me=re.assessments)==null?void 0:me.cia1)==null?void 0:Te.questions)||qu).slice(),D=ie.map(Pt=>Pt.key===Q.key?{...Pt,co:I}:Pt),Z=wv({prevQuestions:ie,nextQuestions:D,existingCoMax:(Le=(je=re.assessments)==null?void 0:je.cia1)==null?void 0:Le.coMax,existingBtlMax:(He=(_e=re.assessments)==null?void 0:_e.cia1)==null?void 0:He.btlMax});return{...re,assessments:{...re.assessments||{},cia1:{...((We=re.assessments)==null?void 0:We.cia1)||{},questions:D,coMax:Z.coMax,btlMax:Z.btlMax}}}}),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db"},children:[a.jsx("option",{value:"1",children:"1"}),a.jsx("option",{value:"2",children:"2"}),a.jsx("option",{value:"1&2",children:"1&2"})]})}),a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,textAlign:"center"},children:a.jsx("select",{value:String(Q.btl),onChange:ne=>n(re=>{var Z,me,Te,je,Le,_e,He;const T=Math.min(6,Math.max(1,Number(ne.target.value||1))),I=(((me=(Z=re.assessments)==null?void 0:Z.cia1)==null?void 0:me.questions)||qu).slice(),ie=I.map(We=>We.key===Q.key?{...We,btl:T}:We),D=wv({prevQuestions:I,nextQuestions:ie,existingCoMax:(je=(Te=re.assessments)==null?void 0:Te.cia1)==null?void 0:je.coMax,existingBtlMax:(_e=(Le=re.assessments)==null?void 0:Le.cia1)==null?void 0:_e.btlMax});return{...re,assessments:{...re.assessments||{},cia1:{...((He=re.assessments)==null?void 0:He.cia1)||{},questions:ie,coMax:D.coMax,btlMax:D.btlMax}}}}),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db"},children:[1,2,3,4,5,6].map(ne=>a.jsx("option",{value:String(ne),children:ne},ne))})})]},Q.key))})]})})]})]})]})]}),a.jsx("div",{style:{marginTop:16,display:"flex",gap:12},children:a.jsx("button",{onClick:S,disabled:i,style:{padding:"10px 14px",borderRadius:8,border:"1px solid #2563eb",background:"#2563eb",color:"#fff",fontWeight:600,cursor:"pointer"},children:i?"Saving...":c==="po"?"Save Global PO Mapping":"Save Assessment Headers"})})]})})}function bOe(){var u,d;const e=hl(),r=x.useMemo(()=>new URLSearchParams(e.search),[e.search]).get("tab")||"obe",[n,i]=x.useState(r),s=((u=window.__APP_ME__)==null?void 0:u.permissions)||((d=window.__ME__)==null?void 0:d.permissions)||[],l=(Array.isArray(s)?s.map(f=>String(f||"").toLowerCase()):[]).includes("obe.master.manage"),c=x.useMemo(()=>{const f=[];return f.push({key:"obe",label:"OBE"}),l&&(f.push({key:"obe_master",label:"OBE Master"}),f.push({key:"due_dates",label:"OBE: Due Dates"})),f},[l]);return sn.useEffect(()=>{var f;c.some(h=>h.key===n)||i(((f=c[0])==null?void 0:f.key)||"obe")},[c,n]),x.useEffect(()=>{const f=new URLSearchParams(e.search).get("tab");f&&c.some(h=>h.key===f)&&f!==n&&i(f)},[e.search]),a.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[a.jsxs("div",{style:{marginBottom:12},children:[a.jsx("h2",{style:{margin:0,fontSize:20},children:"Academic"}),a.jsx("div",{style:{color:"#6b7280",marginTop:6},children:"Quick access to OBE tools."})]}),a.jsx("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:18},children:c.map(f=>a.jsx("button",{onClick:()=>i(f.key),style:{padding:"8px 12px",borderRadius:8,border:n===f.key?"1px solid #10b981":"1px solid #e5e7eb",background:n===f.key?"#ecfdf5":"#fff",fontWeight:700,cursor:"pointer"},children:f.label},f.key))}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[n==="obe"&&a.jsx(RK,{}),n==="obe_master"&&l&&a.jsx(yOe,{}),n==="due_dates"&&l&&a.jsx(k3,{})]})]})}const vOe="https://db.krgi.co.in",KF=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":vOe;function YF(){const e=window.localStorage.getItem("access");return e?{Authorization:`Bearer ${e}`}:{}}function wOe(){var M,B;const[e,t]=x.useState(null),[r,n]=x.useState(!1),[i,s]=x.useState(null),[o,l]=x.useState([]),[c,u]=x.useState(null),[d,f]=x.useState(""),[h,p]=x.useState("pending"),[m,g]=x.useState(!1),[y,b]=x.useState(null),[v,w]=x.useState(null),[S,j]=x.useState(null),k=x.useMemo(()=>o.filter(E=>{const P=String(E.marks??"").trim().toUpperCase(),U=String(E.btl??"").trim().toUpperCase(),G=String(E.course_outcomes??"").trim().toUpperCase();return!(P==="(OR)"&&U==="(OR)"&&G==="(OR)")}),[o]);async function A(){if(!e){s("Please select a .docx file first.");return}n(!0),s(null),b(null),w(null);const E=new FormData;E.append("file",e);try{const P=await fetch(`${KF}/api/template/scan-docx`,{method:"POST",headers:{...YF()},body:E});if(!P.ok){const H=await P.text();s(H||`Scan failed (${P.status})`),l([]);return}const U=await P.json(),G=Array.isArray(U==null?void 0:U.questions)?U.questions:[];u((U==null?void 0:U.debug)??null);try{console.debug("scan_docx response: questions=",G.length,"sample=",G[0]?{q0:G[0].question_text,imgs:(G[0].images||[]).slice(0,2)}:null),G.length&&G.forEach((H,oe)=>{console.log(`Q#${oe+1} images:`,Array.isArray(H.images)?H.images.map(de=>typeof de=="string"?de.slice(0,80):typeof de):H.images)})}catch(H){console.warn("scan_docx debug log failed",H)}l(G)}catch(P){s((P==null?void 0:P.message)||"Scan failed"),l([])}finally{n(!1)}}async function R(){if(!d.trim()){w("Title is required to import.");return}g(!0),w(null),b(null);try{const E={title:d.trim(),status:h,questions:k},P=await fetch(`${KF}/api/import/questions`,{method:"POST",headers:{"Content-Type":"application/json",...YF()},body:JSON.stringify(E)});if(!P.ok){const G=await P.text();w(G||`Import failed (${P.status})`);return}const U=await P.json();b(U)}catch(E){w((E==null?void 0:E.message)||"Import failed")}finally{g(!1)}}return a.jsxs("div",{style:{maxWidth:1100,margin:"0 auto",padding:24},children:[a.jsx("h1",{style:{marginTop:0},children:"Question Import"}),a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",flexWrap:"wrap"},children:[a.jsx("input",{type:"file",accept:".docx",onChange:E=>{var P;return t(((P=E.target.files)==null?void 0:P[0])||null)}}),a.jsx("button",{onClick:A,disabled:r||!e,children:r?"Scanning":"Scan DOCX"}),a.jsx("div",{style:{color:"#666",fontSize:13},children:o.length?`${o.length} scanned (${k.length} visible)`:""})]}),i&&a.jsx("div",{style:{marginTop:10,color:"#b91c1c"},children:i}),c&&a.jsxs("div",{style:{marginTop:10,padding:10,background:"#f8fafc",border:"1px solid #e6eef8",borderRadius:8},children:[a.jsx("div",{style:{fontSize:13,color:"#0747a6",fontWeight:700},children:"Scan debug"}),a.jsxs("div",{style:{fontSize:13,color:"#333"},children:["Questions parsed: ",c.parsed_questions??"-"]}),a.jsxs("div",{style:{fontSize:13,color:"#333"},children:["Total images: ",c.total_images??0]}),a.jsxs("div",{style:{fontSize:12,color:"#666",marginTop:6},children:["Sample questions: ",Array.isArray(c.sample_questions)?c.sample_questions.join(" | "):"-"]}),a.jsxs("div",{style:{fontSize:12,color:"#666",marginTop:6},children:["Sample image prefix: ",a.jsx("code",{style:{background:"#fff",padding:"2px 6px",borderRadius:4},children:String(c.sample_image_prefix||"").slice(0,200)})]}),a.jsxs("div",{style:{fontSize:12,color:"#666",marginTop:6},children:["First questions' images (raw):",a.jsx("pre",{style:{whiteSpace:"pre-wrap",maxHeight:160,overflow:"auto",background:"#fff",padding:8,borderRadius:6},children:JSON.stringify(o.slice(0,3).map(E=>E.images),null,2)})]})]}),a.jsx("hr",{style:{margin:"20px 0"}}),a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",flexWrap:"wrap"},children:[a.jsx("input",{value:d,onChange:E=>f(E.target.value),placeholder:"Title (e.g., Midterm 2026)",style:{padding:"8px 10px",border:"1px solid #e5e7eb",borderRadius:6,minWidth:260}}),a.jsxs("select",{value:h,onChange:E=>p(E.target.value),style:{padding:"8px 10px",border:"1px solid #e5e7eb",borderRadius:6},children:[a.jsx("option",{value:"pending",children:"pending"}),a.jsx("option",{value:"approved",children:"approved"})]}),a.jsx("button",{onClick:R,disabled:m||k.length===0,children:m?"Importing":"Import to Bank"})]}),v&&a.jsx("div",{style:{marginTop:10,color:"#b91c1c"},children:v}),y&&a.jsxs("div",{style:{marginTop:10,color:"#166534"},children:["Imported ",y.inserted," question(s)",(M=y.failed)!=null&&M.length?`, ${y.failed.length} failed.`:"."]}),(B=y==null?void 0:y.failed)!=null&&B.length?a.jsxs("div",{style:{marginTop:10},children:[a.jsx("h3",{style:{margin:"10px 0"},children:"Failures"}),a.jsx("ul",{children:y.failed.map(E=>a.jsxs("li",{style:{color:"#b91c1c"},children:["#",E.index+1,": ",E.error]},E.index))})]}):null,a.jsx("hr",{style:{margin:"20px 0"}}),a.jsx("h2",{style:{margin:"10px 0"},children:"Preview"}),k.length===0?a.jsx("div",{style:{color:"#666"},children:"No questions to preview yet."}):a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:12},children:[k.slice(0,50).map((E,P)=>a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:14},children:[a.jsxs("div",{style:{fontWeight:700,marginBottom:6},children:[P+1,". ",E.question_text]}),a.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap",color:"#555",fontSize:13,marginBottom:8},children:[E.marks!=null&&a.jsxs("span",{children:["Marks: ",String(E.marks)]}),E.btl!=null&&a.jsxs("span",{children:["BTL: ",String(E.btl)]}),E.course_outcomes&&a.jsxs("span",{children:["CO: ",E.course_outcomes]}),E.chapter&&a.jsxs("span",{children:["Chapter: ",E.chapter]})]}),Array.isArray(E.options)&&E.options.length?a.jsx("ol",{type:"a",style:{marginTop:0},children:E.options.map((U,G)=>a.jsx("li",{children:String(U)},G))}):null,E.correct_answer?a.jsxs("div",{style:{marginTop:6,color:"#111",fontSize:13},children:[a.jsx("strong",{children:"Answer:"})," ",E.correct_answer]}):null,E.answer_text?a.jsxs("div",{style:{marginTop:4,color:"#444",fontSize:13},children:[a.jsx("strong",{children:"Explanation:"})," ",E.answer_text]}):null,Array.isArray(E.images)&&E.images.length?a.jsx("div",{style:{marginTop:10,display:"flex",gap:10,flexWrap:"wrap"},children:E.images.slice(0,6).map((U,G)=>{let H=null;try{if(typeof U=="string")H=U,!H.startsWith("data:")&&/^[A-Za-z0-9+/=\n\r]+$/.test(H)&&H.length>100&&(H=`data:image/png;base64,${H.replace(/\s+/g,"")}`);else if(U&&typeof U=="object"){if(U.url)H=U.url;else if(U.base64)H=U.base64.startsWith("data:")?U.base64:`data:image/png;base64,${U.base64}`;else if(U.binary&&U.binary instanceof Uint8Array){const oe=new Blob([U.binary],{type:"image/png"});H=URL.createObjectURL(oe)}}else if(U instanceof Uint8Array){const oe=new Blob([U],{type:"image/png"});H=URL.createObjectURL(oe)}}catch{H=null}return H?a.jsx("img",{src:H,alt:`q${P+1}-img${G+1}`,onClick:()=>j(H),style:{maxHeight:140,borderRadius:8,border:"1px solid #eee",cursor:"pointer",objectFit:"contain"}},G):null})}):null]},P)),k.length>50&&a.jsx("div",{style:{color:"#666"},children:"Showing first 50 questions."})]}),S&&a.jsx("div",{role:"dialog",onClick:()=>{j(null)},style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:60},children:a.jsx("div",{onClick:E=>E.stopPropagation(),style:{maxWidth:"90%",maxHeight:"90%",padding:12},children:a.jsx("img",{src:S,alt:"preview",style:{maxWidth:"100%",maxHeight:"100%",borderRadius:8}})})})]})}function SOe({courseId:e,classType:t,questionPaperType:r,enabledAssessments:n}){const[i,s]=x.useState(e||""),[o,l]=x.useState(!1);return x.useEffect(()=>{e&&e!==i&&s(e),!e&&i&&s("")},[e]),a.jsx("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #ecfdf5 0%, #ffffff 60%)",padding:"0"},children:a.jsxs("div",{style:{background:"#ffffff",minHeight:"100vh",display:"flex",flexDirection:"column"},children:[a.jsxs("div",{style:{background:"linear-gradient(135deg, #10b981, #059669)",color:"#ffffff",padding:"20px 24px",flexShrink:0},children:[a.jsx("div",{style:{fontSize:24,fontWeight:800},children:"Mark Entry"}),a.jsxs("div",{style:{fontSize:14,opacity:.9},children:[" ",i?`Course: ${i}`:"No course selected"," "]})]}),a.jsxs("div",{style:{padding:"20px 24px",flex:1},children:[!e&&a.jsxs("div",{className:"obe-card",style:{marginBottom:12},children:[a.jsx("label",{style:{display:"block",fontSize:12,fontWeight:700,color:"#065f46",textTransform:"uppercase",letterSpacing:"0.03em"},children:"Course ID"}),a.jsx("input",{value:i,onChange:c=>s(c.target.value),placeholder:"Enter course id",className:"obe-input",style:{marginTop:6,...o?{boxShadow:"0 0 0 3px rgba(16,185,129,0.2)",borderColor:"#a7f3d0"}:{}},onFocus:()=>l(!0),onBlur:()=>l(!1)})]}),i?a.jsx(C6,{subjectId:i,classType:t,questionPaperType:r,enabledAssessments:n}):a.jsx("div",{style:{background:"#d1fae5",border:"1px solid #a7f3d0",color:"#065f46",fontSize:14,padding:12,borderRadius:10},children:"Select a course to start mark entry."})]})]})})}const Pc={header:["CO1","CO1","CO1","CO2","CO2","CO2","CO3","CO3","CO3","CO4","CO4","CO4","CO1","CO2","CO3","CO4","CO5"],weights:[1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,2,2,2,2,4],cycles:["ssa","cia","fa","ssa","cia","fa","ssa","cia","fa","ssa","cia","fa","ME","ME","ME","ME","ME"]},_Oe=[{key:"q1",max:2,co:1},{key:"q2",max:2,co:1},{key:"q3",max:2,co:1},{key:"q4",max:2,co:2},{key:"q5",max:2,co:2},{key:"q6",max:2,co:2},{key:"q7",max:16,co:1},{key:"q8",max:16,co:2},{key:"q9",max:16,co:"1&2"}],jOe=[{key:"q1",max:2,co:3},{key:"q2",max:2,co:3},{key:"q3",max:2,co:3},{key:"q4",max:2,co:4},{key:"q5",max:2,co:4},{key:"q6",max:2,co:4},{key:"q7",max:16,co:3},{key:"q8",max:16,co:4},{key:"q9",max:16,co:"3&4"}],kOe=[{key:"q1",max:2},{key:"q2",max:2},{key:"q3",max:2},{key:"q4",max:2},{key:"q5",max:2},{key:"q6",max:2},{key:"q7",max:2},{key:"q8",max:2},{key:"q9",max:2},{key:"q10",max:2},{key:"q11",max:14},{key:"q12",max:14},{key:"q13",max:14},{key:"q14",max:14},{key:"q15",max:14},{key:"q16",max:10}],Sv=[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5,5];function fi(e,t,r){return Math.max(t,Math.min(r,e))}function zf(e){return Math.round(e*100)/100}function Oo(e){if(e===""||e==null)return null;const t=Number(e);return Number.isFinite(t)?t:null}function XF(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const o=r.localeCompare(n);if(o)return o}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim();return i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}function AOe(e){return e==="1&2"?{co1:.5,co2:.5}:e===2?{co1:0,co2:1}:{co1:1,co2:0}}function NOe(e){return e==="3&4"?{co3:.5,co4:.5}:e===4?{co3:0,co4:1}:{co3:1,co4:0}}function Sk(e){if(e==="both"||e==="1&2")return"1&2";if(Array.isArray(e)){const r=e.map(s=>String(s??"").trim().toUpperCase());if(r.some(s=>s==="BOTH"))return"1&2";const n=r.some(s=>s==="1"||s==="CO1"),i=r.some(s=>s==="2"||s==="CO2");return n&&i?"1&2":i?2:1}if(typeof e=="string"){const r=e.trim().toUpperCase();if(r==="BOTH"||r==="1&2"||r==="1,2"||r==="1/2"||r==="2/1"||r==="CO1&CO2"||r==="CO1,CO2")return"1&2";if(r==="2"||r==="CO2")return 2;if(r==="1"||r==="CO1")return 1}const t=Number(e);return t===2?2:t===12?"1&2":1}function _k(e){if(e==="both"||e==="3&4")return"3&4";if(Array.isArray(e)){const r=e.map(l=>String(l??"").trim().toUpperCase());if(r.some(l=>l==="BOTH"))return"3&4";const n=r.some(l=>l==="1"||l==="CO1"),i=r.some(l=>l==="2"||l==="CO2"),s=r.some(l=>l==="3"||l==="CO3"),o=r.some(l=>l==="4"||l==="CO4");return s&&o||n&&i?"3&4":o||i?4:3}if(typeof e=="string"){const r=e.trim().toUpperCase();if(r==="BOTH"||r==="1&2"||r==="1,2"||r==="1/2"||r==="2/1"||r==="CO1&CO2"||r==="CO1,CO2"||r==="3&4"||r==="3,4"||r==="3/4"||r==="4/3"||r==="CO3&CO4"||r==="CO3,CO4")return"3&4";if(r==="4"||r==="CO4")return 4;if(r==="3"||r==="CO3")return 3;if(r==="2"||r==="CO2")return 4;if(r==="1"||r==="CO1")return 3}const t=Number(e);return t===4?4:t===34?"3&4":t===2?4:t===1?3:t===12?"3&4":3}function jk(e,t){const r=e[t];if(!r)return{co1:0,co2:0};if(r.co==="1&2")return{co1:.5,co2:.5};const n=e.some(o=>o.co==="1&2"),i=t===e.length-1,s=String(r.key||"").trim().toLowerCase()==="q9";return!n&&i&&s?{co1:.5,co2:.5}:AOe(r.co)}function kk(e,t){const r=e[t];if(!r)return{co3:0,co4:0};if(r.co==="3&4")return{co3:.5,co4:.5};const n=e.some(o=>o.co==="3&4"),i=t===e.length-1,s=String(r.key||"").trim().toLowerCase()==="q9";return!n&&i&&s?{co3:.5,co4:.5}:NOe(r.co)}function QF(e,t,r,n){const i=Number(e),s=Number(t),o=Number(r),l=Number(n),c=(Number.isFinite(s)?s:0)+(Number.isFinite(o)?o:0)+(Number.isFinite(l)?l:0);if(!Number.isFinite(i)||i<=0||!c)return[0,0,0];const u=zf(i*(s||0)/c),d=zf(i*(o||0)/c),f=zf(i*(l||0)/c);return[u,d,f]}function COe(e,t){const r=ni(e),n=Pc.header,i=Pc.cycles,s=["CO1-SSA","CO1-CIA","CO1-FA","CO2-SSA","CO2-CIA","CO2-FA","CO3-SSA","CO3-CIA","CO3-FA","CO4-SSA","CO4-CIA","CO4-FA","ME-CO1","ME-CO2","ME-CO3","ME-CO4","ME-CO5"];let o=Array.from({length:17},(h,p)=>p),l=[...i],c=[...s];if(r==="TCPR"&&(l=l.map((h,p)=>p===2||p===5||p===8||p===11?"review":h),c=c.map((h,p)=>p===2||p===5||p===8||p===11?h.replace("-FA","-Review"):h)),r==="TCPL"&&(l=l.map((h,p)=>p===2||p===5||p===8||p===11?"lab":h),c=c.map((h,p)=>p===2||p===5?h.replace("-FA","-LAB1"):p===8||p===11?h.replace("-FA","-LAB2"):h)),r==="LAB"||r==="PRACTICAL")return o=[1,4,7,10,16],{visible:o,header:["CO1","CO2","CO3","CO4","ME"],cycles:["CIA 1","CIA 1","CIA 2","CIA 2","MODEL"],labels:["CO1-CIA1","CO2-CIA1","CO3-CIA2","CO4-CIA2","ME-CO5"]};if(r==="SPECIAL"&&t.size){const h=[],p=(m,g)=>{if(m)for(const y of g)h.push(y)};p(t.has("ssa1"),[0,3]),p(t.has("cia1"),[1,4]),p(t.has("formative1"),[2,5]),p(t.has("ssa2"),[6,9]),p(t.has("cia2"),[7,10]),p(t.has("formative2"),[8,11]),o=h}const u=o.map(h=>n[h]),d=o.map(h=>l[h]),f=o.map(h=>c[h]);return{visible:o,header:u,cycles:d,labels:f}}function EOe({courseId:e,enabledAssessments:t}){const r=x.useMemo(()=>new Set((t||[]).map(T=>String(T||"").trim().toLowerCase()).filter(Boolean)),[t]),[n,i]=x.useState([]),[s,o]=x.useState(null),[l,c]=x.useState(null),[u,d]=x.useState(null),[f,h]=x.useState(null),[p,m]=x.useState([]),[g,y]=x.useState(null),[b,v]=x.useState(!1),[w,S]=x.useState({ssa1:1.5,cia1:3,formative1:2.5}),[j,k]=x.useState([...Pc.weights]),[A,R]=x.useState({ssa1:{},ssa2:{},f1:{},f2:{},cia1:null,cia2:null}),[M,B]=x.useState({r1:{},r2:{}}),[E,P]=x.useState({cia1:null,cia2:null,model:null}),[U,G]=x.useState({lab1:null,lab2:null}),[H,oe]=x.useState(null),[de,W]=x.useState({cia1:null,cia2:null}),[V,ae]=x.useState(null),[ee,C]=x.useState(!1),[Y,q]=x.useState(null);x.useEffect(()=>{let T=!0;return(async()=>{try{const I=await oc();if(!T)return;h(I||null)}catch{}})(),()=>{T=!1}},[e]),x.useEffect(()=>{let T=!0;return(async()=>{var I;try{const ie=await hc();if(!T)return;let D=(ie||[]).filter(Te=>String(Te.subject_code)===String(e));if(D.length===0)try{const Te=await mr(`/api/academics/teaching-assignments/?subject_code=${encodeURIComponent(String(e||""))}`);if(Te.ok){const je=await Te.json();D=(Array.isArray(je.results)?je.results:Array.isArray(je)?je:je.items||[])||[]}}catch(Te){console.warn("Server TA list fetch failed:",Te)}i(D);const Z=Zn(`internalMark_selectedTa_${e}`),me=(typeof Z=="number"&&D.some(Te=>Te.id===Z)?Z:(I=D[0])==null?void 0:I.id)??null;o(me),c(null)}catch(ie){if(!T)return;i([]),o(null),c((ie==null?void 0:ie.message)||"Failed to load teaching assignments")}})(),()=>{T=!1}},[e]),x.useEffect(()=>{!e||s==null||Kn(`internalMark_selectedTa_${e}`,s)},[e,s]),x.useEffect(()=>{let T=!0;return(async()=>{try{const I=(n||[]).find(Z=>Z.id===s)||null,ie=I==null?void 0:I.curriculum_row_id;if(!ie){const Z=String(e).trim().toUpperCase(),me=await Sl();if(!T)return;const Te=(me||[]).find(He=>String(He.course_code||"").trim().toUpperCase()===Z),je=(Te==null?void 0:Te.class_type)??null;if(je){d(je);return}const Le=await Yd();if(!T)return;const _e=(Le||[]).find(He=>String(He.course_code||"").trim().toUpperCase()===Z);d((_e==null?void 0:_e.class_type)??null);return}const D=await A3(Number(ie));if(!T)return;d((D==null?void 0:D.class_type)??null)}catch{T&&d(null)}})(),()=>{T=!1}},[n,s,e]),x.useEffect(()=>{let T=!0;return(async()=>{try{const I=ni(u),ie=D=>{if(!D||typeof D!="object")return!1;const Z=Number.isFinite(Number(D.ssa1))?Number(D.ssa1):1.5,me=Number.isFinite(Number(D.cia1))?Number(D.cia1):3,Te=Number.isFinite(Number(D.formative1))?Number(D.formative1):2.5;S({ssa1:Z,cia1:me,formative1:Te});const je=D.internal_mark_weights;if(Array.isArray(je)&&je.length){let Le=je.map(_e=>{const He=Number(_e);return Number.isFinite(He)?He:0});if(Le.length===13&&Pc.weights.length===17){const[_e,He,We]=QF(Le[0]||0,Z,me,Te),[Pt,dt,Ye]=QF(Le[1]||0,Z,me,Te);Le=[_e,He,We,Pt,dt,Ye,...Le.slice(2)]}for(;Le.length<Pc.weights.length;)Le.push(Pc.weights[Le.length]??0);k(Le.slice(0,Pc.weights.length))}else k([...Pc.weights]);return!0};try{const D=await SS();if(!T)return;const Z=D&&D[I]||null;if(ie(Z))return}catch{}try{const D=Zn("iqac_class_type_weights"),Z=D&&D[I]||null;if(ie(Z))return}catch{}}catch{}})(),()=>{T=!1}},[u]),x.useEffect(()=>{let T=!0;return(async()=>{if(s){v(!0),y(null);try{const ie=(n||[]).find(D=>D.id===s)||null;if(ie&&ie.elective_subject_id&&!ie.section_id){const D=ie.elective_subject_id,Z=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(D))}`);if(!Z.ok)throw new Error(`Elective-choices fetch failed: ${Z.status}`);const me=await Z.json();if(!T)return;const je=((Array.isArray(me.results)?me.results:Array.isArray(me)?me:me.items||[])||[]).map(Le=>({id:Number(Le.student_id??Le.id),reg_no:String(Le.reg_no??Le.registration_no??Le.regno??""),name:String(Le.name??Le.full_name??Le.username??""),section:Le.section_name??Le.section??null}));if(!T)return;m(je.filter(Le=>Number.isFinite(Le.id)).sort(XF))}else{const D=await pc(s);if(!T)return;const Z=(D.students||[]).map(me=>({id:Number(me.id),reg_no:String(me.reg_no??""),name:String(me.name??""),section:me.section??null})).filter(me=>Number.isFinite(me.id)).sort(XF);m(Z)}}catch(ie){if(!T)return;m([]),y((ie==null?void 0:ie.message)||"Failed to load roster")}finally{T&&v(!1)}}})(),()=>{T=!1}},[s]),x.useEffect(()=>{let T=!0;return(async()=>{C(!0),q(null);try{const ie=ni(u),D=s??void 0,Z=ie==="TCPL",me=ie==="TCPR",Te=ie==="LAB"||ie==="PRACTICAL",je=ie==="SPECIAL"&&r.size,Le=ct=>je?r.has(String(ct).toLowerCase()):!0;B({r1:{},r2:{}}),P({cia1:null,cia2:null,model:null}),G({lab1:null,lab2:null}),oe(null),W({cia1:null,cia2:null}),ae(null);const _e=async ct=>{if(!ie)return null;try{const Mt=await sh({class_type:String(ie).toUpperCase(),question_paper_type:null,exam:ct}),xr=Mt&&Mt.pattern;if(xr&&Array.isArray(xr.marks)&&xr.marks.length)return xr}catch{}try{const Mt=await sh({class_type:String(ie).toUpperCase(),question_paper_type:null,exam:"CIA"}),xr=Mt&&Mt.pattern;if(xr&&Array.isArray(xr.marks)&&xr.marks.length)return xr}catch{}return null};try{const[ct,Mt]=await Promise.all([_e("CIA1"),_e("CIA2")]);T&&W({cia1:ct,cia2:Mt})}catch{T&&W({cia1:null,cia2:null})}let He=null,We=null,Pt=null,dt=null,Ye=null,lt=null,be=null,ke=null,ce=null,we=null,ht=null,nt=null,Ie=null,It=null;if(Te){try{const ct=await ri("cia1",e,D);ct!=null&&ct.draft&&(ce={data:ct.draft.data??ct.draft})}catch{}try{const ct=await ri("cia2",e,D);ct!=null&&ct.draft&&(we={data:ct.draft.data??ct.draft})}catch{}try{const ct=await ri("model",e,D);ct!=null&&ct.draft&&(ht={data:ct.draft.data??ct.draft})}catch{}if(!(ce!=null&&ce.data))try{ce=await Ys("cia1",e,D)}catch{ce=null}if(!(we!=null&&we.data))try{we=await Ys("cia2",e,D)}catch{we=null}if(!(ht!=null&&ht.data))try{ht=await Im(e,D)}catch{ht=null}if(!T)return;P({cia1:(ce==null?void 0:ce.data)??null,cia2:(we==null?void 0:we.data)??null,model:(ht==null?void 0:ht.data)??null}),R({ssa1:{},ssa2:{},f1:{},f2:{},cia1:null,cia2:null});return}if(Le("ssa1"))try{const ct=await ri("ssa1",e,D);ct!=null&&ct.draft&&ct.draft.marks&&(He={marks:ct.draft.marks})}catch{}if(Le("ssa2"))try{const ct=await ri("ssa2",e,D);ct!=null&&ct.draft&&ct.draft.marks&&(We={marks:ct.draft.marks})}catch{}if(Le("ssa1")&&!(He!=null&&He.marks))try{He=await ag(e,D)}catch{He=null}if(Le("ssa2")&&!(We!=null&&We.marks))try{We=await ey(e,D)}catch{We=null}if(me){try{const ct=await ri("review1",e,D);ct!=null&&ct.draft&&ct.draft.marks&&(be={marks:ct.draft.marks})}catch{}try{const ct=await ri("review2",e,D);ct!=null&&ct.draft&&ct.draft.marks&&(ke={marks:ct.draft.marks})}catch{}if(!(be!=null&&be.marks))try{be=await _S(e)}catch{be=null}if(!(ke!=null&&ke.marks))try{ke=await jS(e)}catch{ke=null}if(!T)return;B({r1:(be==null?void 0:be.marks)||{},r2:(ke==null?void 0:ke.marks)||{}})}if(Z){try{const ct=await ri("formative1",e,D);ct!=null&&ct.draft&&(nt={data:ct.draft.data??ct.draft})}catch{}try{const ct=await ri("formative2",e,D);ct!=null&&ct.draft&&(Ie={data:ct.draft.data??ct.draft})}catch{}if(!(nt!=null&&nt.data))try{nt=await Ys("formative1",e,D)}catch{nt=null}if(!(Ie!=null&&Ie.data))try{Ie=await Ys("formative2",e,D)}catch{Ie=null}if(!T)return;G({lab1:(nt==null?void 0:nt.data)??null,lab2:(Ie==null?void 0:Ie.data)??null})}else{if(!me&&Le("formative1")){try{const ct=await ri("formative1",e,D);ct!=null&&ct.draft&&ct.draft.marks&&(Pt={marks:ct.draft.marks})}catch{}if(!(Pt!=null&&Pt.marks))try{Pt=await v0("formative1",e,D)}catch{Pt=null}}if(!me&&Le("formative2")){try{const ct=await ri("formative2",e,D);ct!=null&&ct.draft&&ct.draft.marks&&(dt={marks:ct.draft.marks})}catch{}if(!(dt!=null&&dt.marks))try{dt=await v0("formative2",e,D)}catch{dt=null}}}if(Le("cia1")){try{const ct=await ri("cia1",e,D);ct!=null&&ct.draft&&(Ye={data:ct.draft.data??ct.draft})}catch{}if(!(Ye!=null&&Ye.data))try{Ye=await w0("cia1",e,D)}catch{Ye=null}}if(Le("cia2")){try{const ct=await ri("cia2",e,D);ct!=null&&ct.draft&&(lt={data:ct.draft.data??ct.draft})}catch{}if(!(lt!=null&&lt.data))try{lt=await w0("cia2",e,D)}catch{lt=null}}try{const ct=await ri("model",e,D);ct!=null&&ct.draft&&(It={data:ct.draft.data??ct.draft})}catch{}if(!(It!=null&&It.data))try{It=await Im(e,D)}catch{It=null}try{const ct=It==null?void 0:It.data,Mt=String((ct==null?void 0:ct.qpType)||"").trim().toUpperCase(),xr=Mt==="QP2"?"QP2":Mt==="QP1"?"QP1":null,Pr=String(ie||"").toUpperCase(),Nt=await sh({class_type:Pr,question_paper_type:Pr==="THEORY"?xr:null,exam:"MODEL"}),Jr=Nt==null?void 0:Nt.pattern;Jr&&Array.isArray(Jr.marks)&&Jr.marks.length&&T&&ae(Jr)}catch{}if(!T)return;R({ssa1:(He==null?void 0:He.marks)||{},ssa2:(We==null?void 0:We.marks)||{},f1:(Pt==null?void 0:Pt.marks)||{},f2:(dt==null?void 0:dt.marks)||{},cia1:(Ye==null?void 0:Ye.data)||null,cia2:(lt==null?void 0:lt.data)||null}),oe((It==null?void 0:It.data)||null)}catch(ie){if(!T)return;q((ie==null?void 0:ie.message)||"Failed to load marks")}finally{T&&C(!1)}})(),()=>{T=!1}},[e,u,r,s]);const O=x.useMemo(()=>COe(u,r),[u,r]),X=x.useMemo(()=>{const I=(Array.isArray(j)&&j.length?j:Pc.weights).slice(0,Pc.weights.length);for(;I.length<Pc.weights.length;)I.push(Pc.weights[I.length]??0);const ie=O.visible.map(D=>I[D]??0);return{header:O.header,weights:ie,cycles:O.cycles,visible:O.visible,labels:O.labels}},[j,O]),F=x.useMemo(()=>X.weights.map(I=>Number(I)||0).reduce((I,ie)=>I+ie,0),[X]),Q=x.useMemo(()=>{var nn,gn,nr,Tr,Dr,Rr,tt,Xe,ot,Wt,pr,Nr,br,Je,Ht,it,bt,_t,Tt,Dt,Gt,$t;const T=ni(u),I=new Array(17).fill(0);for(let ze=0;ze<X.visible.length;ze++){const Ze=X.visible[ze];I[Ze]=Number(X.weights[ze])||0}const ie=I[0]||0,D=I[1]||0,Z=I[2]||0,me=I[3]||0,Te=I[4]||0,je=I[5]||0,Le=I[6]||0,_e=I[7]||0,He=I[8]||0,We=I[9]||0,Pt=I[10]||0,dt=I[11]||0,Ye=I[12]||0,lt=I[13]||0,be=I[14]||0,ke=I[15]||0,ce=I[16]||0,we=A.cia1&&typeof A.cia1=="object"?A.cia1:null,ht=A.cia2&&typeof A.cia2=="object"?A.cia2:null,nt=de==null?void 0:de.cia1,Ie=de==null?void 0:de.cia2,It=Array.isArray((gn=(nn=f==null?void 0:f.assessments)==null?void 0:nn.cia1)==null?void 0:gn.questions)?f.assessments.cia1.questions.map(ze=>({key:String((ze==null?void 0:ze.key)||""),max:Number((ze==null?void 0:ze.max)??(ze==null?void 0:ze.maxMarks)??0),co:Sk(ze==null?void 0:ze.co)})).filter(ze=>ze.key):[],ct=Array.isArray((Tr=(nr=f==null?void 0:f.assessments)==null?void 0:nr.cia2)==null?void 0:Tr.questions)?f.assessments.cia2.questions.map(ze=>({key:String((ze==null?void 0:ze.key)||""),max:Number((ze==null?void 0:ze.max)??(ze==null?void 0:ze.maxMarks)??0),co:_k(ze==null?void 0:ze.co)})).filter(ze=>ze.key):[],Mt=nt&&Array.isArray(nt.marks)&&nt.marks.length?nt.marks.map((ze,Ze)=>{const jt=It[Ze],Bt=Array.isArray(nt.cos)?nt.cos[Ze]:void 0;return{key:`q${Ze+1}`,max:Number(ze)||0,co:Bt!=null?Sk(Bt):(jt==null?void 0:jt.co)??1}}).filter(ze=>!!ze.key):[],xr=Ie&&Array.isArray(Ie.marks)&&Ie.marks.length?Ie.marks.map((ze,Ze)=>{const jt=ct[Ze],Bt=Array.isArray(Ie.cos)?Ie.cos[Ze]:void 0;return{key:`q${Ze+1}`,max:Number(ze)||0,co:Bt!=null?_k(Bt):(jt==null?void 0:jt.co)??3}}).filter(ze=>!!ze.key):[],Pr=Array.isArray(we==null?void 0:we.questions)?we.questions.map(ze=>({key:String((ze==null?void 0:ze.key)||""),max:Number((ze==null?void 0:ze.max)??(ze==null?void 0:ze.maxMarks)??0),co:Sk(ze==null?void 0:ze.co)})).filter(ze=>ze.key):Mt.length?Mt:It.length?It:_Oe,Nt=Array.isArray(ht==null?void 0:ht.questions)?ht.questions.map(ze=>({key:String((ze==null?void 0:ze.key)||""),max:Number((ze==null?void 0:ze.max)??(ze==null?void 0:ze.maxMarks)??0),co:_k(ze==null?void 0:ze.co)})).filter(ze=>ze.key):xr.length?xr:ct.length?ct:jOe,Jr=we!=null&&we.rowsByStudentId&&typeof we.rowsByStudentId=="object"?we.rowsByStudentId:{},Ur=ht!=null&&ht.rowsByStudentId&&typeof ht.rowsByStudentId=="object"?ht.rowsByStudentId:{},qr=Pr.reduce((ze,Ze,jt)=>{const Bt=jk(Pr,jt);return ze+Ze.max*Bt.co1},0),cn=Pr.reduce((ze,Ze,jt)=>{const Bt=jk(Pr,jt);return ze+Ze.max*Bt.co2},0),Pn=Nt.reduce((ze,Ze,jt)=>{const Bt=kk(Nt,jt);return ze+Ze.max*Bt.co3},0),Lr=Nt.reduce((ze,Ze,jt)=>{const Bt=kk(Nt,jt);return ze+Ze.max*Bt.co4},0),mn=((Dr=f==null?void 0:f.assessments)==null?void 0:Dr.ssa1)||{},Me=((Rr=f==null?void 0:f.assessments)==null?void 0:Rr.ssa2)||{},qe=((tt=f==null?void 0:f.assessments)==null?void 0:tt.formative1)||{},ut=((Xe=f==null?void 0:f.assessments)==null?void 0:Xe.formative2)||{},wt=((ot=f==null?void 0:f.assessments)==null?void 0:ot.cia1)||{},At=((Wt=f==null?void 0:f.assessments)==null?void 0:Wt.cia2)||{},sr=Number((pr=mn==null?void 0:mn.coMax)==null?void 0:pr.co1),Zt=Number((Nr=mn==null?void 0:mn.coMax)==null?void 0:Nr.co2),Cr=Number(((br=Me==null?void 0:Me.coMax)==null?void 0:br.co3)??((Je=Me==null?void 0:Me.coMax)==null?void 0:Je.co1)),se=Number(((Ht=Me==null?void 0:Me.coMax)==null?void 0:Ht.co4)??((it=Me==null?void 0:Me.coMax)==null?void 0:it.co2)),ue=Number((bt=wt==null?void 0:wt.coMax)==null?void 0:bt.co1),J=Number((_t=wt==null?void 0:wt.coMax)==null?void 0:_t.co2),pe=Number(((Tt=At==null?void 0:At.coMax)==null?void 0:Tt.co3)??((Dt=At==null?void 0:At.coMax)==null?void 0:Dt.co1)),xe=Number(((Gt=At==null?void 0:At.coMax)==null?void 0:Gt.co4)??(($t=At==null?void 0:At.coMax)==null?void 0:$t.co2)),Ne=Number(qe==null?void 0:qe.maxCo),St=Number(ut==null?void 0:ut.maxCo),Ve=T==="TCPL",De={ssa1:{co1:Number.isFinite(sr)?Math.max(0,sr):10,co2:Number.isFinite(Zt)?Math.max(0,Zt):10},ssa2:{co3:Number.isFinite(Cr)?Math.max(0,Cr):10,co4:Number.isFinite(se)?Math.max(0,se):10},cia1:{co1:Ve?qr>0?qr:Number.isFinite(ue)?Math.max(0,ue):30:Number.isFinite(ue)?Math.max(0,ue):qr,co2:Ve?cn>0?cn:Number.isFinite(J)?Math.max(0,J):30:Number.isFinite(J)?Math.max(0,J):cn},cia2:{co3:Ve?Pn>0?Pn:Number.isFinite(pe)?Math.max(0,pe):30:Number.isFinite(pe)?Math.max(0,pe):Pn,co4:Ve?Lr>0?Lr:Number.isFinite(xe)?Math.max(0,xe):30:Number.isFinite(xe)?Math.max(0,xe):Lr},f1:{co1:Number.isFinite(Ne)?Math.max(0,Ne):10,co2:Number.isFinite(Ne)?Math.max(0,Ne):10},f2:{co3:Number.isFinite(St)?Math.max(0,St):10,co4:Number.isFinite(St)?Math.max(0,St):10},review1:{co1:15,co2:15},review2:{co3:15,co4:15}},Re=T==="TCPL",xt=T==="TCPR",Vt=Re||xt,qt=Array.isArray(V==null?void 0:V.marks)?V.marks:null,zt=(()=>{if(Array.isArray(qt)&&qt.length)return qt.map((ze,Ze)=>({key:`q${Ze+1}`,max:Number(ze)||0}));if(Vt){const ze=xt?12:15,Ze=xt?8:10;return Array.from({length:ze},(jt,Bt)=>{const gr=Bt+1;return{key:`q${gr}`,max:gr<=Ze?2:16}})}return kOe})(),vt=(()=>{const ze=Array.isArray(V==null?void 0:V.cos)?V.cos:null;if(Array.isArray(ze)&&ze.length===zt.length)return ze.map(Ze=>{const jt=Number(Ze);if(Number.isFinite(jt))return fi(Math.round(jt),1,5);const gr=String(Ze??"").toUpperCase().match(/\d+/);return gr?fi(Number(gr[0]),1,5):1});if(xt){const Ze=[1,1,2,2,3,3,4,4,1,2,3,4];return zt.length===Ze.length?Ze:Array.from({length:zt.length},(jt,Bt)=>Ze[Bt%Ze.length])}if(Re){const Ze=[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5];return zt.length===Ze.length?Ze:Array.from({length:zt.length},(jt,Bt)=>Ze[Bt%Ze.length])}return zt.length===Sv.length?[...Sv]:Array.from({length:zt.length},(Ze,jt)=>Sv[jt%Sv.length])})(),Lt=(()=>{const ze={co1:0,co2:0,co3:0,co4:0,co5:0};for(let Ze=0;Ze<zt.length;Ze++){const jt=zt[Ze],Bt=vt[Ze]??1;Bt===1?ze.co1+=jt.max:Bt===2?ze.co2+=jt.max:Bt===3?ze.co3+=jt.max:Bt===4?ze.co4+=jt.max:Bt===5&&(ze.co5+=jt.max)}return ze})(),er=(()=>{const ze={...Lt};return xt?{...ze,co5:ze.co5+30}:Re?{co1:ze.co1+6,co2:ze.co2+6,co3:ze.co3+6,co4:ze.co4+6,co5:ze.co5+6}:ze})(),yr=String(s??"none"),Br=H&&typeof H=="object"?H:null,cr=(()=>{if(Br){const Fe=ni(Br==null?void 0:Br.classType),Ct=Fe==="TCPL"||Fe==="TCPR"?Br==null?void 0:Br.tcplSheet:Br==null?void 0:Br.theorySheet;if(Ct&&typeof Ct=="object")return Ct}const ze=`model_theory_sheet_${e}_${yr}`,Ze=`model_theory_sheet_${e}_none`,jt=`model_tcpl_sheet_${e}_${yr}`,Bt=`model_tcpl_sheet_${e}_none`,gr=`model_tcpr_sheet_${e}_${yr}`,dr=`model_tcpr_sheet_${e}_none`,Kt=`model_sheet_${e}`,ye=Zn(ze);if(ye&&typeof ye=="object")return ye;const Ce=Zn(Ze);if(Ce&&typeof Ce=="object")return Ce;const $e=Zn(jt);if($e&&typeof $e=="object")return $e;const ft=Zn(Bt);if(ft&&typeof ft=="object")return ft;const Sr=Zn(gr);if(Sr&&typeof Sr=="object")return Sr;const at=Zn(dr);if(at&&typeof at=="object")return at;const Ut=Zn(Kt);return Ut&&typeof Ut=="object"?Ut:null})(),ur=ze=>{const Ze=er;if(!cr)return{co1:null,co2:null,co3:null,co4:null,co5:null,max:Ze};const jt=`id:${String(ze.id)}`,Bt=ze.reg_no?`reg:${String(ze.reg_no).trim()}`:"",gr=cr[jt]||(Bt?cr[Bt]:null)||null;if(!gr||typeof gr!="object")return{co1:null,co2:null,co3:null,co4:null,co5:null,max:Ze};const dr=!!gr.absent,Kt=String(gr.absentKind||"AL").toUpperCase(),ye=gr.q&&typeof gr.q=="object"?gr.q:{},Ce=Oo(gr.lab);let $e=!1;const ft={co1:0,co2:0,co3:0,co4:0,co5:0};for(let Sr=0;Sr<zt.length;Sr++){const at=zt[Sr],Ut=ye[at.key],Fe=Oo(Ut);if(Fe==null)continue;$e=!0;const Ue=fi(Fe,0,at.max),Ct=vt[Sr]??1;Ct===1?ft.co1+=Ue:Ct===2?ft.co2+=Ue:Ct===3?ft.co3+=Ue:Ct===4?ft.co4+=Ue:Ct===5&&(ft.co5+=Ue)}if(Vt&&Ce!=null){$e=!0;const Sr=fi(Ce,0,30);if(xt)ft.co5+=Sr;else{const at=Sr/5;ft.co1+=at,ft.co2+=at,ft.co3+=at,ft.co4+=at,ft.co5+=at}}return $e?dr&&Kt==="AL"?{co1:0,co2:0,co3:0,co4:0,co5:0,max:Ze}:{co1:fi(ft.co1,0,Ze.co1),co2:fi(ft.co2,0,Ze.co2),co3:fi(ft.co3,0,Ze.co3),co4:fi(ft.co4,0,Ze.co4),co5:fi(ft.co5,0,Ze.co5),max:Ze}:dr&&Kt==="AL"?{co1:0,co2:0,co3:0,co4:0,co5:0,max:Ze}:{co1:null,co2:null,co3:null,co4:null,co5:null,max:Ze}},en=(ze,Ze,jt)=>ze==null||!Ze||!Number.isFinite(Ze)?null:fi(ze/Ze*jt,0,jt);if(T==="LAB"||T==="PRACTICAL"){const Ze=(Kt,ye,Ce)=>{const $e=Kt!=null&&Kt.sheet&&typeof Kt.sheet=="object"?Kt.sheet:{},ft=$e!=null&&$e.rowsByStudentId&&typeof $e.rowsByStudentId=="object"?$e.rowsByStudentId:{},Sr=fi(Number(($e==null?void 0:$e.expCountA)??0),0,12),at=fi(Number(($e==null?void 0:$e.expCountB)??0),0,12),Ut=!!($e!=null&&$e.coAEnabled),Fe=!!($e!=null&&$e.coBEnabled),Ue=!!($e!=null&&$e.ciaExamEnabled),Ct=$e!=null&&$e.coConfigs&&typeof $e.coConfigs=="object"?$e.coConfigs:null,gt=Ct?Ct[String(ye)]:null,yt=Ce!=null&&Ct?Ct[String(Ce)]:null,mt=gt?!!gt.enabled:Ut,tr=Ce!=null?yt?!!yt.enabled:Fe:!1,lr=gt?fi(Number(gt.expCount??0),0,12):Sr,Fr=Ce!=null?yt?fi(Number(yt.expCount??0),0,12):at:0,rn=gt&&Number.isFinite(Number(gt.expMax))?Number(gt.expMax):Number.isFinite(Number($e==null?void 0:$e.expMaxA))?Number($e.expMaxA):25,Sn=Ce!=null?yt&&Number.isFinite(Number(yt.expMax))?Number(yt.expMax):Number.isFinite(Number($e==null?void 0:$e.expMaxB))?Number($e.expMaxB):25:0,Gr=rn+(Ue?15:0),fn=Ce!=null?Sn+(Ue?15:0):0,an=(st,pt)=>Array.isArray(st)?st.map(Qe=>typeof Qe=="number"&&Number.isFinite(Qe)?Qe:null):st==null?[]:[],bn=st=>{const pt=(st||[]).filter(Qe=>typeof Qe=="number"&&Number.isFinite(Qe));return pt.length?pt.reduce((Qe,vr)=>Qe+vr,0)/pt.length:null};return{get:st=>{const pt=ft[String(st)]||{},Qe=pt!=null&&pt.marksByCo&&typeof pt.marksByCo=="object"?pt.marksByCo:{},vr=(Qe==null?void 0:Qe[String(ye)])??pt.marksA,tn=Ce!=null?(Qe==null?void 0:Qe[String(Ce)])??pt.marksB:[],An=an(vr).slice(0,mt?lr:0),xn=an(tn).slice(0,tr?Fr:0),zn=bn(An),Rn=bn(xn),xi=pt==null?void 0:pt.ciaExam,L=typeof xi=="number"&&Number.isFinite(xi)?xi:null,le=zn!=null||Rn!=null||L!=null,Oe=le?(zn??0)+(Ue?(L??0)/2:0):null,rt=le?(Rn??0)+(Ue?(L??0)/2:0):null;return{a:Oe==null?null:fi(Oe,0,Gr),b:rt==null?null:fi(rt,0,fn)}},CO_MAX_A:Gr,CO_MAX_B:fn}},jt=Ze(E.cia1,1,2),Bt=Ze(E.cia2,3,4),gr=Ze(E.model,5,null),dr=(Kt,ye,Ce)=>Kt==null||!ye||!Number.isFinite(ye)?null:fi(Kt/ye*Ce,0,Ce);return p.map((Kt,ye)=>{const Ce=jt.get(Kt.id),$e=Bt.get(Kt.id),ft=gr.get(Kt.id),Sr=null,at=dr(Ce.a,jt.CO_MAX_A,D),Ut=null,Fe=null,Ue=dr(Ce.b,jt.CO_MAX_B,Te),Ct=null,gt=null,yt=dr($e.a,Bt.CO_MAX_A,_e),mt=null,tr=null,lr=dr($e.b,Bt.CO_MAX_B,Pt),Fr=null,rn=null,Sn=null,Gr=null,fn=null,an=dr(ft.a,gr.CO_MAX_A,ce),bn=[Sr,at,Ut,Fe,Ue,Ct,gt,yt,mt,tr,lr,Fr,rn,Sn,Gr,fn,an],Se=X.visible.map(vr=>bn[vr]),pt=Se.some(vr=>typeof vr=="number"&&Number.isFinite(vr))?zf(Se.reduce((vr,tn)=>vr+(typeof tn=="number"&&Number.isFinite(tn)?tn:0),0)):null,Qe=pt==null||!F?null:zf(pt/F*100);return{sno:ye+1,...Kt,cells:Se,total:pt,pct:Qe}})}return p.map((ze,Ze)=>{const jt=Oo(A.ssa1[String(ze.id)]),Bt=Oo(A.ssa2[String(ze.id)]),gr=jt==null?null:Number(jt)/2,dr=Bt==null?null:Number(Bt)/2,Kt=gr==null?null:fi(gr,0,De.ssa1.co1),ye=gr==null?null:fi(gr,0,De.ssa1.co2),Ce=dr==null?null:fi(dr,0,De.ssa2.co3),$e=dr==null?null:fi(dr,0,De.ssa2.co4),ft=(A.f1||{})[String(ze.id)]||{},Sr=(A.f2||{})[String(ze.id)]||{},at=Oo(ft==null?void 0:ft.skill1)!=null&&Oo(ft==null?void 0:ft.att1)!=null?fi(Number(ft.skill1)+Number(ft.att1),0,De.f1.co1):null,Ut=Oo(ft==null?void 0:ft.skill2)!=null&&Oo(ft==null?void 0:ft.att2)!=null?fi(Number(ft.skill2)+Number(ft.att2),0,De.f1.co2):null,Fe=Oo(Sr==null?void 0:Sr.skill1)!=null&&Oo(Sr==null?void 0:Sr.att1)!=null?fi(Number(Sr.skill1)+Number(Sr.att1),0,De.f2.co3):null,Ue=Oo(Sr==null?void 0:Sr.skill2)!=null&&Oo(Sr==null?void 0:Sr.att2)!=null?fi(Number(Sr.skill2)+Number(Sr.att2),0,De.f2.co4):null,Ct=Oo(M.r1[String(ze.id)]),gt=Oo(M.r2[String(ze.id)]),yt=Ct==null?null:Number(Ct)/2,mt=gt==null?null:Number(gt)/2,tr=yt==null?null:fi(yt,0,De.review1.co1),lr=yt==null?null:fi(yt,0,De.review1.co2),Fr=mt==null?null:fi(mt,0,De.review2.co3),rn=mt==null?null:fi(mt,0,De.review2.co4),Sn=(Mr,Qr,Vr)=>{const Xt=Mr!=null&&Mr.sheet&&typeof Mr.sheet=="object"?Mr.sheet:{},vn=Xt!=null&&Xt.rowsByStudentId&&typeof Xt.rowsByStudentId=="object"?Xt.rowsByStudentId:{},hn=30/2,kn=Xt!=null&&Xt.coConfigs&&typeof Xt.coConfigs=="object"?Xt.coConfigs:null,_n=kn?kn[String(Qr)]:null,yn=Vr!=null&&kn?kn[String(Vr)]:null,ci=fi(Number((Xt==null?void 0:Xt.expCountA)??0),0,12),Wn=fi(Number((Xt==null?void 0:Xt.expCountB)??0),0,12),mi=(Xt==null?void 0:Xt.coAEnabled)!==!1,Jn=Vr!=null?(Xt==null?void 0:Xt.coBEnabled)!==!1:!1,ca=_n?!!_n.enabled:mi,Rl=Vr!=null?yn?!!yn.enabled:Jn:!1,Ko=_n?fi(Number(_n.expCount??0),0,12):ci,So=Vr!=null?yn?fi(Number(yn.expCount??0),0,12):Wn:0,_o=_n&&Number.isFinite(Number(_n.expMax))?Number(_n.expMax):Number.isFinite(Number(Xt==null?void 0:Xt.expMaxA))?Number(Xt.expMaxA):25,Ss=Vr!=null?yn&&Number.isFinite(Number(yn.expMax))?Number(yn.expMax):Number.isFinite(Number(Xt==null?void 0:Xt.expMaxB))?Number(Xt.expMaxB):25:0,ba=(Xt==null?void 0:Xt.ciaExamEnabled)!==!1,cs=_o+(ba?hn:0),Bi=Vr!=null?Ss+(ba?hn:0):0,Aa=Ci=>Array.isArray(Ci)?Ci.map(Hn=>typeof Hn=="number"&&Number.isFinite(Hn)?Hn:null):[],ro=Ci=>{const Hn=(Ci||[]).filter(Yi=>typeof Yi=="number"&&Number.isFinite(Yi));return Hn.length?Hn.reduce((Yi,_s)=>Yi+_s,0)/Hn.length:null};return{get:Ci=>{const Hn=vn[String(Ci)]||{},Yi=Hn!=null&&Hn.marksByCo&&typeof Hn.marksByCo=="object"?Hn.marksByCo:{},_s=(Yi==null?void 0:Yi[String(Qr)])??(Hn==null?void 0:Hn.marksA),hd=Vr!=null?(Yi==null?void 0:Yi[String(Vr)])??(Hn==null?void 0:Hn.marksB):[],Xc=Aa(_s).slice(0,ca?Ko:0),gc=Aa(hd).slice(0,Rl?So:0),xc=ro(Xc),Yo=ro(gc),no=Hn==null?void 0:Hn.ciaExam,pl=typeof no=="number"&&Number.isFinite(no)?no:null,yc=xc!=null||Yo!=null||pl!=null,Fl=yc?(xc??0)+(ba?(pl??0)/2:0):null,Bl=yc?(Yo??0)+(ba?(pl??0)/2:0):null;return{a:Fl==null?null:fi(Fl,0,cs),b:Bl==null?null:fi(Bl,0,Bi)}},CO_MAX_A:cs,CO_MAX_B:Bi}},Gr=T==="TCPL"?Sn(U.lab1,1,2):null,fn=T==="TCPL"?Sn(U.lab2,3,4):null,an=Gr?Gr.get(ze.id):null,bn=fn?fn.get(ze.id):null,Se=(an==null?void 0:an.a)??null,st=(an==null?void 0:an.b)??null,pt=(bn==null?void 0:bn.a)??null,Qe=(bn==null?void 0:bn.b)??null,vr=Jr[String(ze.id)]||{},tn=Ur[String(ze.id)]||{},An=!!(vr!=null&&vr.absent),xn=!!(tn!=null&&tn.absent);let zn=null,Rn=null;if(!An){const Mr=vr!=null&&vr.q&&typeof vr.q=="object"?vr.q:{};let Qr=!1,Vr=0,Xt=0;for(let vn=0;vn<Pr.length;vn++){const hn=Pr[vn],kn=Oo(Mr==null?void 0:Mr[hn.key]);if(kn==null)continue;Qr=!0;const _n=fi(kn,0,hn.max||kn),yn=jk(Pr,vn);Vr+=_n*yn.co1,Xt+=_n*yn.co2}Qr&&(zn=fi(Vr,0,De.cia1.co1),Rn=fi(Xt,0,De.cia1.co2))}let xi=null,L=null;if(!xn){const Mr=tn!=null&&tn.q&&typeof tn.q=="object"?tn.q:{};let Qr=!1,Vr=0,Xt=0;for(let vn=0;vn<Nt.length;vn++){const hn=Nt[vn],kn=Oo(Mr==null?void 0:Mr[hn.key]);if(kn==null)continue;Qr=!0;const _n=fi(kn,0,hn.max||kn),yn=kk(Nt,vn);Vr+=_n*yn.co3,Xt+=_n*yn.co4}Qr&&(xi=fi(Vr,0,De.cia2.co3),L=fi(Xt,0,De.cia2.co4))}const le=en(Kt,De.ssa1.co1,ie),Oe=en(zn,De.cia1.co1,D),rt=T==="TCPR"?en(tr,De.review1.co1,Z):T==="TCPL"?en(Se,(Gr==null?void 0:Gr.CO_MAX_A)??De.f1.co1,Z):en(at,De.f1.co1,Z),Et=en(ye,De.ssa1.co2,me),hr=en(Rn,De.cia1.co2,Te),ir=T==="TCPR"?en(lr,De.review1.co2,je):T==="TCPL"?en(st,(Gr==null?void 0:Gr.CO_MAX_B)??De.f1.co2,je):en(Ut,De.f1.co2,je),wr=en(Ce,De.ssa2.co3,Le),Wr=en(xi,De.cia2.co3,_e),Xr=T==="TCPR"?en(Fr,De.review2.co3,He):T==="TCPL"?en(pt,(fn==null?void 0:fn.CO_MAX_A)??De.f2.co3,He):en(Fe,De.f2.co3,He),dn=en($e,De.ssa2.co4,We),Ln=en(L,De.cia2.co4,Pt),si=T==="TCPR"?en(rn,De.review2.co4,dt):T==="TCPL"?en(Qe,(fn==null?void 0:fn.CO_MAX_B)??De.f2.co4,dt):en(Ue,De.f2.co4,dt),Ir=ur(ze),fe=en(Ir.co1,Ir.max.co1,Ye),Ee=en(Ir.co2,Ir.max.co2,lt),et=en(Ir.co3,Ir.max.co3,be),Be=en(Ir.co4,Ir.max.co4,ke),kt=en(Ir.co5,Ir.max.co5,ce),ar=[le,Oe,rt,Et,hr,ir,wr,Wr,Xr,dn,Ln,si,fe,Ee,et,Be,kt],Rt=X.visible.map(Mr=>ar[Mr]),_r=Rt.some(Mr=>typeof Mr=="number"&&Number.isFinite(Mr))?zf(Rt.reduce((Mr,Qr)=>Mr+(typeof Qr=="number"&&Number.isFinite(Qr)?Qr:0),0)):null,Hr=_r==null||!F?null:zf(_r/F*100);return{sno:Ze+1,...ze,cells:Rt,total:_r,pct:Hr}})},[X,A,M,E,U,H,p,w,F,e,s,f,u,de,V]),K=X.header,ne=X.cycles,re=X.weights;return a.jsxs("div",{style:{padding:12},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",gap:12,flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{children:[a.jsx("h3",{style:{margin:0},children:"INTERNAL MARK"}),a.jsx("div",{style:{color:"#6b7280",marginTop:4},children:"Summative + Formative (based on IQAC mapping)"})]}),a.jsx("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center"},children:a.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[a.jsx("span",{style:{color:"#374151",fontWeight:700},children:"Section"}),a.jsxs("select",{value:s??"",onChange:T=>o(T.target.value?Number(T.target.value):null),style:{padding:8,borderRadius:8,border:"1px solid #d1d5db"},children:[a.jsx("option",{value:"",disabled:!0,children:""}),n.map(T=>{const I=T.department,ie=(I==null?void 0:I.short_name)||(I==null?void 0:I.code)||(I==null?void 0:I.name)||T.department_name||"",D=T.semester,Z=`${T.section_name||`TA ${T.id}`} ${D?` Sem ${D}`:""} ${ie?` ${ie}`:""}`;return a.jsx("option",{value:T.id,children:Z},T.id)})]})]})})]}),l?a.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:l}):null,g?a.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:g}):null,Y?a.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:Y}):null,b||ee?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading"}):null,a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:10},children:a.jsxs("table",{style:{borderCollapse:"collapse",width:"100%",fontSize:12},children:[a.jsxs("thead",{children:[a.jsxs("tr",{children:[a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb"},children:"S.No"}),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb"},children:"Register No."}),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb"},children:"Name"}),K.map((T,I)=>a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f3f4f6"},children:String(T)},I)),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb"},children:zf(F)}),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb"},children:"100"})]}),a.jsxs("tr",{children:[a.jsx("th",{colSpan:3,style:{border:"1px solid #e5e7eb",padding:8,background:"#fff",textAlign:"left",fontWeight:800},children:"internal weightage"}),re.map((T,I)=>a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f3f4f6"},children:Number(T).toFixed(1)},`w-${I}`)),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#fff"}}),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#fff"}})]}),a.jsxs("tr",{children:[a.jsx("th",{colSpan:3,style:{border:"1px solid #e5e7eb",padding:8,background:"#fff",textAlign:"left",fontWeight:800},children:"cycle"}),ne.map((T,I)=>a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#fff"},children:String(T)},`c-${I}`)),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#fff"}}),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#fff"}})]})]}),a.jsx("tbody",{children:Q.map(T=>a.jsxs("tr",{children:[a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6},children:T.sno}),a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6},children:T.reg_no}),a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6},children:T.name}),(Array.isArray(T.cells)?T.cells:[]).map((I,ie)=>a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6,textAlign:"center"},children:I==null?"":Number(I).toFixed(2)},ie)),a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6,textAlign:"center",fontWeight:800},children:T.total==null?"":Number(T.total).toFixed(2)}),a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6,textAlign:"center"},children:T.pct==null?"":Number(T.pct).toFixed(2)})]},T.id))})]})})]})}function TOe(){const{code:e}=z0(),t=vo(),r=hl(),n=e?decodeURIComponent(e):"",[i,s]=sn.useState(()=>"marks"),[o,l]=sn.useState(null),[c,u]=sn.useState(null),[d,f]=sn.useState(!1),[h,p]=sn.useState(()=>{if(!n)return"QP1";try{const b=localStorage.getItem(`obe_course_qp_${n}`);return String(b||"").trim().toUpperCase()==="QP2"?"QP2":"QP1"}catch{return"QP1"}}),[m,g]=sn.useState(null);sn.useEffect(()=>{if(!r||!r.pathname)return;const b=r.pathname.toLowerCase();b.includes("/lca/instructions")||b.includes("/lca_instructions")||b.includes("/lca")||b.includes("/cdap")||b.includes("/articulation")?s("lca_instructions"):b.includes("/marks")?s("marks"):b.includes("/co_attainment")?s("co_attainment"):b.includes("/internal_mark")||b.includes("/internal-mark")?s("internal_mark"):b.includes("/cqi")?s("cqi"):s("marks")},[r]);const y=sn.useMemo(()=>{const b=String((r==null?void 0:r.pathname)||"").toLowerCase();return b.includes("/cdap")?"cdap":b.includes("/articulation")?"articulation":b.includes("/lca")&&!(b.includes("/lca/instructions")||b.includes("/lca_instructions"))?"lca":"instructions"},[r==null?void 0:r.pathname]);return sn.useEffect(()=>{if(!n)return;let b=!0;return(async()=>{try{b&&f(!1);const v=await hc();if(!b)return;const w=(v||[]).filter(R=>String(R.subject_code)===String(n)),S=w[0]||null;S&&l(S.subject_name||null);let j=null;try{const R=localStorage.getItem(`markEntry_selectedTa_${n}`),M=R==null?NaN:Number(R);j=Number.isFinite(M)?M:null}catch{j=null}const k=j!=null&&w.find(R=>Number(R.id)===Number(j))||w.find(R=>String((R==null?void 0:R.class_type)||"").trim())||S,A=String((k==null?void 0:k.class_type)||"").trim();A&&(u(A),f(!0))}catch{}})(),()=>{b=!1}},[n]),sn.useEffect(()=>{if(!n)return;let b=!0;return(async()=>{try{const v=await Sl();if(!b)return;const w=String(n),S=w.toUpperCase(),j=(v||[]).filter(B=>String((B==null?void 0:B.course_code)||"").trim()===w||String((B==null?void 0:B.course_code)||"").trim().toUpperCase()===S),k=B=>String(B||"").trim().toUpperCase(),A=j.find(B=>{const E=k(B==null?void 0:B.question_paper_type);return E&&E!=="QP1"})||j.find(B=>k(B==null?void 0:B.question_paper_type))||j.find(B=>String((B==null?void 0:B.class_type)||"").trim())||j[0];if(!d&&A&&A.class_type){const B=String(A.class_type||"").trim();u(B||null)}else if(!d)try{const B=await pm();if(!b)return;const E=(Array.isArray(B)?B:B.results||[]).find(P=>String(P.course_code||"").trim().toUpperCase()===S);E&&E.class_type&&(u(String(E.class_type||"").trim()||null),Array.isArray(E.enabled_assessments)&&E.enabled_assessments.length&&g(E.enabled_assessments.map(P=>String(P).trim().toLowerCase()).filter(Boolean)))}catch{}let R=null;try{R=localStorage.getItem(`obe_course_qp_${n}`)}catch{R=null}const M=String(R||"").trim().toUpperCase();if(M==="QP1"||M==="QP2")p(M);else{const B=String((A==null?void 0:A.question_paper_type)||"").trim().toUpperCase();p(B==="QP2"?"QP2":"QP1")}if(ni(A==null?void 0:A.class_type)==="SPECIAL"){g([]);try{const B=await vS(w);g(Array.isArray(B)?B:[])}catch{const B=A==null?void 0:A.enabled_assessments;g(Array.isArray(B)?B.map(E=>String(E).trim().toLowerCase()).filter(Boolean):[])}}else g(null)}catch{}})(),()=>{b=!1}},[n]),e?a.jsx("main",{className:"obe-course-page",style:{padding:"32px 48px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',minHeight:"100vh",background:"linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)"},children:a.jsxs("div",{style:{width:"100%",minWidth:0,boxSizing:"border-box"},children:[a.jsx("div",{style:{marginBottom:24,background:"#fff",padding:"28px 32px",borderRadius:16,boxShadow:"0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04)"},children:a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:24,flexWrap:"wrap"},children:[a.jsxs("div",{style:{flex:1},children:[a.jsxs("h2",{style:{margin:0,fontSize:32,fontWeight:700,color:"#0f172a",letterSpacing:"-0.02em"},children:["OBE - ",n]}),a.jsx("div",{style:{color:"#64748b",marginTop:8,fontSize:16},children:"Course OBE workspace"}),o&&a.jsx("div",{style:{color:"#1e293b",marginTop:12,fontWeight:700,fontSize:20},children:o}),a.jsxs("div",{style:{marginTop:16,display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[c&&a.jsxs("div",{style:{background:"#eff6ff",color:"#3b82f6",padding:"6px 14px",borderRadius:8,fontWeight:600,fontSize:14,border:"1px solid #bfdbfe"},children:[" Class type: ",a.jsx("strong",{children:String(c).toLowerCase()[0].toUpperCase()+String(c).toLowerCase().slice(1)})]}),a.jsxs("div",{style:{background:"#f8fafc",color:"#475569",padding:"6px 14px",borderRadius:8,fontWeight:600,fontSize:14,border:"1px solid #e2e8f0",display:"flex",alignItems:"center",gap:8},children:[a.jsx("span",{children:" QP Type:"}),a.jsxs("select",{value:String(h||"QP1").trim().toUpperCase()==="QP2"?"QP2":"QP1",onChange:b=>{const w=String(b.target.value||"").trim().toUpperCase()==="QP2"?"QP2":"QP1";p(w);try{localStorage.setItem(`obe_course_qp_${n}`,w)}catch{}},style:{padding:"4px 10px",borderRadius:6,border:"1px solid #cbd5e1",fontSize:14,fontWeight:600,color:"#0f172a",background:"#fff",cursor:"pointer"},children:[a.jsx("option",{value:"QP1",children:"QP1"}),a.jsx("option",{value:"QP2",children:"QP2"})]})]})]})]}),a.jsx("div",{children:a.jsx("button",{onClick:()=>t("/obe"),onMouseEnter:b=>{b.currentTarget.style.background="#f8fafc",b.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:b=>{b.currentTarget.style.background="#fff",b.currentTarget.style.borderColor="#e2e8f0"},style:{padding:"10px 20px",borderRadius:10,border:"1px solid #e2e8f0",background:"#fff",color:"#475569",cursor:"pointer",fontWeight:600,fontSize:15,transition:"all 0.2s ease",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:" Back to courses"})})]})}),a.jsx("div",{style:{display:"flex",gap:6,marginBottom:24,background:"#fff",padding:"8px",borderRadius:12,boxShadow:"0 1px 3px rgba(0,0,0,0.06)",flexWrap:"wrap"},"aria-label":"OBE Tabs",children:[{key:"lca_instructions",label:" Learner Centric Approach",icon:""},{key:"marks",label:" Mark Entry",icon:""},{key:"co_attainment",label:" CO Attainment",icon:""},{key:"cqi",label:" CQI",icon:""},{key:"internal_mark",label:" Internal Mark",icon:""}].map(b=>{const v=i===b.key;return a.jsx("button",{onClick:()=>{if(s(b.key),e){const w=encodeURIComponent(e),S=b.key==="lca_instructions"?"lca/instructions":String(b.key);t(`/obe/course/${w}/${S}`)}},onMouseEnter:w=>{v||(w.currentTarget.style.background="rgba(59,130,246,0.08)",w.currentTarget.style.color="#3b82f6")},onMouseLeave:w=>{v||(w.currentTarget.style.background="transparent",w.currentTarget.style.color="#64748b")},style:{padding:"10px 24px",borderRadius:8,border:"none",background:v?"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)":"transparent",color:v?"#fff":"#64748b",cursor:"pointer",fontWeight:v?600:500,fontSize:15,transition:"all 0.2s ease",boxShadow:v?"0 2px 8px rgba(37,99,235,0.2)":"none"},children:b.label},b.key)})}),a.jsxs("div",{children:[i==="marks"&&a.jsx(SOe,{courseId:n,classType:c,questionPaperType:h,enabledAssessments:m}),i==="lca_instructions"&&a.jsx(PK,{courseCode:n,courseName:o,initialTab:y}),i==="co_attainment"&&a.jsx(MK,{courseId:n,enabledAssessments:m,classType:c}),i==="internal_mark"&&a.jsx(EOe,{courseId:n,enabledAssessments:m}),i==="cqi"&&a.jsx(LK,{courseId:n})]})]})}):a.jsxs("div",{style:{padding:24},children:[a.jsx("p",{style:{color:"#666"},children:"No course selected."}),a.jsx("button",{onClick:()=>t("/obe"),className:"obe-btn obe-btn-primary",children:"Back"})]})}function POe(){var G,H,oe,de,W,V,ae,ee,C,Y,q;const e=vo(),[t]=YJ(),r=x.useMemo(()=>{const O=String(t.get("subject_code")||"").trim(),X=String(t.get("assessment")||"").trim().toLowerCase(),F=String(t.get("reason")||"Edit Marks").trim(),Q=t.get("teaching_assignment_id"),K=Q?Number(Q):void 0;return{subject_code:O,assessment:X,reason:F,teaching_assignment_id:Number.isFinite(K)?K:void 0}},[t]),[n,i]=x.useState(r.subject_code),[s,o]=x.useState(r.assessment),[l,c]=x.useState(r.reason),[u,d]=x.useState(String(r.teaching_assignment_id??"")),[f,h]=x.useState(!1),[p,m]=x.useState(null),[g,y]=x.useState(!1),[b,v]=x.useState(!1),[w,S]=x.useState(null),[j,k]=x.useState(null),[A,R]=x.useState(null),[M,B]=x.useState(null),E=x.useMemo(()=>{const O=String(u||"").trim();if(!O)return null;const X=Number(O);return Number.isFinite(X)?X:null},[u]);async function P(){y(!0),v(!0),S(null);try{if(!j){const O=await mr("/api/accounts/me/",{method:"GET"});O.ok&&k(await O.json())}if(E!=null&&M!==E)try{const O=await pc(E);R(O),B(E)}catch(O){R(null),B(null),S((O==null?void 0:O.message)||"Failed to load course details")}}catch(O){S((O==null?void 0:O.message)||"Failed to load profile")}finally{v(!1)}}async function U(){h(!0),m(null);try{const O=(u||"").trim(),X=O?Number(O):void 0;await jh({assessment:s,subject_code:n,reason:l,teaching_assignment_id:Number.isFinite(X)?X:void 0,force:!0}),alert("Edit request sent to IQAC."),e(-1)}catch(O){m((O==null?void 0:O.message)||"Request failed")}finally{h(!1)}}return a.jsxs("div",{style:{maxWidth:720},children:[a.jsx("div",{style:{fontWeight:900,fontSize:16,marginBottom:12},children:"OBE Request"}),a.jsx("div",{className:"obe-card",children:a.jsxs("div",{style:{display:"grid",gap:10},children:[a.jsxs("label",{style:{display:"grid",gap:6},children:[a.jsx("div",{className:"obe-small-muted",style:{fontWeight:800},children:"Subject Code"}),a.jsx("input",{className:"obe-input",value:n,onChange:O=>i(O.target.value),placeholder:"e.g., GEA1268"})]}),a.jsxs("label",{style:{display:"grid",gap:6},children:[a.jsx("div",{className:"obe-small-muted",style:{fontWeight:800},children:"Assessment"}),a.jsx("input",{className:"obe-input",value:s,onChange:O=>o(O.target.value),placeholder:"cia1 | cia2 | model | formative1 | formative2"})]}),a.jsxs("label",{style:{display:"grid",gap:6},children:[a.jsx("div",{className:"obe-small-muted",style:{fontWeight:800},children:"Teaching Assignment ID (optional)"}),a.jsx("input",{className:"obe-input",value:u,onChange:O=>d(O.target.value),placeholder:"e.g., 123"})]}),a.jsxs("label",{style:{display:"grid",gap:6},children:[a.jsx("div",{className:"obe-small-muted",style:{fontWeight:800},children:"Reason"}),a.jsx("textarea",{className:"obe-input",value:l,onChange:O=>c(O.target.value),rows:3,placeholder:"Edit Marks",style:{resize:"vertical"}})]}),a.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:a.jsx("button",{className:"obe-btn obe-btn-secondary",type:"button",onClick:P,children:"View Reason"})}),p?a.jsx("div",{className:"obe-danger-pill",children:p}):null,a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[a.jsx("button",{className:"obe-btn",type:"button",onClick:()=>e(-1),disabled:f,children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-primary",type:"button",onClick:U,disabled:f||!n||!s,children:f?"Requesting":"Request Edit"})]})]})}),g?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:80},onClick:()=>{b||y(!1)},children:a.jsxs("div",{style:{width:"min(760px, 96vw)",maxHeight:"min(86vh, 900px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:O=>O.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Reason"}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:String(s||"").toUpperCase()}),a.jsx("button",{type:"button",className:"obe-btn",style:{padding:"6px 10px",minHeight:34},onClick:()=>y(!1),disabled:b,children:"Close"})]}),b?a.jsx("div",{className:"obe-small-muted",style:{marginBottom:10},children:"Loading"}):null,w?a.jsx("div",{className:"obe-danger-pill",style:{marginBottom:10},children:w}):null,a.jsxs("div",{className:"obe-card",style:{padding:12,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:900,marginBottom:6},children:"Staff"}),a.jsxs("div",{style:{fontSize:13,color:"#374151",lineHeight:1.35},children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Name:"})," ",String(((G=j==null?void 0:j.profile)==null?void 0:G.name)||(j==null?void 0:j.username)||(j==null?void 0:j.email)||"")]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Staff ID:"})," ",String(((H=j==null?void 0:j.profile)==null?void 0:H.staff_id)||"")]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Department:"})," ",String(((de=(oe=j==null?void 0:j.profile)==null?void 0:oe.department)==null?void 0:de.short_name)||((V=(W=j==null?void 0:j.profile)==null?void 0:W.department)==null?void 0:V.name)||((ee=(ae=j==null?void 0:j.profile)==null?void 0:ae.department)==null?void 0:ee.code)||"")]})]})]}),a.jsxs("div",{className:"obe-card",style:{padding:12,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:900,marginBottom:6},children:"Course"}),a.jsxs("div",{style:{fontSize:13,color:"#374151",lineHeight:1.35},children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Course Code:"})," ",String(((C=A==null?void 0:A.teaching_assignment)==null?void 0:C.subject_code)||n||"")]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Course Name:"})," ",String(((Y=A==null?void 0:A.teaching_assignment)==null?void 0:Y.subject_name)||"")]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Class/Section:"})," ",String(((q=A==null?void 0:A.teaching_assignment)==null?void 0:q.section_name)||"")]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Teaching Assignment ID:"})," ",E!=null?String(E):""]})]})]}),a.jsxs("div",{className:"obe-card",style:{padding:12},children:[a.jsx("div",{style:{fontWeight:900,marginBottom:6},children:"Reason"}),a.jsx("div",{style:{whiteSpace:"pre-wrap",fontSize:13,color:"#111827",lineHeight:1.45},children:String(l||"").trim()?String(l):""})]})]})})}):null]})}function OOe(){const[e,t]=x.useState([]),[r,n]=x.useState([]),[i,s]=x.useState([]),[o,l]=x.useState(!1),[c,u]=x.useState(!1),[d,f]=x.useState(null),[h,p]=x.useState(new Set);x.useEffect(()=>{m()},[]);async function m(){l(!0);try{const v=await mr("/api/academics/section-advisors/?page_size=0"),w=await mr("/api/academics/sections/?page_size=0"),S=await mr("/api/academics/hod-staff/?page_size=0"),j=await mr("/api/accounts/me/");async function k(A){if(!(A.headers.get("content-type")||"").includes("application/json")){const M=await A.text();throw console.error("Expected JSON but got:",M),new Error("Server returned non-JSON response (see console)")}return A.json()}if(v.ok){const A=await k(v);s(A.results||A)}if(w.ok){const A=await k(w);t(A.results||A)}if(S.ok){const A=await k(S);n(A.results||A)}if(j.ok){const A=await k(j);u(!!(A.permissions&&(A.permissions.includes("academics.assign_advisor")||A.permissions.includes("academics.add_sectionadvisor"))))}}catch(v){console.error(v),alert("Failed to load HOD assignments. Check console for server response.")}finally{l(!1)}}async function g(v,w){l(!0);try{if(!c)return alert("You do not have permission to assign advisors");const j=await mr("/api/academics/section-advisors/",{method:"POST",body:JSON.stringify({section_id:v,advisor_id:w,is_active:!0})});if(j.ok)p(k=>{const A=new Set(k);return A.delete(v),A}),await m();else{const k=await j.text();alert("Error: "+k)}}finally{l(!1)}}function y(v){p(w=>{const S=new Set(w);return S.has(v)?S.delete(v):S.add(v),S})}function b(v){return i.find(w=>w.section_id===v&&w.is_active)}return a.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:a.jsx(W0,{className:"h-6 w-6 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Advisor Assign"}),a.jsx("p",{className:"text-gray-600",children:"Assign advisors to sections and edit existing assignments"})]})]})}),o&&a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-12",children:a.jsxs("div",{className:"flex items-center justify-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),a.jsx("span",{className:"ml-3 text-gray-600",children:"Loading assignments..."})]})}),!o&&e.length>0&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Filter by Department"}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx("button",{onClick:()=>f(null),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${d===null?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All Departments"}),Array.from(new Set(e.map(v=>v.department_id||0))).filter(v=>v>0).map(v=>{var k,A;const w=e.filter(R=>(R.department_id||0)===v);if(w.length===0)return null;const S=((k=w[0])==null?void 0:k.department_short_name)||((A=w[0])==null?void 0:A.department_code)||`Dept ${v}`,j=d===v;return a.jsx("button",{onClick:()=>f(j?null:v),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${j?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:S},v)})]})]}),a.jsx("div",{className:"space-y-6",children:Array.from(new Set(e.map(v=>v.department_id||0))).filter(v=>d===null||d===v).map(v=>{var k,A;const w=e.filter(R=>(R.department_id||0)===v);if(w.length===0)return null;const S=((k=w[0])==null?void 0:k.department_short_name)||((A=w[0])==null?void 0:A.department_code)||`Department ${v}`,j=r.filter(R=>(R.department||0)===v);return a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:[S," Department"]}),a.jsx("div",{className:"overflow-x-auto mb-6",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-blue-50 border-b-2 border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-700",children:"Section"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-700",children:"Select Advisor"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-700",children:"Action"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:w.map(R=>{const M=b(R.id),B=h.has(R.id),E=!M||B;return a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-4 py-3 text-gray-700",children:R.name}),a.jsx("td",{className:"px-4 py-3",children:E?a.jsxs("select",{id:`advisor-${R.id}`,className:"w-full p-2 border border-gray-300 rounded-lg bg-white text-gray-700 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",defaultValue:(M==null?void 0:M.advisor_id)||"",children:[a.jsx("option",{value:"",children:"-- Select Advisor --"}),j.map(P=>a.jsxs("option",{value:P.id,children:[P.staff_id," - ",P.user]},P.id))]}):a.jsx("div",{className:"text-gray-900 font-medium",children:(M==null?void 0:M.advisor)||"No advisor assigned"})}),a.jsx("td",{className:"px-4 py-3",children:M&&!B?a.jsx("button",{disabled:!c,className:`p-2 text-sm font-medium rounded-lg transition-colors ${c?"text-blue-600 hover:bg-blue-50 border border-blue-300":"text-gray-400 bg-gray-100 cursor-not-allowed"}`,onClick:()=>c&&y(R.id),title:"Edit Assignment",children:a.jsx(dh,{className:"h-4 w-4"})}):a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{disabled:!c,className:`p-2 text-sm font-medium rounded-lg transition-colors ${c?"text-blue-600 hover:bg-blue-50 border border-blue-300":"text-gray-400 bg-gray-100 cursor-not-allowed"}`,onClick:()=>{if(!c)return;const U=document.getElementById(`advisor-${R.id}`).value;if(!U)return alert("Select an advisor first");g(R.id,Number(U))},title:"Save Assignment",children:a.jsx(rd,{className:"h-4 w-4"})}),B&&a.jsx("button",{className:"p-2 text-sm font-medium rounded-lg transition-colors text-red-600 hover:bg-red-50 border border-red-300",onClick:()=>y(R.id),title:"Cancel",children:a.jsx(bu,{className:"h-4 w-4"})}),M&&a.jsx("button",{disabled:!c,className:`p-2 text-sm font-medium rounded-lg transition-colors flex items-center justify-center ${c?"bg-red-50 text-red-700 border border-red-300 hover:bg-red-100":"text-gray-400 bg-gray-100 cursor-not-allowed"}`,onClick:async()=>{if(c&&confirm("Delete advisor assignment for this section?"))try{const P=await mr(`/api/academics/section-advisors/${M.id}/`,{method:"DELETE"});if(!P.ok){const U=await P.text();return alert("Delete failed: "+U)}await m()}catch(P){console.error(P),alert("Delete failed")}},title:"Delete Assignment",children:a.jsx(Fm,{className:"h-4 w-4"})})]})})]},R.id)})})]})})]},v)})})]}),!o&&e.length===0&&a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-12",children:a.jsxs("div",{className:"text-center",children:[a.jsx(gs,{className:"mx-auto h-12 w-12 text-gray-300 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No sections available"}),a.jsx("p",{className:"text-gray-600",children:"There are no sections available for advisor assignment at this time."})]})})]})})}const JF=e=>{if(typeof e.user=="string")return e.user;if(e.user&&typeof e.user=="object"){const t=e.user.first_name||"",r=e.user.last_name||"";return`${t} ${r}`.trim()||e.user.username||e.staff_id}return e.staff_id},ZF=e=>{if(!e)return"";if(typeof e.user=="string")return e.user;if(e.user&&typeof e.user=="object"){const t=e.user.first_name||"",r=e.user.last_name||"";return`${t} ${r}`.trim()||e.user.username||e.staff_id}return e.staff_id||""};function MOe(){const[e,t]=x.useState([]),[r,n]=x.useState([]),[i,s]=x.useState([]),[o,l]=x.useState([]),[c,u]=x.useState(null),[d,f]=x.useState(null),[h,p]=x.useState([]),[m,g]=x.useState([]),[y,b]=x.useState([]),[v,w]=x.useState([]),[S,j]=x.useState(!0),[k,A]=x.useState(new Set),[R,M]=x.useState(new Set),B=(()=>{try{return JSON.parse(localStorage.getItem("permissions")||"[]")}catch{return[]}})(),E=B.includes("academics.view_elective_teaching"),P=B.includes("academics.assign_elective_teaching");x.useEffect(()=>{U()},[]);async function U(){try{j(!0);const O=await mr("/api/academics/my-students/?page_size=0"),X=E||P?"/api/academics/hod-staff/?page_size=0":"/api/academics/advisor-staff/?page_size=0";let F=await mr(c&&X.includes("hod-staff")?`${X}&department=${c}`:X);if(F.status===403&&X.includes("hod-staff")){console.warn("hod-staff returned 403  falling back to advisor-staff endpoint");const T=c?`/api/academics/advisor-staff/?page_size=0&department=${c}`:"/api/academics/advisor-staff/?page_size=0";try{const I=await mr(T);I.ok&&(F=I)}catch(I){console.error("fallback to advisor-staff failed",I)}}const Q=await mr("/api/curriculum/department/?page_size=0"),K=await mr("/api/curriculum/elective/?page_size=0"),ne=await mr("/api/academics/teaching-assignments/?page_size=0"),re=async T=>{if(!(T.headers.get("content-type")||"").includes("application/json"))throw new Error("non-json");return T.json()};if(O.ok){const T=await re(O),I=(T.results||T).map(ie=>({id:ie.section_id,name:ie.section_name,batch:ie.batch,batch_regulation:ie.batch_regulation,department_id:ie.department_id,semester:ie.semester,department:ie.department}));t(I)}if(F.ok){const T=await re(F);let I=T.results||T;c&&(I=I.filter(ie=>ie.department&&ie.department.id===c||ie.department===c)),n(I)}if(Q.ok){const T=await re(Q),I=T.results||T;p(I),w(I.filter(D=>D.is_elective));const ie=new Map;I.forEach(D=>{D.department&&D.department.id&&ie.set(D.department.id,D.department)}),ie.size>0&&l(Array.from(ie.values()));try{const D=await mr("/api/academics/departments/?page_size=0");if(D.ok){const Z=await re(D),me=Z.results||Z;Array.isArray(me)&&me.length>0&&s(me)}else ie.size>0&&s(Array.from(ie.values()))}catch{ie.size>0&&s(Array.from(ie.values()))}}if(K.ok){const T=await re(K);b(T.results||T)}if(ne.ok){const T=await re(ne);g(T.results||T)}}catch(O){console.error(O),alert("Failed to load teaching assignment data")}finally{j(!1)}}x.useEffect(()=>{async function O(){try{const X=E||P?"/api/academics/hod-staff/?page_size=0":"/api/academics/advisor-staff/?page_size=0",F=c&&X.includes("hod-staff")?`${X}&department=${c}`:X,Q=await mr(F);let K=Q;if(Q.status===403&&X.includes("hod-staff")){console.warn("hod-staff returned 403 in loadStaff  trying advisor-staff");const T=c?`/api/academics/advisor-staff/?page_size=0&department=${c}`:"/api/academics/advisor-staff/?page_size=0";try{const I=await mr(T);if(I.ok)K=I;else if(I.status!==200)return}catch(I){console.error("fallback failed",I);return}}if(!K.ok)return;const ne=await K.json();let re=ne.results||ne;!X.includes("hod-staff")&&c&&(re=re.filter(T=>T.department&&T.department.id===c||T.department===c)),n(re)}catch(X){console.error("loadStaff failed",X)}}O()},[c]);const G=(O,X)=>m.find(F=>{const Q=F.section_details&&F.section_details.id===O||F.section_details&&F.section_details.id===O||F.section===O||F.section_id===O,K=F.curriculum_row_details&&F.curriculum_row_details.id===X||F.curriculum_row_details&&F.curriculum_row_details.id===X||F.curriculum_row&&F.curriculum_row.id===X||F.curriculum_row_id===X;return Q&&K}),H=(O,X)=>`${O}-${X}`,oe=(O,X)=>{const F=H(O,X);A(Q=>new Set(Q).add(F))},de=(O,X)=>{const F=H(O,X);A(Q=>{const K=new Set(Q);return K.delete(F),K})},W=(O,X)=>{const F=H(O,X);return k.has(F)},V=O=>m.find(X=>{const F=X.elective_subject_id||X.elective_subject&&X.elective_subject.id||X.elective_subject_details&&X.elective_subject_details.id||X.elective_subject;return Number(F)===Number(O)}),ae=O=>`elective-${O}`,ee=O=>{const X=ae(O);M(F=>new Set(F).add(X))},C=O=>{const X=ae(O);M(F=>{const Q=new Set(F);return Q.delete(X),Q})},Y=O=>{const X=ae(O);return R.has(X)};async function q(O,X,F){if(!X)return alert("Select staff"),Promise.reject("No staff selected");try{if(F){const Q={staff_id:Number(X),is_active:!0},K=await mr(`/api/academics/teaching-assignments/${F}/`,{method:"PATCH",body:JSON.stringify(Q)});if(K.ok)return alert("Updated successfully"),U(),Promise.resolve();{const ne=await K.text();return alert("Error: "+ne),Promise.reject(ne)}}else{const Q={elective_subject_id:O,staff_id:Number(X),is_active:!0},K=await mr("/api/academics/teaching-assignments/",{method:"POST",body:JSON.stringify(Q)});if(K.ok)return alert("Assigned successfully"),U(),Promise.resolve();{const ne=await K.text();return alert("Error: "+ne),Promise.reject(ne)}}}catch(Q){return alert("Error: "+Q),Promise.reject(Q)}}return S?a.jsx("div",{style:{padding:"28px",minHeight:"100vh",background:"linear-gradient(180deg, #f7fbff 0%, #ffffff 60%)"},children:a.jsx("div",{style:{padding:"16px",borderRadius:"8px",background:"#fff",border:"1px solid rgba(15,23,42,0.04)",color:"#6b7280"},children:"Loading teaching assignments"})}):a.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:a.jsx(W0,{className:"h-6 w-6 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Teaching Assign"}),a.jsx("p",{className:"text-gray-600",children:"Assign faculty to courses and sections"})]})]})}),i.length>0&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Filters"}),a.jsx("div",{className:"flex flex-wrap gap-4",children:i.length>0&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Department:"}),a.jsxs("select",{value:c??"",onChange:O=>u(O.target.value?Number(O.target.value):null),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-700 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"All Departments"}),i.map(O=>a.jsx("option",{value:O.id,children:O.short_name||O.code||O.name||`Dept ${O.id}`},O.id))]})]})})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(gs,{className:"h-5 w-5 text-blue-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Course Assignments"})]}),e.length===0?a.jsx("div",{className:"text-center py-8",children:a.jsx("div",{className:"text-gray-500 text-sm",children:"No sections available for the selected filters."})}):a.jsx("div",{className:"space-y-6",children:e.map(O=>{const X=h.filter(F=>(O.semester?F.semester===O.semester:!0)&&(O.batch_regulation?F.regulation===O.batch_regulation.code:!0)&&!F.is_elective);return a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsx("div",{className:"bg-blue-50 rounded-lg p-4 mb-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h4",{className:"text-lg font-semibold text-blue-900",children:[O.batch," / ",O.name]}),a.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[a.jsxs("p",{className:"text-blue-700 text-sm",children:["Semester: ",O.semester||"Not specified"]}),O.batch_regulation&&a.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800 border border-indigo-200",children:["Regulation: ",O.batch_regulation.code]})]})]}),a.jsxs("div",{className:"text-blue-600 text-sm font-medium",children:["Section ID: ",O.id]})]})}),X.length===0?a.jsx("div",{className:"text-gray-500 text-sm py-4",children:"No subjects available for this section."}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-50 border-b border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Subject Code"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Subject Name"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Assigned Staff"}),a.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Action"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:X.map(F=>{var ne,re;const Q=G(O.id,F.id),K=W(O.id,F.id);return a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-4 py-3 font-medium text-gray-900",children:F.course_code||"-"}),a.jsx("td",{className:"px-4 py-3 text-gray-700",children:F.course_name||"Unnamed"}),a.jsx("td",{className:"px-4 py-3",children:K?a.jsxs("select",{id:`staff-${O.id}-${F.id}`,defaultValue:((ne=Q==null?void 0:Q.staff_details)==null?void 0:ne.id)||(Q==null?void 0:Q.staff)||"",className:"w-full p-2 border border-gray-300 rounded-lg bg-white text-gray-700 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"-- select staff --"}),r.map(T=>a.jsxs("option",{value:T.id,children:[T.staff_id," - ",JF(T)]},T.id))]}):Q?a.jsxs("div",{className:"text-sm text-gray-900 font-medium",children:[(re=Q.staff_details)==null?void 0:re.staff_id," - ",ZF(Q.staff_details)]}):a.jsx("div",{className:"text-sm text-gray-500 italic",children:"Not assigned"})}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsx("div",{className:"flex items-center justify-center gap-2",children:K?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>{const T=document.getElementById(`staff-${O.id}-${F.id}`);if(!(T!=null&&T.value))return alert("Select staff member");if(Q){const I={staff_id:Number(T.value),is_active:!0};mr(`/api/academics/teaching-assignments/${Q.id}/`,{method:"PATCH",body:JSON.stringify(I)}).then(ie=>{ie.ok?(alert("Updated successfully"),de(O.id,F.id),U()):ie.text().then(D=>alert("Error: "+D))})}else{const I={section_id:O.id,staff_id:Number(T.value),curriculum_row_id:F.id,is_active:!0};mr("/api/academics/teaching-assignments/",{method:"POST",body:JSON.stringify(I)}).then(ie=>{ie.ok?(alert("Assigned successfully"),de(O.id,F.id),U()):ie.text().then(D=>alert("Error: "+D))})}},className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors border border-green-300",title:"Save Assignment",children:a.jsx(rd,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>de(O.id,F.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border border-red-300",title:"Cancel",children:a.jsx(bu,{className:"h-4 w-4"})}),Q&&a.jsx("button",{onClick:async()=>{if(confirm("Delete teaching assignment for this subject/section?"))try{const T=await mr(`/api/academics/teaching-assignments/${Q.id}/`,{method:"DELETE"});if(T.ok)alert("Deleted"),de(O.id,F.id),U();else{const I=await T.text().catch(()=>null);alert("Failed: "+(I||T.status))}}catch(T){console.error(T),alert("Failed to delete")}},className:"p-2 text-red-700 hover:bg-red-50 rounded-lg transition-colors border border-red-300",title:"Delete Assignment",children:a.jsx(Fm,{className:"h-4 w-4"})})]}):a.jsx(a.Fragment,{children:a.jsx("button",{onClick:()=>oe(O.id,F.id),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors border border-blue-300",title:"Edit Assignment",children:a.jsx(dh,{className:"h-4 w-4"})})})})})]},`${O.id}-${F.id}`)})})]})})]},O.id)})})]}),E&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Elective Subject Assignments"}),o.length>1&&a.jsxs("div",{className:"mb-6",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Filter by Department"}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx("button",{onClick:()=>f(null),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${d===null?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All Departments"}),o.map(O=>a.jsx("button",{onClick:()=>f(O.id),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${d===O.id?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:O.short_name||O.code||O.name||`Dept ${O.id}`},O.id))]})]}),a.jsx("div",{className:"space-y-4",children:v.filter(O=>!d||O.department&&O.department.id===d).length===0?a.jsx("div",{className:"text-gray-500 text-sm",children:"No elective parents found for the selected department."}):v.filter(O=>!d||O.department&&O.department.id===d).map(O=>a.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[a.jsx("div",{className:"flex justify-between items-center mb-4",children:a.jsx("div",{className:"font-semibold text-gray-900",children:O.course_name||O.course_code||"Elective"})}),a.jsx("div",{className:"space-y-3",children:(y&&y.filter(X=>X.parent===O.id)).map(X=>{var K,ne;const F=V(X.id),Q=Y(X.id);return console.log(`Elective ${X.course_code} (ID: ${X.id}):`,{opt:X,existingElectiveAssignment:F,allAssignments:m.filter(re=>re.subject&&(re.subject.includes(X.course_code)||re.subject.includes(X.course_name)))}),a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white rounded-lg border border-gray-200",children:[a.jsxs("div",{className:"flex-1 text-sm font-medium text-gray-900",children:[X.course_code||"-","  ",X.course_name||"-"]}),a.jsx("div",{className:"min-w-[200px]",children:Q?a.jsxs("select",{id:`elective-staff-${X.id}`,defaultValue:((K=F==null?void 0:F.staff_details)==null?void 0:K.id)||(F==null?void 0:F.staff)||"",className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-700 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"-- select staff --"}),r.map(re=>a.jsxs("option",{value:re.id,children:[re.staff_id," - ",JF(re)]},re.id))]}):F?a.jsxs("div",{className:"text-sm text-gray-900 font-medium",children:[(ne=F.staff_details)==null?void 0:ne.staff_id," - ",ZF(F.staff_details)]}):a.jsx("div",{className:"text-sm text-gray-500 italic",children:"Not assigned"})}),a.jsx("div",{className:"flex items-center gap-2",children:Q?a.jsxs(a.Fragment,{children:[a.jsx("button",{disabled:!P,onClick:()=>{if(!P)return alert("No permission to assign electives");const re=document.getElementById(`elective-staff-${X.id}`);if(!(re!=null&&re.value))return alert("Select staff member");q(X.id,Number(re.value),F==null?void 0:F.id).then(()=>{C(X.id)}).catch(()=>{})},className:`p-2 rounded-lg transition-colors ${P?"text-green-600 hover:bg-green-50 border border-green-300":"text-gray-400 bg-gray-100 cursor-not-allowed border border-gray-300"}`,title:P?"Save Assignment":"No permission",children:a.jsx(rd,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>C(X.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border border-red-300",title:"Cancel",children:a.jsx(bu,{className:"h-4 w-4"})}),F&&a.jsx("button",{onClick:async()=>{if(confirm("Delete elective teaching assignment for this option?"))try{const re=await mr(`/api/academics/teaching-assignments/${F.id}/`,{method:"DELETE"});if(re.ok)alert("Deleted"),C(X.id),U();else{const T=await re.text().catch(()=>null);alert("Failed: "+(T||re.status))}}catch(re){console.error(re),alert("Failed to delete")}},className:"p-2 text-red-700 hover:bg-red-50 rounded-lg transition-colors border border-red-300",title:"Delete Assignment",children:a.jsx(Fm,{className:"h-4 w-4"})})]}):a.jsx(a.Fragment,{children:a.jsx("button",{onClick:()=>ee(X.id),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors border border-blue-300",title:"Edit Assignment",children:a.jsx(dh,{className:"h-4 w-4"})})})})]},X.id)})})]},O.id))})]})]})})}function LOe(){const[e,t]=x.useState(!1),[r,n]=x.useState(null),[i,s]=x.useState([]),[o,l]=x.useState({});async function c(){t(!0),n(null);try{const m=await S9(),g=Array.isArray(m==null?void 0:m.results)?m.results:[];s(g)}catch(m){n((m==null?void 0:m.message)||"Failed to load requests")}finally{t(!1)}}x.useEffect(()=>{c()},[]);const u=x.useMemo(()=>[...i].sort((m,g)=>String(g.requested_at||"").localeCompare(String(m.requested_at||""))),[i]);function d(m){const g=String(m||"").trim();if(!g)return"?";const y=g.split(/\s+/g).filter(Boolean);return y.length===1?y[0].slice(0,2).toUpperCase():(y[0][0]+y[y.length-1][0]).toUpperCase()}function f(m){if(!m)return"";const g=new Date(m);return Number.isNaN(g.getTime())?String(m):g.toLocaleString()}async function h(m){l(g=>({...g,[m]:!0})),n(null);try{await C9(m),await c()}catch(g){n((g==null?void 0:g.message)||"Forward failed")}finally{l(g=>({...g,[m]:!1}))}}async function p(m){l(g=>({...g,[m]:!0})),n(null);try{await E9(m),await c()}catch(g){n((g==null?void 0:g.message)||"Reject failed")}finally{l(g=>({...g,[m]:!1}))}}return a.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",padding:20},children:[a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center",marginBottom:20},children:[a.jsx(sc,{size:24,color:"#9a3412"}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:24,fontWeight:950,color:"#111827"},children:"HOD: OBE Edit Requests"}),a.jsx("div",{style:{color:"#6b7280",fontSize:14},children:"Approve requests from your department before they go to IQAC"})]}),a.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:a.jsxs("button",{className:"obe-btn obe-btn-secondary",onClick:c,disabled:e,children:[a.jsx(T2,{size:16,style:{marginRight:6}}),e?"Refreshing":"Refresh"]})})]}),r?a.jsxs("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:12,borderRadius:12,marginBottom:20},children:[a.jsx(b3,{size:16,style:{marginRight:8,verticalAlign:"middle"}}),r]}):null,a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontSize:16,fontWeight:950,color:"#111827"},children:"Pending with HOD"}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["(",u.length,")"]})]}),u.length===0?a.jsxs("div",{style:{textAlign:"center",padding:22,color:"#6b7280",border:"1px dashed #e5e7eb",borderRadius:14,background:"#fff"},children:[a.jsx(y3,{size:34,color:"#10b981",style:{marginBottom:8}}),a.jsx("div",{children:"No pending requests"})]}):a.jsx("div",{style:{display:"grid",gap:10},children:u.map(m=>{var v,w;const g=!!o[m.id],y=String(((v=m.staff)==null?void 0:v.name)||((w=m.staff)==null?void 0:w.username)||"Unknown"),b=m.scope==="MARK_MANAGER"?"Mark Manager":"Mark Entry";return a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:14,background:"#fff",padding:12,display:"flex",gap:12,alignItems:"center"},children:[a.jsx("div",{style:{width:44,height:44,borderRadius:999,background:"#fff7ed",border:"1px solid #fed7aa",display:"grid",placeItems:"center",fontWeight:950,color:"#9a3412",flex:"0 0 auto"},children:d(y)}),a.jsxs("div",{style:{flex:1,minWidth:240},children:[a.jsx("div",{style:{fontWeight:900,color:"#111827"},children:y}),a.jsxs("div",{style:{fontSize:13,color:"#374151",fontWeight:700},children:[m.subject_code,"  ",a.jsx("span",{style:{color:"#2563eb",fontWeight:800},children:m.subject_name||m.subject_code})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[b,"  ",String(m.assessment||"").toUpperCase(),"  ",f(m.requested_at)]}),m.reason?a.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#374151"},children:[a.jsx("span",{style:{fontWeight:800},children:"Reason:"})," ",String(m.reason)]}):null]}),a.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center",flex:"0 0 auto"},children:[a.jsxs("div",{style:{background:"#fef3c7",color:"#92400e",padding:"4px 8px",borderRadius:999,fontSize:12,fontWeight:800,whiteSpace:"nowrap"},children:[a.jsx(sc,{size:12,style:{marginRight:4,verticalAlign:"middle"}}),"Pending"]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[a.jsxs("button",{className:"obe-btn obe-btn-success",onClick:()=>h(m.id),disabled:g,children:[a.jsx(Lte,{size:16,style:{marginRight:6}}),g?"Forwarding":"Forward to IQAC"]}),a.jsx("button",{className:"obe-btn obe-btn-danger",onClick:()=>p(m.id),disabled:g,children:g?"Rejecting":"Reject"})]})]})]},m.id)})})]})]})}function ROe(){const[e,t]=x.useState([]),[r,n]=x.useState(!1),[i,s]=x.useState(null);x.useEffect(()=>{o()},[]),x.useEffect(()=>{e.length>0&&i===null&&s(e[0].section_id)},[e]);async function o(){n(!0);try{const u=await mr("/api/academics/my-students/");if(!u.ok)throw new Error(await u.text());const d=await u.json();t(d.results||[])}catch(u){console.error(u),alert("Failed to load your students. See console for details.")}finally{n(!1)}}const l=e.find(u=>u.section_id===i),c=[...(l==null?void 0:l.students)||[]].sort((u,d)=>u.reg_no.localeCompare(d.reg_no));return r?a.jsx("div",{className:"min-h-screen p-4 md:p-6 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Gu,{className:"w-8 h-8 text-indigo-600 animate-spin"}),a.jsx("span",{className:"text-slate-600 text-lg",children:"Loading student information..."})]})}):a.jsxs("div",{className:"min-h-screen p-4 md:p-6 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-6 border border-slate-200",children:a.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 p-3 rounded-xl shadow-lg",children:a.jsx(Lm,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"My Students"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"View and manage your assigned student profiles"})]})]}),a.jsx("div",{className:"px-4 py-2 bg-gradient-to-r from-slate-100 to-indigo-100 rounded-lg",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ys,{className:"w-5 h-5 text-indigo-700"}),a.jsxs("span",{className:"text-sm font-semibold text-indigo-900",children:["Total: ",e.reduce((u,d)=>u+d.students.length,0)]})]})})]})}),e.length===0&&!r&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-12",children:a.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[a.jsx("div",{className:"bg-slate-100 p-4 rounded-full mb-4",children:a.jsx(ys,{className:"w-16 h-16 text-slate-400"})}),a.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"No Students Assigned"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"You don't have any students assigned to your sections yet."})]})}),e.length>0&&a.jsx("div",{className:"mb-6 flex flex-wrap gap-3",children:e.map(u=>{const d=i===u.section_id;return a.jsxs("button",{onClick:()=>s(u.section_id),className:`px-5 py-2 rounded-full font-medium text-sm transition-all duration-200 flex items-center gap-2 ${d?"bg-gradient-to-r from-indigo-600 to-cyan-500 text-white shadow-lg shadow-indigo-200":"bg-white text-slate-700 border border-slate-200 hover:border-indigo-300 hover:bg-slate-50"}`,children:[u.section_name,a.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-bold ${d?"bg-white/25 text-white":"bg-slate-100 text-slate-700"}`,children:u.students.length})]},u.section_id)})}),c.length>0&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-slate-50 to-indigo-50 border-b-2 border-slate-200",children:[a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-indigo-900",children:"S.No"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-indigo-900",children:"Registration No"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-indigo-900",children:"Student Name"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-indigo-900",children:"Email"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-200",children:c.map((u,d)=>a.jsxs("tr",{className:"hover:bg-blue-50 transition-colors",children:[a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"text-sm font-medium text-slate-600",children:d+1})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:u.reg_no})}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qee,{className:"w-5 h-5 text-slate-400"}),a.jsx("span",{className:"text-sm font-medium text-slate-900",children:u.first_name&&u.last_name?`${u.first_name} ${u.last_name}`.trim():u.username})]})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("div",{className:"flex items-center gap-2 text-slate-600",children:u.email?a.jsxs(a.Fragment,{children:[a.jsx(v3,{className:"w-4 h-4 text-slate-400"}),a.jsx("span",{className:"text-sm",children:u.email})]}):a.jsx("span",{className:"text-sm text-slate-400",children:"-"})})})]},u.id))})]})})})]})}const FOe=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];function eB(e){if(!e)return"";if(typeof e=="string"){const i=e.trim();return i.split(/[\s\-\_]+/)[0]||i.slice(0,15)+(i.length>15?"":"")}if(e.course_code)return e.course_code;const t=e.course_name||e.course||e.subject_text||"",r=String(t).trim();if(!r)return"";const n=r.split(/[\s\-\_]+/).filter(i=>i.length>0);return n.length>0?n[0]:r.slice(0,15)+(r.length>15?"":"")}function BOe(){const[e,t]=x.useState(null),[r,n]=x.useState([]),[i,s]=x.useState([]),[o,l]=x.useState(!1),[c,u]=x.useState(null);x.useEffect(()=>{d()},[]);async function d(){try{const f=await mr("/api/accounts/me/");if(!f.ok)throw new Error(await f.text());const h=await f.json(),p=h.profile||{};u(h.id),p.section_id&&t(p.section_id)}catch(f){console.error(f)}}return x.useEffect(()=>{e&&(l(!0),(async()=>{try{const f=await mr(`/api/timetable/section/${e}/timetable/`);if(!f.ok)throw new Error(await f.text());let p=(await f.json()).results||[];n(p);const m=[];for(const g of p||[])for(const y of g.assignments||[])m.find(b=>b.id===y.period_id)||m.push({id:y.period_id,index:y.period_index,is_break:y.is_break,label:y.label});m.sort((g,y)=>(g.index||0)-(y.index||0)),s(m)}catch(f){console.error(f)}finally{l(!1)}})())},[e]),a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6 border border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl",children:a.jsx(xs,{className:"h-6 w-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Timetable"}),a.jsx("p",{className:"text-gray-600",children:"View your class schedule for the week"})]})]})}),o&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-8 border border-gray-100",children:a.jsx("div",{className:"text-center",children:a.jsxs("div",{className:"inline-flex items-center gap-2 text-gray-600",children:[a.jsx(Gu,{className:"animate-spin h-5 w-5 text-indigo-600"}),a.jsx("span",{children:"Loading timetable..."})]})})}),!o&&!e&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-8 border border-gray-100",children:a.jsxs("div",{className:"text-center",children:[a.jsx(ed,{className:"h-12 w-12 text-amber-500 mx-auto mb-3"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Section Not Assigned"}),a.jsx("p",{className:"text-gray-600",children:"You are not assigned to a section or your profile is incomplete."})]})}),!o&&e&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sc,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Weekly Schedule"})]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-slate-50 to-blue-50 border-b-2 border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700 min-w-[100px] sticky left-0 bg-gradient-to-r from-slate-50 to-blue-50 z-10",children:"Day / Period"}),i.map(f=>a.jsx("th",{className:"px-4 py-3 text-left min-w-[140px]",children:a.jsx("div",{className:"text-sm font-bold text-indigo-700",children:f.is_break||f.is_lunch?f.label||(f.is_break?"Break":"Lunch"):f.label||`${f.start_time||""}${f.start_time&&f.end_time?" - ":""}${f.end_time||""}`})},`period-${f.id}`))]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:FOe.map((f,h)=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-4 py-3 font-bold text-gray-900 bg-gray-50 sticky left-0 z-10",children:f}),i.map(p=>{const g=((r.find(b=>b.day===h+1)||{assignments:[]}).assignments||[]).filter(b=>b.period_id===p.id),y=g.some(b=>b.is_special);return a.jsx("td",{className:`px-4 py-3 align-top ${y&&g.some(b=>!b.is_special)?"bg-red-50":""}`,children:p.is_break?a.jsx("div",{className:"flex items-center justify-center py-2",children:a.jsx("span",{className:"text-sm text-gray-500 italic",children:p.label||"Break"})}):g&&g.length?a.jsx("div",{className:"space-y-2",children:g.map((b,v)=>{var S,j;const w=y&&!b.is_special;return a.jsxs("div",{className:`rounded-lg p-2.5 ${b.is_special?"bg-amber-50 border border-amber-200":w?"bg-red-50 border border-red-200":"bg-blue-50 border border-blue-200"}`,children:[a.jsxs("div",{className:"font-semibold text-gray-900 text-xs leading-tight flex items-center gap-1",children:[a.jsx(gs,{className:"h-3 w-3"}),b.is_special?b.timetable_name||"Special":eB(b.curriculum_row||b.subject_text),b.is_special&&a.jsxs("span",{className:"text-amber-600 ml-1",children:[" ",eB(b.curriculum_row||b.subject_text)]})]}),a.jsxs("div",{className:"text-xs text-gray-700 mt-1 flex items-center gap-1",children:[a.jsx(ys,{className:"h-3 w-3"}),"Staff: ",((S=b.staff)==null?void 0:S.username)||""]}),w&&a.jsx("div",{className:"text-xs text-red-600 mt-1 font-medium",children:"Overridden by special"}),b.is_special&&a.jsxs("div",{className:"text-xs text-amber-700 mt-1 flex items-center gap-1",children:[a.jsx(xs,{className:"h-3 w-3"}),b.date||"","  ",p.label||""]}),b.subject_batch&&a.jsxs("div",{className:"text-xs text-blue-700 mt-1 font-medium",children:["Batch: ",b.subject_batch.name]}),w&&b.elective_subject&&a.jsxs("div",{className:"text-xs text-red-600 mt-1",children:["Elective: ",b.elective_subject.course_code||b.elective_subject.course_name]})]},`${b.id||((j=b.curriculum_row)==null?void 0:j.id)||v}`)})}):a.jsx("div",{className:"flex items-center justify-center py-4",children:a.jsx("span",{className:"text-gray-300 text-sm",children:""})})},`cell-${h}-${p.id}`)})]},`day-${h}`))})]})})]})]})})}const IOe=["Mon","Tue","Wed","Thu","Fri","Sat"];function tB(e){if(!e)return"";if(typeof e=="string"){const i=e.trim();return i.split(/[\s\-\_]+/)[0]||i.slice(0,15)+(i.length>15?"":"")}const t=(e==null?void 0:e.course_name)||(e==null?void 0:e.course)||(e==null?void 0:e.subject_text)||(e==null?void 0:e.course_code)||"",r=String(t).trim();if(!r)return"";const n=r.split(/[\s\-\_]+/).filter(i=>i.length>0);return n.length>0?n[0]:r.slice(0,15)+(r.length>15?"":"")}function DOe(e){var i,s;if(Array.isArray(e)){const o=[],l=new Set;for(const c of e){const u=c.section,d=c.subject_batch||(u==null?void 0:u.batch);let f="";d!=null&&d.name&&(f+=d.name),u!=null&&u.name&&(f+=(f?" / ":"")+u.name),f||(u!=null&&u.id?f="Sec "+u.id:(i=c.subject_batch)!=null&&i.name&&(f=c.subject_batch.name)),f&&!l.has(f)&&(o.push(f),l.add(f))}return o.length?o.join(" + "):""}const t=e.section,r=e.subject_batch||(t==null?void 0:t.batch);let n="";return r!=null&&r.name&&(n+=r.name),t!=null&&t.name&&(n+=(n?" / ":"")+t.name),n||(t!=null&&t.id?n="Sec "+t.id:(s=e.subject_batch)!=null&&s.name&&(n=e.subject_batch.name)),n||""}function $Oe(){const[e,t]=x.useState([]),[r,n]=x.useState([]),[i,s]=x.useState(!1);x.useEffect(()=>{o()},[]);async function o(){s(!0);try{const l=new Date().toISOString().slice(0,10),c=await mr(`/api/timetable/staff/?date=${l}`);if(!c.ok)throw new Error(await c.text());const u=await c.json();t(u.results||[]);const d=await mr("/api/timetable/templates/");if(d.ok){const f=await d.json(),h=f.find(p=>p.is_active)||f[0];if(h&&h.periods)n(h.periods);else{const p=[];for(const m of u.results||[])for(const g of m.assignments||[])p.find(y=>y.id===g.period_id)||p.push({id:g.period_id,index:g.period_index,is_break:g.is_break,is_lunch:g.is_lunch,label:g.label,start_time:g.start_time,end_time:g.end_time});p.sort((m,g)=>(m.index||0)-(g.index||0)),n(p)}}}catch(l){console.error(l)}finally{s(!1)}}return a.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:a.jsx(xs,{className:"h-6 w-6 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Timetable"}),a.jsx("p",{className:"text-gray-600",children:"View your assigned teaching schedule"})]})]})}),i?a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-8",children:a.jsx("div",{className:"text-center",children:a.jsxs("div",{className:"inline-flex items-center gap-2 text-gray-600",children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-blue-600 border-t-transparent"}),a.jsx("span",{children:"Loading timetable..."})]})})}):a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(sc,{className:"h-5 w-5 text-blue-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Weekly Schedule"})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-blue-50 border-b-2 border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-700",children:"Day / Period"}),r.map(l=>a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-700 min-w-[120px]",children:l.label||`${l.start_time||""}${l.start_time&&l.end_time?" - ":""}${l.end_time||""}`},l.id))]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:IOe.map((l,c)=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-4 py-3 font-semibold text-gray-900 bg-gray-50",children:l}),r.map(u=>{const f=((e.find(p=>p.day===c+1)||{assignments:[]}).assignments||[]).filter(p=>p.period_id===u.id),h=f.some(p=>p.is_special);return a.jsx("td",{className:`px-4 py-3 ${h&&f.some(p=>!p.is_special)?"bg-red-50":""}`,children:u.is_break||u.is_lunch?a.jsx("div",{className:"flex items-center justify-center",children:a.jsx("span",{className:"text-sm text-gray-500 italic",children:u.label||(u.is_break?"Break":"Lunch")})}):f&&f.length?a.jsx("div",{className:"space-y-2",children:(()=>{var m;const p={};for(const g of f){let y="";g.is_special?y=`special_${g.timetable_name||g.id}`:g.curriculum_row&&g.curriculum_row.id?y=`curr_${g.curriculum_row.id}`:g.subject_batch&&g.subject_batch.id?y=`batch_${g.subject_batch.id}`:g.elective_subject&&g.elective_subject.id?y=`elective_${g.elective_subject.id}`:g.subject_text?y=`subj_${(g.subject_text||"").replace(/[^A-Za-z0-9]/g,"").toLowerCase()}`:y=`section_${((m=g.section)==null?void 0:m.id)||Math.random()}`,p[y]=p[y]||[],p[y].push(g)}return Object.keys(p).map((g,y)=>{const b=p[g],v=b[0],w=h&&!v.is_special,S=v.is_special?"bg-amber-50 border border-amber-200":w?"bg-red-50 border border-red-200":"bg-blue-50 border border-blue-200";return a.jsxs("div",{className:`rounded-lg p-2.5 ${S}`,children:[a.jsxs("div",{className:"font-semibold text-gray-900 text-xs leading-tight",children:[v.is_special?v.timetable_name||"Special":tB(v.elective_subject||v.curriculum_row||v.subject_text),v.is_special&&a.jsxs("span",{className:"text-amber-600 ml-1",children:[" ",tB(v.elective_subject||v.curriculum_row||v.subject_text)]})]}),a.jsx("div",{className:"text-xs text-blue-700 font-medium mt-1",children:DOe(b)}),w&&a.jsx("div",{className:"text-xs text-red-600 mt-1 font-medium",children:"Overridden"}),v.is_special&&a.jsx("div",{className:"text-xs text-amber-700 mt-1",children:v.date||""})]},y)})})()}):a.jsx("div",{className:"flex items-center justify-center py-4",children:a.jsx("span",{className:"text-gray-300 text-sm",children:""})})},u.id)})]},l))})]})})]})]})})}async function UOe(e){const t=e?`/api/academics/staff/${e}/assigned-subjects/`:"/api/academics/staff/assigned-subjects/",r=await mr(t);if(!r.ok)throw new Error("Failed to fetch assigned subjects");const n=await r.json();return n.results||n}async function _v(){const e=await mr("/api/academics/subject-batches/?page_size=0");if(!e.ok)throw new Error("Failed to fetch subject batches");const t=await e.json();return t.results||t}async function zOe(e){var i;const t=await mr("/api/academics/subject-batches/",{method:"POST",body:JSON.stringify(e)}),r=t.headers.get("content-type")||"",n=await t.text();if(!t.ok){const s=r.includes("application/json")&&((i=JSON.parse(n))==null?void 0:i.detail)||n;throw new Error(s)}return r.includes("application/json")?JSON.parse(n):n}function WOe(){const[e,t]=x.useState([]),[r,n]=x.useState([]),[i,s]=x.useState({}),[o,l]=x.useState(!0),[c,u]=x.useState(null),[d,f]=x.useState(null),[h,p]=x.useState(""),[m,g]=x.useState([]),[y,b]=x.useState([]),[v,w]=x.useState(null),[S,j]=x.useState([]),[k,A]=x.useState(!1),[R,M]=x.useState([]),[B,E]=x.useState(null),[P,U]=x.useState([]);x.useEffect(()=>{G()},[]);async function G(){l(!0),u(null);try{const O=await UOe(),X=await _v();t(O),n(X)}catch(O){console.error(O),u((O==null?void 0:O.message)||"Failed to load assigned subjects")}finally{l(!1)}}async function H(O){var F;console.log("openPickerForAssignment clicked",O),u(null);const X=i[O.id]||`Batch for ${O.subject_code||O.subject_name||O.id}`;E(O),s(Q=>({...Q,[O.id]:X}));try{const Q=await mr(`/api/academics/sections/${O.section_id}/students/`);if(!Q.ok){const T=await Q.text();throw new Error(T||"Failed to load students")}const K=await Q.json();let ne=K.results||K;const re=O.curriculum_row_id||((F=O.curriculum_row)==null?void 0:F.id);if(re){const T=new Set;for(const I of r)if(I.curriculum_row&&I.curriculum_row.id===re)for(const ie of I.students||[])T.add(ie.id);ne=ne.filter(I=>!T.has(I.id))}M(ne),U(ne.map(T=>T.id)),A(!0)}catch(Q){console.error("openPickerForAssignment error",Q),u((Q==null?void 0:Q.message)||String(Q)),alert("Failed to load students: "+((Q==null?void 0:Q.message)||Q))}}async function oe(O){u(null),E(O),M([]),U([]);try{let X;if(O.section_id){const K=await mr(`/api/academics/sections/${O.section_id}/students/`);if(!K.ok)throw new Error(await K.text());X=await K.json()}else if(O.elective_subject_id){const K=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${O.elective_subject_id}`);if(!K.ok)throw new Error(await K.text());X=await K.json()}else throw new Error("No student mapping available for this assignment");const Q=(X.results||X||[]).map(K=>({id:Number(K.id),reg_no:String(K.reg_no??K.regno??""),name:String(K.username??K.name??K.full_name??""),section:K.section_name??K.section??null,section_id:K.section_id??null}));M(Q),U(Q.map(K=>K.id)),A(!0)}catch(X){console.error("openListStudents error",X),u((X==null?void 0:X.message)||String(X)),alert("Failed to load students: "+((X==null?void 0:X.message)||X))}}function de(O){U(X=>X.includes(O)?X.filter(F=>F!==O):[...X,O])}async function W(){if(!B)return;const O=r.map(K=>{const ne=String(K.name||"").match(/Batch\s*(\d+)/i);return ne?parseInt(ne[1],10):null}).filter(Boolean),Q={name:`Batch ${(O.length?Math.max(...O):0)+1}`,student_ids:P};B.curriculum_row_id&&(Q.curriculum_row_id=B.curriculum_row_id);try{await zOe(Q);const K=await _v();n(K),A(!1),M([]),E(null),alert("Batch created for subject")}catch(K){console.error(K),alert("Failed to create batch: "+((K==null?void 0:K.message)||K))}}async function V(O){if(f(O.id),p(O.name||""),w(O),b((O.students||[]).map(X=>X.id)),O.curriculum_row&&O.curriculum_row.id)try{const X=e.find(F=>F.curriculum_row_id===O.curriculum_row.id);if(X&&X.section_id){const F=await mr(`/api/academics/sections/${X.section_id}/students/`);if(F.ok){const Q=await F.json(),K=Q.results||Q;g(K)}}}catch(X){console.error("Failed to load students for batch editing:",X),g(O.students||[])}else g(O.students||[])}async function ae(){if(d)try{const O={name:h,student_ids:y},X=await mr(`/api/academics/subject-batches/${d}/`,{method:"PATCH",body:JSON.stringify(O)});if(!X.ok)throw new Error(await X.text());const F=await _v();n(F),ee(),alert("Batch updated successfully")}catch(O){console.error("saveBatchEdit failed",O),alert("Failed to update batch: "+((O==null?void 0:O.message)||O))}}function ee(){f(null),p(""),w(null),g([]),b([])}function C(O){b(X=>X.includes(O)?X.filter(F=>F!==O):[...X,O])}async function Y(O){if(confirm("Delete this batch?"))try{const X=await mr(`/api/academics/subject-batches/${O}/`,{method:"DELETE"});if(!X.ok)throw new Error(await X.text());const F=await _v();n(F),alert("Batch deleted")}catch(X){console.error("deleteBatch failed",X),alert("Failed to delete: "+((X==null?void 0:X.message)||X))}}const q={};return r.forEach(O=>{const X=O.curriculum_row&&O.curriculum_row.id?String(O.curriculum_row.id):"___no_cr";q[X]||(q[X]=[]),q[X].push(O)}),a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-blue-50 via-white to-gray-50 p-6",children:[a.jsx("div",{className:"bg-gradient-to-r from-white to-blue-50 rounded-xl shadow-lg p-6 mb-6",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-100 to-indigo-200 rounded-xl flex items-center justify-center",children:a.jsx(gs,{className:"w-6 h-6 text-blue-700"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Assigned Subjects"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View all subjects assigned to you for the current academic session"})]})]}),!o&&!c&&e.length>0&&a.jsxs("div",{className:"flex items-center gap-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-4 py-2 rounded-full",children:[a.jsx("span",{className:"text-sm font-medium",children:"Total Subjects"}),a.jsx("span",{className:"bg-white/20 text-white px-3 py-1 rounded-full text-sm font-semibold",children:e.length})]})]})}),o&&a.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[a.jsx("div",{className:"w-8 h-8 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin mb-4"}),a.jsx("p",{className:"text-gray-600 font-medium",children:"Loading your assigned subjects..."})]}),c&&!o&&a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(ed,{className:"w-8 h-8 text-red-600"})}),a.jsx("p",{className:"text-red-600 font-medium mb-4",children:c}),a.jsx("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium transition-colors",onClick:G,children:"Try Again"})]}),!o&&!c&&e.length===0&&a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-12 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(lte,{className:"w-8 h-8 text-gray-400"})}),a.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Subjects Assigned"}),a.jsx("p",{className:"text-gray-600",children:"You don't have any subjects assigned for the current session."})]}),!o&&!c&&e.length>0&&a.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-blue-50 border-b-2 border-gray-200",children:[a.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-blue-700",children:"S.No"}),a.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-blue-700",children:"Subject"}),a.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-blue-700",children:"Section"}),a.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-blue-700",children:"Batch"}),a.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-blue-700",children:"Semester"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:e.map((O,X)=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:"text-sm font-medium text-gray-900",children:X+1})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold text-gray-900",children:O.subject_name||"Unnamed Subject"}),O.subject_code&&a.jsx("div",{className:"text-sm text-blue-600 font-medium",children:O.subject_code})]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:O.section_id?a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1.5 rounded-lg text-xs font-medium transition-colors",onClick:()=>H(O),children:"Create Batch"}),a.jsx("button",{type:"button",className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors",onClick:()=>oe(O),children:"List Students"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors",onClick:()=>oe(O),children:"List Students"}),a.jsx("span",{className:"text-xs text-gray-500 px-2 py-1",children:"Department-wide elective"})]})})]})}),a.jsx("td",{className:"px-6 py-4",children:O.section_name?a.jsxs("div",{className:"flex items-center gap-2 bg-blue-50 text-blue-700 px-3 py-1 rounded-full w-fit",children:[a.jsx(ys,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-medium",children:O.section_name})]}):a.jsx("span",{className:"text-gray-400",children:""})}),a.jsx("td",{className:"px-6 py-4",children:O.batch?a.jsxs("div",{className:"flex items-center gap-2 bg-green-50 text-green-700 px-3 py-1 rounded-full w-fit",children:[a.jsx(xs,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-medium",children:O.batch})]}):a.jsx("span",{className:"text-gray-400",children:""})}),a.jsx("td",{className:"px-6 py-4",children:O.semester!=null?a.jsxs("span",{className:"bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-semibold",children:["Sem ",O.semester]}):a.jsx("span",{className:"text-gray-400",children:""})})]},O.id))})]})})}),a.jsx("div",{className:"mt-6",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[a.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[a.jsx(ys,{className:"w-5 h-5 text-blue-600"}),"Student Subject Batches"]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Existing Batches"}),r.length===0&&a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx(ys,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),a.jsx("p",{children:"No batches created yet"})]}),e.map(O=>{const X=O.curriculum_row_id?String(O.curriculum_row_id):null,F=X?q[X]||[]:[];return!F||F.length===0?null:a.jsxs("div",{className:"mb-6 border-b border-gray-100 pb-4 last:border-b-0",children:[a.jsx("div",{className:"font-bold text-gray-900 mb-3",children:O.subject_name||O.subject_code||"Unnamed Subject"}),a.jsx("div",{className:"space-y-3",children:F.map(Q=>a.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:Q.name}),a.jsx("div",{className:"text-sm text-gray-600",children:a.jsxs("span",{className:"font-medium",children:[(Q.students||[]).length," students"]})})]}),a.jsxs("div",{className:"ml-4 flex gap-2",children:[a.jsx("button",{className:"bg-blue-100 hover:bg-blue-200 text-blue-700 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",onClick:()=>V(Q),children:"Edit"}),a.jsx("button",{className:"bg-red-100 hover:bg-red-200 text-red-700 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",onClick:()=>Y(Q.id),children:"Delete"})]})]})},Q.id))})]},`subject-${O.id}`)}),(()=>{const O=r.filter(X=>{const F=X.curriculum_row&&X.curriculum_row.id?X.curriculum_row.id:null;return!F||!e.some(Q=>Q.curriculum_row_id===F)});return O.length===0?null:a.jsxs("div",{className:"mt-6",children:[a.jsx("div",{className:"font-bold text-gray-900 mb-3",children:"Other Batches"}),a.jsx("div",{className:"space-y-3",children:O.map(X=>a.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:X.name}),a.jsx("div",{className:"text-sm text-gray-600",children:a.jsxs("span",{className:"font-medium",children:[(X.students||[]).length," students"]})})]}),a.jsxs("div",{className:"ml-4 flex gap-2",children:[a.jsx("button",{className:"bg-blue-100 hover:bg-blue-200 text-blue-700 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",onClick:()=>V(X),children:"Edit"}),a.jsx("button",{className:"bg-red-100 hover:bg-red-200 text-red-700 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",onClick:()=>Y(X.id),children:"Delete"})]})]})},`other-${X.id}`))})]})})()]})]})}),k&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[80vh] overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:i[(B==null?void 0:B.id)||""]||"Create Batch"}),a.jsx("div",{className:"text-sm text-gray-600",children:(B==null?void 0:B.subject_name)||(B==null?void 0:B.subject_code)})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",className:"bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded-lg font-medium transition-colors",onClick:()=>{A(!1),M([]),E(null)},children:"Cancel"}),a.jsx("button",{type:"button",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",onClick:W,children:"Create Batch"})]})]})}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-4",children:[a.jsxs("h4",{className:"font-semibold text-gray-900 mb-2",children:["Students (",R.length,")"]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Select students to include in this batch"})]}),a.jsx("div",{className:"max-h-96 overflow-y-auto",children:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:R.map(O=>a.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",children:[a.jsx("input",{type:"checkbox",checked:P.includes(O.id),onChange:()=>de(O.id),className:"w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:O.username||O.full_name||O.reg_no}),O.reg_no&&a.jsx("div",{className:"text-xs text-gray-500",children:O.reg_no})]})]},O.id))})})]})]})}),d&&v&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[80vh] overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:"Edit Batch"}),a.jsx("div",{className:"text-sm text-gray-600",children:"Modify batch name and student assignments"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",className:"bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded-lg font-medium transition-colors",onClick:ee,children:"Cancel"}),a.jsx("button",{type:"button",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",onClick:ae,children:"Save Changes"})]})]})}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:"Batch Name"}),a.jsx("input",{type:"text",value:h,onChange:O=>p(O.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter batch name"})]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-semibold text-gray-900 mb-2 flex items-center justify-between",children:[a.jsxs("span",{children:["Students (",y.length," selected)"]}),a.jsx("div",{className:"text-sm text-gray-600",children:"Click to add/remove students"})]}),a.jsx("div",{className:"max-h-80 overflow-y-auto border border-gray-200 rounded-lg p-4",children:m.length===0?a.jsxs("div",{className:"text-center text-gray-500 py-4",children:[a.jsx(ys,{className:"w-8 h-8 mx-auto mb-2 text-gray-300"}),a.jsx("p",{children:"No students available for this batch"})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:m.map(O=>a.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-lg cursor-pointer transition-colors ${y.includes(O.id)?"border-blue-300 bg-blue-50":"border-gray-200 hover:bg-gray-50"}`,children:[a.jsx("input",{type:"checkbox",checked:y.includes(O.id),onChange:()=>C(O.id),className:"w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:O.username||O.full_name||O.reg_no}),O.reg_no&&a.jsx("div",{className:"text-xs text-gray-500",children:O.reg_no})]})]},O.id))})})]})]})]})})]})}function qOe(){const[e,t]=x.useState(new Date().toISOString().slice(0,10)),[r,n]=x.useState([]),[i,s]=x.useState(!1),[o,l]=x.useState(null),[c,u]=x.useState([]),[d,f]=x.useState({}),[h,p]=x.useState(!1),[m,g]=x.useState(!1),[y,b]=x.useState(!1),[v,w]=x.useState(new Date().toISOString().slice(0,7)),[S,j]=x.useState([]),[k,A]=x.useState({}),[R,M]=x.useState([]),[B,E]=x.useState(!1),[P,U]=x.useState({}),[G,H]=x.useState({}),[oe,de]=x.useState({}),[W,V]=x.useState(!1),[ae,ee]=x.useState(null),[C,Y]=x.useState(null);x.useEffect(()=>{O()},[e]);function q(Z){const me={};for(const Te of Z){let je="";if(Te.period&&Te.period.index!==void 0){const Le=Te.period.index;Te.subject_batch_id?je=`batch_${Le}_${Te.subject_batch_id}`:Te.elective_subject_id?je=`elective_${Le}_${Te.teaching_assignment_id||Te.elective_subject_id}`:Te.subject?je=`subj_${Le}_${String(Te.subject||"").replace(/[^A-Za-z0-9]/g,"").toLowerCase()}`:je=`section_${Le}_${Te.section_id}`}else Te.subject_batch_id?je=`batch_${Te.subject_batch_id}`:Te.elective_subject_id?je=`elective_${Te.teaching_assignment_id||Te.elective_subject_id}`:Te.subject?je=`subj_${String(Te.subject).replace(/[^A-Za-z0-9]/g,"").toLowerCase()}`:je=`section_${Te.section_id}`;if(!me[je])me[je]={...Te,section_ids:[Te.section_id],section_names:[Te.section_name],attendance_session_ids:[Te.attendance_session_id]};else{const Le=me[je];Le.section_ids.includes(Te.section_id)||Le.section_ids.push(Te.section_id),Te.section_name&&!Le.section_names.includes(Te.section_name)&&Le.section_names.push(Te.section_name),Le.attendance_session_ids=Array.from(new Set([...Le.attendance_session_ids||[],Te.attendance_session_id]))}}return Object.keys(me).map(Te=>({...me[Te],id:Te}))}async function O(){s(!0);try{const Z=await mr(`/api/academics/staff/periods/?date=${e}`);if(!Z.ok)throw new Error("Failed to load periods");const me=await Z.json();n(me.results||[])}catch(Z){console.error("fetchPeriods",Z),n([])}finally{s(!1)}}function X(Z){var Pt;const me=Z.section_ids&&Array.isArray(Z.section_ids)&&Z.section_ids.length?Z.section_ids:[Z.section_id],Te=r.filter(dt=>!dt||dt.attendance_session_locked||!me.includes(dt.section_id)||Z.id&&dt.id===Z.id?!1:!!(Z.subject_batch_id&&dt.subject_batch_id===Z.subject_batch_id||Z.teaching_assignment_id&&dt.teaching_assignment_id===Z.teaching_assignment_id||Z.elective_subject_id&&dt.elective_subject_id===Z.elective_subject_id||Z.subject&&dt.subject===Z.subject));if(Te.length===0)return null;const je=[...Te].sort((dt,Ye)=>dt.period.index-Ye.period.index),Le=((Pt=Z.period)==null?void 0:Pt.index)||Z.period&&Z.period.index||0,_e=je.find(dt=>dt.period.index>Le),He=[...je].reverse().find(dt=>dt.period.index<Le),We=4;return _e&&_e.period.index-Le<=We?_e:He&&Le-He.period.index<=We?He:null}function F(Z){const me=X(Z);me?(ee(Z),Y(me),V(!0)):Q(Z)}async function Q(Z){l(Z),u([]),f({}),s(!0);try{let me=[];if(Z.section_ids&&Array.isArray(Z.section_ids)&&Z.section_ids.length>1)if(Z.elective_subject_id){const _e=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${Z.elective_subject_id}`);_e.ok&&(me=(await _e.json()).results||[])}else{const _e=[];for(const We of Z.section_ids)_e.push(mr(`/api/academics/sections/${We}/students/`).then(Pt=>Pt.ok?Pt.json():{results:[]}).catch(()=>({results:[]})));const He=await Promise.allSettled(_e);for(const We of He)if(We.status==="fulfilled"){const Pt=We.value||{},dt=Pt.results||Pt.students||[];me=me.concat(dt)}}else if(Z.elective_subject_id){const _e=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${Z.elective_subject_id}`);_e.ok&&(me=(await _e.json()).results||[])}else if(Z.subject_batch_id){const _e=await mr(`/api/academics/subject-batches/${Z.subject_batch_id}/`);if(_e.ok){const He=await _e.json();me=He.students||He.results||[]}}else{const _e=await mr(`/api/academics/sections/${Z.section_id}/students/`);_e.ok&&(me=(await _e.json()).results||[])}const Te={};for(const _e of me||[])_e&&_e.id&&(Te[_e.id]=_e);const je=Object.values(Te);u((je||[]).map(_e=>({id:Number(_e.id),reg_no:String(_e.reg_no||_e.regno||String(_e.id)),name:String(_e.name??_e.full_name??_e.username??""),username:String(_e.username??_e.name??""),section:_e.section_name??_e.section??null,section_id:_e.section_id??null})));const Le={};if((je||[]).forEach(_e=>Le[_e.id]="P"),f(Le),Z.attendance_session_id||Z.attendance_session_ids&&Z.attendance_session_ids.length)try{const He=(Z.attendance_session_ids&&Z.attendance_session_ids.length?Z.attendance_session_ids:[Z.attendance_session_id]).map(dt=>mr(`/api/academics/period-attendance/${dt}/`).then(Ye=>Ye.ok?Ye.json():null).catch(()=>null)),We=await Promise.allSettled(He),Pt={...Le};for(const dt of We){if(dt.status!=="fulfilled"||!dt.value)continue;(dt.value.records||[]).forEach(be=>{const ke=be.student_pk||be.student&&be.student.id||null;ke&&(Pt[ke]=be.status||Pt[ke]||"A")})}f(Pt)}catch(_e){console.error("load session records",_e)}}catch(me){console.error("openPeriod",me)}finally{s(!1)}}function K(Z,me){f(Te=>({...Te,[Z]:me}))}async function ne(){if(o){p(!0);try{const Z=c.map(He=>({student_id:He.id,status:d[He.id]||"P"})),me=o.consecutive_periods&&Array.isArray(o.consecutive_periods)&&o.consecutive_periods.length>0?o.consecutive_periods.map(He=>He.period_id):[o.period.id],Te=o.section_ids&&Array.isArray(o.section_ids)&&o.section_ids.length>0?o.section_ids:[o.section_id],je={};for(const He of Te){const We=c.filter(Pt=>(Pt.section_id||null)===He).map(Pt=>({student_id:Pt.id,status:d[Pt.id]||"P"}));if(We.length===0&&o.section_name){const Pt=new Set(String(o.section_name).split(" + ").map(Ye=>Ye.trim())),dt=c.filter(Ye=>Pt.has(String(Ye.section_name||Ye.section||"").trim())).map(Ye=>({student_id:Ye.id,status:d[Ye.id]||"P"}));je[He]=dt.length?dt:c.map(Ye=>({student_id:Ye.id,status:d[Ye.id]||"P"}))}else je[He]=We.length?We:c.map(Pt=>({student_id:Pt.id,status:d[Pt.id]||"P"}))}const Le=[];for(const He of me)for(const We of Te){const Pt={section_id:We,period_id:He,teaching_assignment_id:o.teaching_assignment_id??null,date:e,records:je[We]||[]};console.log("Saving attendance for section",We,"period",He,Pt);const dt=await mr("/api/academics/period-attendance/bulk-mark/",{method:"POST",body:JSON.stringify(Pt)}),Ye=await(dt.ok?dt.json().catch(()=>null):dt.json().catch(()=>null));Le.push({section:We,period:He,ok:dt.ok,data:Ye})}const _e=Le.filter(He=>!He.ok);if(_e.length)console.error("Some saves failed:",_e),alert("Attendance saved for some sections/periods, but failed for others. Check console for details.");else{await O();const He=o.combined_period_label||o.period&&(o.period.label||`Period ${o.period.index}`);alert(`Attendance saved successfully!

Date: ${e}
Period(s): ${He}
Sections: ${Te.length}
Students: ${c.length}`),l(null)}}catch(Z){console.error("saveMarks error:",Z),alert("Failed to save attendance: "+(Z instanceof Error?Z.message:String(Z)))}finally{p(!1)}}}async function re(){var Z,me,Te,je,Le,_e;if(!(!ae||!C)){V(!1);try{const He=ae;let We=[];if(He.section_ids&&Array.isArray(He.section_ids)&&He.section_ids.length>1){const ke=He.section_ids.map(ce=>mr(`/api/academics/sections/${ce}/students/`).then(we=>we.ok?we.json():{results:[]}).catch(()=>({results:[]})));if(He.elective_subject_id){const ce=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${He.elective_subject_id}`);ce.ok&&(We=(await ce.json()).results||[])}else{const ce=await Promise.allSettled(ke);for(const we of ce)if(we.status==="fulfilled"){const ht=we.value||{};We=We.concat(ht.results||ht.students||[])}}}else if(He.elective_subject_id){const ke=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${He.elective_subject_id}`);ke.ok&&(We=(await ke.json()).results||[])}else if(He.subject_batch_id){const ke=await mr(`/api/academics/subject-batches/${He.subject_batch_id}/`);if(ke.ok){const ce=await ke.json();We=ce.students||ce.results||[]}}else{const ke=await mr(`/api/academics/sections/${He.section_id}/students/`);ke.ok&&(We=(await ke.json()).results||[])}const Pt={};for(const ke of We||[])ke&&ke.id&&(Pt[ke.id]=ke);let dt=Object.values(Pt).map(ke=>({id:Number(ke.id),reg_no:String(ke.reg_no||ke.regno||String(ke.id)),username:ke.username||ke.name||"",section_id:ke.section_id||ke.sectionId||null,section_name:ke.section_name||ke.section||""}));if((!dt||dt.length===0)&&He.section_ids&&Array.isArray(He.section_ids)&&He.section_ids.length>0){const ke=He.section_ids.map(nt=>mr(`/api/academics/sections/${nt}/students/`).then(Ie=>Ie.ok?Ie.json():{results:[]}).catch(()=>({results:[]}))),ce=await Promise.allSettled(ke),we=[];for(const nt of ce)if(nt.status==="fulfilled"){const Ie=nt.value||{},It=Ie.results||Ie.students||[];we.push(...It)}const ht={};for(const nt of we)nt&&nt.id&&(ht[nt.id]=nt);dt=Object.values(ht).map(nt=>({id:Number(nt.id),reg_no:String(nt.reg_no||nt.regno||String(nt.id)),username:nt.username||nt.name||"",section_id:nt.section_id||nt.sectionId||null,section_name:nt.section_name||nt.section||""}))}const Ye={};dt.forEach(ke=>Ye[ke.id]="P"),u(dt),f(Ye);const lt=`${((Z=ae.period)==null?void 0:Z.label)||`Period ${(me=ae.period)==null?void 0:me.index}`} & ${((Te=C.period)==null?void 0:Te.label)||`Period ${(je=C.period)==null?void 0:je.index}`}`,be=He.section_names&&He.section_names.length?He.section_names.join(" + "):He.section_name||"";l({...ae,consecutive_periods:[{period_id:ae.period.id,label:((Le=ae.period)==null?void 0:Le.label)||""},{period_id:C.period.id,label:((_e=C.period)==null?void 0:_e.label)||""}],combined_period_label:lt,section_name:be,section_ids:He.section_ids||[He.section_id]})}catch(He){console.error("markBothPeriods error:",He),alert("Failed to prepare marking for both periods: "+(He instanceof Error?He.message:String(He)))}finally{V(!1),ee(null),Y(null)}}}function T(){ae&&(V(!1),Q(ae),ee(null),Y(null))}async function I(){var je;if(!o||!o.attendance_session_id){alert("No active attendance session to lock/unlock");return}const Z=o.attendance_session_locked,me=o.attendance_session_id;if(window.confirm(Z?"Are you sure you want to request an unlock for this attendance session? Unlocking requires approval.":"Are you sure you want to lock this attendance session? This will prevent any further changes to attendance records.")){g(!0);try{if(Z){const Le=await mr("/api/academics/attendance-unlock-requests/",{method:"POST",body:JSON.stringify({session:o.attendance_session_id,note:""})});if(Le.ok){const _e=await Le.json();console.log("Unlock request created:",_e),alert('Unlock request submitted successfully! Check the "My Requests" button in the Analytics page to view the status.');try{l(He=>He&&{...He,unlock_request_status:_e.status,unlock_request_id:_e.id}),n(He=>He.map(We=>We.attendance_session_id&&me&&We.attendance_session_id===me?{...We,unlock_request_status:_e.status,unlock_request_id:_e.id}:We))}catch(He){console.warn("Failed to update local unlock status",He)}}else{const _e=await Le.json().catch(()=>({}));if(Le.status===400&&((je=_e.detail)!=null&&je.includes("already pending")))alert("An unlock request for this session already exists and is pending approval. Please check the Requests section for status.");else throw new Error(_e.detail||"Failed to create unlock request")}}else{const Le=await mr(`/api/academics/period-attendance/${o.attendance_session_id}/lock/`,{method:"POST"});if(!Le.ok){const He=await Le.json().catch(()=>({}));throw new Error(He.detail||"Failed to lock session")}const _e=await Le.json();console.log("Session locked successfully:",_e),l({...o,attendance_session_locked:_e.is_locked}),await O(),alert("Attendance session locked successfully!")}}catch(Le){console.error("toggleLock error:",Le),alert("Failed to perform lock/unlock: "+(Le instanceof Error?Le.message:String(Le)))}finally{g(!1)}}}async function ie(){try{const Z=await mr("/api/timetable/staff/");if(!Z.ok)throw new Error("Failed to load assignments");const me=await Z.json(),Te=[];for(const je of me.results||[]){const Le=je.day;for(const _e of je.assignments||[])Te.push({..._e,_day:Le})}await D(v,Te),j(Te),b(!0),A({}),U({}),H({})}catch(Z){console.error("openBulkModal",Z),alert("Failed to open bulk modal")}}async function D(Z,me){var Te,je;try{const[Le,_e]=Z.split("-").map(be=>parseInt(be)),He=new Date(Le,_e-1,1).toISOString().slice(0,10),We=new Date(Le,_e,0).toISOString().slice(0,10),Pt=await mr(`/api/academics/period-attendance/?date_after=${He}&date_before=${We}`);if(!Pt.ok){console.warn("Failed to load existing sessions"),de({});return}const Ye=(await Pt.json()).results||[],lt={};for(const be of Ye){const ke=be.date,ce=((Te=be.section)==null?void 0:Te.id)||be.section_id,we=((je=be.period)==null?void 0:je.id)||be.period_id;if(!ke||!ce||!we)continue;const ht=new Date(ke),nt=ht.getDay()===0?7:ht.getDay(),Ie=me.find(It=>{var ct,Mt;return It._day===nt&&(It.period_id===we||((ct=It.period)==null?void 0:ct.id)===we)&&(It.section_id===ce||((Mt=It.section)==null?void 0:Mt.id)===ce)});if(Ie){const It=Ie.id?String(Ie.id):`${Ie._day}_${we}_${ce}`;lt[It]||(lt[It]=new Set),lt[It].add(ke)}}de(lt),console.log("Loaded marked sessions:",lt)}catch(Le){console.error("Error loading marked sessions:",Le),de({})}}return x.useEffect(()=>{y&&S.length>0&&D(v,S)},[v]),x.useEffect(()=>{async function Z(){var Te,je,Le,_e;if(!Object.keys(k).filter(He=>k[He]).length){M([]);return}E(!0);try{const He=[];for(const dt of S){const Ye=dt.id?String(dt.id):`${dt._day}_${dt.period_id}_${dt.section_id}`;if(k[Ye]){if(dt.elective_subject_id)He.push(mr(`/api/curriculum/elective-choices/?elective_subject_id=${dt.elective_subject_id}`).then(lt=>lt.ok?lt.json():{results:[]}));else if(dt.subject_batch_id||(Te=dt.subject_batch)!=null&&Te.id){const lt=dt.subject_batch_id||((je=dt.subject_batch)==null?void 0:je.id);He.push(mr(`/api/academics/subject-batches/${lt}/`).then(be=>be.ok?be.json():{students:[]}))}else if(dt.section_id||(Le=dt.section)!=null&&Le.id){const lt=dt.section_id||((_e=dt.section)==null?void 0:_e.id);He.push(mr(`/api/academics/sections/${lt}/students/`).then(be=>be.ok?be.json():{results:[]}))}}}const We=await Promise.allSettled(He),Pt=[];for(const dt of We){if(dt.status!=="fulfilled")continue;const Ye=dt.value||{},lt=Ye.results||Ye.students||[];for(const be of lt)!be||!be.id||Pt.find(ke=>ke.id===be.id)||Pt.push({id:be.id,reg_no:be.reg_no||be.regno||String(be.id),username:be.username||be.name||""})}M(Pt),H(dt=>{const Ye={...dt};for(const lt of Pt)Ye[lt.id]===void 0&&(Ye[lt.id]=!1);return Ye})}catch(He){console.error("loadAgg",He),M([])}finally{E(!1)}}Z()},[k,S]),a.jsxs("div",{className:"min-h-screen p-4 md:p-6 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-6 border border-slate-200",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 p-3 rounded-xl shadow-lg",children:a.jsx(xs,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Mark Attendance"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"Record student attendance for periods"})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-4 border border-slate-200",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("label",{className:"text-sm font-medium text-slate-700 flex items-center gap-2",children:[a.jsx(sc,{className:"w-4 h-4 text-indigo-600"}),"Select Date:"]}),a.jsx("input",{type:"date",value:e,onChange:Z=>t(Z.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 mb-6",children:[a.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-slate-50",children:a.jsxs("h2",{className:"text-lg font-semibold text-slate-900 flex items-center gap-2",children:[a.jsx(ys,{className:"w-5 h-5 text-indigo-600"}),"Assigned Periods"]})}),a.jsx("div",{className:"p-6",children:i?a.jsxs("div",{className:"flex items-center justify-center py-12",children:[a.jsx(Gu,{className:"w-8 h-8 text-indigo-600 animate-spin"}),a.jsx("span",{className:"ml-3 text-slate-600",children:"Loading periods..."})]}):a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[q(r).map(Z=>a.jsxs("div",{className:"border border-slate-200 rounded-lg p-4 bg-white hover:shadow-md transition-shadow",children:[a.jsx("div",{className:"flex items-start justify-between mb-2",children:a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-semibold text-slate-900 mb-1",children:Z.period.label||`Period ${Z.period.index}`}),a.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-slate-600 mb-1",children:[a.jsx(sc,{className:"w-4 h-4"}),Z.period.start_time||"",Z.period.start_time&&Z.period.end_time?`  ${Z.period.end_time}`:""]}),a.jsx("div",{className:"text-sm text-slate-700 mb-1",children:a.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-md bg-blue-100 text-blue-800 font-medium",children:Z.section_names&&Z.section_names.length?Z.section_names.join(" + "):Z.section_name})}),a.jsx("div",{className:"text-sm italic text-slate-600",children:Z.subject_display||Z.subject||"No subject"}),Z.unlock_request_status&&a.jsxs("div",{className:"mt-2",children:[Z.unlock_request_status==="PENDING"&&a.jsx("span",{className:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-amber-100 text-amber-800 border border-amber-300 rounded-md text-xs font-medium",children:"Pending"}),Z.unlock_request_status==="APPROVED"&&a.jsx("span",{className:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-green-100 text-green-800 border border-green-300 rounded-md text-xs font-medium",children:"Approved"}),Z.unlock_request_status==="REJECTED"&&a.jsx("span",{className:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-red-100 text-red-800 border border-red-300 rounded-md text-xs font-medium",children:"Rejected"})]})]})}),a.jsx("div",{className:"mt-3",children:Z.attendance_session_locked?a.jsxs("button",{onClick:()=>Q(Z),className:"w-full px-3 py-2 bg-amber-100 text-amber-800 border border-amber-300 rounded-lg text-sm font-medium hover:bg-amber-200 flex items-center justify-center gap-2",children:[a.jsx(a0,{className:"w-4 h-4"}),Z.attendance_session_id?"View Locked Session":"View Locked Period"]}):a.jsx("button",{onClick:()=>F(Z),className:"w-full px-3 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2",children:Z.attendance_session_id?a.jsxs(a.Fragment,{children:[a.jsx(Ld,{className:"w-4 h-4"}),"Open Session"]}):a.jsxs(a.Fragment,{children:[a.jsx(xs,{className:"w-4 h-4"}),"Take Attendance"]})})})]},Z.id)),!r.length&&a.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center py-12 text-center",children:[a.jsx("div",{className:"bg-slate-100 p-4 rounded-full mb-4",children:a.jsx(xs,{className:"w-12 h-12 text-slate-400"})}),a.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-1",children:"No Periods Found"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"No periods assigned for this date"})]}),a.jsx("div",{className:"col-span-full mt-2",children:a.jsx("button",{onClick:ie,className:"w-full px-4 py-3 border-2 border-dashed border-indigo-300 text-indigo-600 rounded-lg font-medium hover:bg-indigo-50 transition-colors",children:"Bulk Mark (All Assignments)"})})]})})]}),o&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 mb-6",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-slate-200 bg-slate-50 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("h3",{className:"text-lg font-semibold text-slate-900",children:[o.combined_period_label||o.period.label||`Period ${o.period.index}`,"  ",o.section_name,a.jsxs("span",{className:"ml-3 inline-flex items-center px-2 py-0.5 rounded-md bg-slate-100 text-slate-700 text-sm font-medium",children:[c.length," student",c.length!==1?"s":""]})]}),o.attendance_session_locked&&a.jsxs(a.Fragment,{children:[a.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-amber-100 text-amber-800 border border-amber-300 rounded-lg text-sm font-medium",children:[a.jsx(a0,{className:"w-3.5 h-3.5"}),"Locked"]}),o.unlock_request_status==="PENDING"&&a.jsx("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-amber-50 text-amber-800 border border-amber-200 rounded-lg text-sm font-medium ml-3",children:"Pending"}),o.unlock_request_status==="APPROVED"&&a.jsx("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-green-50 text-green-800 border border-green-200 rounded-lg text-sm font-medium ml-3",children:"Approved"}),o.unlock_request_status==="REJECTED"&&a.jsx("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-red-50 text-red-800 border border-red-200 rounded-lg text-sm font-medium ml-3",children:"Rejected"})]})]}),a.jsxs("button",{onClick:()=>l(null),className:"px-3 py-1.5 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-lg text-sm font-medium transition-colors flex items-center gap-2",children:[a.jsx(bu,{className:"w-4 h-4"}),"Close"]})]}),a.jsxs("div",{className:"p-6",children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-slate-200",children:[a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Reg No"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Student"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Status"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-200",children:c.map(Z=>{const me=d[Z.id]||"P",Te={P:"bg-green-50 text-green-800 border-green-300",A:"bg-red-50 text-red-800 border-red-300",LEAVE:"bg-amber-50 text-amber-800 border-amber-300",OD:"bg-blue-50 text-blue-800 border-blue-300",LATE:"bg-indigo-50 text-indigo-800 border-indigo-300"},je={P:"bg-green-600",A:"bg-red-600",LEAVE:"bg-amber-600",OD:"bg-blue-600",LATE:"bg-indigo-600"},Le=Te[me]||Te.P,_e=je[me]||je.P;return a.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[a.jsx("td",{className:"py-3 px-4 text-sm font-medium text-slate-900",children:Z.reg_no}),a.jsx("td",{className:"py-3 px-4 text-sm text-slate-700",children:Z.username}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:`inline-block w-3 h-3 rounded-full mr-2 ${_e}`}),a.jsxs("div",{className:"relative inline-block",children:[a.jsxs("select",{value:d[Z.id]||"P",onChange:He=>K(Z.id,He.target.value),disabled:o.attendance_session_locked,className:`appearance-none px-3 py-1.5 pr-8 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent ${Le} ${o.attendance_session_locked?"disabled:bg-slate-100 disabled:text-slate-500 disabled:cursor-not-allowed":""}`,children:[a.jsx("option",{value:"P",children:"Present"}),a.jsx("option",{value:"A",children:"Absent"}),a.jsx("option",{value:"LEAVE",children:"Leave"}),a.jsx("option",{value:"OD",children:"On Duty"}),a.jsx("option",{value:"LATE",children:"Late"})]}),a.jsx(Vee,{className:"w-4 h-4 text-slate-400 absolute right-2 top-1/2 -translate-y-1/2 pointer-events-none"})]})]})})]},Z.id)})})]})}),a.jsxs("div",{className:"mt-6 flex flex-wrap gap-3",children:[a.jsx("button",{onClick:ne,disabled:h||o.attendance_session_locked,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-300 text-white rounded-lg font-medium transition-colors flex items-center gap-2",children:h?a.jsxs(a.Fragment,{children:[a.jsx(Gu,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(rd,{className:"w-4 h-4"}),"Save Attendance"]})}),o.attendance_session_id&&a.jsx("button",{onClick:I,disabled:m,className:`px-4 py-2 rounded-lg font-medium transition-colors flex items-center gap-2 ${o.attendance_session_locked?"bg-amber-600 hover:bg-amber-700 disabled:bg-amber-300 text-white":"bg-slate-600 hover:bg-slate-700 disabled:bg-slate-300 text-white"}`,children:m?a.jsxs(a.Fragment,{children:[a.jsx(Gu,{className:"w-4 h-4 animate-spin"}),o.attendance_session_locked?"Unlocking...":"Locking..."]}):a.jsx(a.Fragment,{children:o.attendance_session_locked?a.jsxs(a.Fragment,{children:[a.jsx(gte,{className:"w-4 h-4"}),"Unlock Session"]}):a.jsxs(a.Fragment,{children:[a.jsx(a0,{className:"w-4 h-4"}),"Lock Session"]})})})]})]})]}),y&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-3xl max-h-[85vh] overflow-y-auto shadow-2xl",children:[a.jsx("div",{className:"sticky top-0 bg-white border-b border-slate-200 px-6 py-4 rounded-t-xl",children:a.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Bulk Mark Attendance"})}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[a.jsx(xs,{className:"w-4 h-4 text-indigo-600"}),"Select Month:"]}),a.jsx("input",{type:"month",value:v,onChange:Z=>w(Z.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-900 mb-3",children:"Assignments"}),a.jsxs("div",{className:"border border-slate-200 rounded-lg p-4 max-h-60 overflow-y-auto bg-slate-50",children:[a.jsxs("label",{className:"flex items-center gap-2 mb-3 text-sm font-medium text-slate-700",children:[a.jsx("input",{type:"checkbox",checked:Object.keys(k).length>0&&Object.values(k).every(Boolean),onChange:Z=>{const me=Z.target.checked,Te={};for(const je of S){const Le=je.id?String(je.id):`${je._day}_${je.period_id}_${je.section_id}`;Te[Le]=me}A(Te)},className:"w-4 h-4 text-indigo-600 border-slate-300 rounded focus:ring-indigo-500"}),"Select / Deselect all"]}),a.jsx("div",{className:"space-y-2",children:(()=>{const Z=S.filter(me=>{const Te=me.id?String(me.id):`${me._day}_${me.period_id}_${me.section_id}`,je=oe[Te];if(!je)return!0;try{const[Le,_e]=v.split("-").map(Pt=>parseInt(Pt)),He=new Date(Le,_e,0).getDate();let We=0;for(let Pt=1;Pt<=He;Pt++){const dt=new Date(Le,_e-1,Pt);(dt.getDay()===0?7:dt.getDay())===me._day&&We++}return je.size<We}catch{return!0}});return Z.length===0?a.jsxs("div",{className:"text-center py-8 text-slate-600",children:[a.jsx(Ld,{className:"w-12 h-12 text-green-500 mx-auto mb-2"}),a.jsx("p",{className:"font-medium",children:"All assignments are fully marked for this month!"})]}):Z.map(me=>{var _e;const Te=me.id?String(me.id):`${me._day}_${me.period_id}_${me.section_id}`,je=oe[Te],Le=je?je.size:0;return a.jsxs("label",{className:"flex items-start gap-3 p-2 hover:bg-white rounded-lg transition-colors cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:!!k[Te],onChange:()=>A(He=>({...He,[Te]:!He[Te]})),className:"w-4 h-4 text-indigo-600 border-slate-300 rounded focus:ring-indigo-500 mt-0.5"}),a.jsxs("div",{className:"flex-1 text-sm",children:[a.jsxs("div",{className:"font-medium text-slate-900",children:[me.label||`Period ${me.period_index}`,"  ",["Mon","Tue","Wed","Thu","Fri","Sat"][me._day-1]||`Day ${me._day}`,me.start_time?` ${me.start_time}${me.end_time?" - "+me.end_time:""}`:""]}),a.jsxs("div",{className:"text-xs text-slate-600 mt-0.5",children:[me.section_name||((_e=me.section)==null?void 0:_e.name)||(me.section_id?`Section ${me.section_id}`:""),"  ",me.subject_display||me.subject_text||"",Le>0&&a.jsxs("span",{className:"ml-2 text-green-600 font-medium",children:["(",Le," day",Le!==1?"s":""," marked)"]})]})]})]},Te)})})()})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-900 mb-3",children:"Dates (month view for selected assignments)"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(()=>{try{const[Z,me]=v.split("-").map(We=>parseInt(We)),Te=new Date(Z,me,0),je=new Set;for(const We of S){const Pt=We.id?String(We.id):`${We._day}_${We.period_id}_${We.section_id}`;k[Pt]&&je.add(We._day)}const Le=[];for(let We=1;We<=Te.getDate();We++){const Pt=new Date(Z,me-1,We),dt=Pt.getDay()===0?7:Pt.getDay();je.size>0&&je.has(dt)&&Le.push(Pt.toISOString().slice(0,10))}const _e=Object.keys(k).filter(We=>k[We]),He=Le.filter(We=>_e.length===0?!0:_e.some(Pt=>{const dt=oe[Pt];return!dt||!dt.has(We)}));return He.length===0&&_e.length>0?a.jsxs("div",{className:"text-center py-4 text-slate-600",children:[a.jsx(Ld,{className:"w-8 h-8 text-green-500 mx-auto mb-2"}),a.jsx("p",{className:"text-sm",children:"All dates are already marked for selected assignments"})]}):He.map(We=>{const Pt=_e.filter(dt=>{const Ye=oe[dt];return Ye&&Ye.has(We)}).length;return a.jsxs("label",{className:"inline-flex items-center gap-2 px-3 py-1.5 border border-slate-300 rounded-lg text-sm hover:bg-slate-100 cursor-pointer transition-colors",children:[a.jsx("input",{type:"checkbox",checked:!!P[We],onChange:()=>U(dt=>({...dt,[We]:!dt[We]})),className:"w-4 h-4 text-indigo-600 border-slate-300 rounded focus:ring-indigo-500"}),a.jsxs("span",{children:[We,Pt>0&&_e.length>1&&a.jsxs("span",{className:"ml-1 text-xs text-amber-600",children:["(",Pt,"/",_e.length," marked)"]})]})]},We)})}catch{return a.jsx("div",{})}})()})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-slate-900 mb-3",children:["Students (derived from selected assignments)",a.jsxs("span",{className:"ml-2 text-sm text-slate-600",children:["(",R.length," student",R.length!==1?"s":"",")"]})]}),a.jsxs("div",{className:"border border-slate-200 rounded-lg p-4 max-h-64 overflow-y-auto bg-slate-50",children:[B&&a.jsxs("div",{className:"flex items-center justify-center py-8 text-slate-600",children:[a.jsx(Gu,{className:"w-6 h-6 animate-spin mr-2"}),"Loading students..."]}),!B&&R.length===0&&a.jsx("div",{className:"text-center py-8 text-slate-600",children:"No students for selected assignments"}),!B&&R.length>0&&a.jsx("div",{className:"space-y-1",children:R.map(Z=>a.jsxs("label",{className:"flex items-center gap-2 p-2 hover:bg-white rounded-lg transition-colors cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:!!G[Z.id],onChange:me=>H(Te=>({...Te,[Z.id]:!Te[Z.id]})),className:"w-4 h-4 text-indigo-600 border-slate-300 rounded focus:ring-indigo-500"}),a.jsxs("span",{className:"text-sm text-slate-900",children:[Z.reg_no,"  ",Z.username]})]},Z.id))})]})]})]}),a.jsxs("div",{className:"sticky bottom-0 bg-white border-t border-slate-200 px-6 py-4 flex gap-3 rounded-b-xl",children:[a.jsxs("button",{onClick:async()=>{var je,Le,_e,He;const Z=Object.keys(P).filter(We=>P[We]);if(!Z.length){alert("Select at least one date");return}const me=[];for(const We of S){const Pt=We.id?String(We.id):`${We._day}_${We.period_id}_${((je=We.section)==null?void 0:je.id)||We.section_id}`;if(!k[Pt])continue;const dt=We.section_id||We.section&&(We.section.id||We.section.pk)||((Le=We.section)==null?void 0:Le.pk)||((_e=We.section)==null?void 0:_e.id),Ye=We.period_id||We.period&&(We.period.id||We.period_id)||((He=We.period)==null?void 0:He.id)||We.period_id,lt=Number(dt),be=Number(Ye);!Number.isFinite(lt)||!Number.isFinite(be)||me.push({section_id:lt,period_id:be})}const Te=Object.keys(G).filter(We=>G[Number(We)]).map(We=>Number(We));if(!me.length){alert("No assignments selected");return}if(!Te.length){alert("No students selected");return}try{const We=await mr("/api/academics/period-attendance/bulk-mark/",{method:"POST",body:JSON.stringify({assignments:me,dates:Z,student_ids:Te})});if(!We.ok){let Pt="Failed";try{const dt=await We.json();Pt=JSON.stringify(dt)}catch{try{Pt=await We.text()}catch{}}alert("Failed: "+Pt);return}alert("Bulk attendance saved"),b(!1)}catch(We){console.error("bulk save",We),alert("Failed to save bulk attendance")}},className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors flex items-center gap-2",children:[a.jsx(rd,{className:"w-4 h-4"}),"Save Bulk"]}),a.jsx("button",{onClick:()=>b(!1),className:"px-4 py-2 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-lg font-medium transition-colors",children:"Close"})]})]})}),W&&ae&&C&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md shadow-2xl",children:[a.jsx("div",{className:"bg-gradient-to-br from-amber-500 to-orange-600 px-6 py-4 rounded-t-xl",children:a.jsxs("div",{className:"flex items-center gap-3 text-white",children:[a.jsx(ed,{className:"w-6 h-6"}),a.jsx("h3",{className:"text-xl font-bold",children:"Consecutive Periods Detected"})]})}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:[a.jsxs("p",{className:"text-sm text-slate-700 mb-3",children:["The same subject has consecutive periods",Math.abs(C.period.index-ae.period.index)>1?" (with break/lunch in between)":"",":"]}),a.jsxs("div",{className:"space-y-2 mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-600"}),a.jsx("span",{className:"font-semibold text-slate-900",children:ae.period.label||`Period ${ae.period.index}`}),a.jsxs("span",{className:"text-slate-600",children:["(",ae.period.start_time," - ",ae.period.end_time,")"]})]}),Math.abs(C.period.index-ae.period.index)>1&&a.jsx("div",{className:"flex items-center gap-2 text-sm pl-4",children:a.jsxs("span",{className:"text-slate-500 italic",children:[" ",Math.abs(C.period.index-ae.period.index)-1," period(s) in between (break/lunch)"]})}),a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-600"}),a.jsx("span",{className:"font-semibold text-slate-900",children:C.period.label||`Period ${C.period.index}`}),a.jsxs("span",{className:"text-slate-600",children:["(",C.period.start_time," - ",C.period.end_time,")"]})]})]}),a.jsxs("p",{className:"text-sm font-medium text-slate-900",children:["Subject: ",a.jsx("span",{className:"text-indigo-600",children:ae.subject||ae.subject_display||"Same Subject"})]})]}),a.jsx("p",{className:"text-sm text-slate-600",children:"Would you like to mark attendance for both periods at once (all students Present), or just the selected period?"})]}),a.jsxs("div",{className:"px-6 pb-6 flex flex-col gap-3",children:[a.jsxs("button",{onClick:re,className:"w-full px-4 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors flex items-center justify-center gap-2",children:[a.jsx(Ld,{className:"w-5 h-5"}),"Mark Both Periods (All Present)"]}),a.jsx("button",{onClick:T,className:"w-full px-4 py-3 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-lg font-medium transition-colors",children:"Single Period Only"}),a.jsx("button",{onClick:()=>{V(!1),ee(null),Y(null)},className:"w-full px-4 py-2 text-slate-600 hover:text-slate-800 text-sm font-medium transition-colors",children:"Cancel"})]})]})})]})}const HOe=()=>{const[e,t]=x.useState(!1),[r,n]=x.useState(null),[i,s]=x.useState(!1),[o,l]=x.useState([]),[c,u]=x.useState(!1),[d,f]=x.useState([]),[h,p]=x.useState(null),[m,g]=x.useState("overall"),[y,b]=x.useState(!1),[v,w]=x.useState(null),[S,j]=x.useState([]),[k,A]=x.useState([]),[R,M]=x.useState(null),[B,E]=x.useState({}),[P,U]=x.useState(!1);x.useEffect(()=>{H()},[]),x.useEffect(()=>{oe()},[]),x.useEffect(()=>{de()},[]),x.useEffect(()=>{G()},[]),x.useEffect(()=>{h&&(h==="all"||h==="department"?g("overall"):h==="class"&&g("assigned"))},[h]);async function G(){try{const ee=await mr("/api/academics/analytics/filters/");if(!ee.ok)return p(null);const C=await ee.json().catch(()=>null);p((C==null?void 0:C.permission_level)||null),j((C==null?void 0:C.departments)||[]),A((C==null?void 0:C.sections)||[]),((C==null?void 0:C.departments)||[]).length>0&&M((C.departments[0]||{}).id||null)}catch(ee){console.error("Failed to load analytics filters",ee),p(null)}}async function H(){t(!0);try{const ee=await mr("/api/academics/analytics/today-periods/"),C=await ee.json().catch(()=>null);ee.ok?n(C):n(null)}catch(ee){console.error("Failed to load today periods",ee),n(null)}finally{t(!1)}}async function oe(){s(!0);try{const ee=new Date().toISOString().split("T")[0],C=await mr(`/api/academics/staff/periods/?date=${ee}`),Y=await C.json().catch(()=>({results:[]}));C.ok?l(Y.results||[]):l([])}catch(ee){console.error("Failed to load assigned periods",ee),l([])}finally{s(!1)}}async function de(){u(!0);try{const ee=new Date().toISOString().split("T")[0],C=await mr(`/api/academics/analytics/overall-section/?date=${ee}`);if(!C.ok){f([]),u(!1);return}const Y=await C.json().catch(()=>({sections:[]}));f(Y.sections||[])}catch(ee){console.error("Failed to load overall sections",ee),f([])}finally{u(!1)}}async function W(ee){if(!ee)return;U(!0);const C=new Date().toISOString().split("T")[0],Y=k.filter(O=>String(O.batch__course__department__id)===String(ee)),q={};try{await Promise.all(Y.map(async O=>{try{const X=await mr(`/api/academics/analytics/class-report/?section_id=${O.id}&date=${C}&period_index=1`);if(!X.ok)return;const F=await X.json().catch(()=>null);F&&(q[O.id]=F)}catch{}})),E(O=>({...O,...q}))}finally{U(!1)}}const V=async ee=>{if(!ee)return alert("No session available");if(confirm("Request unlock for this session?"))try{const C=await mr("/api/academics/attendance-unlock-requests/",{method:"POST",body:JSON.stringify({session:ee,note:""})});if(!C.ok){const Y=await C.json().catch(()=>({}));C.status===400&&Y.detail&&String(Y.detail).includes("already pending")?alert("An unlock request for this session is already pending."):alert("Failed to create unlock request: "+(Y.detail||C.status));return}alert("Unlock request submitted successfully")}catch(C){console.error(C),alert("Failed to submit request")}};async function ae(ee){if(ee){b(!0),w(null);try{const C=new Date().toISOString().split("T")[0],Y=await mr(`/api/academics/analytics/class-report/?section_id=${ee}&date=${C}`);if(!Y.ok){const O=await Y.json().catch(()=>({}));alert("Failed to load section report: "+(O.detail||Y.status)),b(!1);return}const q=await Y.json().catch(()=>null);w(q),g("section")}catch(C){console.error("Failed to load section report",C),alert("Failed to load section report")}finally{b(!1)}}}return a.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Attendance Unlock Requests"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Request unlock for a locked attendance session from the list below."})]}),e&&a.jsx("div",{className:"py-6 text-gray-600",children:"Loading today's periods"}),a.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[(h==="all"||h==="department")&&a.jsx("button",{onClick:()=>g("overall"),className:`px-3 py-1 rounded ${m==="overall"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700"}`,children:"Overall"}),a.jsx("button",{onClick:()=>g("assigned"),className:`px-3 py-1 rounded ${m==="assigned"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700"}`,children:"My Assigned"})]}),m==="overall"&&!c&&a.jsx("div",{className:"mb-6 bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"text-sm text-gray-700",children:"Overall sections (permissioned)"}),S&&S.length>0&&a.jsxs("select",{value:R??"",onChange:ee=>{const C=ee.target.value,Y=C?Number(C):null;M(Y),Y&&W(Y)},className:"px-2 py-1 border rounded",children:[a.jsx("option",{value:"",children:"-- Select department --"}),S.map(ee=>a.jsx("option",{value:ee.id,children:ee.short_name||ee.name},ee.id))]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:de,className:"flex items-center gap-2 px-3 py-1 text-sm bg-gray-100 rounded hover:bg-gray-200",children:[a.jsx(T2,{className:"w-4 h-4"})," Refresh"]}),R&&a.jsx("button",{onClick:()=>R&&W(R),className:"flex items-center gap-2 px-3 py-1 text-sm bg-gray-100 rounded hover:bg-gray-200",children:"Load Dept Sections"})]})]}),a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Section"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Present"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Absent"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"OD"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Total"}),a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Status"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Action"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:R?k.filter(ee=>String(ee.batch__course__department__id)===String(R)).map(ee=>{const C=B[ee.id];return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:ee.name}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-green-600 font-semibold",children:(C==null?void 0:C.present)??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-red-600 font-semibold",children:(C==null?void 0:C.absent)??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-600",children:(C==null?void 0:C.on_duty)??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-900",children:(C==null?void 0:C.total_strength)??"-"}),a.jsx("td",{className:"px-4 py-3 text-sm",children:C!=null&&C.is_locked?a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-red-100 text-red-700",children:[a.jsx(a0,{className:"w-3 h-3 mr-1"}),"Locked"]}):C!=null&&C.total_marked?a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-50 text-green-700",children:"Saved"}):a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-50 text-gray-700",children:"Not saved"})}),a.jsx("td",{className:"px-4 py-3 text-right",children:a.jsx("button",{onClick:()=>ae(ee.id),className:"px-3 py-1 rounded text-sm bg-gray-100 text-gray-700 hover:bg-gray-200",children:"View"})})]},ee.id)}):d.map(ee=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:(ee.department_short||ee.department_name?`${ee.department_short||ee.department_name} - `:"")+(ee.section_name||"")}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-green-600 font-semibold",children:ee.present??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-red-600 font-semibold",children:ee.absent??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-600",children:ee.on_duty??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-900",children:ee.total_strength??"-"}),a.jsx("td",{className:"px-4 py-3 text-sm",children:ee.is_locked?a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-red-100 text-red-700",children:[a.jsx(a0,{className:"w-3 h-3 mr-1"}),"Locked"]}):ee.marked_at?a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-50 text-green-700",children:"Saved"}):a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-50 text-gray-700",children:"Not saved"})}),a.jsx("td",{className:"px-4 py-3 text-right",children:a.jsx("button",{onClick:()=>ae(ee.section_id),className:"px-3 py-1 rounded text-sm bg-gray-100 text-gray-700 hover:bg-gray-200",children:"View"})})]},ee.section_id))})]})]})}),m==="section"&&v&&a.jsxs("div",{className:"mb-6 bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-lg font-medium",children:v.section_name}),a.jsxs("div",{className:"text-sm text-gray-600",children:["Date: ",v.date]})]}),a.jsx("div",{children:a.jsx("button",{onClick:()=>g("overall"),className:"px-3 py-1 rounded bg-gray-100",children:"Back"})})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:["Present",a.jsx("br",{}),a.jsx("strong",{className:"text-2xl",children:v.present})]}),a.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:["Absent",a.jsx("br",{}),a.jsx("strong",{className:"text-2xl",children:v.absent})]}),a.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:["OD",a.jsx("br",{}),a.jsx("strong",{className:"text-2xl",children:v.on_duty})]})]})]}),!i&&o&&o.length>0&&a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("div",{className:"text-sm text-gray-700"}),a.jsxs("button",{onClick:oe,className:"flex items-center gap-2 px-3 py-1 text-sm bg-gray-100 rounded hover:bg-gray-200",children:[a.jsx(T2,{className:"w-4 h-4"})," Refresh"]})]}),a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Period"}),a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Subject"}),a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Section"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Present"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Absent"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"OD"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Total"}),a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Status"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Action"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(ee=>{var C,Y;return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:((C=ee.period)==null?void 0:C.label)||((Y=ee.period)==null?void 0:Y.index)||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:ee.subject_display||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:ee.section_name||"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-green-600 font-semibold",children:ee.present??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-red-600 font-semibold",children:ee.absent??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-600",children:ee.on_duty??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-900",children:ee.total_strength??"-"}),a.jsx("td",{className:"px-4 py-3 text-sm",children:ee.attendance_session_locked?a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-red-100 text-red-700",children:[a.jsx(a0,{className:"w-3 h-3 mr-1"}),"Locked"]}):ee.present!==null?a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-50 text-green-700",children:"Saved"}):a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-50 text-gray-700",children:"Not saved"})}),a.jsx("td",{className:"px-4 py-3 text-right",children:a.jsx("button",{onClick:()=>{var q;return V(ee.attendance_session_id||((q=ee.attendance_session)==null?void 0:q.id)||ee.session_id)},className:`px-3 py-1 rounded text-sm ${ee.attendance_session_locked?"bg-indigo-600 text-white hover:bg-indigo-700":"bg-gray-100 text-gray-600 cursor-not-allowed"}`,disabled:!ee.attendance_session_locked,children:"Request Unlock"})})]},ee.id||ee.session_id)})})]})]})}),!e&&(!r||r.periods.length===0)&&a.jsx("div",{className:"text-gray-600 py-6",children:"No periods available for today."})]})};function VOe(){const[e,t]=x.useState(""),[r,n]=x.useState(""),[i,s]=x.useState([]),[o,l]=x.useState(null),[c,u]=x.useState(!1);x.useEffect(()=>{const p=new Date,m=p.toISOString().slice(0,10),g=new Date(p.getTime()-1e3*60*60*24*30).toISOString().slice(0,10);t(g),n(m)},[]),x.useEffect(()=>{e&&r&&d()},[e,r]);async function d(){u(!0);try{const p=`?start_date=${e}&end_date=${r}`;console.log("Fetching student attendance:",{startDate:e,endDate:r,url:`/api/academics/student/attendance/${p}`});const m=await mr(`/api/academics/student/attendance/${p}`);if(!m.ok){const y=await m.text();throw console.error("Failed to fetch attendance:",m.status,y),new Error(`Failed to fetch (${m.status})`)}const g=await m.json();console.log("Student attendance response:",{recordCount:(g.results||[]).length,summary:g.summary,records:g.results}),s(g.results||[]),l(g.summary||null)}catch(p){console.error("fetchRecords error:",p),s([]),alert("Failed to load attendance records: "+(p instanceof Error?p.message:String(p)))}finally{u(!1)}}function f(p){switch(p){case"P":return"bg-green-100 text-green-800 border-green-200";case"A":return"bg-red-100 text-red-800 border-red-200";case"LEAVE":return"bg-blue-100 text-blue-800 border-blue-200";case"OD":return"bg-purple-100 text-purple-800 border-purple-200";case"LATE":return"bg-amber-100 text-amber-800 border-amber-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}}function h(p){switch(p){case"P":return a.jsx(Ld,{className:"h-3.5 w-3.5"});case"A":return a.jsx(b3,{className:"h-3.5 w-3.5"});default:return a.jsx(ed,{className:"h-3.5 w-3.5"})}}return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6 border border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl",children:a.jsx(Ld,{className:"h-6 w-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Attendance"}),a.jsx("p",{className:"text-gray-600",children:"View your attendance records and statistics"})]})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6 border border-gray-100",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(xs,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Select Date Range"})]}),a.jsxs("div",{className:"flex flex-wrap items-end gap-4",children:[a.jsxs("div",{className:"flex-1 min-w-[200px]",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"From Date"}),a.jsx("input",{type:"date",value:e,onChange:p=>t(p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),a.jsxs("div",{className:"flex-1 min-w-[200px]",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"To Date"}),a.jsx("input",{type:"date",value:r,onChange:p=>n(p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),a.jsx("button",{onClick:d,disabled:c,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:bg-indigo-300 transition-colors font-medium flex items-center gap-2",children:c?a.jsxs(a.Fragment,{children:[a.jsx(Gu,{className:"h-4 w-4 animate-spin"}),"Loading..."]}):a.jsxs(a.Fragment,{children:[a.jsx(xs,{className:"h-4 w-4"}),"Refresh"]})})]}),!c&&i.length>0&&a.jsxs("div",{className:"mt-3 text-sm text-gray-600 flex items-center gap-2",children:[a.jsx(Ld,{className:"h-4 w-4 text-green-600"}),"Showing ",i.length," attendance record",i.length!==1?"s":""," from ",e," to ",r]})]}),c?a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-8 border border-gray-100",children:a.jsx("div",{className:"text-center",children:a.jsxs("div",{className:"inline-flex items-center gap-2 text-gray-600",children:[a.jsx(Gu,{className:"animate-spin h-5 w-5 text-indigo-600"}),a.jsx("span",{children:"Loading attendance records..."})]})})}):a.jsx("div",{children:i.length===0?a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-8 border border-gray-100",children:a.jsxs("div",{className:"text-center",children:[a.jsx(ed,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Records Found"}),a.jsx("p",{className:"text-gray-600",children:"No attendance records found for the selected date range."})]})}):a.jsxs("div",{className:"space-y-6",children:[o&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx($te,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Overall Attendance"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg p-4 border border-green-200",children:[a.jsx("div",{className:"text-sm text-green-700 font-medium mb-1",children:"Attendance Rate"}),a.jsx("div",{className:"text-3xl font-bold text-green-900",children:o.overall.percentage!=null?`${o.overall.percentage.toFixed(1)}%`:"N/A"})]}),a.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg p-4 border border-blue-200",children:[a.jsx("div",{className:"text-sm text-blue-700 font-medium mb-1",children:"Present"}),a.jsx("div",{className:"text-3xl font-bold text-blue-900",children:o.overall.present})]}),a.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg p-4 border border-purple-200",children:[a.jsx("div",{className:"text-sm text-purple-700 font-medium mb-1",children:"Total Periods"}),a.jsx("div",{className:"text-3xl font-bold text-purple-900",children:o.overall.total_marked_periods})]})]})]}),o&&o.by_subject&&o.by_subject.length>0&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(gs,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Subject-wise Breakdown"})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.by_subject.map(p=>{const m=p.percentage!=null?p.percentage:0,g=p.counts||{};return a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[a.jsxs("div",{className:"flex justify-between items-start mb-3",children:[a.jsx("div",{className:"font-semibold text-gray-900",children:p.subject_display||p.subject_key}),a.jsx("div",{className:"text-lg font-bold text-indigo-600",children:m!=null?`${m.toFixed(1)}%`:"N/A"})]}),a.jsx("div",{className:"h-2.5 bg-gray-200 rounded-full overflow-hidden mb-3",children:a.jsx("div",{className:`h-full transition-all ${m>=75?"bg-green-500":m>=50?"bg-amber-500":"bg-red-500"}`,style:{width:`${Math.max(0,Math.min(100,m))}%`}})}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded border border-green-200",children:["P: ",g.P||0]}),a.jsxs("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs font-medium rounded border border-red-200",children:["A: ",g.A||0]}),a.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded border border-blue-200",children:["LEAVE: ",g.LEAVE||0]}),a.jsxs("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs font-medium rounded border border-purple-200",children:["OD: ",g.OD||0]}),a.jsxs("span",{className:"px-2 py-1 bg-amber-100 text-amber-800 text-xs font-medium rounded border border-amber-200",children:["LATE: ",g.LATE||0]})]})]},p.subject_key)})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sc,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Attendance Records"})]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Date"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Period"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Section"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Subject"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Status"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Marked By"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:i.map(p=>{var m,g,y;return a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(xs,{className:"h-4 w-4 text-gray-400"}),p.date]})}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:((m=p.period)==null?void 0:m.label)||((g=p.period)!=null&&g.index?`Period ${p.period.index}`:"")}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:((y=p.section)==null?void 0:y.name)||""}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 font-medium",children:p.subject_display||""}),a.jsx("td",{className:"px-6 py-4 text-sm",children:a.jsxs("span",{className:`inline-flex items-center gap-1 px-2.5 py-1 rounded-md text-xs font-medium border ${f(p.status)}`,children:[h(p.status),p.status]})}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(W0,{className:"h-3.5 w-3.5 text-gray-400"}),p.marked_by||""]})})]},p.id)})})]})})]})]})})]})})}function GOe(){const[e,t]=x.useState(!0),[r,n]=x.useState(null),[i,s]=x.useState("cycle1");x.useEffect(()=>{let l=!0;return(async()=>{t(!0);try{const c=await mr("/api/academics/student/marks/");if(!l)return;if(!c.ok){n(null);return}const u=await c.json();l&&n(u)}catch{l&&n(null)}finally{l&&t(!1)}})(),()=>{l=!1}},[]);const o=Array.isArray(r==null?void 0:r.courses)?r.courses:[];return a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"max-w-4xl",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Academics"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Your subject marks (personal view)."}),a.jsx("div",{className:"mt-6 bg-white shadow rounded p-4",children:e?a.jsx("div",{className:"text-gray-600",children:"Loading marks"}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex gap-2 mb-4",children:[a.jsx("button",{onClick:()=>s("cycle1"),className:`px-3 py-1 rounded ${i==="cycle1"?"bg-blue-500 text-white":"bg-gray-100"}`,children:"Cycle I"}),a.jsx("button",{onClick:()=>s("cycle2"),className:`px-3 py-1 rounded ${i==="cycle2"?"bg-blue-500 text-white":"bg-gray-100"}`,children:"Cycle II"})]}),a.jsx("div",{className:"space-y-4",children:o.length===0?a.jsx("div",{className:"text-gray-600",children:"No courses found for your semester."}):o.map(l=>{var h;const c=l.marks||{},u=i==="cycle1"?c.cia1:c.cia2,d=((h=c.internal)==null?void 0:h.computed)??null,f=!!c.has_cqi;return a.jsxs("div",{className:"p-3 border rounded",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"font-semibold",children:[l.code,"  ",l.name]}),a.jsx("div",{className:"text-sm text-gray-500",children:r!=null&&r.semester?`Semester ${r.semester.number}`:""})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"text-sm text-gray-600",children:["CIA: ",a.jsx("span",{className:"font-medium",children:u!=null?String(u):""})]}),a.jsxs("div",{className:"text-sm text-gray-600",children:["Internal: ",a.jsx("span",{className:"font-medium",children:d!==null?String(d):""})]}),f?a.jsx("div",{className:"text-sm text-green-700",children:"CQI available"}):null]})]}),a.jsxs("div",{className:"mt-3 h-3 bg-gray-100 rounded overflow-hidden",children:[a.jsx("div",{style:{width:`${u?Math.min(100,Number(u)):0}%`},className:"h-3 bg-blue-400 inline-block"}),a.jsx("div",{style:{width:`${d?Math.min(100,Number(d)):0}%`},className:"h-3 bg-yellow-400 inline-block"}),f?a.jsx("div",{style:{width:"6%"},className:"h-3 bg-green-500 inline-block"}):null]})]},l.id)})})]})})]})})}const Ag="";async function KOe(){const e=await mr(`${Ag}/api/academics/mentor/staff/`);return e.ok?e.json():{results:[]}}async function YOe(e){const t=await mr(`${Ag}/api/academics/mentor/staff/${e}/students/`);return t.ok?t.json():{results:[]}}async function XOe(e,t){return await mr(`${Ag}/api/academics/mentor/map/`,{method:"POST",body:JSON.stringify({mentor_id:e,student_ids:t})})}async function rB(){const e=await mr(`${Ag}/api/academics/my-students/`);return e.ok?e.json():{results:[]}}async function QOe(e,t){const r={student_ids:[e]};return t&&(r.mentor_id=t),await mr(`${Ag}/api/academics/mentor/unmap/`,{method:"POST",body:JSON.stringify(r)})}async function JOe(){const e=await mr(`${Ag}/api/academics/mentor/my-mentees/`);return e.ok?e.json():{results:[]}}function ZOe(){const[e,t]=x.useState([]),[r,n]=x.useState(null),[i,s]=x.useState([]),[o,l]=x.useState([]),[c,u]=x.useState(!1);x.useEffect(()=>{d()},[]);async function d(){const y=await KOe();t(y.results||[])}async function f(){const b=(await rB()).results||[],v=[];b.forEach(w=>{(w.students||[]).forEach(j=>v.push(j))}),s(v)}async function h(y){n(y),l([]),s([]);const v=(await YOe(y)).results||[],S=(await rB()).results||[],j=[];S.forEach(R=>{(R.students||[]).forEach(B=>j.push(B))});const k=new Set(v.map(R=>R.id)),A=j.filter(R=>!k.has(R.id)&&!R.has_mentor);l(v),s(A)}async function p(y){if(!r)return alert("Select a mentor first");u(!0);const b=await XOe(r,[y]);if(b.ok)await f(),r&&await h(r);else{const v=await b.json().catch(()=>null);alert("Failed: "+(v&&v.detail?v.detail:b.statusText))}u(!1)}async function m(y){if(!r)return;u(!0);const b=await QOe(y,r);if(b.ok)await f(),r&&await h(r);else{const v=await b.json().catch(()=>null);alert("Failed to remove: "+(v&&v.detail?v.detail:b.statusText))}u(!1)}const g=e.find(y=>y.id===r);return a.jsxs("div",{className:"min-h-screen p-4 md:p-6 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-6 border border-slate-200",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 p-3 rounded-xl shadow-lg",children:a.jsx($v,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Mentor Assignment"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"Assign and manage mentor mappings for your students"})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6",children:[a.jsx("div",{className:"lg:col-span-2",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[a.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-slate-50",children:a.jsxs("h3",{className:"text-lg font-semibold text-slate-900 flex items-center gap-2",children:[a.jsx(ys,{className:"w-5 h-5 text-indigo-600"}),"Staff Members",a.jsx("span",{className:"ml-auto px-2.5 py-0.5 bg-indigo-100 text-indigo-700 text-xs font-medium rounded-full",children:e.length})]})}),a.jsx("div",{className:"p-4 max-h-[600px] overflow-y-auto",children:e.length===0?a.jsx("div",{className:"text-center py-8 text-slate-500",children:"No staff members available"}):a.jsx("div",{className:"space-y-2",children:e.map(y=>a.jsx("div",{className:`p-4 rounded-lg border transition-all cursor-pointer ${r===y.id?"bg-gradient-to-r from-indigo-50 to-blue-50 border-indigo-300 shadow-md":"bg-white border-slate-200 hover:border-indigo-200 hover:shadow-sm"}`,onClick:()=>h(y.id),children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:`font-medium ${r===y.id?"text-indigo-900":"text-slate-900"}`,children:y.username}),a.jsx("div",{className:"text-sm text-slate-600 mt-1",children:a.jsx("span",{className:"font-mono",children:y.staff_id||"N/A"})})]}),a.jsxs("button",{onClick:b=>{b.stopPropagation(),h(y.id)},className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5 ${r===y.id?"bg-indigo-600 text-white":"bg-indigo-100 text-indigo-700 hover:bg-indigo-200"}`,children:[a.jsx(a9,{className:"w-4 h-4"}),"View"]})]})},y.id))})})]})}),a.jsx("div",{className:"lg:col-span-3",children:r?a.jsxs("div",{className:"space-y-6",children:[g&&a.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl p-4 shadow-lg",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx($v,{className:"w-6 h-6"}),a.jsxs("div",{children:[a.jsxs("div",{className:"font-semibold",children:["Selected Mentor: ",g.username]}),a.jsxs("div",{className:"text-sm opacity-90",children:["Staff ID: ",g.staff_id||"N/A"]})]})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[a.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-green-50",children:a.jsxs("h4",{className:"text-base font-semibold text-green-900 flex items-center gap-2",children:[a.jsx(Lm,{className:"w-5 h-5 text-green-700"}),"Assigned Students",a.jsx("span",{className:"ml-auto px-2.5 py-0.5 bg-green-200 text-green-800 text-xs font-medium rounded-full",children:o.length})]})}),a.jsx("div",{className:"p-4 max-h-[300px] overflow-y-auto",children:o.length>0?a.jsx("div",{className:"space-y-2",children:o.map(y=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg hover:bg-slate-100 transition-colors",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"text-sm font-medium text-slate-900",children:[y.reg_no,"  ",y.username]}),a.jsx("div",{className:"text-xs text-slate-600 mt-0.5",children:y.section_name})]}),a.jsxs("button",{className:"px-3 py-1.5 bg-red-600 hover:bg-red-700 disabled:bg-red-300 text-white rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5",onClick:()=>m(y.id),disabled:c,children:[a.jsx(Vte,{className:"w-4 h-4"}),"Remove"]})]},y.id))}):a.jsx("div",{className:"text-center py-8 text-slate-500",children:"No students currently assigned to this mentor"})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[a.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-blue-50",children:a.jsxs("h4",{className:"text-base font-semibold text-blue-900 flex items-center gap-2",children:[a.jsx(ys,{className:"w-5 h-5 text-blue-700"}),"Available to Assign",a.jsx("span",{className:"ml-auto px-2.5 py-0.5 bg-blue-200 text-blue-800 text-xs font-medium rounded-full",children:i.length})]})}),a.jsx("div",{className:"p-4 max-h-[300px] overflow-y-auto",children:i.length>0?a.jsx("div",{className:"space-y-2",children:i.map(y=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg hover:bg-slate-100 transition-colors",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"text-sm font-medium text-slate-900",children:[y.reg_no,"  ",y.username]}),a.jsx("div",{className:"text-xs text-slate-600 mt-0.5",children:y.section_name})]}),a.jsxs("button",{className:"px-3 py-1.5 bg-green-600 hover:bg-green-700 disabled:bg-green-300 text-white rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5",onClick:()=>p(y.id),disabled:c||!r,children:[c?a.jsx(Gu,{className:"w-4 h-4 animate-spin"}):a.jsx(qte,{className:"w-4 h-4"}),"Assign"]})]},y.id))}):a.jsx("div",{className:"text-center py-8 text-slate-500",children:"No available students to assign"})})]})]}):a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-12",children:a.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[a.jsx("div",{className:"bg-slate-100 p-4 rounded-full mb-4",children:a.jsx($v,{className:"w-16 h-16 text-slate-400"})}),a.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-1",children:"Select a Staff Member"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"Click on a staff member to view and manage their mentee assignments"})]})})})]})]})}function eMe(){const[e,t]=x.useState([]),[r,n]=x.useState(!1);x.useEffect(()=>{i()},[]);async function i(){n(!0);try{const s=await JOe();t(s.results||[])}catch(s){console.error(s),alert("Failed to load mentees")}finally{n(!1)}}return a.jsxs("div",{className:"min-h-screen p-4 md:p-6 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-6 border border-slate-200",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 p-3 rounded-xl shadow-lg",children:a.jsx(ys,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"My Mentees"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"Students assigned to you as mentor"})]})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[a.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-slate-50",children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("h2",{className:"text-lg font-semibold text-slate-900 flex items-center gap-2",children:[a.jsx($v,{className:"w-5 h-5 text-indigo-600"}),"Mentees List",!r&&e.length>0&&a.jsx("span",{className:"ml-2 px-2.5 py-0.5 bg-indigo-100 text-indigo-700 text-xs font-medium rounded-full",children:e.length})]})})}),a.jsxs("div",{className:"p-6",children:[r&&a.jsxs("div",{className:"flex items-center justify-center py-12",children:[a.jsx(Gu,{className:"w-8 h-8 text-indigo-600 animate-spin"}),a.jsx("span",{className:"ml-3 text-slate-600",children:"Loading mentees..."})]}),!r&&e.length===0&&a.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[a.jsx("div",{className:"bg-slate-100 p-4 rounded-full mb-4",children:a.jsx(ys,{className:"w-12 h-12 text-slate-400"})}),a.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-1",children:"No Mentees Assigned"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"You don't have any students assigned as mentees yet."})]}),!r&&e.length>0&&a.jsx("div",{children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-slate-200",children:[a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Reg No"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Name"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Section"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-200",children:e.map(s=>a.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"text-sm font-medium text-slate-900",children:s.reg_no})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"text-sm text-slate-700",children:s.username})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-md text-xs font-medium bg-blue-100 text-blue-800",children:s.section_name||"N/A"})})]},s.id))})]})})]})]})]})}async function tMe(){var t;return((t=(await Uo.get("notification-templates/")).data)==null?void 0:t.templates)||[]}async function rMe(e){return(await Uo.put("notification-templates/",{templates:e})).data}const jv=[{label:"{otp}",value:"{otp}",description:"Auto-generated OTP code",category:"auth"},{label:"{username}",value:"{username}",description:"User's username",category:"user"},{label:"{email}",value:"{email}",description:"User's email",category:"user"},{label:"{mobile}",value:"{mobile}",description:"Mobile number",category:"user"},{label:"{name}",value:"{name}",description:"Full name",category:"user"},{label:"{expiry}",value:"{expiry}",description:"OTP/time expiry",category:"time"},{label:"{subject}",value:"{subject}",description:"Subject/course name",category:"academic"},{label:"{assessment}",value:"{assessment}",description:"Assessment type (CIA1, CIA2, etc.)",category:"academic"},{label:"{percentage}",value:"{percentage}",description:"Percentage value",category:"academic"},{label:"{time}",value:"{time}",description:"Timestamp",category:"time"},{label:"{date}",value:"{date}",description:"Date",category:"time"}],Ak=[{id:"mobile_verify",name:"Mobile Number Verification OTP",template:"Your OTP is {otp}. It is valid for {expiry} minutes. - IQAC",enabled:!0,expiry_minutes:5},{id:"password_reset",name:"Password Reset OTP",template:"Hello {username}, your password reset OTP is {otp}. Valid for {expiry} minutes. - IQAC",enabled:!1,expiry_minutes:10},{id:"login_alert",name:"Login Alert Notification",template:"Hello {name}, a login was detected on your account from a new device at {time}.",enabled:!1},{id:"obe_approval",name:"OBE Edit Request Approved",template:"Your OBE edit request for {subject} ({assessment}) has been approved. Edit until: {expiry}",enabled:!1},{id:"attendance_alert",name:"Low Attendance Alert",template:"Dear {name}, your attendance is {percentage}% in {subject}. Please improve to meet requirements.",enabled:!1}];function nMe(){const[e,t]=x.useState(Ak),[r,n]=x.useState("mobile_verify"),[i,s]=x.useState(null),[o,l]=x.useState(!0),[c,u]=x.useState(null),d=e.find(S=>S.id===r),f=x.useMemo(()=>{const S=d==null?void 0:d.expiry_minutes;return typeof S=="number"&&Number.isFinite(S)&&S>0?String(S):"5"},[d]);x.useEffect(()=>{let S=!0;return l(!0),u(null),tMe().then(j=>{var k;if(S&&j&&j.length){const A=new Map(j.map(P=>[P.code,{id:P.code,name:P.name,template:P.template,enabled:!!P.enabled,expiry_minutes:P.expiry_minutes??null,updated_at:P.updated_at}])),R=Ak.map(P=>A.get(P.id)||P),M=j.filter(P=>!Ak.some(U=>U.id===P.code)).map(P=>A.get(P.code)).filter(Boolean),B=[...R,...M];t(B);const E=B.some(P=>P.id==="mobile_verify")?"mobile_verify":((k=B[0])==null?void 0:k.id)||null;n(E)}}).catch(j=>{var k,A;S&&u(String(((A=(k=j==null?void 0:j.response)==null?void 0:k.data)==null?void 0:A.detail)||(j==null?void 0:j.message)||j||"Failed to load templates"))}).finally(()=>{S&&l(!1)}),()=>{S=!1}},[]);const h=S=>{r&&t(j=>j.map(k=>k.id===r?{...k,template:k.template+" "+S}:k))},p=(S,j)=>{t(k=>k.map(A=>A.id===S?{...A,template:j}:A))},m=S=>{t(j=>j.map(k=>k.id===S?{...k,enabled:!k.enabled}:k))},g=async()=>{var S,j;s("saving");try{await rMe(e.map(k=>({code:k.id,name:k.name,template:k.template,enabled:!!k.enabled,expiry_minutes:k.expiry_minutes??null,updated_at:k.updated_at}))),s("saved"),setTimeout(()=>s(null),2e3)}catch(k){s("error"),setTimeout(()=>s(null),2500),alert(String(((j=(S=k==null?void 0:k.response)==null?void 0:S.data)==null?void 0:j.detail)||(k==null?void 0:k.message)||k||"Failed to save"))}},y=()=>{const S=`template_${Date.now()}`,j={id:S,name:"New Message Template",template:"Enter your message here...",enabled:!1,expiry_minutes:null};t(k=>[...k,j]),n(S)},b=S=>{var j;confirm("Are you sure you want to delete this template?")&&(t(k=>k.filter(A=>A.id!==S)),r===S&&n(((j=e[0])==null?void 0:j.id)||null))},v=(S,j)=>{t(k=>k.map(A=>A.id===S?{...A,name:j}:A))},w=(S,j)=>{const k=String(j??"").trim(),A=k===""?null:Number(k);t(R=>R.map(M=>M.id!==S?M:A===null?{...M,expiry_minutes:null}:!Number.isFinite(A)||A<=0?M:{...M,expiry_minutes:Math.floor(A)}))};return a.jsx(t0,{children:a.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[a.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Cx,{className:"w-8 h-8 text-blue-600"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Notification Templates"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Configure message templates for OTP, alerts, and notifications"})]})]}),a.jsxs("button",{onClick:y,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx(Rm,{className:"w-4 h-4"}),"Add Template"]})]}),c?a.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-800 rounded-lg p-3 text-sm",children:c}):null,a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[a.jsx("div",{className:"lg:col-span-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[a.jsx("div",{className:"bg-gray-50 px-4 py-3 border-b border-gray-200",children:a.jsx("h2",{className:"font-semibold text-gray-900",children:"Message Templates"})}),a.jsx("div",{className:"divide-y divide-gray-200",children:e.map(S=>a.jsx("div",{onClick:()=>n(S.id),className:`p-4 cursor-pointer transition-colors ${r===S.id?"bg-blue-50 border-l-4 border-blue-600":"hover:bg-gray-50"}`,children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-medium text-gray-900 truncate",children:S.name}),a.jsx("p",{className:"text-xs text-gray-500 mt-1 line-clamp-2",children:S.template})]}),a.jsx("div",{className:"ml-2 flex items-center gap-2",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded ${S.enabled?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"}`,children:S.enabled?"Active":"Inactive"})})]})},S.id))})]})}),a.jsx("div",{className:"lg:col-span-8",children:o?a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 text-gray-600",children:"Loading templates"}):d?a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[a.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("input",{type:"text",value:d.name,onChange:S=>v(d.id,S.target.value),className:"text-lg font-semibold text-gray-900 bg-transparent border-none focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 -mx-2"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>m(d.id),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${d.enabled?"bg-green-600 text-white hover:bg-green-700":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:d.enabled?"Enabled":"Disabled"}),a.jsx("button",{onClick:()=>b(d.id),className:"p-1.5 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Delete template",children:a.jsx(bu,{className:"w-5 h-5"})})]})]})}),a.jsxs("div",{className:"p-6 space-y-6",children:[d.template.includes("{expiry}")?a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-blue-900",children:"Validity Time"}),a.jsxs("div",{className:"text-xs text-blue-800",children:["Controls ","{expiry}"," and OTP expiry minutes."]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"number",min:1,value:String(d.expiry_minutes??""),onChange:S=>w(d.id,S.target.value),className:"w-24 px-3 py-2 border border-blue-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"5"}),a.jsx("span",{className:"text-sm text-blue-900",children:"minutes"})]})]})}):null,a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message Template"}),a.jsx("textarea",{value:d.template,onChange:S=>p(d.id,S.target.value),rows:6,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm",placeholder:"Enter your message template here..."}),a.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Use placeholders from the buttons below to insert dynamic values"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Insert Placeholders"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"User Information"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:jv.filter(S=>S.category==="user").map(S=>a.jsxs("button",{onClick:()=>h(S.value),className:"group relative px-3 py-2 bg-gray-50 hover:bg-blue-50 border border-gray-200 hover:border-blue-300 rounded-lg text-sm font-medium text-gray-700 hover:text-blue-700 transition-all text-left",title:S.description,children:[a.jsx("span",{className:"font-mono",children:S.label}),a.jsxs("div",{className:"hidden group-hover:block absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg whitespace-nowrap z-10",children:[S.description,a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})]})]},S.value))})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"Authentication"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:jv.filter(S=>S.category==="auth").map(S=>a.jsxs("button",{onClick:()=>h(S.value),className:"group relative px-3 py-2 bg-gray-50 hover:bg-blue-50 border border-gray-200 hover:border-blue-300 rounded-lg text-sm font-medium text-gray-700 hover:text-blue-700 transition-all text-left",title:S.description,children:[a.jsx("span",{className:"font-mono",children:S.label}),a.jsxs("div",{className:"hidden group-hover:block absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg whitespace-nowrap z-10",children:[S.description,a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})]})]},S.value))})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"Academic"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:jv.filter(S=>S.category==="academic").map(S=>a.jsxs("button",{onClick:()=>h(S.value),className:"group relative px-3 py-2 bg-gray-50 hover:bg-blue-50 border border-gray-200 hover:border-blue-300 rounded-lg text-sm font-medium text-gray-700 hover:text-blue-700 transition-all text-left",title:S.description,children:[a.jsx("span",{className:"font-mono",children:S.label}),a.jsxs("div",{className:"hidden group-hover:block absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg whitespace-nowrap z-10",children:[S.description,a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})]})]},S.value))})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"Date & Time"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:jv.filter(S=>S.category==="time").map(S=>a.jsxs("button",{onClick:()=>h(S.value),className:"group relative px-3 py-2 bg-gray-50 hover:bg-blue-50 border border-gray-200 hover:border-blue-300 rounded-lg text-sm font-medium text-gray-700 hover:text-blue-700 transition-all text-left",title:S.description,children:[a.jsx("span",{className:"font-mono",children:S.label}),a.jsxs("div",{className:"hidden group-hover:block absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg whitespace-nowrap z-10",children:[S.description,a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})]})]},S.value))})]})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Preview (valid for ",f," minutes)"]}),a.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:a.jsx("div",{className:"text-sm text-gray-700 font-mono whitespace-pre-wrap",children:d.template.replace(/{otp}/g,"123456").replace(/{username}/g,"john_doe").replace(/{email}/g,"john@example.com").replace(/{mobile}/g,"+91XXXXXXXXXX").replace(/{name}/g,"John Doe").replace(/{expiry}/g,f).replace(/{subject}/g,"Mathematics").replace(/{assessment}/g,"CIA1").replace(/{percentage}/g,"75").replace(/{time}/g,new Date().toLocaleTimeString()).replace(/{date}/g,new Date().toLocaleDateString())})}),a.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"This is how your message will look with sample data"})]}),a.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[a.jsx("div",{className:"text-sm text-gray-600",children:i==="saved"&&a.jsx("span",{className:"text-green-600 font-medium",children:" Template saved successfully"})}),a.jsxs("button",{onClick:g,disabled:i==="saving",className:"flex items-center gap-2 px-6 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[a.jsx(rd,{className:"w-4 h-4"}),i==="saving"?"Saving...":"Save Template"]})]})]})]}):a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[a.jsx(Cx,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-500",children:"Select a template from the list or create a new one"})]})})]})]})})}function iMe(){const[e,t]=x.useState(null),[r,n]=x.useState(!0),{collapsed:i}=w3();return x.useEffect(()=>{ah().then(o=>{const l={...o,roles:Array.isArray(o.roles)?o.roles.map(c=>typeof c=="string"?c:c.name):[],permissions:Array.isArray(o.permissions)?o.permissions:[],profile_type:o.profile_type||null,profile:o.profile||null};t(l)}).catch(()=>t(null)).finally(()=>n(!1))},[]),r?a.jsx("div",{className:"flex justify-center items-center h-screen",children:a.jsx("p",{className:"text-gray-600",children:"Loading..."})}):((Array.isArray(e==null?void 0:e.permissions)?e==null?void 0:e.permissions:[]).map(o=>String(o||"").toLowerCase()),a.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-x-hidden",children:[a.jsx(o9,{user:e}),e?a.jsxs("div",{className:"flex",children:[a.jsx(jre,{}),a.jsx("main",{className:`flex-1 min-w-0 transition-all duration-300 pt-20 overflow-x-hidden ${i?"lg:pl-20":"lg:pl-64"}`,children:a.jsx("div",{className:"app-main-zoom",children:a.jsxs(v4,{children:[a.jsx(ei,{path:"/",element:a.jsx(Zp,{to:"/dashboard",replace:!0})}),a.jsx(ei,{path:"/dashboard",element:a.jsx(cOe,{})}),a.jsx(ei,{path:"/profile",element:a.jsx(dOe,{user:e})}),a.jsx(ei,{path:"/notifications",element:a.jsx(nMe,{})}),a.jsx(ei,{path:"/import/questions",element:a.jsx(wOe,{})}),a.jsx(ei,{path:"/curriculum/master",element:a.jsx(fOe,{})}),a.jsx(ei,{path:"/curriculum/master/:id",element:a.jsx(GF,{})}),a.jsx(ei,{path:"/curriculum/master/new",element:a.jsx(GF,{})}),a.jsx(ei,{path:"/curriculum/department",element:a.jsx(hOe,{})}),a.jsx(ei,{path:"/curriculum/elective-import",element:a.jsx(da,{user:e,requiredPermissions:["curriculum.import_elective_choices"],element:a.jsx(pOe,{})})}),a.jsx(ei,{path:"/obe",element:a.jsx(RK,{})}),a.jsx(ei,{path:"/obe/course/:code/lca/cotarget",element:a.jsx(aMe,{})}),a.jsx(ei,{path:"/obe/course/:code/*",element:a.jsx(TOe,{})}),a.jsx(ei,{path:"/obe/request",element:a.jsx(da,{user:e,requiredProfile:"STAFF",element:a.jsx(POe,{})})}),a.jsx(ei,{path:"/obe/master/requests",element:a.jsx(da,{user:e,requiredPermissions:["obe.master.manage"],element:a.jsx(oOe,{})})}),a.jsx(ei,{path:"/obe/master/due-dates",element:a.jsx(da,{user:e,requiredPermissions:["obe.master.manage"],element:a.jsx(k3,{})})}),a.jsx(ei,{path:"/academic",element:a.jsx(bOe,{})}),a.jsx(ei,{path:"/hod/advisors",element:a.jsx(da,{user:e,requiredRoles:["HOD"],requiredPermissions:["academics.assign_advisor"],element:a.jsx(OOe,{})})}),a.jsx(ei,{path:"/hod/obe-requests",element:a.jsx(da,{user:e,requiredRoles:["HOD"],requiredPermissions:["academics.assign_advisor"],element:a.jsx(LOe,{})})}),a.jsx(ei,{path:"/advisor/teaching",element:a.jsx(da,{user:e,requiredRoles:["ADVISOR"],requiredPermissions:["academics.assign_teaching"],element:a.jsx(MOe,{})})}),a.jsx(ei,{path:"/iqac/timetable",element:a.jsx(da,{user:e,requiredPermissions:["timetable.manage_templates"],element:a.jsx(Cre,{})})}),a.jsx(ei,{path:"/iqac/academic-controller",element:a.jsx(da,{user:e,requiredRoles:["IQAC"],requiredPermissions:["obe.master.manage"],element:a.jsx(ane,{})})}),a.jsx(ei,{path:"/iqac/academic-controller/course/:courseCode",element:a.jsx(da,{user:e,requiredRoles:["IQAC"],requiredPermissions:["obe.master.manage"],element:a.jsx(lne,{})})}),a.jsx(ei,{path:"/iqac/academic-controller/course/:courseCode/marks/:taId",element:a.jsx(da,{user:e,requiredRoles:["IQAC"],requiredPermissions:["obe.master.manage"],element:a.jsx(TPe,{})})}),a.jsx(ei,{path:"/iqac/academic-controller/course/:courseCode/internal-mark/:taId",element:a.jsx(da,{user:e,requiredRoles:["IQAC"],requiredPermissions:["obe.master.manage"],element:a.jsx(sOe,{})})}),a.jsx(ei,{path:"/iqac/academic-controller/course/:courseCode/obe/:taId/*",element:a.jsx(da,{user:e,requiredRoles:["IQAC"],requiredPermissions:["obe.master.manage"],element:a.jsx(aOe,{})})}),a.jsx(ei,{path:"/iqac/obe-requests",element:a.jsx(da,{user:e,requiredPermissions:["obe.master.manage"],element:a.jsx(I9,{})})}),a.jsx(ei,{path:"/advisor/timetable",element:a.jsx(da,{user:e,requiredRoles:["ADVISOR"],requiredPermissions:["timetable.assign"],element:a.jsx(Nre,{})})}),a.jsx(ei,{path:"/advisor/students",element:a.jsx(da,{user:e,requiredRoles:["ADVISOR"],requiredPermissions:["academics.view_my_students"],element:a.jsx(ROe,{})})}),a.jsx(ei,{path:"/advisor/mentor",element:a.jsx(da,{user:e,requiredRoles:["ADVISOR"],requiredPermissions:["academics.assign_mentor"],element:a.jsx(ZOe,{})})}),a.jsx(ei,{path:"/student/timetable",element:a.jsx(da,{user:e,requiredProfile:"STUDENT",requiredPermissions:["timetable.view"],element:a.jsx(BOe,{})})}),a.jsx(ei,{path:"/student/attendance",element:a.jsx(da,{user:e,requiredProfile:"STUDENT",element:a.jsx(VOe,{})})}),a.jsx(ei,{path:"/student/academics",element:a.jsx(da,{user:e,requiredProfile:"STUDENT",element:a.jsx(GOe,{})})}),a.jsx(ei,{path:"/staff/timetable",element:a.jsx(da,{user:e,requiredProfile:"STAFF",requiredPermissions:["timetable.view"],element:a.jsx($Oe,{})})}),a.jsx(ei,{path:"/staff/assigned-subjects",element:a.jsx(da,{user:e,requiredProfile:"STAFF",requiredPermissions:["academics.view_assigned_subjects"],element:a.jsx(WOe,{})})}),a.jsx(ei,{path:"/staff/period-attendance",element:a.jsx(da,{user:e,requiredProfile:"STAFF",requiredPermissions:["academics.mark_attendance"],element:a.jsx(qOe,{})})}),a.jsx(ei,{path:"/staff/analytics",element:a.jsx(da,{user:e,requiredProfile:"STAFF",requiredPermissions:["academics.view_all_attendance","academics.view_attendance_overall","academics.view_all_departments","academics.view_department_attendance","academics.view_class_attendance","academics.view_section_attendance"],element:a.jsx(HOe,{})})}),a.jsx(ei,{path:"/staff/mentees",element:a.jsx(da,{user:e,requiredProfile:"STAFF",requiredPermissions:["academics.view_mentees"],element:a.jsx(eMe,{})})}),a.jsx(ei,{path:"*",element:e?a.jsx(Zp,{to:"/dashboard",replace:!0}):a.jsx(vk,{user:e})})]})})})]}):a.jsx("div",{className:"pt-16",children:a.jsxs(v4,{children:[a.jsx(ei,{path:"/",element:e?a.jsx(Zp,{to:"/dashboard",replace:!0}):a.jsx(vk,{user:e})}),a.jsx(ei,{path:"*",element:e?a.jsx(Zp,{to:"/dashboard",replace:!0}):a.jsx(vk,{user:e})})]})})]}))}function aMe(){const{code:e}=z0(),t=e?decodeURIComponent(e):void 0;return a.jsx(TK,{courseCode:t})}function sMe(){const[e,t]=x.useState(""),[r,n]=x.useState(""),[i,s]=x.useState(!1),[o,l]=x.useState(null),[c,u]=x.useState(!1),d=vo();function f(p){if(typeof p!="object"||p===null)return null;const g=p.response;if(!g)return null;const y=g.data;if(!y)return null;const b=y.non_field_errors;return Array.isArray(b)&&b.length>0?String(b[0]):typeof y.detail=="string"?y.detail:null}const h=async p=>{p.preventDefault(),l(null),u(!0);try{await QD(e,r),d("/dashboard")}catch(m){const g=f(m)||"Login failed";l(g)}finally{u(!1)}};return a.jsxs(a.Fragment,{children:[a.jsx(o9,{user:null}),a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:a.jsx("div",{className:"max-w-md w-full",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 sm:p-10",children:[a.jsxs("div",{className:"mb-8 text-center",children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Welcome Back"}),a.jsx("p",{className:"text-gray-600",children:"Sign in to access your account"})]}),a.jsxs("form",{className:"space-y-6",onSubmit:h,children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",htmlFor:"identifier",children:"Email or Register No"}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(v3,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"identifier",type:"text",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"College Email or Reg. No.",value:e,onChange:p=>t(p.target.value),required:!0,disabled:c})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",htmlFor:"password",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(a0,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"password",type:i?"text":"password",className:"block w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"Enter your password",value:r,onChange:p=>n(p.target.value),required:!0,disabled:c}),a.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 transition-colors",onClick:()=>s(!i),"aria-label":i?"Hide password":"Show password",children:i?a.jsx(nte,{className:"h-5 w-5"}):a.jsx(a9,{className:"h-5 w-5"})})]})]}),a.jsx("div",{className:"flex items-center justify-end",children:a.jsx(es,{to:"/forgot-password",className:"text-sm font-medium text-blue-600 hover:text-blue-700 transition-colors",children:"Forgot Password?"})}),o&&a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3",children:[a.jsx(ed,{className:"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-sm text-red-800",children:o})]}),a.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 disabled:opacity-60 disabled:cursor-not-allowed transform hover:scale-[1.02] active:scale-[0.98]",disabled:c,children:c?a.jsxs("span",{className:"flex items-center justify-center gap-2",children:[a.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing In..."]}):"Sign In"}),a.jsx("div",{className:"text-center pt-4",children:a.jsx(es,{to:"/",className:"text-sm text-gray-600 hover:text-gray-900 font-medium transition-colors",children:" Back to Home"})})]})]})})})]})}gD(document.getElementById("root")).render(a.jsx(sn.StrictMode,{children:a.jsx(HJ,{children:a.jsx(ere,{children:a.jsxs(v4,{children:[a.jsx(ei,{path:"/login",element:a.jsx(sMe,{})}),a.jsx(ei,{path:"/*",element:a.jsx(iMe,{})})]})})})}));export{Hi as _,lMe as c,sf as g};
