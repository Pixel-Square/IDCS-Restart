var hY=Object.defineProperty;var pY=(e,t,r)=>t in e?hY(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Oi=(e,t,r)=>pY(e,typeof t!="symbol"?t+"":t,r);function mY(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var cMe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function af(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var rB={exports:{}},Xw={},nB={exports:{}},yi={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var W1=Symbol.for("react.element"),gY=Symbol.for("react.portal"),xY=Symbol.for("react.fragment"),yY=Symbol.for("react.strict_mode"),bY=Symbol.for("react.profiler"),vY=Symbol.for("react.provider"),wY=Symbol.for("react.context"),SY=Symbol.for("react.forward_ref"),_Y=Symbol.for("react.suspense"),kY=Symbol.for("react.memo"),jY=Symbol.for("react.lazy"),dT=Symbol.iterator;function AY(e){return e===null||typeof e!="object"?null:(e=dT&&e[dT]||e["@@iterator"],typeof e=="function"?e:null)}var iB={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},aB=Object.assign,sB={};function Ym(e,t,r){this.props=e,this.context=t,this.refs=sB,this.updater=r||iB}Ym.prototype.isReactComponent={};Ym.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ym.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function oB(){}oB.prototype=Ym.prototype;function hN(e,t,r){this.props=e,this.context=t,this.refs=sB,this.updater=r||iB}var pN=hN.prototype=new oB;pN.constructor=hN;aB(pN,Ym.prototype);pN.isPureReactComponent=!0;var fT=Array.isArray,lB=Object.prototype.hasOwnProperty,mN={current:null},cB={key:!0,ref:!0,__self:!0,__source:!0};function uB(e,t,r){var n,i={},s=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)lB.call(t,n)&&!cB.hasOwnProperty(n)&&(i[n]=t[n]);var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)i[n]===void 0&&(i[n]=l[n]);return{$$typeof:W1,type:e,key:s,ref:o,props:i,_owner:mN.current}}function NY(e,t){return{$$typeof:W1,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function gN(e){return typeof e=="object"&&e!==null&&e.$$typeof===W1}function CY(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var hT=/\/+/g;function p5(e,t){return typeof e=="object"&&e!==null&&e.key!=null?CY(""+e.key):t.toString(36)}function jv(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case W1:case gY:o=!0}}if(o)return o=e,i=i(o),e=n===""?"."+p5(o,0):n,fT(i)?(r="",e!=null&&(r=e.replace(hT,"$&/")+"/"),jv(i,t,r,"",function(u){return u})):i!=null&&(gN(i)&&(i=NY(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(hT,"$&/")+"/")+e)),t.push(i)),1;if(o=0,n=n===""?".":n+":",fT(e))for(var l=0;l<e.length;l++){s=e[l];var c=n+p5(s,l);o+=jv(s,t,r,c,i)}else if(c=AY(e),typeof c=="function")for(e=c.call(e),l=0;!(s=e.next()).done;)s=s.value,c=n+p5(s,l++),o+=jv(s,t,r,c,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function nb(e,t,r){if(e==null)return e;var n=[],i=0;return jv(e,n,"","",function(s){return t.call(r,s,i++)}),n}function EY(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var cl={current:null},Av={transition:null},TY={ReactCurrentDispatcher:cl,ReactCurrentBatchConfig:Av,ReactCurrentOwner:mN};function dB(){throw Error("act(...) is not supported in production builds of React.")}yi.Children={map:nb,forEach:function(e,t,r){nb(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return nb(e,function(){t++}),t},toArray:function(e){return nb(e,function(t){return t})||[]},only:function(e){if(!gN(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};yi.Component=Ym;yi.Fragment=xY;yi.Profiler=bY;yi.PureComponent=hN;yi.StrictMode=yY;yi.Suspense=_Y;yi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=TY;yi.act=dB;yi.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=aB({},e.props),i=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=mN.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)lB.call(t,c)&&!cB.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:W1,type:e.type,key:i,ref:s,props:n,_owner:o}};yi.createContext=function(e){return e={$$typeof:wY,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:vY,_context:e},e.Consumer=e};yi.createElement=uB;yi.createFactory=function(e){var t=uB.bind(null,e);return t.type=e,t};yi.createRef=function(){return{current:null}};yi.forwardRef=function(e){return{$$typeof:SY,render:e}};yi.isValidElement=gN;yi.lazy=function(e){return{$$typeof:jY,_payload:{_status:-1,_result:e},_init:EY}};yi.memo=function(e,t){return{$$typeof:kY,type:e,compare:t===void 0?null:t}};yi.startTransition=function(e){var t=Av.transition;Av.transition={};try{e()}finally{Av.transition=t}};yi.unstable_act=dB;yi.useCallback=function(e,t){return cl.current.useCallback(e,t)};yi.useContext=function(e){return cl.current.useContext(e)};yi.useDebugValue=function(){};yi.useDeferredValue=function(e){return cl.current.useDeferredValue(e)};yi.useEffect=function(e,t){return cl.current.useEffect(e,t)};yi.useId=function(){return cl.current.useId()};yi.useImperativeHandle=function(e,t,r){return cl.current.useImperativeHandle(e,t,r)};yi.useInsertionEffect=function(e,t){return cl.current.useInsertionEffect(e,t)};yi.useLayoutEffect=function(e,t){return cl.current.useLayoutEffect(e,t)};yi.useMemo=function(e,t){return cl.current.useMemo(e,t)};yi.useReducer=function(e,t,r){return cl.current.useReducer(e,t,r)};yi.useRef=function(e){return cl.current.useRef(e)};yi.useState=function(e){return cl.current.useState(e)};yi.useSyncExternalStore=function(e,t,r){return cl.current.useSyncExternalStore(e,t,r)};yi.useTransition=function(){return cl.current.useTransition()};yi.version="18.3.1";nB.exports=yi;var x=nB.exports;const on=af(x),fB=mY({__proto__:null,default:on},[x]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PY=x,OY=Symbol.for("react.element"),MY=Symbol.for("react.fragment"),LY=Object.prototype.hasOwnProperty,RY=PY.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,FY={key:!0,ref:!0,__self:!0,__source:!0};function hB(e,t,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)LY.call(t,n)&&!FY.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:OY,type:e,key:s,ref:o,props:i,_owner:RY.current}}Xw.Fragment=MY;Xw.jsx=hB;Xw.jsxs=hB;rB.exports=Xw;var a=rB.exports,pB={exports:{}},uc={},mB={exports:{}},gB={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(z,G){var ie=z.length;z.push(G);e:for(;0<ie;){var Y=ie-1>>>1,C=z[Y];if(0<i(C,G))z[Y]=G,z[ie]=C,ie=Y;else break e}}function r(z){return z.length===0?null:z[0]}function n(z){if(z.length===0)return null;var G=z[0],ie=z.pop();if(ie!==G){z[0]=ie;e:for(var Y=0,C=z.length,K=C>>>1;Y<K;){var H=2*(Y+1)-1,R=z[H],J=H+1,V=z[J];if(0>i(R,ie))J<C&&0>i(V,R)?(z[Y]=V,z[J]=ie,Y=J):(z[Y]=R,z[H]=ie,Y=H);else if(J<C&&0>i(V,ie))z[Y]=V,z[J]=ie,Y=J;else break e}}return G}function i(z,G){var ie=z.sortIndex-G.sortIndex;return ie!==0?ie:z.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,f=null,h=3,p=!1,m=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(z){for(var G=r(u);G!==null;){if(G.callback===null)n(u);else if(G.startTime<=z)n(u),G.sortIndex=G.expirationTime,t(c,G);else break;G=r(u)}}function S(z){if(g=!1,w(z),!m)if(r(c)!==null)m=!0,se(k);else{var G=r(u);G!==null&&de(S,G.startTime-z)}}function k(z,G){m=!1,g&&(g=!1,b(L),L=-1),p=!0;var ie=h;try{for(w(G),f=r(c);f!==null&&(!(f.expirationTime>G)||z&&!E());){var Y=f.callback;if(typeof Y=="function"){f.callback=null,h=f.priorityLevel;var C=Y(f.expirationTime<=G);G=e.unstable_now(),typeof C=="function"?f.callback=C:f===r(c)&&n(c),w(G)}else n(c);f=r(c)}if(f!==null)var K=!0;else{var H=r(u);H!==null&&de(S,H.startTime-G),K=!1}return K}finally{f=null,h=ie,p=!1}}var j=!1,A=null,L=-1,P=5,F=-1;function E(){return!(e.unstable_now()-F<P)}function T(){if(A!==null){var z=e.unstable_now();F=z;var G=!0;try{G=A(!0,z)}finally{G?B():(j=!1,A=null)}}else j=!1}var B;if(typeof v=="function")B=function(){v(T)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,U=q.port2;q.port1.onmessage=T,B=function(){U.postMessage(null)}}else B=function(){y(T,0)};function se(z){A=z,j||(j=!0,B())}function de(z,G){L=y(function(){z(e.unstable_now())},G)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(z){z.callback=null},e.unstable_continueExecution=function(){m||p||(m=!0,se(k))},e.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<z?Math.floor(1e3/z):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(z){switch(h){case 1:case 2:case 3:var G=3;break;default:G=h}var ie=h;h=G;try{return z()}finally{h=ie}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(z,G){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var ie=h;h=z;try{return G()}finally{h=ie}},e.unstable_scheduleCallback=function(z,G,ie){var Y=e.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?Y+ie:Y):ie=Y,z){case 1:var C=-1;break;case 2:C=250;break;case 5:C=1073741823;break;case 4:C=1e4;break;default:C=5e3}return C=ie+C,z={id:d++,callback:G,priorityLevel:z,startTime:ie,expirationTime:C,sortIndex:-1},ie>Y?(z.sortIndex=ie,t(u,z),r(c)===null&&z===r(u)&&(g?(b(L),L=-1):g=!0,de(S,ie-Y))):(z.sortIndex=C,t(c,z),m||p||(m=!0,se(k))),z},e.unstable_shouldYield=E,e.unstable_wrapCallback=function(z){var G=h;return function(){var ie=h;h=G;try{return z.apply(this,arguments)}finally{h=ie}}}})(gB);mB.exports=gB;var BY=mB.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IY=x,ac=BY;function Jr(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var xB=new Set,Ux={};function $0(e,t){jm(e,t),jm(e+"Capture",t)}function jm(e,t){for(Ux[e]=t,e=0;e<t.length;e++)xB.add(t[e])}var qd=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Aj=Object.prototype.hasOwnProperty,DY=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,pT={},mT={};function $Y(e){return Aj.call(mT,e)?!0:Aj.call(pT,e)?!1:DY.test(e)?mT[e]=!0:(pT[e]=!0,!1)}function UY(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function zY(e,t,r,n){if(t===null||typeof t>"u"||UY(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ul(e,t,r,n,i,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var go={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){go[e]=new ul(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];go[t]=new ul(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){go[e]=new ul(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){go[e]=new ul(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){go[e]=new ul(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){go[e]=new ul(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){go[e]=new ul(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){go[e]=new ul(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){go[e]=new ul(e,5,!1,e.toLowerCase(),null,!1,!1)});var xN=/[\-:]([a-z])/g;function yN(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(xN,yN);go[t]=new ul(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(xN,yN);go[t]=new ul(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(xN,yN);go[t]=new ul(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){go[e]=new ul(e,1,!1,e.toLowerCase(),null,!1,!1)});go.xlinkHref=new ul("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){go[e]=new ul(e,1,!1,e.toLowerCase(),null,!0,!0)});function bN(e,t,r,n){var i=go.hasOwnProperty(t)?go[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(zY(t,r,i,n)&&(r=null),n||i===null?$Y(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var sf=IY.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ib=Symbol.for("react.element"),$p=Symbol.for("react.portal"),Up=Symbol.for("react.fragment"),vN=Symbol.for("react.strict_mode"),Nj=Symbol.for("react.profiler"),yB=Symbol.for("react.provider"),bB=Symbol.for("react.context"),wN=Symbol.for("react.forward_ref"),Cj=Symbol.for("react.suspense"),Ej=Symbol.for("react.suspense_list"),SN=Symbol.for("react.memo"),Mf=Symbol.for("react.lazy"),vB=Symbol.for("react.offscreen"),gT=Symbol.iterator;function Og(e){return e===null||typeof e!="object"?null:(e=gT&&e[gT]||e["@@iterator"],typeof e=="function"?e:null)}var La=Object.assign,m5;function sx(e){if(m5===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);m5=t&&t[1]||""}return`
`+m5+e}var g5=!1;function x5(e,t){if(!e||g5)return"";g5=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var c=`
`+i[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{g5=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?sx(e):""}function WY(e){switch(e.tag){case 5:return sx(e.type);case 16:return sx("Lazy");case 13:return sx("Suspense");case 19:return sx("SuspenseList");case 0:case 2:case 15:return e=x5(e.type,!1),e;case 11:return e=x5(e.type.render,!1),e;case 1:return e=x5(e.type,!0),e;default:return""}}function Tj(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Up:return"Fragment";case $p:return"Portal";case Nj:return"Profiler";case vN:return"StrictMode";case Cj:return"Suspense";case Ej:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case bB:return(e.displayName||"Context")+".Consumer";case yB:return(e._context.displayName||"Context")+".Provider";case wN:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case SN:return t=e.displayName||null,t!==null?t:Tj(e.type)||"Memo";case Mf:t=e._payload,e=e._init;try{return Tj(e(t))}catch{}}return null}function qY(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Tj(t);case 8:return t===vN?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function lh(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function wB(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function HY(e){var t=wB(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ab(e){e._valueTracker||(e._valueTracker=HY(e))}function SB(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=wB(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function r2(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Pj(e,t){var r=t.checked;return La({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function xT(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=lh(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function _B(e,t){t=t.checked,t!=null&&bN(e,"checked",t,!1)}function Oj(e,t){_B(e,t);var r=lh(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Mj(e,t.type,r):t.hasOwnProperty("defaultValue")&&Mj(e,t.type,lh(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function yT(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Mj(e,t,r){(t!=="number"||r2(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var ox=Array.isArray;function am(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+lh(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Lj(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Jr(91));return La({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function bT(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Jr(92));if(ox(r)){if(1<r.length)throw Error(Jr(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:lh(r)}}function kB(e,t){var r=lh(t.value),n=lh(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function vT(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function jB(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Rj(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?jB(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var sb,AB=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(sb=sb||document.createElement("div"),sb.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=sb.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function zx(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var xx={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},VY=["Webkit","ms","Moz","O"];Object.keys(xx).forEach(function(e){VY.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),xx[t]=xx[e]})});function NB(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||xx.hasOwnProperty(e)&&xx[e]?(""+t).trim():t+"px"}function CB(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=NB(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var GY=La({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Fj(e,t){if(t){if(GY[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Jr(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Jr(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Jr(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Jr(62))}}function Bj(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ij=null;function _N(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Dj=null,sm=null,om=null;function wT(e){if(e=V1(e)){if(typeof Dj!="function")throw Error(Jr(280));var t=e.stateNode;t&&(t=tS(t),Dj(e.stateNode,e.type,t))}}function EB(e){sm?om?om.push(e):om=[e]:sm=e}function TB(){if(sm){var e=sm,t=om;if(om=sm=null,wT(e),t)for(e=0;e<t.length;e++)wT(t[e])}}function PB(e,t){return e(t)}function OB(){}var y5=!1;function MB(e,t,r){if(y5)return e(t,r);y5=!0;try{return PB(e,t,r)}finally{y5=!1,(sm!==null||om!==null)&&(OB(),TB())}}function Wx(e,t){var r=e.stateNode;if(r===null)return null;var n=tS(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Jr(231,t,typeof r));return r}var $j=!1;if(qd)try{var Mg={};Object.defineProperty(Mg,"passive",{get:function(){$j=!0}}),window.addEventListener("test",Mg,Mg),window.removeEventListener("test",Mg,Mg)}catch{$j=!1}function KY(e,t,r,n,i,s,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var yx=!1,n2=null,i2=!1,Uj=null,YY={onError:function(e){yx=!0,n2=e}};function XY(e,t,r,n,i,s,o,l,c){yx=!1,n2=null,KY.apply(YY,arguments)}function QY(e,t,r,n,i,s,o,l,c){if(XY.apply(this,arguments),yx){if(yx){var u=n2;yx=!1,n2=null}else throw Error(Jr(198));i2||(i2=!0,Uj=u)}}function U0(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function LB(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ST(e){if(U0(e)!==e)throw Error(Jr(188))}function JY(e){var t=e.alternate;if(!t){if(t=U0(e),t===null)throw Error(Jr(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return ST(i),e;if(s===n)return ST(i),t;s=s.sibling}throw Error(Jr(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o)throw Error(Jr(189))}}if(r.alternate!==n)throw Error(Jr(190))}if(r.tag!==3)throw Error(Jr(188));return r.stateNode.current===r?e:t}function RB(e){return e=JY(e),e!==null?FB(e):null}function FB(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=FB(e);if(t!==null)return t;e=e.sibling}return null}var BB=ac.unstable_scheduleCallback,_T=ac.unstable_cancelCallback,ZY=ac.unstable_shouldYield,eX=ac.unstable_requestPaint,ts=ac.unstable_now,tX=ac.unstable_getCurrentPriorityLevel,kN=ac.unstable_ImmediatePriority,IB=ac.unstable_UserBlockingPriority,a2=ac.unstable_NormalPriority,rX=ac.unstable_LowPriority,DB=ac.unstable_IdlePriority,Qw=null,ed=null;function nX(e){if(ed&&typeof ed.onCommitFiberRoot=="function")try{ed.onCommitFiberRoot(Qw,e,void 0,(e.current.flags&128)===128)}catch{}}var pu=Math.clz32?Math.clz32:sX,iX=Math.log,aX=Math.LN2;function sX(e){return e>>>=0,e===0?32:31-(iX(e)/aX|0)|0}var ob=64,lb=4194304;function lx(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function s2(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~i;l!==0?n=lx(l):(s&=o,s!==0&&(n=lx(s)))}else o=r&~i,o!==0?n=lx(o):s!==0&&(n=lx(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-pu(t),i=1<<r,n|=e[r],t&=~i;return n}function oX(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lX(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-pu(s),l=1<<o,c=i[o];c===-1?(!(l&r)||l&n)&&(i[o]=oX(l,t)):c<=t&&(e.expiredLanes|=l),s&=~l}}function zj(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function $B(){var e=ob;return ob<<=1,!(ob&4194240)&&(ob=64),e}function b5(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function q1(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-pu(t),e[t]=r}function cX(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-pu(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function jN(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-pu(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Gi=0;function UB(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var zB,AN,WB,qB,HB,Wj=!1,cb=[],Xf=null,Qf=null,Jf=null,qx=new Map,Hx=new Map,Bf=[],uX="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function kT(e,t){switch(e){case"focusin":case"focusout":Xf=null;break;case"dragenter":case"dragleave":Qf=null;break;case"mouseover":case"mouseout":Jf=null;break;case"pointerover":case"pointerout":qx.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hx.delete(t.pointerId)}}function Lg(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=V1(t),t!==null&&AN(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function dX(e,t,r,n,i){switch(t){case"focusin":return Xf=Lg(Xf,e,t,r,n,i),!0;case"dragenter":return Qf=Lg(Qf,e,t,r,n,i),!0;case"mouseover":return Jf=Lg(Jf,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return qx.set(s,Lg(qx.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Hx.set(s,Lg(Hx.get(s)||null,e,t,r,n,i)),!0}return!1}function VB(e){var t=Hh(e.target);if(t!==null){var r=U0(t);if(r!==null){if(t=r.tag,t===13){if(t=LB(r),t!==null){e.blockedOn=t,HB(e.priority,function(){WB(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Nv(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=qj(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Ij=n,r.target.dispatchEvent(n),Ij=null}else return t=V1(r),t!==null&&AN(t),e.blockedOn=r,!1;t.shift()}return!0}function jT(e,t,r){Nv(e)&&r.delete(t)}function fX(){Wj=!1,Xf!==null&&Nv(Xf)&&(Xf=null),Qf!==null&&Nv(Qf)&&(Qf=null),Jf!==null&&Nv(Jf)&&(Jf=null),qx.forEach(jT),Hx.forEach(jT)}function Rg(e,t){e.blockedOn===t&&(e.blockedOn=null,Wj||(Wj=!0,ac.unstable_scheduleCallback(ac.unstable_NormalPriority,fX)))}function Vx(e){function t(i){return Rg(i,e)}if(0<cb.length){Rg(cb[0],e);for(var r=1;r<cb.length;r++){var n=cb[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Xf!==null&&Rg(Xf,e),Qf!==null&&Rg(Qf,e),Jf!==null&&Rg(Jf,e),qx.forEach(t),Hx.forEach(t),r=0;r<Bf.length;r++)n=Bf[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Bf.length&&(r=Bf[0],r.blockedOn===null);)VB(r),r.blockedOn===null&&Bf.shift()}var lm=sf.ReactCurrentBatchConfig,o2=!0;function hX(e,t,r,n){var i=Gi,s=lm.transition;lm.transition=null;try{Gi=1,NN(e,t,r,n)}finally{Gi=i,lm.transition=s}}function pX(e,t,r,n){var i=Gi,s=lm.transition;lm.transition=null;try{Gi=4,NN(e,t,r,n)}finally{Gi=i,lm.transition=s}}function NN(e,t,r,n){if(o2){var i=qj(e,t,r,n);if(i===null)E5(e,t,n,l2,r),kT(e,n);else if(dX(i,e,t,r,n))n.stopPropagation();else if(kT(e,n),t&4&&-1<uX.indexOf(e)){for(;i!==null;){var s=V1(i);if(s!==null&&zB(s),s=qj(e,t,r,n),s===null&&E5(e,t,n,l2,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else E5(e,t,n,null,r)}}var l2=null;function qj(e,t,r,n){if(l2=null,e=_N(n),e=Hh(e),e!==null)if(t=U0(e),t===null)e=null;else if(r=t.tag,r===13){if(e=LB(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return l2=e,null}function GB(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(tX()){case kN:return 1;case IB:return 4;case a2:case rX:return 16;case DB:return 536870912;default:return 16}default:return 16}}var zf=null,CN=null,Cv=null;function KB(){if(Cv)return Cv;var e,t=CN,r=t.length,n,i="value"in zf?zf.value:zf.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===i[s-n];n++);return Cv=i.slice(e,1<n?1-n:void 0)}function Ev(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ub(){return!0}function AT(){return!1}function dc(e){function t(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?ub:AT,this.isPropagationStopped=AT,this}return La(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=ub)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=ub)},persist:function(){},isPersistent:ub}),t}var Xm={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},EN=dc(Xm),H1=La({},Xm,{view:0,detail:0}),mX=dc(H1),v5,w5,Fg,Jw=La({},H1,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:TN,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Fg&&(Fg&&e.type==="mousemove"?(v5=e.screenX-Fg.screenX,w5=e.screenY-Fg.screenY):w5=v5=0,Fg=e),v5)},movementY:function(e){return"movementY"in e?e.movementY:w5}}),NT=dc(Jw),gX=La({},Jw,{dataTransfer:0}),xX=dc(gX),yX=La({},H1,{relatedTarget:0}),S5=dc(yX),bX=La({},Xm,{animationName:0,elapsedTime:0,pseudoElement:0}),vX=dc(bX),wX=La({},Xm,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),SX=dc(wX),_X=La({},Xm,{data:0}),CT=dc(_X),kX={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jX={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},AX={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function NX(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=AX[e])?!!t[e]:!1}function TN(){return NX}var CX=La({},H1,{key:function(e){if(e.key){var t=kX[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ev(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?jX[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:TN,charCode:function(e){return e.type==="keypress"?Ev(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ev(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),EX=dc(CX),TX=La({},Jw,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ET=dc(TX),PX=La({},H1,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:TN}),OX=dc(PX),MX=La({},Xm,{propertyName:0,elapsedTime:0,pseudoElement:0}),LX=dc(MX),RX=La({},Jw,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),FX=dc(RX),BX=[9,13,27,32],PN=qd&&"CompositionEvent"in window,bx=null;qd&&"documentMode"in document&&(bx=document.documentMode);var IX=qd&&"TextEvent"in window&&!bx,YB=qd&&(!PN||bx&&8<bx&&11>=bx),TT=" ",PT=!1;function XB(e,t){switch(e){case"keyup":return BX.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function QB(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var zp=!1;function DX(e,t){switch(e){case"compositionend":return QB(t);case"keypress":return t.which!==32?null:(PT=!0,TT);case"textInput":return e=t.data,e===TT&&PT?null:e;default:return null}}function $X(e,t){if(zp)return e==="compositionend"||!PN&&XB(e,t)?(e=KB(),Cv=CN=zf=null,zp=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return YB&&t.locale!=="ko"?null:t.data;default:return null}}var UX={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function OT(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!UX[e.type]:t==="textarea"}function JB(e,t,r,n){EB(n),t=c2(t,"onChange"),0<t.length&&(r=new EN("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var vx=null,Gx=null;function zX(e){cI(e,0)}function Zw(e){var t=Hp(e);if(SB(t))return e}function WX(e,t){if(e==="change")return t}var ZB=!1;if(qd){var _5;if(qd){var k5="oninput"in document;if(!k5){var MT=document.createElement("div");MT.setAttribute("oninput","return;"),k5=typeof MT.oninput=="function"}_5=k5}else _5=!1;ZB=_5&&(!document.documentMode||9<document.documentMode)}function LT(){vx&&(vx.detachEvent("onpropertychange",eI),Gx=vx=null)}function eI(e){if(e.propertyName==="value"&&Zw(Gx)){var t=[];JB(t,Gx,e,_N(e)),MB(zX,t)}}function qX(e,t,r){e==="focusin"?(LT(),vx=t,Gx=r,vx.attachEvent("onpropertychange",eI)):e==="focusout"&&LT()}function HX(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Zw(Gx)}function VX(e,t){if(e==="click")return Zw(t)}function GX(e,t){if(e==="input"||e==="change")return Zw(t)}function KX(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var bu=typeof Object.is=="function"?Object.is:KX;function Kx(e,t){if(bu(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Aj.call(t,i)||!bu(e[i],t[i]))return!1}return!0}function RT(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function FT(e,t){var r=RT(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=RT(r)}}function tI(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?tI(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function rI(){for(var e=window,t=r2();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=r2(e.document)}return t}function ON(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function YX(e){var t=rI(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&tI(r.ownerDocument.documentElement,r)){if(n!==null&&ON(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=FT(r,s);var o=FT(r,n);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var XX=qd&&"documentMode"in document&&11>=document.documentMode,Wp=null,Hj=null,wx=null,Vj=!1;function BT(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Vj||Wp==null||Wp!==r2(n)||(n=Wp,"selectionStart"in n&&ON(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),wx&&Kx(wx,n)||(wx=n,n=c2(Hj,"onSelect"),0<n.length&&(t=new EN("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Wp)))}function db(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var qp={animationend:db("Animation","AnimationEnd"),animationiteration:db("Animation","AnimationIteration"),animationstart:db("Animation","AnimationStart"),transitionend:db("Transition","TransitionEnd")},j5={},nI={};qd&&(nI=document.createElement("div").style,"AnimationEvent"in window||(delete qp.animationend.animation,delete qp.animationiteration.animation,delete qp.animationstart.animation),"TransitionEvent"in window||delete qp.transitionend.transition);function eS(e){if(j5[e])return j5[e];if(!qp[e])return e;var t=qp[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in nI)return j5[e]=t[r];return e}var iI=eS("animationend"),aI=eS("animationiteration"),sI=eS("animationstart"),oI=eS("transitionend"),lI=new Map,IT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function bh(e,t){lI.set(e,t),$0(t,[e])}for(var A5=0;A5<IT.length;A5++){var N5=IT[A5],QX=N5.toLowerCase(),JX=N5[0].toUpperCase()+N5.slice(1);bh(QX,"on"+JX)}bh(iI,"onAnimationEnd");bh(aI,"onAnimationIteration");bh(sI,"onAnimationStart");bh("dblclick","onDoubleClick");bh("focusin","onFocus");bh("focusout","onBlur");bh(oI,"onTransitionEnd");jm("onMouseEnter",["mouseout","mouseover"]);jm("onMouseLeave",["mouseout","mouseover"]);jm("onPointerEnter",["pointerout","pointerover"]);jm("onPointerLeave",["pointerout","pointerover"]);$0("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));$0("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));$0("onBeforeInput",["compositionend","keypress","textInput","paste"]);$0("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));$0("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));$0("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cx="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ZX=new Set("cancel close invalid load scroll toggle".split(" ").concat(cx));function DT(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,QY(n,t,void 0,e),e.currentTarget=null}function cI(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==s&&i.isPropagationStopped())break e;DT(i,l,u),s=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==s&&i.isPropagationStopped())break e;DT(i,l,u),s=c}}}if(i2)throw e=Uj,i2=!1,Uj=null,e}function fa(e,t){var r=t[Qj];r===void 0&&(r=t[Qj]=new Set);var n=e+"__bubble";r.has(n)||(uI(t,e,2,!1),r.add(n))}function C5(e,t,r){var n=0;t&&(n|=4),uI(r,e,n,t)}var fb="_reactListening"+Math.random().toString(36).slice(2);function Yx(e){if(!e[fb]){e[fb]=!0,xB.forEach(function(r){r!=="selectionchange"&&(ZX.has(r)||C5(r,!1,e),C5(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[fb]||(t[fb]=!0,C5("selectionchange",!1,t))}}function uI(e,t,r,n){switch(GB(t)){case 1:var i=hX;break;case 4:i=pX;break;default:i=NN}r=i.bind(null,t,r,e),i=void 0,!$j||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function E5(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Hh(l),o===null)return;if(c=o.tag,c===5||c===6){n=s=o;continue e}l=l.parentNode}}n=n.return}MB(function(){var u=s,d=_N(r),f=[];e:{var h=lI.get(e);if(h!==void 0){var p=EN,m=e;switch(e){case"keypress":if(Ev(r)===0)break e;case"keydown":case"keyup":p=EX;break;case"focusin":m="focus",p=S5;break;case"focusout":m="blur",p=S5;break;case"beforeblur":case"afterblur":p=S5;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=NT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=xX;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=OX;break;case iI:case aI:case sI:p=vX;break;case oI:p=LX;break;case"scroll":p=mX;break;case"wheel":p=FX;break;case"copy":case"cut":case"paste":p=SX;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=ET}var g=(t&4)!==0,y=!g&&e==="scroll",b=g?h!==null?h+"Capture":null:h;g=[];for(var v=u,w;v!==null;){w=v;var S=w.stateNode;if(w.tag===5&&S!==null&&(w=S,b!==null&&(S=Wx(v,b),S!=null&&g.push(Xx(v,S,w)))),y)break;v=v.return}0<g.length&&(h=new p(h,m,null,r,d),f.push({event:h,listeners:g}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",h&&r!==Ij&&(m=r.relatedTarget||r.fromElement)&&(Hh(m)||m[Hd]))break e;if((p||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,p?(m=r.relatedTarget||r.toElement,p=u,m=m?Hh(m):null,m!==null&&(y=U0(m),m!==y||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=u),p!==m)){if(g=NT,S="onMouseLeave",b="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(g=ET,S="onPointerLeave",b="onPointerEnter",v="pointer"),y=p==null?h:Hp(p),w=m==null?h:Hp(m),h=new g(S,v+"leave",p,r,d),h.target=y,h.relatedTarget=w,S=null,Hh(d)===u&&(g=new g(b,v+"enter",m,r,d),g.target=w,g.relatedTarget=y,S=g),y=S,p&&m)t:{for(g=p,b=m,v=0,w=g;w;w=hp(w))v++;for(w=0,S=b;S;S=hp(S))w++;for(;0<v-w;)g=hp(g),v--;for(;0<w-v;)b=hp(b),w--;for(;v--;){if(g===b||b!==null&&g===b.alternate)break t;g=hp(g),b=hp(b)}g=null}else g=null;p!==null&&$T(f,h,p,g,!1),m!==null&&y!==null&&$T(f,y,m,g,!0)}}e:{if(h=u?Hp(u):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var k=WX;else if(OT(h))if(ZB)k=GX;else{k=HX;var j=qX}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(k=VX);if(k&&(k=k(e,u))){JB(f,k,r,d);break e}j&&j(e,h,u),e==="focusout"&&(j=h._wrapperState)&&j.controlled&&h.type==="number"&&Mj(h,"number",h.value)}switch(j=u?Hp(u):window,e){case"focusin":(OT(j)||j.contentEditable==="true")&&(Wp=j,Hj=u,wx=null);break;case"focusout":wx=Hj=Wp=null;break;case"mousedown":Vj=!0;break;case"contextmenu":case"mouseup":case"dragend":Vj=!1,BT(f,r,d);break;case"selectionchange":if(XX)break;case"keydown":case"keyup":BT(f,r,d)}var A;if(PN)e:{switch(e){case"compositionstart":var L="onCompositionStart";break e;case"compositionend":L="onCompositionEnd";break e;case"compositionupdate":L="onCompositionUpdate";break e}L=void 0}else zp?XB(e,r)&&(L="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(L="onCompositionStart");L&&(YB&&r.locale!=="ko"&&(zp||L!=="onCompositionStart"?L==="onCompositionEnd"&&zp&&(A=KB()):(zf=d,CN="value"in zf?zf.value:zf.textContent,zp=!0)),j=c2(u,L),0<j.length&&(L=new CT(L,e,null,r,d),f.push({event:L,listeners:j}),A?L.data=A:(A=QB(r),A!==null&&(L.data=A)))),(A=IX?DX(e,r):$X(e,r))&&(u=c2(u,"onBeforeInput"),0<u.length&&(d=new CT("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=A))}cI(f,t)})}function Xx(e,t,r){return{instance:e,listener:t,currentTarget:r}}function c2(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Wx(e,r),s!=null&&n.unshift(Xx(e,s,i)),s=Wx(e,t),s!=null&&n.push(Xx(e,s,i))),e=e.return}return n}function hp(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function $T(e,t,r,n,i){for(var s=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,i?(c=Wx(r,s),c!=null&&o.unshift(Xx(r,c,l))):i||(c=Wx(r,s),c!=null&&o.push(Xx(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var eQ=/\r\n?/g,tQ=/\u0000|\uFFFD/g;function UT(e){return(typeof e=="string"?e:""+e).replace(eQ,`
`).replace(tQ,"")}function hb(e,t,r){if(t=UT(t),UT(e)!==t&&r)throw Error(Jr(425))}function u2(){}var Gj=null,Kj=null;function Yj(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Xj=typeof setTimeout=="function"?setTimeout:void 0,rQ=typeof clearTimeout=="function"?clearTimeout:void 0,zT=typeof Promise=="function"?Promise:void 0,nQ=typeof queueMicrotask=="function"?queueMicrotask:typeof zT<"u"?function(e){return zT.resolve(null).then(e).catch(iQ)}:Xj;function iQ(e){setTimeout(function(){throw e})}function T5(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),Vx(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Vx(t)}function Zf(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function WT(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Qm=Math.random().toString(36).slice(2),Ku="__reactFiber$"+Qm,Qx="__reactProps$"+Qm,Hd="__reactContainer$"+Qm,Qj="__reactEvents$"+Qm,aQ="__reactListeners$"+Qm,sQ="__reactHandles$"+Qm;function Hh(e){var t=e[Ku];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Hd]||r[Ku]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=WT(e);e!==null;){if(r=e[Ku])return r;e=WT(e)}return t}e=r,r=e.parentNode}return null}function V1(e){return e=e[Ku]||e[Hd],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Hp(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Jr(33))}function tS(e){return e[Qx]||null}var Jj=[],Vp=-1;function vh(e){return{current:e}}function ga(e){0>Vp||(e.current=Jj[Vp],Jj[Vp]=null,Vp--)}function ca(e,t){Vp++,Jj[Vp]=e.current,e.current=t}var ch={},Uo=vh(ch),Al=vh(!1),h0=ch;function Am(e,t){var r=e.type.contextTypes;if(!r)return ch;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Nl(e){return e=e.childContextTypes,e!=null}function d2(){ga(Al),ga(Uo)}function qT(e,t,r){if(Uo.current!==ch)throw Error(Jr(168));ca(Uo,t),ca(Al,r)}function dI(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(Jr(108,qY(e)||"Unknown",i));return La({},r,n)}function f2(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ch,h0=Uo.current,ca(Uo,e),ca(Al,Al.current),!0}function HT(e,t,r){var n=e.stateNode;if(!n)throw Error(Jr(169));r?(e=dI(e,t,h0),n.__reactInternalMemoizedMergedChildContext=e,ga(Al),ga(Uo),ca(Uo,e)):ga(Al),ca(Al,r)}var Nd=null,rS=!1,P5=!1;function fI(e){Nd===null?Nd=[e]:Nd.push(e)}function oQ(e){rS=!0,fI(e)}function wh(){if(!P5&&Nd!==null){P5=!0;var e=0,t=Gi;try{var r=Nd;for(Gi=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Nd=null,rS=!1}catch(i){throw Nd!==null&&(Nd=Nd.slice(e+1)),BB(kN,wh),i}finally{Gi=t,P5=!1}}return null}var Gp=[],Kp=0,h2=null,p2=0,Oc=[],Mc=0,p0=null,Od=1,Md="";function Bh(e,t){Gp[Kp++]=p2,Gp[Kp++]=h2,h2=e,p2=t}function hI(e,t,r){Oc[Mc++]=Od,Oc[Mc++]=Md,Oc[Mc++]=p0,p0=e;var n=Od;e=Md;var i=32-pu(n)-1;n&=~(1<<i),r+=1;var s=32-pu(t)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,Od=1<<32-pu(t)+i|r<<i|n,Md=s+e}else Od=1<<s|r<<i|n,Md=e}function MN(e){e.return!==null&&(Bh(e,1),hI(e,1,0))}function LN(e){for(;e===h2;)h2=Gp[--Kp],Gp[Kp]=null,p2=Gp[--Kp],Gp[Kp]=null;for(;e===p0;)p0=Oc[--Mc],Oc[Mc]=null,Md=Oc[--Mc],Oc[Mc]=null,Od=Oc[--Mc],Oc[Mc]=null}var nc=null,ec=null,_a=!1,lu=null;function pI(e,t){var r=Rc(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function VT(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,nc=e,ec=Zf(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,nc=e,ec=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=p0!==null?{id:Od,overflow:Md}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Rc(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,nc=e,ec=null,!0):!1;default:return!1}}function Zj(e){return(e.mode&1)!==0&&(e.flags&128)===0}function e4(e){if(_a){var t=ec;if(t){var r=t;if(!VT(e,t)){if(Zj(e))throw Error(Jr(418));t=Zf(r.nextSibling);var n=nc;t&&VT(e,t)?pI(n,r):(e.flags=e.flags&-4097|2,_a=!1,nc=e)}}else{if(Zj(e))throw Error(Jr(418));e.flags=e.flags&-4097|2,_a=!1,nc=e}}}function GT(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;nc=e}function pb(e){if(e!==nc)return!1;if(!_a)return GT(e),_a=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Yj(e.type,e.memoizedProps)),t&&(t=ec)){if(Zj(e))throw mI(),Error(Jr(418));for(;t;)pI(e,t),t=Zf(t.nextSibling)}if(GT(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Jr(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){ec=Zf(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}ec=null}}else ec=nc?Zf(e.stateNode.nextSibling):null;return!0}function mI(){for(var e=ec;e;)e=Zf(e.nextSibling)}function Nm(){ec=nc=null,_a=!1}function RN(e){lu===null?lu=[e]:lu.push(e)}var lQ=sf.ReactCurrentBatchConfig;function Bg(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Jr(309));var n=r.stateNode}if(!n)throw Error(Jr(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(Jr(284));if(!r._owner)throw Error(Jr(290,e))}return e}function mb(e,t){throw e=Object.prototype.toString.call(t),Error(Jr(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function KT(e){var t=e._init;return t(e._payload)}function gI(e){function t(b,v){if(e){var w=b.deletions;w===null?(b.deletions=[v],b.flags|=16):w.push(v)}}function r(b,v){if(!e)return null;for(;v!==null;)t(b,v),v=v.sibling;return null}function n(b,v){for(b=new Map;v!==null;)v.key!==null?b.set(v.key,v):b.set(v.index,v),v=v.sibling;return b}function i(b,v){return b=nh(b,v),b.index=0,b.sibling=null,b}function s(b,v,w){return b.index=w,e?(w=b.alternate,w!==null?(w=w.index,w<v?(b.flags|=2,v):w):(b.flags|=2,v)):(b.flags|=1048576,v)}function o(b){return e&&b.alternate===null&&(b.flags|=2),b}function l(b,v,w,S){return v===null||v.tag!==6?(v=I5(w,b.mode,S),v.return=b,v):(v=i(v,w),v.return=b,v)}function c(b,v,w,S){var k=w.type;return k===Up?d(b,v,w.props.children,S,w.key):v!==null&&(v.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Mf&&KT(k)===v.type)?(S=i(v,w.props),S.ref=Bg(b,v,w),S.return=b,S):(S=Fv(w.type,w.key,w.props,null,b.mode,S),S.ref=Bg(b,v,w),S.return=b,S)}function u(b,v,w,S){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=D5(w,b.mode,S),v.return=b,v):(v=i(v,w.children||[]),v.return=b,v)}function d(b,v,w,S,k){return v===null||v.tag!==7?(v=r0(w,b.mode,S,k),v.return=b,v):(v=i(v,w),v.return=b,v)}function f(b,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=I5(""+v,b.mode,w),v.return=b,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case ib:return w=Fv(v.type,v.key,v.props,null,b.mode,w),w.ref=Bg(b,null,v),w.return=b,w;case $p:return v=D5(v,b.mode,w),v.return=b,v;case Mf:var S=v._init;return f(b,S(v._payload),w)}if(ox(v)||Og(v))return v=r0(v,b.mode,w,null),v.return=b,v;mb(b,v)}return null}function h(b,v,w,S){var k=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return k!==null?null:l(b,v,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ib:return w.key===k?c(b,v,w,S):null;case $p:return w.key===k?u(b,v,w,S):null;case Mf:return k=w._init,h(b,v,k(w._payload),S)}if(ox(w)||Og(w))return k!==null?null:d(b,v,w,S,null);mb(b,w)}return null}function p(b,v,w,S,k){if(typeof S=="string"&&S!==""||typeof S=="number")return b=b.get(w)||null,l(v,b,""+S,k);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case ib:return b=b.get(S.key===null?w:S.key)||null,c(v,b,S,k);case $p:return b=b.get(S.key===null?w:S.key)||null,u(v,b,S,k);case Mf:var j=S._init;return p(b,v,w,j(S._payload),k)}if(ox(S)||Og(S))return b=b.get(w)||null,d(v,b,S,k,null);mb(v,S)}return null}function m(b,v,w,S){for(var k=null,j=null,A=v,L=v=0,P=null;A!==null&&L<w.length;L++){A.index>L?(P=A,A=null):P=A.sibling;var F=h(b,A,w[L],S);if(F===null){A===null&&(A=P);break}e&&A&&F.alternate===null&&t(b,A),v=s(F,v,L),j===null?k=F:j.sibling=F,j=F,A=P}if(L===w.length)return r(b,A),_a&&Bh(b,L),k;if(A===null){for(;L<w.length;L++)A=f(b,w[L],S),A!==null&&(v=s(A,v,L),j===null?k=A:j.sibling=A,j=A);return _a&&Bh(b,L),k}for(A=n(b,A);L<w.length;L++)P=p(A,b,L,w[L],S),P!==null&&(e&&P.alternate!==null&&A.delete(P.key===null?L:P.key),v=s(P,v,L),j===null?k=P:j.sibling=P,j=P);return e&&A.forEach(function(E){return t(b,E)}),_a&&Bh(b,L),k}function g(b,v,w,S){var k=Og(w);if(typeof k!="function")throw Error(Jr(150));if(w=k.call(w),w==null)throw Error(Jr(151));for(var j=k=null,A=v,L=v=0,P=null,F=w.next();A!==null&&!F.done;L++,F=w.next()){A.index>L?(P=A,A=null):P=A.sibling;var E=h(b,A,F.value,S);if(E===null){A===null&&(A=P);break}e&&A&&E.alternate===null&&t(b,A),v=s(E,v,L),j===null?k=E:j.sibling=E,j=E,A=P}if(F.done)return r(b,A),_a&&Bh(b,L),k;if(A===null){for(;!F.done;L++,F=w.next())F=f(b,F.value,S),F!==null&&(v=s(F,v,L),j===null?k=F:j.sibling=F,j=F);return _a&&Bh(b,L),k}for(A=n(b,A);!F.done;L++,F=w.next())F=p(A,b,L,F.value,S),F!==null&&(e&&F.alternate!==null&&A.delete(F.key===null?L:F.key),v=s(F,v,L),j===null?k=F:j.sibling=F,j=F);return e&&A.forEach(function(T){return t(b,T)}),_a&&Bh(b,L),k}function y(b,v,w,S){if(typeof w=="object"&&w!==null&&w.type===Up&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case ib:e:{for(var k=w.key,j=v;j!==null;){if(j.key===k){if(k=w.type,k===Up){if(j.tag===7){r(b,j.sibling),v=i(j,w.props.children),v.return=b,b=v;break e}}else if(j.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Mf&&KT(k)===j.type){r(b,j.sibling),v=i(j,w.props),v.ref=Bg(b,j,w),v.return=b,b=v;break e}r(b,j);break}else t(b,j);j=j.sibling}w.type===Up?(v=r0(w.props.children,b.mode,S,w.key),v.return=b,b=v):(S=Fv(w.type,w.key,w.props,null,b.mode,S),S.ref=Bg(b,v,w),S.return=b,b=S)}return o(b);case $p:e:{for(j=w.key;v!==null;){if(v.key===j)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){r(b,v.sibling),v=i(v,w.children||[]),v.return=b,b=v;break e}else{r(b,v);break}else t(b,v);v=v.sibling}v=D5(w,b.mode,S),v.return=b,b=v}return o(b);case Mf:return j=w._init,y(b,v,j(w._payload),S)}if(ox(w))return m(b,v,w,S);if(Og(w))return g(b,v,w,S);mb(b,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(r(b,v.sibling),v=i(v,w),v.return=b,b=v):(r(b,v),v=I5(w,b.mode,S),v.return=b,b=v),o(b)):r(b,v)}return y}var Cm=gI(!0),xI=gI(!1),m2=vh(null),g2=null,Yp=null,FN=null;function BN(){FN=Yp=g2=null}function IN(e){var t=m2.current;ga(m2),e._currentValue=t}function t4(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function cm(e,t){g2=e,FN=Yp=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(wl=!0),e.firstContext=null)}function Dc(e){var t=e._currentValue;if(FN!==e)if(e={context:e,memoizedValue:t,next:null},Yp===null){if(g2===null)throw Error(Jr(308));Yp=e,g2.dependencies={lanes:0,firstContext:e}}else Yp=Yp.next=e;return t}var Vh=null;function DN(e){Vh===null?Vh=[e]:Vh.push(e)}function yI(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,DN(t)):(r.next=i.next,i.next=r),t.interleaved=r,Vd(e,n)}function Vd(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Lf=!1;function $N(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bI(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Id(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function eh(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,ji&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Vd(e,r)}return i=n.interleaved,i===null?(t.next=t,DN(n)):(t.next=i.next,i.next=t),n.interleaved=t,Vd(e,r)}function Tv(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,jN(e,r)}}function YT(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function x2(e,t,r,n){var i=e.updateQueue;Lf=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?s=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(s!==null){var f=i.baseState;o=0,d=u=c=null,l=s;do{var h=l.lane,p=l.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=e,g=l;switch(h=t,p=r,g.tag){case 1:if(m=g.payload,typeof m=="function"){f=m.call(p,f,h);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,h=typeof m=="function"?m.call(p,f,h):m,h==null)break e;f=La({},f,h);break e;case 2:Lf=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=i.effects,h===null?i.effects=[l]:h.push(l))}else p={eventTime:p,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=p,c=f):d=d.next=p,o|=h;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;h=l,l=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(d===null&&(c=f),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);g0|=o,e.lanes=o,e.memoizedState=f}}function XT(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Jr(191,i));i.call(n)}}}var G1={},td=vh(G1),Jx=vh(G1),Zx=vh(G1);function Gh(e){if(e===G1)throw Error(Jr(174));return e}function UN(e,t){switch(ca(Zx,t),ca(Jx,e),ca(td,G1),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Rj(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Rj(t,e)}ga(td),ca(td,t)}function Em(){ga(td),ga(Jx),ga(Zx)}function vI(e){Gh(Zx.current);var t=Gh(td.current),r=Rj(t,e.type);t!==r&&(ca(Jx,e),ca(td,r))}function zN(e){Jx.current===e&&(ga(td),ga(Jx))}var Ea=vh(0);function y2(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var O5=[];function WN(){for(var e=0;e<O5.length;e++)O5[e]._workInProgressVersionPrimary=null;O5.length=0}var Pv=sf.ReactCurrentDispatcher,M5=sf.ReactCurrentBatchConfig,m0=0,Ma=null,Es=null,qs=null,b2=!1,Sx=!1,e1=0,cQ=0;function So(){throw Error(Jr(321))}function qN(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!bu(e[r],t[r]))return!1;return!0}function HN(e,t,r,n,i,s){if(m0=s,Ma=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Pv.current=e===null||e.memoizedState===null?hQ:pQ,e=r(n,i),Sx){s=0;do{if(Sx=!1,e1=0,25<=s)throw Error(Jr(301));s+=1,qs=Es=null,t.updateQueue=null,Pv.current=mQ,e=r(n,i)}while(Sx)}if(Pv.current=v2,t=Es!==null&&Es.next!==null,m0=0,qs=Es=Ma=null,b2=!1,t)throw Error(Jr(300));return e}function VN(){var e=e1!==0;return e1=0,e}function qu(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qs===null?Ma.memoizedState=qs=e:qs=qs.next=e,qs}function $c(){if(Es===null){var e=Ma.alternate;e=e!==null?e.memoizedState:null}else e=Es.next;var t=qs===null?Ma.memoizedState:qs.next;if(t!==null)qs=t,Es=e;else{if(e===null)throw Error(Jr(310));Es=e,e={memoizedState:Es.memoizedState,baseState:Es.baseState,baseQueue:Es.baseQueue,queue:Es.queue,next:null},qs===null?Ma.memoizedState=qs=e:qs=qs.next=e}return qs}function t1(e,t){return typeof t=="function"?t(e):t}function L5(e){var t=$c(),r=t.queue;if(r===null)throw Error(Jr(311));r.lastRenderedReducer=e;var n=Es,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var l=o=null,c=null,u=s;do{var d=u.lane;if((m0&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,Ma.lanes|=d,g0|=d}u=u.next}while(u!==null&&u!==s);c===null?o=n:c.next=l,bu(n,t.memoizedState)||(wl=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,Ma.lanes|=s,g0|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function R5(e){var t=$c(),r=t.queue;if(r===null)throw Error(Jr(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=e(s,o.action),o=o.next;while(o!==i);bu(s,t.memoizedState)||(wl=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function wI(){}function SI(e,t){var r=Ma,n=$c(),i=t(),s=!bu(n.memoizedState,i);if(s&&(n.memoizedState=i,wl=!0),n=n.queue,GN(jI.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||qs!==null&&qs.memoizedState.tag&1){if(r.flags|=2048,r1(9,kI.bind(null,r,n,i,t),void 0,null),Ys===null)throw Error(Jr(349));m0&30||_I(r,t,i)}return i}function _I(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ma.updateQueue,t===null?(t={lastEffect:null,stores:null},Ma.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function kI(e,t,r,n){t.value=r,t.getSnapshot=n,AI(t)&&NI(e)}function jI(e,t,r){return r(function(){AI(t)&&NI(e)})}function AI(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!bu(e,r)}catch{return!0}}function NI(e){var t=Vd(e,1);t!==null&&mu(t,e,1,-1)}function QT(e){var t=qu();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t1,lastRenderedState:e},t.queue=e,e=e.dispatch=fQ.bind(null,Ma,e),[t.memoizedState,e]}function r1(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Ma.updateQueue,t===null?(t={lastEffect:null,stores:null},Ma.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function CI(){return $c().memoizedState}function Ov(e,t,r,n){var i=qu();Ma.flags|=e,i.memoizedState=r1(1|t,r,void 0,n===void 0?null:n)}function nS(e,t,r,n){var i=$c();n=n===void 0?null:n;var s=void 0;if(Es!==null){var o=Es.memoizedState;if(s=o.destroy,n!==null&&qN(n,o.deps)){i.memoizedState=r1(t,r,s,n);return}}Ma.flags|=e,i.memoizedState=r1(1|t,r,s,n)}function JT(e,t){return Ov(8390656,8,e,t)}function GN(e,t){return nS(2048,8,e,t)}function EI(e,t){return nS(4,2,e,t)}function TI(e,t){return nS(4,4,e,t)}function PI(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function OI(e,t,r){return r=r!=null?r.concat([e]):null,nS(4,4,PI.bind(null,t,e),r)}function KN(){}function MI(e,t){var r=$c();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&qN(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function LI(e,t){var r=$c();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&qN(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function RI(e,t,r){return m0&21?(bu(r,t)||(r=$B(),Ma.lanes|=r,g0|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,wl=!0),e.memoizedState=r)}function uQ(e,t){var r=Gi;Gi=r!==0&&4>r?r:4,e(!0);var n=M5.transition;M5.transition={};try{e(!1),t()}finally{Gi=r,M5.transition=n}}function FI(){return $c().memoizedState}function dQ(e,t,r){var n=rh(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},BI(e))II(t,r);else if(r=yI(e,t,r,n),r!==null){var i=tl();mu(r,e,n,i),DI(r,t,n)}}function fQ(e,t,r){var n=rh(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(BI(e))II(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,l=s(o,r);if(i.hasEagerState=!0,i.eagerState=l,bu(l,o)){var c=t.interleaved;c===null?(i.next=i,DN(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}r=yI(e,t,i,n),r!==null&&(i=tl(),mu(r,e,n,i),DI(r,t,n))}}function BI(e){var t=e.alternate;return e===Ma||t!==null&&t===Ma}function II(e,t){Sx=b2=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function DI(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,jN(e,r)}}var v2={readContext:Dc,useCallback:So,useContext:So,useEffect:So,useImperativeHandle:So,useInsertionEffect:So,useLayoutEffect:So,useMemo:So,useReducer:So,useRef:So,useState:So,useDebugValue:So,useDeferredValue:So,useTransition:So,useMutableSource:So,useSyncExternalStore:So,useId:So,unstable_isNewReconciler:!1},hQ={readContext:Dc,useCallback:function(e,t){return qu().memoizedState=[e,t===void 0?null:t],e},useContext:Dc,useEffect:JT,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Ov(4194308,4,PI.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Ov(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ov(4,2,e,t)},useMemo:function(e,t){var r=qu();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=qu();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=dQ.bind(null,Ma,e),[n.memoizedState,e]},useRef:function(e){var t=qu();return e={current:e},t.memoizedState=e},useState:QT,useDebugValue:KN,useDeferredValue:function(e){return qu().memoizedState=e},useTransition:function(){var e=QT(!1),t=e[0];return e=uQ.bind(null,e[1]),qu().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Ma,i=qu();if(_a){if(r===void 0)throw Error(Jr(407));r=r()}else{if(r=t(),Ys===null)throw Error(Jr(349));m0&30||_I(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,JT(jI.bind(null,n,s,e),[e]),n.flags|=2048,r1(9,kI.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=qu(),t=Ys.identifierPrefix;if(_a){var r=Md,n=Od;r=(n&~(1<<32-pu(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=e1++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=cQ++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},pQ={readContext:Dc,useCallback:MI,useContext:Dc,useEffect:GN,useImperativeHandle:OI,useInsertionEffect:EI,useLayoutEffect:TI,useMemo:LI,useReducer:L5,useRef:CI,useState:function(){return L5(t1)},useDebugValue:KN,useDeferredValue:function(e){var t=$c();return RI(t,Es.memoizedState,e)},useTransition:function(){var e=L5(t1)[0],t=$c().memoizedState;return[e,t]},useMutableSource:wI,useSyncExternalStore:SI,useId:FI,unstable_isNewReconciler:!1},mQ={readContext:Dc,useCallback:MI,useContext:Dc,useEffect:GN,useImperativeHandle:OI,useInsertionEffect:EI,useLayoutEffect:TI,useMemo:LI,useReducer:R5,useRef:CI,useState:function(){return R5(t1)},useDebugValue:KN,useDeferredValue:function(e){var t=$c();return Es===null?t.memoizedState=e:RI(t,Es.memoizedState,e)},useTransition:function(){var e=R5(t1)[0],t=$c().memoizedState;return[e,t]},useMutableSource:wI,useSyncExternalStore:SI,useId:FI,unstable_isNewReconciler:!1};function su(e,t){if(e&&e.defaultProps){t=La({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function r4(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:La({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var iS={isMounted:function(e){return(e=e._reactInternals)?U0(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=tl(),i=rh(e),s=Id(n,i);s.payload=t,r!=null&&(s.callback=r),t=eh(e,s,i),t!==null&&(mu(t,e,i,n),Tv(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=tl(),i=rh(e),s=Id(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=eh(e,s,i),t!==null&&(mu(t,e,i,n),Tv(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=tl(),n=rh(e),i=Id(r,n);i.tag=2,t!=null&&(i.callback=t),t=eh(e,i,n),t!==null&&(mu(t,e,n,r),Tv(t,e,n))}};function ZT(e,t,r,n,i,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,o):t.prototype&&t.prototype.isPureReactComponent?!Kx(r,n)||!Kx(i,s):!0}function $I(e,t,r){var n=!1,i=ch,s=t.contextType;return typeof s=="object"&&s!==null?s=Dc(s):(i=Nl(t)?h0:Uo.current,n=t.contextTypes,s=(n=n!=null)?Am(e,i):ch),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=iS,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function e8(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&iS.enqueueReplaceState(t,t.state,null)}function n4(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},$N(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=Dc(s):(s=Nl(t)?h0:Uo.current,i.context=Am(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(r4(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&iS.enqueueReplaceState(i,i.state,null),x2(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Tm(e,t){try{var r="",n=t;do r+=WY(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function F5(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function i4(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var gQ=typeof WeakMap=="function"?WeakMap:Map;function UI(e,t,r){r=Id(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){S2||(S2=!0,p4=n),i4(e,t)},r}function zI(e,t,r){r=Id(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){i4(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){i4(e,t),typeof n!="function"&&(th===null?th=new Set([this]):th.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function t8(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new gQ;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=TQ.bind(null,e,t,r),t.then(e,e))}function r8(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function n8(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Id(-1,1),t.tag=2,eh(r,t,1))),r.lanes|=1),e)}var xQ=sf.ReactCurrentOwner,wl=!1;function Xo(e,t,r,n){t.child=e===null?xI(t,null,r,n):Cm(t,e.child,r,n)}function i8(e,t,r,n,i){r=r.render;var s=t.ref;return cm(t,i),n=HN(e,t,r,n,s,i),r=VN(),e!==null&&!wl?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Gd(e,t,i)):(_a&&r&&MN(t),t.flags|=1,Xo(e,t,n,i),t.child)}function a8(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!r3(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,WI(e,t,s,n,i)):(e=Fv(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:Kx,r(o,n)&&e.ref===t.ref)return Gd(e,t,i)}return t.flags|=1,e=nh(s,n),e.ref=t.ref,e.return=t,t.child=e}function WI(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(Kx(s,n)&&e.ref===t.ref)if(wl=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(wl=!0);else return t.lanes=e.lanes,Gd(e,t,i)}return a4(e,t,r,n,i)}function qI(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ca(Qp,Kl),Kl|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ca(Qp,Kl),Kl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,ca(Qp,Kl),Kl|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,ca(Qp,Kl),Kl|=n;return Xo(e,t,i,r),t.child}function HI(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function a4(e,t,r,n,i){var s=Nl(r)?h0:Uo.current;return s=Am(t,s),cm(t,i),r=HN(e,t,r,n,s,i),n=VN(),e!==null&&!wl?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Gd(e,t,i)):(_a&&n&&MN(t),t.flags|=1,Xo(e,t,r,i),t.child)}function s8(e,t,r,n,i){if(Nl(r)){var s=!0;f2(t)}else s=!1;if(cm(t,i),t.stateNode===null)Mv(e,t),$I(t,r,n),n4(t,r,n,i),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=Dc(u):(u=Nl(r)?h0:Uo.current,u=Am(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&e8(t,o,n,u),Lf=!1;var h=t.memoizedState;o.state=h,x2(t,n,o,i),c=t.memoizedState,l!==n||h!==c||Al.current||Lf?(typeof d=="function"&&(r4(t,r,d,n),c=t.memoizedState),(l=Lf||ZT(t,r,l,n,h,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,bI(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:su(t.type,l),o.props=u,f=t.pendingProps,h=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Dc(c):(c=Nl(r)?h0:Uo.current,c=Am(t,c));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||h!==c)&&e8(t,o,n,c),Lf=!1,h=t.memoizedState,o.state=h,x2(t,n,o,i);var m=t.memoizedState;l!==f||h!==m||Al.current||Lf?(typeof p=="function"&&(r4(t,r,p,n),m=t.memoizedState),(u=Lf||ZT(t,r,u,n,h,m,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,m,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,m,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),o.props=n,o.state=m,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return s4(e,t,r,n,s,i)}function s4(e,t,r,n,i,s){HI(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return i&&HT(t,r,!1),Gd(e,t,s);n=t.stateNode,xQ.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=Cm(t,e.child,null,s),t.child=Cm(t,null,l,s)):Xo(e,t,l,s),t.memoizedState=n.state,i&&HT(t,r,!0),t.child}function VI(e){var t=e.stateNode;t.pendingContext?qT(e,t.pendingContext,t.pendingContext!==t.context):t.context&&qT(e,t.context,!1),UN(e,t.containerInfo)}function o8(e,t,r,n,i){return Nm(),RN(i),t.flags|=256,Xo(e,t,r,n),t.child}var o4={dehydrated:null,treeContext:null,retryLane:0};function l4(e){return{baseLanes:e,cachePool:null,transitions:null}}function GI(e,t,r){var n=t.pendingProps,i=Ea.current,s=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),ca(Ea,i&1),e===null)return e4(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,s?(n=t.mode,s=t.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=oS(o,n,0,null),e=r0(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=l4(r),t.memoizedState=o4,e):YN(t,o));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return yQ(e,t,o,n,l,i,r);if(s){s=n.fallback,o=t.mode,i=e.child,l=i.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=nh(i,c),n.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=nh(l,s):(s=r0(s,o,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,o=e.child.memoizedState,o=o===null?l4(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~r,t.memoizedState=o4,n}return s=e.child,e=s.sibling,n=nh(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function YN(e,t){return t=oS({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function gb(e,t,r,n){return n!==null&&RN(n),Cm(t,e.child,null,r),e=YN(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function yQ(e,t,r,n,i,s,o){if(r)return t.flags&256?(t.flags&=-257,n=F5(Error(Jr(422))),gb(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=oS({mode:"visible",children:n.children},i,0,null),s=r0(s,i,o,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Cm(t,e.child,null,o),t.child.memoizedState=l4(o),t.memoizedState=o4,s);if(!(t.mode&1))return gb(e,t,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(Jr(419)),n=F5(s,n,void 0),gb(e,t,o,n)}if(l=(o&e.childLanes)!==0,wl||l){if(n=Ys,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Vd(e,i),mu(n,e,i,-1))}return t3(),n=F5(Error(Jr(421))),gb(e,t,o,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=PQ.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,ec=Zf(i.nextSibling),nc=t,_a=!0,lu=null,e!==null&&(Oc[Mc++]=Od,Oc[Mc++]=Md,Oc[Mc++]=p0,Od=e.id,Md=e.overflow,p0=t),t=YN(t,n.children),t.flags|=4096,t)}function l8(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),t4(e.return,t,r)}function B5(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function KI(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Xo(e,t,n.children,r),n=Ea.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&l8(e,r,t);else if(e.tag===19)l8(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(ca(Ea,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&y2(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),B5(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&y2(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}B5(t,!0,r,null,s);break;case"together":B5(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Mv(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Gd(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),g0|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Jr(153));if(t.child!==null){for(e=t.child,r=nh(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=nh(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function bQ(e,t,r){switch(t.tag){case 3:VI(t),Nm();break;case 5:vI(t);break;case 1:Nl(t.type)&&f2(t);break;case 4:UN(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;ca(m2,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(ca(Ea,Ea.current&1),t.flags|=128,null):r&t.child.childLanes?GI(e,t,r):(ca(Ea,Ea.current&1),e=Gd(e,t,r),e!==null?e.sibling:null);ca(Ea,Ea.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return KI(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ca(Ea,Ea.current),n)break;return null;case 22:case 23:return t.lanes=0,qI(e,t,r)}return Gd(e,t,r)}var YI,c4,XI,QI;YI=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};c4=function(){};XI=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,Gh(td.current);var s=null;switch(r){case"input":i=Pj(e,i),n=Pj(e,n),s=[];break;case"select":i=La({},i,{value:void 0}),n=La({},n,{value:void 0}),s=[];break;case"textarea":i=Lj(e,i),n=Lj(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=u2)}Fj(r,n);var o;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Ux.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(l=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(s||(s=[]),s.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Ux.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&fa("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};QI=function(e,t,r,n){r!==n&&(t.flags|=4)};function Ig(e,t){if(!_a)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function _o(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function vQ(e,t,r){var n=t.pendingProps;switch(LN(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _o(t),null;case 1:return Nl(t.type)&&d2(),_o(t),null;case 3:return n=t.stateNode,Em(),ga(Al),ga(Uo),WN(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(pb(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,lu!==null&&(x4(lu),lu=null))),c4(e,t),_o(t),null;case 5:zN(t);var i=Gh(Zx.current);if(r=t.type,e!==null&&t.stateNode!=null)XI(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Jr(166));return _o(t),null}if(e=Gh(td.current),pb(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Ku]=t,n[Qx]=s,e=(t.mode&1)!==0,r){case"dialog":fa("cancel",n),fa("close",n);break;case"iframe":case"object":case"embed":fa("load",n);break;case"video":case"audio":for(i=0;i<cx.length;i++)fa(cx[i],n);break;case"source":fa("error",n);break;case"img":case"image":case"link":fa("error",n),fa("load",n);break;case"details":fa("toggle",n);break;case"input":xT(n,s),fa("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},fa("invalid",n);break;case"textarea":bT(n,s),fa("invalid",n)}Fj(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&hb(n.textContent,l,e),i=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&hb(n.textContent,l,e),i=["children",""+l]):Ux.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&fa("scroll",n)}switch(r){case"input":ab(n),yT(n,s,!0);break;case"textarea":ab(n),vT(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=u2)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=jB(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[Ku]=t,e[Qx]=n,YI(e,t,!1,!1),t.stateNode=e;e:{switch(o=Bj(r,n),r){case"dialog":fa("cancel",e),fa("close",e),i=n;break;case"iframe":case"object":case"embed":fa("load",e),i=n;break;case"video":case"audio":for(i=0;i<cx.length;i++)fa(cx[i],e);i=n;break;case"source":fa("error",e),i=n;break;case"img":case"image":case"link":fa("error",e),fa("load",e),i=n;break;case"details":fa("toggle",e),i=n;break;case"input":xT(e,n),i=Pj(e,n),fa("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=La({},n,{value:void 0}),fa("invalid",e);break;case"textarea":bT(e,n),i=Lj(e,n),fa("invalid",e);break;default:i=n}Fj(r,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?CB(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&AB(e,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&zx(e,c):typeof c=="number"&&zx(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ux.hasOwnProperty(s)?c!=null&&s==="onScroll"&&fa("scroll",e):c!=null&&bN(e,s,c,o))}switch(r){case"input":ab(e),yT(e,n,!1);break;case"textarea":ab(e),vT(e);break;case"option":n.value!=null&&e.setAttribute("value",""+lh(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?am(e,!!n.multiple,s,!1):n.defaultValue!=null&&am(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=u2)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return _o(t),null;case 6:if(e&&t.stateNode!=null)QI(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Jr(166));if(r=Gh(Zx.current),Gh(td.current),pb(t)){if(n=t.stateNode,r=t.memoizedProps,n[Ku]=t,(s=n.nodeValue!==r)&&(e=nc,e!==null))switch(e.tag){case 3:hb(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&hb(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ku]=t,t.stateNode=n}return _o(t),null;case 13:if(ga(Ea),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(_a&&ec!==null&&t.mode&1&&!(t.flags&128))mI(),Nm(),t.flags|=98560,s=!1;else if(s=pb(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(Jr(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Jr(317));s[Ku]=t}else Nm(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;_o(t),s=!1}else lu!==null&&(x4(lu),lu=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ea.current&1?Os===0&&(Os=3):t3())),t.updateQueue!==null&&(t.flags|=4),_o(t),null);case 4:return Em(),c4(e,t),e===null&&Yx(t.stateNode.containerInfo),_o(t),null;case 10:return IN(t.type._context),_o(t),null;case 17:return Nl(t.type)&&d2(),_o(t),null;case 19:if(ga(Ea),s=t.memoizedState,s===null)return _o(t),null;if(n=(t.flags&128)!==0,o=s.rendering,o===null)if(n)Ig(s,!1);else{if(Os!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=y2(e),o!==null){for(t.flags|=128,Ig(s,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return ca(Ea,Ea.current&1|2),t.child}e=e.sibling}s.tail!==null&&ts()>Pm&&(t.flags|=128,n=!0,Ig(s,!1),t.lanes=4194304)}else{if(!n)if(e=y2(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Ig(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!_a)return _o(t),null}else 2*ts()-s.renderingStartTime>Pm&&r!==1073741824&&(t.flags|=128,n=!0,Ig(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(r=s.last,r!==null?r.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=ts(),t.sibling=null,r=Ea.current,ca(Ea,n?r&1|2:r&1),t):(_o(t),null);case 22:case 23:return e3(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Kl&1073741824&&(_o(t),t.subtreeFlags&6&&(t.flags|=8192)):_o(t),null;case 24:return null;case 25:return null}throw Error(Jr(156,t.tag))}function wQ(e,t){switch(LN(t),t.tag){case 1:return Nl(t.type)&&d2(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Em(),ga(Al),ga(Uo),WN(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return zN(t),null;case 13:if(ga(Ea),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Jr(340));Nm()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ga(Ea),null;case 4:return Em(),null;case 10:return IN(t.type._context),null;case 22:case 23:return e3(),null;case 24:return null;default:return null}}var xb=!1,Lo=!1,SQ=typeof WeakSet=="function"?WeakSet:Set,jn=null;function Xp(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Wa(e,t,n)}else r.current=null}function u4(e,t,r){try{r()}catch(n){Wa(e,t,n)}}var c8=!1;function _Q(e,t){if(Gj=o2,e=rI(),ON(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,f=e,h=null;t:for(;;){for(var p;f!==r||i!==0&&f.nodeType!==3||(l=o+i),f!==s||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(p=f.firstChild)!==null;)h=f,f=p;for(;;){if(f===e)break t;if(h===r&&++u===i&&(l=o),h===s&&++d===n&&(c=o),(p=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=p}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Kj={focusedElem:e,selectionRange:r},o2=!1,jn=t;jn!==null;)if(t=jn,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,jn=e;else for(;jn!==null;){t=jn;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,y=m.memoizedState,b=t.stateNode,v=b.getSnapshotBeforeUpdate(t.elementType===t.type?g:su(t.type,g),y);b.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Jr(163))}}catch(S){Wa(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,jn=e;break}jn=t.return}return m=c8,c8=!1,m}function _x(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&u4(t,r,s)}i=i.next}while(i!==n)}}function aS(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function d4(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function JI(e){var t=e.alternate;t!==null&&(e.alternate=null,JI(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ku],delete t[Qx],delete t[Qj],delete t[aQ],delete t[sQ])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ZI(e){return e.tag===5||e.tag===3||e.tag===4}function u8(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||ZI(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function f4(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=u2));else if(n!==4&&(e=e.child,e!==null))for(f4(e,t,r),e=e.sibling;e!==null;)f4(e,t,r),e=e.sibling}function h4(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(h4(e,t,r),e=e.sibling;e!==null;)h4(e,t,r),e=e.sibling}var co=null,ou=!1;function kf(e,t,r){for(r=r.child;r!==null;)eD(e,t,r),r=r.sibling}function eD(e,t,r){if(ed&&typeof ed.onCommitFiberUnmount=="function")try{ed.onCommitFiberUnmount(Qw,r)}catch{}switch(r.tag){case 5:Lo||Xp(r,t);case 6:var n=co,i=ou;co=null,kf(e,t,r),co=n,ou=i,co!==null&&(ou?(e=co,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):co.removeChild(r.stateNode));break;case 18:co!==null&&(ou?(e=co,r=r.stateNode,e.nodeType===8?T5(e.parentNode,r):e.nodeType===1&&T5(e,r),Vx(e)):T5(co,r.stateNode));break;case 4:n=co,i=ou,co=r.stateNode.containerInfo,ou=!0,kf(e,t,r),co=n,ou=i;break;case 0:case 11:case 14:case 15:if(!Lo&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&u4(r,t,o),i=i.next}while(i!==n)}kf(e,t,r);break;case 1:if(!Lo&&(Xp(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Wa(r,t,l)}kf(e,t,r);break;case 21:kf(e,t,r);break;case 22:r.mode&1?(Lo=(n=Lo)||r.memoizedState!==null,kf(e,t,r),Lo=n):kf(e,t,r);break;default:kf(e,t,r)}}function d8(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new SQ),t.forEach(function(n){var i=OQ.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function ru(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:co=l.stateNode,ou=!1;break e;case 3:co=l.stateNode.containerInfo,ou=!0;break e;case 4:co=l.stateNode.containerInfo,ou=!0;break e}l=l.return}if(co===null)throw Error(Jr(160));eD(s,o,i),co=null,ou=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){Wa(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)tD(t,e),t=t.sibling}function tD(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ru(t,e),Tu(e),n&4){try{_x(3,e,e.return),aS(3,e)}catch(g){Wa(e,e.return,g)}try{_x(5,e,e.return)}catch(g){Wa(e,e.return,g)}}break;case 1:ru(t,e),Tu(e),n&512&&r!==null&&Xp(r,r.return);break;case 5:if(ru(t,e),Tu(e),n&512&&r!==null&&Xp(r,r.return),e.flags&32){var i=e.stateNode;try{zx(i,"")}catch(g){Wa(e,e.return,g)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,o=r!==null?r.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&_B(i,s),Bj(l,o);var u=Bj(l,s);for(o=0;o<c.length;o+=2){var d=c[o],f=c[o+1];d==="style"?CB(i,f):d==="dangerouslySetInnerHTML"?AB(i,f):d==="children"?zx(i,f):bN(i,d,f,u)}switch(l){case"input":Oj(i,s);break;case"textarea":kB(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?am(i,!!s.multiple,p,!1):h!==!!s.multiple&&(s.defaultValue!=null?am(i,!!s.multiple,s.defaultValue,!0):am(i,!!s.multiple,s.multiple?[]:"",!1))}i[Qx]=s}catch(g){Wa(e,e.return,g)}}break;case 6:if(ru(t,e),Tu(e),n&4){if(e.stateNode===null)throw Error(Jr(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(g){Wa(e,e.return,g)}}break;case 3:if(ru(t,e),Tu(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Vx(t.containerInfo)}catch(g){Wa(e,e.return,g)}break;case 4:ru(t,e),Tu(e);break;case 13:ru(t,e),Tu(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(JN=ts())),n&4&&d8(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Lo=(u=Lo)||d,ru(t,e),Lo=u):ru(t,e),Tu(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(jn=e,d=e.child;d!==null;){for(f=jn=d;jn!==null;){switch(h=jn,p=h.child,h.tag){case 0:case 11:case 14:case 15:_x(4,h,h.return);break;case 1:Xp(h,h.return);var m=h.stateNode;if(typeof m.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Wa(n,r,g)}}break;case 5:Xp(h,h.return);break;case 22:if(h.memoizedState!==null){h8(f);continue}}p!==null?(p.return=h,jn=p):h8(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{i=f.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=NB("display",o))}catch(g){Wa(e,e.return,g)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(g){Wa(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:ru(t,e),Tu(e),n&4&&d8(e);break;case 21:break;default:ru(t,e),Tu(e)}}function Tu(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(ZI(r)){var n=r;break e}r=r.return}throw Error(Jr(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(zx(i,""),n.flags&=-33);var s=u8(e);h4(e,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,l=u8(e);f4(e,l,o);break;default:throw Error(Jr(161))}}catch(c){Wa(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function kQ(e,t,r){jn=e,rD(e)}function rD(e,t,r){for(var n=(e.mode&1)!==0;jn!==null;){var i=jn,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||xb;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||Lo;l=xb;var u=Lo;if(xb=o,(Lo=c)&&!u)for(jn=i;jn!==null;)o=jn,c=o.child,o.tag===22&&o.memoizedState!==null?p8(i):c!==null?(c.return=o,jn=c):p8(i);for(;s!==null;)jn=s,rD(s),s=s.sibling;jn=i,xb=l,Lo=u}f8(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,jn=s):f8(e)}}function f8(e){for(;jn!==null;){var t=jn;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Lo||aS(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Lo)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:su(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&XT(t,s,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}XT(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Vx(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Jr(163))}Lo||t.flags&512&&d4(t)}catch(h){Wa(t,t.return,h)}}if(t===e){jn=null;break}if(r=t.sibling,r!==null){r.return=t.return,jn=r;break}jn=t.return}}function h8(e){for(;jn!==null;){var t=jn;if(t===e){jn=null;break}var r=t.sibling;if(r!==null){r.return=t.return,jn=r;break}jn=t.return}}function p8(e){for(;jn!==null;){var t=jn;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{aS(4,t)}catch(c){Wa(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(c){Wa(t,i,c)}}var s=t.return;try{d4(t)}catch(c){Wa(t,s,c)}break;case 5:var o=t.return;try{d4(t)}catch(c){Wa(t,o,c)}}}catch(c){Wa(t,t.return,c)}if(t===e){jn=null;break}var l=t.sibling;if(l!==null){l.return=t.return,jn=l;break}jn=t.return}}var jQ=Math.ceil,w2=sf.ReactCurrentDispatcher,XN=sf.ReactCurrentOwner,Bc=sf.ReactCurrentBatchConfig,ji=0,Ys=null,ms=null,mo=0,Kl=0,Qp=vh(0),Os=0,n1=null,g0=0,sS=0,QN=0,kx=null,vl=null,JN=0,Pm=1/0,Ad=null,S2=!1,p4=null,th=null,yb=!1,Wf=null,_2=0,jx=0,m4=null,Lv=-1,Rv=0;function tl(){return ji&6?ts():Lv!==-1?Lv:Lv=ts()}function rh(e){return e.mode&1?ji&2&&mo!==0?mo&-mo:lQ.transition!==null?(Rv===0&&(Rv=$B()),Rv):(e=Gi,e!==0||(e=window.event,e=e===void 0?16:GB(e.type)),e):1}function mu(e,t,r,n){if(50<jx)throw jx=0,m4=null,Error(Jr(185));q1(e,r,n),(!(ji&2)||e!==Ys)&&(e===Ys&&(!(ji&2)&&(sS|=r),Os===4&&If(e,mo)),Cl(e,n),r===1&&ji===0&&!(t.mode&1)&&(Pm=ts()+500,rS&&wh()))}function Cl(e,t){var r=e.callbackNode;lX(e,t);var n=s2(e,e===Ys?mo:0);if(n===0)r!==null&&_T(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&_T(r),t===1)e.tag===0?oQ(m8.bind(null,e)):fI(m8.bind(null,e)),nQ(function(){!(ji&6)&&wh()}),r=null;else{switch(UB(n)){case 1:r=kN;break;case 4:r=IB;break;case 16:r=a2;break;case 536870912:r=DB;break;default:r=a2}r=uD(r,nD.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function nD(e,t){if(Lv=-1,Rv=0,ji&6)throw Error(Jr(327));var r=e.callbackNode;if(um()&&e.callbackNode!==r)return null;var n=s2(e,e===Ys?mo:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=k2(e,n);else{t=n;var i=ji;ji|=2;var s=aD();(Ys!==e||mo!==t)&&(Ad=null,Pm=ts()+500,t0(e,t));do try{CQ();break}catch(l){iD(e,l)}while(!0);BN(),w2.current=s,ji=i,ms!==null?t=0:(Ys=null,mo=0,t=Os)}if(t!==0){if(t===2&&(i=zj(e),i!==0&&(n=i,t=g4(e,i))),t===1)throw r=n1,t0(e,0),If(e,n),Cl(e,ts()),r;if(t===6)If(e,n);else{if(i=e.current.alternate,!(n&30)&&!AQ(i)&&(t=k2(e,n),t===2&&(s=zj(e),s!==0&&(n=s,t=g4(e,s))),t===1))throw r=n1,t0(e,0),If(e,n),Cl(e,ts()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(Jr(345));case 2:Ih(e,vl,Ad);break;case 3:if(If(e,n),(n&130023424)===n&&(t=JN+500-ts(),10<t)){if(s2(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){tl(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Xj(Ih.bind(null,e,vl,Ad),t);break}Ih(e,vl,Ad);break;case 4:if(If(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-pu(n);s=1<<o,o=t[o],o>i&&(i=o),n&=~s}if(n=i,n=ts()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*jQ(n/1960))-n,10<n){e.timeoutHandle=Xj(Ih.bind(null,e,vl,Ad),n);break}Ih(e,vl,Ad);break;case 5:Ih(e,vl,Ad);break;default:throw Error(Jr(329))}}}return Cl(e,ts()),e.callbackNode===r?nD.bind(null,e):null}function g4(e,t){var r=kx;return e.current.memoizedState.isDehydrated&&(t0(e,t).flags|=256),e=k2(e,t),e!==2&&(t=vl,vl=r,t!==null&&x4(t)),e}function x4(e){vl===null?vl=e:vl.push.apply(vl,e)}function AQ(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!bu(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function If(e,t){for(t&=~QN,t&=~sS,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-pu(t),n=1<<r;e[r]=-1,t&=~n}}function m8(e){if(ji&6)throw Error(Jr(327));um();var t=s2(e,0);if(!(t&1))return Cl(e,ts()),null;var r=k2(e,t);if(e.tag!==0&&r===2){var n=zj(e);n!==0&&(t=n,r=g4(e,n))}if(r===1)throw r=n1,t0(e,0),If(e,t),Cl(e,ts()),r;if(r===6)throw Error(Jr(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ih(e,vl,Ad),Cl(e,ts()),null}function ZN(e,t){var r=ji;ji|=1;try{return e(t)}finally{ji=r,ji===0&&(Pm=ts()+500,rS&&wh())}}function x0(e){Wf!==null&&Wf.tag===0&&!(ji&6)&&um();var t=ji;ji|=1;var r=Bc.transition,n=Gi;try{if(Bc.transition=null,Gi=1,e)return e()}finally{Gi=n,Bc.transition=r,ji=t,!(ji&6)&&wh()}}function e3(){Kl=Qp.current,ga(Qp)}function t0(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,rQ(r)),ms!==null)for(r=ms.return;r!==null;){var n=r;switch(LN(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&d2();break;case 3:Em(),ga(Al),ga(Uo),WN();break;case 5:zN(n);break;case 4:Em();break;case 13:ga(Ea);break;case 19:ga(Ea);break;case 10:IN(n.type._context);break;case 22:case 23:e3()}r=r.return}if(Ys=e,ms=e=nh(e.current,null),mo=Kl=t,Os=0,n1=null,QN=sS=g0=0,vl=kx=null,Vh!==null){for(t=0;t<Vh.length;t++)if(r=Vh[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}Vh=null}return e}function iD(e,t){do{var r=ms;try{if(BN(),Pv.current=v2,b2){for(var n=Ma.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}b2=!1}if(m0=0,qs=Es=Ma=null,Sx=!1,e1=0,XN.current=null,r===null||r.return===null){Os=1,n1=t,ms=null;break}e:{var s=e,o=r.return,l=r,c=t;if(t=mo,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=r8(o);if(p!==null){p.flags&=-257,n8(p,o,l,s,t),p.mode&1&&t8(s,u,t),t=p,c=u;var m=t.updateQueue;if(m===null){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}else{if(!(t&1)){t8(s,u,t),t3();break e}c=Error(Jr(426))}}else if(_a&&l.mode&1){var y=r8(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),n8(y,o,l,s,t),RN(Tm(c,l));break e}}s=c=Tm(c,l),Os!==4&&(Os=2),kx===null?kx=[s]:kx.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var b=UI(s,c,t);YT(s,b);break e;case 1:l=c;var v=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(th===null||!th.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t;var S=zI(s,l,t);YT(s,S);break e}}s=s.return}while(s!==null)}oD(r)}catch(k){t=k,ms===r&&r!==null&&(ms=r=r.return);continue}break}while(!0)}function aD(){var e=w2.current;return w2.current=v2,e===null?v2:e}function t3(){(Os===0||Os===3||Os===2)&&(Os=4),Ys===null||!(g0&268435455)&&!(sS&268435455)||If(Ys,mo)}function k2(e,t){var r=ji;ji|=2;var n=aD();(Ys!==e||mo!==t)&&(Ad=null,t0(e,t));do try{NQ();break}catch(i){iD(e,i)}while(!0);if(BN(),ji=r,w2.current=n,ms!==null)throw Error(Jr(261));return Ys=null,mo=0,Os}function NQ(){for(;ms!==null;)sD(ms)}function CQ(){for(;ms!==null&&!ZY();)sD(ms)}function sD(e){var t=cD(e.alternate,e,Kl);e.memoizedProps=e.pendingProps,t===null?oD(e):ms=t,XN.current=null}function oD(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=wQ(r,t),r!==null){r.flags&=32767,ms=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Os=6,ms=null;return}}else if(r=vQ(r,t,Kl),r!==null){ms=r;return}if(t=t.sibling,t!==null){ms=t;return}ms=t=e}while(t!==null);Os===0&&(Os=5)}function Ih(e,t,r){var n=Gi,i=Bc.transition;try{Bc.transition=null,Gi=1,EQ(e,t,r,n)}finally{Bc.transition=i,Gi=n}return null}function EQ(e,t,r,n){do um();while(Wf!==null);if(ji&6)throw Error(Jr(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Jr(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(cX(e,s),e===Ys&&(ms=Ys=null,mo=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||yb||(yb=!0,uD(a2,function(){return um(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Bc.transition,Bc.transition=null;var o=Gi;Gi=1;var l=ji;ji|=4,XN.current=null,_Q(e,r),tD(r,e),YX(Kj),o2=!!Gj,Kj=Gj=null,e.current=r,kQ(r),eX(),ji=l,Gi=o,Bc.transition=s}else e.current=r;if(yb&&(yb=!1,Wf=e,_2=i),s=e.pendingLanes,s===0&&(th=null),nX(r.stateNode),Cl(e,ts()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(S2)throw S2=!1,e=p4,p4=null,e;return _2&1&&e.tag!==0&&um(),s=e.pendingLanes,s&1?e===m4?jx++:(jx=0,m4=e):jx=0,wh(),null}function um(){if(Wf!==null){var e=UB(_2),t=Bc.transition,r=Gi;try{if(Bc.transition=null,Gi=16>e?16:e,Wf===null)var n=!1;else{if(e=Wf,Wf=null,_2=0,ji&6)throw Error(Jr(331));var i=ji;for(ji|=4,jn=e.current;jn!==null;){var s=jn,o=s.child;if(jn.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(jn=u;jn!==null;){var d=jn;switch(d.tag){case 0:case 11:case 15:_x(8,d,s)}var f=d.child;if(f!==null)f.return=d,jn=f;else for(;jn!==null;){d=jn;var h=d.sibling,p=d.return;if(JI(d),d===u){jn=null;break}if(h!==null){h.return=p,jn=h;break}jn=p}}}var m=s.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}jn=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,jn=o;else e:for(;jn!==null;){if(s=jn,s.flags&2048)switch(s.tag){case 0:case 11:case 15:_x(9,s,s.return)}var b=s.sibling;if(b!==null){b.return=s.return,jn=b;break e}jn=s.return}}var v=e.current;for(jn=v;jn!==null;){o=jn;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,jn=w;else e:for(o=v;jn!==null;){if(l=jn,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:aS(9,l)}}catch(k){Wa(l,l.return,k)}if(l===o){jn=null;break e}var S=l.sibling;if(S!==null){S.return=l.return,jn=S;break e}jn=l.return}}if(ji=i,wh(),ed&&typeof ed.onPostCommitFiberRoot=="function")try{ed.onPostCommitFiberRoot(Qw,e)}catch{}n=!0}return n}finally{Gi=r,Bc.transition=t}}return!1}function g8(e,t,r){t=Tm(r,t),t=UI(e,t,1),e=eh(e,t,1),t=tl(),e!==null&&(q1(e,1,t),Cl(e,t))}function Wa(e,t,r){if(e.tag===3)g8(e,e,r);else for(;t!==null;){if(t.tag===3){g8(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(th===null||!th.has(n))){e=Tm(r,e),e=zI(t,e,1),t=eh(t,e,1),e=tl(),t!==null&&(q1(t,1,e),Cl(t,e));break}}t=t.return}}function TQ(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=tl(),e.pingedLanes|=e.suspendedLanes&r,Ys===e&&(mo&r)===r&&(Os===4||Os===3&&(mo&130023424)===mo&&500>ts()-JN?t0(e,0):QN|=r),Cl(e,t)}function lD(e,t){t===0&&(e.mode&1?(t=lb,lb<<=1,!(lb&130023424)&&(lb=4194304)):t=1);var r=tl();e=Vd(e,t),e!==null&&(q1(e,t,r),Cl(e,r))}function PQ(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),lD(e,r)}function OQ(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Jr(314))}n!==null&&n.delete(t),lD(e,r)}var cD;cD=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Al.current)wl=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return wl=!1,bQ(e,t,r);wl=!!(e.flags&131072)}else wl=!1,_a&&t.flags&1048576&&hI(t,p2,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Mv(e,t),e=t.pendingProps;var i=Am(t,Uo.current);cm(t,r),i=HN(null,t,n,e,i,r);var s=VN();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Nl(n)?(s=!0,f2(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,$N(t),i.updater=iS,t.stateNode=i,i._reactInternals=t,n4(t,n,e,r),t=s4(null,t,n,!0,s,r)):(t.tag=0,_a&&s&&MN(t),Xo(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Mv(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=LQ(n),e=su(n,e),i){case 0:t=a4(null,t,n,e,r);break e;case 1:t=s8(null,t,n,e,r);break e;case 11:t=i8(null,t,n,e,r);break e;case 14:t=a8(null,t,n,su(n.type,e),r);break e}throw Error(Jr(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:su(n,i),a4(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:su(n,i),s8(e,t,n,i,r);case 3:e:{if(VI(t),e===null)throw Error(Jr(387));n=t.pendingProps,s=t.memoizedState,i=s.element,bI(e,t),x2(t,n,null,r);var o=t.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=Tm(Error(Jr(423)),t),t=o8(e,t,n,r,i);break e}else if(n!==i){i=Tm(Error(Jr(424)),t),t=o8(e,t,n,r,i);break e}else for(ec=Zf(t.stateNode.containerInfo.firstChild),nc=t,_a=!0,lu=null,r=xI(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Nm(),n===i){t=Gd(e,t,r);break e}Xo(e,t,n,r)}t=t.child}return t;case 5:return vI(t),e===null&&e4(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,o=i.children,Yj(n,i)?o=null:s!==null&&Yj(n,s)&&(t.flags|=32),HI(e,t),Xo(e,t,o,r),t.child;case 6:return e===null&&e4(t),null;case 13:return GI(e,t,r);case 4:return UN(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Cm(t,null,n,r):Xo(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:su(n,i),i8(e,t,n,i,r);case 7:return Xo(e,t,t.pendingProps,r),t.child;case 8:return Xo(e,t,t.pendingProps.children,r),t.child;case 12:return Xo(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,ca(m2,n._currentValue),n._currentValue=o,s!==null)if(bu(s.value,o)){if(s.children===i.children&&!Al.current){t=Gd(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=Id(-1,r&-r),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),t4(s.return,r,t),l.lanes|=r;break}c=c.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Jr(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),t4(o,r,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Xo(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,cm(t,r),i=Dc(i),n=n(i),t.flags|=1,Xo(e,t,n,r),t.child;case 14:return n=t.type,i=su(n,t.pendingProps),i=su(n.type,i),a8(e,t,n,i,r);case 15:return WI(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:su(n,i),Mv(e,t),t.tag=1,Nl(n)?(e=!0,f2(t)):e=!1,cm(t,r),$I(t,n,i),n4(t,n,i,r),s4(null,t,n,!0,e,r);case 19:return KI(e,t,r);case 22:return qI(e,t,r)}throw Error(Jr(156,t.tag))};function uD(e,t){return BB(e,t)}function MQ(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rc(e,t,r,n){return new MQ(e,t,r,n)}function r3(e){return e=e.prototype,!(!e||!e.isReactComponent)}function LQ(e){if(typeof e=="function")return r3(e)?1:0;if(e!=null){if(e=e.$$typeof,e===wN)return 11;if(e===SN)return 14}return 2}function nh(e,t){var r=e.alternate;return r===null?(r=Rc(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Fv(e,t,r,n,i,s){var o=2;if(n=e,typeof e=="function")r3(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Up:return r0(r.children,i,s,t);case vN:o=8,i|=8;break;case Nj:return e=Rc(12,r,t,i|2),e.elementType=Nj,e.lanes=s,e;case Cj:return e=Rc(13,r,t,i),e.elementType=Cj,e.lanes=s,e;case Ej:return e=Rc(19,r,t,i),e.elementType=Ej,e.lanes=s,e;case vB:return oS(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case yB:o=10;break e;case bB:o=9;break e;case wN:o=11;break e;case SN:o=14;break e;case Mf:o=16,n=null;break e}throw Error(Jr(130,e==null?e:typeof e,""))}return t=Rc(o,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function r0(e,t,r,n){return e=Rc(7,e,n,t),e.lanes=r,e}function oS(e,t,r,n){return e=Rc(22,e,n,t),e.elementType=vB,e.lanes=r,e.stateNode={isHidden:!1},e}function I5(e,t,r){return e=Rc(6,e,null,t),e.lanes=r,e}function D5(e,t,r){return t=Rc(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function RQ(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=b5(0),this.expirationTimes=b5(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=b5(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function n3(e,t,r,n,i,s,o,l,c){return e=new RQ(e,t,r,l,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Rc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},$N(s),e}function FQ(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$p,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function dD(e){if(!e)return ch;e=e._reactInternals;e:{if(U0(e)!==e||e.tag!==1)throw Error(Jr(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Nl(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Jr(171))}if(e.tag===1){var r=e.type;if(Nl(r))return dI(e,r,t)}return t}function fD(e,t,r,n,i,s,o,l,c){return e=n3(r,n,!0,e,i,s,o,l,c),e.context=dD(null),r=e.current,n=tl(),i=rh(r),s=Id(n,i),s.callback=t??null,eh(r,s,i),e.current.lanes=i,q1(e,i,n),Cl(e,n),e}function lS(e,t,r,n){var i=t.current,s=tl(),o=rh(i);return r=dD(r),t.context===null?t.context=r:t.pendingContext=r,t=Id(s,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=eh(i,t,o),e!==null&&(mu(e,i,o,s),Tv(e,i,o)),o}function j2(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function x8(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function i3(e,t){x8(e,t),(e=e.alternate)&&x8(e,t)}function BQ(){return null}var hD=typeof reportError=="function"?reportError:function(e){console.error(e)};function a3(e){this._internalRoot=e}cS.prototype.render=a3.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Jr(409));lS(e,t,null,null)};cS.prototype.unmount=a3.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;x0(function(){lS(null,e,null,null)}),t[Hd]=null}};function cS(e){this._internalRoot=e}cS.prototype.unstable_scheduleHydration=function(e){if(e){var t=qB();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Bf.length&&t!==0&&t<Bf[r].priority;r++);Bf.splice(r,0,e),r===0&&VB(e)}};function s3(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function uS(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function y8(){}function IQ(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=j2(o);s.call(u)}}var o=fD(t,n,e,0,null,!1,!1,"",y8);return e._reactRootContainer=o,e[Hd]=o.current,Yx(e.nodeType===8?e.parentNode:e),x0(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var l=n;n=function(){var u=j2(c);l.call(u)}}var c=n3(e,0,!1,null,null,!1,!1,"",y8);return e._reactRootContainer=c,e[Hd]=c.current,Yx(e.nodeType===8?e.parentNode:e),x0(function(){lS(t,c,r,n)}),c}function dS(e,t,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var c=j2(o);l.call(c)}}lS(t,o,e,i)}else o=IQ(r,t,e,i,n);return j2(o)}zB=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=lx(t.pendingLanes);r!==0&&(jN(t,r|1),Cl(t,ts()),!(ji&6)&&(Pm=ts()+500,wh()))}break;case 13:x0(function(){var n=Vd(e,1);if(n!==null){var i=tl();mu(n,e,1,i)}}),i3(e,1)}};AN=function(e){if(e.tag===13){var t=Vd(e,134217728);if(t!==null){var r=tl();mu(t,e,134217728,r)}i3(e,134217728)}};WB=function(e){if(e.tag===13){var t=rh(e),r=Vd(e,t);if(r!==null){var n=tl();mu(r,e,t,n)}i3(e,t)}};qB=function(){return Gi};HB=function(e,t){var r=Gi;try{return Gi=e,t()}finally{Gi=r}};Dj=function(e,t,r){switch(t){case"input":if(Oj(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=tS(n);if(!i)throw Error(Jr(90));SB(n),Oj(n,i)}}}break;case"textarea":kB(e,r);break;case"select":t=r.value,t!=null&&am(e,!!r.multiple,t,!1)}};PB=ZN;OB=x0;var DQ={usingClientEntryPoint:!1,Events:[V1,Hp,tS,EB,TB,ZN]},Dg={findFiberByHostInstance:Hh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},$Q={bundleType:Dg.bundleType,version:Dg.version,rendererPackageName:Dg.rendererPackageName,rendererConfig:Dg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:sf.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=RB(e),e===null?null:e.stateNode},findFiberByHostInstance:Dg.findFiberByHostInstance||BQ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bb=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bb.isDisabled&&bb.supportsFiber)try{Qw=bb.inject($Q),ed=bb}catch{}}uc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=DQ;uc.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!s3(t))throw Error(Jr(200));return FQ(e,t,null,r)};uc.createRoot=function(e,t){if(!s3(e))throw Error(Jr(299));var r=!1,n="",i=hD;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=n3(e,1,!1,null,null,r,!1,n,i),e[Hd]=t.current,Yx(e.nodeType===8?e.parentNode:e),new a3(t)};uc.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Jr(188)):(e=Object.keys(e).join(","),Error(Jr(268,e)));return e=RB(t),e=e===null?null:e.stateNode,e};uc.flushSync=function(e){return x0(e)};uc.hydrate=function(e,t,r){if(!uS(t))throw Error(Jr(200));return dS(null,e,t,!0,r)};uc.hydrateRoot=function(e,t,r){if(!s3(e))throw Error(Jr(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=hD;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=fD(t,null,e,1,r??null,i,!1,s,o),e[Hd]=t.current,Yx(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new cS(t)};uc.render=function(e,t,r){if(!uS(t))throw Error(Jr(200));return dS(null,e,t,!1,r)};uc.unmountComponentAtNode=function(e){if(!uS(e))throw Error(Jr(40));return e._reactRootContainer?(x0(function(){dS(null,null,e,!1,function(){e._reactRootContainer=null,e[Hd]=null})}),!0):!1};uc.unstable_batchedUpdates=ZN;uc.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!uS(r))throw Error(Jr(200));if(e==null||e._reactInternals===void 0)throw Error(Jr(38));return dS(e,t,r,!1,n)};uc.version="18.3.1-next-f1338f8080-20240426";function pD(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(pD)}catch(e){console.error(e)}}pD(),pB.exports=uc;var K1=pB.exports,mD,b8=K1;mD=b8.createRoot,b8.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function i1(){return i1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i1.apply(this,arguments)}var qf;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(qf||(qf={}));const v8="popstate";function UQ(e){e===void 0&&(e={});function t(n,i){let{pathname:s,search:o,hash:l}=n.location;return y4("",{pathname:s,search:o,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:A2(i)}return WQ(t,r,null,e)}function ss(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function o3(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function zQ(){return Math.random().toString(36).substr(2,8)}function w8(e,t){return{usr:e.state,key:e.key,idx:t}}function y4(e,t,r,n){return r===void 0&&(r=null),i1({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Jm(t):t,{state:r,key:t&&t.key||n||zQ()})}function A2(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Jm(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function WQ(e,t,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,o=i.history,l=qf.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(i1({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function f(){l=qf.Pop;let y=d(),b=y==null?null:y-u;u=y,c&&c({action:l,location:g.location,delta:b})}function h(y,b){l=qf.Push;let v=y4(g.location,y,b);u=d()+1;let w=w8(v,u),S=g.createHref(v);try{o.pushState(w,"",S)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;i.location.assign(S)}s&&c&&c({action:l,location:g.location,delta:1})}function p(y,b){l=qf.Replace;let v=y4(g.location,y,b);u=d();let w=w8(v,u),S=g.createHref(v);o.replaceState(w,"",S),s&&c&&c({action:l,location:g.location,delta:0})}function m(y){let b=i.location.origin!=="null"?i.location.origin:i.location.href,v=typeof y=="string"?y:A2(y);return v=v.replace(/ $/,"%20"),ss(b,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,b)}let g={get action(){return l},get location(){return e(i,o)},listen(y){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(v8,f),c=y,()=>{i.removeEventListener(v8,f),c=null}},createHref(y){return t(i,y)},createURL:m,encodeLocation(y){let b=m(y);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:h,replace:p,go(y){return o.go(y)}};return g}var S8;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(S8||(S8={}));function qQ(e,t,r){return r===void 0&&(r="/"),HQ(e,t,r)}function HQ(e,t,r,n){let i=typeof t=="string"?Jm(t):t,s=l3(i.pathname||"/",r);if(s==null)return null;let o=gD(e);VQ(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=iJ(s);l=tJ(o[c],u)}return l}function gD(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,o,l)=>{let c={relativePath:l===void 0?s.path||"":l,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};c.relativePath.startsWith("/")&&(ss(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=ih([n,c.relativePath]),d=r.concat(c);s.children&&s.children.length>0&&(ss(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),gD(s.children,t,d,u)),!(s.path==null&&!s.index)&&t.push({path:u,score:ZQ(u,s.index),routesMeta:d})};return e.forEach((s,o)=>{var l;if(s.path===""||!((l=s.path)!=null&&l.includes("?")))i(s,o);else for(let c of xD(s.path))i(s,o,c)}),t}function xD(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let o=xD(n.join("/")),l=[];return l.push(...o.map(c=>c===""?s:[s,c].join("/"))),i&&l.push(...o),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function VQ(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:eJ(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const GQ=/^:[\w-]+$/,KQ=3,YQ=2,XQ=1,QQ=10,JQ=-2,_8=e=>e==="*";function ZQ(e,t){let r=e.split("/"),n=r.length;return r.some(_8)&&(n+=JQ),t&&(n+=YQ),r.filter(i=>!_8(i)).reduce((i,s)=>i+(GQ.test(s)?KQ:s===""?XQ:QQ),n)}function eJ(e,t){return e.length===t.length&&e.slice(0,-1).every((n,i)=>n===t[i])?e[e.length-1]-t[t.length-1]:0}function tJ(e,t,r){let{routesMeta:n}=e,i={},s="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,d=s==="/"?t:t.slice(s.length)||"/",f=rJ({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),h=c.route;if(!f)return null;Object.assign(i,f.params),o.push({params:i,pathname:ih([s,f.pathname]),pathnameBase:cJ(ih([s,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(s=ih([s,f.pathnameBase]))}return o}function rJ(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=nJ(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:n.reduce((u,d,f)=>{let{paramName:h,isOptional:p}=d;if(h==="*"){let g=l[f]||"";o=s.slice(0,s.length-g.length).replace(/(.)\/+$/,"$1")}const m=l[f];return p&&!m?u[h]=void 0:u[h]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:e}}function nJ(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),o3(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function iJ(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return o3(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function l3(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}const aJ=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,sJ=e=>aJ.test(e);function oJ(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:i=""}=typeof e=="string"?Jm(e):e,s;if(r)if(sJ(r))s=r;else{if(r.includes("//")){let o=r;r=r.replace(/\/\/+/g,"/"),o3(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+r))}r.startsWith("/")?s=k8(r.substring(1),"/"):s=k8(r,t)}else s=t;return{pathname:s,search:uJ(n),hash:dJ(i)}}function k8(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function $5(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function lJ(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function c3(e,t){let r=lJ(e);return t?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function u3(e,t,r,n){n===void 0&&(n=!1);let i;typeof e=="string"?i=Jm(e):(i=i1({},e),ss(!i.pathname||!i.pathname.includes("?"),$5("?","pathname","search",i)),ss(!i.pathname||!i.pathname.includes("#"),$5("#","pathname","hash",i)),ss(!i.search||!i.search.includes("#"),$5("#","search","hash",i)));let s=e===""||i.pathname==="",o=s?"/":i.pathname,l;if(o==null)l=r;else{let f=t.length-1;if(!n&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),f-=1;i.pathname=h.join("/")}l=f>=0?t[f]:"/"}let c=oJ(i,l),u=o&&o!=="/"&&o.endsWith("/"),d=(s||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const ih=e=>e.join("/").replace(/\/\/+/g,"/"),cJ=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),uJ=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,dJ=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function fJ(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const yD=["post","put","patch","delete"];new Set(yD);const hJ=["get",...yD];new Set(hJ);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function a1(){return a1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a1.apply(this,arguments)}const d3=x.createContext(null),pJ=x.createContext(null),Sh=x.createContext(null),fS=x.createContext(null),of=x.createContext({outlet:null,matches:[],isDataRoute:!1}),bD=x.createContext(null);function mJ(e,t){let{relative:r}=t===void 0?{}:t;Zm()||ss(!1);let{basename:n,navigator:i}=x.useContext(Sh),{hash:s,pathname:o,search:l}=wD(e,{relative:r}),c=o;return n!=="/"&&(c=o==="/"?n:ih([n,o])),i.createHref({pathname:c,search:l,hash:s})}function Zm(){return x.useContext(fS)!=null}function dl(){return Zm()||ss(!1),x.useContext(fS).location}function vD(e){x.useContext(Sh).static||x.useLayoutEffect(e)}function xo(){let{isDataRoute:e}=x.useContext(of);return e?CJ():gJ()}function gJ(){Zm()||ss(!1);let e=x.useContext(d3),{basename:t,future:r,navigator:n}=x.useContext(Sh),{matches:i}=x.useContext(of),{pathname:s}=dl(),o=JSON.stringify(c3(i,r.v7_relativeSplatPath)),l=x.useRef(!1);return vD(()=>{l.current=!0}),x.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){n.go(u);return}let f=u3(u,JSON.parse(o),s,d.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:ih([t,f.pathname])),(d.replace?n.replace:n.push)(f,d.state,d)},[t,n,o,s,e])}function z0(){let{matches:e}=x.useContext(of),t=e[e.length-1];return t?t.params:{}}function wD(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=x.useContext(Sh),{matches:i}=x.useContext(of),{pathname:s}=dl(),o=JSON.stringify(c3(i,n.v7_relativeSplatPath));return x.useMemo(()=>u3(e,JSON.parse(o),s,r==="path"),[e,o,s,r])}function xJ(e,t){return yJ(e,t)}function yJ(e,t,r,n){Zm()||ss(!1);let{navigator:i}=x.useContext(Sh),{matches:s}=x.useContext(of),o=s[s.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=dl(),d;if(t){var f;let y=typeof t=="string"?Jm(t):t;c==="/"||(f=y.pathname)!=null&&f.startsWith(c)||ss(!1),d=y}else d=u;let h=d.pathname||"/",p=h;if(c!=="/"){let y=c.replace(/^\//,"").split("/");p="/"+h.replace(/^\//,"").split("/").slice(y.length).join("/")}let m=qQ(e,{pathname:p}),g=_J(m&&m.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:ih([c,i.encodeLocation?i.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:ih([c,i.encodeLocation?i.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),s,r,n);return t&&g?x.createElement(fS.Provider,{value:{location:a1({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:qf.Pop}},g):g}function bJ(){let e=NJ(),t=fJ(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return x.createElement(x.Fragment,null,x.createElement("h2",null,"Unexpected Application Error!"),x.createElement("h3",{style:{fontStyle:"italic"}},t),r?x.createElement("pre",{style:i},r):null,null)}const vJ=x.createElement(bJ,null);class wJ extends x.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?x.createElement(of.Provider,{value:this.props.routeContext},x.createElement(bD.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function SJ(e){let{routeContext:t,match:r,children:n}=e,i=x.useContext(d3);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),x.createElement(of.Provider,{value:t},n)}function _J(e,t,r,n){var i;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var s;if(!r)return null;if(r.errors)e=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let o=e,l=(i=r)==null?void 0:i.errors;if(l!=null){let d=o.findIndex(f=>f.route.id&&(l==null?void 0:l[f.route.id])!==void 0);d>=0||ss(!1),o=o.slice(0,Math.min(o.length,d+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<o.length;d++){let f=o[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:h,errors:p}=r,m=f.route.loader&&h[f.route.id]===void 0&&(!p||p[f.route.id]===void 0);if(f.route.lazy||m){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,f,h)=>{let p,m=!1,g=null,y=null;r&&(p=l&&f.route.id?l[f.route.id]:void 0,g=f.route.errorElement||vJ,c&&(u<0&&h===0?(EJ("route-fallback"),m=!0,y=null):u===h&&(m=!0,y=f.route.hydrateFallbackElement||null)));let b=t.concat(o.slice(0,h+1)),v=()=>{let w;return p?w=g:m?w=y:f.route.Component?w=x.createElement(f.route.Component,null):f.route.element?w=f.route.element:w=d,x.createElement(SJ,{match:f,routeContext:{outlet:d,matches:b,isDataRoute:r!=null},children:w})};return r&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?x.createElement(wJ,{location:r.location,revalidation:r.revalidation,component:g,error:p,children:v(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):v()},null)}var SD=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(SD||{}),_D=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(_D||{});function kJ(e){let t=x.useContext(d3);return t||ss(!1),t}function jJ(e){let t=x.useContext(pJ);return t||ss(!1),t}function AJ(e){let t=x.useContext(of);return t||ss(!1),t}function kD(e){let t=AJ(),r=t.matches[t.matches.length-1];return r.route.id||ss(!1),r.route.id}function NJ(){var e;let t=x.useContext(bD),r=jJ(),n=kD();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function CJ(){let{router:e}=kJ(SD.UseNavigateStable),t=kD(_D.UseNavigateStable),r=x.useRef(!1);return vD(()=>{r.current=!0}),x.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,a1({fromRouteId:t},s)))},[e,t])}const j8={};function EJ(e,t,r){j8[e]||(j8[e]=!0)}function TJ(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Jp(e){let{to:t,replace:r,state:n,relative:i}=e;Zm()||ss(!1);let{future:s,static:o}=x.useContext(Sh),{matches:l}=x.useContext(of),{pathname:c}=dl(),u=xo(),d=u3(t,c3(l,s.v7_relativeSplatPath),c,i==="path"),f=JSON.stringify(d);return x.useEffect(()=>u(JSON.parse(f),{replace:r,state:n,relative:i}),[u,f,i,r,n]),null}function ii(e){ss(!1)}function PJ(e){let{basename:t="/",children:r=null,location:n,navigationType:i=qf.Pop,navigator:s,static:o=!1,future:l}=e;Zm()&&ss(!1);let c=t.replace(/^\/*/,"/"),u=x.useMemo(()=>({basename:c,navigator:s,static:o,future:a1({v7_relativeSplatPath:!1},l)}),[c,l,s,o]);typeof n=="string"&&(n=Jm(n));let{pathname:d="/",search:f="",hash:h="",state:p=null,key:m="default"}=n,g=x.useMemo(()=>{let y=l3(d,c);return y==null?null:{location:{pathname:y,search:f,hash:h,state:p,key:m},navigationType:i}},[c,d,f,h,p,m,i]);return g==null?null:x.createElement(Sh.Provider,{value:u},x.createElement(fS.Provider,{children:r,value:g}))}function b4(e){let{children:t,location:r}=e;return xJ(v4(t),r)}new Promise(()=>{});function v4(e,t){t===void 0&&(t=[]);let r=[];return x.Children.forEach(e,(n,i)=>{if(!x.isValidElement(n))return;let s=[...t,i];if(n.type===x.Fragment){r.push.apply(r,v4(n.props.children,s));return}n.type!==ii&&ss(!1),!n.props.index||!n.props.children||ss(!1);let o={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=v4(n.props.children,s)),r.push(o)}),r}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function w4(){return w4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},w4.apply(this,arguments)}function OJ(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function MJ(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function LJ(e,t){return e.button===0&&(!t||t==="_self")&&!MJ(e)}function S4(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(i=>[r,i]):[[r,n]])},[]))}function RJ(e,t){let r=S4(e);return t&&t.forEach((n,i)=>{r.has(i)||t.getAll(i).forEach(s=>{r.append(i,s)})}),r}const FJ=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],BJ="6";try{window.__reactRouterVersion=BJ}catch{}const IJ="startTransition",A8=fB[IJ];function DJ(e){let{basename:t,children:r,future:n,window:i}=e,s=x.useRef();s.current==null&&(s.current=UQ({window:i,v5Compat:!0}));let o=s.current,[l,c]=x.useState({action:o.action,location:o.location}),{v7_startTransition:u}=n||{},d=x.useCallback(f=>{u&&A8?A8(()=>c(f)):c(f)},[c,u]);return x.useLayoutEffect(()=>o.listen(d),[o,d]),x.useEffect(()=>TJ(n),[n]),x.createElement(PJ,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:o,future:n})}const $J=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",UJ=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,es=x.forwardRef(function(t,r){let{onClick:n,relative:i,reloadDocument:s,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:f}=t,h=OJ(t,FJ),{basename:p}=x.useContext(Sh),m,g=!1;if(typeof u=="string"&&UJ.test(u)&&(m=u,$J))try{let w=new URL(window.location.href),S=u.startsWith("//")?new URL(w.protocol+u):new URL(u),k=l3(S.pathname,p);S.origin===w.origin&&k!=null?u=k+S.search+S.hash:g=!0}catch{}let y=mJ(u,{relative:i}),b=zJ(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:i,viewTransition:f});function v(w){n&&n(w),w.defaultPrevented||b(w)}return x.createElement("a",w4({},h,{href:m||y,onClick:g||s?n:v,ref:r,target:c}))});var N8;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(N8||(N8={}));var C8;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(C8||(C8={}));function zJ(e,t){let{target:r,replace:n,state:i,preventScrollReset:s,relative:o,viewTransition:l}=t===void 0?{}:t,c=xo(),u=dl(),d=wD(e,{relative:o});return x.useCallback(f=>{if(LJ(f,r)){f.preventDefault();let h=n!==void 0?n:A2(u)===A2(d);c(e,{replace:h,state:i,preventScrollReset:s,relative:o,viewTransition:l})}},[u,c,d,n,i,r,e,s,o,l])}function WJ(e){let t=x.useRef(S4(e)),r=x.useRef(!1),n=dl(),i=x.useMemo(()=>RJ(n.search,r.current?null:t.current),[n.search]),s=xo(),o=x.useCallback((l,c)=>{const u=S4(typeof l=="function"?l(i):l);r.current=!0,s("?"+u,c)},[s,i]);return[i,o]}function jD(e,t){return function(){return e.apply(t,arguments)}}const{toString:qJ}=Object.prototype,{getPrototypeOf:f3}=Object,{iterator:hS,toStringTag:AD}=Symbol,pS=(e=>t=>{const r=qJ.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),_u=e=>(e=e.toLowerCase(),t=>pS(t)===e),mS=e=>t=>typeof t===e,{isArray:eg}=Array,Om=mS("undefined");function Y1(e){return e!==null&&!Om(e)&&e.constructor!==null&&!Om(e.constructor)&&El(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const ND=_u("ArrayBuffer");function HJ(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&ND(e.buffer),t}const VJ=mS("string"),El=mS("function"),CD=mS("number"),X1=e=>e!==null&&typeof e=="object",GJ=e=>e===!0||e===!1,Bv=e=>{if(pS(e)!=="object")return!1;const t=f3(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(AD in e)&&!(hS in e)},KJ=e=>{if(!X1(e)||Y1(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},YJ=_u("Date"),XJ=_u("File"),QJ=_u("Blob"),JJ=_u("FileList"),ZJ=e=>X1(e)&&El(e.pipe),eZ=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||El(e.append)&&((t=pS(e))==="formdata"||t==="object"&&El(e.toString)&&e.toString()==="[object FormData]"))},tZ=_u("URLSearchParams"),[rZ,nZ,iZ,aZ]=["ReadableStream","Request","Response","Headers"].map(_u),sZ=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Q1(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,i;if(typeof e!="object"&&(e=[e]),eg(e))for(n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else{if(Y1(e))return;const s=r?Object.getOwnPropertyNames(e):Object.keys(e),o=s.length;let l;for(n=0;n<o;n++)l=s[n],t.call(null,e[l],l,e)}}function ED(e,t){if(Y1(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,i;for(;n-- >0;)if(i=r[n],t===i.toLowerCase())return i;return null}const Kh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,TD=e=>!Om(e)&&e!==Kh;function _4(){const{caseless:e,skipUndefined:t}=TD(this)&&this||{},r={},n=(i,s)=>{const o=e&&ED(r,s)||s;Bv(r[o])&&Bv(i)?r[o]=_4(r[o],i):Bv(i)?r[o]=_4({},i):eg(i)?r[o]=i.slice():(!t||!Om(i))&&(r[o]=i)};for(let i=0,s=arguments.length;i<s;i++)arguments[i]&&Q1(arguments[i],n);return r}const oZ=(e,t,r,{allOwnKeys:n}={})=>(Q1(t,(i,s)=>{r&&El(i)?e[s]=jD(i,r):e[s]=i},{allOwnKeys:n}),e),lZ=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),cZ=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},uZ=(e,t,r,n)=>{let i,s,o;const l={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),s=i.length;s-- >0;)o=i[s],(!n||n(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=r!==!1&&f3(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},dZ=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},fZ=e=>{if(!e)return null;if(eg(e))return e;let t=e.length;if(!CD(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},hZ=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&f3(Uint8Array)),pZ=(e,t)=>{const n=(e&&e[hS]).call(e);let i;for(;(i=n.next())&&!i.done;){const s=i.value;t.call(e,s[0],s[1])}},mZ=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},gZ=_u("HTMLFormElement"),xZ=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,i){return n.toUpperCase()+i}),E8=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),yZ=_u("RegExp"),PD=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};Q1(r,(i,s)=>{let o;(o=t(i,s,e))!==!1&&(n[s]=o||i)}),Object.defineProperties(e,n)},bZ=e=>{PD(e,(t,r)=>{if(El(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(El(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},vZ=(e,t)=>{const r={},n=i=>{i.forEach(s=>{r[s]=!0})};return eg(e)?n(e):n(String(e).split(t)),r},wZ=()=>{},SZ=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function _Z(e){return!!(e&&El(e.append)&&e[AD]==="FormData"&&e[hS])}const kZ=e=>{const t=new Array(10),r=(n,i)=>{if(X1(n)){if(t.indexOf(n)>=0)return;if(Y1(n))return n;if(!("toJSON"in n)){t[i]=n;const s=eg(n)?[]:{};return Q1(n,(o,l)=>{const c=r(o,i+1);!Om(c)&&(s[l]=c)}),t[i]=void 0,s}}return n};return r(e,0)},jZ=_u("AsyncFunction"),AZ=e=>e&&(X1(e)||El(e))&&El(e.then)&&El(e.catch),OD=((e,t)=>e?setImmediate:t?((r,n)=>(Kh.addEventListener("message",({source:i,data:s})=>{i===Kh&&s===r&&n.length&&n.shift()()},!1),i=>{n.push(i),Kh.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",El(Kh.postMessage)),NZ=typeof queueMicrotask<"u"?queueMicrotask.bind(Kh):typeof process<"u"&&process.nextTick||OD,CZ=e=>e!=null&&El(e[hS]),mr={isArray:eg,isArrayBuffer:ND,isBuffer:Y1,isFormData:eZ,isArrayBufferView:HJ,isString:VJ,isNumber:CD,isBoolean:GJ,isObject:X1,isPlainObject:Bv,isEmptyObject:KJ,isReadableStream:rZ,isRequest:nZ,isResponse:iZ,isHeaders:aZ,isUndefined:Om,isDate:YJ,isFile:XJ,isBlob:QJ,isRegExp:yZ,isFunction:El,isStream:ZJ,isURLSearchParams:tZ,isTypedArray:hZ,isFileList:JJ,forEach:Q1,merge:_4,extend:oZ,trim:sZ,stripBOM:lZ,inherits:cZ,toFlatObject:uZ,kindOf:pS,kindOfTest:_u,endsWith:dZ,toArray:fZ,forEachEntry:pZ,matchAll:mZ,isHTMLForm:gZ,hasOwnProperty:E8,hasOwnProp:E8,reduceDescriptors:PD,freezeMethods:bZ,toObjectSet:vZ,toCamelCase:xZ,noop:wZ,toFiniteNumber:SZ,findKey:ED,global:Kh,isContextDefined:TD,isSpecCompliantForm:_Z,toJSONObject:kZ,isAsyncFn:jZ,isThenable:AZ,setImmediate:OD,asap:NZ,isIterable:CZ};function si(e,t,r,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),i&&(this.response=i,this.status=i.status?i.status:null)}mr.inherits(si,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:mr.toJSONObject(this.config),code:this.code,status:this.status}}});const MD=si.prototype,LD={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{LD[e]={value:e}});Object.defineProperties(si,LD);Object.defineProperty(MD,"isAxiosError",{value:!0});si.from=(e,t,r,n,i,s)=>{const o=Object.create(MD);mr.toFlatObject(e,o,function(d){return d!==Error.prototype},u=>u!=="isAxiosError");const l=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return si.call(o,l,c,r,n,i),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",s&&Object.assign(o,s),o};const EZ=null;function k4(e){return mr.isPlainObject(e)||mr.isArray(e)}function RD(e){return mr.endsWith(e,"[]")?e.slice(0,-2):e}function T8(e,t,r){return e?e.concat(t).map(function(i,s){return i=RD(i),!r&&s?"["+i+"]":i}).join(r?".":""):t}function TZ(e){return mr.isArray(e)&&!e.some(k4)}const PZ=mr.toFlatObject(mr,{},null,function(t){return/^is[A-Z]/.test(t)});function gS(e,t,r){if(!mr.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=mr.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,y){return!mr.isUndefined(y[g])});const n=r.metaTokens,i=r.visitor||d,s=r.dots,o=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&mr.isSpecCompliantForm(t);if(!mr.isFunction(i))throw new TypeError("visitor must be a function");function u(m){if(m===null)return"";if(mr.isDate(m))return m.toISOString();if(mr.isBoolean(m))return m.toString();if(!c&&mr.isBlob(m))throw new si("Blob is not supported. Use a Buffer instead.");return mr.isArrayBuffer(m)||mr.isTypedArray(m)?c&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function d(m,g,y){let b=m;if(m&&!y&&typeof m=="object"){if(mr.endsWith(g,"{}"))g=n?g:g.slice(0,-2),m=JSON.stringify(m);else if(mr.isArray(m)&&TZ(m)||(mr.isFileList(m)||mr.endsWith(g,"[]"))&&(b=mr.toArray(m)))return g=RD(g),b.forEach(function(w,S){!(mr.isUndefined(w)||w===null)&&t.append(o===!0?T8([g],S,s):o===null?g:g+"[]",u(w))}),!1}return k4(m)?!0:(t.append(T8(y,g,s),u(m)),!1)}const f=[],h=Object.assign(PZ,{defaultVisitor:d,convertValue:u,isVisitable:k4});function p(m,g){if(!mr.isUndefined(m)){if(f.indexOf(m)!==-1)throw Error("Circular reference detected in "+g.join("."));f.push(m),mr.forEach(m,function(b,v){(!(mr.isUndefined(b)||b===null)&&i.call(t,b,mr.isString(v)?v.trim():v,g,h))===!0&&p(b,g?g.concat(v):[v])}),f.pop()}}if(!mr.isObject(e))throw new TypeError("data must be an object");return p(e),t}function P8(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function h3(e,t){this._pairs=[],e&&gS(e,this,t)}const FD=h3.prototype;FD.append=function(t,r){this._pairs.push([t,r])};FD.toString=function(t){const r=t?function(n){return t.call(this,n,P8)}:P8;return this._pairs.map(function(i){return r(i[0])+"="+r(i[1])},"").join("&")};function OZ(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function BD(e,t,r){if(!t)return e;const n=r&&r.encode||OZ;mr.isFunction(r)&&(r={serialize:r});const i=r&&r.serialize;let s;if(i?s=i(t,r):s=mr.isURLSearchParams(t)?t.toString():new h3(t,r).toString(n),s){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class O8{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){mr.forEach(this.handlers,function(n){n!==null&&t(n)})}}const ID={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},MZ=typeof URLSearchParams<"u"?URLSearchParams:h3,LZ=typeof FormData<"u"?FormData:null,RZ=typeof Blob<"u"?Blob:null,FZ={isBrowser:!0,classes:{URLSearchParams:MZ,FormData:LZ,Blob:RZ},protocols:["http","https","file","blob","url","data"]},p3=typeof window<"u"&&typeof document<"u",j4=typeof navigator=="object"&&navigator||void 0,BZ=p3&&(!j4||["ReactNative","NativeScript","NS"].indexOf(j4.product)<0),IZ=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",DZ=p3&&window.location.href||"http://localhost",$Z=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:p3,hasStandardBrowserEnv:BZ,hasStandardBrowserWebWorkerEnv:IZ,navigator:j4,origin:DZ},Symbol.toStringTag,{value:"Module"})),Bo={...$Z,...FZ};function UZ(e,t){return gS(e,new Bo.classes.URLSearchParams,{visitor:function(r,n,i,s){return Bo.isNode&&mr.isBuffer(r)?(this.append(n,r.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...t})}function zZ(e){return mr.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function WZ(e){const t={},r=Object.keys(e);let n;const i=r.length;let s;for(n=0;n<i;n++)s=r[n],t[s]=e[s];return t}function DD(e){function t(r,n,i,s){let o=r[s++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=s>=r.length;return o=!o&&mr.isArray(i)?i.length:o,c?(mr.hasOwnProp(i,o)?i[o]=[i[o],n]:i[o]=n,!l):((!i[o]||!mr.isObject(i[o]))&&(i[o]=[]),t(r,n,i[o],s)&&mr.isArray(i[o])&&(i[o]=WZ(i[o])),!l)}if(mr.isFormData(e)&&mr.isFunction(e.entries)){const r={};return mr.forEachEntry(e,(n,i)=>{t(zZ(n),i,r,0)}),r}return null}function qZ(e,t,r){if(mr.isString(e))try{return(t||JSON.parse)(e),mr.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const J1={transitional:ID,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",i=n.indexOf("application/json")>-1,s=mr.isObject(t);if(s&&mr.isHTMLForm(t)&&(t=new FormData(t)),mr.isFormData(t))return i?JSON.stringify(DD(t)):t;if(mr.isArrayBuffer(t)||mr.isBuffer(t)||mr.isStream(t)||mr.isFile(t)||mr.isBlob(t)||mr.isReadableStream(t))return t;if(mr.isArrayBufferView(t))return t.buffer;if(mr.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return UZ(t,this.formSerializer).toString();if((l=mr.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return gS(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return s||i?(r.setContentType("application/json",!1),qZ(t)):t}],transformResponse:[function(t){const r=this.transitional||J1.transitional,n=r&&r.forcedJSONParsing,i=this.responseType==="json";if(mr.isResponse(t)||mr.isReadableStream(t))return t;if(t&&mr.isString(t)&&(n&&!this.responseType||i)){const o=!(r&&r.silentJSONParsing)&&i;try{return JSON.parse(t,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?si.from(l,si.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Bo.classes.FormData,Blob:Bo.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};mr.forEach(["delete","get","head","post","put","patch"],e=>{J1.headers[e]={}});const HZ=mr.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),VZ=e=>{const t={};let r,n,i;return e&&e.split(`
`).forEach(function(o){i=o.indexOf(":"),r=o.substring(0,i).trim().toLowerCase(),n=o.substring(i+1).trim(),!(!r||t[r]&&HZ[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},M8=Symbol("internals");function $g(e){return e&&String(e).trim().toLowerCase()}function Iv(e){return e===!1||e==null?e:mr.isArray(e)?e.map(Iv):String(e)}function GZ(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const KZ=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function U5(e,t,r,n,i){if(mr.isFunction(n))return n.call(this,t,r);if(i&&(t=r),!!mr.isString(t)){if(mr.isString(n))return t.indexOf(n)!==-1;if(mr.isRegExp(n))return n.test(t)}}function YZ(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function XZ(e,t){const r=mr.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(i,s,o){return this[n].call(this,t,i,s,o)},configurable:!0})})}let Tl=class{constructor(t){t&&this.set(t)}set(t,r,n){const i=this;function s(l,c,u){const d=$g(c);if(!d)throw new Error("header name must be a non-empty string");const f=mr.findKey(i,d);(!f||i[f]===void 0||u===!0||u===void 0&&i[f]!==!1)&&(i[f||c]=Iv(l))}const o=(l,c)=>mr.forEach(l,(u,d)=>s(u,d,c));if(mr.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(mr.isString(t)&&(t=t.trim())&&!KZ(t))o(VZ(t),r);else if(mr.isObject(t)&&mr.isIterable(t)){let l={},c,u;for(const d of t){if(!mr.isArray(d))throw TypeError("Object iterator must return a key-value pair");l[u=d[0]]=(c=l[u])?mr.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}o(l,r)}else t!=null&&s(r,t,n);return this}get(t,r){if(t=$g(t),t){const n=mr.findKey(this,t);if(n){const i=this[n];if(!r)return i;if(r===!0)return GZ(i);if(mr.isFunction(r))return r.call(this,i,n);if(mr.isRegExp(r))return r.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=$g(t),t){const n=mr.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||U5(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let i=!1;function s(o){if(o=$g(o),o){const l=mr.findKey(n,o);l&&(!r||U5(n,n[l],l,r))&&(delete n[l],i=!0)}}return mr.isArray(t)?t.forEach(s):s(t),i}clear(t){const r=Object.keys(this);let n=r.length,i=!1;for(;n--;){const s=r[n];(!t||U5(this,this[s],s,t,!0))&&(delete this[s],i=!0)}return i}normalize(t){const r=this,n={};return mr.forEach(this,(i,s)=>{const o=mr.findKey(n,s);if(o){r[o]=Iv(i),delete r[s];return}const l=t?YZ(s):String(s).trim();l!==s&&delete r[s],r[l]=Iv(i),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return mr.forEach(this,(n,i)=>{n!=null&&n!==!1&&(r[i]=t&&mr.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(i=>n.set(i)),n}static accessor(t){const n=(this[M8]=this[M8]={accessors:{}}).accessors,i=this.prototype;function s(o){const l=$g(o);n[l]||(XZ(i,o),n[l]=!0)}return mr.isArray(t)?t.forEach(s):s(t),this}};Tl.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);mr.reduceDescriptors(Tl.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});mr.freezeMethods(Tl);function z5(e,t){const r=this||J1,n=t||r,i=Tl.from(n.headers);let s=n.data;return mr.forEach(e,function(l){s=l.call(r,s,i.normalize(),t?t.status:void 0)}),i.normalize(),s}function $D(e){return!!(e&&e.__CANCEL__)}function tg(e,t,r){si.call(this,e??"canceled",si.ERR_CANCELED,t,r),this.name="CanceledError"}mr.inherits(tg,si,{__CANCEL__:!0});function UD(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new si("Request failed with status code "+r.status,[si.ERR_BAD_REQUEST,si.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function QZ(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function JZ(e,t){e=e||10;const r=new Array(e),n=new Array(e);let i=0,s=0,o;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),d=n[s];o||(o=u),r[i]=c,n[i]=u;let f=s,h=0;for(;f!==i;)h+=r[f++],f=f%e;if(i=(i+1)%e,i===s&&(s=(s+1)%e),u-o<t)return;const p=d&&u-d;return p?Math.round(h*1e3/p):void 0}}function ZZ(e,t){let r=0,n=1e3/t,i,s;const o=(u,d=Date.now())=>{r=d,i=null,s&&(clearTimeout(s),s=null),e(...u)};return[(...u)=>{const d=Date.now(),f=d-r;f>=n?o(u,d):(i=u,s||(s=setTimeout(()=>{s=null,o(i)},n-f)))},()=>i&&o(i)]}const N2=(e,t,r=3)=>{let n=0;const i=JZ(50,250);return ZZ(s=>{const o=s.loaded,l=s.lengthComputable?s.total:void 0,c=o-n,u=i(c),d=o<=l;n=o;const f={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&d?(l-o)/u:void 0,event:s,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(f)},r)},L8=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},R8=e=>(...t)=>mr.asap(()=>e(...t)),eee=Bo.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Bo.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Bo.origin),Bo.navigator&&/(msie|trident)/i.test(Bo.navigator.userAgent)):()=>!0,tee=Bo.hasStandardBrowserEnv?{write(e,t,r,n,i,s,o){if(typeof document>"u")return;const l=[`${e}=${encodeURIComponent(t)}`];mr.isNumber(r)&&l.push(`expires=${new Date(r).toUTCString()}`),mr.isString(n)&&l.push(`path=${n}`),mr.isString(i)&&l.push(`domain=${i}`),s===!0&&l.push("secure"),mr.isString(o)&&l.push(`SameSite=${o}`),document.cookie=l.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function ree(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function nee(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function zD(e,t,r){let n=!ree(t);return e&&(n||r==!1)?nee(e,t):t}const F8=e=>e instanceof Tl?{...e}:e;function y0(e,t){t=t||{};const r={};function n(u,d,f,h){return mr.isPlainObject(u)&&mr.isPlainObject(d)?mr.merge.call({caseless:h},u,d):mr.isPlainObject(d)?mr.merge({},d):mr.isArray(d)?d.slice():d}function i(u,d,f,h){if(mr.isUndefined(d)){if(!mr.isUndefined(u))return n(void 0,u,f,h)}else return n(u,d,f,h)}function s(u,d){if(!mr.isUndefined(d))return n(void 0,d)}function o(u,d){if(mr.isUndefined(d)){if(!mr.isUndefined(u))return n(void 0,u)}else return n(void 0,d)}function l(u,d,f){if(f in t)return n(u,d);if(f in e)return n(void 0,u)}const c={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(u,d,f)=>i(F8(u),F8(d),f,!0)};return mr.forEach(Object.keys({...e,...t}),function(d){const f=c[d]||i,h=f(e[d],t[d],d);mr.isUndefined(h)&&f!==l||(r[d]=h)}),r}const WD=e=>{const t=y0({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:i,xsrfCookieName:s,headers:o,auth:l}=t;if(t.headers=o=Tl.from(o),t.url=BD(zD(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),mr.isFormData(r)){if(Bo.hasStandardBrowserEnv||Bo.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(mr.isFunction(r.getHeaders)){const c=r.getHeaders(),u=["content-type","content-length"];Object.entries(c).forEach(([d,f])=>{u.includes(d.toLowerCase())&&o.set(d,f)})}}if(Bo.hasStandardBrowserEnv&&(n&&mr.isFunction(n)&&(n=n(t)),n||n!==!1&&eee(t.url))){const c=i&&s&&tee.read(s);c&&o.set(i,c)}return t},iee=typeof XMLHttpRequest<"u",aee=iee&&function(e){return new Promise(function(r,n){const i=WD(e);let s=i.data;const o=Tl.from(i.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=i,d,f,h,p,m;function g(){p&&p(),m&&m(),i.cancelToken&&i.cancelToken.unsubscribe(d),i.signal&&i.signal.removeEventListener("abort",d)}let y=new XMLHttpRequest;y.open(i.method.toUpperCase(),i.url,!0),y.timeout=i.timeout;function b(){if(!y)return;const w=Tl.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),k={data:!l||l==="text"||l==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:w,config:e,request:y};UD(function(A){r(A),g()},function(A){n(A),g()},k),y=null}"onloadend"in y?y.onloadend=b:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(b)},y.onabort=function(){y&&(n(new si("Request aborted",si.ECONNABORTED,e,y)),y=null)},y.onerror=function(S){const k=S&&S.message?S.message:"Network Error",j=new si(k,si.ERR_NETWORK,e,y);j.event=S||null,n(j),y=null},y.ontimeout=function(){let S=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const k=i.transitional||ID;i.timeoutErrorMessage&&(S=i.timeoutErrorMessage),n(new si(S,k.clarifyTimeoutError?si.ETIMEDOUT:si.ECONNABORTED,e,y)),y=null},s===void 0&&o.setContentType(null),"setRequestHeader"in y&&mr.forEach(o.toJSON(),function(S,k){y.setRequestHeader(k,S)}),mr.isUndefined(i.withCredentials)||(y.withCredentials=!!i.withCredentials),l&&l!=="json"&&(y.responseType=i.responseType),u&&([h,m]=N2(u,!0),y.addEventListener("progress",h)),c&&y.upload&&([f,p]=N2(c),y.upload.addEventListener("progress",f),y.upload.addEventListener("loadend",p)),(i.cancelToken||i.signal)&&(d=w=>{y&&(n(!w||w.type?new tg(null,e,y):w),y.abort(),y=null)},i.cancelToken&&i.cancelToken.subscribe(d),i.signal&&(i.signal.aborted?d():i.signal.addEventListener("abort",d)));const v=QZ(i.url);if(v&&Bo.protocols.indexOf(v)===-1){n(new si("Unsupported protocol "+v+":",si.ERR_BAD_REQUEST,e));return}y.send(s||null)})},see=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,i;const s=function(u){if(!i){i=!0,l();const d=u instanceof Error?u:this.reason;n.abort(d instanceof si?d:new tg(d instanceof Error?d.message:d))}};let o=t&&setTimeout(()=>{o=null,s(new si(`timeout ${t} of ms exceeded`,si.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(s):u.removeEventListener("abort",s)}),e=null)};e.forEach(u=>u.addEventListener("abort",s));const{signal:c}=n;return c.unsubscribe=()=>mr.asap(l),c}},oee=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,i;for(;n<r;)i=n+t,yield e.slice(n,i),n=i},lee=async function*(e,t){for await(const r of cee(e))yield*oee(r,t)},cee=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},B8=(e,t,r,n)=>{const i=lee(e,t);let s=0,o,l=c=>{o||(o=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await i.next();if(u){l(),c.close();return}let f=d.byteLength;if(r){let h=s+=f;r(h)}c.enqueue(new Uint8Array(d))}catch(u){throw l(u),u}},cancel(c){return l(c),i.return()}},{highWaterMark:2})},I8=64*1024,{isFunction:vb}=mr,uee=(({Request:e,Response:t})=>({Request:e,Response:t}))(mr.global),{ReadableStream:D8,TextEncoder:$8}=mr.global,U8=(e,...t)=>{try{return!!e(...t)}catch{return!1}},dee=e=>{e=mr.merge.call({skipUndefined:!0},uee,e);const{fetch:t,Request:r,Response:n}=e,i=t?vb(t):typeof fetch=="function",s=vb(r),o=vb(n);if(!i)return!1;const l=i&&vb(D8),c=i&&(typeof $8=="function"?(m=>g=>m.encode(g))(new $8):async m=>new Uint8Array(await new r(m).arrayBuffer())),u=s&&l&&U8(()=>{let m=!1;const g=new r(Bo.origin,{body:new D8,method:"POST",get duplex(){return m=!0,"half"}}).headers.has("Content-Type");return m&&!g}),d=o&&l&&U8(()=>mr.isReadableStream(new n("").body)),f={stream:d&&(m=>m.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach(m=>{!f[m]&&(f[m]=(g,y)=>{let b=g&&g[m];if(b)return b.call(g);throw new si(`Response type '${m}' is not supported`,si.ERR_NOT_SUPPORT,y)})});const h=async m=>{if(m==null)return 0;if(mr.isBlob(m))return m.size;if(mr.isSpecCompliantForm(m))return(await new r(Bo.origin,{method:"POST",body:m}).arrayBuffer()).byteLength;if(mr.isArrayBufferView(m)||mr.isArrayBuffer(m))return m.byteLength;if(mr.isURLSearchParams(m)&&(m=m+""),mr.isString(m))return(await c(m)).byteLength},p=async(m,g)=>{const y=mr.toFiniteNumber(m.getContentLength());return y??h(g)};return async m=>{let{url:g,method:y,data:b,signal:v,cancelToken:w,timeout:S,onDownloadProgress:k,onUploadProgress:j,responseType:A,headers:L,withCredentials:P="same-origin",fetchOptions:F}=WD(m),E=t||fetch;A=A?(A+"").toLowerCase():"text";let T=see([v,w&&w.toAbortSignal()],S),B=null;const q=T&&T.unsubscribe&&(()=>{T.unsubscribe()});let U;try{if(j&&u&&y!=="get"&&y!=="head"&&(U=await p(L,b))!==0){let Y=new r(g,{method:"POST",body:b,duplex:"half"}),C;if(mr.isFormData(b)&&(C=Y.headers.get("content-type"))&&L.setContentType(C),Y.body){const[K,H]=L8(U,N2(R8(j)));b=B8(Y.body,I8,K,H)}}mr.isString(P)||(P=P?"include":"omit");const se=s&&"credentials"in r.prototype,de={...F,signal:T,method:y.toUpperCase(),headers:L.normalize().toJSON(),body:b,duplex:"half",credentials:se?P:void 0};B=s&&new r(g,de);let z=await(s?E(B,F):E(g,de));const G=d&&(A==="stream"||A==="response");if(d&&(k||G&&q)){const Y={};["status","statusText","headers"].forEach(R=>{Y[R]=z[R]});const C=mr.toFiniteNumber(z.headers.get("content-length")),[K,H]=k&&L8(C,N2(R8(k),!0))||[];z=new n(B8(z.body,I8,K,()=>{H&&H(),q&&q()}),Y)}A=A||"text";let ie=await f[mr.findKey(f,A)||"text"](z,m);return!G&&q&&q(),await new Promise((Y,C)=>{UD(Y,C,{data:ie,headers:Tl.from(z.headers),status:z.status,statusText:z.statusText,config:m,request:B})})}catch(se){throw q&&q(),se&&se.name==="TypeError"&&/Load failed|fetch/i.test(se.message)?Object.assign(new si("Network Error",si.ERR_NETWORK,m,B),{cause:se.cause||se}):si.from(se,se&&se.code,m,B)}}},fee=new Map,qD=e=>{let t=e&&e.env||{};const{fetch:r,Request:n,Response:i}=t,s=[n,i,r];let o=s.length,l=o,c,u,d=fee;for(;l--;)c=s[l],u=d.get(c),u===void 0&&d.set(c,u=l?new Map:dee(t)),d=u;return u};qD();const m3={http:EZ,xhr:aee,fetch:{get:qD}};mr.forEach(m3,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const z8=e=>`- ${e}`,hee=e=>mr.isFunction(e)||e===null||e===!1;function pee(e,t){e=mr.isArray(e)?e:[e];const{length:r}=e;let n,i;const s={};for(let o=0;o<r;o++){n=e[o];let l;if(i=n,!hee(n)&&(i=m3[(l=String(n)).toLowerCase()],i===void 0))throw new si(`Unknown adapter '${l}'`);if(i&&(mr.isFunction(i)||(i=i.get(t))))break;s[l||"#"+o]=i}if(!i){const o=Object.entries(s).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let l=r?o.length>1?`since :
`+o.map(z8).join(`
`):" "+z8(o[0]):"as no adapter specified";throw new si("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return i}const HD={getAdapter:pee,adapters:m3};function W5(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new tg(null,e)}function W8(e){return W5(e),e.headers=Tl.from(e.headers),e.data=z5.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),HD.getAdapter(e.adapter||J1.adapter,e)(e).then(function(n){return W5(e),n.data=z5.call(e,e.transformResponse,n),n.headers=Tl.from(n.headers),n},function(n){return $D(n)||(W5(e),n&&n.response&&(n.response.data=z5.call(e,e.transformResponse,n.response),n.response.headers=Tl.from(n.response.headers))),Promise.reject(n)})}const VD="1.13.2",xS={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{xS[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const q8={};xS.transitional=function(t,r,n){function i(s,o){return"[Axios v"+VD+"] Transitional option '"+s+"'"+o+(n?". "+n:"")}return(s,o,l)=>{if(t===!1)throw new si(i(o," has been removed"+(r?" in "+r:"")),si.ERR_DEPRECATED);return r&&!q8[o]&&(q8[o]=!0,console.warn(i(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(s,o,l):!0}};xS.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function mee(e,t,r){if(typeof e!="object")throw new si("options must be an object",si.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let i=n.length;for(;i-- >0;){const s=n[i],o=t[s];if(o){const l=e[s],c=l===void 0||o(l,s,e);if(c!==!0)throw new si("option "+s+" must be "+c,si.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new si("Unknown option "+s,si.ERR_BAD_OPTION)}}const Dv={assertOptions:mee,validators:xS},Pu=Dv.validators;let n0=class{constructor(t){this.defaults=t||{},this.interceptors={request:new O8,response:new O8}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{n.stack?s&&!String(n.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+s):n.stack=s}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=y0(this.defaults,r);const{transitional:n,paramsSerializer:i,headers:s}=r;n!==void 0&&Dv.assertOptions(n,{silentJSONParsing:Pu.transitional(Pu.boolean),forcedJSONParsing:Pu.transitional(Pu.boolean),clarifyTimeoutError:Pu.transitional(Pu.boolean)},!1),i!=null&&(mr.isFunction(i)?r.paramsSerializer={serialize:i}:Dv.assertOptions(i,{encode:Pu.function,serialize:Pu.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Dv.assertOptions(r,{baseUrl:Pu.spelling("baseURL"),withXsrfToken:Pu.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=s&&mr.merge(s.common,s[r.method]);s&&mr.forEach(["delete","get","head","post","put","patch","common"],m=>{delete s[m]}),r.headers=Tl.concat(o,s);const l=[];let c=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(r)===!1||(c=c&&g.synchronous,l.unshift(g.fulfilled,g.rejected))});const u=[];this.interceptors.response.forEach(function(g){u.push(g.fulfilled,g.rejected)});let d,f=0,h;if(!c){const m=[W8.bind(this),void 0];for(m.unshift(...l),m.push(...u),h=m.length,d=Promise.resolve(r);f<h;)d=d.then(m[f++],m[f++]);return d}h=l.length;let p=r;for(;f<h;){const m=l[f++],g=l[f++];try{p=m(p)}catch(y){g.call(this,y);break}}try{d=W8.call(this,p)}catch(m){return Promise.reject(m)}for(f=0,h=u.length;f<h;)d=d.then(u[f++],u[f++]);return d}getUri(t){t=y0(this.defaults,t);const r=zD(t.baseURL,t.url,t.allowAbsoluteUrls);return BD(r,t.params,t.paramsSerializer)}};mr.forEach(["delete","get","head","options"],function(t){n0.prototype[t]=function(r,n){return this.request(y0(n||{},{method:t,url:r,data:(n||{}).data}))}});mr.forEach(["post","put","patch"],function(t){function r(n){return function(s,o,l){return this.request(y0(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}n0.prototype[t]=r(),n0.prototype[t+"Form"]=r(!0)});let gee=class GD{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(s){r=s});const n=this;this.promise.then(i=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](i);n._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(l=>{n.subscribe(l),s=l}).then(i);return o.cancel=function(){n.unsubscribe(s)},o},t(function(s,o,l){n.reason||(n.reason=new tg(s,o,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new GD(function(i){t=i}),cancel:t}}};function xee(e){return function(r){return e.apply(null,r)}}function yee(e){return mr.isObject(e)&&e.isAxiosError===!0}const A4={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(A4).forEach(([e,t])=>{A4[t]=e});function KD(e){const t=new n0(e),r=jD(n0.prototype.request,t);return mr.extend(r,n0.prototype,t,{allOwnKeys:!0}),mr.extend(r,t,null,{allOwnKeys:!0}),r.create=function(i){return KD(y0(e,i))},r}const Ra=KD(J1);Ra.Axios=n0;Ra.CanceledError=tg;Ra.CancelToken=gee;Ra.isCancel=$D;Ra.VERSION=VD;Ra.toFormData=gS;Ra.AxiosError=si;Ra.Cancel=Ra.CanceledError;Ra.all=function(t){return Promise.all(t)};Ra.spread=xee;Ra.isAxiosError=yee;Ra.mergeConfig=y0;Ra.AxiosHeaders=Tl;Ra.formToJSON=e=>DD(mr.isHTMLForm(e)?new FormData(e):e);Ra.getAdapter=HD.getAdapter;Ra.HttpStatusCode=A4;Ra.default=Ra;const{Axios:fMe,AxiosError:hMe,CanceledError:pMe,isCancel:mMe,CancelToken:gMe,VERSION:xMe,all:yMe,Cancel:bMe,isAxiosError:vMe,spread:wMe,toFormData:SMe,AxiosHeaders:N4,HttpStatusCode:_Me,formToJSON:kMe,getAdapter:jMe,mergeConfig:AMe}=Ra;function bee(){var e;if(typeof window<"u"&&((e=window.location)!=null&&e.origin)){const t=String(window.location.hostname||"").trim().toLowerCase();return t==="localhost"||t==="127.0.0.1"?"http://localhost:8000":String(window.location.origin).replace(/\/+$/,"")}return"https://db.krgi.co.in"}const YD=`${bee()}/api/accounts/`,rl=Ra.create({baseURL:YD});let q5=!1,C4=[];function vee(e){C4.push(e)}function wee(e){C4.forEach(t=>t(e)),C4=[]}async function See(){const e=localStorage.getItem("refresh");if(!e)throw new Error("no refresh token");const t=await Ra.post(`${YD}token/refresh/`,{refresh:e}),{access:r,refresh:n}=t.data;return r&&localStorage.setItem("access",r),n&&localStorage.setItem("refresh",n),r}rl.interceptors.response.use(e=>e,async e=>{const t=e.config;if(e.response&&e.response.status===401&&!t._retry){if(t._retry=!0,q5)return new Promise(r=>{vee(n=>{const i=t.headers??{};i.Authorization=`Bearer ${n}`,t.headers=new N4(i),r(rl(t))})});q5=!0;try{const r=await See();wee(r);const n=t.headers??{};return n.Authorization=`Bearer ${r}`,t.headers=new N4(n),rl(t)}catch(r){return g3(),Promise.reject(r)}finally{q5=!1}}return Promise.reject(e)});async function XD(e,t){const r=await rl.post("token/",{identifier:e,password:t}),{access:n,refresh:i}=r.data;localStorage.setItem("access",n),localStorage.setItem("refresh",i);try{await b0()}catch{}return r.data}function g3(){localStorage.removeItem("access"),localStorage.removeItem("refresh"),localStorage.removeItem("roles"),localStorage.removeItem("permissions"),localStorage.removeItem("me")}rl.interceptors.request.use(e=>{const t=localStorage.getItem("access");if(t){const r=e.headers??{};r.Authorization=`Bearer ${t}`,e.headers=new N4(r)}return e});async function b0(){if(!localStorage.getItem("access"))throw new Error("no access token");const r=(await rl.get("me/")).data;try{localStorage.setItem("roles",JSON.stringify(r.roles||[])),localStorage.setItem("permissions",JSON.stringify(r.permissions||[])),localStorage.setItem("me",JSON.stringify(r||null))}catch{}return r}function QD(){try{const e=localStorage.getItem("me");return e?JSON.parse(e):null}catch{return null}}function JD(){var t;const e=QD();return!!((t=e==null?void 0:e.profile)!=null&&t.mobile_verified)}async function as(){var e;if(JD())return!0;try{const t=await b0();return!!((e=t==null?void 0:t.profile)!=null&&e.mobile_verified)}catch{return!1}}async function ZD(e){return(await rl.post("mobile/request-otp/",{mobile_number:e})).data}async function e9(e,t){return(await rl.post("mobile/verify-otp/",{mobile_number:e,otp:t})).data}const _ee=Object.freeze(Object.defineProperty({__proto__:null,apiClient:rl,ensureMobileVerified:as,getCachedMe:QD,getMe:b0,isMobileVerifiedCached:JD,login:XD,logout:g3,requestMobileOtp:ZD,verifyMobileOtp:e9},Symbol.toStringTag,{value:"Module"})),kee="/assets/idcs-logo-Ci6ccowJ.png";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t9=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jee=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aee=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase());/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H8=e=>{const t=Aee(e);return t.charAt(0).toUpperCase()+t.slice(1)};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Nee={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cee=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eee=x.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:o,...l},c)=>x.createElement("svg",{ref:c,...Nee,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:t9("lucide",i),...!s&&!Cee(l)&&{"aria-hidden":"true"},...l},[...o.map(([u,d])=>x.createElement(u,d)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vn=(e,t)=>{const r=x.forwardRef(({className:n,...i},s)=>x.createElement(Eee,{ref:s,iconNode:t,className:t9(`lucide-${jee(H8(e))}`,`lucide-${e}`,n),...i}));return r.displayName=H8(e),r};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tee=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Ax=Vn("bell",Tee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pee=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],gs=Vn("book-open",Pee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oee=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],Mee=Vn("briefcase",Oee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lee=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],Ree=Vn("building",Lee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fee=[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]],E4=Vn("calendar-clock",Fee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bee=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],ys=Vn("calendar",Bee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iee=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Dee=Vn("check",Iee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ee=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Uee=Vn("chevron-down",$ee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zee=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],rd=Vn("circle-alert",zee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wee=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],x3=Vn("circle-check-big",Wee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qee=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Hf=Vn("circle-check",qee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hee=[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Vee=Vn("circle-user-round",Hee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gee=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],y3=Vn("circle-x",Gee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kee=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],C2=Vn("clipboard-list",Kee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yee=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],sc=Vn("clock",Yee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xee=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],T4=Vn("download",Xee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qee=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Jee=Vn("eye-off",Qee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zee=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],r9=Vn("eye",Zee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ete=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],tte=Vn("file-spreadsheet",ete);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rte=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],nte=Vn("file-text",rte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ite=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],ate=Vn("funnel",ite);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ste=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],Z1=Vn("graduation-cap",ste);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ote=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],P4=Vn("grid-3x3",ote);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lte=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],E2=Vn("house",lte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cte=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Yu=Vn("loader-circle",cte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ute=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],dte=Vn("lock-open",ute);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fte=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],i0=Vn("lock",fte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hte=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],pte=Vn("log-in",hte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mte=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],gte=Vn("log-out",mte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xte=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],b3=Vn("mail",xte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yte=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],bte=Vn("menu",yte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vte=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],V8=Vn("panels-top-left",vte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wte=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Ste=Vn("phone",wte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _te=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Mm=Vn("plus",_te);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kte=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],T2=Vn("refresh-cw",kte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jte=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],id=Vn("save",jte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ate=[["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M18 5v16",key:"1ethyx"}],["path",{d:"m4 6 7.106-3.79a2 2 0 0 1 1.788 0L20 6",key:"zywc2d"}],["path",{d:"m6 11-3.52 2.147a1 1 0 0 0-.48.854V19a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a1 1 0 0 0-.48-.853L18 11",key:"1d4ql0"}],["path",{d:"M6 5v16",key:"1sn0nx"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]],Nte=Vn("school",Ate);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cte=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Ete=Vn("send",Cte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tte=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Pte=Vn("shield",Tte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ote=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],uh=Vn("square-pen",Ote);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mte=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],s1=Vn("trash-2",Mte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lte=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Rte=Vn("trending-up",Lte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fte=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],P2=Vn("upload",Fte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bte=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],$v=Vn("user-check",Bte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ite=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Dte=Vn("user-plus",Ite);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $te=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],Ute=Vn("user-x",$te);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zte=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],W0=Vn("user",zte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wte=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],bs=Vn("users",Wte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qte=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],vu=Vn("x",qte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hte=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Vte=Vn("zoom-in",Hte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gte=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Kte=Vn("zoom-out",Gte),n9=x.createContext(void 0);function Yte({children:e}){const[t,r]=x.useState(()=>typeof window<"u"?window.innerWidth<1024:!0),n=()=>r(i=>!i);return a.jsx(n9.Provider,{value:{collapsed:t,toggle:n,setCollapsed:r},children:e})}function v3(){const e=x.useContext(n9);if(!e)throw new Error("useSidebar must be used within SidebarProvider");return e}function i9({user:e}){const t=xo(),n=dl().pathname==="/login",{collapsed:i,toggle:s}=v3(),o=()=>{g3(),t("/login")};return a.jsx("nav",{className:"bg-white shadow-md border-b border-gray-200 fixed top-0 left-0 right-0 z-40 overflow-x-hidden",children:a.jsx("div",{className:"px-4 max-w-full",children:a.jsxs("div",{className:"flex items-center justify-between h-16",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("button",{className:"p-2 rounded-lg text-gray-600 hover:bg-gray-100 hover:text-gray-900 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:s,"aria-label":"Toggle sidebar",children:i?a.jsx(bte,{className:"h-6 w-6"}):a.jsx(vu,{className:"h-6 w-6"})}),a.jsx(es,{to:"/dashboard",className:"flex items-center gap-3 group",children:a.jsx("img",{src:kee,alt:"IDCS Logo",className:"h-12 w-12 object-contain transition-transform duration-200 group-hover:scale-110",onError:l=>{l.currentTarget.style.display="none"}})})]}),a.jsx("div",{className:"flex items-center gap-3",children:e?a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"hidden sm:block",children:a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-blue-50 rounded-lg",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-white font-semibold text-sm",children:e.username.charAt(0).toUpperCase()})}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:e.username})]})}),a.jsxs("button",{onClick:o,className:"flex items-center gap-2 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg font-medium transition-colors",children:[a.jsx(gte,{className:"h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]}):n?a.jsxs(es,{to:"/",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md transform hover:scale-105",children:[a.jsx(E2,{className:"h-4 w-4"}),a.jsx("span",{children:"Home"})]}):a.jsxs(es,{to:"/login",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md transform hover:scale-105",children:[a.jsx(pte,{className:"h-4 w-4"}),a.jsx("span",{children:"Login"})]})})]})})})}function a9(){var e;if(typeof window<"u"&&((e=window.location)!=null&&e.origin)){const t=String(window.location.hostname||"").trim().toLowerCase();return t==="localhost"||t==="127.0.0.1"?"http://localhost:8000":String(window.location.origin).replace(/\/+$/,"")}return"https://db.krgi.co.in"}const Xte=a9();let H5=!1,Ug=null;async function Qte(){return H5&&Ug||(H5=!0,Ug=(async()=>{try{const e=window.localStorage.getItem("refresh");if(!e)throw new Error("no refresh token");const t=await fetch(`${Xte}/api/accounts/token/refresh/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:e})});if(!t.ok)throw window.localStorage.removeItem("access"),window.localStorage.removeItem("refresh"),new Error("refresh failed");const r=await t.json();return r.access&&window.localStorage.setItem("access",r.access),r.refresh&&window.localStorage.setItem("refresh",r.refresh),r.access}finally{H5=!1,Ug=null}})()),Ug}async function xr(e,t={},r=!0){const n=window.localStorage.getItem("access"),i=t.body instanceof FormData,s=Object.assign({},t.headers||{});i||(s["Content-Type"]="application/json"),n?s.Authorization=`Bearer ${n}`:console.warn("No access token found in localStorage");let o=e;try{typeof e=="string"&&e.startsWith("/api")&&(o=`${a9()}${e}`)}catch{}const l=await fetch(o,{...t,headers:s});if(l.status===400){const c=await l.text();console.error("400 Bad Request:",{url:o,token:n,response:c})}if(l.status===401||l.status===403){let c="";try{c=await l.text()}catch{}const u={};try{l.headers.forEach((d,f)=>{u[f]=d})}catch{}console.error("Auth error from fetchWithAuth",{url:String(o),status:l.status,requestHeaders:s,responseHeaders:u,token:n,responseText:c})}if(l.status!==401||!r)return l;try{const c=await Qte(),u=Object.assign({},t.headers||{});return i||(u["Content-Type"]="application/json"),u.Authorization=`Bearer ${c}`,fetch(o,{...t,headers:u})}catch(c){try{window.localStorage.removeItem("access"),window.localStorage.removeItem("refresh")}catch{}console.error("Token refresh failed:",c);try{typeof window<"u"&&setTimeout(()=>{try{window.location.href="/login"}catch{}},50)}catch{}return l}}async function Jte(e=""){const t=e?`${e}/api/accounts/dashboard/`:"/api/accounts/dashboard/",r=await xr(t,{method:"GET"});if(!r.ok){const n=await r.text();throw new Error(`Dashboard fetch failed: ${r.status} ${n}`)}return r.json()}function Zte(e=""){const[t,r]=x.useState(null),[n,i]=x.useState(!0),[s,o]=x.useState(null),l=x.useCallback(async()=>{i(!0),o(null);try{const c=await Jte(e);r(c)}catch(c){o(c)}finally{i(!1)}},[e]);return x.useEffect(()=>{l()},[l]),{data:t,loading:n,error:s,refresh:l}}const ere="modulepreload",tre=function(e){return"/"+e},G8={},dm=function(t,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(r.map(c=>{if(c=tre(c),c in G8)return;G8[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":ere,u||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),u)return new Promise((h,p)=>{f.addEventListener("load",h),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return t().catch(s)})};async function fc(){var t;const e=`${xn()}/api/academics/my-teaching-assignments/`;try{return(await rl.get(e)).data}catch(r){if(((t=r==null?void 0:r.response)==null?void 0:t.status)===401)return[];throw r}}function xn(){var e;if(typeof window<"u"&&((e=window.location)!=null&&e.origin)){const t=String(window.location.hostname||"").trim().toLowerCase();return t==="localhost"||t==="127.0.0.1"?"http://localhost:8000":String(window.location.origin).replace(/\/+$/,"")}return"https://db.krgi.co.in"}function ai(){const e=window.localStorage.getItem("access");return e?{Authorization:`Bearer ${e}`}:{}}async function w3(e,t,r){const n=`${xn()}/api/obe/iqac/reset/${encodeURIComponent(String(e))}/${encodeURIComponent(String(t))}`;return(await rl.post(n,{teaching_assignment_id:r})).data}async function s9(e){var i;const t=`${xn()}/api/obe/iqac/reset-notifications`,r=e?{teaching_assignment_id:e}:{};return((i=(await rl.get(t,{params:r})).data)==null?void 0:i.notifications)||[]}async function o9(e){const t=`${xn()}/api/obe/iqac/reset-notifications/dismiss`;return(await rl.post(t,{notification_ids:e})).data}async function rre(){try{const e=xn(),t=localStorage.getItem("refresh");if(!t)return null;const r=await Ra.post(`${e}/api/accounts/token/refresh/`,{refresh:t}),{access:n,refresh:i}=r.data||{};return n&&localStorage.setItem("access",n),i&&localStorage.setItem("refresh",i),n||null}catch{try{(await dm(()=>Promise.resolve().then(()=>_ee),void 0)).logout()}catch{}return null}}async function ua(e,t){const r={"Content-Type":"application/json",...(t==null?void 0:t.headers)||{},...ai()},n={...t||{},headers:r};let i=await fetch(e,n);if(i.status!==401)return i;const s=await rre();if(!s)return i;const o={...n.headers,Authorization:`Bearer ${s}`},l={...n,headers:o};return i=await fetch(e,l),i}async function yS(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${xn()}/api/obe/mark-table-lock/${encodeURIComponent(e)}/${encodeURIComponent(t)}${n}`,s=await ua(i,{method:"GET"});return s.status===401?{assessment:e,subject_code:String(t),teaching_assignment_id:typeof r=="number"?r:null,academic_year:null,section_name:null,exists:!1,is_published:!1,published_blocked:!1,mark_entry_blocked:!1,mark_manager_locked:!1,mark_entry_unblocked_until:null,mark_manager_unlocked_until:null,entry_open:!1,mark_manager_editable:!0,updated_at:null}:(s.ok||await wn(s,"Mark table lock fetch failed"),s.json())}async function nre(e){const t=await fm(e);return Array.isArray(t==null?void 0:t.enabled_assessments)?t.enabled_assessments.map(r=>String(r).trim().toLowerCase()).filter(Boolean):[]}async function fm(e){const t=`${xn()}/api/academics/teaching-assignments/${encodeURIComponent(String(e))}/enabled_assessments/`,r=await ua(t,{method:"GET"});if(r.status===401||r.status===404)return{enabled_assessments:[],meta:{locked:!1,can_edit:!1}};r.ok||await wn(r,"Failed to fetch enabled assessments");const n=await r.json();return{enabled_assessments:Array.isArray(n==null?void 0:n.enabled_assessments)?n.enabled_assessments.map(i=>String(i).trim().toLowerCase()).filter(Boolean):[],meta:(n==null?void 0:n.meta)||void 0}}async function ire(e,t){const r=`${xn()}/api/academics/teaching-assignments/${encodeURIComponent(String(e))}/enabled_assessments/`,n=await ua(r,{method:"POST",body:JSON.stringify({enabled_assessments:t})});if(n.status===401)throw new Error("Authentication required");n.ok||await wn(n,"Failed to save enabled assessments");const i=await n.json();return Array.isArray(i==null?void 0:i.enabled_assessments)?i.enabled_assessments:[]}async function l9(e,t){const r=`${xn()}/api/academics/teaching-assignments/${encodeURIComponent(String(e))}/enabled_assessments/`,n=await ua(r,{method:"POST",body:JSON.stringify({enabled_assessments:t})});if(n.status===401)throw new Error("Authentication required");n.ok||await wn(n,"Failed to save enabled assessments");const i=await n.json();return{enabled_assessments:Array.isArray(i==null?void 0:i.enabled_assessments)?i.enabled_assessments:[],meta:(i==null?void 0:i.meta)||void 0}}async function c9(e){const t=`${xn()}/api/academics/teaching-assignments/${encodeURIComponent(String(e))}/enabled_assessments/request-edit/`,r=await ua(t,{method:"POST",body:JSON.stringify({})});if(r.status===401)throw new Error("Authentication required");return r.ok||await wn(r,"Failed to request edit approval"),r.json()}async function bS(e,t){const r=t?`?academic_year_id=${encodeURIComponent(String(t))}`:"",n=`${xn()}/api/academics/special-courses/${encodeURIComponent(String(e))}/enabled_assessments/${r}`,i=await ua(n,{method:"GET"});if(i.status===401)throw new Error("Authentication required");i.ok||await wn(i,"Failed to fetch enabled assessments");const s=await i.json();return(Array.isArray(s==null?void 0:s.enabled_assessments)?s.enabled_assessments:[]).map(l=>String(l).trim().toLowerCase()).filter(Boolean)}async function dh(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${xn()}/api/obe/mark-table-lock/${encodeURIComponent(e)}/${encodeURIComponent(t)}/confirm-mark-manager${n}`,s=await ua(i,{method:"POST",body:JSON.stringify({})});if(s.status===401)throw new Error("Authentication required");return s.ok||await wn(s,"Mark Manager confirm failed"),s.json()}async function S3(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${xn()}/api/obe/publish-window/${encodeURIComponent(e)}/${encodeURIComponent(t)}${n}`,s=await fetch(i,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return s.status===401?{assessment:e,subject_code:String(t),publish_allowed:!1,allowed_by_due:!1,allowed_by_approval:!1,global_override_active:!1,global_is_open:null,allowed_by_global:null,due_at:null,now:null,remaining_seconds:null,approval_until:null,academic_year:null,teaching_assignment_id:typeof r=="number"?r:null}:(s.ok||await wn(s,"Publish window fetch failed"),s.json())}async function o1(e,t,r,n){const i=[`scope=${encodeURIComponent(String(r))}`];n&&i.push(`teaching_assignment_id=${encodeURIComponent(String(n))}`);const s=i.length?`?${i.join("&")}`:"",o=`${xn()}/api/obe/edit-window/${encodeURIComponent(e)}/${encodeURIComponent(t)}${s}`,l=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return l.status===401?{assessment:e,subject_code:String(t),scope:r,allowed_by_approval:!1,approval_until:null,now:null,academic_year:null,teaching_assignment_id:typeof n=="number"?n:null}:(l.ok||await wn(l,"Edit window fetch failed"),l.json())}async function ux(e,t){const r=[];e!=null&&e.length&&r.push(`semester_ids=${encodeURIComponent(e.join(","))}`),t!=null&&t.length&&r.push(`assessments=${encodeURIComponent(t.join(","))}`);const n=r.length?`?${r.join("&")}`:"",i=`${xn()}/api/obe/global-publish-controls${n}`,s=await fetch(i,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return s.ok||await wn(s,"Global publish controls fetch failed"),s.json()}async function O4(e){const t=`${xn()}/api/obe/global-publish-controls/bulk-set`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify(e)});return r.ok||await wn(r,"Bulk set global publish controls failed"),r.json()}async function u9(e){const t=`${xn()}/api/obe/global-publish-controls/bulk-reset`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify(e)});return r.ok||await wn(r,"Bulk reset global publish controls failed"),r.json()}async function d9(){const e=`${xn()}/api/obe/semesters`,t=await fetch(e,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return t.ok||await wn(t,"Semesters fetch failed"),t.json()}async function Uv(e){const t=e!=null&&e.length?`?semester_ids=${encodeURIComponent(e.join(","))}`:"",r=`${xn()}/api/obe/assessment-controls${t}`,n=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});if(!n.ok){if(n.status===404)throw new Error(`Assessment controls endpoint not found (404).

URL requested:
${r}

This usually means your frontend is calling an older backend that does not include /api/obe/assessment-controls.
- Deploy/restart the updated backend OR
- Set VITE_API_BASE to the backend instance that has the new endpoints.`);await wn(n,"Assessment controls fetch failed")}return n.json()}async function M4(e){const t=`${xn()}/api/obe/assessment-controls/bulk-set`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify(e)});if(!r.ok){if(r.status===404)throw new Error(`Assessment controls bulk-set endpoint not found (404).

URL requested:
${t}

Your backend is missing /api/obe/assessment-controls/bulk-set. Deploy/restart the updated backend or point VITE_API_BASE to the correct server.`);await wn(r,"Bulk set assessment controls failed")}return r.json()}async function L4(e){const t=e!=null&&e.length?`?semester_ids=${encodeURIComponent(e.join(","))}`:"",r=`${xn()}/api/obe/due-schedules${t}`,n=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return n.ok||await wn(n,"Due schedules fetch failed"),n.json()}async function f9(e){const t=`?semester_ids=${encodeURIComponent(e.join(","))}`,r=`${xn()}/api/obe/due-schedule-subjects${t}`,n=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return n.ok||await wn(n,"Due schedule subjects fetch failed"),n.json()}async function are(e){const t=`${xn()}/api/obe/due-schedule-upsert`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify(e)});return r.ok||await wn(r,"Due schedule save failed"),r.json()}async function h9(e){const t=`${xn()}/api/obe/due-schedule-bulk-upsert`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify(e)});return r.ok||await wn(r,"Due schedule bulk save failed"),r.json()}async function p9(e){const t=`${xn()}/api/obe/due-schedule-bulk-delete`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify(e)});return r.ok||await wn(r,"Due schedule bulk delete failed"),r.json()}function m9(e){if(Array.isArray(e))return{marks:e.map(r=>Number(r)).filter(r=>Number.isFinite(r))};if(e&&typeof e=="object"){const r=(Array.isArray(e.marks)?e.marks:[]).map(o=>Number(o)).filter(o=>Number.isFinite(o)),n=Array.isArray(e.cos)?e.cos:void 0,i=n?n.map(o=>{if(typeof o=="string")return o;const l=Number(o);return Number.isFinite(l)?l:""}):void 0,s={marks:r};return i&&(s.cos=i.filter(o=>o!=="")),s}return{marks:[]}}async function ah(e){const t=[];t.push(`class_type=${encodeURIComponent(String(e.class_type||"").trim())}`),e.question_paper_type&&t.push(`question_paper_type=${encodeURIComponent(String(e.question_paper_type||"").trim())}`),t.push(`exam=${encodeURIComponent(String(e.exam||"").trim())}`);const r=t.length?`?${t.join("&")}`:"",n=`${xn()}/api/obe/iqac/qp-pattern${r}`,i=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});i.ok||await wn(i,"QP pattern fetch failed");const s=await i.json(),o=m9(s==null?void 0:s.pattern);return{class_type:String((s==null?void 0:s.class_type)||""),question_paper_type:(s==null?void 0:s.question_paper_type)==null?null:String(s.question_paper_type),exam:(()=>{const l=String((s==null?void 0:s.exam)||"CIA").trim().toUpperCase();return l==="MODEL"?"MODEL":l==="CIA1"?"CIA1":l==="CIA2"?"CIA2":"CIA"})(),pattern:o,updated_at:(s==null?void 0:s.updated_at)??null,updated_by:typeof(s==null?void 0:s.updated_by)=="number"?s.updated_by:null}}async function g9(e){var o,l;const t=`${xn()}/api/obe/iqac/qp-pattern/save`,r={class_type:String(e.class_type||"").trim(),question_paper_type:e.question_paper_type?String(e.question_paper_type||"").trim():null,exam:e.exam,pattern:{marks:Array.isArray((o=e.pattern)==null?void 0:o.marks)?e.pattern.marks:[],cos:Array.isArray((l=e.pattern)==null?void 0:l.cos)?e.pattern.cos:void 0}},n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify(r)});n.ok||await wn(n,"QP pattern save failed");const i=await n.json(),s=m9(i==null?void 0:i.pattern);return{class_type:String((i==null?void 0:i.class_type)||""),question_paper_type:(i==null?void 0:i.question_paper_type)==null?null:String(i.question_paper_type),exam:(()=>{const c=String((i==null?void 0:i.exam)||"CIA").trim().toUpperCase();return c==="MODEL"?"MODEL":c==="CIA1"?"CIA1":c==="CIA2"?"CIA2":"CIA"})(),pattern:s,updated_at:(i==null?void 0:i.updated_at)??null,updated_by:typeof(i==null?void 0:i.updated_by)=="number"?i.updated_by:null}}async function vS(){const e=`${xn()}/api/obe/iqac/cqi-config`,t=await fetch(e,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});t.ok||await wn(t,"CQI config fetch failed");const r=await t.json();return{options:Array.isArray(r==null?void 0:r.options)?r.options:[],divider:Number.isFinite(Number(r==null?void 0:r.divider))?Number(r==null?void 0:r.divider):2,multiplier:Number.isFinite(Number(r==null?void 0:r.multiplier))?Number(r==null?void 0:r.multiplier):.15,updated_at:(r==null?void 0:r.updated_at)??null,updated_by:typeof(r==null?void 0:r.updated_by)=="number"?r.updated_by:null}}async function x9(e){const t=`${xn()}/api/obe/iqac/cqi-config/save`,r={options:Array.isArray(e.options)?e.options:[],divider:Number.isFinite(Number(e.divider))?Number(e.divider):2,multiplier:Number.isFinite(Number(e.multiplier))?Number(e.multiplier):.15},n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify(r)});return n.ok||await wn(n,"CQI config save failed"),n.json()}async function sre(e){const t=`${xn()}/api/obe/due-schedule-delete`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify(e)});return r.ok||await wn(r,"Due schedule delete failed"),r.json()}async function _h(e){const t=`${xn()}/api/obe/publish-request`,r=await ua(t,{method:"POST",body:JSON.stringify(e)});if(r.status===401)throw new Error("Authentication required");return r.ok||await wn(r,"Publish request failed"),r.json()}async function il(e){const t=`${xn()}/api/obe/edit-request`,r=await ua(t,{method:"POST",body:JSON.stringify(e)});if(r.status===401)throw new Error("Authentication required");return r.ok||await wn(r,"Edit request failed"),r.json()}function al(e){var o,l,c,u,d;const t=e||{},r=`Edit request ID: ${typeof t.id=="number"?t.id:""}`;if((String(t.routed_to||"IQAC").trim().toUpperCase()==="HOD"?"HOD":"IQAC")==="HOD"){const f=String(((o=t.department)==null?void 0:o.short_name)||((l=t.department)==null?void 0:l.name)||((c=t.department)==null?void 0:c.code)||"").trim(),h=String(((u=t.hod)==null?void 0:u.name)||((d=t.hod)==null?void 0:d.username)||"").trim(),p=f&&h?`Sent to: ${f} HOD, ${h}`:"Sent to: HOD";return`${r}
${p}`}const s=String(t.routing_warning||"").trim();return s?`${r}
Sent to: IQAC
Note: ${s}`:`${r}
Sent to: IQAC`}function sl(e,t="Request failed"){var i,s;const r=String((e==null?void 0:e.message)||"").trim();if(r)return r;const n=String(((s=(i=e==null?void 0:e.response)==null?void 0:i.data)==null?void 0:s.detail)||"").trim();return n||t}async function Lm(e){const t=[];t.push(`assessment=${encodeURIComponent(String(e.assessment))}`),t.push(`subject_code=${encodeURIComponent(String(e.subject_code))}`),t.push(`scope=${encodeURIComponent(String(e.scope))}`),typeof e.teaching_assignment_id=="number"&&t.push(`teaching_assignment_id=${encodeURIComponent(String(e.teaching_assignment_id))}`);const r=t.length?`?${t.join("&")}`:"",n=`${xn()}/api/obe/edit-requests/my-latest${r}`,i=await ua(n,{method:"GET"});return i.status===401?{result:null}:(i.ok||await wn(i,"My edit request status fetch failed"),i.json())}async function y9(e){const t=e?`?scope=${encodeURIComponent(e)}`:"",r=`${xn()}/api/obe/edit-requests/pending${t}`,n=await ua(r,{method:"GET"});return n.status===401?{results:[]}:(n.ok||await wn(n,"Pending edit requests fetch failed"),n.json())}async function b9(e){const t=e?`?scope=${encodeURIComponent(e)}`:"",r=`${xn()}/api/obe/edit-requests/hod/pending${t}`,n=await ua(r,{method:"GET"});return n.status===401?{results:[]}:(n.ok||await wn(n,"HOD pending edit requests fetch failed"),n.json())}async function v9(e){var l;const t=(l=e==null?void 0:e.statuses)!=null&&l.length?e.statuses.join(","):"",r=typeof(e==null?void 0:e.limit)=="number"?e.limit:200,n=[];t&&n.push(`statuses=${encodeURIComponent(t)}`),Number.isFinite(r)&&n.push(`limit=${encodeURIComponent(String(r))}`),e!=null&&e.scope&&n.push(`scope=${encodeURIComponent(e.scope)}`);const i=n.length?`?${n.join("&")}`:"",s=`${xn()}/api/obe/edit-requests/history${i}`,o=await ua(s,{method:"GET"});return o.status===401?{results:[]}:(o.ok||await wn(o,"Edit requests history fetch failed"),o.json())}async function wS(){const e=`${xn()}/api/obe/iqac/class-type-weights`,t=await ua(e,{method:"GET"});if(t.status===401)throw new Error("Authentication required to fetch class-type weights");t.ok||await wn(t,"Fetch class-type weights failed");const r=await t.json();return(r==null?void 0:r.results)||{}}async function w9(e){const t=`${xn()}/api/obe/iqac/internal-mark-mapping/${encodeURIComponent(e)}`,r=await ua(t,{method:"GET"});if(r.status===401)throw new Error("Authentication required");return r.ok||await wn(r,"Failed to fetch internal mark mapping"),r.json()}async function S9(e,t){const r=`${xn()}/api/obe/iqac/internal-mark-mapping/${encodeURIComponent(e)}/save`,n=await ua(r,{method:"POST",body:JSON.stringify({mapping:t})});if(n.status===401)throw new Error("Authentication required");return n.ok||await wn(n,"Failed to save internal mark mapping"),n.json()}async function ore(e){const t=`${xn()}/api/obe/iqac/class-type-weights/save`,r=await ua(t,{method:"POST",body:JSON.stringify(e)});if(r.status===401)throw new Error("Authentication required");r.ok||await wn(r,"Save class-type weights failed");const n=await r.json();return(n==null?void 0:n.results)||{}}async function lre(e){const t=e?`?scope=${encodeURIComponent(e)}`:"",r=`${xn()}/api/obe/edit-requests/pending-count${t}`,n=await ua(r,{method:"GET"});return n.status===401?{pending:0}:(n.ok||await wn(n,"Pending edit requests count fetch failed"),n.json())}async function cre(e){const t=e?`?scope=${encodeURIComponent(e)}`:"",r=`${xn()}/api/obe/edit-requests/hod/pending-count${t}`,n=await ua(r,{method:"GET"});return n.status===401?{pending:0}:(n.ok||await wn(n,"HOD pending edit requests count fetch failed"),n.json())}async function _9(e,t=120){const r=`${xn()}/api/obe/edit-requests/${encodeURIComponent(String(e))}/approve`,n=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify({window_minutes:t})});return n.ok||await wn(n,"Approve edit request failed"),n.json()}async function k9(e){const t=`${xn()}/api/obe/edit-requests/${encodeURIComponent(String(e))}/reject`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ai()}});return r.ok||await wn(r,"Reject edit request failed"),r.json()}async function j9(e){const t=`${xn()}/api/obe/edit-requests/${encodeURIComponent(String(e))}/hod-approve`,r=await ua(t,{method:"POST"});return r.ok||await wn(r,"HOD approve/forward failed"),r.json()}async function A9(e){const t=`${xn()}/api/obe/edit-requests/${encodeURIComponent(String(e))}/hod-reject`,r=await ua(t,{method:"POST"});return r.ok||await wn(r,"HOD reject failed"),r.json()}async function ure(){const e=`${xn()}/api/obe/publish-requests/pending`,t=await ua(e,{method:"GET"});return t.status===401?{results:[]}:(t.ok||await wn(t,"Pending requests fetch failed"),t.json())}async function dre(e){var l;const t=(l=e==null?void 0:e.statuses)!=null&&l.length?e.statuses.join(","):"",r=typeof(e==null?void 0:e.limit)=="number"?e.limit:200,n=[];t&&n.push(`statuses=${encodeURIComponent(t)}`),Number.isFinite(r)&&n.push(`limit=${encodeURIComponent(String(r))}`);const i=n.length?`?${n.join("&")}`:"",s=`${xn()}/api/obe/publish-requests/history${i}`,o=await ua(s,{method:"GET"});return o.status===401?{results:[]}:(o.ok||await wn(o,"History requests fetch failed"),o.json())}async function R4(){const e=`${xn()}/api/obe/publish-requests/pending-count`,t=await ua(e,{method:"GET"});return t.status===401?{pending:0}:(t.ok||await wn(t,"Pending requests count fetch failed"),t.json())}async function fre(e,t=120){const r=`${xn()}/api/obe/publish-requests/${encodeURIComponent(String(e))}/approve`,n=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify({window_minutes:t})});return n.ok||await wn(n,"Approve request failed"),n.json()}async function hre(e){const t=`${xn()}/api/obe/publish-requests/${encodeURIComponent(String(e))}/reject`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ai()}});return r.ok||await wn(r,"Reject request failed"),r.json()}async function wn(e,t){const r=await e.text();try{const n=String(r??"").replace(/^\uFEFF/,"").trim(),i=JSON.parse(n),s=(i==null?void 0:i.detail)||t,o=Array.isArray(i==null?void 0:i.how_to_fix)?`
How to fix:
- ${i.how_to_fix.join(`
- `)}`:"",l=Array.isArray(i==null?void 0:i.errors)?`
Errors:
- ${i.errors.join(`
- `)}`:"",c=new Error(`${s}${o}${l}`);throw c.status=e.status,c.body=i,c}catch{const n=new Error(`${t}: ${e.status} ${r}`);throw n.status=e.status,n.bodyText=r,n}}async function ei(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${xn()}/api/obe/draft/${encodeURIComponent(e)}/${encodeURIComponent(t)}${n}`,s=await ua(i,{method:"GET"});return s.status===401?{subject:{code:String(t),name:""},draft:null,updated_at:null,updated_by:null}:(s.ok||await wn(s,"Draft fetch failed"),s.json())}async function Ri(e,t,r){const n=`${xn()}/api/obe/draft/${encodeURIComponent(e)}/${encodeURIComponent(t)}`,i=await ua(n,{method:"PUT",body:JSON.stringify({data:r})});if(i.status===401)throw new Error("Authentication required");return i.ok||await wn(i,"Draft save failed"),i.json()}async function rg(e,t){const r=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${xn()}/api/obe/ssa1-published/${encodeURIComponent(e)}${r}`,i=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return i.ok||await wn(i,"SSA1 published fetch failed"),i.json()}async function N9(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${xn()}/api/obe/ssa1-publish/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify({data:t})});return s.ok||await wn(s,"SSA1 publish failed"),s.json()}async function SS(e){const t=`${xn()}/api/obe/review1-published/${encodeURIComponent(e)}`,r=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return r.ok||await wn(r,"Review 1 published fetch failed"),r.json()}async function C9(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${xn()}/api/obe/review1-publish/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify({data:t})});return s.ok||await wn(s,"Review 1 publish failed"),s.json()}async function ey(e,t){const r=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${xn()}/api/obe/ssa2-published/${encodeURIComponent(e)}${r}`,i=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return i.ok||await wn(i,"SSA2 published fetch failed"),i.json()}async function E9(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${xn()}/api/obe/ssa2-publish/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify({data:t})});return s.ok||await wn(s,"SSA2 publish failed"),s.json()}async function _S(e){const t=`${xn()}/api/obe/review2-published/${encodeURIComponent(e)}`,r=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return r.ok||await wn(r,"Review 2 published fetch failed"),r.json()}async function T9(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${xn()}/api/obe/review2-publish/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify({data:t})});return s.ok||await wn(s,"Review 2 publish failed"),s.json()}async function kS(e,t){const r=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${xn()}/api/obe/formative1-published/${encodeURIComponent(e)}${r}`,i=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return i.ok||await wn(i,"Formative1 published fetch failed"),i.json()}async function pre(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${xn()}/api/obe/formative1-publish/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify({data:t})});return s.ok||await wn(s,"Formative1 publish failed"),s.json()}async function v0(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${xn()}/api/obe/${encodeURIComponent(e)}-published/${encodeURIComponent(t)}${n}`,s=await fetch(i,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return s.ok||await wn(s,`${e} published fetch failed`),s.json()}async function P9(e,t,r,n){const i=n?`?teaching_assignment_id=${encodeURIComponent(String(n))}`:"",s=`${xn()}/api/obe/${encodeURIComponent(e)}-publish/${encodeURIComponent(t)}${i}`,o=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify({data:r})});return o.ok||await wn(o,`${e} publish failed`),o.json()}async function po(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${xn()}/api/obe/lab-published-sheet/${encodeURIComponent(e)}/${encodeURIComponent(t)}${n}`,s=await fetch(i,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return s.ok||await wn(s,"Lab published sheet fetch failed"),s.json()}async function _3(e,t,r,n){const i=n?`?teaching_assignment_id=${encodeURIComponent(String(n))}`:"",s=`${xn()}/api/obe/lab-publish-sheet/${encodeURIComponent(e)}/${encodeURIComponent(t)}${i}`,o=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify({data:r})});return o.ok||await wn(o,"Lab publish failed"),o.json()}async function ty(e,t){const r=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${xn()}/api/obe/cia1-published-sheet/${encodeURIComponent(e)}${r}`,i=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return i.ok||await wn(i,"CIA1 published sheet fetch failed"),i.json()}async function mre(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${xn()}/api/obe/cia1-publish-sheet/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify({data:t})});return s.ok||await wn(s,"CIA1 publish failed"),s.json()}async function Rm(e,t){const r=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${xn()}/api/obe/model-published-sheet/${encodeURIComponent(e)}${r}`;try{const i=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});if(i.ok)return i.json();if(i.status===404){const s=await po("model",e,t);return{subject:s.subject,data:s.data}}await wn(i,"MODEL published sheet fetch failed")}catch(i){throw i}}async function O9(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${xn()}/api/obe/model-publish-sheet/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify({data:t})});return s.ok||await wn(s,"MODEL publish failed"),s.json()}async function w0(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${xn()}/api/obe/${encodeURIComponent(e)}-published-sheet/${encodeURIComponent(t)}${n}`,s=await fetch(i,{method:"GET",headers:{"Content-Type":"application/json",...ai()}});return s.ok||await wn(s,`${e} published sheet fetch failed`),s.json()}async function M9(e,t,r,n){const i=n?`?teaching_assignment_id=${encodeURIComponent(String(n))}`:"",s=`${xn()}/api/obe/${encodeURIComponent(e)}-publish-sheet/${encodeURIComponent(t)}${i}`,o=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",...ai()},body:JSON.stringify({data:r})});return o.ok||await wn(o,`${e} publish failed`),o.json()}async function L9(e,t,r){const n=(c,u=1200)=>{const d=String(c||""),p=d.replace(/<script[\s\S]*?<\/script>/gi," ").replace(/<style[\s\S]*?<\/style>/gi," ").replace(/<[^>]+>/g," ").replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&quot;/gi,'"').replace(/&#39;/gi,"'").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/\s+/g," ").trim()||d.replace(/\s+/g," ").trim();return p.length<=u?p:p.slice(0,u)+" (truncated)"},i=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",s=`${xn()}/api/obe/${encodeURIComponent(e)}-marks/${encodeURIComponent(t)}${i}`,o=window.localStorage.getItem("access"),l=await fetch(s,{method:"GET",headers:{"Content-Type":"application/json",...o?{Authorization:`Bearer ${o}`}:{}}});if(!l.ok){const c=await l.text();try{const u=JSON.parse(c),d=(u==null?void 0:u.detail)||`${e.toUpperCase()} roster fetch failed: ${l.status}`,f=Array.isArray(u==null?void 0:u.how_to_fix)?`
How to fix:
- ${u.how_to_fix.join(`
- `)}`:"";throw new Error(`${d}${f}`)}catch{const u=n(c);throw new Error(`${e.toUpperCase()} roster fetch failed: ${l.status}
${u||"Server returned a non-JSON error response."}`)}}return l.json()}async function gre(e,t){const r=(u,d=1200)=>{const f=String(u||""),m=f.replace(/<script[\s\S]*?<\/script>/gi," ").replace(/<style[\s\S]*?<\/style>/gi," ").replace(/<[^>]+>/g," ").replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&quot;/gi,'"').replace(/&#39;/gi,"'").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/\s+/g," ").trim()||f.replace(/\s+/g," ").trim();return m.length<=d?m:m.slice(0,d)+" (truncated)"},i=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":"https://db.krgi.co.in",s=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",o=`${i}/api/obe/cia1-marks/${encodeURIComponent(e)}${s}`,l=window.localStorage.getItem("access"),c=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json",...l?{Authorization:`Bearer ${l}`}:{}}});if(!c.ok){const u=await c.text();try{const d=JSON.parse(u),f=(d==null?void 0:d.detail)||`CIA1 roster fetch failed: ${c.status}`,h=Array.isArray(d==null?void 0:d.how_to_fix)?`
How to fix:
- ${d.how_to_fix.join(`
- `)}`:"";throw new Error(`${f}${h}`)}catch{const d=r(u);throw new Error(`CIA1 roster fetch failed: ${c.status}
${d||"Server returned a non-JSON error response."}`)}}return c.json()}async function xre(e,t){const r=(u,d=1200)=>{const f=String(u||""),m=f.replace(/<script[\s\S]*?<\/script>/gi," ").replace(/<style[\s\S]*?<\/style>/gi," ").replace(/<[^>]+>/g," ").replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&quot;/gi,'"').replace(/&#39;/gi,"'").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/\s+/g," ").trim()||f.replace(/\s+/g," ").trim();return m.length<=d?m:m.slice(0,d)+" (truncated)"},s=`${typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":"https://db.krgi.co.in"}/api/obe/cia1-marks/${encodeURIComponent(e)}`,o=window.localStorage.getItem("access"),l=await fetch(s,{method:"PUT",headers:{"Content-Type":"application/json",...o?{Authorization:`Bearer ${o}`}:{}},body:JSON.stringify({marks:t})}),c=await l.text();if(!l.ok)try{const u=JSON.parse(c),d=(u==null?void 0:u.detail)||`CIA1 save failed: ${l.status}`,f=Array.isArray(u==null?void 0:u.how_to_fix)?`
How to fix:
- ${u.how_to_fix.join(`
- `)}`:"",h=Array.isArray(u==null?void 0:u.errors)?`
Errors:
- ${u.errors.join(`
- `)}`:"";throw new Error(`${d}${f}${h}`)}catch{const u=r(c);throw new Error(`CIA1 save failed: ${l.status}
${u||"Server returned a non-JSON error response."}`)}return JSON.parse(c)}const K8=Object.freeze(Object.defineProperty({__proto__:null,approveEditRequest:_9,approvePublishRequest:fre,bulkDeleteDueSchedule:p9,bulkResetGlobalPublishControls:u9,bulkSetAssessmentControls:M4,bulkSetGlobalPublishControls:O4,bulkUpsertDueSchedule:h9,confirmMarkManagerLock:dh,createEditRequest:il,createPublishRequest:_h,deleteDueSchedule:sre,dismissResetNotifications:o9,fetchAssessmentControls:Uv,fetchCia1Marks:gre,fetchCiaMarks:L9,fetchClassTypeWeights:wS,fetchDraft:ei,fetchDueScheduleSubjects:f9,fetchDueSchedules:L4,fetchEditRequestsHistory:v9,fetchEditWindow:o1,fetchGlobalPublishControls:ux,fetchHodPendingEditRequestCount:cre,fetchHodPendingEditRequests:b9,fetchInternalMarkMapping:w9,fetchIqacCqiConfig:vS,fetchIqacQpPattern:ah,fetchMarkTableLockStatus:yS,fetchMyLatestEditRequest:Lm,fetchMyTeachingAssignments:fc,fetchObeSemesters:d9,fetchPendingEditRequestCount:lre,fetchPendingEditRequests:y9,fetchPendingPublishRequestCount:R4,fetchPendingPublishRequests:ure,fetchPublishRequestsHistory:dre,fetchPublishWindow:S3,fetchPublishedCia1Sheet:ty,fetchPublishedCiaSheet:w0,fetchPublishedFormative:v0,fetchPublishedFormative1:kS,fetchPublishedLabSheet:po,fetchPublishedModelSheet:Rm,fetchPublishedReview1:SS,fetchPublishedReview2:_S,fetchPublishedSsa1:rg,fetchPublishedSsa2:ey,fetchResetNotifications:s9,fetchSpecialCourseEnabledAssessments:bS,fetchTeachingAssignmentEnabledAssessments:nre,fetchTeachingAssignmentEnabledAssessmentsInfo:fm,formatApiErrorMessage:sl,formatEditRequestSentMessage:al,hodApproveEditRequest:j9,hodRejectEditRequest:A9,iqacResetAssessment:w3,publishCia1Sheet:mre,publishCiaSheet:M9,publishFormative:P9,publishFormative1:pre,publishLabSheet:_3,publishModelSheet:O9,publishReview1:C9,publishReview2:T9,publishSsa1:N9,publishSsa2:E9,rejectEditRequest:k9,rejectPublishRequest:hre,requestTeachingAssignmentEnabledAssessmentsEdit:c9,saveCia1Marks:xre,saveDraft:Ri,setTeachingAssignmentEnabledAssessments:ire,setTeachingAssignmentEnabledAssessmentsInfo:l9,upsertClassTypeWeights:ore,upsertDueSchedule:are,upsertInternalMarkMapping:S9,upsertIqacCqiConfig:x9,upsertIqacQpPattern:g9},Symbol.toStringTag,{value:"Module"})),yre={profile:W0,curriculum_master:gs,assigned_subjects:gs,department_curriculum:V8,elective_import:P2,student_curriculum_view:P4,home:E2,hod_advisors:bs,hod_teaching:gs,advisor_students:Z1,mentor_assign:bs,timetable_templates:ys,timetable_assignments:ys,student_timetable:ys,staff_timetable:ys,student_attendance:C2,my_mentees:bs,period_attendance:C2,obe:gs,obe_master:gs,obe_due_dates:E4,obe_requests:Ax,hod_obe_requests:Ax,academic_controller:V8,notifications:Ax};function bre({baseUrl:e=""}){const{data:t,loading:r,error:n}=Zte(e),i=dl(),{collapsed:s,toggle:o}=v3(),[l,c]=x.useState(0),[u,d]=x.useState({}),h=((t==null?void 0:t.permissions)||[]).map(k=>String(k||"").toLowerCase()).includes("obe.master.manage");if(x.useEffect(()=>{let k=!0;const j=window.localStorage.getItem("access");if(!h||!j)return c(0),()=>{k=!1};(async()=>{try{const L=await R4();if(!k)return;c(Number(L.pending||0))}catch{}})();const A=window.setInterval(()=>{(async()=>{try{const L=await R4();if(!k)return;c(Number(L.pending||0))}catch{}})()},3e4);return()=>{k=!1,window.clearInterval(A)}},[h]),x.useEffect(()=>{i.pathname.startsWith("/academic")&&d(k=>({...k,academic:!0}))},[i.pathname]),x.useEffect(()=>{i.pathname.startsWith("/iqac/academic-controller")&&d(k=>({...k,academic_controller:!0}))},[i.pathname]),r)return a.jsx("aside",{className:`fixed top-16 left-0 h-[calc(100vh-4rem)] bg-white shadow-lg transition-all duration-300 z-30 ${s?"-translate-x-full lg:translate-x-0 lg:w-20":"w-full lg:w-64"}`,children:a.jsx("div",{className:"p-6 flex items-center justify-center h-full",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})});if(n)return a.jsx("aside",{className:`fixed top-16 left-0 h-[calc(100vh-4rem)] bg-white shadow-lg transition-all duration-300 z-30 ${s?"-translate-x-full lg:translate-x-0 lg:w-20":"w-full lg:w-64"}`,children:a.jsx("div",{className:"p-6 text-red-600 text-sm",children:"Error loading sidebar"})});if(!t)return null;const p=t.entry_points||{},m=[],g=(t.permissions||[]).map(k=>(k||"").toString().toLowerCase()),y=(t.roles||[]).map(k=>(k||"").toString().toUpperCase()),b=t.flags||{},v=y.includes("IQAC");return p.curriculum_master&&(g.some(k=>k.includes("curriculum"))||p.curriculum_master)&&m.push({key:"curriculum_master",label:"Curriculum Master",to:"/curriculum/master"}),p.department_curriculum&&(g.some(k=>k.includes("curriculum"))||p.department_curriculum)&&m.push({key:"department_curriculum",label:"Department Curriculum",to:"/curriculum/department"}),g.includes("curriculum.import_elective_choices")&&m.push({key:"elective_import",label:"Elective Import",to:"/curriculum/elective-import"}),p.hod_advisors&&(y.includes("HOD")||g.includes("academics.assign_advisor"))&&m.push({key:"hod_advisors",label:"Advisor Assign",to:"/hod/advisors"}),p.hod_teaching&&(y.includes("ADVISOR")||g.includes("academics.assign_teaching"))&&m.push({key:"hod_teaching",label:"Teaching Assign",to:"/advisor/teaching"}),(!!(p!=null&&p.hod_obe_requests)||y.includes("HOD"))&&m.push({key:"hod_obe_requests",label:"HOD: OBE Requests",to:"/hod/obe-requests"}),p.advisor_students&&(y.includes("ADVISOR")||g.includes("academics.view_my_students"))&&m.push({key:"advisor_students",label:"My Students",to:"/advisor/students"}),(y.includes("ADVISOR")||g.includes("academics.assign_mentor"))&&m.push({key:"mentor_assign",label:"Mentor Assign",to:"/advisor/mentor"}),p.student_curriculum_view&&g.some(k=>k.includes("curriculum"))&&m.push({key:"student_curriculum_view",label:"My Curriculum",to:"/curriculum/student"}),(b.can_manage_timetable_templates||g.includes("timetable.manage_templates"))&&p.timetable_templates&&m.push({key:"timetable_templates",label:"IQAC: Timetable Templates",to:"/iqac/timetable"}),(!!b.can_assign_timetable||g.includes("timetable.assign")||y.includes("ADVISOR"))&&p.timetable_assignments&&m.push({key:"timetable_assignments",label:"Timetable Assignments",to:"/advisor/timetable"}),b.can_view_timetable&&b.is_student&&g.includes("timetable.view")&&m.push({key:"student_timetable",label:"My Timetable",to:"/student/timetable"}),b.can_view_timetable&&b.is_staff&&g.includes("timetable.view")&&m.push({key:"staff_timetable",label:"My Timetable (Staff)",to:"/staff/timetable"}),b.is_student&&m.push({key:"student_attendance",label:"My Attendance",to:"/student/attendance"}),b.is_staff&&(g.includes("academics.view_assigned_subjects")||y.includes("HOD"))&&m.push({key:"assigned_subjects",label:"Assigned Subjects",to:"/staff/assigned-subjects"}),b.is_staff&&g.includes("academics.view_mentees")&&m.push({key:"my_mentees",label:"My Mentees",to:"/staff/mentees"}),b.is_staff&&(g.includes("academics.mark_attendance")||y.includes("HOD")||y.includes("ADVISOR"))&&m.push({key:"period_attendance",label:"Mark Attendance",to:"/staff/period-attendance"}),b.is_staff&&(g.includes("academics.view_all_attendance")||g.includes("academics.view_attendance_overall")||g.includes("academics.view_all_departments")||g.includes("academics.view_department_attendance")||g.includes("academics.view_class_attendance")||g.includes("academics.view_section_attendance"))&&m.push({key:"attendance_analytics",label:"Attendance Analytics",to:"/staff/analytics"}),m.unshift({key:"profile",label:"Profile",to:"/profile"}),v&&m.push({key:"notifications",label:"Notifications",to:"/notifications"}),b.is_staff&&!m.some(k=>k.key==="academic")&&m.push({key:"academic",label:"Academic",to:"/academic"}),v&&!m.some(k=>k.key==="academic_controller")&&m.push({key:"academic_controller",label:"Academic Controller",to:"/iqac/academic-controller"}),h&&!v&&!m.some(k=>k.key==="obe_due_dates")&&m.push({key:"obe_due_dates",label:"OBE: Due Dates",to:"/obe/master/due-dates"}),h&&!m.some(k=>k.key==="obe_requests")&&m.push({key:"obe_requests",label:"OBE: Requests",to:"/obe/master/requests"}),a.jsxs(a.Fragment,{children:[!s&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-20 lg:hidden",onClick:o}),a.jsxs("aside",{className:`fixed top-16 left-0 h-[calc(100vh-4rem)] bg-white shadow-lg transition-all duration-300 z-30 overflow-y-auto ${s?"-translate-x-full lg:translate-x-0 lg:w-20":"w-full lg:w-64"}`,children:[a.jsx("div",{className:"hidden"}),a.jsx("nav",{className:"py-6",children:a.jsxs("ul",{className:"space-y-2 px-3",children:[a.jsx("li",{children:a.jsxs(es,{to:"/dashboard",className:`flex items-center gap-3 px-3 py-3 rounded-lg transition-all duration-200 ${i.pathname==="/dashboard"?"bg-blue-600 text-white shadow-md":"text-gray-700 hover:bg-blue-50 hover:text-blue-600"} ${s?"lg:justify-center lg:px-2":""}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(E2,{className:`flex-shrink-0 ${s?"lg:w-5 lg:h-5":"w-6 h-6"}`}),a.jsx("span",{className:`font-medium text-base ${s?"lg:hidden":""}`,children:"Dashboard"})]})}),m.map(k=>{const j=yre[k.key]||W0,A=i.pathname.startsWith(k.to);return a.jsxs("li",{className:"relative",children:[a.jsxs(es,{to:k.to,className:`flex items-center gap-3 px-3 py-3 rounded-lg transition-all duration-200 ${A?"bg-blue-600 text-white shadow-md":"text-gray-700 hover:bg-blue-50 hover:text-blue-600"} ${s?"lg:justify-center lg:px-2":""}`,onClick:()=>{window.innerWidth<1024&&o(),k.key==="academic"&&d(L=>({...L,academic:!L.academic})),k.key==="academic_controller"&&d(L=>({...L,academic_controller:!L.academic_controller}))},children:[a.jsx(j,{className:`flex-shrink-0 ${s?"lg:w-5 lg:h-5":"w-6 h-6"}`}),a.jsxs("span",{className:`font-medium text-base ${s?"lg:hidden":""}`,children:[k.label,k.key==="obe_requests"&&l>0?a.jsx("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-medium rounded-full bg-red-600 text-white",children:l}):null]})]}),k.key==="academic"&&h&&u.academic?a.jsxs("ul",{className:"pl-8 mt-1 space-y-1",children:[a.jsx("li",{children:a.jsxs(es,{to:"/academic?tab=obe_master",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${i.pathname.startsWith("/academic")&&new URLSearchParams(i.search).get("tab")==="obe_master"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(gs,{className:"w-4 h-4"})," ",a.jsx("span",{children:"OBE Master"})]})}),v?null:a.jsx("li",{children:a.jsxs(es,{to:"/academic?tab=due_dates",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${i.pathname.startsWith("/academic")&&new URLSearchParams(i.search).get("tab")==="due_dates"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(E4,{className:"w-4 h-4"})," ",a.jsx("span",{children:"OBE: Due Dates"})]})})]}):null,k.key==="academic_controller"&&u.academic_controller?a.jsxs("ul",{className:"pl-8 mt-1 space-y-1",children:[a.jsx("li",{children:a.jsxs(es,{to:"/iqac/academic-controller?tab=dashboard",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${i.pathname.startsWith("/iqac/academic-controller")&&new URLSearchParams(i.search).get("tab")==="dashboard"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(E2,{className:"w-4 h-4"})," ",a.jsx("span",{children:"Dashboard"})]})}),a.jsx("li",{children:a.jsxs(es,{to:"/iqac/academic-controller?tab=qp",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${i.pathname.startsWith("/iqac/academic-controller")&&new URLSearchParams(i.search).get("tab")==="qp"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(P4,{className:"w-4 h-4"})," ",a.jsx("span",{children:"QP"})]})}),a.jsx("li",{children:a.jsxs(es,{to:"/iqac/academic-controller?tab=due_dates",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${i.pathname.startsWith("/iqac/academic-controller")&&new URLSearchParams(i.search).get("tab")==="due_dates"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(E4,{className:"w-4 h-4"})," ",a.jsx("span",{children:"OBE Due Dates"})]})}),a.jsx("li",{children:a.jsxs(es,{to:"/iqac/academic-controller?tab=courses",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${i.pathname.startsWith("/iqac/academic-controller")&&new URLSearchParams(i.search).get("tab")==="courses"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(P4,{className:"w-4 h-4"})," ",a.jsx("span",{children:"Courses"})]})})]}):null]},k.key)})]})})]})]})}const vre=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];function wre({editingCell:e,periods:t,assignmentMap:r,specialName:n,setSpecialName:i,selectedSpecialId:s,setSelectedSpecialId:o,specialTimetables:l,specialDate:c,setSpecialDate:u,curriculum:d,currentSectionRegulation:f,editingCurriculumId:h,setEditingCurriculumId:p,customSubjectText:m,setCustomSubjectText:g,editingAvailableBatches:y,setEditingAvailableBatches:b,editingBatchId:v,setEditingBatchId:w,isCustomAssignment:S,setIsCustomAssignment:k,customAssignmentText:j,setCustomAssignmentText:A,selectedStaffId:L,setSelectedStaffId:P,staffList:F,sectionId:E,shortLabel:T,loadBatchesForCurriculum:B,handleDeleteSpecialEntry:q,handleDeleteAssignment:U,handleUpdateAssignment:se,handleAssign:de,loadTimetable:z,setShowCellPopup:G,customSubjectOptions:ie,setEditingCell:Y,fetchWithAuth:C}){if(!e)return null;const K=e.day,H=e.periodId,R=r[K]&&r[K][H]||[],J=t.find(V=>V.id===H)||{};return a.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 px-6 py-4 flex justify-between items-center",children:[a.jsxs("div",{className:"flex items-center gap-3 text-white",children:[a.jsx(ys,{className:"h-5 w-5"}),a.jsxs("h3",{className:"text-lg font-semibold",children:["Day ",K,"  ",J.label||`${J.start_time||""} - ${J.end_time||""}`]})]}),a.jsx("button",{onClick:()=>{G(!1),Y(null)},className:"text-white hover:bg-white hover:bg-opacity-20 rounded-lg p-1.5 transition-colors",children:a.jsx(vu,{className:"h-5 w-5"})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(gs,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Existing Assignments"})]}),R.length===0?a.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg border-2 border-dashed border-gray-200",children:[a.jsx(rd,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-gray-500",children:"No assignment yet"})]}):a.jsx("div",{className:"space-y-3",children:R.map(V=>{var X;return a.jsxs("div",{className:`rounded-lg p-4 border-2 ${V.is_special?"bg-amber-50 border-amber-200":"bg-blue-50 border-blue-200"}`,children:[a.jsxs("div",{className:"font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(gs,{className:"h-4 w-4"}),V.is_special?V.timetable_name||"Special":T(V.curriculum_row||V.subject_text),V.is_special&&a.jsxs("span",{className:"text-amber-600 text-sm",children:[" ",T(V.curriculum_row||V.subject_text)]})]}),a.jsxs("div",{className:"text-sm text-gray-700 mt-2 flex items-center gap-1",children:[a.jsx(bs,{className:"h-3.5 w-3.5"}),((X=V.staff)==null?void 0:X.username)||"",V.subject_batch?`  Batch: ${V.subject_batch.name}`:""]}),V.is_special&&a.jsxs("div",{className:"text-xs text-amber-700 mt-2 flex items-center gap-1",children:[a.jsx(ys,{className:"h-3.5 w-3.5"}),"Date: ",V.date||"","  ",J.label||`${J.start_time||""}${J.start_time&&J.end_time?" - ":""}${J.end_time||""}`]}),a.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[a.jsxs("button",{onClick:async()=>{var oe,O;const Q=((oe=V.curriculum_row)==null?void 0:oe.id)||null,ne=((O=V.subject_batch)==null?void 0:O.id)||null;if(p(Q),w(ne),Q){const W=await B(Q);if(ne&&!W.find(ae=>ae.id===ne))try{const ae=await C(`/api/academics/subject-batches/${ne}/`);if(ae.ok){const I=await ae.json();b(Z=>Z.find(me=>me.id===I.id)?Z:[...Z,I])}}catch(ae){console.error("failed to load existing batch",ae)}}else if(ne)try{const W=await C(`/api/academics/subject-batches/${ne}/`);if(W.ok){const ae=await W.json();b(I=>I.find(Z=>Z.id===ae.id)?I:[...I,ae])}}catch(W){console.error("failed to load existing batch",W)}},className:"px-3 py-1.5 bg-indigo-600 text-white text-sm rounded-lg hover:bg-indigo-700 transition-colors flex items-center gap-1",children:[a.jsx(uh,{className:"h-3.5 w-3.5"}),"Edit"]}),a.jsxs("button",{onClick:()=>{V.is_special?q(V.id):U(V.id)},className:"px-3 py-1.5 bg-red-600 text-white text-sm rounded-lg hover:bg-red-700 transition-colors flex items-center gap-1",children:[a.jsx(s1,{className:"h-3.5 w-3.5"}),"Delete"]}),a.jsxs("button",{onClick:async()=>{if(!h)return alert("Select new subject from right panel then click Update");const Q={};h&&(Q.curriculum_row=h),v!==null&&(Q.subject_batch_id=v),await se(V.id,Q)},className:"px-3 py-1.5 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 transition-colors flex items-center gap-1",children:[a.jsx(id,{className:"h-3.5 w-3.5"}),"Update"]})]})]},V.id)})})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(Mm,{className:"h-5 w-5 text-green-600"}),a.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Assign / Edit"})]}),a.jsxs("div",{className:"space-y-4 bg-gray-50 rounded-lg p-4 border border-gray-200",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assignment Type"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>{k(!1),A(""),P(null)},className:`px-3 py-2 text-sm rounded-lg border transition-colors ${S?"bg-white text-gray-700 border-gray-300 hover:border-indigo-300":"bg-indigo-600 text-white border-indigo-600"}`,children:"From Curriculum"}),a.jsx("button",{onClick:()=>{k(!0),p(null),w(null),b([])},className:`px-3 py-2 text-sm rounded-lg border transition-colors ${S?"bg-indigo-600 text-white border-indigo-600":"bg-white text-gray-700 border-gray-300 hover:border-indigo-300"}`,children:"Custom Subject"})]})]}),S?a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Subject Name"}),a.jsxs("select",{value:j||"",onChange:V=>A(V.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[a.jsx("option",{value:"",children:"Select custom subject"}),ie.map(V=>a.jsx("option",{value:V.label,children:V.label},V.value))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Staff (optional)"}),a.jsxs("select",{value:L||"",onChange:V=>P(Number(V.target.value)||null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[a.jsx("option",{value:"",children:"Select staff (optional)"}),F.map(V=>a.jsx("option",{value:V.id,children:(()=>{var oe,O,W;const X=((oe=V.user)==null?void 0:oe.first_name)||"",Q=((O=V.user)==null?void 0:O.last_name)||"";return`${X} ${Q}`.trim()||((W=V.user)==null?void 0:W.username)||V.staff_id})()},V.id))]})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Subject"}),a.jsxs("select",{value:h||"",onChange:async V=>{const X=Number(V.target.value)||null;p(X),w(null),X?await B(X):b([])},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[a.jsx("option",{value:"",children:"Select subject"}),d.filter(V=>!(f!=null&&f.code)||V.regulation===f.code).map(V=>a.jsxs("option",{value:V.id,children:[V.course_code,"  ",V.course_name]},V.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Batch (optional)"}),a.jsxs("select",{value:v||"",onChange:V=>w(Number(V.target.value)||null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[a.jsx("option",{value:"",children:"Select batch (optional)"}),y.map(V=>a.jsx("option",{value:V.id,children:V.name},V.id))]})]})]}),a.jsxs("button",{onClick:async()=>{if(S){if(!j.trim())return alert("Subject name is required");await de(K,H)}else{if(!h)return alert("Select a subject");await de(K,H,h)}G(!1),Y(null)},className:"w-full px-4 py-2.5 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center gap-2 font-medium",children:[a.jsx(Mm,{className:"h-4 w-4"}),"Assign to Period"]})]}),a.jsxs("div",{className:"mt-6 border-t border-gray-200 pt-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(rd,{className:"h-5 w-5 text-amber-600"}),a.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Mark Special Period"})]}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Create a date-specific override for this period."}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Special timetable"}),a.jsxs("select",{value:s??"",onChange:V=>o(V.target.value?Number(V.target.value):null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",children:[a.jsx("option",{value:"",children:"Create new"}),l.map(V=>a.jsxs("option",{value:V.id,children:[V.name," ",V.is_active?"":"(inactive)"]},V.id))]}),!s&&a.jsx("input",{placeholder:"Name for new special timetable",value:n,onChange:V=>{V.preventDefault(),i(V.target.value)},className:"w-full mt-2 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500"},"special-name-input")]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Date"}),a.jsx("input",{type:"date",value:c||"",onChange:V=>u(V.target.value||null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Subject"}),a.jsxs("select",{value:h??"",onChange:V=>{const X=Number(V.target.value)||null;p(X),g(""),w(null),X&&X!==-1&&B(X).catch(console.error)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",children:[a.jsx("option",{value:"",children:"-- choose from section subjects --"}),d.filter(V=>!(f!=null&&f.code)||V.regulation===f.code).map(V=>a.jsxs("option",{value:V.id,children:[V.course_code,"  ",V.course_name]},V.id)),a.jsx("option",{value:"-1",children:"Custom text"})]}),h===-1&&a.jsxs("select",{value:m||"",onChange:V=>{V.preventDefault(),g(V.target.value)},className:"w-full mt-2 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",children:[a.jsx("option",{value:"",children:"-- choose custom subject --"}),ie.map(V=>a.jsx("option",{value:V.label,children:V.label},V.value))]},"custom-subject-input")]}),y&&y.length>0&&h&&h!==-1&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Batch (optional)"}),a.jsxs("select",{value:v||"",onChange:V=>w(Number(V.target.value)||null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",children:[a.jsx("option",{value:"",children:"None"}),y.map(V=>a.jsx("option",{value:V.id,children:V.name},V.id))]})]}),a.jsxs("button",{onClick:async()=>{if(!c)return alert("Select a date");try{let V=s;if(!V){const ne=n||`Special - ${c}`,oe=await C("/api/timetable/special-timetables/",{method:"POST",body:JSON.stringify({name:ne,section:E,is_active:!0})});if(!oe.ok){const W=await oe.text();return alert("Failed to create special timetable: "+W)}V=(await oe.json()).id}const X={timetable_id:V,timetable:V,date:c,period_id:H,period:H};h&&h!==-1&&(X.curriculum_row=h),h===-1&&m&&(X.subject_text=m),v&&(X.subject_batch_id=v);const Q=await C("/api/timetable/special-entries/",{method:"POST",body:JSON.stringify(X)});if(!Q.ok){const ne=await Q.text();return alert("Failed to create special entry: "+ne)}alert("Special period created"),await z(),G(!1),Y(null)}catch(V){console.error(V),alert("Failed to create special entry")}},className:"w-full px-4 py-2.5 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors flex items-center justify-center gap-2 font-medium",children:[a.jsx(rd,{className:"h-4 w-4"}),"Mark Special Period"]})]})]})]})]})})]})})}function Sre(){const[e,t]=x.useState([]),[r,n]=x.useState([]),[i,s]=x.useState([]),[o,l]=x.useState(null),[c,u]=x.useState(null),[d,f]=x.useState(null),[h,p]=x.useState(null),[m,g]=x.useState([]),[y,b]=x.useState([]),[v,w]=x.useState([]),[S,k]=x.useState(null),[j,A]=x.useState(null),[L,P]=x.useState([]),[F,E]=x.useState(null),[T,B]=x.useState(!1),[q,U]=x.useState(new Date().toISOString().slice(0,10)),[se,de]=x.useState([]),[z,G]=x.useState(null),[ie,Y]=x.useState(""),[C,K]=x.useState(""),[H,R]=x.useState([]),[J,V]=x.useState(!1),[X,Q]=x.useState(""),[ne,oe]=x.useState(null),[O,W]=x.useState([]);x.useEffect(()=>{xr("/api/academics/my-students/").then(He=>He.ok?He.json():[]).then(He=>{const tt=(He.results||[]).map(_e=>({id:_e.section_id,name:_e.section_name,batch:_e.batch,batch_regulation:_e.batch_regulation,department_id:_e.department_id}));t(tt),!o&&tt.length>0&&(l(tt[0].id),u(tt[0].department_id),f(tt[0].batch_regulation))}),xr("/api/timetable/templates/").then(He=>He.json()).then(He=>{const tt=He||[];n(tt);const _e=tt.find(Se=>Se.is_active)||tt[0];_e&&(p(_e.id),s(_e.periods||[]))}),xr("/api/academics/custom-subjects/").then(He=>He.ok?He.json():{results:[]}).then(He=>R(He.results||[])).catch(He=>console.error("Failed to load custom subjects",He))},[]),x.useEffect(()=>{if(o){const He=e.find(tt=>tt.id===o);He&&f(He.batch_regulation),xr(`/api/timetable/curriculum-for-section/?section_id=${o}`).then(tt=>tt.json()).then(tt=>g(tt.results||[])),ae(),xr(`/api/timetable/section/${o}/subjects-staff/`).then(tt=>tt.ok?tt.json():[]).then(tt=>w(tt.results||[])),xr(`/api/timetable/special-timetables/?section_id=${o}`).then(tt=>tt.ok?tt.json():[]).then(tt=>de(tt.results||[])),c&&xr(`/api/academics/advisor-staff/?department=${c}`).then(tt=>tt.ok?tt.json():[]).then(tt=>W(tt.results||tt||[]))}},[o,c]);async function ae(){if(o)try{const He=await xr(`/api/timetable/section/${o}/timetable/`);if(!He.ok)return;const tt=await He.json();b(tt.results||[])}catch(He){console.error("loadTimetable failed",He)}}const I={};for(const He of y){const tt=He.day;I[tt]=I[tt]||{};for(const _e of He.assignments||[])I[tt][_e.period_id]=I[tt][_e.period_id]||[],I[tt][_e.period_id].push(_e)}function Z(He){if(!He)return"";if(typeof He=="string"){const Se=He.trim();return Se.length<=12?Se:Se.slice(0,12)+""}if(He.course_code)return He.course_code;const tt=He.course_name||He.course||He.subject_text||"",_e=String(tt).trim();return _e.length<=12?_e:_e.split(" ").map(Se=>Se[0]).slice(0,3).join("")||_e.slice(0,12)}function me(He){const tt=new Date,_e=tt.getDay(),Se=new Date(tt),he=_e===0?-6:1-_e;Se.setDate(tt.getDate()+he);const ye=new Date(Se);return ye.setDate(Se.getDate()+(He-1)),ye.toISOString().slice(0,10)}async function Te(He,tt,_e){if(!o)return alert("Section is required");const Se={period_id:tt,day:He,section_id:o};if(J){if(!X.trim())return alert("Subject name is required");Se.subject_text=X.trim(),ne&&(Se.staff_id=ne)}else{if(!_e)return alert("Select a curriculum row first");Se.curriculum_row=_e,F&&(Se.subject_batch_id=F)}const he=await xr("/api/timetable/assignments/",{method:"POST",body:JSON.stringify(Se)});if(!he.ok){const ye=await he.text();return alert("Failed: "+ye)}A(null),P([]),E(null),Q(""),oe(null),await ae()}async function Ae(He){if(P([]),!He)return[];try{const tt=await xr(`/api/academics/subject-batches/?curriculum_row_id=${He}&page_size=0&include_all=1`);if(tt.ok){const _e=await tt.json(),Se=_e.results||_e||[];return P(Se),Se}}catch(tt){console.error("loadBatches failed",tt)}return[]}function Be(He,tt){if(tt.is_break||tt.is_lunch)return a.jsx("div",{className:"flex items-center justify-center py-2",children:a.jsx("span",{className:"text-sm text-gray-500 italic",children:tt.label||(tt.is_break?"Break":"Lunch")})});const _e=I[He]&&I[He][tt.id];return a.jsx("div",{children:_e&&_e.length?a.jsx("div",{className:"space-y-2",children:_e.map((Se,he)=>a.jsxs("div",{className:`rounded-lg p-2.5 cursor-pointer transition-all hover:shadow-md ${Se.is_special?"bg-amber-50 border border-amber-200 hover:border-amber-300":"bg-blue-50 border border-blue-200 hover:border-blue-300"}`,onClick:()=>{k({day:He,periodId:tt.id}),U(me(He)),B(!0)},children:[a.jsxs("div",{className:"font-semibold text-gray-900 text-xs leading-tight flex items-center gap-1",children:[a.jsx(gs,{className:"h-3 w-3"}),Se.is_special?Se.timetable_name||"Special":Z(Se.curriculum_row||Se.subject_text),Se.is_special&&a.jsxs("span",{className:"text-amber-600 ml-1",children:[" ",Z(Se.curriculum_row||Se.subject_text)]})]}),a.jsxs("div",{className:"text-xs text-gray-700 mt-1 flex items-center gap-1",children:[a.jsx(bs,{className:"h-3 w-3"}),"Staff: ",(()=>{if(!Se.staff)return"";const ye=Se.staff.first_name||"",ht=Se.staff.last_name||"";return`${ye} ${ht}`.trim()||Se.staff.username||""})(),Se.subject_batch?`  Batch: ${Se.subject_batch.name}`:""]})]},he))}):a.jsxs("div",{className:"py-4 text-gray-400 text-sm cursor-pointer hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-all flex items-center justify-center gap-1",onClick:()=>{k({day:He,periodId:tt.id}),U(me(He)),B(!0)},children:[a.jsx(Mm,{className:"h-4 w-4"}),"Click to assign"]})})}async function Ee(He){if(He&&confirm("Delete this assignment?"))try{const tt=await xr(`/api/timetable/assignments/${He}/`,{method:"DELETE"});if(!tt.ok){const _e=await tt.text();return alert("Failed: "+_e)}await ae()}catch(tt){console.error(tt),alert("Delete failed")}}async function ze(He){if(!He||!confirm("Delete this special period?"))return;let tt=String(He);tt.startsWith("special-")&&(tt=tt.replace("special-",""));const _e=Number(tt);if(!_e)return alert("Invalid special entry id");try{const Se=await xr(`/api/timetable/special-entries/${_e}/`,{method:"DELETE"});if(!Se.ok){const he=await Se.text();return alert("Failed: "+he)}await ae()}catch(Se){console.error(Se),alert("Delete failed")}}async function Xe(He,tt){if(He)try{const _e=await xr(`/api/timetable/assignments/${He}/`,{method:"PATCH",body:JSON.stringify(tt)});if(!_e.ok){const Se=await _e.text();return alert("Failed: "+Se)}await ae(),B(!1),k(null)}catch(_e){console.error(_e),alert("Update failed")}}const ft=(()=>{if(!(d!=null&&d.code))return[];const He=m.filter(Se=>Se.regulation===d.code),tt=new Map;return v.forEach(Se=>{Se.id&&Se.staff&&tt.set(Se.id,Se.staff)}),He.map(Se=>({...Se,staff:tt.get(Se.id)||""}))})();return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-6",children:[a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6 border border-gray-100",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-3 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl",children:a.jsx(ys,{className:"h-7 w-7 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Timetable Editor"}),a.jsx("p",{className:"text-gray-600",children:"Manage class schedules and assignments"})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"px-4 py-2 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg border border-indigo-200",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Z1,{className:"h-4 w-4 text-indigo-600"}),a.jsx("span",{className:"font-semibold text-indigo-900",children:(e.find(He=>He.id===o)||{name:"Section"}).name})]})}),d&&a.jsx("div",{className:"px-4 py-2 bg-gradient-to-r from-emerald-50 to-teal-50 rounded-lg border border-emerald-200",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(gs,{className:"h-4 w-4 text-emerald-600"}),a.jsxs("span",{className:"font-semibold text-emerald-900",children:["Regulation: ",d.code]})]})}),h&&a.jsx("div",{className:"px-4 py-2 bg-gray-50 rounded-lg border border-gray-200",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sc,{className:"h-4 w-4 text-gray-600"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:(r.find(He=>He.id===h)||{name:"Template"}).name})]})})]})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 mb-6 overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sc,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Weekly Schedule"})]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-slate-50 to-blue-50 border-b-2 border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700 min-w-[120px] sticky left-0 bg-gradient-to-r from-slate-50 to-blue-50 z-10",children:"Day / Period"}),i.map(He=>a.jsxs("th",{className:"px-4 py-3 min-w-[160px]",children:[a.jsx("div",{className:"text-sm font-bold text-indigo-700",children:He.label||`Period ${He.index||""}`}),a.jsx("div",{className:"text-xs text-gray-600 mt-0.5",children:He.start_time?`${He.start_time}${He.end_time?" - "+He.end_time:""}`:He.is_break?"Break":""})]},He.id))]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:vre.map((He,tt)=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-4 py-3 font-bold text-gray-900 bg-gray-50 sticky left-0 z-10",children:He}),i.map(_e=>{const Se=S&&S.day===tt+1&&S.periodId===_e.id;return a.jsx("td",{className:`px-4 py-3 align-top ${Se?"bg-indigo-50 border-2 border-indigo-300 shadow-md":""}`,children:Be(tt+1,_e)},_e.id)})]},He))})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(bs,{className:"h-5 w-5 text-indigo-600"}),a.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Subjects & Staff Reference",d&&a.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-600",children:["(Regulation: ",d.code,")"]})]})]})}),a.jsx("div",{className:"overflow-x-auto max-h-96",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 sticky top-0",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Subject"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Staff"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:ft.length===0?a.jsx("tr",{children:a.jsxs("td",{colSpan:2,className:"px-6 py-8 text-center",children:[a.jsx(gs,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-gray-500",children:d?`No subjects found for regulation ${d.code}`:"No subjects found"})]})}):ft.map(He=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-6 py-3 text-sm text-gray-900",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(gs,{className:"h-4 w-4 text-indigo-600"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:He.course_code?`${He.course_code}  ${He.course_name}`:He.course_name}),He.class_type&&a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[He.class_type," ",He.is_elective?" Elective":""]})]})]})}),a.jsx("td",{className:"px-6 py-3 text-sm text-gray-700",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(bs,{className:"h-4 w-4 text-gray-500"}),a.jsx("span",{className:He.staff===""?"text-gray-400 italic":"",children:He.staff}),He.staff===""&&a.jsx("span",{className:"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full",children:"Not Assigned"})]})})]},String(He.id)))})]})})]})]}),T?a.jsx(wre,{editingCell:S,periods:i,assignmentMap:I,specialName:ie,setSpecialName:Y,selectedSpecialId:z,setSelectedSpecialId:G,specialTimetables:se,specialDate:q,setSpecialDate:U,curriculum:m,currentSectionRegulation:d,editingCurriculumId:j,setEditingCurriculumId:A,customSubjectText:C,setCustomSubjectText:K,editingAvailableBatches:L,setEditingAvailableBatches:P,editingBatchId:F,setEditingBatchId:E,isCustomAssignment:J,setIsCustomAssignment:V,customAssignmentText:X,setCustomAssignmentText:Q,selectedStaffId:ne,setSelectedStaffId:oe,staffList:O,sectionId:o,shortLabel:Z,loadBatchesForCurriculum:Ae,handleDeleteSpecialEntry:ze,handleDeleteAssignment:Ee,handleUpdateAssignment:Xe,handleAssign:Te,loadTimetable:ae,setShowCellPopup:B,setEditingCell:k,fetchWithAuth:xr,customSubjectOptions:H}):null]})}function _re(){const[e,t]=x.useState([]),[r,n]=x.useState(null),[i,s]=x.useState(!1),[o,l]=x.useState({name:"",description:"",parity:"BOTH",is_public:!1,is_active:!1}),[c,u]=x.useState([]),[d,f]=x.useState({name:"",parity:"ODD",is_active:!1}),[h,p]=x.useState({index:1,start_time:"",end_time:"",is_break:!1,is_lunch:!1,label:""}),[m,g]=x.useState(null),[y,b]=x.useState({});x.useEffect(()=>{v()},[]),x.useEffect(()=>{w()},[]);async function v(){s(!0);try{const E=await xr("/api/timetable/templates/");if(!E.ok)throw new Error(await E.text());const T=await E.json(),B=Array.isArray(T)?T:T.results||T;if(t(B||[]),B&&B.length){const q=B.find(U=>U.is_active)||B[0];n(q);try{const U=q&&q.periods||[],se=U.length?Math.max(...U.map(de=>Number(de.index||de.position||0))):0;p(de=>({...de,index:Number(se)+1}))}catch{}}}catch(E){console.error(E),alert("Failed to load templates")}finally{s(!1)}}async function w(){try{const E=await xr("/api/academics/academic-years/");if(!E.ok)throw new Error(await E.text());const T=await E.json(),B=Array.isArray(T)?T:T.results||T;u(B||[])}catch(E){console.error(E)}}async function S(){try{const E=await xr("/api/academics/academic-years/",{method:"POST",body:JSON.stringify(d)});if(!E.ok)throw new Error(await E.text());await w(),f({name:"",parity:"ODD",is_active:!1})}catch(E){console.error(E),alert("Failed to create academic year: "+String(E))}}async function k(E,T){try{const B=await xr(`/api/academics/academic-years/${E}/`,{method:"PATCH",body:JSON.stringify({is_active:T})});if(!B.ok)throw new Error(await B.text());await w(),await v()}catch(B){console.error(B),alert("Failed to update academic year: "+String(B))}}async function j(){if(!r)return alert("Select a template first");try{const E={...h,template:r.id},T=await xr("/api/timetable/slots/",{method:"POST",body:JSON.stringify(E)});if(!T.ok)throw new Error(await T.text());await v(),p({index:h.index+1,start_time:"",end_time:"",is_break:!1,is_lunch:!1,label:""})}catch(E){console.error(E),alert("Failed to add slot: "+String(E))}}async function A(E){if(confirm("Delete this period?"))try{const T=await xr(`/api/timetable/slots/${E}/`,{method:"DELETE"});if(!T.ok)throw new Error(await T.text());await v()}catch(T){console.error(T),alert("Failed to delete slot: "+String(T))}}function L(E){g(E.id),b({...E})}function P(){g(null),b({})}async function F(){if(!(!m||!y))try{const E=await xr(`/api/timetable/slots/${m}/`,{method:"PATCH",body:JSON.stringify(y)});if(!E.ok)throw new Error(await E.text());await v(),g(null),b({})}catch(E){console.error(E),alert("Failed to update slot: "+String(E))}}return a.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[a.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[a.jsx("span",{className:"p-3 bg-indigo-100 rounded-xl",children:a.jsxs("svg",{width:"28",height:"28",fill:"none",viewBox:"0 0 48 48",children:[a.jsx("rect",{width:"48",height:"48",rx:"12",fill:"#e0e7ff"}),a.jsx("path",{d:"M16 24h16M16 32h16M16 16h16",stroke:"#6366f1",strokeWidth:"2",strokeLinecap:"round"})]})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"IQAC  Timetable Templates"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Create and manage timetable templates and periods."})]})]}),i&&a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),"Loading templates..."]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsx("div",{className:"lg:col-span-1",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(ys,{className:"w-5 h-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Academic Years"})]}),a.jsxs("div",{className:"space-y-3 mb-6 p-4 bg-gray-50 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{type:"text",placeholder:"e.g. 2025-26",value:d.name,onChange:E=>f({...d,name:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Parity"}),a.jsxs("select",{value:d.parity,onChange:E=>f({...d,parity:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"ODD",children:"Odd"}),a.jsx("option",{value:"EVEN",children:"Even"})]})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",id:"activate",checked:d.is_active,onChange:E=>f({...d,is_active:E.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("label",{htmlFor:"activate",className:"ml-2 text-sm text-gray-700",children:"Activate on create"})]}),a.jsx("button",{onClick:S,className:"w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Create Academic Year"})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Existing Years"}),a.jsx("div",{className:"space-y-2",children:c.map(E=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsx("div",{children:a.jsxs("div",{className:"font-medium text-gray-900",children:[E.name," ",E.parity&&`(${E.parity})`,E.is_active&&a.jsx("span",{className:"ml-2 text-xs bg-green-100 text-green-800 px-2 py-0.5 rounded-full",children:"Active"})]})}),a.jsx("button",{onClick:()=>k(E.id,!E.is_active),className:`px-3 py-1 text-xs font-medium rounded-lg transition-colors ${E.is_active?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:E.is_active?"Deactivate":"Activate"})]},E.id))})]})]})}),a.jsx("div",{className:"lg:col-span-2",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[a.jsx(sc,{className:"w-5 h-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Template Management"})]}),!r&&a.jsxs("div",{className:"text-center py-12 text-gray-500",children:[a.jsx(sc,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),a.jsx("p",{children:"Select a template to manage its periods."})]}),r&&a.jsxs("div",{children:[a.jsxs("div",{className:"border-b border-gray-200 pb-4 mb-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("h4",{className:"text-xl font-semibold text-gray-900",children:r.name}),a.jsx("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded-full",children:r.parity}),r.is_active&&a.jsx("span",{className:"px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full",children:"Active"})]}),r.description&&a.jsx("p",{className:"text-gray-600",children:r.description})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h5",{className:"text-lg font-medium text-gray-900 mb-3",children:"Periods"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full border-collapse border border-gray-200 rounded-lg",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-indigo-50",children:[a.jsx("th",{className:"border border-gray-200 px-4 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider",children:"Label"}),a.jsx("th",{className:"border border-gray-200 px-4 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider",children:"Start Time"}),a.jsx("th",{className:"border border-gray-200 px-4 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider",children:"End Time"}),a.jsx("th",{className:"border border-gray-200 px-4 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider",children:"Type"}),a.jsx("th",{className:"border border-gray-200 px-4 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white",children:(r.periods||[]).map(E=>a.jsx("tr",{className:"hover:bg-gray-50",children:m===E.id?a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"border border-gray-200 px-4 py-3",children:a.jsx("input",{type:"text",value:y.label||"",onChange:T=>b({...y,label:T.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Label"})}),a.jsx("td",{className:"border border-gray-200 px-4 py-3",children:a.jsx("input",{type:"time",value:y.start_time||"",onChange:T=>b({...y,start_time:T.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"border border-gray-200 px-4 py-3",children:a.jsx("input",{type:"time",value:y.end_time||"",onChange:T=>b({...y,end_time:T.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"border border-gray-200 px-4 py-3",children:a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("label",{className:"flex items-center text-xs",children:[a.jsx("input",{type:"checkbox",checked:y.is_break||!1,onChange:T=>b({...y,is_break:T.target.checked,is_lunch:!1}),className:"mr-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),"Break"]}),a.jsxs("label",{className:"flex items-center text-xs",children:[a.jsx("input",{type:"checkbox",checked:y.is_lunch||!1,onChange:T=>b({...y,is_lunch:T.target.checked,is_break:!1}),className:"mr-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),"Lunch"]})]})}),a.jsx("td",{className:"border border-gray-200 px-4 py-3",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:F,className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Save Changes",children:a.jsx(id,{className:"w-4 h-4"})}),a.jsx("button",{onClick:P,className:"p-2 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors",title:"Cancel Edit",children:a.jsx(vu,{className:"w-4 h-4"})})]})})]}):a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"border border-gray-200 px-4 py-3 text-sm text-gray-900",children:E.label||""}),a.jsx("td",{className:"border border-gray-200 px-4 py-3 text-sm text-gray-900",children:E.start_time||""}),a.jsx("td",{className:"border border-gray-200 px-4 py-3 text-sm text-gray-900",children:E.end_time||""}),a.jsx("td",{className:"border border-gray-200 px-4 py-3 text-sm",children:E.is_break?a.jsx("span",{className:"px-2 py-1 text-xs bg-yellow-100 text-yellow-800 rounded-full",children:"Break"}):E.is_lunch?a.jsx("span",{className:"px-2 py-1 text-xs bg-orange-100 text-orange-800 rounded-full",children:"Lunch"}):a.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full",children:"Period"})}),a.jsx("td",{className:"border border-gray-200 px-4 py-3",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>L(E),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit Period",children:a.jsx(uh,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>A(E.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete Period",children:a.jsx(s1,{className:"w-4 h-4"})})]})})]})},E.id))})]})})]}),a.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(Mm,{className:"w-5 h-5 text-green-600"}),a.jsx("h5",{className:"text-lg font-medium text-gray-900",children:"Add New Period"})]}),a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Index"}),a.jsx("input",{type:"number",value:h.index,onChange:E=>p({...h,index:Number(E.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Time"}),a.jsx("input",{type:"time",value:h.start_time,onChange:E=>p({...h,start_time:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Time"}),a.jsx("input",{type:"time",value:h.end_time,onChange:E=>p({...h,end_time:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Label"}),a.jsx("input",{type:"text",placeholder:"Period 1, Break, etc.",value:h.label,onChange:E=>p({...h,label:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),a.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:h.is_break,onChange:E=>p({...h,is_break:E.target.checked,is_lunch:!1}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Break Period"})]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:h.is_lunch,onChange:E=>p({...h,is_lunch:E.target.checked,is_break:!1}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Lunch Period"})]})]}),a.jsxs("button",{onClick:j,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors font-medium flex items-center gap-2",children:[a.jsx(Mm,{className:"w-4 h-4"}),"Add Period"]})]})]})]})})]})]})}function R9(){var k,j,A,L,P;const[e,t]=x.useState(!1),[r,n]=x.useState(null),[i,s]=x.useState([]),[o,l]=x.useState([]),[c,u]=x.useState({}),[d,f]=x.useState({}),[h,p]=x.useState(null);async function m(){t(!0),n(null);try{const[F,E]=await Promise.all([y9(),v9({statuses:["APPROVED","REJECTED"],limit:200})]),T=Array.isArray(F==null?void 0:F.results)?F.results:[],B=Array.isArray(E==null?void 0:E.results)?E.results:[];s(T),l(B),u(q=>{const U={...q};for(const se of T)U[se.id]==null&&(U[se.id]=120);return U})}catch(F){n((F==null?void 0:F.message)||"Failed to load requests")}finally{t(!1)}}x.useEffect(()=>{m()},[]);const g=x.useMemo(()=>[...i].sort((F,E)=>String(E.requested_at||"").localeCompare(String(F.requested_at||""))),[i]),y=x.useMemo(()=>[...o].sort((F,E)=>String(E.reviewed_at||E.requested_at||"").localeCompare(String(F.reviewed_at||F.requested_at||""))),[o]);function b(F){const E=String(F||"").trim();if(!E)return"?";const T=E.split(/\s+/g).filter(Boolean);return T.length===1?T[0].slice(0,2).toUpperCase():(T[0][0]+T[T.length-1][0]).toUpperCase()}function v(F){if(!F)return"";const E=new Date(F);return Number.isNaN(E.getTime())?String(F):E.toLocaleString()}async function w(F){const E=Number(c[F]??120);f(T=>({...T,[F]:!0})),n(null);try{await _9(F,Number.isFinite(E)?E:120),await m()}catch(T){n((T==null?void 0:T.message)||"Approve failed")}finally{f(T=>({...T,[F]:!1}))}}async function S(F){f(E=>({...E,[F]:!0})),n(null);try{await k9(F),await m()}catch(E){n((E==null?void 0:E.message)||"Reject failed")}finally{f(E=>({...E,[F]:!1}))}}return a.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",padding:20},children:[a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center",marginBottom:20},children:[a.jsx(sc,{size:24,color:"#9a3412"}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:24,fontWeight:950,color:"#111827"},children:"OBE Edit Requests"}),a.jsx("div",{style:{color:"#6b7280",fontSize:14},children:"Manage pending requests for Mark Entry and Mark Manager edits from faculty"})]}),a.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:a.jsxs("button",{className:"obe-btn obe-btn-secondary",onClick:m,disabled:e,children:[a.jsx(T2,{size:16,style:{marginRight:6}}),e?"Refreshing":"Refresh"]})})]}),r?a.jsxs("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:12,borderRadius:12,marginBottom:20},children:[a.jsx(y3,{size:16,style:{marginRight:8,verticalAlign:"middle"}}),r]}):null,a.jsxs("div",{style:{display:"grid",gap:18},children:[a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontSize:16,fontWeight:950,color:"#111827"},children:"Answered Now"}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["(",g.length,")"]})]}),g.length===0?a.jsxs("div",{style:{textAlign:"center",padding:22,color:"#6b7280",border:"1px dashed #e5e7eb",borderRadius:14,background:"#fff"},children:[a.jsx(x3,{size:34,color:"#10b981",style:{marginBottom:8}}),a.jsx("div",{children:"No pending requests"})]}):a.jsx("div",{style:{display:"grid",gap:10},children:g.map(F=>{var q,U,se;const E=!!d[F.id],T=String(((q=F.staff)==null?void 0:q.name)||((U=F.staff)==null?void 0:U.username)||"Unknown"),B=(se=F.staff)==null?void 0:se.department;return a.jsxs("div",{onClick:()=>p({kind:"pending",item:F}),style:{border:"1px solid #e5e7eb",borderRadius:14,background:"#fff",padding:12,display:"flex",gap:12,alignItems:"center",cursor:"pointer"},children:[a.jsx("div",{style:{width:44,height:44,borderRadius:999,background:"#fff7ed",border:"1px solid #fed7aa",display:"grid",placeItems:"center",fontWeight:950,color:"#9a3412"},children:b(T)}),a.jsxs("div",{style:{flex:1,minWidth:220},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"baseline"},children:[a.jsx("div",{style:{fontWeight:900,color:"#111827"},children:T}),B?a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[" ",B]}):null]}),a.jsxs("div",{style:{fontSize:13,color:"#374151",fontWeight:700},children:[F.subject_code,"  ",a.jsx("span",{style:{color:"#2563eb",fontWeight:800},children:F.subject_name||F.subject_code})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["Mark Manager  ",F.assessment.toUpperCase(),"  ",v(F.requested_at)]})]}),a.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[a.jsxs("div",{style:{background:"#fef3c7",color:"#92400e",padding:"4px 8px",borderRadius:999,fontSize:12,fontWeight:800,whiteSpace:"nowrap"},children:[a.jsx(sc,{size:12,style:{marginRight:4,verticalAlign:"middle"}}),"Pending"]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},onClick:de=>de.stopPropagation(),children:[a.jsx("input",{type:"number",value:c[F.id]??120,onChange:de=>u(z=>({...z,[F.id]:Number(de.target.value)})),min:1,max:1440,style:{width:82,padding:"6px 8px",border:"1px solid #d1d5db",borderRadius:10},disabled:E,title:"Window minutes"}),a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>w(F.id),disabled:E,children:E?"Approving":"Approve"}),a.jsx("button",{className:"obe-btn obe-btn-danger",onClick:()=>S(F.id),disabled:E,children:E?"Rejecting":"Reject"})]})]})]},F.id)})})]}),a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontSize:16,fontWeight:950,color:"#111827"},children:"History"}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["(",y.length,")"]})]}),y.length===0?a.jsx("div",{style:{textAlign:"center",padding:22,color:"#6b7280",border:"1px dashed #e5e7eb",borderRadius:14,background:"#fff"},children:a.jsx("div",{children:"No reviewed requests yet"})}):a.jsx("div",{style:{display:"grid",gap:10},children:y.map(F=>{var de,z,G;const E=String(((de=F.staff)==null?void 0:de.name)||((z=F.staff)==null?void 0:z.username)||"Unknown"),T=(G=F.staff)==null?void 0:G.department,B=F.status==="APPROVED",q=B?"#ecfdf5":"#fef2f2",U=B?"#065f46":"#991b1b",se=B?"#10b98133":"#ef444433";return a.jsxs("div",{onClick:()=>p({kind:"history",item:F}),style:{border:"1px solid #e5e7eb",borderRadius:14,background:"#fff",padding:12,display:"flex",gap:12,alignItems:"center",cursor:"pointer"},children:[a.jsx("div",{style:{width:44,height:44,borderRadius:999,background:"#f9fafb",border:"1px solid #e5e7eb",display:"grid",placeItems:"center",fontWeight:950,color:"#111827"},children:b(E)}),a.jsxs("div",{style:{flex:1,minWidth:220},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"baseline"},children:[a.jsx("div",{style:{fontWeight:900,color:"#111827"},children:E}),T?a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[" ",T]}):null]}),a.jsxs("div",{style:{fontSize:13,color:"#374151",fontWeight:700},children:[F.subject_code,"  ",a.jsx("span",{style:{color:"#2563eb",fontWeight:800},children:F.subject_name||F.subject_code})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["Mark Manager  ",F.assessment.toUpperCase(),"  Reviewed ",v(F.reviewed_at)]})]}),a.jsx("div",{style:{display:"flex",gap:10,alignItems:"center"},children:a.jsx("div",{style:{background:q,color:U,border:`1px solid ${se}`,padding:"4px 10px",borderRadius:999,fontSize:12,fontWeight:900,whiteSpace:"nowrap"},children:B?"Approved":"Rejected"})})]},F.id)})})]})]}),h?a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:60},onClick:()=>p(null),children:a.jsxs("div",{style:{width:"min(760px, 96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:16},onClick:F=>F.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,color:"#111827"},children:"Request Details"}),a.jsx("div",{style:{marginLeft:"auto"},children:a.jsx("button",{className:"obe-btn",onClick:()=>p(null),children:"Close"})})]}),a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#f9fafb"},children:a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"160px 1fr",rowGap:8,columnGap:10,fontSize:13},children:[a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Status"}),a.jsx("div",{style:{color:"#111827",fontWeight:900},children:h.item.status}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Staff"}),a.jsxs("div",{style:{color:"#111827",fontWeight:900},children:[String(((k=h.item.staff)==null?void 0:k.name)||((j=h.item.staff)==null?void 0:j.username)||"Unknown"),(A=h.item.staff)!=null&&A.department?a.jsxs("span",{style:{color:"#6b7280",fontWeight:700},children:["  ",h.item.staff.department]}):null]}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Subject"}),a.jsxs("div",{style:{color:"#111827"},children:[a.jsx("span",{style:{fontWeight:900},children:h.item.subject_code}),"  ",a.jsx("span",{style:{color:"#2563eb",fontWeight:800},children:h.item.subject_name||h.item.subject_code})]}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Assessment"}),a.jsx("div",{style:{color:"#111827",fontWeight:900},children:h.item.assessment.toUpperCase()}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Requested At"}),a.jsx("div",{style:{color:"#111827"},children:v(h.item.requested_at)}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Reason"}),a.jsx("div",{style:{color:"#111827",whiteSpace:"pre-wrap"},children:h.item.reason||""}),"reviewed_at"in h.item?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Reviewed At"}),a.jsx("div",{style:{color:"#111827"},children:v(h.item.reviewed_at)}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Reviewed By"}),a.jsx("div",{style:{color:"#111827"},children:String(((L=h.item.reviewed_by)==null?void 0:L.name)||((P=h.item.reviewed_by)==null?void 0:P.username)||"")}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Approved Until"}),a.jsx("div",{style:{color:"#111827"},children:v(h.item.approved_until)})]}):null]})})]})}):null]})}const Y8=[1,2,3,4,5,6,7,8],kre=["THEORY","LAB","TCPL","TCPR","PRACTICAL","PROJECT","AUDIT","SPECIAL"],jf={THEORY:"Theory",LAB:"Lab",TCPL:"TCPL",TCPR:"TCPR",PRACTICAL:"Practical",PROJECT:"Project",AUDIT:"Audit",SPECIAL:"Special"},jre=["ssa1","formative1","cia1","ssa2","formative2","cia2","model"],Are=["ssa1","review1","cia1","ssa2","review2","cia2","model"],Nre=["cia1","cia2","model"],Cre=["cia1","cia2","model"],Ere=["review1","review2","model"],X8=["ssa1","formative1","cia1","ssa2","formative2","cia2"],Ou=["ssa1","review1","formative1","cia1","ssa2","review2","formative2","cia2","model"];function Q8(e){var l;const{controls:t,semesterIds:r,assessments:n}=e;if(!r.length||!n.length)return"MIXED";const i=new Set(r.map(c=>Number(c))),s=new Map;for(const c of t||[]){const u=Number((l=c==null?void 0:c.semester)==null?void 0:l.id);if(!Number.isFinite(u)||!i.has(u))continue;const d=String((c==null?void 0:c.assessment)||"").trim().toLowerCase();d&&s.set(`${u}::${d}`,!!(c!=null&&c.is_open))}const o=new Set;for(const c of r)for(const u of n){const d=`${Number(c)}::${String(u).toLowerCase()}`;if(!s.has(d))o.add("ON");else{const f=!!s.get(d);o.add(f?"UNLIMITED":"OFF")}}return o.size===1?Array.from(o)[0]:"MIXED"}function Tre(e,t){if(e==="LAB")return Nre;if(e==="TCPR")return Are;if(e==="PRACTICAL")return Cre;if(e==="PROJECT")return Ere;if(e==="SPECIAL"){const r=[];for(const o of t){const l=Array.isArray(o==null?void 0:o.enabled_assessments)?o.enabled_assessments:[];for(const c of l)r.push(String(c||"").trim().toLowerCase())}const n=F4(r).filter(Boolean);if(!n.length)return[];const i=new Set(X8),s=[];for(const o of X8)n.includes(String(o))&&s.push(o);for(const o of n)i.has(o)&&!s.includes(o)&&s.push(o);return s}return jre}function J8(e,t){if(e==="TCPL"){if(t==="formative1")return"LAB 1";if(t==="formative2")return"LAB 2"}if(e==="LAB"){if(t==="cia1")return"CIA 1 LAB";if(t==="cia2")return"CIA 2 LAB";if(t==="model")return"MODEL LAB"}if(e==="PRACTICAL"){if(t==="cia1")return"CIA 1 Review";if(t==="cia2")return"CIA 2 Review";if(t==="model")return"MODEL Review"}return e==="PROJECT"&&t==="model"?"MODEL Review":t==="ssa1"?"SSA1":t==="ssa2"?"SSA2":t==="review1"?"Review 1":t==="review2"?"Review 2":t==="formative1"?"Formative 1":t==="formative2"?"Formative 2":t==="cia1"?"CIA 1":t==="cia2"?"CIA 2":t==="model"?"MODEL":String(t).toUpperCase()}function Pre(e){const t=String(e||"").trim().toUpperCase();return t==="THEORY"?"THEORY":t==="LAB"?"LAB":t==="TCPL"?"TCPL":t==="TCPR"?"TCPR":t==="PRACTICAL"?"PRACTICAL":t==="PROJECT"?"PROJECT":t==="AUDIT"?"AUDIT":t==="SPECIAL"?"SPECIAL":"THEORY"}function Ore(e,t){const r=String(e||"").trim(),n=String(t||"").trim();return!r||!n?null:`${r}T${n}:00`}function F4(e){const t=new Set,r=[];for(const n of e)t.has(n)||(t.add(n),r.push(n));return r}function Mre(e){const{controls:t,subjectCodes:r,assessments:n}=e;if(!r.length||!n.length)return"MIXED";const i=new Map;for(const l of t||[]){const c=String(l.subject_code||"").trim(),u=String(l.assessment||"").trim().toLowerCase();!c||!u||i.set(`${c}::${u}`,{is_open:!!l.is_open,is_enabled:!!l.is_enabled})}let s=0,o=0;for(const l of r)for(const c of n){const u=`${l}::${String(c).toLowerCase()}`,d=i.get(u);(d?!!d.is_open:!0)?s+=1:o+=1}return s>0&&o>0?"MIXED":o>0?"READONLY":"EDITABLE"}function k3(){const[e,t]=x.useState([]),[r,n]=x.useState(1),[i,s]=x.useState({}),[o,l]=x.useState([]),[c,u]=x.useState([]),[d,f]=x.useState([]),[h,p]=x.useState([]),[m,g]=x.useState("THEORY"),[y,b]=x.useState([]),[v,w]=x.useState(""),[S,k]=x.useState(""),[j,A]=x.useState(!1),[L,P]=x.useState(null),[F,E]=x.useState(null),T=x.useCallback(oe=>({padding:"8px 12px",borderRadius:8,border:oe?"1px solid #10b981":"1px solid #e5e7eb",background:oe?"#ecfdf5":"#fff",fontWeight:700,cursor:"pointer",whiteSpace:"nowrap"}),[]);x.useEffect(()=>{let oe=!0;return(async()=>{try{const O=await d9(),W=Array.isArray(O==null?void 0:O.results)?O.results:[];if(!oe)return;const ae=W.map(I=>({id:Number(I.id),number:(I==null?void 0:I.number)===null||typeof(I==null?void 0:I.number)>"u"?null:Number(I.number)})).filter(I=>Number.isFinite(I.id));ae.sort((I,Z)=>Number(I.number??9999)-Number(Z.number??9999)||I.id-Z.id),t(ae)}catch(O){if(!oe)return;E((O==null?void 0:O.message)||"Failed to load semesters")}})(),()=>{oe=!1}},[]);const B=x.useMemo(()=>{const oe=new Map;for(const O of e){const W=O.number;typeof W=="number"&&Number.isFinite(W)&&oe.set(W,O.id)}return oe},[e]),q=B.get(r)??null,U=x.useMemo(()=>{const oe=[];for(const O of Y8){const W=B.get(O);W&&oe.push(W)}return oe},[B]);x.useEffect(()=>{let oe=!0;return(async()=>{try{if(!U.length)return;const O=await ux(U,Ou);if(!oe)return;p(Array.isArray(O==null?void 0:O.results)?O.results:[])}catch{}})(),()=>{oe=!1}},[U.join(",")]);const se=x.useCallback(async()=>{A(!0),P(null),E(null);try{if(!q){s({}),l([]),u([]),f([]),P(`Semester ${r} is not available in the database.`);return}const[oe,O,W,ae]=await Promise.all([f9([q]),L4([q]),Uv([q]),ux([q],Ou)]),I=(oe==null?void 0:oe.subjects_by_semester)||{},Z=Array.isArray(O==null?void 0:O.results)?O.results:[];s(I),l(Z),u(Array.isArray(W==null?void 0:W.results)?W.results:[]),f(Array.isArray(ae==null?void 0:ae.results)?ae.results:[])}catch(oe){E((oe==null?void 0:oe.message)||"Failed to load semester data")}finally{A(!1)}},[q,r,m]);x.useEffect(()=>{se()},[se]);const de=x.useMemo(()=>{if(!q)return[];const oe=(i==null?void 0:i[String(q)])||[];return(Array.isArray(oe)?oe:[]).filter(O=>O&&O.subject_code)},[i,q]),z=x.useMemo(()=>kre.slice(),[]);x.useEffect(()=>{z.includes(m)||g(z[0]||"THEORY")},[z.join("|")]);const G=x.useMemo(()=>de.filter(oe=>Pre(oe==null?void 0:oe.class_type)===m),[de,m]),ie=x.useMemo(()=>F4(G.map(oe=>String(oe.subject_code||"").trim()).filter(Boolean)),[G]),Y=x.useMemo(()=>F4(de.map(oe=>String(oe.subject_code||"").trim()).filter(Boolean)),[de]),C=x.useMemo(()=>Tre(m,G),[m,G]);x.useEffect(()=>{var Z;const oe=C;if(!oe.length){b([]);return}if(!q){b(oe);return}const O=new Set(ie),W=new Map;for(const me of c||[]){const Te=String(me.subject_code||"").trim();if(!O.has(Te))continue;const Ae=String(me.assessment||"").trim().toLowerCase();Ae&&W.set(Ae,!!me.is_enabled)}const ae=new Set;for(const me of o||[])me!=null&&me.is_active&&(!((Z=me==null?void 0:me.semester)!=null&&Z.id)||Number(me.semester.id)!==Number(q)||O.has(String(me.subject_code||"").trim())&&ae.add(String(me.assessment||"").trim().toLowerCase()));const I=oe.filter(me=>{const Te=String(me).toLowerCase();return W.has(Te)?!!W.get(Te):ae.has(Te)});b(I)},[q,m,c,o,C,ie]);const K=x.useMemo(()=>Mre({controls:c,subjectCodes:ie,assessments:y}),[c,ie,y]),H=x.useMemo(()=>q?Q8({controls:d,semesterIds:[q],assessments:Ou}):"MIXED",[d,q]),R=x.useMemo(()=>U.length?Q8({controls:h,semesterIds:U,assessments:Ou}):"MIXED",[h,U.join(",")]),J=x.useCallback(async(oe,O)=>{A(!0),P(null),E(null);try{const W=O==="ALL"?U:q?[q]:[];if(!W.length)throw new Error("No semester ids available for this action.");if(oe==="ON"?await u9({semester_ids:W,assessments:Ou}):oe==="OFF"?await O4({semester_ids:W,assessments:Ou,is_open:!1}):await O4({semester_ids:W,assessments:Ou,is_open:!0}),q){const ae=await ux([q],Ou);f(Array.isArray(ae==null?void 0:ae.results)?ae.results:[])}if(U.length){const ae=await ux(U,Ou);p(Array.isArray(ae==null?void 0:ae.results)?ae.results:[])}P(`${O==="ALL"?"All Semesters":`SEM ${r}`}: Publish set to ${oe==="ON"?"On (Timed)":oe==="OFF"?"Off (Locked)":"Unlimited (No Time Limit)"}.`)}catch(W){E((W==null?void 0:W.message)||"Publish toggle failed")}finally{A(!1)}},[U,q,r]),V=x.useCallback(async oe=>{const O=!y.includes(oe),W=y;b(ae=>O?[...ae,oe]:ae.filter(I=>I!==oe)),A(!0),P(null),E(null);try{if(!q)throw new Error(`Semester ${r} is not available in the database.`);if(!ie.length)throw new Error(`No courses found for SEM ${r} (${jf[m]}).`);await M4({semester_id:q,subject_codes:ie,assessments:[oe],is_enabled:O}),O||await p9({semester_id:q,subject_codes:ie,assessments:[oe]});const[ae,I]=await Promise.all([Uv([q]),L4([q])]);u(Array.isArray(ae==null?void 0:ae.results)?ae.results:[]),l(Array.isArray(I==null?void 0:I.results)?I.results:[]),P(`SEM ${r}  ${jf[m]}: ${J8(m,oe)} ${O?"enabled":"disabled"}.`)}catch(ae){b(W),E((ae==null?void 0:ae.message)||"Update failed")}finally{A(!1)}},[y,q,r,m,ie]),X=x.useCallback(async()=>{A(!0),P(null),E(null);try{if(!q)throw new Error(`Semester ${r} is not available in the database.`);if(!Y.length)throw new Error(`No courses found for SEM ${r}.`);if(H!=="ON")throw new Error(H==="OFF"?"Publish is OFF (Locked). Set Publish to ON to use a timer.":H==="UNLIMITED"?"Publish is UNLIMITED (No Time Limit). Set Publish to ON to use a due-date timer.":"Publish mode is MIXED. Set a single Publish mode first.");const oe=Ore(v,S);if(!oe)throw new Error("Select Due Date and Due Time");await h9({semester_id:q,subject_codes:Y,assessments:Ou,due_at:oe}),P(`SEM ${r}: Timer applied to all class types.`),await se()}catch(oe){E((oe==null?void 0:oe.message)||"Save failed")}finally{A(!1)}},[q,r,Y,v,S,se,H]),Q=x.useCallback(async oe=>{A(!0),P(null),E(null);try{if(!q)throw new Error(`Semester ${r} is not available in the database.`);if(!y.length)throw new Error("Select at least one exam/assessment");if(!ie.length)throw new Error(`No courses found for SEM ${r} (${jf[m]}).`);await M4({semester_id:q,subject_codes:ie,assessments:y,is_open:oe});const O=await Uv([q]);u(Array.isArray(O==null?void 0:O.results)?O.results:[]),P(`SEM ${r}  ${jf[m]}: ${oe?"Editable":"Read-only"}`)}catch(O){E((O==null?void 0:O.message)||"Lock toggle failed")}finally{A(!1)}},[q,r,y,m,ie]),ne=oe=>{const O=oe==="THIS"?H:R,W=oe==="THIS"&&R==="OFF",ae=j||oe==="ALL"&&!U.length||W;return a.jsxs("div",{className:`pub3${ae?" pub3--disabled":""}`,title:W?"Locked by Common Publish (Off)":void 0,children:[a.jsx("button",{className:`pub3__btn pub3__btn--off${O==="OFF"?" pub3__btn--active":""}`,onClick:()=>void J("OFF",oe),disabled:ae,children:"Off"}),a.jsx("button",{className:`pub3__btn pub3__btn--on${O==="ON"?" pub3__btn--active":""}`,onClick:()=>void J("ON",oe),disabled:ae,children:"On"}),a.jsx("button",{className:`pub3__btn pub3__btn--unlimited${O==="UNLIMITED"?" pub3__btn--active":""}`,onClick:()=>void J("UNLIMITED",oe),disabled:ae,children:"Unlimited"})]})};return a.jsxs("main",{style:{padding:0,fontFamily:"Arial, sans-serif",minHeight:"100vh",background:"#f3f4f6"},children:[a.jsx("style",{children:`
        /*  Neon 3-state publish switch  */
        .pub3 {
          display: inline-flex;
          border-radius: 999px;
          background: #0f172a;
          padding: 4px;
          gap: 3px;
          box-shadow: 0 0 0 1px #1e293b, 0 4px 12px rgba(0,0,0,0.55);
        }
        .pub3--disabled { opacity: 0.4; pointer-events: none; }
        .pub3__btn {
          padding: 8px 18px;
          border-radius: 999px;
          border: none;
          font-weight: 900;
          font-size: 13px;
          cursor: pointer;
          background: transparent;
          color: #64748b;
          transition: background 0.35s cubic-bezier(0.65,0,0.35,1),
                      color 0.35s cubic-bezier(0.65,0,0.35,1),
                      box-shadow 0.35s cubic-bezier(0.65,0,0.35,1);
          letter-spacing: 0.02em;
          min-width: 64px;
        }
        .pub3__btn:disabled { cursor: not-allowed; }
        .pub3__btn--off.pub3__btn--active {
          background: #450a0a;
          color: #fca5a5;
          box-shadow: 0 0 6px #ef4444, 0 0 18px #ef444455, inset 0 0 8px #ef444418;
        }
        .pub3__btn--on.pub3__btn--active {
          background: #052e16;
          color: #86efac;
          box-shadow: 0 0 6px #22c55e, 0 0 18px #22c55e55, inset 0 0 8px #22c55e18;
        }
        .pub3__btn--unlimited.pub3__btn--active {
          background: #1e3a8a;
          color: #93c5fd;
          box-shadow: 0 0 6px #3b82f6, 0 0 18px #3b82f655, inset 0 0 8px #3b82f618;
        }
      `}),a.jsxs("div",{style:{padding:20,maxWidth:1100,margin:"0 auto"},children:[a.jsx("div",{className:"welcome",style:{marginBottom:18},children:a.jsxs("div",{className:"welcome-left",children:[a.jsx("h2",{className:"welcome-title",style:{fontSize:22,marginBottom:2},children:"OBE Master  Lock & Timer Controls"}),a.jsx("div",{className:"welcome-sub",children:"Common Publish  Semester  Publish & Timer  Class Type  Exams"})]})}),F&&a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:12,whiteSpace:"pre-wrap"},children:F}),L&&a.jsx("div",{style:{background:"#ecfdf5",border:"1px solid #10b98133",color:"#065f46",padding:10,borderRadius:10,marginBottom:12,whiteSpace:"pre-wrap"},children:L}),a.jsxs("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:14,padding:"16px 20px",marginBottom:16,display:"flex",alignItems:"center",gap:20,flexWrap:"wrap"},children:[a.jsxs("div",{style:{flex:"0 0 auto"},children:[a.jsx("div",{style:{fontWeight:900,fontSize:14,marginBottom:4,color:"#111827"},children:"Common Publish  All Semesters"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Applies the same publish mode to every semester at once."})]}),a.jsxs("div",{style:{flex:"1 1 auto",display:"flex",alignItems:"center",gap:14,flexWrap:"wrap"},children:[ne("ALL"),a.jsx("span",{style:{fontSize:13,fontWeight:700,color:R==="OFF"?"#991b1b":R==="ON"?"#065f46":R==="UNLIMITED"?"#1e40af":"#6b7280"},children:R==="OFF"?"All Locked":R==="ON"?"All Timer-based":R==="UNLIMITED"?"All Unlimited":"Mixed"})]})]}),a.jsxs("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:14,padding:"14px 18px",marginBottom:0,borderBottomLeftRadius:0,borderBottomRightRadius:0,borderBottom:"2px solid #10b981"},children:[a.jsx("div",{style:{fontWeight:900,fontSize:12,color:"#6b7280",marginBottom:10,textTransform:"uppercase",letterSpacing:1},children:"Select Semester"}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:Y8.map(oe=>a.jsxs("button",{disabled:j,onClick:()=>n(oe),style:T(oe===r),children:["SEM ",oe]},oe))})]}),a.jsxs("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderTop:0,borderRadius:14,borderTopLeftRadius:0,borderTopRightRadius:0,padding:"18px 20px",marginBottom:16},children:[a.jsxs("div",{style:{display:"flex",gap:18,alignItems:"center",flexWrap:"wrap",marginBottom:18,paddingBottom:16,borderBottom:"1px solid #f3f4f6"},children:[a.jsxs("div",{style:{flex:"0 0 auto"},children:[a.jsxs("div",{style:{fontWeight:900,fontSize:13,marginBottom:6,color:"#111827"},children:["Publish  SEM ",r]}),ne("THIS")]}),R==="OFF"?a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"10px 16px",borderRadius:10,background:"#fef2f2",border:"1px solid #fecaca",color:"#991b1b",fontWeight:800,fontSize:13},children:[a.jsx("span",{style:{fontSize:16},children:""})," Locked  Common Publish is Off"]}):H==="ON"?a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap",flex:"1 1 auto"},children:[a.jsx("input",{type:"date",value:v,onChange:oe=>w(oe.target.value),disabled:j,style:{padding:"8px 10px",borderRadius:8,border:"1px solid #e5e7eb",fontSize:13}}),a.jsx("input",{type:"time",value:S,onChange:oe=>k(oe.target.value),disabled:j,style:{padding:"8px 10px",borderRadius:8,border:"1px solid #e5e7eb",fontSize:13}}),a.jsx("button",{onClick:()=>void X(),disabled:j,className:"obe-btn obe-btn-primary",style:{padding:"9px 16px",borderRadius:8,fontWeight:900,fontSize:13},children:j?"Saving":`Apply Timer  SEM ${r}`}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["All ",Y.length," subjects  all class types"]})]}):H==="UNLIMITED"?a.jsx("div",{style:{padding:"10px 16px",borderRadius:10,background:"#eff6ff",color:"#1e40af",fontWeight:800,border:"1px solid #bfdbfe",fontSize:13},children:" No Time Limit  always open"}):H==="OFF"?a.jsx("div",{style:{padding:"10px 16px",borderRadius:10,background:"#fef2f2",color:"#991b1b",fontWeight:800,border:"1px solid #fecaca",fontSize:13},children:" This semester locked"}):null]}),a.jsxs("div",{style:{marginBottom:14},children:[a.jsx("div",{style:{fontWeight:900,fontSize:12,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:1},children:"Class Type"}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:z.map(oe=>a.jsx("button",{disabled:j,onClick:()=>g(oe),style:T(oe===m),children:jf[oe]},oe))}),a.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:[G.length," course",G.length!==1?"s":""," in SEM ",r,"  ",jf[m]]})]}),a.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:"14px 16px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12,flexWrap:"wrap",gap:8},children:[a.jsxs("div",{style:{fontWeight:900,fontSize:14,color:"#111827"},children:["SEM ",r,"  ",jf[m]," Exams"]}),a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Mark Entry Mode:"}),a.jsxs("div",{style:{display:"inline-flex",border:"1px solid #e5e7eb",borderRadius:999,overflow:"hidden",background:"#fff"},children:[a.jsx("button",{onClick:()=>void Q(!1),disabled:j||!y.length,style:{padding:"7px 14px",fontWeight:900,border:0,cursor:"pointer",fontSize:13,background:K==="READONLY"?"#fee2e2":"#fff",color:K==="READONLY"?"#991b1b":"#374151",minWidth:100},children:"Read-only"}),a.jsx("button",{onClick:()=>void Q(!0),disabled:j||!y.length,style:{padding:"7px 14px",fontWeight:900,border:0,cursor:"pointer",fontSize:13,background:K==="EDITABLE"?"#dcfce7":"#fff",color:K==="EDITABLE"?"#065f46":"#374151",minWidth:90},children:"Editable"})]})]})]}),C.length?a.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:10},children:C.map(oe=>a.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center",fontSize:13,padding:"8px 14px",borderRadius:10,border:`2px solid ${y.includes(oe)?"#10b981":"#e5e7eb"}`,background:y.includes(oe)?"#ecfdf5":"#fff",color:y.includes(oe)?"#065f46":"#374151",cursor:"pointer",userSelect:"none",fontWeight:700},children:[a.jsx("input",{type:"checkbox",checked:y.includes(oe),onChange:()=>void V(oe),disabled:j,style:{accentColor:"#10b981",width:15,height:15}}),J8(m,oe)]},oe))}):a.jsxs("div",{style:{color:"#6b7280",fontSize:13,padding:"8px 0"},children:["No exams configured for ",jf[m],"."]}),a.jsx("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:"Uncheck an exam to hide it from staff (message-only). Selected exams also control the Mark Entry Mode lever above."})]})]})]})]})}const lf="https://db.krgi.co.in";async function Kd(){const e=await xr(`${lf}/api/curriculum/master/`);if(!e.ok)throw new Error("Failed to fetch masters");return e.json()}async function Lre(e){const t=await xr(`${lf}/api/curriculum/master/`,{method:"POST",body:JSON.stringify(e)});if(!t.ok)throw new Error(await t.text());return t.json()}async function Rre(e,t){const r=await xr(`${lf}/api/curriculum/master/${e}/`,{method:"PATCH",body:JSON.stringify(t)});try{if(!r.ok){const n=r.headers.get("content-type");if(n&&n.includes("application/json")){const i=await r.json();throw new Error(i.detail||"An error occurred")}else throw new Error(await r.text())}return r.json()}catch(n){throw console.error("Error in updateMaster:",n),n}}async function Sl(){const e=await xr(`${lf}/api/curriculum/department/`);if(!e.ok)throw new Error("Failed to fetch dept rows");return e.json()}async function j3(e){const t=await xr(`${lf}/api/curriculum/department/${encodeURIComponent(String(e))}/`);if(!t.ok)throw new Error("Failed to fetch dept row");return t.json()}async function hm(e){const t=new URLSearchParams;e!=null&&e.department_id&&t.set("department_id",String(e.department_id)),e!=null&&e.regulation&&t.set("regulation",e.regulation),e!=null&&e.semester&&t.set("semester",String(e.semester));const r=`${lf}/api/curriculum/elective/?${t.toString()}`,n=await xr(r);if(!n.ok)throw new Error("Failed to fetch electives");return n.json()}async function Fre(e){const t=await xr(`${lf}/api/curriculum/elective/`,{method:"POST",body:JSON.stringify(e)});if(!t.ok)throw new Error(await t.text());return t.json()}async function Bre(e,t){const r=await xr(`${lf}/api/curriculum/department/${e}/`,{method:"PATCH",body:JSON.stringify(t)});if(!r.ok)throw new Error(await r.text());return r.json()}async function Ire(e,t){const r=await xr(`${lf}/api/curriculum/department/${e}/approve/`,{method:"POST",body:JSON.stringify({action:t})});if(!r.ok)throw new Error(await r.text());return r.json()}function zg(e){return String(e||"").trim()}function Dre(){const e=xo(),[t,r]=x.useState([]),[n,i]=x.useState(!0),[s,o]=x.useState(null),[l,c]=x.useState("");x.useEffect(()=>{let f=!0;return(async()=>{try{const h=await Sl();if(!f)return;r(Array.isArray(h)?h:[]),o(null)}catch(h){if(!f)return;r([]),o((h==null?void 0:h.message)||"Failed to load courses")}finally{f&&i(!1)}})(),()=>{f=!1}},[]);const u=x.useMemo(()=>{const f=new Map;for(const h of t||[]){const p=zg(h.course_code);if(!p)continue;const m={course_code:p,course_name:zg(h.course_name),class_type:zg(h.class_type)||null,question_paper_type:zg(h.question_paper_type)||null},g=f.get(p);if(!g){f.set(p,m);continue}const y=b=>(b.course_name?1:0)+(b.class_type?1:0)+(b.question_paper_type?1:0)+(String(b.question_paper_type||"").trim().toUpperCase()&&String(b.question_paper_type||"").trim().toUpperCase()!=="QP1"?1:0);y(m)>y(g)&&f.set(p,m)}return Array.from(f.values()).sort((h,p)=>h.course_code.localeCompare(p.course_code))},[t]),d=x.useMemo(()=>{const f=zg(l).toLowerCase();return f?u.filter(h=>`${h.course_code} ${h.course_name}`.toLowerCase().includes(f)):u},[u,l]);return n?a.jsx("div",{style:{color:"#6b7280"},children:"Loading courses"}):s?a.jsx("div",{style:{color:"#b91c1c"},children:s}):a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,alignItems:"flex-end",flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:16,fontWeight:800,color:"#0f172a"},children:"Courses"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Search and open a course to view sections and staff mappings."})]}),a.jsxs("div",{style:{minWidth:280},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Search"}),a.jsx("input",{value:l,onChange:f=>c(f.target.value),placeholder:"Course code or name",className:"obe-input"})]})]}),d.length===0?a.jsx("div",{style:{color:"#6b7280"},children:"No courses found."}):a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(260px, 1fr))",gap:12},children:d.map(f=>a.jsxs("div",{className:"obe-card",style:{display:"flex",flexDirection:"column",gap:8},children:[a.jsx("div",{style:{fontWeight:900,color:"#0f172a"},children:f.course_code}),a.jsx("div",{style:{color:"#374151",fontWeight:700},children:f.course_name||""}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[f.class_type?`Class type: ${f.class_type}`:"",f.question_paper_type?`    QP: ${f.question_paper_type}`:""]}),a.jsx("div",{style:{marginTop:6},children:a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:()=>e(`/iqac/academic-controller/course/${encodeURIComponent(f.course_code)}`),children:"Open"})})]},f.course_code))})]})}function $re(){var L;const e=x.useMemo(()=>[{key:"THEORY_QP1",label:"Theory QP 1",class_type:"THEORY",question_paper_type:"QP1"},{key:"THEORY_QP2",label:"Theory QP 2",class_type:"THEORY",question_paper_type:"QP2"},{key:"TCPR",label:"TCPR",class_type:"TCPR"},{key:"TCPL",label:"TCPL",class_type:"TCPL"},{key:"LAB",label:"LAB",class_type:"LAB"}],[]),[t,r]=x.useState(((L=e[0])==null?void 0:L.key)||""),n=x.useMemo(()=>e.find(P=>P.key===t)||null,[e,t]),[i,s]=x.useState("CIA1"),[o,l]=x.useState([]),[c,u]=x.useState(null),[d,f]=x.useState(null),[h,p]=x.useState(!1),[m,g]=x.useState(!1),[y,b]=x.useState(null),v=x.useMemo(()=>{const P=(n==null?void 0:n.class_type)||"THEORY",F=(n==null?void 0:n.question_paper_type)||null;return{class_type:P,question_paper_type:F,exam:i}},[n,i]);x.useEffect(()=>{let P=!1;async function F(){var E,T;u(null),f(null),p(!0),b(null);try{const B=await ah(v);if(P)return;const q=Array.isArray((E=B==null?void 0:B.pattern)==null?void 0:E.marks)?B.pattern.marks:[],U=Array.isArray((T=B==null?void 0:B.pattern)==null?void 0:T.cos)?B.pattern.cos:[],se=q.map((de,z)=>({marks:String(de),co:U[z]==null?"":String(U[z])}));l(se),b((B==null?void 0:B.updated_at)??null)}catch(B){if(P)return;f(String((B==null?void 0:B.message)||B||"Failed to load pattern.")),l([])}finally{P||p(!1)}}return F(),()=>{P=!0}},[v]);const w=()=>{l(P=>[...P,{marks:"",co:i==="CIA2"?"3":"1"}])},S=P=>{l(F=>F.filter((E,T)=>T!==P))},k=(P,F)=>{l(E=>{const T=[...E],B=T[P]||{marks:"",co:""};return T[P]={...B,marks:F},T})},j=(P,F)=>{l(E=>{const T=[...E],B=T[P]||{marks:"",co:""};return T[P]={...B,co:F},T})},A=async()=>{u(null),f(null);try{const P=o.map(q=>({marks:String(q.marks??"").trim(),co:String((q==null?void 0:q.co)??"").trim()}));if(P.length&&P.some(q=>!q.marks||!q.co)){f("Enter marks and CO for all rows (or delete empty rows).");return}for(const q of P){const U=Number(q.marks);if(!Number.isFinite(U)||U<0){f("Marks must be a non-negative number.");return}}const F=q=>{const U=String(q||"").trim();if(!U)return"";if(U==="both")return"both";if(U==="1&2")return 12;if(U==="3&4")return 34;const se=Number(U);return Number.isFinite(se)?Math.trunc(se):""};g(!0);const E=P.map(q=>Number(q.marks)),T=P.map(q=>F(q.co)).filter(q=>q!=="");if(T.length!==E.length){f("CO values must be valid for all rows.");return}const B=await g9({class_type:v.class_type,question_paper_type:v.question_paper_type,exam:v.exam,pattern:{marks:E,cos:T}});b((B==null?void 0:B.updated_at)??null),u("Saved.")}catch(P){f((P==null?void 0:P.message)||"Save failed.")}finally{g(!1)}};return a.jsxs("div",{children:[a.jsxs("div",{style:{marginBottom:12},children:[a.jsx("div",{style:{fontSize:16,fontWeight:800,color:"#0f172a"},children:"QP"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Select the QP/class type option."})]}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:12},children:e.map(P=>{const F=P.key===t;return a.jsx("button",{onClick:()=>r(P.key),className:F?"obe-btn obe-btn-primary":"obe-btn obe-btn-secondary",type:"button",children:P.label},P.key)})}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:12},children:["CIA1","CIA2","MODEL"].map(P=>{const F=i===P;return a.jsx("button",{onClick:()=>s(P),className:F?"obe-btn obe-btn-primary":"obe-btn obe-btn-secondary",type:"button",children:P==="CIA1"?"CIA 1":P==="CIA2"?"CIA 2":"MODEL"},P)})}),n?a.jsxs("div",{className:"obe-card",style:{padding:12},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",fontWeight:800,marginBottom:6},children:"Selected"}),a.jsx("div",{style:{fontWeight:900,color:"#111827"},children:n.label}),a.jsxs("div",{style:{marginTop:6,fontSize:13,color:"#374151"},children:["Class type: ",a.jsx("strong",{children:n.class_type}),n.question_paper_type?a.jsxs(a.Fragment,{children:[" "," QP: ",a.jsx("strong",{children:n.question_paper_type})]}):null," "," Exam: ",a.jsx("strong",{children:i==="CIA1"?"CIA 1":i==="CIA2"?"CIA 2":"MODEL"})]}),h?a.jsx("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:"Loading saved pattern"}):y?a.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:["Last saved: ",new Date(y).toLocaleString()]}):null]}):null,a.jsxs("div",{className:"obe-card",style:{padding:12,marginTop:12},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,alignItems:"baseline",flexWrap:"wrap",marginBottom:10},children:[a.jsx("div",{style:{fontWeight:900,color:"#111827"},children:"QP Pattern"}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[i==="CIA1"?"CIA 1":i==="CIA2"?"CIA 2":"MODEL","  ",(n==null?void 0:n.label)||t]})]}),d?a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10},children:d}):null,c?a.jsx("div",{style:{background:"#ecfdf5",border:"1px solid #10b98133",color:"#065f46",padding:10,borderRadius:10,marginBottom:10},children:c}):null,a.jsx("div",{style:{overflowX:"auto"},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{textAlign:"left",fontSize:12,color:"#6b7280",padding:"8px 6px",borderBottom:"1px solid #e5e7eb"},children:"S.No"}),a.jsx("th",{style:{textAlign:"left",fontSize:12,color:"#6b7280",padding:"8px 6px",borderBottom:"1px solid #e5e7eb"},children:"Marks"}),a.jsx("th",{style:{textAlign:"left",fontSize:12,color:"#6b7280",padding:"8px 6px",borderBottom:"1px solid #e5e7eb"},children:"CO"}),a.jsx("th",{style:{width:120,borderBottom:"1px solid #e5e7eb"}})]})}),a.jsx("tbody",{children:o.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:4,style:{padding:10,color:"#6b7280"},children:"No questions yet. Click + to add."})}):o.map((P,F)=>a.jsxs("tr",{children:[a.jsx("td",{style:{padding:"8px 6px",borderBottom:"1px solid #f3f4f6",fontWeight:800},children:F+1}),a.jsx("td",{style:{padding:"8px 6px",borderBottom:"1px solid #f3f4f6"},children:a.jsx("input",{className:"obe-input",type:"number",min:0,step:"0.5",value:P.marks,onChange:E=>k(F,E.target.value),placeholder:"Marks",style:{maxWidth:160}})}),a.jsx("td",{style:{padding:"8px 6px",borderBottom:"1px solid #f3f4f6"},children:a.jsxs("select",{className:"obe-input",value:String((P==null?void 0:P.co)??""),onChange:E=>j(F,E.target.value),style:{maxWidth:160},children:[a.jsx("option",{value:"",children:"Select"}),i==="MODEL"?a.jsxs(a.Fragment,{children:[a.jsx("option",{value:"1",children:"1"}),a.jsx("option",{value:"2",children:"2"}),a.jsx("option",{value:"3",children:"3"}),a.jsx("option",{value:"4",children:"4"}),a.jsx("option",{value:"5",children:"5"})]}):i==="CIA2"?a.jsxs(a.Fragment,{children:[a.jsx("option",{value:"3",children:"3"}),a.jsx("option",{value:"4",children:"4"}),a.jsx("option",{value:"3&4",children:"3&4"})]}):a.jsxs(a.Fragment,{children:[a.jsx("option",{value:"1",children:"1"}),a.jsx("option",{value:"2",children:"2"}),a.jsx("option",{value:"1&2",children:"1&2"})]})]})}),a.jsx("td",{style:{padding:"8px 6px",borderBottom:"1px solid #f3f4f6"},children:a.jsx("button",{type:"button",className:"obe-btn obe-btn-danger",onClick:()=>S(F),children:"Delete"})})]},F))})]})}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginTop:12},children:[a.jsx("button",{type:"button",className:"obe-btn obe-btn-secondary",onClick:w,children:"+"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-primary",onClick:A,disabled:m,children:m?"Saving":"Save"})]})]})]})}const Zp=["Theory","Lab","Tcpl","Tcpr","Practical","Project","Audit","Special"];function ti(e){return String(e??"").trim().toUpperCase()}function A3(e){const t=ti(e);return t?!!(t==="LAB"||t==="L"||t.startsWith("LAB")||t.includes("LAB")||t.includes("PRACTICAL")||t.includes("PRACT")):!1}function Ure(e){return ti(e)==="SPECIAL"}function Jn(e){try{const t=window.localStorage.getItem(e);return t?JSON.parse(t):null}catch{return null}}function Kn(e,t){try{window.localStorage.setItem(e,JSON.stringify(t))}catch{}}function Mu(e){try{window.localStorage.removeItem(e)}catch{}}const Hu=[1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,2,2,2,2,4],zre=["THEORY","TCPR","TCPL","LAB","AUDIT","PRACTICAL","SPECIAL"],V5=6,Wre=64;function qre(e){const t=ti(e);return t==="THEORY"?"Theory":t==="TCPL"?"TCPL":t==="TCPR"?"TCPR":t?t.charAt(0).toUpperCase()+t.slice(1).toLowerCase():""}function F9(e){const t=Array.isArray(e)?[...e]:[...Hu];for(;t.length<17;)t.push("");return t.slice(0,17)}function Z8(e,t,r,n){const i=Number(e),s=Number(t),o=Number(r),l=Number(n),c=(Number.isFinite(s)?s:0)+(Number.isFinite(o)?o:0)+(Number.isFinite(l)?l:0);if(!Number.isFinite(i)||i<=0||!c)return[0,0,0];const u=Math.round(i*(s||0)/c*100)/100,d=Math.round(i*(o||0)/c*100)/100,f=Math.round(i*(l||0)/c*100)/100;return[u,d,f]}function G5(e,t){let r=Array.isArray(e)?[...e]:[...Hu];if(r.length===13){const[n,i,s]=Z8(r[0]??0,(t==null?void 0:t.ssa1)??1.5,(t==null?void 0:t.cia1)??3,(t==null?void 0:t.formative1)??2.5),[o,l,c]=Z8(r[1]??0,(t==null?void 0:t.ssa1)??1.5,(t==null?void 0:t.cia1)??3,(t==null?void 0:t.formative1)??2.5);r=[n,i,s,o,l,c,...r.slice(2)]}return r=F9(r),r}function Hre(e){const t=ti(e);if(t==="LAB"||t==="PRACTICAL")return[{header:"CO1",cols:[{label:"CIA 1",index:1}]},{header:"CO2",cols:[{label:"CIA 1",index:4}]},{header:"CO3",cols:[{label:"CIA 2",index:7}]},{header:"CO4",cols:[{label:"CIA 2",index:10}]},{header:"ME",cols:[{label:"MODEL",index:16}]}];const r=o=>t==="TCPR"?o===1||o===2?"Review 1":"Review 2":t==="TCPL"?o===1||o===2?"LAB 1":"LAB 2":o===1||o===2?"Formative 1":"Formative 2",n=o=>o===1||o===2?"CIA 1":"CIA 2",i=o=>o===1||o===2?"SSA 1":"SSA 2",s=(o,l)=>({header:`CO${o}`,cols:[{label:i(o),index:l},{label:n(o),index:l+1},{label:r(o),index:l+2}]});return[s(1,0),s(2,3),s(3,6),s(4,9),{header:"ME",cols:[{label:"CO1",index:12},{label:"CO2",index:13},{label:"CO3",index:14},{label:"CO4",index:15},{label:"CO5",index:16}]}]}function Vre(){const[e,t]=x.useState({}),[r,n]=x.useState(!1),[i,s]=x.useState(!1),[o,l]=x.useState(null),[c,u]=x.useState(null);x.useEffect(()=>{n(!0),l(null),(async()=>{const p=()=>{const g={};for(const y of Zp){const b=ti(String(y));let v=1.5,w=3,S=2.5;b==="TCPL"?(v=1,w=3.25,S=3.5):b==="TCPR"?(v=1,w=3.25,S=4):b==="LAB"&&(v=1,w=1,S=1);let k=[...Hu];if(b==="THEORY")k=[...Hu];else if(b==="TCPL"){k=[];for(let j=0;j<4;j++)k.push(v,w,S);k.push(3,3,3,3,7)}else if(b==="TCPR"){k=[];for(let j=0;j<4;j++)k.push(v,w,S);k.push(3,3,3,3,10)}g[b]={ssa1:v,cia1:w,formative1:S,internal_mark_weights:k}}return g.THEORY||(g.THEORY={ssa1:1.5,cia1:3,formative1:2.5,internal_mark_weights:[...Hu]}),g},m=g=>{const y=p();if(!g||typeof g!="object")return y;const b={...y},v=Array.from(new Set([...Zp.map(S=>ti(String(S))),"THEORY"])),w=g.THEORY??g.Theory??g.theory??null;w&&typeof w=="object"&&(g.THEORY=w);for(const S of v){const k=g[S]??g[String(S)]??g[String(S).toUpperCase()]??null;if(!k||typeof k!="object")continue;const j=Array.isArray(k.internal_mark_weights)?k.internal_mark_weights:null,A={ssa1:k.ssa1??b[S].ssa1,cia1:k.cia1??b[S].cia1,formative1:k.formative1??b[S].formative1};b[S]={ssa1:A.ssa1,cia1:A.cia1,formative1:A.formative1,internal_mark_weights:G5(j&&j.length?j:b[S].internal_mark_weights,A)}}return b};try{const y=await(await dm(()=>Promise.resolve().then(()=>K8),void 0)).fetchClassTypeWeights(),b=m(y);t(b);return}catch{}try{const g=Jn("iqac_class_type_weights"),y=m(g);t(y)}catch{const g=p();t(g)}finally{n(!1)}})().finally(()=>n(!1))},[]);const d=(p,m,g)=>{t(y=>({...y,[p]:{...y[p],[m]:g}}))},f=(p,m,g)=>{t(y=>{const b=y[p]||{ssa1:"",cia1:"",formative1:"",internal_mark_weights:[...Hu]},v=Array.isArray(b.internal_mark_weights)?[...b.internal_mark_weights]:[...Hu];for(;v.length<17;)v.push("");return v[m]=g,{...y,[p]:{...b,internal_mark_weights:v}}})},h=async()=>{s(!0),l(null),u(null);try{const p={},m=Array.from(new Set([...Zp.map(y=>ti(String(y))),"THEORY"]));for(const y of m){const b=e[y]??e[y.toLowerCase()]??e[y.toUpperCase()]??{},v=G5(Array.isArray(b==null?void 0:b.internal_mark_weights)?b.internal_mark_weights:Hu,{ssa1:b==null?void 0:b.ssa1,cia1:b==null?void 0:b.cia1,formative1:b==null?void 0:b.formative1});p[y]={ssa1:Number(b==null?void 0:b.ssa1)||0,cia1:Number(b==null?void 0:b.cia1)||0,formative1:Number(b==null?void 0:b.formative1)||0,internal_mark_weights:F9(v).map((w,S)=>{const k=Number(w);return Number.isFinite(k)?k:Hu[S]??0})}}p.THEORY||(p.THEORY=p.THEORY||null);let g=!1;try{await(await dm(()=>Promise.resolve().then(()=>K8),void 0)).upsertClassTypeWeights(p),g=!0}catch{Kn("iqac_class_type_weights",p)}t(p),u(g?"Weights saved to server successfully.":"Saved locally (backend not reachable).")}catch(p){l((p==null?void 0:p.message)||"Failed to save weights")}finally{s(!1)}};return a.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",padding:24},children:[a.jsx("h2",{children:"Class Type Weights"}),a.jsx("p",{children:"Set the weights for each class type. These weights are IQAC-controlled and are not editable by staff."}),r?a.jsx("div",{children:"Loading..."}):a.jsxs("form",{onSubmit:p=>{p.preventDefault(),h()},children:[a.jsxs("div",{style:{marginBottom:16},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"CO Attainment Weights"}),a.jsx("div",{style:{color:"#6b7280",fontSize:13},children:"Used in CO Attainment (SSA/CIA/Formative blend)."})]}),a.jsx("div",{style:{overflowX:"auto",marginBottom:24},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{border:"1px solid #ccc",padding:8},children:"Class Type"}),a.jsx("th",{style:{border:"1px solid #ccc",padding:8},children:"SSA1"}),a.jsx("th",{style:{border:"1px solid #ccc",padding:8},children:"CIA1"}),a.jsx("th",{style:{border:"1px solid #ccc",padding:8},children:"Formative1"})]})}),a.jsx("tbody",{children:Zp.map(p=>{var y,b,v;const m=ti(String(p)),g=String(p).charAt(0).toUpperCase()+String(p).slice(1);return a.jsxs("tr",{children:[a.jsx("td",{style:{border:"1px solid #ccc",padding:8},children:g}),a.jsx("td",{style:{border:"1px solid #ccc",padding:8},children:a.jsx("input",{type:"number",step:"0.1",value:((y=e[m])==null?void 0:y.ssa1)??"",onChange:w=>d(m,"ssa1",w.target.value),required:!0})}),a.jsx("td",{style:{border:"1px solid #ccc",padding:8},children:a.jsx("input",{type:"number",step:"0.1",value:((b=e[m])==null?void 0:b.cia1)??"",onChange:w=>d(m,"cia1",w.target.value),required:!0})}),a.jsxs("td",{style:{border:"1px solid #ccc",padding:8},children:[a.jsx("input",{type:"number",step:"0.1",value:((v=e[m])==null?void 0:v.formative1)??"",onChange:w=>d(m,"formative1",w.target.value),required:!0}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:4},children:m==="TCPL"?"Lab":m==="TCPR"?"Review":"Formative"})]})]},m)})})]})}),a.jsxs("div",{style:{marginBottom:16},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Internal Mark Weightage"}),a.jsx("div",{style:{color:"#6b7280",fontSize:13},children:"Inputs are mapped exactly to class-type exam assignments used in Internal Mark calculation."})]}),a.jsx("div",{style:{marginBottom:24},children:zre.map(p=>{const m=ti(String(p)),g=e[m],y=G5(Array.isArray(g==null?void 0:g.internal_mark_weights)?g.internal_mark_weights:Hu,g),b=Hre(m),v=b.flatMap(w=>w.cols);return a.jsxs("div",{style:{marginBottom:18,overflowX:"auto"},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:8},children:qre(m)}),a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:b.map(w=>a.jsx("th",{colSpan:w.cols.length,style:{border:"1px solid #ccc",padding:V5,textAlign:"center",whiteSpace:"nowrap",fontSize:13},children:w.header},w.header))}),a.jsx("tr",{children:v.map(w=>a.jsx("th",{style:{border:"1px solid #ccc",padding:V5,textAlign:"center",whiteSpace:"nowrap",fontSize:12},children:w.label},`${w.label}_${w.index}`))})]}),a.jsx("tbody",{children:a.jsx("tr",{children:v.map(w=>a.jsx("td",{style:{border:"1px solid #ccc",padding:V5,textAlign:"center"},children:a.jsx("input",{type:"number",step:"0.1",value:y[w.index]??"",onChange:S=>f(m,w.index,S.target.value),required:!0,style:{width:Wre}})},w.index))})})]})]},m)})}),a.jsx("button",{type:"submit",disabled:i,style:{padding:"8px 18px",fontWeight:700},children:i?"Saving...":"Save"}),o&&a.jsx("div",{style:{color:"red",marginTop:12},children:o}),c&&a.jsx("div",{style:{color:"green",marginTop:12},children:c})]})]})}const K5=[{id:"cia1_co1_co2",label:"CIA 1",cos:["CO1","CO2"],assessment:"cia1"},{id:"cia2_co3_co4",label:"CIA 2",cos:["CO3","CO4"],assessment:"cia2"},{id:"model_co1_co2_co3_co4_co5",label:"MODEL",cos:["CO1","CO2","CO3","CO4","CO5"],assessment:"model"},{id:"model_co3_co4_co5",label:"MODEL",cos:["CO3","CO4","CO5"],assessment:"model"},{id:"model_co5",label:"MODEL",cos:["CO5"],assessment:"model"}];function eP(e){const t=String(e||"").trim().toLowerCase();return t==="cia1_co1_co2"?"cia1_co1_co2":t==="cia2_co3_co4"?"cia2_co3_co4":t==="model_co1_co2_co3_co4_co5"?"model_co1_co2_co3_co4_co5":t==="model_co3_co4_co5"?"model_co3_co4_co5":t==="model_co5"?"model_co5":null}function Y5(e){const t=new Set,r={cia1_co1_co2:"CIA 1",cia2_co3_co4:"CIA 2",model_co1_co2_co3_co4_co5:"MODEL",model_co3_co4_co5:"MODEL",model_co5:"MODEL"},n=Array.isArray(e)?e:[];for(const i of n){if(typeof i=="string"){const s=eP(i);s&&t.add(s);continue}if(i&&typeof i=="object"){const s=eP(i.id);if(!s)continue;t.add(s);const o=String(i.name||"").trim();o&&(r[s]=o)}}return{selected:t,names:r}}function Gre({isOpen:e,onClose:t,onSave:r,currentSelection:n}){const i=Y5(n.options),[s,o]=x.useState(i.selected),[l,c]=x.useState(i.names),[u,d]=x.useState(Number(n.divider)||2),[f,h]=x.useState(Number(n.multiplier)||.15),[p,m]=x.useState("");x.useEffect(()=>{const v=Y5(n.options);o(v.selected),c(v.names),d(Number(n.divider)||2),h(Number(n.multiplier)||.15),m("")},[n,e]);const g=v=>{const w=new Set(s);if(w.has(v))w.delete(v),o(w),m("");else{const S=K5.find(k=>k.id===v);if(S){const k=new Set;w.forEach(L=>{const P=K5.find(F=>F.id===L);P&&P.cos.forEach(F=>k.add(F))});const A=S.cos.filter(L=>k.has(L));if(A.length>0){m(`Cannot select this option: ${A.join(", ")} already selected in another option. Only one option per CO is allowed.`);return}w.add(v),o(w),m("")}}},y=()=>{const v=Number(u),w=Number(f);if(!Number.isFinite(v)||v<=0){m("Divider must be a number greater than 0.");return}if(!Number.isFinite(w)||w<0){m("Multiplier must be a number greater than or equal to 0.");return}m("");const S=Array.from(s).map(k=>({id:k,name:String((l==null?void 0:l[k])||"").trim()||void 0}));r({options:S,divider:v,multiplier:w}),t()},b=()=>{m("");const v=Y5(n.options);o(v.selected),c(v.names),d(Number(n.divider)||2),h(Number(n.multiplier)||.15),t()};return e?a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:b,children:a.jsxs("div",{style:{backgroundColor:"white",borderRadius:12,padding:24,maxWidth:500,width:"90%",maxHeight:"80vh",overflow:"auto",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)"},onClick:v=>v.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[a.jsx("h2",{style:{margin:0,fontSize:20,fontWeight:700,color:"#0f172a"},children:"CQI Editor"}),a.jsx("button",{onClick:b,style:{background:"transparent",border:"none",fontSize:24,cursor:"pointer",color:"#64748b",padding:0,width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center"},title:"Close",children:""})]}),a.jsx("div",{style:{fontSize:14,color:"#64748b",marginBottom:20},children:"Select when to show the CQI buttons. Multiple options can be selected as long as COs don't overlap."}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:16},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"TOTAL<58 Divider"}),a.jsx("input",{type:"number",value:String(u),onChange:v=>d(Number(v.target.value)),className:"obe-input",min:.1,step:.1})]}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"TOTAL58 Multiplier"}),a.jsx("input",{type:"number",value:String(f),onChange:v=>h(Number(v.target.value)),className:"obe-input",min:0,step:.01})]})]}),p&&a.jsx("div",{style:{padding:12,marginBottom:16,backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:8,color:"#b91c1c",fontSize:13},children:p}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12,marginBottom:24},children:K5.map(v=>a.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:12,padding:16,border:"2px solid",borderColor:s.has(v.id)?"#3b82f6":"#e2e8f0",borderRadius:8,cursor:"pointer",backgroundColor:s.has(v.id)?"#eff6ff":"white",transition:"all 0.2s"},children:[a.jsx("input",{type:"checkbox",checked:s.has(v.id),onChange:()=>g(v.id),style:{marginTop:3,width:18,height:18,cursor:"pointer"}}),a.jsxs("div",{style:{flex:1},children:[a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:12,marginBottom:6},children:[a.jsxs("div",{style:{fontWeight:600,color:"#0f172a"},children:[v.label," - ",v.cos.join(" and ")]}),a.jsxs("div",{style:{minWidth:190},children:[a.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"Display name"}),a.jsx("input",{type:"text",value:String((l==null?void 0:l[v.id])||v.label),onChange:w=>{const S=String(w.target.value||"");c(k=>({...k,[v.id]:S}))},className:"obe-input",style:{padding:8},placeholder:v.label})]})]}),a.jsxs("div",{style:{fontSize:13,color:"#64748b"},children:["Show CQI button after ",v.label," exam"]})]})]},v.id))}),a.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end"},children:[a.jsx("button",{onClick:b,className:"obe-btn",style:{minWidth:80},children:"Cancel"}),a.jsx("button",{onClick:y,className:"obe-btn obe-btn-primary",style:{minWidth:80},children:"Save"})]})]})}):null}function Kre(){const e={options:[],divider:2,multiplier:.15},[t,r]=x.useState(!1),[n,i]=x.useState(e),[s,o]=x.useState(!1);x.useEffect(()=>{let c=!0;return o(!0),vS().then(u=>{c&&i({options:Array.isArray(u.options)?u.options:[],divider:Number.isFinite(Number(u.divider))?Number(u.divider):2,multiplier:Number.isFinite(Number(u.multiplier))?Number(u.multiplier):.15})}).catch(()=>{}).finally(()=>{c&&o(!1)}),()=>{c=!1}},[]);const l=async c=>{i(c);try{await x9({options:Array.isArray(c.options)?c.options:[],divider:c.divider,multiplier:c.multiplier}),window.alert("CQI configuration saved.")}catch{window.alert("Failed to save CQI configuration.")}};return a.jsxs("div",{style:{padding:18},children:[a.jsx("h3",{style:{marginTop:0},children:"CQI Editor"}),a.jsx("div",{style:{color:"#6b7280",marginBottom:12},children:"Edit global CQI defaults for courses."}),a.jsx("div",{style:{display:"flex",gap:8},children:a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:()=>r(!0),disabled:s,children:s?"Loading":"Open CQI Editor"})}),a.jsx(Gre,{isOpen:t,onClose:()=>r(!1),onSave:l,currentSelection:n})]})}function Lc(e){return String(e??"").toLowerCase().replace(/[^a-z0-9]+/g,"").trim()}function Yre(){return{}}const Fm=["Technical magazine","Journal paper reading","Real time problems","Case study","Dipstick (Writing explanation content of CO)","Dipstick (Sketch Representation)","Real time Photography or Video Explanation","Course competition","Active Learing Exercies (Group Discussion)","Active Learing Exercies (Technical Question and answering Session)","Technical Role play","Interview Assessment","Active Projects","Journal Preparation"];function Xre(){var e;if(typeof window<"u"&&((e=window.location)!=null&&e.origin)){const t=String(window.location.hostname||"").trim().toLowerCase();return t==="localhost"||t==="127.0.0.1"?"http://localhost:8000":String(window.location.origin).replace(/\/+$/,"")}return"https://db.krgi.co.in"}const q0=Xre(),O2="obe_assessment_master_config_cache";async function H0(e,t){const r=e.headers.get("content-type")||"";try{if(r.includes("application/json")){const s=await e.json(),o=(s==null?void 0:s.detail)||(s==null?void 0:s.message);if(o)return`${t}: ${o}`}}catch{}if(e.status===401)return`${t}: Authentication required. Please login.`;if(e.status===403)return`${t}: Permission required.`;if(e.status===404)return`${t}: No CDAP found for this course yet. Upload the Excel to create one.`;let n="";try{n=await e.text()}catch{}const i=(n||"").trim();return i&&!i.startsWith("<")?`${t}: ${i}`:`${t}: Server returned ${e.status}.`}async function B9(e,t){const r=typeof t=="number"?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${q0}/api/obe/cdap-revision/${encodeURIComponent(e)}${r}`,i=await xr(n,{method:"GET"});if(!i.ok){const s=await H0(i,"CDAP revision fetch failed");throw new Error(s)}return i.json()}async function B4(e,t){const r=typeof t=="number"?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${q0}/api/obe/articulation-matrix/${encodeURIComponent(e)}${r}`,i=await xr(n,{method:"GET"});if(!i.ok){const s=await H0(i,"Articulation Matrix fetch failed");throw new Error(s)}return i.json()}async function I9(e){const t=(e==null?void 0:e.subjectId)||(e==null?void 0:e.subject_id);if(!t)throw new Error("subjectId is required to save CDAP revision");const r=e==null?void 0:e.teaching_assignment_id,n=typeof r=="number"?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${q0}/api/obe/cdap-revision/${encodeURIComponent(t)}${n}`,s=await xr(i,{method:"PUT",body:JSON.stringify(e)});if(!s.ok){const o=await H0(s,"CDAP revision save failed");throw new Error(o)}return s.json()}async function N3(){const e=`${q0}/api/obe/active-learning-mapping`,t=await xr(e,{method:"GET"});if(!t.ok){try{const i=window.localStorage.getItem(O2);if(i){const s=JSON.parse(i);if(s&&typeof s=="object")return s}}catch{}const n=await H0(t,"Active learning mapping fetch failed");throw new Error(n)}const r=await t.json();return(r==null?void 0:r.mapping)||{}}async function D9(e){const t=`${q0}/api/obe/active-learning-mapping`,r=await xr(t,{method:"PUT",body:JSON.stringify({mapping:e})});if(!r.ok){const i=await H0(r,"Active learning mapping save failed");throw new Error(i)}const n=await r.json();return(n==null?void 0:n.mapping)||{}}async function ku(){const e=`${q0}/api/obe/assessment-master-config`,t=await xr(e,{method:"GET"});if(!t.ok){try{const s=window.localStorage.getItem(O2);if(s){const o=JSON.parse(s);if(o&&typeof o=="object")return o}}catch{}const i=await H0(t,"Assessment master config fetch failed");throw new Error(i)}const r=await t.json(),n=(r==null?void 0:r.config)||{};try{window.localStorage.setItem(O2,JSON.stringify(n))}catch{}return n}async function Qre(e){const t=`${q0}/api/obe/assessment-master-config`,r=await xr(t,{method:"PUT",body:JSON.stringify({config:e})});if(!r.ok){const s=await H0(r,"Assessment master config save failed");throw new Error(s)}const n=await r.json(),i=(n==null?void 0:n.config)||{};try{window.localStorage.setItem(O2,JSON.stringify(i))}catch{}return i}function Jre(e,t=3e4){const r=window.setInterval(()=>e(),t);return()=>window.clearInterval(r)}const Lp=Array.from({length:11},(e,t)=>`PO${t+1}`);function Zre(){const e={};for(const t of Fm)e[Lc(t)]=Array(Lp.length).fill(!1);return e}function ene(){const[e,t]=x.useState(Zre),[r,n]=x.useState(!0),[i,s]=x.useState(!1),[o,l]=x.useState(null);x.useEffect(()=>{let d=!0;return n(!0),N3().then(f=>{d&&t(h=>{const p={...h};for(const m of Fm){const g=Lc(m),y=f==null?void 0:f[g];Array.isArray(y)&&y.length===Lp.length&&(p[g]=y)}return p})}).catch(()=>{}).finally(()=>{d&&n(!1)}),()=>{d=!1}},[]);function c(d,f){const h=Lc(d);t(p=>{const m=p[h]?[...p[h]]:Array(Lp.length).fill(!1);return m[f]=!m[f],{...p,[h]:m}}),l(null)}async function u(){s(!0),l(null);try{await D9(e),l(" Saved  changes are now active for all courses.")}catch(d){l(`Save failed: ${(d==null?void 0:d.message)||"Unknown error"}`)}finally{s(!1)}}return a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:6},children:[a.jsxs("div",{children:[a.jsx("h3",{style:{margin:0},children:"Active Learning  PO Mapping (Global)"}),a.jsxs("p",{style:{color:"#6b7280",marginTop:4,marginBottom:0,fontSize:13},children:["For each active-learning activity, tick which POs it contributes to. These settings apply to"," ",a.jsx("strong",{children:"all courses"})," immediately after saving."]})]}),a.jsx("button",{onClick:u,disabled:i||r,style:{padding:"8px 18px",borderRadius:8,background:i||r?"#d1fae5":"#10b981",color:"#fff",border:"none",fontWeight:700,cursor:i||r?"default":"pointer",whiteSpace:"nowrap"},children:i?"Saving":"Save Global Mapping"})]}),o&&a.jsx("div",{style:{marginBottom:10,padding:"8px 12px",borderRadius:6,background:o.startsWith("")?"#ecfdf5":"#fef2f2",color:o.startsWith("")?"#065f46":"#991b1b",fontSize:13},children:o}),r?a.jsx("div",{style:{color:"#6b7280",padding:16},children:"Loading global mapping"}):a.jsx("div",{style:{overflowX:"auto"},children:a.jsxs("table",{style:{borderCollapse:"collapse",fontSize:13,minWidth:700,width:"100%"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:"8px 10px",border:"1px solid #e5e7eb",minWidth:220},children:"Active Learning Activity"}),Lp.map(d=>a.jsx("th",{style:{padding:"6px 8px",border:"1px solid #e5e7eb",textAlign:"center",minWidth:46},children:d},d))]})}),a.jsx("tbody",{children:Fm.map((d,f)=>{const h=Lc(d),p=e[h]??Array(Lp.length).fill(!1);return a.jsxs("tr",{style:{background:f%2===0?"#fff":"#f9fafb"},children:[a.jsx("td",{style:{padding:"7px 10px",border:"1px solid #e5e7eb",fontWeight:500},children:d}),Lp.map((m,g)=>a.jsx("td",{style:{padding:"4px",border:"1px solid #e5e7eb",textAlign:"center"},children:a.jsx("input",{type:"checkbox",checked:!!p[g],onChange:()=>c(d,g),style:{cursor:"pointer",width:16,height:16}})},g))]},d)})})]})})]})}function tne(){const e=dl(),t=xo(),n=x.useMemo(()=>new URLSearchParams(e.search),[e.search]).get("tab")||"dashboard",[i,s]=x.useState(n);x.useEffect(()=>{const l=new URLSearchParams(e.search).get("tab");l&&l!==i&&s(l)},[e.search]);const o=[{key:"dashboard",label:"Dashboard"},{key:"weights",label:"Weights"},{key:"active_learning",label:"Active Learning Mapping"},{key:"due_dates",label:"OBE Due Dates"},{key:"courses",label:"Courses"},{key:"qp",label:"QP"},{key:"cqi",label:"CQI Editor"}];return a.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[a.jsxs("div",{style:{marginBottom:12},children:[a.jsx("h2",{style:{margin:0,fontSize:20},children:"Academic Controller"}),a.jsx("div",{style:{color:"#6b7280",marginTop:6},children:"IQAC tools for OBE oversight."})]}),a.jsx("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:18,flexWrap:"wrap"},children:o.map(l=>a.jsx("button",{onClick:()=>{s(l.key),t(`/iqac/academic-controller?tab=${encodeURIComponent(l.key)}`)},style:{padding:"8px 12px",borderRadius:8,border:i===l.key?"1px solid #10b981":"1px solid #e5e7eb",background:i===l.key?"#ecfdf5":"#fff",fontWeight:700,cursor:"pointer"},children:l.label},l.key))}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[i==="dashboard"&&a.jsx("div",{style:{color:"#6b7280"},children:"Dashboard coming soon."}),i==="weights"&&a.jsx(Vre,{}),i==="active_learning"&&a.jsx(ene,{}),i==="due_dates"&&a.jsx(k3,{}),i==="courses"&&a.jsx(Dre,{}),i==="qp"&&a.jsx($re,{}),i==="cqi"&&a.jsx(Kre,{})]})]})}const rne="https://db.krgi.co.in",nne=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":rne;async function M2(e){const t=encodeURIComponent(String(e||"").trim()),r=await xr(`${nne}/api/academics/iqac/course-teaching/${t}/`);if(!r.ok)throw new Error("Failed to fetch course teaching map");const n=await r.json();if(Array.isArray(n))return n;const i=n==null?void 0:n.results;return Array.isArray(i)?i:[]}function ine(){var m;const{courseCode:e}=z0(),t=xo(),r=x.useMemo(()=>decodeURIComponent(String(e||"")).trim(),[e]),[n,i]=x.useState([]),[s,o]=x.useState(null),[l,c]=x.useState(!0),[u,d]=x.useState(null);x.useEffect(()=>{let g=!0;return(async()=>{if(r)try{const[y,b]=await Promise.all([M2(r),Sl()]);if(!g)return;i(Array.isArray(y)?y:[]),o(Array.isArray(b)?b:[]),d(null)}catch(y){if(!g)return;i([]),d((y==null?void 0:y.message)||"Failed to load course mapping")}finally{g&&c(!1)}})(),()=>{g=!1}},[r]);const f=((m=n[0])==null?void 0:m.course_name)||r,h=x.useMemo(()=>{const g=new Map;for(const b of n||[]){const v=String((b==null?void 0:b.section_name)||"").trim()||"Section",w=b!=null&&b.academic_year?String(b.academic_year):null,S=`${v}__${w||""}`,k=g.get(S);k?k.items.push(b):g.set(S,{section_name:v,academic_year:w,items:[b]})}const y=Array.from(g.values());y.sort((b,v)=>{const w=b.section_name.localeCompare(v.section_name);return w!==0?w:String(b.academic_year||"").localeCompare(String(v.academic_year||""))});for(const b of y)b.items.sort((v,w)=>{var j,A,L,P;const S=String(((j=v.staff)==null?void 0:j.name)||((A=v.staff)==null?void 0:A.username)||"").trim(),k=String(((L=w.staff)==null?void 0:L.name)||((P=w.staff)==null?void 0:P.username)||"").trim();return S.localeCompare(k)});return y},[n]);async function p(g){if(!g||!window.confirm("Resetting this course will delete all entered exam data for this teaching assignment. This cannot be undone. Proceed?"))return;const b=["ssa1","review1","ssa2","review2","cia1","cia2","formative1","formative2","model"];try{for(const w of b)try{await w3(w,r,g)}catch(S){console.warn("reset assessment failed",w,S)}c(!0);const v=await M2(r);i(Array.isArray(v)?v:[]),d(null),window.alert("Reset completed.")}catch(v){window.alert("Reset failed: "+((v==null?void 0:v.message)||String(v)))}finally{c(!1)}}return a.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",gap:12,flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{children:[a.jsx("h2",{style:{margin:0,fontSize:20},children:r}),a.jsx("div",{style:{color:"#374151",marginTop:6,fontWeight:800},children:f}),a.jsx("div",{style:{color:"#6b7280",marginTop:4},children:"Sections and staff mapping."})]}),a.jsxs("div",{style:{display:"flex",gap:8},children:[a.jsx(es,{className:"obe-btn obe-btn-secondary",to:"/iqac/academic-controller?tab=courses",children:"Back"}),a.jsx("button",{className:"obe-btn",onClick:()=>t(`/obe/course/${encodeURIComponent(r)}`),children:"Open OBE (faculty view)"})]})]}),l?a.jsx("div",{style:{color:"#6b7280"},children:"Loading"}):null,u?a.jsx("div",{style:{color:"#b91c1c"},children:u}):null,!l&&!u&&n.length===0?a.jsx("div",{style:{color:"#6b7280"},children:"No active teaching assignments found for this course."}):null,!l&&!u&&n.length>0?a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:h.map(g=>a.jsxs("div",{className:"obe-card",style:{display:"flex",flexDirection:"column",gap:10},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",alignItems:"baseline"},children:[a.jsx("div",{style:{fontWeight:900,color:"#0f172a"},children:g.section_name}),a.jsx("div",{style:{color:"#6b7280",fontSize:13},children:g.academic_year||""})]}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:10},children:g.items.map(y=>{var b,v;return a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:10,background:"#fff",display:"flex",flexDirection:"column",gap:8},children:[a.jsx("div",{style:{color:"#111827",fontWeight:800},children:((b=y.staff)==null?void 0:b.name)||((v=y.staff)==null?void 0:v.username)||""}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[y.section_name?`Section: ${y.section_name}`:"",y.academic_year?`    AY: ${y.academic_year}`:"",(()=>{var S,k;const w=(s||[]).find(j=>String((j==null?void 0:j.course_code)||"").trim().toUpperCase()===r.toUpperCase());return w?`    Dept: ${((S=w.department)==null?void 0:S.name)||((k=w.department)==null?void 0:k.code)||""}    Sem: ${w.semester||""}`:""})()]}),a.jsxs("div",{style:{marginTop:2,display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:()=>t(`/iqac/academic-controller/course/${encodeURIComponent(r)}/marks/${encodeURIComponent(String(y.teaching_assignment_id))}`),children:"Open Mark Entry"}),a.jsx("button",{className:"obe-btn",onClick:()=>t(`/iqac/academic-controller/course/${encodeURIComponent(r)}/obe/${encodeURIComponent(String(y.teaching_assignment_id))}/marks`),children:"Open OBE (view-only)"}),a.jsx("button",{className:"obe-btn",onClick:()=>p(Number(y.teaching_assignment_id)),children:"Reset Course"})]})]},String(y.teaching_assignment_id))})})]},`${g.section_name}__${g.academic_year||""}`))}):null]})}async function Vc(e){const t=`/api/academics/teaching-assignments/${encodeURIComponent(String(e))}/students/`,r=(i,s=800)=>{const o=String(i||""),u=o.replace(/<script[\s\S]*?<\/script>/gi," ").replace(/<style[\s\S]*?<\/style>/gi," ").replace(/<[^>]+>/g," ").replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&quot;/gi,'"').replace(/&#39;/gi,"'").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/\s+/g," ").trim()||o.replace(/\s+/g," ").trim();return u.length<=s?u:u.slice(0,s)+" (truncated)"},n=await xr(t,{method:"GET"});if(!n.ok){const i=await n.text();throw new Error(`Roster fetch failed: ${n.status}
${r(i)}`)}return n.json()}function ane(e,t){if(!e)return null;const r=new Date(e).getTime();if(!Number.isFinite(r))return null;const n=t?new Date(t).getTime():Date.now();return Number.isFinite(n)?Math.floor((r-n)/1e3):null}function ng(e){if(e==null)return"";const t=Math.max(0,Math.floor(e)),r=Math.floor(t/3600),n=Math.floor(t%3600/60),i=t%60;return r>0?`${r}h ${String(n).padStart(2,"0")}m`:`${n}m ${String(i).padStart(2,"0")}s`}function V0(e){const{assessment:t,subjectCode:r,teachingAssignmentId:n,options:i}=e,[s,o]=x.useState(null),[l,c]=x.useState(!1),[u,d]=x.useState(null),[f,h]=x.useState(null),p=x.useMemo(()=>`${t}|${r}|${n||""}`,[t,r,n]),m=async y=>{if(!t||!r)return;const b=!!(y!=null&&y.silent);b||c(!0),b||d(null);try{const v=await S3(t,r,n);o(v);const w=v.remaining_seconds??ane(v.due_at,v.now);h(w)}catch(v){d((v==null?void 0:v.message)||"Failed to check publish window")}finally{b||c(!1)}};x.useEffect(()=>{o(null),h(null),m()},[p]),x.useEffect(()=>{if((i==null?void 0:i.poll)===!1)return;const y=window.setInterval(()=>{m({silent:!0})},3e4);return()=>window.clearInterval(y)},[p,i==null?void 0:i.poll]),x.useEffect(()=>{if(f==null||f<=0)return;const y=window.setInterval(()=>{h(b=>b==null?b:b<=0?0:b-1)},1e3);return()=>window.clearInterval(y)},[f]);const g=(s==null?void 0:s.publish_allowed)??!0;return{data:s,loading:l,error:u,remainingSeconds:f,publishAllowed:g,refresh:m}}function oc(e){const{assessment:t,subjectCode:r,scope:n,teachingAssignmentId:i,options:s}=e,[o,l]=x.useState(null),[c,u]=x.useState(!1),[d,f]=x.useState(null),h=x.useMemo(()=>`${t}|${r}|${n}|${i||""}`,[t,r,n,i]),p=async m=>{if(!t||!r||!n)return;const g=!!(m!=null&&m.silent);g||u(!0),g||f(null);try{const y=await o1(t,r,n,i);l(y)}catch(y){f((y==null?void 0:y.message)||"Failed to check edit window")}finally{g||u(!1)}};return x.useEffect(()=>{l(null),p()},[h]),x.useEffect(()=>{if((s==null?void 0:s.poll)===!1)return;const m=window.setInterval(()=>{p({silent:!0})},3e4);return()=>window.clearInterval(m)},[h,s==null?void 0:s.poll]),{data:o,loading:c,error:d,refresh:p}}function G0(e){const{assessment:t,subjectCode:r,teachingAssignmentId:n,options:i}=e,[s,o]=x.useState(null),[l,c]=x.useState(!1),[u,d]=x.useState(null),f=x.useMemo(()=>`${t}|${r}|${n||""}`,[t,r,n]),h=async p=>{if(!t||!r)return;const m=!!(p!=null&&p.silent);m||c(!0),m||d(null);try{const g=await yS(t,r,n);o(g)}catch(g){d((g==null?void 0:g.message)||"Failed to load lock status")}finally{m||c(!1)}};return x.useEffect(()=>{o(null),h()},[f]),x.useEffect(()=>{if((i==null?void 0:i.poll)===!1)return;const p=window.setInterval(()=>{h({silent:!0})},3e4);return()=>window.clearInterval(p)},[f,i==null?void 0:i.poll]),{data:s,loading:l,error:u,refresh:h}}const sne=24*60*60*1e3;function one(e){if(!e||String(e.status||"").toUpperCase()!=="PENDING"||!e.is_active)return null;const r=e.requested_at?new Date(String(e.requested_at)).getTime():0;if(!r||!Number.isFinite(r))return null;const n=r+sne;return Number.isFinite(n)?n:null}function K0(e){const{enabled:t,assessment:r,subjectCode:n,scope:i,teachingAssignmentId:s}=e,[o,l]=x.useState(null),[c,u]=x.useState(null),[d,f]=x.useState(!1),h=x.useMemo(()=>c?c>Date.now():!1,[c]),p=async m=>{if(!t||!r||!n||!i)return;const g=!!(m!=null&&m.silent);g||f(!0);try{const y=await Lm({assessment:r,subject_code:String(n),scope:i,teaching_assignment_id:s}),b=(y==null?void 0:y.result)??null;l(b),u(one(b))}catch{l(null),u(null)}finally{g||f(!1)}};return x.useEffect(()=>{if(!t){l(null),u(null);return}p({silent:!0});const m=window.setInterval(()=>{p({silent:!0})},6e4);return()=>window.clearInterval(m)},[t,r,n,i,s]),{latest:o,pending:h,pendingUntilMs:c,loading:d,refresh:p,setPendingUntilMs:u}}function Y0(e){x.useEffect(()=>{if(!e||typeof document>"u")return;const t=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=t}},[e])}function lne({size:e=22}){return a.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,focusable:"false",children:[a.jsx("path",{d:"M7 10V8a5 5 0 0 1 10 0v2",stroke:"#111827",strokeWidth:"1.8",strokeLinecap:"round"}),a.jsx("path",{d:"M6.5 10h11A2.5 2.5 0 0 1 20 12.5v6A2.5 2.5 0 0 1 17.5 21h-11A2.5 2.5 0 0 1 4 18.5v-6A2.5 2.5 0 0 1 6.5 10Z",fill:"#F3F4F6",stroke:"#111827",strokeWidth:"1.2"}),a.jsx("path",{d:"M12 14.2v2.6",stroke:"#111827",strokeWidth:"1.8",strokeLinecap:"round"})]})}function ig({locked:e,title:t,subtitle:r,children:n}){return e?a.jsxs("div",{style:{position:"relative"},children:[a.jsx("div",{style:{position:"sticky",top:0,left:0,right:0,zIndex:10,marginBottom:12},children:a.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center",background:"#ffffff",border:"2px solid #fde68a",borderRadius:12,padding:"12px 16px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)"},children:[a.jsx("div",{style:{width:36,height:36,borderRadius:999,display:"grid",placeItems:"center",background:"#fef3c7",border:"1px solid #fde68a",flex:"0 0 auto"},children:a.jsx(lne,{size:20})}),a.jsxs("div",{style:{minWidth:0,flex:1},children:[a.jsx("div",{style:{fontWeight:800,color:"#111827",fontSize:14},children:t||"Locked by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:2},children:r||"Publishing is turned OFF globally for this assessment."})]})]})}),a.jsx("div",{style:{filter:"brightness(0.97)",pointerEvents:"none",userSelect:"none"},children:n})]}):a.jsx(a.Fragment,{children:n})}function ag({children:e}){const t={minHeight:"100vh",background:"linear-gradient(180deg, #f0f9ff 0%, #ffffff 65%)",padding:"18px 14px"},r={maxWidth:1400,margin:"0 auto"},n={border:"1px solid rgba(15,23,42,0.08)",borderRadius:16,background:"rgba(255,255,255,0.88)",boxShadow:"0 12px 30px rgba(15,23,42,0.08)",padding:16,backdropFilter:"blur(10px)",overflowX:"auto",minWidth:0};return a.jsx("div",{style:t,children:a.jsx("div",{style:{...r,...n},children:e})})}function xs(e){return typeof document>"u"?a.jsx(a.Fragment,{children:e.children}):K1.createPortal(a.jsx(a.Fragment,{children:e.children}),document.body)}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var L2={};L2.version="0.18.5";var $9=1252,cne=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],C3={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},E3=function(e){cne.indexOf(e)!=-1&&($9=C3[0]=e)};function une(){E3(1252)}var fu=function(e){E3(e)};function T3(){fu(1200),une()}function tP(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function dne(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function U9(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var dx=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?dne(e.slice(2)):t==254&&r==255?U9(e.slice(2)):t==65279?e.slice(1):e},wb=function(t){return String.fromCharCode(t)},rP=function(t){return String.fromCharCode(t)},l1,Vf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function c1(e){for(var t="",r=0,n=0,i=0,s=0,o=0,l=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),s=r>>2,n=e.charCodeAt(u++),o=(r&3)<<4|n>>4,i=e.charCodeAt(u++),l=(n&15)<<2|i>>6,c=i&63,isNaN(n)?l=c=64:isNaN(i)&&(c=64),t+=Vf.charAt(s)+Vf.charAt(o)+Vf.charAt(l)+Vf.charAt(c);return t}function lc(e){var t="",r=0,n=0,i=0,s=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=Vf.indexOf(e.charAt(u++)),o=Vf.indexOf(e.charAt(u++)),r=s<<2|o>>4,t+=String.fromCharCode(r),l=Vf.indexOf(e.charAt(u++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=Vf.indexOf(e.charAt(u++)),i=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(i));return t}var mi=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),cf=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function fh(e){return mi?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function nP(e){return mi?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ql=function(t){return mi?cf(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function jS(e){if(typeof ArrayBuffer>"u")return Ql(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function kh(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function fne(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function P3(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return P3(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Vs=mi?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:cf(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function hne(e){for(var t=[],r=0,n=e.length+250,i=fh(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++s)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|l>>6&15|(o&3)<<4,i[r++]=128|l&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(t.push(i.slice(0,r)),r=0,i=fh(65535),n=65530)}return t.push(i.slice(0,r)),Vs(t)}var nl=/\u0000/g,fx=/[\u0001-\u0006]/g;function pm(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function hu(e,t){var r=""+e;return r.length>=t?r:qa("0",t-r.length)+r}function O3(e,t){var r=""+e;return r.length>=t?r:qa(" ",t-r.length)+r}function R2(e,t){var r=""+e;return r.length>=t?r:r+qa(" ",t-r.length)}function pne(e,t){var r=""+Math.round(e);return r.length>=t?r:qa("0",t-r.length)+r}function mne(e,t){var r=""+e;return r.length>=t?r:qa("0",t-r.length)+r}var iP=Math.pow(2,32);function pp(e,t){if(e>iP||e<-iP)return pne(e,t);var r=Math.round(e);return mne(r,t)}function F2(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var aP=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],X5=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function gne(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Gn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},sP={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},xne={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function B2(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,o=1,l=0,c=1,u=0,d=0,f=Math.floor(i);u<t&&(f=Math.floor(i),l=f*o+s,d=f*u+c,!(i-f<5e-8));)i=1/(i-f),s=o,o=l,c=u,u=d;if(d>t&&(u>t?(d=c,l=s):(d=u,l=o)),!r)return[0,n*l,d];var h=Math.floor(n*l/d);return[h,n*l-h*d,d]}function Yh(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,o=[],l={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++i==86400&&(l.T=i=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=_ne(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=i%60,i=Math.floor(i/60),l.M=i%60,i=Math.floor(i/60),l.H=i,l.q=s,l}var z9=new Date(1899,11,31,0,0,0),yne=z9.getTime(),bne=new Date(1900,2,1,0,0,0);function W9(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=bne&&(r+=24*60*60*1e3),(r-(yne+(e.getTimezoneOffset()-z9.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function M3(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function vne(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function wne(e){var t=e<0?12:11,r=M3(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Sne(e){var t=M3(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function u1(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=wne(e):t===10?r=e.toFixed(10).substr(0,12):r=Sne(e),M3(vne(r.toUpperCase()))}function S0(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):u1(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Uc(14,W9(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function _ne(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function kne(e,t,r,n){var i="",s=0,o=0,l=r.y,c,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return X5[r.m-1][1];case 5:return X5[r.m-1][0];default:return X5[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return aP[r.q][0];default:return aP[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?hu(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),t==="s"?s===0?"0":""+s/o:(i=hu(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?hu(c,u):"";return d}function Gf(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var q9=/%/g;function jne(e,t,r){var n=t.replace(q9,""),i=t.length-n.length;return Dd(e,n,r*Math.pow(10,2*i))+qa("%",i)}function Ane(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Dd(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function H9(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+H9(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var V9=/# (\?+)( ?)\/( ?)(\d+)/;function Nne(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),o=i-s*n,l=n;return r+(s===0?"":""+s)+" "+(o===0?qa(" ",e[1].length+1+e[4].length):O3(o,e[1].length)+e[2]+"/"+e[3]+hu(l,e[4].length))}function Cne(e,t,r){return r+(t===0?"":""+t)+qa(" ",e[1].length+2+e[4].length)}var G9=/^#*0*\.([0#]+)/,K9=/\).*[0#]/,Y9=/\(###\) ###\\?-####/;function Qo(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function oP(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function lP(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Ene(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Tne(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function kc(e,t,r){if(e.charCodeAt(0)===40&&!t.match(K9)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?kc("n",n,r):"("+kc("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Ane(e,t,r);if(t.indexOf("%")!==-1)return jne(e,t,r);if(t.indexOf("E")!==-1)return H9(t,r);if(t.charCodeAt(0)===36)return"$"+kc(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+pp(c,t.length);if(t.match(/^[#?]+$/))return i=pp(r,0),i==="0"&&(i=""),i.length>t.length?i:Qo(t.substr(0,t.length-i.length))+i;if(s=t.match(V9))return Nne(s,c,u);if(t.match(/^#+0+$/))return u+pp(c,t.length-t.indexOf("0"));if(s=t.match(G9))return i=oP(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Qo(s[1])).replace(/\.$/,"."+Qo(s[1])).replace(/\.(\d*)$/,function(m,g){return"."+g+qa("0",Qo(s[1]).length-g.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+oP(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+Gf(pp(c,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+kc(e,t,-r):Gf(""+(Math.floor(r)+Ene(r,s[1].length)))+"."+hu(lP(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return kc(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=pm(kc(e,t.replace(/[\\-]/g,""),r)),o=0,pm(pm(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<i.length?i.charAt(o++):m==="0"?"0":""}));if(t.match(Y9))return i=kc(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=B2(c,Math.pow(10,o)-1,!1),i=""+u,d=Dd("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=R2(l[2],o),d.length<s[4].length&&(d=Qo(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=B2(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?O3(l[1],o)+s[2]+"/"+s[3]+R2(l[2],o):qa(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=pp(r,0),t.length<=i.length?i:Qo(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var f=t.indexOf(".")-o,h=t.length-i.length-f;return Qo(t.substr(0,f)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=lP(r,s[1].length),r<0?"-"+kc(e,t,-r):Gf(Tne(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?hu(0,3-m.length):"")+m})+"."+hu(o,s[1].length);switch(t){case"###,##0.00":return kc(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Gf(pp(c,0));return p!=="0"?u+p:"";case"###,###.00":return kc(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return kc(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Pne(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Dd(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function One(e,t,r){var n=t.replace(q9,""),i=t.length-n.length;return Dd(e,n,r*Math.pow(10,2*i))+qa("%",i)}function X9(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+X9(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function $u(e,t,r){if(e.charCodeAt(0)===40&&!t.match(K9)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?$u("n",n,r):"("+$u("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Pne(e,t,r);if(t.indexOf("%")!==-1)return One(e,t,r);if(t.indexOf("E")!==-1)return X9(t,r);if(t.charCodeAt(0)===36)return"$"+$u(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+hu(c,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:Qo(t.substr(0,t.length-i.length))+i;if(s=t.match(V9))return Cne(s,c,u);if(t.match(/^#+0+$/))return u+hu(c,t.length-t.indexOf("0"));if(s=t.match(G9))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Qo(s[1])).replace(/\.$/,"."+Qo(s[1])),i=i.replace(/\.(\d*)$/,function(m,g){return"."+g+qa("0",Qo(s[1]).length-g.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+Gf(""+c);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+$u(e,t,-r):Gf(""+r)+"."+qa("0",s[1].length);if(s=t.match(/^#,#*,#0/))return $u(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=pm($u(e,t.replace(/[\\-]/g,""),r)),o=0,pm(pm(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<i.length?i.charAt(o++):m==="0"?"0":""}));if(t.match(Y9))return i=$u(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=B2(c,Math.pow(10,o)-1,!1),i=""+u,d=Dd("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=R2(l[2],o),d.length<s[4].length&&(d=Qo(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=B2(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?O3(l[1],o)+s[2]+"/"+s[3]+R2(l[2],o):qa(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:Qo(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var f=t.indexOf(".")-o,h=t.length-i.length-f;return Qo(t.substr(0,f)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+$u(e,t,-r):Gf(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?hu(0,3-m.length):"")+m})+"."+hu(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Gf(""+c);return p!=="0"?u+p:"";default:if(t.match(/\.[0#?]*$/))return $u(e,t.slice(0,t.lastIndexOf(".")),r)+Qo(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Dd(e,t,r){return(r|0)===r?$u(e,t,r):kc(e,t,r)}function Mne(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Q9=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function sg(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":F2(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Q9))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Lne(e,t,r,n){for(var i=[],s="",o=0,l="",c="t",u,d,f,h="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!F2(e,o))throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(f=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++o;break;case"\\":var p=e.charAt(++o),m=p==="("||p===")"?p:"t";i[i.length]={t:m,v:p},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=Yh(t,r,e.charAt(o+1)==="2"),u==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Yh(t,r),u==null))return"";for(s=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)s+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=h),i[i.length]={t:l,v:s},c=l;break;case"A":case"a":case"":var g={t:l,v:l};if(u==null&&(u=Yh(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",h="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",o+=5,h="h"):e.substr(o,5).toUpperCase()==="/"?(u!=null&&(g.v=u.H>=12?"":""),g.t="T",o+=5,h="h"):(g.t="t",++o),u==null&&g.t==="T")return"";i[i.length]=g,c=l;break;case"[":for(s=l;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Q9)){if(u==null&&(u=Yh(t,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",sg(e)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=l;++o<e.length&&(l=e.charAt(o))==="0";)s+=l;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)s+=l;i[i.length]={t:"n",v:s};break;case"?":for(s=l;e.charAt(++o)===l;)s+=l;i[i.length]={t:l,v:s},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:l,v:l},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"t",v:l},++o;break}var y=0,b=0,v;for(o=i.length-1,c="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=h,c="h",y<1&&(y=1);break;case"s":(v=i[o].v.match(/\.0+$/))&&(b=Math.max(b,v[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":c=i[o].t;break;case"m":c==="s"&&(i[o].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&i[o].v.match(/[Hh]/)&&(y=1),y<2&&i[o].v.match(/[Mm]/)&&(y=2),y<3&&i[o].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var w="",S;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=kne(i[o].t.charCodeAt(0),i[o].v,u,b),i[o].t="t";break;case"n":case"?":for(S=o+1;i[S]!=null&&((l=i[S].t)==="?"||l==="D"||(l===" "||l==="t")&&i[S+1]!=null&&(i[S+1].t==="?"||i[S+1].t==="t"&&i[S+1].v==="/")||i[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(i[S].v==="/"||i[S].v===" "&&i[S+1]!=null&&i[S+1].t=="?"));)i[o].v+=i[S].v,i[S]={v:"",t:";"},++S;w+=i[o].v,o=S-1;break;case"G":i[o].t="t",i[o].v=S0(t,r);break}var k="",j,A;if(w.length>0){w.charCodeAt(0)==40?(j=t<0&&w.charCodeAt(0)===45?-t:t,A=Dd("n",w,j)):(j=t<0&&n>1?-t:t,A=Dd("n",w,j),j<0&&i[0]&&i[0].t=="t"&&(A=A.substr(1),i[0].v="-"+i[0].v)),S=A.length-1;var L=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){L=o;break}var P=i.length;if(L===i.length&&A.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(S>=i[o].v.length-1?(S-=i[o].v.length,i[o].v=A.substr(S+1,i[o].v.length)):S<0?i[o].v="":(i[o].v=A.substr(0,S+1),S=-1),i[o].t="t",P=o);S>=0&&P<i.length&&(i[P].v=A.substr(0,S+1)+i[P].v)}else if(L!==i.length&&A.indexOf("E")===-1){for(S=A.indexOf(".")-1,o=L;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(d=i[o].v.indexOf(".")>-1&&o===L?i[o].v.indexOf(".")-1:i[o].v.length-1,k=i[o].v.substr(d+1);d>=0;--d)S>=0&&(i[o].v.charAt(d)==="0"||i[o].v.charAt(d)==="#")&&(k=A.charAt(S--)+k);i[o].v=k,i[o].t="t",P=o}for(S>=0&&P<i.length&&(i[P].v=A.substr(0,S+1)+i[P].v),S=A.indexOf(".")+1,o=L;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==L)){for(d=i[o].v.indexOf(".")>-1&&o===L?i[o].v.indexOf(".")+1:0,k=i[o].v.substr(0,d);d<i[o].v.length;++d)S<A.length&&(k+=A.charAt(S++));i[o].v=k,i[o].t="t",P=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(j=n>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=Dd(i[o].t,i[o].v,j),i[o].t="t");var F="";for(o=0;o!==i.length;++o)i[o]!=null&&(F+=i[o].v);return F}var cP=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function uP(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Rne(e,t){var r=Mne(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(cP),l=r[1].match(cP);return uP(t,o)?[n,r[0]]:uP(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,s]}function Uc(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Gn)[e],n==null&&(n=r.table&&r.table[sP[e]]||Gn[sP[e]]),n==null&&(n=xne[e]||"General");break}if(F2(n,0))return S0(t,r);t instanceof Date&&(t=W9(t,r.date1904));var i=Rne(n,t);if(F2(i[1]))return S0(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Lne(i[1],t,r,i[0])}function $d(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Gn[r]==null){t<0&&(t=r);continue}if(Gn[r]==e){t=r;break}}t<0&&(t=391)}return Gn[t]=e,t}function AS(e){for(var t=0;t!=392;++t)e[t]!==void 0&&$d(e[t],t)}function og(){Gn=gne()}var Fne={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},J9=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Bne(e){var t=typeof e=="number"?Gn[e]:e;return t=t.replace(J9,"(\\d+)"),new RegExp("^"+t+"$")}function Ine(e,t,r){var n=-1,i=-1,s=-1,o=-1,l=-1,c=-1;(t.match(J9)||[]).forEach(function(f,h){var p=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=p;break;case"d":s=p;break;case"h":o=p;break;case"s":c=p;break;case"m":o>=0?l=p:i=p;break}}),c>=0&&l==-1&&i>=0&&(l=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?u:n==-1&&i==-1&&s==-1?d:u+"T"+d}var Dne=function(){var e={};e.version="1.2.0";function t(){for(var A=0,L=new Array(256),P=0;P!=256;++P)A=P,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,L[P]=A;return typeof Int32Array<"u"?new Int32Array(L):L}var r=t();function n(A){var L=0,P=0,F=0,E=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(F=0;F!=256;++F)E[F]=A[F];for(F=0;F!=256;++F)for(P=A[F],L=256+F;L<4096;L+=256)P=E[L]=P>>>8^A[P&255];var T=[];for(F=1;F!=16;++F)T[F-1]=typeof Int32Array<"u"?E.subarray(F*256,F*256+256):E.slice(F*256,F*256+256);return T}var i=n(r),s=i[0],o=i[1],l=i[2],c=i[3],u=i[4],d=i[5],f=i[6],h=i[7],p=i[8],m=i[9],g=i[10],y=i[11],b=i[12],v=i[13],w=i[14];function S(A,L){for(var P=L^-1,F=0,E=A.length;F<E;)P=P>>>8^r[(P^A.charCodeAt(F++))&255];return~P}function k(A,L){for(var P=L^-1,F=A.length-15,E=0;E<F;)P=w[A[E++]^P&255]^v[A[E++]^P>>8&255]^b[A[E++]^P>>16&255]^y[A[E++]^P>>>24]^g[A[E++]]^m[A[E++]]^p[A[E++]]^h[A[E++]]^f[A[E++]]^d[A[E++]]^u[A[E++]]^c[A[E++]]^l[A[E++]]^o[A[E++]]^s[A[E++]]^r[A[E++]];for(F+=15;E<F;)P=P>>>8^r[(P^A[E++])&255];return~P}function j(A,L){for(var P=L^-1,F=0,E=A.length,T=0,B=0;F<E;)T=A.charCodeAt(F++),T<128?P=P>>>8^r[(P^T)&255]:T<2048?(P=P>>>8^r[(P^(192|T>>6&31))&255],P=P>>>8^r[(P^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,B=A.charCodeAt(F++)&1023,P=P>>>8^r[(P^(240|T>>8&7))&255],P=P>>>8^r[(P^(128|T>>2&63))&255],P=P>>>8^r[(P^(128|B>>6&15|(T&3)<<4))&255],P=P>>>8^r[(P^(128|B&63))&255]):(P=P>>>8^r[(P^(224|T>>12&15))&255],P=P>>>8^r[(P^(128|T>>6&63))&255],P=P>>>8^r[(P^(128|T&63))&255]);return~P}return e.table=r,e.bstr=S,e.buf=k,e.str=j,e}(),Wn=function(){var t={};t.version="1.2.1";function r(re,le){for(var te=re.split("/"),ue=le.split("/"),Ne=0,ke=0,vt=Math.min(te.length,ue.length);Ne<vt;++Ne){if(ke=te[Ne].length-ue[Ne].length)return ke;if(te[Ne]!=ue[Ne])return te[Ne]<ue[Ne]?-1:1}return te.length-ue.length}function n(re){if(re.charAt(re.length-1)=="/")return re.slice(0,-1).indexOf("/")===-1?re:n(re.slice(0,-1));var le=re.lastIndexOf("/");return le===-1?re:re.slice(0,le+1)}function i(re){if(re.charAt(re.length-1)=="/")return i(re.slice(0,-1));var le=re.lastIndexOf("/");return le===-1?re:re.slice(le+1)}function s(re,le){typeof le=="string"&&(le=new Date(le));var te=le.getHours();te=te<<6|le.getMinutes(),te=te<<5|le.getSeconds()>>>1,re.write_shift(2,te);var ue=le.getFullYear()-1980;ue=ue<<4|le.getMonth()+1,ue=ue<<5|le.getDate(),re.write_shift(2,ue)}function o(re){var le=re.read_shift(2)&65535,te=re.read_shift(2)&65535,ue=new Date,Ne=te&31;te>>>=5;var ke=te&15;te>>>=4,ue.setMilliseconds(0),ue.setFullYear(te+1980),ue.setMonth(ke-1),ue.setDate(Ne);var vt=le&31;le>>>=5;var rt=le&63;return le>>>=6,ue.setHours(le),ue.setMinutes(rt),ue.setSeconds(vt<<1),ue}function l(re){fo(re,0);for(var le={},te=0;re.l<=re.length-4;){var ue=re.read_shift(2),Ne=re.read_shift(2),ke=re.l+Ne,vt={};switch(ue){case 21589:te=re.read_shift(1),te&1&&(vt.mtime=re.read_shift(4)),Ne>5&&(te&2&&(vt.atime=re.read_shift(4)),te&4&&(vt.ctime=re.read_shift(4))),vt.mtime&&(vt.mt=new Date(vt.mtime*1e3));break}re.l=ke,le[ue]=vt}return le}var c;function u(){return c||(c={})}function d(re,le){if(re[0]==80&&re[1]==75)return hr(re,le);if((re[0]|32)==109&&(re[1]|32)==105)return je(re,le);if(re.length<512)throw new Error("CFB file size "+re.length+" < 512");var te=3,ue=512,Ne=0,ke=0,vt=0,rt=0,De=0,We=[],st=re.slice(0,512);fo(st,0);var zt=f(st);switch(te=zt[0],te){case 3:ue=512;break;case 4:ue=4096;break;case 0:if(zt[1]==0)return hr(re,le);default:throw new Error("Major Version: Expected 3 or 4 saw "+te)}ue!==512&&(st=re.slice(0,ue),fo(st,28));var Wt=re.slice(0,ue);h(st,te);var xt=st.read_shift(4,"i");if(te===3&&xt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+xt);st.l+=4,vt=st.read_shift(4,"i"),st.l+=4,st.chk("00100000","Mini Stream Cutoff Size: "),rt=st.read_shift(4,"i"),Ne=st.read_shift(4,"i"),De=st.read_shift(4,"i"),ke=st.read_shift(4,"i");for(var Dt=-1,Vt=0;Vt<109&&(Dt=st.read_shift(4,"i"),!(Dt<0));++Vt)We[Vt]=Dt;var gr=p(re,ue);y(De,ke,gr,ue,We);var sr=v(gr,vt,We,ue);sr[vt].name="!Directory",Ne>0&&rt!==B&&(sr[rt].name="!MiniFAT"),sr[We[0]].name="!FAT",sr.fat_addrs=We,sr.ssz=ue;var Lr={},Zr=[],Er=[],qt=[];w(vt,sr,gr,Zr,Ne,Lr,Er,rt),m(Er,qt,Zr),Zr.shift();var zr={FileIndex:Er,FullPaths:qt};return le&&le.raw&&(zr.raw={header:Wt,sectors:gr}),zr}function f(re){if(re[re.l]==80&&re[re.l+1]==75)return[0,0];re.chk(q,"Header Signature: "),re.l+=16;var le=re.read_shift(2,"u");return[re.read_shift(2,"u"),le]}function h(re,le){var te=9;switch(re.l+=2,te=re.read_shift(2)){case 9:if(le!=3)throw new Error("Sector Shift: Expected 9 saw "+te);break;case 12:if(le!=4)throw new Error("Sector Shift: Expected 12 saw "+te);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+te)}re.chk("0600","Mini Sector Shift: "),re.chk("000000000000","Reserved: ")}function p(re,le){for(var te=Math.ceil(re.length/le)-1,ue=[],Ne=1;Ne<te;++Ne)ue[Ne-1]=re.slice(Ne*le,(Ne+1)*le);return ue[te-1]=re.slice(te*le),ue}function m(re,le,te){for(var ue=0,Ne=0,ke=0,vt=0,rt=0,De=te.length,We=[],st=[];ue<De;++ue)We[ue]=st[ue]=ue,le[ue]=te[ue];for(;rt<st.length;++rt)ue=st[rt],Ne=re[ue].L,ke=re[ue].R,vt=re[ue].C,We[ue]===ue&&(Ne!==-1&&We[Ne]!==Ne&&(We[ue]=We[Ne]),ke!==-1&&We[ke]!==ke&&(We[ue]=We[ke])),vt!==-1&&(We[vt]=ue),Ne!==-1&&ue!=We[ue]&&(We[Ne]=We[ue],st.lastIndexOf(Ne)<rt&&st.push(Ne)),ke!==-1&&ue!=We[ue]&&(We[ke]=We[ue],st.lastIndexOf(ke)<rt&&st.push(ke));for(ue=1;ue<De;++ue)We[ue]===ue&&(ke!==-1&&We[ke]!==ke?We[ue]=We[ke]:Ne!==-1&&We[Ne]!==Ne&&(We[ue]=We[Ne]));for(ue=1;ue<De;++ue)if(re[ue].type!==0){if(rt=ue,rt!=We[rt])do rt=We[rt],le[ue]=le[rt]+"/"+le[ue];while(rt!==0&&We[rt]!==-1&&rt!=We[rt]);We[ue]=-1}for(le[0]+="/",ue=1;ue<De;++ue)re[ue].type!==2&&(le[ue]+="/")}function g(re,le,te){for(var ue=re.start,Ne=re.size,ke=[],vt=ue;te&&Ne>0&&vt>=0;)ke.push(le.slice(vt*T,vt*T+T)),Ne-=T,vt=Wh(te,vt*4);return ke.length===0?wr(0):Vs(ke).slice(0,re.size)}function y(re,le,te,ue,Ne){var ke=B;if(re===B){if(le!==0)throw new Error("DIFAT chain shorter than expected")}else if(re!==-1){var vt=te[re],rt=(ue>>>2)-1;if(!vt)return;for(var De=0;De<rt&&(ke=Wh(vt,De*4))!==B;++De)Ne.push(ke);y(Wh(vt,ue-4),le-1,te,ue,Ne)}}function b(re,le,te,ue,Ne){var ke=[],vt=[];Ne||(Ne=[]);var rt=ue-1,De=0,We=0;for(De=le;De>=0;){Ne[De]=!0,ke[ke.length]=De,vt.push(re[De]);var st=te[Math.floor(De*4/ue)];if(We=De*4&rt,ue<4+We)throw new Error("FAT boundary crossed: "+De+" 4 "+ue);if(!re[st])break;De=Wh(re[st],We)}return{nodes:ke,data:SP([vt])}}function v(re,le,te,ue){var Ne=re.length,ke=[],vt=[],rt=[],De=[],We=ue-1,st=0,zt=0,Wt=0,xt=0;for(st=0;st<Ne;++st)if(rt=[],Wt=st+le,Wt>=Ne&&(Wt-=Ne),!vt[Wt]){De=[];var Dt=[];for(zt=Wt;zt>=0;){Dt[zt]=!0,vt[zt]=!0,rt[rt.length]=zt,De.push(re[zt]);var Vt=te[Math.floor(zt*4/ue)];if(xt=zt*4&We,ue<4+xt)throw new Error("FAT boundary crossed: "+zt+" 4 "+ue);if(!re[Vt]||(zt=Wh(re[Vt],xt),Dt[zt]))break}ke[Wt]={nodes:rt,data:SP([De])}}return ke}function w(re,le,te,ue,Ne,ke,vt,rt){for(var De=0,We=ue.length?2:0,st=le[re].data,zt=0,Wt=0,xt;zt<st.length;zt+=128){var Dt=st.slice(zt,zt+128);fo(Dt,64),Wt=Dt.read_shift(2),xt=$3(Dt,0,Wt-We),ue.push(xt);var Vt={name:xt,type:Dt.read_shift(1),color:Dt.read_shift(1),L:Dt.read_shift(4,"i"),R:Dt.read_shift(4,"i"),C:Dt.read_shift(4,"i"),clsid:Dt.read_shift(16),state:Dt.read_shift(4,"i"),start:0,size:0},gr=Dt.read_shift(2)+Dt.read_shift(2)+Dt.read_shift(2)+Dt.read_shift(2);gr!==0&&(Vt.ct=S(Dt,Dt.l-8));var sr=Dt.read_shift(2)+Dt.read_shift(2)+Dt.read_shift(2)+Dt.read_shift(2);sr!==0&&(Vt.mt=S(Dt,Dt.l-8)),Vt.start=Dt.read_shift(4,"i"),Vt.size=Dt.read_shift(4,"i"),Vt.size<0&&Vt.start<0&&(Vt.size=Vt.type=0,Vt.start=B,Vt.name=""),Vt.type===5?(De=Vt.start,Ne>0&&De!==B&&(le[De].name="!StreamData")):Vt.size>=4096?(Vt.storage="fat",le[Vt.start]===void 0&&(le[Vt.start]=b(te,Vt.start,le.fat_addrs,le.ssz)),le[Vt.start].name=Vt.name,Vt.content=le[Vt.start].data.slice(0,Vt.size)):(Vt.storage="minifat",Vt.size<0?Vt.size=0:De!==B&&Vt.start!==B&&le[De]&&(Vt.content=g(Vt,le[De].data,(le[rt]||{}).data))),Vt.content&&fo(Vt.content,0),ke[xt]=Vt,vt.push(Vt)}}function S(re,le){return new Date((Xl(re,le+4)/1e7*Math.pow(2,32)+Xl(re,le)/1e7-11644473600)*1e3)}function k(re,le){return u(),d(c.readFileSync(re),le)}function j(re,le){var te=le&&le.type;switch(te||mi&&Buffer.isBuffer(re)&&(te="buffer"),te||"base64"){case"file":return k(re,le);case"base64":return d(Ql(lc(re)),le);case"binary":return d(Ql(re),le)}return d(re,le)}function A(re,le){var te=le||{},ue=te.root||"Root Entry";if(re.FullPaths||(re.FullPaths=[]),re.FileIndex||(re.FileIndex=[]),re.FullPaths.length!==re.FileIndex.length)throw new Error("inconsistent CFB structure");re.FullPaths.length===0&&(re.FullPaths[0]=ue+"/",re.FileIndex[0]={name:ue,type:5}),te.CLSID&&(re.FileIndex[0].clsid=te.CLSID),L(re)}function L(re){var le="Sh33tJ5";if(!Wn.find(re,"/"+le)){var te=wr(4);te[0]=55,te[1]=te[3]=50,te[2]=54,re.FileIndex.push({name:le,type:2,content:te,size:4,L:69,R:69,C:69}),re.FullPaths.push(re.FullPaths[0]+le),P(re)}}function P(re,le){A(re);for(var te=!1,ue=!1,Ne=re.FullPaths.length-1;Ne>=0;--Ne){var ke=re.FileIndex[Ne];switch(ke.type){case 0:ue?te=!0:(re.FileIndex.pop(),re.FullPaths.pop());break;case 1:case 2:case 5:ue=!0,isNaN(ke.R*ke.L*ke.C)&&(te=!0),ke.R>-1&&ke.L>-1&&ke.R==ke.L&&(te=!0);break;default:te=!0;break}}if(!(!te&&!le)){var vt=new Date(1987,1,19),rt=0,De=Object.create?Object.create(null):{},We=[];for(Ne=0;Ne<re.FullPaths.length;++Ne)De[re.FullPaths[Ne]]=!0,re.FileIndex[Ne].type!==0&&We.push([re.FullPaths[Ne],re.FileIndex[Ne]]);for(Ne=0;Ne<We.length;++Ne){var st=n(We[Ne][0]);ue=De[st],ue||(We.push([st,{name:i(st).replace("/",""),type:1,clsid:se,ct:vt,mt:vt,content:null}]),De[st]=!0)}for(We.sort(function(xt,Dt){return r(xt[0],Dt[0])}),re.FullPaths=[],re.FileIndex=[],Ne=0;Ne<We.length;++Ne)re.FullPaths[Ne]=We[Ne][0],re.FileIndex[Ne]=We[Ne][1];for(Ne=0;Ne<We.length;++Ne){var zt=re.FileIndex[Ne],Wt=re.FullPaths[Ne];if(zt.name=i(Wt).replace("/",""),zt.L=zt.R=zt.C=-(zt.color=1),zt.size=zt.content?zt.content.length:0,zt.start=0,zt.clsid=zt.clsid||se,Ne===0)zt.C=We.length>1?1:-1,zt.size=0,zt.type=5;else if(Wt.slice(-1)=="/"){for(rt=Ne+1;rt<We.length&&n(re.FullPaths[rt])!=Wt;++rt);for(zt.C=rt>=We.length?-1:rt,rt=Ne+1;rt<We.length&&n(re.FullPaths[rt])!=n(Wt);++rt);zt.R=rt>=We.length?-1:rt,zt.type=1}else n(re.FullPaths[Ne+1]||"")==n(Wt)&&(zt.R=Ne+1),zt.type=2}}}function F(re,le){var te=le||{};if(te.fileType=="mad")return Mt(re,te);switch(P(re),te.fileType){case"zip":return en(re,te)}var ue=function(xt){for(var Dt=0,Vt=0,gr=0;gr<xt.FileIndex.length;++gr){var sr=xt.FileIndex[gr];if(sr.content){var Lr=sr.content.length;Lr>0&&(Lr<4096?Dt+=Lr+63>>6:Vt+=Lr+511>>9)}}for(var Zr=xt.FullPaths.length+3>>2,Er=Dt+7>>3,qt=Dt+127>>7,zr=Er+Vt+Zr+qt,bn=zr+127>>7,or=bn<=109?0:Math.ceil((bn-109)/127);zr+bn+or+127>>7>bn;)or=++bn<=109?0:Math.ceil((bn-109)/127);var kr=[1,or,bn,qt,Zr,Vt,Dt,0];return xt.FileIndex[0].size=Dt<<6,kr[7]=(xt.FileIndex[0].start=kr[0]+kr[1]+kr[2]+kr[3]+kr[4]+kr[5])+(kr[6]+7>>3),kr}(re),Ne=wr(ue[7]<<9),ke=0,vt=0;{for(ke=0;ke<8;++ke)Ne.write_shift(1,U[ke]);for(ke=0;ke<8;++ke)Ne.write_shift(2,0);for(Ne.write_shift(2,62),Ne.write_shift(2,3),Ne.write_shift(2,65534),Ne.write_shift(2,9),Ne.write_shift(2,6),ke=0;ke<3;++ke)Ne.write_shift(2,0);for(Ne.write_shift(4,0),Ne.write_shift(4,ue[2]),Ne.write_shift(4,ue[0]+ue[1]+ue[2]+ue[3]-1),Ne.write_shift(4,0),Ne.write_shift(4,4096),Ne.write_shift(4,ue[3]?ue[0]+ue[1]+ue[2]-1:B),Ne.write_shift(4,ue[3]),Ne.write_shift(-4,ue[1]?ue[0]-1:B),Ne.write_shift(4,ue[1]),ke=0;ke<109;++ke)Ne.write_shift(-4,ke<ue[2]?ue[1]+ke:-1)}if(ue[1])for(vt=0;vt<ue[1];++vt){for(;ke<236+vt*127;++ke)Ne.write_shift(-4,ke<ue[2]?ue[1]+ke:-1);Ne.write_shift(-4,vt===ue[1]-1?B:vt+1)}var rt=function(xt){for(vt+=xt;ke<vt-1;++ke)Ne.write_shift(-4,ke+1);xt&&(++ke,Ne.write_shift(-4,B))};for(vt=ke=0,vt+=ue[1];ke<vt;++ke)Ne.write_shift(-4,de.DIFSECT);for(vt+=ue[2];ke<vt;++ke)Ne.write_shift(-4,de.FATSECT);rt(ue[3]),rt(ue[4]);for(var De=0,We=0,st=re.FileIndex[0];De<re.FileIndex.length;++De)st=re.FileIndex[De],st.content&&(We=st.content.length,!(We<4096)&&(st.start=vt,rt(We+511>>9)));for(rt(ue[6]+7>>3);Ne.l&511;)Ne.write_shift(-4,de.ENDOFCHAIN);for(vt=ke=0,De=0;De<re.FileIndex.length;++De)st=re.FileIndex[De],st.content&&(We=st.content.length,!(!We||We>=4096)&&(st.start=vt,rt(We+63>>6)));for(;Ne.l&511;)Ne.write_shift(-4,de.ENDOFCHAIN);for(ke=0;ke<ue[4]<<2;++ke){var zt=re.FullPaths[ke];if(!zt||zt.length===0){for(De=0;De<17;++De)Ne.write_shift(4,0);for(De=0;De<3;++De)Ne.write_shift(4,-1);for(De=0;De<12;++De)Ne.write_shift(4,0);continue}st=re.FileIndex[ke],ke===0&&(st.start=st.size?st.start-1:B);var Wt=ke===0&&te.root||st.name;if(We=2*(Wt.length+1),Ne.write_shift(64,Wt,"utf16le"),Ne.write_shift(2,We),Ne.write_shift(1,st.type),Ne.write_shift(1,st.color),Ne.write_shift(-4,st.L),Ne.write_shift(-4,st.R),Ne.write_shift(-4,st.C),st.clsid)Ne.write_shift(16,st.clsid,"hex");else for(De=0;De<4;++De)Ne.write_shift(4,0);Ne.write_shift(4,st.state||0),Ne.write_shift(4,0),Ne.write_shift(4,0),Ne.write_shift(4,0),Ne.write_shift(4,0),Ne.write_shift(4,st.start),Ne.write_shift(4,st.size),Ne.write_shift(4,0)}for(ke=1;ke<re.FileIndex.length;++ke)if(st=re.FileIndex[ke],st.size>=4096)if(Ne.l=st.start+1<<9,mi&&Buffer.isBuffer(st.content))st.content.copy(Ne,Ne.l,0,st.size),Ne.l+=st.size+511&-512;else{for(De=0;De<st.size;++De)Ne.write_shift(1,st.content[De]);for(;De&511;++De)Ne.write_shift(1,0)}for(ke=1;ke<re.FileIndex.length;++ke)if(st=re.FileIndex[ke],st.size>0&&st.size<4096)if(mi&&Buffer.isBuffer(st.content))st.content.copy(Ne,Ne.l,0,st.size),Ne.l+=st.size+63&-64;else{for(De=0;De<st.size;++De)Ne.write_shift(1,st.content[De]);for(;De&63;++De)Ne.write_shift(1,0)}if(mi)Ne.l=Ne.length;else for(;Ne.l<Ne.length;)Ne.write_shift(1,0);return Ne}function E(re,le){var te=re.FullPaths.map(function(De){return De.toUpperCase()}),ue=te.map(function(De){var We=De.split("/");return We[We.length-(De.slice(-1)=="/"?2:1)]}),Ne=!1;le.charCodeAt(0)===47?(Ne=!0,le=te[0].slice(0,-1)+le):Ne=le.indexOf("/")!==-1;var ke=le.toUpperCase(),vt=Ne===!0?te.indexOf(ke):ue.indexOf(ke);if(vt!==-1)return re.FileIndex[vt];var rt=!ke.match(fx);for(ke=ke.replace(nl,""),rt&&(ke=ke.replace(fx,"!")),vt=0;vt<te.length;++vt)if((rt?te[vt].replace(fx,"!"):te[vt]).replace(nl,"")==ke||(rt?ue[vt].replace(fx,"!"):ue[vt]).replace(nl,"")==ke)return re.FileIndex[vt];return null}var T=64,B=-2,q="d0cf11e0a1b11ae1",U=[208,207,17,224,161,177,26,225],se="00000000000000000000000000000000",de={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:B,FREESECT:-1,HEADER_SIGNATURE:q,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:se,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function z(re,le,te){u();var ue=F(re,te);c.writeFileSync(le,ue)}function G(re){for(var le=new Array(re.length),te=0;te<re.length;++te)le[te]=String.fromCharCode(re[te]);return le.join("")}function ie(re,le){var te=F(re,le);switch(le&&le.type||"buffer"){case"file":return u(),c.writeFileSync(le.filename,te),te;case"binary":return typeof te=="string"?te:G(te);case"base64":return c1(typeof te=="string"?te:G(te));case"buffer":if(mi)return Buffer.isBuffer(te)?te:cf(te);case"array":return typeof te=="string"?Ql(te):te}return te}var Y;function C(re){try{var le=re.InflateRaw,te=new le;if(te._processChunk(new Uint8Array([3,0]),te._finishFlushFlag),te.bytesRead)Y=re;else throw new Error("zlib does not expose bytesRead")}catch(ue){console.error("cannot use native zlib: "+(ue.message||ue))}}function K(re,le){if(!Y)return Fr(re,le);var te=Y.InflateRaw,ue=new te,Ne=ue._processChunk(re.slice(re.l),ue._finishFlushFlag);return re.l+=ue.bytesRead,Ne}function H(re){return Y?Y.deflateRawSync(re):he(re)}var R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],V=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function X(re){var le=(re<<1|re<<11)&139536|(re<<5|re<<15)&558144;return(le>>16|le>>8|le)&255}for(var Q=typeof Uint8Array<"u",ne=Q?new Uint8Array(256):[],oe=0;oe<256;++oe)ne[oe]=X(oe);function O(re,le){var te=ne[re&255];return le<=8?te>>>8-le:(te=te<<8|ne[re>>8&255],le<=16?te>>>16-le:(te=te<<8|ne[re>>16&255],te>>>24-le))}function W(re,le){var te=le&7,ue=le>>>3;return(re[ue]|(te<=6?0:re[ue+1]<<8))>>>te&3}function ae(re,le){var te=le&7,ue=le>>>3;return(re[ue]|(te<=5?0:re[ue+1]<<8))>>>te&7}function I(re,le){var te=le&7,ue=le>>>3;return(re[ue]|(te<=4?0:re[ue+1]<<8))>>>te&15}function Z(re,le){var te=le&7,ue=le>>>3;return(re[ue]|(te<=3?0:re[ue+1]<<8))>>>te&31}function me(re,le){var te=le&7,ue=le>>>3;return(re[ue]|(te<=1?0:re[ue+1]<<8))>>>te&127}function Te(re,le,te){var ue=le&7,Ne=le>>>3,ke=(1<<te)-1,vt=re[Ne]>>>ue;return te<8-ue||(vt|=re[Ne+1]<<8-ue,te<16-ue)||(vt|=re[Ne+2]<<16-ue,te<24-ue)||(vt|=re[Ne+3]<<24-ue),vt&ke}function Ae(re,le,te){var ue=le&7,Ne=le>>>3;return ue<=5?re[Ne]|=(te&7)<<ue:(re[Ne]|=te<<ue&255,re[Ne+1]=(te&7)>>8-ue),le+3}function Be(re,le,te){var ue=le&7,Ne=le>>>3;return te=(te&1)<<ue,re[Ne]|=te,le+1}function Ee(re,le,te){var ue=le&7,Ne=le>>>3;return te<<=ue,re[Ne]|=te&255,te>>>=8,re[Ne+1]=te,le+8}function ze(re,le,te){var ue=le&7,Ne=le>>>3;return te<<=ue,re[Ne]|=te&255,te>>>=8,re[Ne+1]=te&255,re[Ne+2]=te>>>8,le+16}function Xe(re,le){var te=re.length,ue=2*te>le?2*te:le+5,Ne=0;if(te>=le)return re;if(mi){var ke=nP(ue);if(re.copy)re.copy(ke);else for(;Ne<re.length;++Ne)ke[Ne]=re[Ne];return ke}else if(Q){var vt=new Uint8Array(ue);if(vt.set)vt.set(re);else for(;Ne<te;++Ne)vt[Ne]=re[Ne];return vt}return re.length=ue,re}function Pt(re){for(var le=new Array(re),te=0;te<re;++te)le[te]=0;return le}function ft(re,le,te){var ue=1,Ne=0,ke=0,vt=0,rt=0,De=re.length,We=Q?new Uint16Array(32):Pt(32);for(ke=0;ke<32;++ke)We[ke]=0;for(ke=De;ke<te;++ke)re[ke]=0;De=re.length;var st=Q?new Uint16Array(De):Pt(De);for(ke=0;ke<De;++ke)We[Ne=re[ke]]++,ue<Ne&&(ue=Ne),st[ke]=0;for(We[0]=0,ke=1;ke<=ue;++ke)We[ke+16]=rt=rt+We[ke-1]<<1;for(ke=0;ke<De;++ke)rt=re[ke],rt!=0&&(st[ke]=We[rt+16]++);var zt=0;for(ke=0;ke<De;++ke)if(zt=re[ke],zt!=0)for(rt=O(st[ke],ue)>>ue-zt,vt=(1<<ue+4-zt)-1;vt>=0;--vt)le[rt|vt<<zt]=zt&15|ke<<4;return ue}var He=Q?new Uint16Array(512):Pt(512),tt=Q?new Uint16Array(32):Pt(32);if(!Q){for(var _e=0;_e<512;++_e)He[_e]=0;for(_e=0;_e<32;++_e)tt[_e]=0}(function(){for(var re=[],le=0;le<32;le++)re.push(5);ft(re,tt,32);var te=[];for(le=0;le<=143;le++)te.push(8);for(;le<=255;le++)te.push(9);for(;le<=279;le++)te.push(7);for(;le<=287;le++)te.push(8);ft(te,He,288)})();var Se=function(){for(var le=Q?new Uint8Array(32768):[],te=0,ue=0;te<V.length-1;++te)for(;ue<V[te+1];++ue)le[ue]=te;for(;ue<32768;++ue)le[ue]=29;var Ne=Q?new Uint8Array(259):[];for(te=0,ue=0;te<J.length-1;++te)for(;ue<J[te+1];++ue)Ne[ue]=te;function ke(rt,De){for(var We=0;We<rt.length;){var st=Math.min(65535,rt.length-We),zt=We+st==rt.length;for(De.write_shift(1,+zt),De.write_shift(2,st),De.write_shift(2,~st&65535);st-- >0;)De[De.l++]=rt[We++]}return De.l}function vt(rt,De){for(var We=0,st=0,zt=Q?new Uint16Array(32768):[];st<rt.length;){var Wt=Math.min(65535,rt.length-st);if(Wt<10){for(We=Ae(De,We,+(st+Wt==rt.length)),We&7&&(We+=8-(We&7)),De.l=We/8|0,De.write_shift(2,Wt),De.write_shift(2,~Wt&65535);Wt-- >0;)De[De.l++]=rt[st++];We=De.l*8;continue}We=Ae(De,We,+(st+Wt==rt.length)+2);for(var xt=0;Wt-- >0;){var Dt=rt[st];xt=(xt<<5^Dt)&32767;var Vt=-1,gr=0;if((Vt=zt[xt])&&(Vt|=st&-32768,Vt>st&&(Vt-=32768),Vt<st))for(;rt[Vt+gr]==rt[st+gr]&&gr<250;)++gr;if(gr>2){Dt=Ne[gr],Dt<=22?We=Ee(De,We,ne[Dt+1]>>1)-1:(Ee(De,We,3),We+=5,Ee(De,We,ne[Dt-23]>>5),We+=3);var sr=Dt<8?0:Dt-4>>2;sr>0&&(ze(De,We,gr-J[Dt]),We+=sr),Dt=le[st-Vt],We=Ee(De,We,ne[Dt]>>3),We-=3;var Lr=Dt<4?0:Dt-2>>1;Lr>0&&(ze(De,We,st-Vt-V[Dt]),We+=Lr);for(var Zr=0;Zr<gr;++Zr)zt[xt]=st&32767,xt=(xt<<5^rt[st])&32767,++st;Wt-=gr-1}else Dt<=143?Dt=Dt+48:We=Be(De,We,1),We=Ee(De,We,ne[Dt]),zt[xt]=st&32767,++st}We=Ee(De,We,0)-1}return De.l=(We+7)/8|0,De.l}return function(De,We){return De.length<8?ke(De,We):vt(De,We)}}();function he(re){var le=wr(50+Math.floor(re.length*1.1)),te=Se(re,le);return le.slice(0,te)}var ye=Q?new Uint16Array(32768):Pt(32768),ht=Q?new Uint16Array(32768):Pt(32768),Ge=Q?new Uint16Array(128):Pt(128),lt=1,jt=1;function wt(re,le){var te=Z(re,le)+257;le+=5;var ue=Z(re,le)+1;le+=5;var Ne=I(re,le)+4;le+=4;for(var ke=0,vt=Q?new Uint8Array(19):Pt(19),rt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],De=1,We=Q?new Uint8Array(8):Pt(8),st=Q?new Uint8Array(8):Pt(8),zt=vt.length,Wt=0;Wt<Ne;++Wt)vt[R[Wt]]=ke=ae(re,le),De<ke&&(De=ke),We[ke]++,le+=3;var xt=0;for(We[0]=0,Wt=1;Wt<=De;++Wt)st[Wt]=xt=xt+We[Wt-1]<<1;for(Wt=0;Wt<zt;++Wt)(xt=vt[Wt])!=0&&(rt[Wt]=st[xt]++);var Dt=0;for(Wt=0;Wt<zt;++Wt)if(Dt=vt[Wt],Dt!=0){xt=ne[rt[Wt]]>>8-Dt;for(var Vt=(1<<7-Dt)-1;Vt>=0;--Vt)Ge[xt|Vt<<Dt]=Dt&7|Wt<<3}var gr=[];for(De=1;gr.length<te+ue;)switch(xt=Ge[me(re,le)],le+=xt&7,xt>>>=3){case 16:for(ke=3+W(re,le),le+=2,xt=gr[gr.length-1];ke-- >0;)gr.push(xt);break;case 17:for(ke=3+ae(re,le),le+=3;ke-- >0;)gr.push(0);break;case 18:for(ke=11+me(re,le),le+=7;ke-- >0;)gr.push(0);break;default:gr.push(xt),De<xt&&(De=xt);break}var sr=gr.slice(0,te),Lr=gr.slice(te);for(Wt=te;Wt<286;++Wt)sr[Wt]=0;for(Wt=ue;Wt<30;++Wt)Lr[Wt]=0;return lt=ft(sr,ye,286),jt=ft(Lr,ht,30),le}function yt(re,le){if(re[0]==3&&!(re[1]&3))return[fh(le),2];for(var te=0,ue=0,Ne=nP(le||1<<18),ke=0,vt=Ne.length>>>0,rt=0,De=0;!(ue&1);){if(ue=ae(re,te),te+=3,ue>>>1)ue>>1==1?(rt=9,De=5):(te=wt(re,te),rt=lt,De=jt);else{te&7&&(te+=8-(te&7));var We=re[te>>>3]|re[(te>>>3)+1]<<8;if(te+=32,We>0)for(!le&&vt<ke+We&&(Ne=Xe(Ne,ke+We),vt=Ne.length);We-- >0;)Ne[ke++]=re[te>>>3],te+=8;continue}for(;;){!le&&vt<ke+32767&&(Ne=Xe(Ne,ke+32767),vt=Ne.length);var st=Te(re,te,rt),zt=ue>>>1==1?He[st]:ye[st];if(te+=zt&15,zt>>>=4,!(zt>>>8&255))Ne[ke++]=zt;else{if(zt==256)break;zt-=257;var Wt=zt<8?0:zt-4>>2;Wt>5&&(Wt=0);var xt=ke+J[zt];Wt>0&&(xt+=Te(re,te,Wt),te+=Wt),st=Te(re,te,De),zt=ue>>>1==1?tt[st]:ht[st],te+=zt&15,zt>>>=4;var Dt=zt<4?0:zt-2>>1,Vt=V[zt];for(Dt>0&&(Vt+=Te(re,te,Dt),te+=Dt),!le&&vt<xt&&(Ne=Xe(Ne,xt+100),vt=Ne.length);ke<xt;)Ne[ke]=Ne[ke-Vt],++ke}}}return le?[Ne,te+7>>>3]:[Ne.slice(0,ke),te+7>>>3]}function Fr(re,le){var te=re.slice(re.l||0),ue=yt(te,le);return re.l+=ue[1],ue[0]}function Tt(re,le){if(re)typeof console<"u"&&console.error(le);else throw new Error(le)}function hr(re,le){var te=re;fo(te,0);var ue=[],Ne=[],ke={FileIndex:ue,FullPaths:Ne};A(ke,{root:le.root});for(var vt=te.length-4;(te[vt]!=80||te[vt+1]!=75||te[vt+2]!=5||te[vt+3]!=6)&&vt>=0;)--vt;te.l=vt+4,te.l+=4;var rt=te.read_shift(2);te.l+=6;var De=te.read_shift(4);for(te.l=De,vt=0;vt<rt;++vt){te.l+=20;var We=te.read_shift(4),st=te.read_shift(4),zt=te.read_shift(2),Wt=te.read_shift(2),xt=te.read_shift(2);te.l+=8;var Dt=te.read_shift(4),Vt=l(te.slice(te.l+zt,te.l+zt+Wt));te.l+=zt+Wt+xt;var gr=te.l;te.l=Dt+4,rn(te,We,st,ke,Vt),te.l=gr}return ke}function rn(re,le,te,ue,Ne){re.l+=2;var ke=re.read_shift(2),vt=re.read_shift(2),rt=o(re);if(ke&8257)throw new Error("Unsupported ZIP encryption");for(var De=re.read_shift(4),We=re.read_shift(4),st=re.read_shift(4),zt=re.read_shift(2),Wt=re.read_shift(2),xt="",Dt=0;Dt<zt;++Dt)xt+=String.fromCharCode(re[re.l++]);if(Wt){var Vt=l(re.slice(re.l,re.l+Wt));(Vt[21589]||{}).mt&&(rt=Vt[21589].mt),((Ne||{})[21589]||{}).mt&&(rt=Ne[21589].mt)}re.l+=Wt;var gr=re.slice(re.l,re.l+We);switch(vt){case 8:gr=K(re,st);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+vt)}var sr=!1;ke&8&&(De=re.read_shift(4),De==134695760&&(De=re.read_shift(4),sr=!0),We=re.read_shift(4),st=re.read_shift(4)),We!=le&&Tt(sr,"Bad compressed size: "+le+" != "+We),st!=te&&Tt(sr,"Bad uncompressed size: "+te+" != "+st),Ut(ue,xt,gr,{unsafe:!0,mt:rt})}function en(re,le){var te=le||{},ue=[],Ne=[],ke=wr(1),vt=te.compression?8:0,rt=0,De=0,We=0,st=0,zt=0,Wt=re.FullPaths[0],xt=Wt,Dt=re.FileIndex[0],Vt=[],gr=0;for(De=1;De<re.FullPaths.length;++De)if(xt=re.FullPaths[De].slice(Wt.length),Dt=re.FileIndex[De],!(!Dt.size||!Dt.content||xt=="Sh33tJ5")){var sr=st,Lr=wr(xt.length);for(We=0;We<xt.length;++We)Lr.write_shift(1,xt.charCodeAt(We)&127);Lr=Lr.slice(0,Lr.l),Vt[zt]=Dne.buf(Dt.content,0);var Zr=Dt.content;vt==8&&(Zr=H(Zr)),ke=wr(30),ke.write_shift(4,67324752),ke.write_shift(2,20),ke.write_shift(2,rt),ke.write_shift(2,vt),Dt.mt?s(ke,Dt.mt):ke.write_shift(4,0),ke.write_shift(-4,Vt[zt]),ke.write_shift(4,Zr.length),ke.write_shift(4,Dt.content.length),ke.write_shift(2,Lr.length),ke.write_shift(2,0),st+=ke.length,ue.push(ke),st+=Lr.length,ue.push(Lr),st+=Zr.length,ue.push(Zr),ke=wr(46),ke.write_shift(4,33639248),ke.write_shift(2,0),ke.write_shift(2,20),ke.write_shift(2,rt),ke.write_shift(2,vt),ke.write_shift(4,0),ke.write_shift(-4,Vt[zt]),ke.write_shift(4,Zr.length),ke.write_shift(4,Dt.content.length),ke.write_shift(2,Lr.length),ke.write_shift(2,0),ke.write_shift(2,0),ke.write_shift(2,0),ke.write_shift(2,0),ke.write_shift(4,0),ke.write_shift(4,sr),gr+=ke.l,Ne.push(ke),gr+=Lr.length,Ne.push(Lr),++zt}return ke=wr(22),ke.write_shift(4,101010256),ke.write_shift(2,0),ke.write_shift(2,0),ke.write_shift(2,zt),ke.write_shift(2,zt),ke.write_shift(4,gr),ke.write_shift(4,st),ke.write_shift(2,0),Vs([Vs(ue),Vs(Ne),ke])}var $r={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Kr(re,le){if(re.ctype)return re.ctype;var te=re.name||"",ue=te.match(/\.([^\.]+)$/);return ue&&$r[ue[1]]||le&&(ue=(te=le).match(/[\.\\]([^\.\\])+$/),ue&&$r[ue[1]])?$r[ue[1]]:"application/octet-stream"}function Rn(re){for(var le=c1(re),te=[],ue=0;ue<le.length;ue+=76)te.push(le.slice(ue,ue+76));return te.join(`\r
`)+`\r
`}function Pr(re){var le=re.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(We){var st=We.charCodeAt(0).toString(16).toUpperCase();return"="+(st.length==1?"0"+st:st)});le=le.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),le.charAt(0)==`
`&&(le="=0D"+le.slice(1)),le=le.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var te=[],ue=le.split(`\r
`),Ne=0;Ne<ue.length;++Ne){var ke=ue[Ne];if(ke.length==0){te.push("");continue}for(var vt=0;vt<ke.length;){var rt=76,De=ke.slice(vt,vt+rt);De.charAt(rt-1)=="="?rt--:De.charAt(rt-2)=="="?rt-=2:De.charAt(rt-3)=="="&&(rt-=3),De=ke.slice(vt,vt+rt),vt+=rt,vt<ke.length&&(De+="="),te.push(De)}}return te.join(`\r
`)}function Sn(re){for(var le=[],te=0;te<re.length;++te){for(var ue=re[te];te<=re.length&&ue.charAt(ue.length-1)=="=";)ue=ue.slice(0,ue.length-1)+re[++te];le.push(ue)}for(var Ne=0;Ne<le.length;++Ne)le[Ne]=le[Ne].replace(/[=][0-9A-Fa-f]{2}/g,function(ke){return String.fromCharCode(parseInt(ke.slice(1),16))});return Ql(le.join(`\r
`))}function Me(re,le,te){for(var ue="",Ne="",ke="",vt,rt=0;rt<10;++rt){var De=le[rt];if(!De||De.match(/^\s*$/))break;var We=De.match(/^(.*?):\s*([^\s].*)$/);if(We)switch(We[1].toLowerCase()){case"content-location":ue=We[2].trim();break;case"content-type":ke=We[2].trim();break;case"content-transfer-encoding":Ne=We[2].trim();break}}switch(++rt,Ne.toLowerCase()){case"base64":vt=Ql(lc(le.slice(rt).join("")));break;case"quoted-printable":vt=Sn(le.slice(rt));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Ne)}var st=Ut(re,ue.slice(te.length),vt,{unsafe:!0});ke&&(st.ctype=ke)}function je(re,le){if(G(re.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var te=le&&le.root||"",ue=(mi&&Buffer.isBuffer(re)?re.toString("binary"):G(re)).split(`\r
`),Ne=0,ke="";for(Ne=0;Ne<ue.length;++Ne)if(ke=ue[Ne],!!/^Content-Location:/i.test(ke)&&(ke=ke.slice(ke.indexOf("file")),te||(te=ke.slice(0,ke.lastIndexOf("/")+1)),ke.slice(0,te.length)!=te))for(;te.length>0&&(te=te.slice(0,te.length-1),te=te.slice(0,te.lastIndexOf("/")+1),ke.slice(0,te.length)!=te););var vt=(ue[1]||"").match(/boundary="(.*?)"/);if(!vt)throw new Error("MAD cannot find boundary");var rt="--"+(vt[1]||""),De=[],We=[],st={FileIndex:De,FullPaths:We};A(st);var zt,Wt=0;for(Ne=0;Ne<ue.length;++Ne){var xt=ue[Ne];xt!==rt&&xt!==rt+"--"||(Wt++&&Me(st,ue.slice(zt,Ne),te),zt=Ne)}return st}function Mt(re,le){var te=le||{},ue=te.boundary||"SheetJS";ue="------="+ue;for(var Ne=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ue.slice(2)+'"',"","",""],ke=re.FullPaths[0],vt=ke,rt=re.FileIndex[0],De=1;De<re.FullPaths.length;++De)if(vt=re.FullPaths[De].slice(ke.length),rt=re.FileIndex[De],!(!rt.size||!rt.content||vt=="Sh33tJ5")){vt=vt.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(gr){return"_x"+gr.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(gr){return"_u"+gr.charCodeAt(0).toString(16)+"_"});for(var We=rt.content,st=mi&&Buffer.isBuffer(We)?We.toString("binary"):G(We),zt=0,Wt=Math.min(1024,st.length),xt=0,Dt=0;Dt<=Wt;++Dt)(xt=st.charCodeAt(Dt))>=32&&xt<128&&++zt;var Vt=zt>=Wt*4/5;Ne.push(ue),Ne.push("Content-Location: "+(te.root||"file:///C:/SheetJS/")+vt),Ne.push("Content-Transfer-Encoding: "+(Vt?"quoted-printable":"base64")),Ne.push("Content-Type: "+Kr(rt,vt)),Ne.push(""),Ne.push(Vt?Pr(st):Rn(st))}return Ne.push(ue+`--\r
`),Ne.join(`\r
`)}function pt(re){var le={};return A(le,re),le}function Ut(re,le,te,ue){var Ne=ue&&ue.unsafe;Ne||A(re);var ke=!Ne&&Wn.find(re,le);if(!ke){var vt=re.FullPaths[0];le.slice(0,vt.length)==vt?vt=le:(vt.slice(-1)!="/"&&(vt+="/"),vt=(vt+le).replace("//","/")),ke={name:i(le),type:2},re.FileIndex.push(ke),re.FullPaths.push(vt),Ne||Wn.utils.cfb_gc(re)}return ke.content=te,ke.size=te?te.length:0,ue&&(ue.CLSID&&(ke.clsid=ue.CLSID),ue.mt&&(ke.mt=ue.mt),ue.ct&&(ke.ct=ue.ct)),ke}function ir(re,le){A(re);var te=Wn.find(re,le);if(te){for(var ue=0;ue<re.FileIndex.length;++ue)if(re.FileIndex[ue]==te)return re.FileIndex.splice(ue,1),re.FullPaths.splice(ue,1),!0}return!1}function fr(re,le,te){A(re);var ue=Wn.find(re,le);if(ue){for(var Ne=0;Ne<re.FileIndex.length;++Ne)if(re.FileIndex[Ne]==ue)return re.FileIndex[Ne].name=i(te),re.FullPaths[Ne]=te,!0}return!1}function vr(re){P(re,!0)}return t.find=E,t.read=j,t.parse=d,t.write=ie,t.writeFile=z,t.utils={cfb_new:pt,cfb_add:Ut,cfb_del:ir,cfb_mov:fr,cfb_gc:vr,ReadShift:Nx,CheckField:v$,prep_blob:fo,bconcat:Vs,use_zlib:C,_deflateRaw:he,_inflateRaw:Fr,consts:de},t}();function $ne(e){return typeof e=="string"?jS(e):Array.isArray(e)?fne(e):e}function ry(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=jS(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Xu(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([$ne(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=kh(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function Une(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Ga(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function dP(e,t){for(var r=[],n=Ga(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function NS(e){for(var t=[],r=Ga(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function CS(e){for(var t=[],r=Ga(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function zne(e){for(var t=[],r=Ga(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var I2=new Date(1899,11,30,0,0,0);function Ms(e,t){var r=e.getTime(),n=I2.getTime()+(e.getTimezoneOffset()-I2.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Z9=new Date,Wne=I2.getTime()+(Z9.getTimezoneOffset()-I2.getTimezoneOffset())*6e4,fP=Z9.getTimezoneOffset();function ES(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Wne),t.getTimezoneOffset()!==fP&&t.setTime(t.getTime()+(t.getTimezoneOffset()-fP)*6e4),t}function qne(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[s],10)}return t}var hP=new Date("2017-02-19T19:06:09.000Z"),e$=isNaN(hP.getFullYear())?new Date("2/19/17"):hP,Hne=e$.getFullYear()==2017;function xa(e,t){var r=new Date(e);if(Hne)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(e$.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function _0(e,t){if(mi&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Xu(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Xu(U9(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Xu(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Xu(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function ya(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=ya(e[r]));return t}function qa(e,t){for(var r="";r.length<t;)r+=e;return r}function gu(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var Vne=["january","february","march","april","may","june","july","august","september","october","november","december"];function Bm(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&Vne.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Gne=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),o=[s[0]],l=1;l<s.length;++l)o.push(i),o.push(s[l]);return o}}();function t$(e){return e?e.content&&e.type?_0(e.content,!0):e.data?dx(e.data):e.asNodeBuffer&&mi?dx(e.asNodeBuffer().toString("binary")):e.asBinary?dx(e.asBinary()):e._data&&e._data.getContent?dx(_0(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function r$(e){if(!e)return null;if(e.data)return tP(e.data);if(e.asNodeBuffer&&mi)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?tP(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Kne(e){return e&&e.name.slice(-4)===".bin"?r$(e):t$(e)}function Tc(e,t){for(var r=e.FullPaths||Ga(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function L3(e,t){var r=Tc(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function hs(e,t,r){if(!r)return Kne(L3(e,t));if(!t)return null;try{return hs(e,t)}catch{return null}}function Jl(e,t,r){if(!r)return t$(L3(e,t));if(!t)return null;try{return Jl(e,t)}catch{return null}}function Yne(e,t,r){return r$(L3(e,t))}function pP(e){for(var t=e.FullPaths||Ga(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function hi(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return mi?n=cf(r):n=hne(r),Wn.utils.cfb_add(e,t,n)}Wn.utils.cfb_add(e,t,r)}else e.file(t,r)}function R3(){return Wn.utils.cfb_new()}function n$(e,t){switch(t.type){case"base64":return Wn.read(e,{type:"base64"});case"binary":return Wn.read(e,{type:"binary"});case"buffer":case"array":return Wn.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function hx(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var ls=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Xne=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,mP=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Qne=/<[^>]*>/g,qo=ls.match(mP)?mP:Qne,Jne=/<\w*:/,Zne=/<(\/?)\w+:/;function Xn(e,t,r){for(var n={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var o=e.match(Xne),l=0,c="",u=0,d="",f="",h=1;if(o)for(u=0;u!=o.length;++u){for(f=o[u],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(d=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(h=(i=f.charCodeAt(s+1))==34||i==39?1:0,c=f.slice(s+1+h,f.length-h),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,n[d.toLowerCase()]=c;else{var p=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(n[p]&&d.slice(l-3,l)=="ext")continue;n[p]=c,n[p.toLowerCase()]=c}}return n}function ud(e){return e.replace(Zne,"<$1")}var i$={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},F3=NS(i$),Ai=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(l,c){return i$[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,o)+r(i.slice(o+3))}}(),B3=/[&<>'"]/g,eie=/[\u0000-\u0008\u000b-\u001f]/g;function Vi(e){var t=e+"";return t.replace(B3,function(r){return F3[r]}).replace(eie,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function gP(e){return Vi(e).replace(/ /g,"_x0020_")}var a$=/[\u0000-\u001f]/g;function I3(e){var t=e+"";return t.replace(B3,function(r){return F3[r]}).replace(/\n/g,"<br/>").replace(a$,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function tie(e){var t=e+"";return t.replace(B3,function(r){return F3[r]}).replace(a$,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var xP=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function rie(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function pa(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Q5(e){for(var t="",r=0,n=0,i=0,s=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function yP(e){var t=fh(2*e.length),r,n,i=1,s=0,o=0,l;for(n=0;n<e.length;n+=i)i=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),i=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[s++]=o&255,t[s++]=o>>>8,o=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function bP(e){return cf(e,"binary").toString("utf8")}var Sb="foo bar baz",Qi=mi&&(bP(Sb)==Q5(Sb)&&bP||yP(Sb)==Q5(Sb)&&yP)||Q5,Xu=mi?function(e){return cf(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},d1=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),s$=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),nie=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),iie=/<\/?(?:vt:)?variant>/g,aie=/<(?:vt:)([^>]*)>([\s\S]*)</;function vP(e,t){var r=Xn(e),n=e.match(nie(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var o=s.replace(iie,"").match(aie);o&&i.push({v:Qi(o[2]),t:o[1]})}),i}var o$=/(^\s|\s$|\n)/;function ho(e,t){return"<"+e+(t.match(o$)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function f1(e){return Ga(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ln(e,t,r){return"<"+e+(r!=null?f1(r):"")+(t!=null?(t.match(o$)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function I4(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function sie(e,t){switch(typeof e){case"string":var r=ln("vt:lpwstr",Vi(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ln((e|0)==e?"vt:i4":"vt:r8",Vi(String(e)));case"boolean":return ln("vt:bool",e?"true":"false")}if(e instanceof Date)return ln("vt:filetime",I4(e));throw new Error("Unable to serialize "+e)}function D3(e){if(mi&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Qi(kh(P3(e)));throw new Error("Bad input format: expected Buffer or string")}var h1=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Ps={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},X0=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Yl={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function oie(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function lie(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,o=n?-t:t;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var l=0;l<=5;++l,s/=256)e[r+l]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var wP=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},SP=mi?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:cf(t)})):wP(e)}:wP,_P=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(Ld(e,i)));return n.join("").replace(nl,"")},$3=mi?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(nl,""):_P(e,t,r)}:_P,kP=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},l$=mi?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):kP(e,t,r)}:kP,jP=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Rp(e,i)));return n.join("")},ny=mi?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):jP(t,r,n)}:jP,c$=function(e,t){var r=Xl(e,t);return r>0?ny(e,t+4,t+4+r-1):""},u$=c$,d$=function(e,t){var r=Xl(e,t);return r>0?ny(e,t+4,t+4+r-1):""},f$=d$,h$=function(e,t){var r=2*Xl(e,t);return r>0?ny(e,t+4,t+4+r-1):""},p$=h$,m$=function(t,r){var n=Xl(t,r);return n>0?$3(t,r+4,r+4+n):""},g$=m$,x$=function(e,t){var r=Xl(e,t);return r>0?ny(e,t+4,t+4+r):""},y$=x$,b$=function(e,t){return oie(e,t)},D2=b$,U3=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};mi&&(u$=function(t,r){if(!Buffer.isBuffer(t))return c$(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},f$=function(t,r){if(!Buffer.isBuffer(t))return d$(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},p$=function(t,r){if(!Buffer.isBuffer(t))return h$(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},g$=function(t,r){if(!Buffer.isBuffer(t))return m$(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},y$=function(t,r){if(!Buffer.isBuffer(t))return x$(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},D2=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):b$(t,r)},U3=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Rp=function(e,t){return e[t]},Ld=function(e,t){return e[t+1]*256+e[t]},cie=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Xl=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Wh=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},uie=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Nx(e,t){var r="",n,i,s=[],o,l,c,u;switch(t){case"dbcs":if(u=this.l,mi&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Ld(this,u)),u+=2;e*=2;break;case"utf8":r=ny(this,this.l,this.l+e);break;case"utf16le":e*=2,r=$3(this,this.l,this.l+e);break;case"wstr":return Nx.call(this,e,"dbcs");case"lpstr-ansi":r=u$(this,this.l),e=4+Xl(this,this.l);break;case"lpstr-cp":r=f$(this,this.l),e=4+Xl(this,this.l);break;case"lpwstr":r=p$(this,this.l),e=4+2*Xl(this,this.l);break;case"lpp4":e=4+Xl(this,this.l),r=g$(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Xl(this,this.l),r=y$(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Rp(this,this.l+e++))!==0;)s.push(wb(o));r=s.join("");break;case"_wstr":for(e=0,r="";(o=Ld(this,this.l+e))!==0;)s.push(wb(o)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Rp(this,u),this.l=u+1,l=Nx.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(wb(Ld(this,u))),u+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Rp(this,u),this.l=u+1,l=Nx.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(wb(Rp(this,u))),u+=1}r=s.join("");break;default:switch(e){case 1:return n=Rp(this,this.l),this.l++,n;case 2:return n=(t==="i"?cie:Ld)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Wh:uie)(this,this.l),this.l+=4,n):(i=Xl(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=D2(this,this.l):i=D2([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=l$(this,this.l,e);break}}return this.l+=e,r}var die=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},fie=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},hie=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function pie(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)hie(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,die(this,t,this.l);break;case 8:if(n=8,r==="f"){lie(this,t,this.l);break}case 16:break;case-4:n=4,fie(this,t,this.l);break}return this.l+=n,this}function v$(e,t){var r=l$(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function fo(e,t){e.l=t,e.read_shift=Nx,e.chk=v$,e.write_shift=pie}function zo(e,t){e.l+=t}function wr(e){var t=fh(e);return fo(t,0),t}function uf(e,t,r){if(e){var n,i,s;fo(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var u=b1[l]||b1[65535];for(n=e.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=e.read_shift(1))&127)<<7*i;c=e.l+s;var d=u.f&&u.f(e,s,r);if(e.l=c,t(d,u,l))return}}}function Pl(){var e=[],t=mi?256:2048,r=function(u){var d=wr(u);return fo(d,0),d},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,t)))},o=function(){return i(),Vs(e)},l=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:l,end:o,_bufs:e}}function Br(e,t,r,n){var i=+t,s;if(!isNaN(i)){n||(n=b1[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var o=e.next(s);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&U3(r)&&e.push(r)}}function Cx(e,t,r){var n=ya(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function AP(e,t,r){var n=ya(e);return n.s=Cx(n.s,t.s,r),n.e=Cx(n.e,t.s,r),n}function Ex(e,t){if(e.cRel&&e.c<0)for(e=ya(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ya(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Yn(e);return!e.cRel&&e.cRel!=null&&(r=xie(r)),!e.rRel&&e.rRel!=null&&(r=mie(r)),r}function J5(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ta(e.s.c)+":"+(e.e.cRel?"":"$")+Ta(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+os(e.s.r)+":"+(e.e.rRel?"":"$")+os(e.e.r):Ex(e.s,t.biff)+":"+Ex(e.e,t.biff)}function z3(e){return parseInt(gie(e),10)-1}function os(e){return""+(e+1)}function mie(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function gie(e){return e.replace(/\$(\d+)$/,"$1")}function W3(e){for(var t=yie(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Ta(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function xie(e){return e.replace(/^([A-Z])/,"$$$1")}function yie(e){return e.replace(/^\$([A-Z])/,"$1")}function bie(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Pa(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function Yn(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ol(e){var t=e.indexOf(":");return t==-1?{s:Pa(e),e:Pa(e)}:{s:Pa(e.slice(0,t)),e:Pa(e.slice(t+1))}}function oi(e,t){return typeof t>"u"||typeof t=="number"?oi(e.s,e.e):(typeof e!="string"&&(e=Yn(e)),typeof t!="string"&&(t=Yn(t)),e==t?e:e+":"+t)}function Ni(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function NP(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Uc(e.z,r?Ms(t):t)}catch{}try{return e.w=Uc((e.XF||{}).numFmtId||(r?14:0),r?Ms(t):t)}catch{return""+t}}function Yd(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?df[e.v]||e.v:t==null?NP(e,e.v):NP(e,t))}function jh(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function w$(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),o=0,l=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Pa(n.origin):n.origin;o=c.r,l=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=Ni(s["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(u.e.r=o=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var p={v:t[f][h]},m=o+f,g=l+h;if(u.s.r>m&&(u.s.r=m),u.s.c>g&&(u.s.c=g),u.e.r<m&&(u.e.r=m),u.e.c<g&&(u.e.c=g),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))p=t[f][h];else if(Array.isArray(p.v)&&(p.f=t[f][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Gn[14],n.cellDates?(p.t="d",p.w=Uc(p.z,Ms(p.v))):(p.t="n",p.v=Ms(p.v),p.w=Uc(p.z,p.v))):p.t="s";if(i)s[m]||(s[m]=[]),s[m][g]&&s[m][g].z&&(p.z=s[m][g].z),s[m][g]=p;else{var y=Yn({c:g,r:m});s[y]&&s[y].z&&(p.z=s[y].z),s[y]=p}}}return u.s.c<1e7&&(s["!ref"]=oi(u)),s}function lg(e,t){return w$(null,e,t)}function vie(e){return e.read_shift(4,"i")}function xu(e,t){return t||(t=wr(4)),t.write_shift(4,e),t}function Do(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Gs(e,t){var r=!1;return t==null&&(r=!0,t=wr(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function wie(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Sie(e,t){return t||(t=wr(4)),t.write_shift(2,0),t.write_shift(2,0),t}function q3(e,t){var r=e.l,n=e.read_shift(1),i=Do(e),s=[],o={t:i,h:i};if(n&1){for(var l=e.read_shift(4),c=0;c!=l;++c)s.push(wie(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function _ie(e,t){var r=!1;return t==null&&(r=!0,t=wr(15+4*e.t.length)),t.write_shift(1,0),Gs(e.t,t),r?t.slice(0,t.l):t}var kie=q3;function jie(e,t){var r=!1;return t==null&&(r=!0,t=wr(23+4*e.t.length)),t.write_shift(1,1),Gs(e.t,t),t.write_shift(4,1),Sie({},t),r?t.slice(0,t.l):t}function Gc(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Q0(e,t){return t==null&&(t=wr(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function J0(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Z0(e,t){return t==null&&(t=wr(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Aie=Do,S$=Gs;function H3(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function $2(e,t){var r=!1;return t==null&&(r=!0,t=wr(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Nie=Do,D4=H3,V3=$2;function G3(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?D2([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Wh(t,0)>>2;return r?i/100:i}function _$(e,t){t==null&&(t=wr(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function k$(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Cie(e,t){return t||(t=wr(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var ep=k$,cg=Cie;function Io(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function k0(e,t){return(t||wr(8)).write_shift(8,e,"f")}function Eie(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var u=a0[i];u&&(t.rgb=m1(u));break;case 2:t.rgb=m1([o,l,c]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function U2(e,t){if(t||(t=wr(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function Tie(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Pie(e,t){t||(t=wr(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function j$(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Oie(e){return j$(e,1)}function Mie(e){return j$(e,2)}var K3=2,bl=3,_b=11,CP=12,z2=19,kb=64,Lie=65,Rie=71,Fie=4108,Bie=4126,zs=80,A$=81,Iie=[zs,A$],$4={1:{n:"CodePage",t:K3},2:{n:"Category",t:zs},3:{n:"PresentationFormat",t:zs},4:{n:"ByteCount",t:bl},5:{n:"LineCount",t:bl},6:{n:"ParagraphCount",t:bl},7:{n:"SlideCount",t:bl},8:{n:"NoteCount",t:bl},9:{n:"HiddenCount",t:bl},10:{n:"MultimediaClipCount",t:bl},11:{n:"ScaleCrop",t:_b},12:{n:"HeadingPairs",t:Fie},13:{n:"TitlesOfParts",t:Bie},14:{n:"Manager",t:zs},15:{n:"Company",t:zs},16:{n:"LinksUpToDate",t:_b},17:{n:"CharacterCount",t:bl},19:{n:"SharedDoc",t:_b},22:{n:"HyperlinksChanged",t:_b},23:{n:"AppVersion",t:bl,p:"version"},24:{n:"DigSig",t:Lie},26:{n:"ContentType",t:zs},27:{n:"ContentStatus",t:zs},28:{n:"Language",t:zs},29:{n:"Version",t:zs},255:{},2147483648:{n:"Locale",t:z2},2147483651:{n:"Behavior",t:z2},1919054434:{}},U4={1:{n:"CodePage",t:K3},2:{n:"Title",t:zs},3:{n:"Subject",t:zs},4:{n:"Author",t:zs},5:{n:"Keywords",t:zs},6:{n:"Comments",t:zs},7:{n:"Template",t:zs},8:{n:"LastAuthor",t:zs},9:{n:"RevNumber",t:zs},10:{n:"EditTime",t:kb},11:{n:"LastPrinted",t:kb},12:{n:"CreatedDate",t:kb},13:{n:"ModifiedDate",t:kb},14:{n:"PageCount",t:bl},15:{n:"WordCount",t:bl},16:{n:"CharCount",t:bl},17:{n:"Thumbnail",t:Rie},18:{n:"Application",t:zs},19:{n:"DocSecurity",t:bl},255:{},2147483648:{n:"Locale",t:z2},2147483651:{n:"Behavior",t:z2},1919054434:{}},EP={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Die=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function $ie(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Uie=$ie([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),a0=ya(Uie),df={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},N$={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},z4={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},jb={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Y3(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function zie(e){var t=Y3();if(!e||!e.match)return t;var r={};if((e.match(qo)||[]).forEach(function(n){var i=Xn(n);switch(i[0].replace(Jne,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[z4[i.ContentType]]!==void 0&&t[z4[i.ContentType]].push(i.PartName);break}}),t.xmlns!==Ps.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function C$(e,t){var r=zne(z4),n=[],i;n[n.length]=ls,n[n.length]=ln("Types",null,{xmlns:Ps.CT,"xmlns:xsd":Ps.xsd,"xmlns:xsi":Ps.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return ln("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){e[c]&&e[c].length>0&&(i=e[c][0],n[n.length]=ln("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:jb[c][t.bookType]||jb[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=ln("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:jb[c][t.bookType]||jb[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(u){n[n.length]=ln("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return s("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var gi={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function p1(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Tx(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(qo)||[]).forEach(function(i){var s=Xn(i);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var l=s.TargetMode==="External"?s.Target:hx(s.Target,t);r[l]=o,n[s.Id]=o}}),r["!id"]=n,r}function mm(e){var t=[ls,ln("Relationships",null,{xmlns:Ps.RELS})];return Ga(e["!id"]).forEach(function(r){t[t.length]=ln("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Wi(e,t,r,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[gi.HLINK,gi.XPATH,gi.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var Wie="application/vnd.oasis.opendocument.spreadsheet";function qie(e,t){for(var r=D3(e),n,i;n=h1.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Xn(n[0],!1),i.path=="/"&&i.type!==Wie)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function Hie(e){var t=[ls];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function TP(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Vie(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Gie(e){var t=[ls];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(TP(e[r][0],e[r][1])),t.push(Vie("",e[r][0]));return t.push(TP("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function E$(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+L2.version+"</meta:generator></office:meta></office:document-meta>"}var Ic=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Kie=function(){for(var e=new Array(Ic.length),t=0;t<Ic.length;++t){var r=Ic[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function T$(e){var t={};e=Qi(e);for(var r=0;r<Ic.length;++r){var n=Ic[r],i=e.match(Kie[r]);i!=null&&i.length>0&&(t[n[1]]=Ai(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=xa(t[n[1]]))}return t}function Z5(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=Vi(t),n[n.length]=r?ln(e,t,r):ho(e,t))}function P$(e,t){var r=t||{},n=[ls,ln("cp:coreProperties",null,{"xmlns:cp":Ps.CORE_PROPS,"xmlns:dc":Ps.dc,"xmlns:dcterms":Ps.dcterms,"xmlns:dcmitype":Ps.dcmitype,"xmlns:xsi":Ps.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Z5("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:I4(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&Z5("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:I4(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Ic.length;++s){var o=Ic[s],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Z5(o[0],l,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var s0=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],O$=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function M$(e,t,r,n){var i=[];if(typeof e=="string")i=vP(e,n);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(d){return{v:d}}));var o=typeof t=="string"?vP(t,n).map(function(d){return d.v}):t,l=0,c=0;if(o.length>0)for(var u=0;u!==i.length;u+=2){switch(c=+i[u+1].v,i[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function Yie(e,t,r){var n={};return t||(t={}),e=Qi(e),s0.forEach(function(i){var s=(e.match(d1(i[0]))||[])[1];switch(i[2]){case"string":s&&(t[i[1]]=Ai(s));break;case"bool":t[i[1]]=s==="true";break;case"raw":var o=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&M$(n.HeadingPairs,n.TitlesOfParts,t,r),t}function L$(e){var t=[],r=ln;return e||(e={}),e.Application="SheetJS",t[t.length]=ls,t[t.length]=ln("Properties",null,{xmlns:Ps.EXT_PROPS,"xmlns:vt":Ps.vt}),s0.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Vi(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Vi(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Xie=/<[^>]+>[^<]*/g;function Qie(e,t){var r={},n="",i=e.match(Xie);if(i)for(var s=0;s!=i.length;++s){var o=i[s],l=Xn(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ai(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=Ai(d);break;case"bool":r[n]=pa(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=xa(d);break;case"cy":case"error":r[n]=Ai(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function R$(e){var t=[ls,ln("Properties",null,{xmlns:Ps.CUST_PROPS,"xmlns:vt":Ps.vt})];if(!e)return t.join("");var r=1;return Ga(e).forEach(function(i){++r,t[t.length]=ln("property",sie(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Vi(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var W4={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ek;function Jie(e,t,r){ek||(ek=NS(W4)),t=ek[t]||t,e[t]=r}function Zie(e,t){var r=[];return Ga(W4).map(function(n){for(var i=0;i<Ic.length;++i)if(Ic[i][1]==n)return Ic[i];for(i=0;i<s0.length;++i)if(s0[i][1]==n)return s0[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(ho(W4[n[1]]||n[1],i))}}),ln("DocumentProperties",r.join(""),{xmlns:Yl.o})}function eae(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&Ga(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var o=0;o<Ic.length;++o)if(s==Ic[o][1])return;for(o=0;o<s0.length;++o)if(s==s0[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var l=e[s],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),i.push(ln(gP(s),l,{"dt:dt":c}))}}),t&&Ga(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),i.push(ln(gP(s),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+Yl.o+'">'+i.join("")+"</"+n+">"}function X3(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function tae(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var o=wr(8);return o.write_shift(4,n),o.write_shift(4,i),o}function F$(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function B$(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function I$(e,t,r){return t===31?B$(e):F$(e,t,r)}function q4(e,t,r){return I$(e,t,r===!1?0:4)}function rae(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return I$(e,t,0)}function nae(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(nl,""),e.l-i&2&&(e.l+=2)}return r}function iae(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(nl,"");return r}function aae(e){var t=e.l,r=W2(e,A$);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=W2(e,bl);return[r,n]}function sae(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(aae(e));return r}function PP(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var s=e.read_shift(4),o=e.read_shift(4);n[s]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(nl,"").replace(fx,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function D$(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function oae(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function W2(e,t,r){var n=e.read_shift(2),i,s=r||{};if(e.l+=2,t!==CP&&n!==t&&Iie.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===CP?n:t){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return F$(e,n,4).replace(nl,"");case 31:return B$(e);case 64:return X3(e);case 65:return D$(e);case 71:return oae(e);case 80:return q4(e,n,!s.raw).replace(nl,"");case 81:return rae(e,n).replace(nl,"");case 4108:return sae(e);case 4126:case 4127:return n==4127?nae(e):iae(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function OP(e,t){var r=wr(4),n=wr(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=wr(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=tae(t);break;case 31:case 80:for(n=wr(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Vs([r,n])}function MP(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),s=[],o=0,l=0,c=-1,u={};for(o=0;o!=i;++o){var d=e.read_shift(4),f=e.read_shift(4);s[o]=[d,f+r]}s.sort(function(v,w){return v[1]-w[1]});var h={};for(o=0;o!=i;++o){if(e.l!==s[o][1]){var p=!0;if(o>0&&t)switch(t[s[o-1][0]].t){case 2:e.l+2===s[o][1]&&(e.l+=2,p=!1);break;case 80:e.l<=s[o][1]&&(e.l=s[o][1],p=!1);break;case 4108:e.l<=s[o][1]&&(e.l=s[o][1],p=!1);break}if((!t||o==0)&&e.l<=s[o][1]&&(p=!1,e.l=s[o][1]),p)throw new Error("Read Error: Expected address "+s[o][1]+" at "+e.l+" :"+o)}if(t){var m=t[s[o][0]];if(h[m.n]=W2(e,m.t,{raw:!0}),m.p==="version"&&(h[m.n]=String(h[m.n]>>16)+"."+("0000"+String(h[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(h[m.n]){case 0:h[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:fu(l=h[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[m.n])}}else if(s[o][0]===1){if(l=h.CodePage=W2(e,K3),fu(l),c!==-1){var g=e.l;e.l=s[c][1],u=PP(e,l),e.l=g}}else if(s[o][0]===0){if(l===0){c=o,e.l=s[o+1][1];continue}u=PP(e,l)}else{var y=u[s[o][0]],b;switch(e[e.l]){case 65:e.l+=4,b=D$(e);break;case 30:e.l+=4,b=q4(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,b=q4(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,b=e.read_shift(4,"i");break;case 19:e.l+=4,b=e.read_shift(4);break;case 5:e.l+=4,b=e.read_shift(8,"f");break;case 11:e.l+=4,b=Za(e,4);break;case 64:e.l+=4,b=xa(X3(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[y]=b}}return e.l=r+n,h}var $$=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function lae(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function LP(e,t,r){var n=wr(8),i=[],s=[],o=8,l=0,c=wr(8),u=wr(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),s.push(c),i.push(u),o+=8+c.length,!t){u=wr(8),u.write_shift(4,0),i.unshift(u);var d=[wr(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(c=wr(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=Vs(d),s.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!($$.indexOf(e[l][0])>-1||O$.indexOf(e[l][0])>-1)&&e[l][1]!=null){var h=e[l][1],p=0;if(t){p=+t[e[l][0]];var m=r[p];if(m.p=="version"&&typeof h=="string"){var g=h.split(".");h=(+g[0]<<16)+(+g[1]||0)}c=OP(m.t,h)}else{var y=lae(h);y==-1&&(y=31,h=String(h)),c=OP(y,h)}s.push(c),u=wr(8),u.write_shift(4,t?p:2+l),i.push(u),o+=8+c.length}var b=8*(s.length+1);for(l=0;l<s.length;++l)i[l].write_shift(4,b),b+=s[l].length;return n.write_shift(4,o),n.write_shift(4,s.length),Vs([n].concat(i).concat(s))}function RP(e,t,r){var n=e.content;if(!n)return{};fo(n,0);var i,s,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==Wn.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),l=n.read_shift(4),i===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);i===2&&(o=n.read_shift(16),c=n.read_shift(4));var f=MP(n,t),h={SystemIdentifier:u};for(var p in f)h[p]=f[p];if(h.FMTID=s,i===1)return h;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var m;try{m=MP(n,null)}catch{}for(p in m)h[p]=m[p];return h.FMTID=[s,o],h}function FP(e,t,r,n,i,s){var o=wr(i?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Wn.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,i?68:48);var c=LP(e,r,n);if(l.push(c),i){var u=LP(i,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+c.length),l.push(u)}return Vs(l)}function Af(e,t){return e.read_shift(t),null}function cae(e,t){t||(t=wr(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function uae(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function Za(e,t){return e.read_shift(t)===1}function Jo(e,t){return t||(t=wr(2)),t.write_shift(2,+!!e),t}function ps(e){return e.read_shift(2,"u")}function Pc(e,t){return t||(t=wr(2)),t.write_shift(2,e),t}function U$(e,t){return uae(e,t,ps)}function dae(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function z$(e,t,r){return r||(r=wr(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function iy(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?e.read_shift(n,i):"";return o}function fae(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,s=1+(r&1),o=0,l,c={};i&&(o=e.read_shift(2)),n&&(l=e.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return i&&(e.l+=4*o),n&&(e.l+=l),c.t=d,i||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function hae(e){var t=e.t||"",r=wr(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=wr(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return Vs(i)}function j0(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function ay(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):j0(e,n,r)}function tp(e,t,r){if(r.biff>5)return ay(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function W$(e,t,r){return r||(r=wr(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function pae(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function mae(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(nl,"");return n&&(e.l+=24),i}function gae(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(s>>1,"utf16le").replace(nl,"");return r+o}function xae(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return mae(e);case"0303000000000000c000000000000046":return gae(e);default:throw new Error("Unsupported Moniker "+r)}}function Ab(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(nl,""):"";return r}function BP(e,t){t||(t=wr(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function yae(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var s,o,l,c,u="",d,f;i&16&&(s=Ab(e,r-e.l)),i&128&&(o=Ab(e,r-e.l)),(i&257)===257&&(l=Ab(e,r-e.l)),(i&257)===1&&(c=xae(e,r-e.l)),i&8&&(u=Ab(e,r-e.l)),i&32&&(d=e.read_shift(16)),i&64&&(f=X3(e)),e.l=r;var h=o||l||c||"";h&&u&&(h+="#"+u),h||(h="#"+u),i&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var p={Target:h};return d&&(p.guid=d),f&&(p.time=f),s&&(p.Tooltip=s),p}function bae(e){var t=wr(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(s==28)n=n.slice(1),BP(n,t);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),s&8&&BP(i>-1?n.slice(i+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function q$(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function H$(e,t){var r=q$(e);return r[3]=0,r}function dd(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function A0(e,t,r,n){return n||(n=wr(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function vae(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function wae(e,t,r){return t===0?"":tp(e,t,r)}function Sae(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[i,s,o]}function V$(e){var t=e.read_shift(2),r=G3(e);return[t,r]}function _ae(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=iy(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,i}function TS(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function G$(e,t){return t||(t=wr(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function K$(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var kae=K$;function Y$(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function jae(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function Aae(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function ko(e){e.l+=2,e.l+=e.read_shift(2)}var Nae={0:ko,4:ko,5:ko,6:ko,7:Aae,8:ko,9:ko,10:ko,11:ko,12:ko,13:jae,14:ko,15:ko,16:ko,17:ko,18:ko,19:ko,20:ko,21:Y$};function Cae(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(Nae[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Nb(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Q3(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=wr(i);return s.write_shift(2,n),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function Eae(e,t){return t===0||e.read_shift(2),1200}function Tae(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=tp(e,0,r);return e.read_shift(t+n-e.l),i}function Pae(e,t){var r=!t||t.biff==8,n=wr(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function Oae(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function Mae(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=iy(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:s,name:o}}function Lae(e,t){var r=!t||t.biff>=8?2:1,n=wr(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function Rae(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),s=[],o=0;o!=i&&e.l<r;++o)s.push(fae(e));return s.Count=n,s.Unique=i,s}function Fae(e,t){var r=wr(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=hae(e[i]);var s=Vs([r].concat(n));return s.parts=[r.length].concat(n.map(function(o){return o.length})),s}function Bae(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function Iae(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function Dae(e){var t=vae(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function $ae(e){return e.read_shift(2),e.read_shift(4)}function IP(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function Uae(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:s,CurTab:o,FirstTab:l,Selected:c,TabRatio:u}}function zae(){var e=wr(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Wae(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function qae(e){var t=wr(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Hae(){}function Vae(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=iy(e,0,r),n}function Gae(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,s=wr(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function Kae(e){var t=dd(e);return t.isst=e.read_shift(4),t}function Yae(e,t,r,n){var i=wr(10);return A0(e,t,n,i),i.write_shift(4,r),i}function Xae(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=dd(e);r.biff==2&&e.l++;var s=ay(e,n-e.l,r);return i.val=s,i}function Qae(e,t,r,n,i){var s=!i||i.biff==8,o=wr(8+ +s+(1+s)*r.length);return A0(e,t,n,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function Jae(e,t,r){var n=e.read_shift(2),i=tp(e,0,r);return[n,i]}function Zae(e,t,r,n){var i=r&&r.biff==5;n||(n=wr(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var ese=tp;function DP(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,s=e.read_shift(i),o=e.read_shift(i),l=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:s,c:l},e:{r:o,c}}}function tse(e,t){var r=t.biff==8||!t.biff?4:2,n=wr(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function rse(e){var t=e.read_shift(2),r=e.read_shift(2),n=V$(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function nse(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(V$(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:s}}function ise(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:s}}function ase(e,t,r,n){var i={},s=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return i.patternType=Die[l>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=l&127,i.icvBottom=l>>7&127,i.icvDiag=l>>14&127,i.dgDiag=l>>21&15,i.icvFore=c&127,i.icvBack=c>>7&127,i.fsxButton=c>>14&1),i}function sse(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=ase(e,t,n.fStyle,r),n}function $P(e,t,r,n){var i=r&&r.biff==5;n||(n=wr(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function ose(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function lse(e){var t=wr(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function UP(e,t,r){var n=dd(e);(r.biff==2||t==9)&&++e.l;var i=dae(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function cse(e,t,r,n,i,s){var o=wr(8);return A0(e,t,n,o),z$(r,s,o),o}function use(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=dd(e),i=Io(e);return n.val=i,n}function dse(e,t,r,n){var i=wr(14);return A0(e,t,n,i),k0(r,i),i}var zP=wae;function fse(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=j0(e,s),l=[];n>e.l;)l.push(ay(e));return[s,i,o,l]}function WP(e,t,r){var n=e.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=_ae(e,t-2,r)),s.body=i||e.read_shift(t-2),typeof i=="string"&&(s.Name=i),s}var hse=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function qP(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=j0(e,o,r);i&32&&(u=hse[u.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var f=n==e.l||l===0||!(d>0)?[]:Cue(e,d,r,l);return{chKey:s,Name:u,itab:c,rgce:f}}function X$(e,t,r){if(r.biff<8)return pse(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(Sae(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function pse(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=iy(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function mse(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),s=j0(e,n,r),o=j0(e,i,r);return[s,o]}function gse(e,t,r){var n=K$(e);e.l++;var i=e.read_shift(1);return t-=8,[Eue(e,t,r),i,n]}function HP(e,t,r){var n=kae(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Aue(e,t,r)]}function xse(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function yse(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=tp(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},l,o,s]}}function bse(e,t,r){return yse(e,t,r)}function vse(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(TS(e));return r}function wse(e){var t=wr(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)G$(e[r],t);return t}function Sse(e,t,r){if(r&&r.biff<8)return kse(e,t,r);var n=Y$(e),i=Cae(e,t-22,n[1]);return{cmo:n,ft:i}}var _se={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function kse(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((_se[n]||zo)(e,t,r)),{cmo:[i,n,s],ft:o}}function jse(e,t,r){var n=e.l,i="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:o=pae(e,6,r);var l=e.read_shift(2);e.read_shift(2),ps(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=j0(e,e.lens[u+1]-e.lens[u]-1);if(i+=f,i.length>=(d?l:2*l))break}if(i.length!==l&&i.length!==l*2)throw new Error("cchText: "+l+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function Ase(e,t){var r=TS(e);e.l+=16;var n=yae(e,t-24);return[r,n]}function Nse(e){var t=wr(24),r=Pa(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return Vs([t,bae(e[1])])}function Cse(e,t){e.read_shift(2);var r=TS(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(nl,""),[r,n]}function Ese(e){var t=e[1].Tooltip,r=wr(10+2*(t.length+1));r.write_shift(2,2048);var n=Pa(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function Tse(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=EP[r]||r,r=e.read_shift(2),t[1]=EP[r]||r,t}function Pse(e){return e||(e=wr(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Ose(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(H$(e));return r}function Mse(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(H$(e));return r}function Lse(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Q$(e,t,r){if(!r.cellStyles)return zo(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s:i,e:s,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function Rse(e,t){var r=wr(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Fse(e,t){var r={};return t<32||(e.l+=16,r.header=Io(e),r.footer=Io(e),e.l+=2),r}function Bse(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}function Ise(e){for(var t=wr(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var Dse=dd,$se=U$,Use=ay;function zse(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function Wse(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=dd(e);++e.l;var i=tp(e,t-7,r);return n.t="str",n.val=i,n}function qse(e){var t=dd(e);++e.l;var r=Io(e);return t.t="n",t.val=r,t}function Hse(e,t,r){var n=wr(15);return cy(n,e,t),n.write_shift(8,r,"f"),n}function Vse(e){var t=dd(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function Gse(e,t,r){var n=wr(9);return cy(n,e,t),n.write_shift(2,r),n}function Kse(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function Yse(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function Xse(e,t,r){var n=e.l+t,i=dd(e),s=e.read_shift(2),o=j0(e,s,r);return e.l=n,i.t="str",i.val=o,i}var Qse=[2,3,48,49,131,139,140,245],H4=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=NS({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],d=fh(1);switch(c.type){case"base64":d=Ql(lc(l));break;case"binary":d=Ql(l);break;case"buffer":case"array":d=l;break}fo(d,0);var f=d.read_shift(1),h=!!(f&136),p=!1,m=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var g=0,y=521;f==2&&(g=d.read_shift(2)),d.l+=3,f!=2&&(g=d.read_shift(4)),g>1048576&&(g=1e6),f!=2&&(y=d.read_shift(2));var b=d.read_shift(2),v=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(v=e[d[d.l]]),d.l+=1,d.l+=2),m&&(d.l+=36);for(var w=[],S={},k=Math.min(d.length,f==2?521:y-10-(p?264:0)),j=m?32:11;d.l<k&&d[d.l]!=13;)switch(S={},S.name=l1.utils.decode(v,d.slice(d.l,d.l+j)).replace(/[\u0000\r\n].*$/g,""),d.l+=j,S.type=String.fromCharCode(d.read_shift(1)),f!=2&&!m&&(S.offset=d.read_shift(4)),S.len=d.read_shift(1),f==2&&(S.offset=d.read_shift(2)),S.dec=d.read_shift(1),S.name.length&&w.push(S),f!=2&&(d.l+=m?13:14),S.type){case"B":(!p||S.len!=8)&&c.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(d[d.l]!==13&&(d.l=y-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=y;var A=0,L=0;for(u[0]=[],L=0;L!=w.length;++L)u[0][L]=w[L].name;for(;g-- >0;){if(d[d.l]===42){d.l+=b;continue}for(++d.l,u[++A]=[],L=0,L=0;L!=w.length;++L){var P=d.slice(d.l,d.l+w[L].len);d.l+=w[L].len,fo(P,0);var F=l1.utils.decode(v,P);switch(w[L].type){case"C":F.trim().length&&(u[A][L]=F.replace(/\s+$/,""));break;case"D":F.length===8?u[A][L]=new Date(+F.slice(0,4),+F.slice(4,6)-1,+F.slice(6,8)):u[A][L]=F;break;case"F":u[A][L]=parseFloat(F.trim());break;case"+":case"I":u[A][L]=m?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(F.trim().toUpperCase()){case"Y":case"T":u[A][L]=!0;break;case"N":case"F":u[A][L]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+F+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[A][L]="##MEMO##"+(m?parseInt(F.trim(),10):P.read_shift(4));break;case"N":F=F.replace(/\u0000/g,"").trim(),F&&F!="."&&(u[A][L]=+F||0);break;case"@":u[A][L]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":u[A][L]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":u[A][L]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[A][L]=-P.read_shift(-8,"f");break;case"B":if(p&&w[L].len==8){u[A][L]=P.read_shift(8,"f");break}case"G":case"P":P.l+=w[L].len;break;case"0":if(w[L].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[L].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=w,u}function n(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=lg(r(l,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function i(l,c){try{return jh(n(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var u=c||{};if(+u.codepage>=0&&fu(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Pl(),f=V2(l,{header:1,raw:!0,cellDates:!0}),h=f[0],p=f.slice(1),m=l["!cols"]||[],g=0,y=0,b=0,v=1;for(g=0;g<h.length;++g){if(((m[g]||{}).DBF||{}).name){h[g]=m[g].DBF.name,++b;continue}if(h[g]!=null){if(++b,typeof h[g]=="number"&&(h[g]=h[g].toString(10)),typeof h[g]!="string")throw new Error("DBF Invalid column name "+h[g]+" |"+typeof h[g]+"|");if(h.indexOf(h[g])!==g){for(y=0;y<1024;++y)if(h.indexOf(h[g]+"_"+y)==-1){h[g]+="_"+y;break}}}}var w=Ni(l["!ref"]),S=[],k=[],j=[];for(g=0;g<=w.e.c-w.s.c;++g){var A="",L="",P=0,F=[];for(y=0;y<p.length;++y)p[y][g]!=null&&F.push(p[y][g]);if(F.length==0||h[g]==null){S[g]="?";continue}for(y=0;y<F.length;++y){switch(typeof F[y]){case"number":L="B";break;case"string":L="C";break;case"boolean":L="L";break;case"object":L=F[y]instanceof Date?"D":"C";break;default:L="C"}P=Math.max(P,String(F[y]).length),A=A&&A!=L?"C":L}P>250&&(P=250),L=((m[g]||{}).DBF||{}).type,L=="C"&&m[g].DBF.len>P&&(P=m[g].DBF.len),A=="B"&&L=="N"&&(A="N",j[g]=m[g].DBF.dec,P=m[g].DBF.len),k[g]=A=="C"||L=="N"?P:s[A]||0,v+=k[g],S[g]=A}var E=d.next(32);for(E.write_shift(4,318902576),E.write_shift(4,p.length),E.write_shift(2,296+32*b),E.write_shift(2,v),g=0;g<4;++g)E.write_shift(4,0);for(E.write_shift(4,0|(+t[$9]||3)<<8),g=0,y=0;g<h.length;++g)if(h[g]!=null){var T=d.next(32),B=(h[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,B,"sbcs"),T.write_shift(1,S[g]=="?"?"C":S[g],"sbcs"),T.write_shift(4,y),T.write_shift(1,k[g]||s[S[g]]||0),T.write_shift(1,j[g]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),y+=k[g]||s[S[g]]||0}var q=d.next(264);for(q.write_shift(4,13),g=0;g<65;++g)q.write_shift(4,0);for(g=0;g<p.length;++g){var U=d.next(v);for(U.write_shift(1,0),y=0;y<h.length;++y)if(h[y]!=null)switch(S[y]){case"L":U.write_shift(1,p[g][y]==null?63:p[g][y]?84:70);break;case"B":U.write_shift(8,p[g][y]||0,"f");break;case"N":var se="0";for(typeof p[g][y]=="number"&&(se=p[g][y].toFixed(j[y]||0)),b=0;b<k[y]-se.length;++b)U.write_shift(1,32);U.write_shift(1,se,"sbcs");break;case"D":p[g][y]?(U.write_shift(4,("0000"+p[g][y].getFullYear()).slice(-4),"sbcs"),U.write_shift(2,("00"+(p[g][y].getMonth()+1)).slice(-2),"sbcs"),U.write_shift(2,("00"+p[g][y].getDate()).slice(-2),"sbcs")):U.write_shift(8,"00000000","sbcs");break;case"C":var de=String(p[g][y]!=null?p[g][y]:"").slice(0,k[y]);for(U.write_shift(1,de,"sbcs"),b=0;b<k[y]-de.length;++b)U.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),J$=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ga(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var m=e[p];return typeof m=="number"?rP(m):m},n=function(h,p,m){var g=p.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return g==59?h:rP(g)};e["|"]=254;function i(h,p){switch(p.type){case"base64":return s(lc(h),p);case"binary":return s(h,p);case"buffer":return s(mi&&Buffer.isBuffer(h)?h.toString("binary"):kh(h),p);case"array":return s(_0(h),p)}throw new Error("Unrecognized type "+p.type)}function s(h,p){var m=h.split(/[\n\r]+/),g=-1,y=-1,b=0,v=0,w=[],S=[],k=null,j={},A=[],L=[],P=[],F=0,E;for(+p.codepage>=0&&fu(+p.codepage);b!==m.length;++b){F=0;var T=m[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),B=T.replace(/;;/g,"\0").split(";").map(function(R){return R.replace(/\u0000/g,";")}),q=B[0],U;if(T.length>0)switch(q){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":B[1].charAt(0)=="P"&&S.push(T.slice(3).replace(/;;/g,";"));break;case"C":var se=!1,de=!1,z=!1,G=!1,ie=-1,Y=-1;for(v=1;v<B.length;++v)switch(B[v].charAt(0)){case"A":break;case"X":y=parseInt(B[v].slice(1))-1,de=!0;break;case"Y":for(g=parseInt(B[v].slice(1))-1,de||(y=0),E=w.length;E<=g;++E)w[E]=[];break;case"K":U=B[v].slice(1),U.charAt(0)==='"'?U=U.slice(1,U.length-1):U==="TRUE"?U=!0:U==="FALSE"?U=!1:isNaN(gu(U))?isNaN(Bm(U).getDate())||(U=xa(U)):(U=gu(U),k!==null&&sg(k)&&(U=ES(U))),se=!0;break;case"E":G=!0;var C=gm(B[v].slice(1),{r:g,c:y});w[g][y]=[w[g][y],C];break;case"S":z=!0,w[g][y]=[w[g][y],"S5S"];break;case"G":break;case"R":ie=parseInt(B[v].slice(1))-1;break;case"C":Y=parseInt(B[v].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+T)}if(se&&(w[g][y]&&w[g][y].length==2?w[g][y][0]=U:w[g][y]=U,k=null),z){if(G)throw new Error("SYLK shared formula cannot have own formula");var K=ie>-1&&w[ie][Y];if(!K||!K[1])throw new Error("SYLK shared formula cannot find base");w[g][y][1]=gU(K[1],{r:g-ie,c:y-Y})}break;case"F":var H=0;for(v=1;v<B.length;++v)switch(B[v].charAt(0)){case"X":y=parseInt(B[v].slice(1))-1,++H;break;case"Y":for(g=parseInt(B[v].slice(1))-1,E=w.length;E<=g;++E)w[E]=[];break;case"M":F=parseInt(B[v].slice(1))/20;break;case"F":break;case"G":break;case"P":k=S[parseInt(B[v].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=B[v].slice(1).split(" "),E=parseInt(P[0],10);E<=parseInt(P[1],10);++E)F=parseInt(P[2],10),L[E-1]=F===0?{hidden:!0}:{wch:F},hh(L[E-1]);break;case"C":y=parseInt(B[v].slice(1))-1,L[y]||(L[y]={});break;case"R":g=parseInt(B[v].slice(1))-1,A[g]||(A[g]={}),F>0?(A[g].hpt=F,A[g].hpx=Dm(F)):F===0&&(A[g].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+T)}H<1&&(k=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+T)}}return A.length>0&&(j["!rows"]=A),L.length>0&&(j["!cols"]=L),p&&p.sheetRows&&(w=w.slice(0,p.sheetRows)),[w,j]}function o(h,p){var m=i(h,p),g=m[0],y=m[1],b=lg(g,p);return Ga(y).forEach(function(v){b[v]=y[v]}),b}function l(h,p){return jh(o(h,p),p)}function c(h,p,m,g){var y="C;Y"+(m+1)+";X"+(g+1)+";K";switch(h.t){case"n":y+=h.v||0,h.f&&!h.F&&(y+=";E"+nC(h.f,{r:m,c:g}));break;case"b":y+=h.v?"TRUE":"FALSE";break;case"e":y+=h.w||h.v;break;case"d":y+='"'+(h.w||h.v)+'"';break;case"s":y+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function u(h,p){p.forEach(function(m,g){var y="F;W"+(g+1)+" "+(g+1)+" ";m.hidden?y+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=g1(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=x1(m.wpx)),typeof m.wch=="number"&&(y+=Math.round(m.wch))),y.charAt(y.length-1)!=" "&&h.push(y)})}function d(h,p){p.forEach(function(m,g){var y="F;";m.hidden?y+="M0;":m.hpt?y+="M"+20*m.hpt+";":m.hpx&&(y+="M"+20*y1(m.hpx)+";"),y.length>2&&h.push(y+"R"+(g+1))})}function f(h,p){var m=["ID;PWXL;N;E"],g=[],y=Ni(h["!ref"]),b,v=Array.isArray(h),w=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),h["!cols"]&&u(m,h["!cols"]),h["!rows"]&&d(m,h["!rows"]),m.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var S=y.s.r;S<=y.e.r;++S)for(var k=y.s.c;k<=y.e.c;++k){var j=Yn({r:S,c:k});b=v?(h[S]||[])[k]:h[j],!(!b||b.v==null&&(!b.f||b.F))&&g.push(c(b,h,S,k))}return m.join(w)+w+g.join(w)+w+"E"+w}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),Z$=function(){function e(s,o){switch(o.type){case"base64":return t(lc(s),o);case"binary":return t(s,o);case"buffer":return t(mi&&Buffer.isBuffer(s)?s.toString("binary"):kh(s),o);case"array":return t(_0(s),o)}throw new Error("Unrecognized type "+o.type)}function t(s,o){for(var l=s.split(`
`),c=-1,u=-1,d=0,f=[];d!==l.length;++d){if(l[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var h=l[d].trim().split(","),p=h[0],m=h[1];++d;for(var g=l[d]||"";(g.match(/["]/g)||[]).length&1&&d<l.length-1;)g+=`
`+l[++d];switch(g=g.trim(),+p){case-1:if(g==="BOT"){f[++c]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?f[c][u]=!0:g==="FALSE"?f[c][u]=!1:isNaN(gu(m))?isNaN(Bm(m).getDate())?f[c][u]=m:f[c][u]=xa(m):f[c][u]=gu(m),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),f[c][u++]=g!==""?g:null;break}if(g==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(s,o){return lg(e(s,o),o)}function n(s,o){return jh(r(s,o),o)}var i=function(){var s=function(c,u,d,f,h){c.push(u),c.push(d+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},o=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=Ni(c["!ref"]),f,h=Array.isArray(c);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,d.e.r-d.s.r+1,""),s(u,"TUPLES",0,d.e.c-d.s.c+1,""),s(u,"DATA",0,0,"");for(var p=d.s.r;p<=d.e.r;++p){o(u,-1,0,"BOT");for(var m=d.s.c;m<=d.e.c;++m){var g=Yn({r:p,c:m});if(f=h?(c[p]||[])[m]:c[g],!f){o(u,1,0,"");continue}switch(f.t){case"n":var y=f.w;!y&&f.v!=null&&(y=f.v),y==null?f.f&&!f.F?o(u,1,0,"="+f.f):o(u,1,0,""):o(u,0,y,"V");break;case"b":o(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Uc(f.z||Gn[14],Ms(xa(f.v)))),o(u,0,f.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var b=`\r
`,v=u.join(b);return v}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),eU=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var p=f.split(`
`),m=-1,g=-1,y=0,b=[];y!==p.length;++y){var v=p[y].trim().split(":");if(v[0]==="cell"){var w=Pa(v[1]);if(b.length<=w.r)for(m=b.length;m<=w.r;++m)b[m]||(b[m]=[]);switch(m=w.r,g=w.c,v[2]){case"t":b[m][g]=e(v[3]);break;case"v":b[m][g]=+v[3];break;case"vtf":var S=v[v.length-1];case"vtc":switch(v[3]){case"nl":b[m][g]=!!+v[4];break;default:b[m][g]=+v[4];break}v[2]=="vtf"&&(b[m][g]=[b[m][g],S])}}}return h&&h.sheetRows&&(b=b.slice(0,h.sheetRows)),b}function n(f,h){return lg(r(f,h),h)}function i(f,h){return jh(n(f,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var h=[],p=[],m,g="",y=Ol(f["!ref"]),b=Array.isArray(f),v=y.s.r;v<=y.e.r;++v)for(var w=y.s.c;w<=y.e.c;++w)if(g=Yn({r:v,c:w}),m=b?(f[v]||[])[w]:f[g],!(!m||m.v==null||m.t==="z")){switch(p=["cell",g,"t"],m.t){case"s":case"str":p.push(t(m.v));break;case"n":m.f?(p[2]="vtf",p[3]="n",p[4]=m.v,p[5]=t(m.f)):(p[2]="v",p[3]=m.v);break;case"b":p[2]="vt"+(m.f?"f":"c"),p[3]="nl",p[4]=m.v?"1":"0",p[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var S=Ms(xa(m.v));p[2]="vtc",p[3]="nd",p[4]=""+S,p[5]=m.w||Uc(m.z||Gn[14],S);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[s,o,l,o,u(f),c].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),Im=function(){function e(d,f,h,p,m){m.raw?f[h][p]=d:d===""||(d==="TRUE"?f[h][p]=!0:d==="FALSE"?f[h][p]=!1:isNaN(gu(d))?isNaN(Bm(d).getDate())?f[h][p]=d:f[h][p]=xa(d):f[h][p]=gu(d))}function t(d,f){var h=f||{},p=[];if(!d||d.length===0)return p;for(var m=d.split(/[\r\n]/),g=m.length-1;g>=0&&m[g].length===0;)--g;for(var y=10,b=0,v=0;v<=g;++v)b=m[v].indexOf(" "),b==-1?b=m[v].length:b++,y=Math.max(y,b);for(v=0;v<=g;++v){p[v]=[];var w=0;for(e(m[v].slice(0,y).trim(),p,v,w,h),w=1;w<=(m[v].length-y)/10+1;++w)e(m[v].slice(y+(w-1)*10,y+w*10).trim(),p,v,w,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var f={},h=!1,p=0,m=0;p<d.length;++p)(m=d.charCodeAt(p))==34?h=!h:!h&&m in r&&(f[m]=(f[m]||0)+1);m=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&m.push([f[p],p]);if(!m.length){f=n;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&m.push([f[p],p])}return m.sort(function(g,y){return g[0]-y[0]||n[g[1]]-n[y[1]]}),r[m.pop()[1]]||44}function s(d,f){var h=f||{},p="",m=h.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(p=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(p=d.charAt(4),d=d.slice(6)):p=i(d.slice(0,1024)):h&&h.FS?p=h.FS:p=i(d.slice(0,1024));var y=0,b=0,v=0,w=0,S=0,k=p.charCodeAt(0),j=!1,A=0,L=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var P=h.dateNF!=null?Bne(h.dateNF):null;function F(){var E=d.slice(w,S),T={};if(E.charAt(0)=='"'&&E.charAt(E.length-1)=='"'&&(E=E.slice(1,-1).replace(/""/g,'"')),E.length===0)T.t="z";else if(h.raw)T.t="s",T.v=E;else if(E.trim().length===0)T.t="s",T.v=E;else if(E.charCodeAt(0)==61)E.charCodeAt(1)==34&&E.charCodeAt(E.length-1)==34?(T.t="s",T.v=E.slice(2,-1).replace(/""/g,'"')):fce(E)?(T.t="n",T.f=E.slice(1)):(T.t="s",T.v=E);else if(E=="TRUE")T.t="b",T.v=!0;else if(E=="FALSE")T.t="b",T.v=!1;else if(!isNaN(v=gu(E)))T.t="n",h.cellText!==!1&&(T.w=E),T.v=v;else if(!isNaN(Bm(E).getDate())||P&&E.match(P)){T.z=h.dateNF||Gn[14];var B=0;P&&E.match(P)&&(E=Ine(E,h.dateNF,E.match(P)||[]),B=1),h.cellDates?(T.t="d",T.v=xa(E,B)):(T.t="n",T.v=Ms(xa(E,B))),h.cellText!==!1&&(T.w=Uc(T.z,T.v instanceof Date?Ms(T.v):T.v)),h.cellNF||delete T.z}else T.t="s",T.v=E;if(T.t=="z"||(h.dense?(m[y]||(m[y]=[]),m[y][b]=T):m[Yn({c:b,r:y})]=T),w=S+1,L=d.charCodeAt(w),g.e.c<b&&(g.e.c=b),g.e.r<y&&(g.e.r=y),A==k)++b;else if(b=0,++y,h.sheetRows&&h.sheetRows<=y)return!0}e:for(;S<d.length;++S)switch(A=d.charCodeAt(S)){case 34:L===34&&(j=!j);break;case k:case 10:case 13:if(!j&&F())break e;break}return S-w>0&&F(),m["!ref"]=oi(g),m}function o(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,f):lg(t(d,f),f)}function l(d,f){var h="",p=f.type=="string"?[0,0,0,0]:dC(d,f);switch(f.type){case"base64":h=lc(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof l1<"u"||(h=mi&&Buffer.isBuffer(d)?d.toString("binary"):kh(d));break;case"array":h=_0(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=Qi(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=Qi(h):f.type=="binary"&&typeof l1<"u",h.slice(0,19)=="socialcalc:version:"?eU.to_sheet(f.type=="string"?h:Qi(h),f):o(h,f)}function c(d,f){return jh(l(d,f),f)}function u(d){for(var f=[],h=Ni(d["!ref"]),p,m=Array.isArray(d),g=h.s.r;g<=h.e.r;++g){for(var y=[],b=h.s.c;b<=h.e.c;++b){var v=Yn({r:g,c:b});if(p=m?(d[g]||[])[b]:d[v],!p||p.v==null){y.push("          ");continue}for(var w=(p.w||(Yd(p),p.w)||"").slice(0,10);w.length<10;)w+=" ";y.push(w+(b===0?" ":""))}f.push(y.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}();function Jse(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=J$.to_workbook(e,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Im.to_workbook(e,t)}}var o0=function(){function e(C,K,H){if(C){fo(C,C.l||0);for(var R=H.Enum||ie;C.l<C.length;){var J=C.read_shift(2),V=R[J]||R[65535],X=C.read_shift(2),Q=C.l+X,ne=V.f&&V.f(C,X,H);if(C.l=Q,K(ne,V,J))return}}}function t(C,K){switch(K.type){case"base64":return r(Ql(lc(C)),K);case"binary":return r(Ql(C),K);case"buffer":case"array":return r(C,K)}throw"Unsupported type "+K.type}function r(C,K){if(!C)return C;var H=K||{},R=H.dense?[]:{},J="Sheet1",V="",X=0,Q={},ne=[],oe=[],O={s:{r:0,c:0},e:{r:0,c:0}},W=H.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)H.Enum=ie,e(C,function(me,Te,Ae){switch(Ae){case 0:H.vers=me,me>=4096&&(H.qpro=!0);break;case 6:O=me;break;case 204:me&&(V=me);break;case 222:V=me;break;case 15:case 51:H.qpro||(me[1].v=me[1].v.slice(1));case 13:case 14:case 16:Ae==14&&(me[2]&112)==112&&(me[2]&15)>1&&(me[2]&15)<15&&(me[1].z=H.dateNF||Gn[14],H.cellDates&&(me[1].t="d",me[1].v=ES(me[1].v))),H.qpro&&me[3]>X&&(R["!ref"]=oi(O),Q[J]=R,ne.push(J),R=H.dense?[]:{},O={s:{r:0,c:0},e:{r:0,c:0}},X=me[3],J=V||"Sheet"+(X+1),V="");var Be=H.dense?(R[me[0].r]||[])[me[0].c]:R[Yn(me[0])];if(Be){Be.t=me[1].t,Be.v=me[1].v,me[1].z!=null&&(Be.z=me[1].z),me[1].f!=null&&(Be.f=me[1].f);break}H.dense?(R[me[0].r]||(R[me[0].r]=[]),R[me[0].r][me[0].c]=me[1]):R[Yn(me[0])]=me[1];break}},H);else if(C[2]==26||C[2]==14)H.Enum=Y,C[2]==14&&(H.qpro=!0,C.l=0),e(C,function(me,Te,Ae){switch(Ae){case 204:J=me;break;case 22:me[1].v=me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(me[3]>X&&(R["!ref"]=oi(O),Q[J]=R,ne.push(J),R=H.dense?[]:{},O={s:{r:0,c:0},e:{r:0,c:0}},X=me[3],J="Sheet"+(X+1)),W>0&&me[0].r>=W)break;H.dense?(R[me[0].r]||(R[me[0].r]=[]),R[me[0].r][me[0].c]=me[1]):R[Yn(me[0])]=me[1],O.e.c<me[0].c&&(O.e.c=me[0].c),O.e.r<me[0].r&&(O.e.r=me[0].r);break;case 27:me[14e3]&&(oe[me[14e3][0]]=me[14e3][1]);break;case 1537:oe[me[0]]=me[1],me[0]==X&&(J=me[1]);break}},H);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(R["!ref"]=oi(O),Q[V||J]=R,ne.push(V||J),!oe.length)return{SheetNames:ne,Sheets:Q};for(var ae={},I=[],Z=0;Z<oe.length;++Z)Q[ne[Z]]?(I.push(oe[Z]||ne[Z]),ae[oe[Z]]=Q[oe[Z]]||Q[ne[Z]]):(I.push(oe[Z]),ae[oe[Z]]={"!ref":"A1"});return{SheetNames:I,Sheets:ae}}function n(C,K){var H=K||{};if(+H.codepage>=0&&fu(+H.codepage),H.type=="string")throw new Error("Cannot write WK1 to JS string");var R=Pl(),J=Ni(C["!ref"]),V=Array.isArray(C),X=[];cn(R,0,s(1030)),cn(R,6,c(J));for(var Q=Math.min(J.e.r,8191),ne=J.s.r;ne<=Q;++ne)for(var oe=os(ne),O=J.s.c;O<=J.e.c;++O){ne===J.s.r&&(X[O]=Ta(O));var W=X[O]+oe,ae=V?(C[ne]||[])[O]:C[W];if(!(!ae||ae.t=="z"))if(ae.t=="n")(ae.v|0)==ae.v&&ae.v>=-32768&&ae.v<=32767?cn(R,13,p(ne,O,ae.v)):cn(R,14,g(ne,O,ae.v));else{var I=Yd(ae);cn(R,15,f(ne,O,I.slice(0,239)))}}return cn(R,1),R.end()}function i(C,K){var H=K||{};if(+H.codepage>=0&&fu(+H.codepage),H.type=="string")throw new Error("Cannot write WK3 to JS string");var R=Pl();cn(R,0,o(C));for(var J=0,V=0;J<C.SheetNames.length;++J)(C.Sheets[C.SheetNames[J]]||{})["!ref"]&&cn(R,27,G(C.SheetNames[J],V++));var X=0;for(J=0;J<C.SheetNames.length;++J){var Q=C.Sheets[C.SheetNames[J]];if(!(!Q||!Q["!ref"])){for(var ne=Ni(Q["!ref"]),oe=Array.isArray(Q),O=[],W=Math.min(ne.e.r,8191),ae=ne.s.r;ae<=W;++ae)for(var I=os(ae),Z=ne.s.c;Z<=ne.e.c;++Z){ae===ne.s.r&&(O[Z]=Ta(Z));var me=O[Z]+I,Te=oe?(Q[ae]||[])[Z]:Q[me];if(!(!Te||Te.t=="z"))if(Te.t=="n")cn(R,23,F(ae,Z,X,Te.v));else{var Ae=Yd(Te);cn(R,22,A(ae,Z,X,Ae.slice(0,239)))}}++X}}return cn(R,1),R.end()}function s(C){var K=wr(2);return K.write_shift(2,C),K}function o(C){var K=wr(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var H=0,R=0,J=0,V=0;V<C.SheetNames.length;++V){var X=C.SheetNames[V],Q=C.Sheets[X];if(!(!Q||!Q["!ref"])){++J;var ne=Ol(Q["!ref"]);H<ne.e.r&&(H=ne.e.r),R<ne.e.c&&(R=ne.e.c)}}return H>8191&&(H=8191),K.write_shift(2,H),K.write_shift(1,J),K.write_shift(1,R),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function l(C,K,H){var R={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&H.qpro?(R.s.c=C.read_shift(1),C.l++,R.s.r=C.read_shift(2),R.e.c=C.read_shift(1),C.l++,R.e.r=C.read_shift(2),R):(R.s.c=C.read_shift(2),R.s.r=C.read_shift(2),K==12&&H.qpro&&(C.l+=2),R.e.c=C.read_shift(2),R.e.r=C.read_shift(2),K==12&&H.qpro&&(C.l+=2),R.s.c==65535&&(R.s.c=R.e.c=R.s.r=R.e.r=0),R)}function c(C){var K=wr(8);return K.write_shift(2,C.s.c),K.write_shift(2,C.s.r),K.write_shift(2,C.e.c),K.write_shift(2,C.e.r),K}function u(C,K,H){var R=[{c:0,r:0},{t:"n",v:0},0,0];return H.qpro&&H.vers!=20768?(R[0].c=C.read_shift(1),R[3]=C.read_shift(1),R[0].r=C.read_shift(2),C.l+=2):(R[2]=C.read_shift(1),R[0].c=C.read_shift(2),R[0].r=C.read_shift(2)),R}function d(C,K,H){var R=C.l+K,J=u(C,K,H);if(J[1].t="s",H.vers==20768){C.l++;var V=C.read_shift(1);return J[1].v=C.read_shift(V,"utf8"),J}return H.qpro&&C.l++,J[1].v=C.read_shift(R-C.l,"cstr"),J}function f(C,K,H){var R=wr(7+H.length);R.write_shift(1,255),R.write_shift(2,K),R.write_shift(2,C),R.write_shift(1,39);for(var J=0;J<R.length;++J){var V=H.charCodeAt(J);R.write_shift(1,V>=128?95:V)}return R.write_shift(1,0),R}function h(C,K,H){var R=u(C,K,H);return R[1].v=C.read_shift(2,"i"),R}function p(C,K,H){var R=wr(7);return R.write_shift(1,255),R.write_shift(2,K),R.write_shift(2,C),R.write_shift(2,H,"i"),R}function m(C,K,H){var R=u(C,K,H);return R[1].v=C.read_shift(8,"f"),R}function g(C,K,H){var R=wr(13);return R.write_shift(1,255),R.write_shift(2,K),R.write_shift(2,C),R.write_shift(8,H,"f"),R}function y(C,K,H){var R=C.l+K,J=u(C,K,H);if(J[1].v=C.read_shift(8,"f"),H.qpro)C.l=R;else{var V=C.read_shift(2);S(C.slice(C.l,C.l+V),J),C.l+=V}return J}function b(C,K,H){var R=K&32768;return K&=-32769,K=(R?C:0)+(K>=8192?K-16384:K),(R?"":"$")+(H?Ta(K):os(K))}var v={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(C,K){fo(C,0);for(var H=[],R=0,J="",V="",X="",Q="";C.l<C.length;){var ne=C[C.l++];switch(ne){case 0:H.push(C.read_shift(8,"f"));break;case 1:V=b(K[0].c,C.read_shift(2),!0),J=b(K[0].r,C.read_shift(2),!1),H.push(V+J);break;case 2:{var oe=b(K[0].c,C.read_shift(2),!0),O=b(K[0].r,C.read_shift(2),!1);V=b(K[0].c,C.read_shift(2),!0),J=b(K[0].r,C.read_shift(2),!1),H.push(oe+O+":"+V+J)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:H.push("("+H.pop()+")");break;case 5:H.push(C.read_shift(2));break;case 6:{for(var W="";ne=C[C.l++];)W+=String.fromCharCode(ne);H.push('"'+W.replace(/"/g,'""')+'"')}break;case 8:H.push("-"+H.pop());break;case 23:H.push("+"+H.pop());break;case 22:H.push("NOT("+H.pop()+")");break;case 20:case 21:Q=H.pop(),X=H.pop(),H.push(["AND","OR"][ne-20]+"("+X+","+Q+")");break;default:if(ne<32&&w[ne])Q=H.pop(),X=H.pop(),H.push(X+w[ne]+Q);else if(v[ne]){if(R=v[ne][1],R==69&&(R=C[C.l++]),R>H.length){console.error("WK1 bad formula parse 0x"+ne.toString(16)+":|"+H.join("|")+"|");return}var ae=H.slice(-R);H.length-=R,H.push(v[ne][0]+"("+ae.join(",")+")")}else return ne<=7?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=24?console.error("WK1 unsupported op "+ne.toString(16)):ne<=30?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=115?console.error("WK1 unsupported function opcode "+ne.toString(16)):console.error("WK1 unrecognized opcode "+ne.toString(16))}}H.length==1?K[1].f=""+H[0]:console.error("WK1 bad formula parse |"+H.join("|")+"|")}function k(C){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=C.read_shift(2),K[3]=C[C.l++],K[0].c=C[C.l++],K}function j(C,K){var H=k(C);return H[1].t="s",H[1].v=C.read_shift(K-4,"cstr"),H}function A(C,K,H,R){var J=wr(6+R.length);J.write_shift(2,C),J.write_shift(1,H),J.write_shift(1,K),J.write_shift(1,39);for(var V=0;V<R.length;++V){var X=R.charCodeAt(V);J.write_shift(1,X>=128?95:X)}return J.write_shift(1,0),J}function L(C,K){var H=k(C);H[1].v=C.read_shift(2);var R=H[1].v>>1;if(H[1].v&1)switch(R&7){case 0:R=(R>>3)*5e3;break;case 1:R=(R>>3)*500;break;case 2:R=(R>>3)/20;break;case 3:R=(R>>3)/200;break;case 4:R=(R>>3)/2e3;break;case 5:R=(R>>3)/2e4;break;case 6:R=(R>>3)/16;break;case 7:R=(R>>3)/64;break}return H[1].v=R,H}function P(C,K){var H=k(C),R=C.read_shift(4),J=C.read_shift(4),V=C.read_shift(2);if(V==65535)return R===0&&J===3221225472?(H[1].t="e",H[1].v=15):R===0&&J===3489660928?(H[1].t="e",H[1].v=42):H[1].v=0,H;var X=V&32768;return V=(V&32767)-16446,H[1].v=(1-X*2)*(J*Math.pow(2,V+32)+R*Math.pow(2,V)),H}function F(C,K,H,R){var J=wr(14);if(J.write_shift(2,C),J.write_shift(1,H),J.write_shift(1,K),R==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var V=0,X=0,Q=0,ne=0;return R<0&&(V=1,R=-R),X=Math.log2(R)|0,R/=Math.pow(2,X-31),ne=R>>>0,ne&2147483648||(R/=2,++X,ne=R>>>0),R-=ne,ne|=2147483648,ne>>>=0,R*=Math.pow(2,32),Q=R>>>0,J.write_shift(4,Q),J.write_shift(4,ne),X+=16383+(V?32768:0),J.write_shift(2,X),J}function E(C,K){var H=P(C);return C.l+=K-14,H}function T(C,K){var H=k(C),R=C.read_shift(4);return H[1].v=R>>6,H}function B(C,K){var H=k(C),R=C.read_shift(8,"f");return H[1].v=R,H}function q(C,K){var H=B(C);return C.l+=K-10,H}function U(C,K){return C[C.l+K-1]==0?C.read_shift(K,"cstr"):""}function se(C,K){var H=C[C.l++];H>K-1&&(H=K-1);for(var R="";R.length<H;)R+=String.fromCharCode(C[C.l++]);return R}function de(C,K,H){if(!(!H.qpro||K<21)){var R=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var J=C.read_shift(K-21,"cstr");return[R,J]}}function z(C,K){for(var H={},R=C.l+K;C.l<R;){var J=C.read_shift(2);if(J==14e3){for(H[J]=[0,""],H[J][0]=C.read_shift(2);C[C.l];)H[J][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return H}function G(C,K){var H=wr(5+C.length);H.write_shift(2,14e3),H.write_shift(2,K);for(var R=0;R<C.length;++R){var J=C.charCodeAt(R);H[H.l++]=J>127?95:J}return H[H.l++]=0,H}var ie={0:{n:"BOF",f:ps},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:U},222:{n:"SHEETNAMELP",f:se},65535:{n:""}},Y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:j},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:L},25:{n:"FORMULA19",f:E},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:z},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:B},40:{n:"FORMULA28",f:q},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:U},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:de},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function Zse(e){var t={},r=e.match(qo),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Xn(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=C3[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var eoe=function(){var e=d1("t"),t=d1("rPr");function r(s){var o=s.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:Ai(o[1])},c=s.match(t);return c&&(l.s=Zse(c[1])),l}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(l){return l.v})}}(),toe=function(){var t=/(\r\n|\n)/g;function r(i,s,o){var l=[];i.u&&l.push("text-decoration: underline;"),i.uval&&l.push("text-underline-style:"+i.uval+";"),i.sz&&l.push("font-size:"+i.sz+"pt;"),i.outline&&l.push("text-effect: outline;"),i.shadow&&l.push("text-shadow: auto;"),s.push('<span style="'+l.join("")+'">'),i.b&&(s.push("<b>"),o.push("</b>")),i.i&&(s.push("<i>"),o.push("</i>")),i.strike&&(s.push("<s>"),o.push("</s>"));var c=i.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),roe=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,noe=/<(?:\w+:)?r>/,ioe=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function J3(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ai(Qi(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Qi(e),r&&(n.h=I3(n.t))):e.match(noe)&&(n.r=Qi(e),n.t=Ai(Qi((e.replace(ioe,"").match(roe)||[]).join("").replace(qo,""))),r&&(n.h=toe(eoe(n.r)))),n):{t:""}}var aoe=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,soe=/<(?:\w+:)?(?:si|sstItem)>/g,ooe=/<\/(?:\w+:)?(?:si|sstItem)>/;function loe(e,t){var r=[],n="";if(!e)return r;var i=e.match(aoe);if(i){n=i[2].replace(soe,"").split(ooe);for(var s=0;s!=n.length;++s){var o=J3(n[s].trim(),t);o!=null&&(r[r.length]=o)}i=Xn(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var coe=/^\s|\s$|[\t\n\r]/;function tU(e,t){if(!t.bookSST)return"";var r=[ls];r[r.length]=ln("sst",null,{xmlns:X0[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(coe)&&(s+=' xml:space="preserve"'),s+=">"+Vi(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function uoe(e){return[e.read_shift(4),e.read_shift(4)]}function doe(e,t){var r=[],n=!1;return uf(e,function(s,o,l){switch(l){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function foe(e,t){return t||(t=wr(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var hoe=_ie;function poe(e){var t=Pl();Br(t,159,foe(e));for(var r=0;r<e.length;++r)Br(t,19,hoe(e[r]));return Br(t,160),t.end()}function rU(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Ud(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function moe(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Ud(e,4),t.U=Ud(e,4),t.W=Ud(e,4),t}function goe(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function xoe(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(goe(e));return t}function yoe(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function boe(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Ud(e,4),t.U=Ud(e,4),t.W=Ud(e,4),t}function voe(e){var t=boe(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function nU(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function iU(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function woe(e){var t=Ud(e);switch(t.Minor){case 2:return[t.Minor,Soe(e)];case 3:return[t.Minor,_oe()];case 4:return[t.Minor,koe(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Soe(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=nU(e,r),i=iU(e,e.length-e.l);return{t:"Std",h:n,v:i}}function _oe(){throw new Error("File is password-protected: ECMA-376 Extensible")}function koe(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(qo,function(s){var o=Xn(s);switch(ud(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function joe(e,t){var r={},n=r.EncryptionVersionInfo=Ud(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=nU(e,i),t-=i,r.EncryptionVerifier=iU(e,t),r}function Aoe(e){var t={},r=t.EncryptionVersionInfo=Ud(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Z3(e){var t=0,r,n=rU(e),i=n.length+1,s,o,l,c,u;for(r=fh(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)o=r[s],l=t&16384?1:0,c=t<<1&32767,u=l|c,t=u^o;return t^52811}var aU=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,l){return n(o^l)},s=function(o){for(var l=t[o.length-1],c=104,u=o.length-1;u>=0;--u)for(var d=o[u],f=0;f!=7;++f)d&64&&(l^=r[c]),d*=2,--c;return l};return function(o){for(var l=rU(o),c=s(l),u=l.length,d=fh(16),f=0;f!=16;++f)d[f]=0;var h,p,m;for((u&1)===1&&(h=c>>8,d[u]=i(e[0],h),--u,h=c&255,p=l[l.length-1],d[u]=i(p,h));u>0;)--u,h=c>>8,d[u]=i(l[u],h),--u,h=c&255,d[u]=i(l[u],h);for(u=15,m=15-l.length;m>0;)h=c>>8,d[u]=i(e[m],h),--u,--m,h=c&255,d[u]=i(l[u],h),--u,--m;return d}}(),Noe=function(e,t,r,n,i){i||(i=t),n||(n=aU(e));var s,o;for(s=0;s!=t.length;++s)o=t[s],o^=n[r],o=(o>>5|o<<3)&255,i[s]=o,++r;return[i,r,n]},Coe=function(e){var t=0,r=aU(e);return function(n){var i=Noe("",n,t,r);return t=i[1],i[0]}};function Eoe(e,t,r,n){var i={key:ps(e),verificationBytes:ps(e)};return r.password&&(i.verifier=Z3(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=Coe(r.password)),i}function Toe(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Aoe(e):n.Data=joe(e,t),n}function Poe(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Toe(e,t-2,n):Eoe(e,r.biff>=8?t:t-2,r,n),n}var sU=function(){function e(i,s){switch(s.type){case"base64":return t(lc(i),s);case"binary":return t(i,s);case"buffer":return t(mi&&Buffer.isBuffer(i)?i.toString("binary"):kh(i),s);case"array":return t(_0(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var o=s||{},l=o.dense?[]:{},c=i.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(l)&&(l[f]=[]);for(var h=/\\\w+\b/g,p=0,m,g=-1;m=h.exec(d);){switch(m[0]){case"\\cell":var y=d.slice(p,h.lastIndex-m[0].length);if(y[0]==" "&&(y=y.slice(1)),++g,y.length){var b={v:y,t:"s"};Array.isArray(l)?l[f][g]=b:l[Yn({r:f,c:g})]=b}break}p=h.lastIndex}g>u.e.c&&(u.e.c=g)}),l["!ref"]=oi(u),l}function r(i,s){return jh(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],o=Ni(i["!ref"]),l,c=Array.isArray(i),u=o.s.r;u<=o.e.r;++u){s.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var f=Yn({r:u,c:d});l=c?(i[u]||[])[d]:i[f],!(!l||l.v==null&&(!l.f||l.F))&&(s.push(" "+(l.w||(Yd(l),l.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Ooe(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function m1(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Moe(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),s=Math.min(t,r,n),o=i-s;if(o===0)return[0,0,t];var l=0,c=0,u=i+s;switch(c=o/(u>1?2-u:u),i){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4;break}return[l/6,c,u/2]}function Loe(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),s=n-i/2,o=[s,s,s],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=i*l,o[0]+=i,o[1]+=c;break;case 1:c=i*(2-l),o[0]+=c,o[1]+=i;break;case 2:c=i*(l-2),o[1]+=i,o[2]+=c;break;case 3:c=i*(4-l),o[1]+=c,o[2]+=i;break;case 4:c=i*(l-4),o[2]+=i,o[0]+=c;break;case 5:c=i*(6-l),o[2]+=c,o[0]+=i;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function q2(e,t){if(t===0)return e;var r=Moe(Ooe(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),m1(Loe(r))}var oU=6,Roe=15,Foe=1,Ro=oU;function g1(e){return Math.floor((e+Math.round(128/Ro)/256)*Ro)}function x1(e){return Math.floor((e-5)/Ro*100+.5)/100}function H2(e){return Math.round((e*Ro+5)/Ro*256)/256}function tk(e){return H2(x1(g1(e)))}function eC(e){var t=Math.abs(e-tk(e)),r=Ro;if(t>.005)for(Ro=Foe;Ro<Roe;++Ro)Math.abs(e-tk(e))<=t&&(t=Math.abs(e-tk(e)),r=Ro);Ro=r}function hh(e){e.width?(e.wpx=g1(e.width),e.wch=x1(e.wpx),e.MDW=Ro):e.wpx?(e.wch=x1(e.wpx),e.width=H2(e.wch),e.MDW=Ro):typeof e.wch=="number"&&(e.width=H2(e.wch),e.wpx=g1(e.width),e.MDW=Ro),e.customWidth&&delete e.customWidth}var Boe=96,lU=Boe;function y1(e){return e*96/lU}function Dm(e){return e*lU/96}var Ioe={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Doe(e,t,r,n){t.Borders=[];var i={},s=!1;(e[0].match(qo)||[]).forEach(function(o){var l=Xn(o);switch(ud(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},l.diagonalUp&&(i.diagonalUp=pa(l.diagonalUp)),l.diagonalDown&&(i.diagonalDown=pa(l.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in borders")}})}function $oe(e,t,r,n){t.Fills=[];var i={},s=!1;(e[0].match(qo)||[]).forEach(function(o){var l=Xn(o);switch(ud(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":l.patternType&&(i.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),l.indexed&&(i.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(i.bgColor.theme=parseInt(l.theme,10)),l.tint&&(i.bgColor.tint=parseFloat(l.tint)),l.rgb&&(i.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),l.theme&&(i.fgColor.theme=parseInt(l.theme,10)),l.tint&&(i.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(i.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fills")}})}function Uoe(e,t,r,n){t.Fonts=[];var i={},s=!1;(e[0].match(qo)||[]).forEach(function(o){var l=Xn(o);switch(ud(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":l.val&&(i.name=Qi(l.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=l.val?pa(l.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=l.val?pa(l.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(l.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=l.val?pa(l.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=l.val?pa(l.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=l.val?pa(l.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=l.val?pa(l.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=l.val?pa(l.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":l.val&&(i.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(i.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(i.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(i.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=C3[parseInt(l.val,10)];break;case"<color":if(i.color||(i.color={}),l.auto&&(i.color.auto=pa(l.auto)),l.rgb)i.color.rgb=l.rgb.slice(-6);else if(l.indexed){i.color.index=parseInt(l.indexed,10);var c=a0[i.color.index];i.color.index==81&&(c=a0[1]),c||(c=a0[1]),i.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(i.color.theme=parseInt(l.theme,10),l.tint&&(i.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=q2(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fonts")}})}function zoe(e,t,r){t.NumberFmt=[];for(var n=Ga(Gn),i=0;i<n.length;++i)t.NumberFmt[n[i]]=Gn[n[i]];var s=e[0].match(qo);if(s)for(i=0;i<s.length;++i){var o=Xn(s[i]);switch(ud(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=Ai(Qi(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}$d(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function Woe(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=ln("numFmt",null,{numFmtId:n,formatCode:Vi(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ln("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Cb=["numFmtId","fillId","fontId","borderId","xfId"],Eb=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function qoe(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(qo)||[]).forEach(function(s){var o=Xn(s),l=0;switch(ud(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<Cb.length;++l)n[Cb[l]]&&(n[Cb[l]]=parseInt(n[Cb[l]],10));for(l=0;l<Eb.length;++l)n[Eb[l]]&&(n[Eb[l]]=pa(n[Eb[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=pa(o.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function Hoe(e){var t=[];return t[t.length]=ln("cellXfs",null),e.forEach(function(r){t[t.length]=ln("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ln("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Voe=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(t))&&zoe(f,d,u),(f=l.match(i))&&Uoe(f,d,c,u),(f=l.match(n))&&$oe(f,d,c,u),(f=l.match(s))&&Doe(f,d,c,u),(f=l.match(r))&&qoe(f,d,u),d}}();function cU(e,t){var r=[ls,ln("styleSheet",null,{xmlns:X0[0],"xmlns:vt":Ps.vt})],n;return e.SSF&&(n=Woe(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Hoe(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Goe(e,t){var r=e.read_shift(2),n=Do(e);return[r,n]}function Koe(e,t,r){r||(r=wr(6+4*t.length)),r.write_shift(2,e),Gs(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Yoe(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=Tie(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=Eie(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Do(e),n}function Xoe(e,t){t||(t=wr(25+4*32)),t.write_shift(2,e.sz*20),Pie(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),U2(e.color,t);var n=0;return n=2,t.write_shift(1,n),Gs(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Qoe=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],rk,Joe=zo;function VP(e,t){t||(t=wr(4*3+8*7+16*1)),rk||(rk=NS(Qoe));var r=rk[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(U2({auto:1},t),U2({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Zoe(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function uU(e,t,r){r||(r=wr(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Wg(e,t){return t||(t=wr(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var ele=zo;function tle(e,t){return t||(t=wr(51)),t.write_shift(1,0),Wg(null,t),Wg(null,t),Wg(null,t),Wg(null,t),Wg(null,t),t.length>t.l?t.slice(0,t.l):t}function rle(e,t){return t||(t=wr(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),$2(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function nle(e,t,r){var n=wr(2052);return n.write_shift(4,e),$2(t,n),$2(r,n),n.length>n.l?n.slice(0,n.l):n}function ile(e,t,r){var n={};n.NumberFmt=[];for(var i in Gn)n.NumberFmt[i]=Gn[i];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return uf(e,function(c,u,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],$d(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=q2(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(d),o=!0;break;case 38:s.pop(),o=!1;break;default:if(u.T>0)s.push(d);else if(u.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function ale(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(Br(e,615,xu(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Br(e,44,Koe(i,t[i]))}),Br(e,616))}}function sle(e){var t=1;Br(e,611,xu(t)),Br(e,43,Xoe({sz:12,color:{theme:1},name:"Calibri",family:2})),Br(e,612)}function ole(e){var t=2;Br(e,603,xu(t)),Br(e,45,VP({patternType:"none"})),Br(e,45,VP({patternType:"gray125"})),Br(e,604)}function lle(e){var t=1;Br(e,613,xu(t)),Br(e,46,tle()),Br(e,614)}function cle(e){var t=1;Br(e,626,xu(t)),Br(e,47,uU({numFmtId:0},65535)),Br(e,627)}function ule(e,t){Br(e,617,xu(t.length)),t.forEach(function(r){Br(e,47,uU(r,0))}),Br(e,618)}function dle(e){var t=1;Br(e,619,xu(t)),Br(e,48,rle({xfId:0,name:"Normal"})),Br(e,620)}function fle(e){var t=0;Br(e,505,xu(t)),Br(e,506)}function hle(e){var t=0;Br(e,508,nle(t,"TableStyleMedium9","PivotStyleMedium4")),Br(e,509)}function ple(e,t){var r=Pl();return Br(r,278),ale(r,e.SSF),sle(r),ole(r),lle(r),cle(r),ule(r,t.cellXfs),dle(r),fle(r),hle(r),Br(r,279),r.end()}var mle=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function gle(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(qo)||[]).forEach(function(i){var s=Xn(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[mle.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function xle(){}function yle(){}var ble=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,vle=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,wle=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Sle(e,t,r){t.themeElements={};var n;[["clrScheme",ble,gle],["fontScheme",vle,xle],["fmtScheme",wle,yle]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var _le=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function dU(e,t){(!e||e.length===0)&&(e=tC());var r,n={};if(!(r=e.match(_le)))throw new Error("themeElements not found in theme");return Sle(r[0],n,t),n.raw=e,n}function tC(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[ls];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function kle(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var o;try{o=n$(s,{type:"array"})}catch{return}var l=Jl(o,"theme/theme/theme1.xml",!0);if(l)return dU(l,r)}}function jle(e){return e.read_shift(4)}function Ale(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Nle(e,4);break;case 2:t.xclrValue=q$(e);break;case 3:t.xclrValue=jle(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Nle(e,t){return zo(e,t)}function Cle(e,t){return zo(e,t)}function Ele(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Ale(e);break;case 6:n[1]=Cle(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Tle(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(Ele(e,r-e.l));return{ixfe:n,ext:s}}function Ple(e,t){t.forEach(function(r){switch(r[0]){}})}function Ole(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Do(e)}}function Mle(e){var t=wr(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Gs(e.name,t),t.slice(0,t.l)}function Lle(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Rle(e){var t=wr(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Fle(e,t){var r=wr(8+2*t.length);return r.write_shift(4,e),Gs(t,r),r.slice(0,r.l)}function Ble(e){return e.l+=4,e.read_shift(4)!=0}function Ile(e,t){var r=wr(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Dle(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],o=!1,l=2;return uf(e,function(c,u,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):l==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:s.push(d),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!u.T){if(!o||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function $le(){var e=Pl();return Br(e,332),Br(e,334,xu(1)),Br(e,335,Mle({name:"XLDAPR",version:12e4,flags:3496657072})),Br(e,336),Br(e,339,Fle(1,"XLDAPR")),Br(e,52),Br(e,35,xu(514)),Br(e,4096,xu(0)),Br(e,4097,Pc(1)),Br(e,36),Br(e,53),Br(e,340),Br(e,337,Ile(1)),Br(e,51,Rle([[1,0]])),Br(e,338),Br(e,333),e.end()}function Ule(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,s=2,o;return e.replace(qo,function(l){var c=Xn(l);switch(ud(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(o=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function fU(){var e=[ls];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function zle(e){var t=[];if(!e)return t;var r=1;return(e.match(qo)||[]).forEach(function(n){var i=Xn(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function Wle(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Yn(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function qle(e,t,r){var n=[];return uf(e,function(s,o,l){switch(l){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function Hle(e,t,r,n){if(!e)return e;var i=n||{},s=!1;uf(e,function(l,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},i)}function Vle(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var em=1024;function hU(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[ln("xml",null,{"xmlns:v":Yl.v,"xmlns:o":Yl.o,"xmlns:x":Yl.x,"xmlns:mv":Yl.mv}).replace(/\/>/,">"),ln("o:shapelayout",ln("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ln("v:shapetype",[ln("v:stroke",null,{joinstyle:"miter"}),ln("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];em<e*1e3;)em+=1e3;return t.forEach(function(s){var o=Pa(s[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?ln("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=ln("v:fill",c,l),d={on:"t",obscured:"t"};++em,i=i.concat(["<v:shape"+f1({id:"_x0000_s"+em,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,ln("v:shadow",null,d),ln("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ho("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),ho("x:AutoFill","False"),ho("x:Row",String(o.r)),ho("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function GP(e,t,r,n){var i=Array.isArray(e),s;t.forEach(function(o){var l=Pa(o.ref);if(i?(e[l.r]||(e[l.r]=[]),s=e[l.r][l.c]):s=e[o.ref],!s){s={t:"z"},i?e[l.r][l.c]=s:e[o.ref]=s;var c=Ni(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=oi(c);u!==e["!ref"]&&(e["!ref"]=u)}s.c||(s.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}s.c.push(d)})}function Gle(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Xn(l[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=Pa(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&J3(f[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),n.push(u)}}}}),n}function pU(e){var t=[ls,ln("comments",null,{xmlns:X0[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var s=Vi(i.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(i=r.indexOf(Vi(c.a))),s.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(ho("t",Vi(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,l=1;l<s.length;++l)o+=`Reply:
    `+s[l]+`
`;t.push(ho("t",Vi(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Kle(e,t){var r=[],n=!1,i={},s=0;return e.replace(qo,function(l,c){var u=Xn(l);switch(ud(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=c+l.length;break;case"</text>":i.t=e.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function Yle(e,t,r){var n=[ls,ln("ThreadedComments",null,{xmlns:Ps.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?s=c.id:c.parentId=s,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(ln("threadedComment",ho("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function Xle(e,t){var r=[],n=!1;return e.replace(qo,function(s){var o=Xn(s);switch(ud(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function Qle(e){var t=[ls,ln("personList",null,{xmlns:Ps.TCMNT,"xmlns:x":X0[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(ln("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Jle(e){var t={};t.iauthor=e.read_shift(4);var r=ep(e);return t.rfx=r.s,t.ref=Yn(r.s),e.l+=16,t}function Zle(e,t){return t==null&&(t=wr(36)),t.write_shift(4,e[1].iauthor),cg(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var ece=Do;function tce(e){return Gs(e.slice(0,54))}function rce(e,t){var r=[],n=[],i={},s=!1;return uf(e,function(l,c,u){switch(u){case 632:n.push(l);break;case 635:i=l;break;case 637:i.t=l.t,i.h=l.h,i.r=l.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function nce(e){var t=Pl(),r=[];return Br(t,628),Br(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),Br(t,632,tce(i.a)))})}),Br(t,631),Br(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Pa(n[0]),e:Pa(n[0])};Br(t,635,Zle([s,i])),i.t&&i.t.length>0&&Br(t,637,jie(i)),Br(t,636),delete i.iauthor})}),Br(t,634),Br(t,629),t.end()}var ice="application/vnd.ms-office.vbaProject";function ace(e){var t=Wn.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Wn.utils.cfb_add(t,i,e.FileIndex[n].content)}}),Wn.write(t)}function sce(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Wn.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var mU=["xlsb","xlsm","xlam","biff8","xla"];function oce(){return{"!type":"dialog"}}function lce(){return{"!type":"dialog"}}function cce(){return{"!type":"macro"}}function uce(){return{"!type":"macro"}}var gm=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,o){var l=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=t.c:--d,c?u+=t.r:--u,i+(l?"":"$")+Ta(d)+(c?"":"$")+os(u)}return function(i,s){return t=s,i.replace(e,r)}}(),rC=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,nC=function(){return function(t,r){return t.replace(rC,function(n,i,s,o,l,c){var u=W3(o)-(s?0:r.c),d=z3(c)-(l?0:r.r),f=d==0?"":l?d+1:"["+d+"]",h=u==0?"":s?u+1:"["+u+"]";return i+"R"+f+"C"+h})}}();function gU(e,t){return e.replace(rC,function(r,n,i,s,o,l){return n+(i=="$"?i+s:Ta(W3(s)+t.c))+(o=="$"?o+l:os(z3(l)+t.r))})}function dce(e,t,r){var n=Ol(t),i=n.s,s=Pa(r),o={r:s.r-i.r,c:s.c-i.c};return gU(e,o)}function fce(e){return e.length!=1}function KP(e){return e.replace(/_xlfn\./g,"")}function us(e){e.l+=1}function ph(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function xU(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return yU(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),o=ph(e),l=ph(e);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function yU(e){var t=ph(e),r=ph(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function hce(e,t,r){if(r.biff<8)return yU(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=ph(e),o=ph(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function bU(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return pce(e);var n=e.read_shift(r&&r.biff==12?4:2),i=ph(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function pce(e){var t=ph(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function mce(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function gce(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return xce(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:l}}function xce(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function yce(e,t,r){var n=(e[e.l++]&96)>>5,i=xU(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function bce(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=xU(e,s,r);return[n,i,o]}function vce(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function wce(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function Sce(e,t,r){var n=(e[e.l++]&96)>>5,i=hce(e,t-1,r);return[n,i]}function _ce(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function YP(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function kce(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function jce(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Ace(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Nce(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Cce(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function vU(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Ece(e){return e.read_shift(2),vU(e)}function Tce(e){return e.read_shift(2),vU(e)}function Pce(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=bU(e,0,r);return[n,i]}function Oce(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=gce(e,0,r);return[n,i]}function Mce(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=bU(e,0,r);return[n,i,s]}function Lce(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[Bue[i],_U[i],n]}function Rce(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Fce(e);return[i,(s[0]===0?_U:Fue)[s[1]]]}function Fce(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Bce(e,t,r){e.l+=r&&r.biff==2?3:4}function Ice(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function Dce(e){return e.l++,df[e.read_shift(1)]}function $ce(e){return e.l++,e.read_shift(2)}function Uce(e){return e.l++,e.read_shift(1)!==0}function zce(e){return e.l++,Io(e)}function Wce(e,t,r){return e.l++,iy(e,t-1,r)}function qce(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Za(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=df[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Io(e);break;case 2:r[1]=tp(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Hce(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?ep:TS)(e));return i}function Vce(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var l=0;l!=i;++l)o[s][l]=qce(e,r.biff);return o}function Gce(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function Kce(e,t,r){if(r.biff==5)return Yce(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function Yce(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function Xce(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function Qce(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function Jce(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Zce(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var eue=zo,tue=zo,rue=zo;function sy(e,t,r){return e.l+=2,[mce(e)]}function iC(e){return e.l+=6,[]}var nue=sy,iue=iC,aue=iC,sue=sy;function wU(e){return e.l+=2,[ps(e),e.read_shift(2)&1]}var oue=sy,lue=wU,cue=iC,uue=sy,due=sy,fue=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function hue(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),o=fue[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:i,C:s}}function pue(e){return e.l+=2,[e.read_shift(4)]}function mue(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function gue(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function xue(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function yue(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function bue(e){return e.l+=4,[0,0]}var XP={1:{n:"PtgExp",f:Ice},2:{n:"PtgTbl",f:rue},3:{n:"PtgAdd",f:us},4:{n:"PtgSub",f:us},5:{n:"PtgMul",f:us},6:{n:"PtgDiv",f:us},7:{n:"PtgPower",f:us},8:{n:"PtgConcat",f:us},9:{n:"PtgLt",f:us},10:{n:"PtgLe",f:us},11:{n:"PtgEq",f:us},12:{n:"PtgGe",f:us},13:{n:"PtgGt",f:us},14:{n:"PtgNe",f:us},15:{n:"PtgIsect",f:us},16:{n:"PtgUnion",f:us},17:{n:"PtgRange",f:us},18:{n:"PtgUplus",f:us},19:{n:"PtgUminus",f:us},20:{n:"PtgPercent",f:us},21:{n:"PtgParen",f:us},22:{n:"PtgMissArg",f:us},23:{n:"PtgStr",f:Wce},26:{n:"PtgSheet",f:mue},27:{n:"PtgEndSheet",f:gue},28:{n:"PtgErr",f:Dce},29:{n:"PtgBool",f:Uce},30:{n:"PtgInt",f:$ce},31:{n:"PtgNum",f:zce},32:{n:"PtgArray",f:_ce},33:{n:"PtgFunc",f:Lce},34:{n:"PtgFuncVar",f:Rce},35:{n:"PtgName",f:Gce},36:{n:"PtgRef",f:Pce},37:{n:"PtgArea",f:yce},38:{n:"PtgMemArea",f:Xce},39:{n:"PtgMemErr",f:eue},40:{n:"PtgMemNoMem",f:tue},41:{n:"PtgMemFunc",f:Qce},42:{n:"PtgRefErr",f:Jce},43:{n:"PtgAreaErr",f:vce},44:{n:"PtgRefN",f:Oce},45:{n:"PtgAreaN",f:Sce},46:{n:"PtgMemAreaN",f:xue},47:{n:"PtgMemNoMemN",f:yue},57:{n:"PtgNameX",f:Kce},58:{n:"PtgRef3d",f:Mce},59:{n:"PtgArea3d",f:bce},60:{n:"PtgRefErr3d",f:Zce},61:{n:"PtgAreaErr3d",f:wce},255:{}},vue={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},wue={1:{n:"PtgElfLel",f:wU},2:{n:"PtgElfRw",f:uue},3:{n:"PtgElfCol",f:nue},6:{n:"PtgElfRwV",f:due},7:{n:"PtgElfColV",f:sue},10:{n:"PtgElfRadical",f:oue},11:{n:"PtgElfRadicalS",f:cue},13:{n:"PtgElfColS",f:iue},15:{n:"PtgElfColSV",f:aue},16:{n:"PtgElfRadicalLel",f:lue},25:{n:"PtgList",f:hue},29:{n:"PtgSxName",f:pue},255:{}},Sue={0:{n:"PtgAttrNoop",f:bue},1:{n:"PtgAttrSemi",f:Cce},2:{n:"PtgAttrIf",f:Ace},4:{n:"PtgAttrChoose",f:kce},8:{n:"PtgAttrGoto",f:jce},16:{n:"PtgAttrSum",f:Bce},32:{n:"PtgAttrBaxcel",f:YP},33:{n:"PtgAttrBaxcel",f:YP},64:{n:"PtgAttrSpace",f:Ece},65:{n:"PtgAttrSpaceSemi",f:Tce},128:{n:"PtgAttrIfError",f:Nce},255:{}};function oy(e,t,r,n){if(n.biff<8)return zo(e,t);for(var i=e.l+t,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=Vce(e,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=Hce(e,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=i-e.l,t!==0&&s.push(zo(e,t)),s}function ly(e,t,r){for(var n=e.l+t,i,s,o=[];n!=e.l;)t=n-e.l,s=e[e.l],i=XP[s]||XP[vue[s]],(s===24||s===25)&&(i=(s===24?wue:Sue)[e[e.l+1]]),!i||!i.f?zo(e,t):o.push([i.n,i.f(e,t,r)]);return o}function _ue(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var kue={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function jue(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function SU(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function QP(e,t,r){var n=SU(e,t,r);return n=="#REF"?n:jue(n,r)}function Mo(e,t,r,n,i){var s=i&&i.biff||8,o={s:{c:0,r:0}},l=[],c,u,d,f=0,h=0,p,m="";if(!e[0]||!e[0][0])return"";for(var g=-1,y="",b=0,v=e[0].length;b<v;++b){var w=e[0][b];switch(w[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),g>=0){switch(e[0][g][1][0]){case 0:y=qa(" ",e[0][g][1][1]);break;case 1:y=qa("\r",e[0][g][1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+y,g=-1}l.push(u+kue[w[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Cx(w[1][1],o,i),l.push(Ex(d,s));break;case"PtgRefN":d=r?Cx(w[1][1],r,i):w[1][1],l.push(Ex(d,s));break;case"PtgRef3d":f=w[1][1],d=Cx(w[1][2],o,i),m=QP(n,f,i),l.push(m+"!"+Ex(d,s));break;case"PtgFunc":case"PtgFuncVar":var S=w[1][0],k=w[1][1];S||(S=0),S&=127;var j=S==0?[]:l.slice(-S);l.length-=S,k==="User"&&(k=j.shift()),l.push(k+"("+j.join(",")+")");break;case"PtgBool":l.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(w[1]);break;case"PtgNum":l.push(String(w[1]));break;case"PtgStr":l.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(w[1]);break;case"PtgAreaN":p=AP(w[1][1],r?{s:r}:o,i),l.push(J5(p,i));break;case"PtgArea":p=AP(w[1][1],o,i),l.push(J5(p,i));break;case"PtgArea3d":f=w[1][1],p=w[1][2],m=QP(n,f,i),l.push(m+"!"+J5(p,i));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=w[1][2];var A=(n.names||[])[h-1]||(n[0]||[])[h],L=A?A.Name:"SH33TJSNAME"+String(h);L&&L.slice(0,6)=="_xlfn."&&!i.xlfn&&(L=L.slice(6)),l.push(L);break;case"PtgNameX":var P=w[1][1];h=w[1][2];var F;if(i.biff<=5)P<0&&(P=-P),n[P]&&(F=n[P][h]);else{var E="";if(((n[P]||[])[0]||[])[0]==14849||(((n[P]||[])[0]||[])[0]==1025?n[P][h]&&n[P][h].itab>0&&(E=n.SheetNames[n[P][h].itab-1]+"!"):E=n.SheetNames[h-1]+"!"),n[P]&&n[P][h])E+=n[P][h].Name;else if(n[0]&&n[0][h])E+=n[0][h].Name;else{var T=(SU(n,P,i)||"").split(";;");T[h-1]?E=T[h-1]:E+="SH33TJSERRX"}l.push(E);break}F||(F={Name:"SH33TJSERRY"}),l.push(F.Name);break;case"PtgParen":var B="(",q=")";if(g>=0){switch(y="",e[0][g][1][0]){case 2:B=qa(" ",e[0][g][1][1])+B;break;case 3:B=qa("\r",e[0][g][1][1])+B;break;case 4:q=qa(" ",e[0][g][1][1])+q;break;case 5:q=qa("\r",e[0][g][1][1])+q;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}l.push(B+l.pop()+q);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:w[1][1],r:w[1][0]};var U={c:r.c,r:r.r};if(n.sharedf[Yn(d)]){var se=n.sharedf[Yn(d)];l.push(Mo(se,o,U,n,i))}else{var de=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(Mo(u[1],o,U,n,i)),de=!0;break}de||l.push(w[1])}break;case"PtgArray":l.push("{"+_ue(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var z=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&g>=0&&z.indexOf(e[0][b][0])==-1){w=e[0][g];var G=!0;switch(w[1][0]){case 4:G=!1;case 0:y=qa(" ",w[1][1]);break;case 5:G=!1;case 1:y=qa("\r",w[1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}l.push((G?y:"")+l.pop()+(G?"":y)),g=-1}}if(l.length>1&&i.WTF)throw new Error("bad formula stack");return l[0]}function Aue(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],zo(e,t-2)];var l=ly(e,o,r);return t!==o+i&&(s=oy(e,t-o-i,l,r)),e.l=n,[l,s]}function Nue(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],zo(e,t-2)];var l=ly(e,o,r);return t!==o+i&&(s=oy(e,t-o-i,l,r)),e.l=n,[l,s]}function Cue(e,t,r,n){var i=e.l+t,s=ly(e,n,r),o;return i!==e.l&&(o=oy(e,i-e.l,s,r)),[s,o]}function Eue(e,t,r){var n=e.l+t,i,s=e.read_shift(2),o=ly(e,s,r);return s==65535?[[],zo(e,t-2)]:(t!==s+2&&(i=oy(e,n-s-2,o,r)),[o,i])}function Tue(e){var t;if(Ld(e,e.l+6)!==65535)return[Io(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Pue(e){if(e==null){var t=wr(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return k0(e);return k0(0)}function nk(e,t,r){var n=e.l+t,i=dd(e);r.biff==2&&++e.l;var s=Tue(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=Nue(e,n-e.l,r);return{cell:i,val:s[0],formula:l,shared:o>>3&1,tt:s[1]}}function Oue(e,t,r,n,i){var s=A0(t,r,i),o=Pue(e.v),l=wr(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=wr(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=Vs([s,o,l,u]);return f}function PS(e,t,r){var n=e.read_shift(4),i=ly(e,n,r),s=e.read_shift(4),o=s>0?oy(e,s,i,r):null;return[i,o]}var Mue=PS,OS=PS,Lue=PS,Rue=PS,Fue={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},_U={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Bue={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function JP(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Iue(e){var t="of:="+e.replace(rC,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function ik(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Due(e){return e.replace(/\./,"!")}var Px={},xm={},Ox=typeof Map<"u";function aC(e,t,r){var n=0,i=e.length;if(r){if(Ox?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Ox?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(Ox?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function MS(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Ro=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=x1(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=H2(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function l0(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Ah(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){$d(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function kU(e,t,r,n,i,s){try{n.cellNF&&(e.z=Gn[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=xa(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Gn[t]==null&&$d(Fne[t]||"General",t),e.t==="e")e.w=e.w||df[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=u1(e.v);else if(e.t==="d"){var o=Ms(e.v);(o|0)===o?e.w=o.toString(10):e.w=u1(o)}else{if(e.v===void 0)return"";e.w=S0(e.v,xm)}else e.t==="d"?e.w=Uc(t,Ms(e.v),xm):e.w=Uc(t,e.v,xm)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=q2(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=q2(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&s.Fills)throw l}}}function $ue(e,t,r){if(e&&e["!ref"]){var n=Ni(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Uue(e,t){var r=Ni(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=oi(r))}var zue=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Wue=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,que=/<(?:\w:)?hyperlink [^>]*>/mg,Hue=/"(\w*:\w*)"/,Vue=/<(?:\w:)?col\b[^>]*[\/]?>/g,Gue=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Kue=/<(?:\w:)?pageMargins[^>]*\/>/g,jU=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Yue=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Xue=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Que(e,t,r,n,i,s,o){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(Wue);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var h=u.match(jU);h?sC(h[0],l,i,r):(h=u.match(Yue))&&Zue(h[0],h[1]||"",l,i,r);var p=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var m=u.slice(p,p+50).match(Hue);m&&Uue(l,m[1])}var g=u.match(Xue);g&&g[1]&&fde(g[1],i);var y=[];if(t.cellStyles){var b=u.match(Vue);b&&ode(y,b)}f&&mde(f[1],l,t,c,s,o);var v=d.match(Gue);v&&(l["!autofilter"]=cde(v[0]));var w=[],S=d.match(zue);if(S)for(p=0;p!=S.length;++p)w[p]=Ni(S[p].slice(S[p].indexOf('"')+1));var k=d.match(que);k&&ide(l,k,n);var j=d.match(Kue);if(j&&(l["!margins"]=ade(Xn(j[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=oi(c)),t.sheetRows>0&&l["!ref"]){var A=Ni(l["!ref"]);t.sheetRows<=+A.e.r&&(A.e.r=t.sheetRows-1,A.e.r>c.e.r&&(A.e.r=c.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>c.e.c&&(A.e.c=c.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),l["!fullref"]=l["!ref"],l["!ref"]=oi(A))}return y.length>0&&(l["!cols"]=y),w.length>0&&(l["!merges"]=w),l}function Jue(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+oi(e[r])+'"/>';return t+"</mergeCells>"}function sC(e,t,r,n){var i=Xn(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Ai(Qi(i.codeName)))}function Zue(e,t,r,n,i){sC(e.slice(0,e.indexOf(">")),r,n,i)}function ede(e,t,r,n,i){var s=!1,o={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,o.codeName=Xu(Vi(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),l=(l||"")+ln("outlinePr",null,u)}!s&&!l||(i[i.length]=ln("sheetPr",l,o))}var tde=["objects","scenarios","selectLockedCells","selectUnlockedCells"],rde=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function nde(e){var t={sheet:1};return tde.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),rde.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Z3(e.password).toString(16).toUpperCase()),ln("sheetProtection",null,t)}function ide(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var s=Xn(Qi(t[i]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+Ai(s.location))):(s.Target="#"+Ai(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var l=Ni(s.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var d=Yn({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=s):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=s)}}}function ade(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function sde(e){return l0(e),ln("pageMargins",null,e)}function ode(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=Xn(t[n],!0);i.hidden&&(i.hidden=pa(i.hidden));var s=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,eC(i.width)),hh(i);s<=o;)e[s++]=ya(i)}}function lde(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=ln("col",null,MS(i,n)));return r[r.length]="</cols>",r.join("")}function cde(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function ude(e,t,r,n){var i=typeof e.ref=="string"?e.ref:oi(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=Ol(i);o.s.r==o.e.r&&(o.e.r=Ol(t["!ref"]).e.r,i=oi(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),ln("autoFilter",null,{ref:i})}var dde=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function fde(e,t){t.Views||(t.Views=[{}]),(e.match(dde)||[]).forEach(function(r,n){var i=Xn(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),pa(i.rightToLeft)&&(t.Views[n].RTL=!0)})}function hde(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ln("sheetViews",ln("sheetView",null,i),{})}function pde(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=df[e.v];break;case"d":n&&n.cellDates?i=xa(e.v,-1).toISOString():(e=ya(e),e.t="n",i=""+(e.v=Ms(xa(e.v)))),typeof e.z>"u"&&(e.z=Gn[14]);break;default:i=e.v;break}var l=ho("v",Vi(i)),c={r:t},u=Ah(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=ho("v",""+aC(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=s&&(e.t=s,e.v=o),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=ln("f",Vi(e.f),d)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),ln("c",l,c)}var mde=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=d1("v"),o=d1("f");return function(c,u,d,f,h,p){for(var m=0,g="",y=[],b=[],v=0,w=0,S=0,k="",j,A,L=0,P=0,F,E,T=0,B=0,q=Array.isArray(p.CellXf),U,se=[],de=[],z=Array.isArray(u),G=[],ie={},Y=!1,C=!!d.sheetStubs,K=c.split(t),H=0,R=K.length;H!=R;++H){g=K[H].trim();var J=g.length;if(J!==0){var V=0;e:for(m=0;m<J;++m)switch(g[m]){case">":if(g[m-1]!="/"){++m;break e}if(d&&d.cellStyles){if(A=Xn(g.slice(V,m),!0),L=A.r!=null?parseInt(A.r,10):L+1,P=-1,d.sheetRows&&d.sheetRows<L)continue;ie={},Y=!1,A.ht&&(Y=!0,ie.hpt=parseFloat(A.ht),ie.hpx=Dm(ie.hpt)),A.hidden=="1"&&(Y=!0,ie.hidden=!0),A.outlineLevel!=null&&(Y=!0,ie.level=+A.outlineLevel),Y&&(G[L-1]=ie)}break;case"<":V=m;break}if(V>=m)break;if(A=Xn(g.slice(V,m),!0),L=A.r!=null?parseInt(A.r,10):L+1,P=-1,!(d.sheetRows&&d.sheetRows<L)){f.s.r>L-1&&(f.s.r=L-1),f.e.r<L-1&&(f.e.r=L-1),d&&d.cellStyles&&(ie={},Y=!1,A.ht&&(Y=!0,ie.hpt=parseFloat(A.ht),ie.hpx=Dm(ie.hpt)),A.hidden=="1"&&(Y=!0,ie.hidden=!0),A.outlineLevel!=null&&(Y=!0,ie.level=+A.outlineLevel),Y&&(G[L-1]=ie)),y=g.slice(m).split(e);for(var X=0;X!=y.length&&y[X].trim().charAt(0)=="<";++X);for(y=y.slice(X),m=0;m!=y.length;++m)if(g=y[m].trim(),g.length!==0){if(b=g.match(r),v=m,w=0,S=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,b!=null&&b.length===2){for(v=0,k=b[1],w=0;w!=k.length&&!((S=k.charCodeAt(w)-64)<1||S>26);++w)v=26*v+S;--v,P=v}else++P;for(w=0;w!=g.length&&g.charCodeAt(w)!==62;++w);if(++w,A=Xn(g.slice(0,w),!0),A.r||(A.r=Yn({r:L-1,c:P})),k=g.slice(w),j={t:""},(b=k.match(s))!=null&&b[1]!==""&&(j.v=Ai(b[1])),d.cellFormula){if((b=k.match(o))!=null&&b[1]!==""){if(j.f=Ai(Qi(b[1])).replace(/\r\n/g,`
`),d.xlfn||(j.f=KP(j.f)),b[0].indexOf('t="array"')>-1)j.F=(k.match(i)||[])[1],j.F.indexOf(":")>-1&&se.push([Ni(j.F),j.F]);else if(b[0].indexOf('t="shared"')>-1){E=Xn(b[0]);var Q=Ai(Qi(b[1]));d.xlfn||(Q=KP(Q)),de[parseInt(E.si,10)]=[E,Q,A.r]}}else(b=k.match(/<f[^>]*\/>/))&&(E=Xn(b[0]),de[E.si]&&(j.f=dce(de[E.si][1],de[E.si][2],A.r)));var ne=Pa(A.r);for(w=0;w<se.length;++w)ne.r>=se[w][0].s.r&&ne.r<=se[w][0].e.r&&ne.c>=se[w][0].s.c&&ne.c<=se[w][0].e.c&&(j.F=se[w][1])}if(A.t==null&&j.v===void 0)if(j.f||j.F)j.v=0,j.t="n";else if(C)j.t="z";else continue;else j.t=A.t||"n";switch(f.s.c>P&&(f.s.c=P),f.e.c<P&&(f.e.c=P),j.t){case"n":if(j.v==""||j.v==null){if(!C)continue;j.t="z"}else j.v=parseFloat(j.v);break;case"s":if(typeof j.v>"u"){if(!C)continue;j.t="z"}else F=Px[parseInt(j.v,10)],j.v=F.t,j.r=F.r,d.cellHTML&&(j.h=F.h);break;case"str":j.t="s",j.v=j.v!=null?Qi(j.v):"",d.cellHTML&&(j.h=I3(j.v));break;case"inlineStr":b=k.match(n),j.t="s",b!=null&&(F=J3(b[1]))?(j.v=F.t,d.cellHTML&&(j.h=F.h)):j.v="";break;case"b":j.v=pa(j.v);break;case"d":d.cellDates?j.v=xa(j.v,1):(j.v=Ms(xa(j.v,1)),j.t="n");break;case"e":(!d||d.cellText!==!1)&&(j.w=j.v),j.v=N$[j.v];break}if(T=B=0,U=null,q&&A.s!==void 0&&(U=p.CellXf[A.s],U!=null&&(U.numFmtId!=null&&(T=U.numFmtId),d.cellStyles&&U.fillId!=null&&(B=U.fillId))),kU(j,T,B,d,h,p),d.cellDates&&q&&j.t=="n"&&sg(Gn[T])&&(j.t="d",j.v=ES(j.v)),A.cm&&d.xlmeta){var oe=(d.xlmeta.Cell||[])[+A.cm-1];oe&&oe.type=="XLDAPR"&&(j.D=!0)}if(z){var O=Pa(A.r);u[O.r]||(u[O.r]=[]),u[O.r][O.c]=j}else u[A.r]=j}}}}G.length>0&&(u["!rows"]=G)}}();function gde(e,t,r,n){var i=[],s=[],o=Ni(e["!ref"]),l="",c,u="",d=[],f=0,h=0,p=e["!rows"],m=Array.isArray(e),g={r:u},y,b=-1;for(h=o.s.c;h<=o.e.c;++h)d[h]=Ta(h);for(f=o.s.r;f<=o.e.r;++f){for(s=[],u=os(f),h=o.s.c;h<=o.e.c;++h){c=d[h]+u;var v=m?(e[f]||[])[h]:e[c];v!==void 0&&(l=pde(v,c,e,t))!=null&&s.push(l)}(s.length>0||p&&p[f])&&(g={r:u},p&&p[f]&&(y=p[f],y.hidden&&(g.hidden=1),b=-1,y.hpx?b=y1(y.hpx):y.hpt&&(b=y.hpt),b>-1&&(g.ht=b,g.customHeight=1),y.level&&(g.outlineLevel=y.level)),i[i.length]=ln("row",s.join(""),g))}if(p)for(;f<p.length;++f)p&&p[f]&&(g={r:f+1},y=p[f],y.hidden&&(g.hidden=1),b=-1,y.hpx?b=y1(y.hpx):y.hpt&&(b=y.hpt),b>-1&&(g.ht=b,g.customHeight=1),y.level&&(g.outlineLevel=y.level),i[i.length]=ln("row","",g));return i.join("")}function AU(e,t,r,n){var i=[ls,ln("worksheet",null,{xmlns:X0[0],"xmlns:r":Ps.r})],s=r.SheetNames[e],o=0,l="",c=r.Sheets[s];c==null&&(c={});var u=c["!ref"]||"A1",d=Ni(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=oi(d)}n||(n={}),c["!comments"]=[];var f=[];ede(c,r,e,t,i),i[i.length]=ln("dimension",null,{ref:u}),i[i.length]=hde(c,t,e,r),t.sheetFormat&&(i[i.length]=ln("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(i[i.length]=lde(c,c["!cols"])),i[o=i.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=gde(c,t),l.length>0&&(i[i.length]=l)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),c["!protect"]&&(i[i.length]=nde(c["!protect"])),c["!autofilter"]!=null&&(i[i.length]=ude(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(i[i.length]=Jue(c["!merges"]));var h=-1,p,m=-1;return c["!links"].length>0&&(i[i.length]="<hyperlinks>",c["!links"].forEach(function(g){g[1].Target&&(p={ref:g[0]},g[1].Target.charAt(0)!="#"&&(m=Wi(n,-1,Vi(g[1].Target).replace(/#.*$/,""),gi.HLINK),p["r:id"]="rId"+m),(h=g[1].Target.indexOf("#"))>-1&&(p.location=Vi(g[1].Target.slice(h+1))),g[1].Tooltip&&(p.tooltip=Vi(g[1].Tooltip)),i[i.length]=ln("hyperlink",null,p))}),i[i.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(i[i.length]=sde(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=ho("ignoredErrors",ln("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(m=Wi(n,-1,"../drawings/drawing"+(e+1)+".xml",gi.DRAW),i[i.length]=ln("drawing",null,{"r:id":"rId"+m}),c["!drawing"]=f),c["!comments"].length>0&&(m=Wi(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",gi.VML),i[i.length]=ln("legacyDrawing",null,{"r:id":"rId"+m}),c["!legacy"]=m),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function xde(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function yde(e,t,r){var n=wr(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=y1(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,h=-1,p=d<<10;p<d+1<<10;++p){u.c=p;var m=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Yn(u)];m&&(f<0&&(f=p),h=p)}f<0||(++l,n.write_shift(4,f),n.write_shift(4,h))}var g=n.l;return n.l=c,n.write_shift(4,l),n.l=g,n.length>n.l?n.slice(0,n.l):n}function bde(e,t,r,n){var i=yde(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&Br(e,0,i)}var vde=ep,wde=cg;function Sde(){}function _de(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Aie(e),r}function kde(e,t,r){r==null&&(r=wr(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return U2({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),S$(e,r),r.slice(0,r.l)}function jde(e){var t=Gc(e);return[t]}function Ade(e,t,r){return r==null&&(r=wr(8)),Q0(t,r)}function Nde(e){var t=J0(e);return[t]}function Cde(e,t,r){return r==null&&(r=wr(4)),Z0(t,r)}function Ede(e){var t=Gc(e),r=e.read_shift(1);return[t,r,"b"]}function Tde(e,t,r){return r==null&&(r=wr(9)),Q0(t,r),r.write_shift(1,e.v?1:0),r}function Pde(e){var t=J0(e),r=e.read_shift(1);return[t,r,"b"]}function Ode(e,t,r){return r==null&&(r=wr(5)),Z0(t,r),r.write_shift(1,e.v?1:0),r}function Mde(e){var t=Gc(e),r=e.read_shift(1);return[t,r,"e"]}function Lde(e,t,r){return r==null&&(r=wr(9)),Q0(t,r),r.write_shift(1,e.v),r}function Rde(e){var t=J0(e),r=e.read_shift(1);return[t,r,"e"]}function Fde(e,t,r){return r==null&&(r=wr(8)),Z0(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Bde(e){var t=Gc(e),r=e.read_shift(4);return[t,r,"s"]}function Ide(e,t,r){return r==null&&(r=wr(12)),Q0(t,r),r.write_shift(4,t.v),r}function Dde(e){var t=J0(e),r=e.read_shift(4);return[t,r,"s"]}function $de(e,t,r){return r==null&&(r=wr(8)),Z0(t,r),r.write_shift(4,t.v),r}function Ude(e){var t=Gc(e),r=Io(e);return[t,r,"n"]}function zde(e,t,r){return r==null&&(r=wr(16)),Q0(t,r),k0(e.v,r),r}function NU(e){var t=J0(e),r=Io(e);return[t,r,"n"]}function Wde(e,t,r){return r==null&&(r=wr(12)),Z0(t,r),k0(e.v,r),r}function qde(e){var t=Gc(e),r=G3(e);return[t,r,"n"]}function Hde(e,t,r){return r==null&&(r=wr(12)),Q0(t,r),_$(e.v,r),r}function Vde(e){var t=J0(e),r=G3(e);return[t,r,"n"]}function Gde(e,t,r){return r==null&&(r=wr(8)),Z0(t,r),_$(e.v,r),r}function Kde(e){var t=Gc(e),r=q3(e);return[t,r,"is"]}function Yde(e){var t=Gc(e),r=Do(e);return[t,r,"str"]}function Xde(e,t,r){return r==null&&(r=wr(12+4*e.v.length)),Q0(t,r),Gs(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Qde(e){var t=J0(e),r=Do(e);return[t,r,"str"]}function Jde(e,t,r){return r==null&&(r=wr(8+4*e.v.length)),Z0(t,r),Gs(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Zde(e,t,r){var n=e.l+t,i=Gc(e);i.r=r["!row"];var s=e.read_shift(1),o=[i,s,"b"];if(r.cellFormula){e.l+=2;var l=OS(e,n-e.l,r);o[3]=Mo(l,null,i,r.supbooks,r)}else e.l=n;return o}function efe(e,t,r){var n=e.l+t,i=Gc(e);i.r=r["!row"];var s=e.read_shift(1),o=[i,s,"e"];if(r.cellFormula){e.l+=2;var l=OS(e,n-e.l,r);o[3]=Mo(l,null,i,r.supbooks,r)}else e.l=n;return o}function tfe(e,t,r){var n=e.l+t,i=Gc(e);i.r=r["!row"];var s=Io(e),o=[i,s,"n"];if(r.cellFormula){e.l+=2;var l=OS(e,n-e.l,r);o[3]=Mo(l,null,i,r.supbooks,r)}else e.l=n;return o}function rfe(e,t,r){var n=e.l+t,i=Gc(e);i.r=r["!row"];var s=Do(e),o=[i,s,"str"];if(r.cellFormula){e.l+=2;var l=OS(e,n-e.l,r);o[3]=Mo(l,null,i,r.supbooks,r)}else e.l=n;return o}var nfe=ep,ife=cg;function afe(e,t){return t==null&&(t=wr(4)),t.write_shift(4,e),t}function sfe(e,t){var r=e.l+t,n=ep(e),i=H3(e),s=Do(e),o=Do(e),l=Do(e);e.l=r;var c={rfx:n,relId:i,loc:s,display:l};return o&&(c.Tooltip=o),c}function ofe(e,t){var r=wr(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));cg({s:Pa(e[0]),e:Pa(e[0])},r),V3("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return Gs(i||"",r),Gs(e[1].Tooltip||"",r),Gs("",r),r.slice(0,r.l)}function lfe(){}function cfe(e,t,r){var n=e.l+t,i=k$(e),s=e.read_shift(1),o=[i];if(o[2]=s,r.cellFormula){var l=Mue(e,n-e.l,r);o[1]=l}else e.l=n;return o}function ufe(e,t,r){var n=e.l+t,i=ep(e),s=[i];if(r.cellFormula){var o=Rue(e,n-e.l,r);s[1]=o,e.l=n}else e.l=n;return s}function dfe(e,t,r){r==null&&(r=wr(18));var n=MS(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var CU=["left","right","top","bottom","header","footer"];function ffe(e){var t={};return CU.forEach(function(r){t[r]=Io(e)}),t}function hfe(e,t){return t==null&&(t=wr(6*8)),l0(e),CU.forEach(function(r){k0(e[r],t)}),t}function pfe(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function mfe(e,t,r){r==null&&(r=wr(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function gfe(e){var t=wr(24);return t.write_shift(4,4),t.write_shift(4,1),cg(e,t),t}function xfe(e,t){return t==null&&(t=wr(16*4+2)),t.write_shift(2,e.password?Z3(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function yfe(){}function bfe(){}function vfe(e,t,r,n,i,s,o){if(!e)return e;var l=t||{};n||(n={"!id":{}});var c=l.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,p,m,g,y,b,v,w,S,k,j=[];l.biff=12,l["!row"]=0;var A=0,L=!1,P=[],F={},E=l.supbooks||i.supbooks||[[]];if(E.sharedf=F,E.arrayf=P,E.SheetNames=i.SheetNames||i.Sheets.map(function(z){return z.name}),!l.supbooks&&(l.supbooks=E,i.Names))for(var T=0;T<i.Names.length;++T)E[0][T+1]=i.Names[T];var B=[],q=[],U=!1;b1[16]={n:"BrtShortReal",f:NU};var se;if(uf(e,function(G,ie,Y){if(!h)switch(Y){case 148:u=G;break;case 0:p=G,l.sheetRows&&l.sheetRows<=p.r&&(h=!0),S=os(y=p.r),l["!row"]=p.r,(G.hidden||G.hpt||G.level!=null)&&(G.hpt&&(G.hpx=Dm(G.hpt)),q[G.r]=G);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:G[2]},G[2]){case"n":m.v=G[1];break;case"s":w=Px[G[1]],m.v=w.t,m.r=w.r;break;case"b":m.v=!!G[1];break;case"e":m.v=G[1],l.cellText!==!1&&(m.w=df[m.v]);break;case"str":m.t="s",m.v=G[1];break;case"is":m.t="s",m.v=G[1].t;break}if((g=o.CellXf[G[0].iStyleRef])&&kU(m,g.numFmtId,null,l,s,o),b=G[0].c==-1?b+1:G[0].c,l.dense?(c[y]||(c[y]=[]),c[y][b]=m):c[Ta(b)+S]=m,l.cellFormula){for(L=!1,A=0;A<P.length;++A){var C=P[A];p.r>=C[0].s.r&&p.r<=C[0].e.r&&b>=C[0].s.c&&b<=C[0].e.c&&(m.F=oi(C[0]),L=!0)}!L&&G.length>3&&(m.f=G[3])}if(d.s.r>p.r&&(d.s.r=p.r),d.s.c>b&&(d.s.c=b),d.e.r<p.r&&(d.e.r=p.r),d.e.c<b&&(d.e.c=b),l.cellDates&&g&&m.t=="n"&&sg(Gn[g.numFmtId])){var K=Yh(m.v);K&&(m.t="d",m.v=new Date(K.y,K.m-1,K.d,K.H,K.M,K.S,K.u))}se&&(se.type=="XLDAPR"&&(m.D=!0),se=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;m={t:"z",v:void 0},b=G[0].c==-1?b+1:G[0].c,l.dense?(c[y]||(c[y]=[]),c[y][b]=m):c[Ta(b)+S]=m,d.s.r>p.r&&(d.s.r=p.r),d.s.c>b&&(d.s.c=b),d.e.r<p.r&&(d.e.r=p.r),d.e.c<b&&(d.e.c=b),se&&(se.type=="XLDAPR"&&(m.D=!0),se=void 0);break;case 176:j.push(G);break;case 49:se=((l.xlmeta||{}).Cell||[])[G-1];break;case 494:var H=n["!id"][G.relId];for(H?(G.Target=H.Target,G.loc&&(G.Target+="#"+G.loc),G.Rel=H):G.relId==""&&(G.Target="#"+G.loc),y=G.rfx.s.r;y<=G.rfx.e.r;++y)for(b=G.rfx.s.c;b<=G.rfx.e.c;++b)l.dense?(c[y]||(c[y]=[]),c[y][b]||(c[y][b]={t:"z",v:void 0}),c[y][b].l=G):(v=Yn({c:b,r:y}),c[v]||(c[v]={t:"z",v:void 0}),c[v].l=G);break;case 426:if(!l.cellFormula)break;P.push(G),k=l.dense?c[y][b]:c[Ta(b)+S],k.f=Mo(G[1],d,{r:p.r,c:b},E,l),k.F=oi(G[0]);break;case 427:if(!l.cellFormula)break;F[Yn(G[0].s)]=G[1],k=l.dense?c[y][b]:c[Ta(b)+S],k.f=Mo(G[1],d,{r:p.r,c:b},E,l);break;case 60:if(!l.cellStyles)break;for(;G.e>=G.s;)B[G.e--]={width:G.w/256,hidden:!!(G.flags&1),level:G.level},U||(U=!0,eC(G.w/256)),hh(B[G.e+1]);break;case 161:c["!autofilter"]={ref:oi(G)};break;case 476:c["!margins"]=G;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),G.name&&(i.Sheets[r].CodeName=G.name),(G.above||G.left)&&(c["!outline"]={above:G.above,left:G.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),G.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!ie.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+Y.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=oi(u||d)),l.sheetRows&&c["!ref"]){var de=Ni(c["!ref"]);l.sheetRows<=+de.e.r&&(de.e.r=l.sheetRows-1,de.e.r>d.e.r&&(de.e.r=d.e.r),de.e.r<de.s.r&&(de.s.r=de.e.r),de.e.c>d.e.c&&(de.e.c=d.e.c),de.e.c<de.s.c&&(de.s.c=de.e.c),c["!fullref"]=c["!ref"],c["!ref"]=oi(de))}return j.length>0&&(c["!merges"]=j),B.length>0&&(c["!cols"]=B),q.length>0&&(c["!rows"]=q),c}function wfe(e,t,r,n,i,s,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=ya(t),t.z=t.z||Gn[14],t.v=Ms(xa(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:n};switch(c.s=Ah(i.cellXfs,t,i),t.l&&s["!links"].push([Yn(c),t.l]),t.c&&s["!comments"].push([Yn(c),t.c]),t.t){case"s":case"str":return i.bookSST?(l=aC(i.Strings,t.v,i.revStrings),c.t="s",c.v=l,o?Br(e,18,$de(t,c)):Br(e,7,Ide(t,c))):(c.t="str",o?Br(e,17,Jde(t,c)):Br(e,6,Xde(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?Br(e,13,Gde(t,c)):Br(e,2,Hde(t,c)):o?Br(e,16,Wde(t,c)):Br(e,5,zde(t,c)),!0;case"b":return c.t="b",o?Br(e,15,Ode(t,c)):Br(e,4,Tde(t,c)),!0;case"e":return c.t="e",o?Br(e,14,Fde(t,c)):Br(e,3,Lde(t,c)),!0}return o?Br(e,12,Cde(t,c)):Br(e,1,Ade(t,c)),!0}function Sfe(e,t,r,n){var i=Ni(t["!ref"]||"A1"),s,o="",l=[];Br(e,145);var c=Array.isArray(t),u=i.e.r;t["!rows"]&&(u=Math.max(i.e.r,t["!rows"].length-1));for(var d=i.s.r;d<=u;++d){o=os(d),bde(e,t,i,d);var f=!1;if(d<=i.e.r)for(var h=i.s.c;h<=i.e.c;++h){d===i.s.r&&(l[h]=Ta(h)),s=l[h]+o;var p=c?(t[d]||[])[h]:t[s];if(!p){f=!1;continue}f=wfe(e,p,d,h,n,t,f)}}Br(e,146)}function _fe(e,t){!t||!t["!merges"]||(Br(e,177,afe(t["!merges"].length)),t["!merges"].forEach(function(r){Br(e,176,ife(r))}),Br(e,178))}function kfe(e,t){!t||!t["!cols"]||(Br(e,390),t["!cols"].forEach(function(r,n){r&&Br(e,60,dfe(n,r))}),Br(e,391))}function jfe(e,t){!t||!t["!ref"]||(Br(e,648),Br(e,649,gfe(Ni(t["!ref"]))),Br(e,650))}function Afe(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=Wi(r,-1,n[1].Target.replace(/#.*$/,""),gi.HLINK);Br(e,494,ofe(n,i))}}),delete t["!links"]}function Nfe(e,t,r,n){if(t["!comments"].length>0){var i=Wi(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",gi.VML);Br(e,551,V3("rId"+i)),t["!legacy"]=i}}function Cfe(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:oi(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=Ol(s);l.s.r==l.e.r&&(l.e.r=Ol(t["!ref"]).e.r,s=oi(l));for(var c=0;c<o.length;++c){var u=o[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Br(e,161,cg(Ni(s))),Br(e,162)}}function Efe(e,t,r){Br(e,133),Br(e,137,mfe(t,r)),Br(e,138),Br(e,134)}function Tfe(e,t){t["!protect"]&&Br(e,535,xfe(t["!protect"]))}function Pfe(e,t,r,n){var i=Pl(),s=r.SheetNames[e],o=r.Sheets[s]||{},l=s;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=Ni(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Br(i,129),(r.vbaraw||o["!outline"])&&Br(i,147,kde(l,o["!outline"])),Br(i,148,wde(c)),Efe(i,o,r.Workbook),kfe(i,o),Sfe(i,o,e,t),Tfe(i,o),Cfe(i,o,r,e),_fe(i,o),Afe(i,o,n),o["!margins"]&&Br(i,476,hfe(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&jfe(i,o),Nfe(i,o,e,n),Br(i,130),i.end()}function Ofe(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var i=Ai((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,i,n]}function Mfe(e,t,r,n,i,s){var o=s||{"!type":"chart"};if(!e)return s;var l=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=Ofe(f);d.s.r=d.s.c=0,d.e.c=l,u=Ta(l),h[0].forEach(function(p,m){o[u+os(m)]={t:"n",v:p,z:h[1]},c=m}),d.e.r<c&&(d.e.r=c),++l}),l>0&&(o["!ref"]=oi(d)),o}function Lfe(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(jU);return l&&sC(l[0],s,i,r),(o=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function Rfe(e,t){e.l+=10;var r=Do(e);return{name:r}}function Ffe(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return uf(e,function(c,u,d){switch(d){case 550:s["!rel"]=c;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),c.name&&(i.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var oC=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Bfe=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Ife=[],Dfe=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function ZP(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var s=t[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=pa(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function eO(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=pa(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function EU(e){eO(e.WBProps,oC),eO(e.CalcPr,Dfe),ZP(e.WBView,Bfe),ZP(e.Sheets,Ife),xm.date1904=pa(e.WBProps.date1904)}function $fe(e){return!e.Workbook||!e.Workbook.WBProps?"false":pa(e.Workbook.WBProps.date1904)?"true":"false"}var Ufe="][*?/\\".split("");function TU(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Ufe.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function zfe(e,t,r){e.forEach(function(n,i){TU(n);for(var s=0;s<i;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[i]&&t[i].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function Wfe(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];zfe(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)$ue(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var qfe=/<\w+:workbook/;function Hfe(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},o=0;if(e.replace(qo,function(c,u){var d=Xn(c);switch(ud(d[0])){case"<?xml":break;case"<workbook":c.match(qfe)&&(i="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[i];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":oC.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=pa(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=Qi(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Ai(Qi(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Qi(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),pa(d.hidden||"0")&&(s.Hidden=!0),o=u+c.length;break;case"</definedName>":s.Ref=Ai(Qi(e.slice(o,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),X0.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return EU(r),r}function PU(e){var t=[ls];t[t.length]=ln("workbook",null,{xmlns:X0[0],"xmlns:r":Ps.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(oC.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=ln("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var o={name:Vi(e.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=ln("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=ln("definedName",Vi(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Vfe(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=D4(e),r.name=Do(e),r}function Gfe(e,t){return t||(t=wr(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),V3(e.strRelID,t),Gs(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Kfe(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?Do(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Yfe(e,t){t||(t=wr(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),S$(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function Xfe(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Qfe(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=Nie(e),o=Lue(e,0,r),l=H3(e);e.l=n;var c={Name:s,Ptg:o};return i<268435455&&(c.Sheet=i),l&&(c.Comment=l),c}function Jfe(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],b1[16]={n:"BrtFRTArchID$",f:Xfe},uf(e,function(c,u,d){switch(d){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Mo(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,c]):o[0]=[d,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(d),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!u.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),EU(r),r.Names=s,r.supbooks=o,r}function Zfe(e,t){Br(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Br(e,156,Gfe(i))}Br(e,144)}function ehe(e,t){t||(t=wr(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Gs("SheetJS",t),Gs(L2.version,t),Gs(L2.version,t),Gs("7262",t),t.length>t.l?t.slice(0,t.l):t}function the(e,t){t||(t=wr(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function rhe(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(Br(e,135),Br(e,158,the(i)),Br(e,136))}}function nhe(e,t){var r=Pl();return Br(r,131),Br(r,128,ehe()),Br(r,153,Yfe(e.Workbook&&e.Workbook.WBProps||null)),rhe(r,e),Zfe(r,e),Br(r,132),r.end()}function ihe(e,t,r){return t.slice(-4)===".bin"?Jfe(e,r):Hfe(e,r)}function ahe(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?vfe(e,n,r,i,s,o,l):Que(e,n,r,i,s,o,l)}function she(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?Ffe(e,n,r,i,s):Lfe(e,n,r,i,s)}function ohe(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?cce():uce()}function lhe(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?oce():lce()}function che(e,t,r,n){return t.slice(-4)===".bin"?ile(e,r,n):Voe(e,r,n)}function uhe(e,t,r){return dU(e,r)}function dhe(e,t,r){return t.slice(-4)===".bin"?doe(e,r):loe(e,r)}function fhe(e,t,r){return t.slice(-4)===".bin"?rce(e,r):Gle(e,r)}function hhe(e,t,r){return t.slice(-4)===".bin"?qle(e):zle(e)}function phe(e,t,r,n){return r.slice(-4)===".bin"?Hle(e,t,r,n):void 0}function mhe(e,t,r){return t.slice(-4)===".bin"?Dle(e,t,r):Ule(e,t,r)}function ghe(e,t,r){return(t.slice(-4)===".bin"?nhe:PU)(e)}function xhe(e,t,r,n,i){return(t.slice(-4)===".bin"?Pfe:AU)(e,r,n,i)}function yhe(e,t,r){return(t.slice(-4)===".bin"?ple:cU)(e,r)}function bhe(e,t,r){return(t.slice(-4)===".bin"?poe:tU)(e,r)}function vhe(e,t,r){return(t.slice(-4)===".bin"?nce:pU)(e)}function whe(e){return(e.slice(-4)===".bin"?$le:fU)()}var OU=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,MU=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function nu(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=e.match(OU),s,o,l,c;if(i)for(c=0;c!=i.length;++c)s=i[c].match(MU),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(o+1),n[l]=s[2].slice(1,s[2].length-1));return n}function She(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(OU),i,s,o,l;if(n)for(l=0;l!=n.length;++l)i=n[l].match(MU),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),r[o]=i[2].slice(1,i[2].length-1));return r}var Mx;function _he(e,t){var r=Mx[e]||Ai(e);return r==="General"?S0(t):Uc(r,t)}function khe(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=pa(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=xa(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ai(t)]=i}function jhe(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||df[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=u1(e.v):e.w=S0(e.v):e.w=_he(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=Mx[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&sg(n)){var i=Yh(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function Ahe(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=Ioe[n.Pattern]||n.Pattern)}e[t.ID]=t}function Nhe(e,t,r,n,i,s,o,l,c,u){var d="General",f=n.StyleID,h={};u=u||{};var p=[],m=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&o&&(f=o.StyleID);s[f]!==void 0&&(s[f].nf&&(d=s[f].nf),s[f].Interior&&p.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=pa(e);break;case"String":n.t="s",n.r=xP(Ai(e)),n.v=e.indexOf("<")>-1?Ai(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(xa(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ai(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=N$[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=xP(t||e));break}if(jhe(n,d,u),u.cellFormula!==!1)if(n.Formula){var g=Ai(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=gm(g,i),delete n.Formula,n.ArrayRange=="RC"?n.F=gm("RC:RC",i):n.ArrayRange&&(n.F=gm(n.ArrayRange,i),c.push([Ni(n.F),n.F]))}else for(m=0;m<c.length;++m)i.r>=c[m][0].s.r&&i.r<=c[m][0].e.r&&i.c>=c[m][0].s.c&&i.c<=c[m][0].e.c&&(n.F=c[m][1]);u.cellStyles&&(p.forEach(function(y){!h.patternType&&y.patternType&&(h.patternType=y.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Che(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function ak(e,t){var r=t||{};og();var n=dx(D3(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Qi(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=ya(r);return o.type="string",Im.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Te){i.indexOf("<"+Te)>=0&&(s=!0)}),s)return h0e(n,r);Mx={"General Number":"General","General Date":Gn[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Gn[15],"Short Date":Gn[14],"Long Time":Gn[19],"Medium Time":Gn[18],"Short Time":Gn[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Gn[2],Standard:Gn[4],Percent:Gn[10],Scientific:Gn[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],u,d={},f=[],h=r.dense?[]:{},p="",m={},g={},y=nu('<Data ss:Type="String">'),b=0,v=0,w=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},k={},j={},A="",L=0,P=[],F={},E={},T=0,B=[],q=[],U={},se=[],de,z=!1,G=[],ie=[],Y={},C=0,K=0,H={Sheets:[],WBProps:{date1904:!1}},R={};h1.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var J="";l=h1.exec(n);)switch(l[3]=(J=l[3]).toLowerCase()){case"data":if(J=="data"){if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?Nhe(n.slice(b,l.index),A,y,c[c.length-1][0]=="comment"?U:m,{c:v,r:w},k,se[v],g,G,r):(A="",y=nu(l[0]),b=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(q.length>0&&(m.c=q),(!r.sheetRows||r.sheetRows>w)&&m.v!==void 0&&(r.dense?(h[w]||(h[w]=[]),h[w][v]=m):h[Ta(v)+os(w)]=m),m.HRef&&(m.l={Target:Ai(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(C=v+(parseInt(m.MergeAcross,10)|0),K=w+(parseInt(m.MergeDown,10)|0),P.push({s:{c:v,r:w},e:{c:C,r:K}})),!r.sheetStubs)m.MergeAcross?v=C+1:++v;else if(m.MergeAcross||m.MergeDown){for(var V=v;V<=C;++V)for(var X=w;X<=K;++X)(V>v||X>w)&&(r.dense?(h[X]||(h[X]=[]),h[X][V]={t:"z"}):h[Ta(V)+os(X)]={t:"z"});v=C+1}else++v;else m=She(l[0]),m.Index&&(v=+m.Index-1),v<S.s.c&&(S.s.c=v),v>S.e.c&&(S.e.c=v),l[0].slice(-2)==="/>"&&++v,q=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(w<S.s.r&&(S.s.r=w),w>S.e.r&&(S.e.r=w),l[0].slice(-2)==="/>"&&(g=nu(l[0]),g.Index&&(w=+g.Index-1)),v=0,++w):(g=nu(l[0]),g.Index&&(w=+g.Index-1),Y={},(g.AutoFitHeight=="0"||g.Height)&&(Y.hpx=parseInt(g.Height,10),Y.hpt=y1(Y.hpx),ie[w]=Y),g.Hidden=="1"&&(Y.hidden=!0,ie[w]=Y));break;case"worksheet":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));f.push(p),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(h["!ref"]=oi(S),r.sheetRows&&r.sheetRows<=S.e.r&&(h["!fullref"]=h["!ref"],S.e.r=r.sheetRows-1,h["!ref"]=oi(S))),P.length&&(h["!merges"]=P),se.length>0&&(h["!cols"]=se),ie.length>0&&(h["!rows"]=ie),d[p]=h}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=v=0,c.push([l[3],!1]),u=nu(l[0]),p=Ai(u.Name),h=r.dense?[]:{},P=[],G=[],ie=[],R={name:p,Hidden:0},H.Sheets.push(R);break;case"table":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),se=[],z=!1}break;case"style":l[1]==="/"?Ahe(k,j,r):j=nu(l[0]);break;case"numberformat":j.nf=Ai(nu(l[0]).Format||"General"),Mx[j.nf]&&(j.nf=Mx[j.nf]);for(var Q=0;Q!=392&&Gn[Q]!=j.nf;++Q);if(Q==392){for(Q=57;Q!=392;++Q)if(Gn[Q]==null){$d(j.nf,Q);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(de=nu(l[0]),de.Hidden&&(de.hidden=!0,delete de.Hidden),de.Width&&(de.wpx=parseInt(de.Width,10)),!z&&de.wpx>10){z=!0,Ro=oU;for(var ne=0;ne<se.length;++ne)se[ne]&&hh(se[ne])}z&&hh(de),se[de.Index-1||se.length]=de;for(var oe=0;oe<+de.Span;++oe)se[se.length]=ya(de);break;case"namedrange":if(l[1]==="/")break;H.Names||(H.Names=[]);var O=Xn(l[0]),W={Name:O.Name,Ref:gm(O.RefersTo.slice(1),{r:0,c:0})};H.Sheets.length>0&&(W.Sheet=H.Sheets.length-1),H.Names.push(W);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?A+=n.slice(L,l.index):L=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;j.Interior=nu(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?Jie(F,J,n.slice(T,l.index)):T=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));Che(U),q.push(U)}else c.push([l[3],!1]),u=nu(l[0]),U={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var ae=nu(l[0]);h["!autofilter"]={ref:gm(ae.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return aO(n,r);var I=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:I=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:I=!1}break;case"excelworkbook":switch(l[3]){case"date1904":H.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:I=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:I=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(T,l.index)){case"SheetHidden":R.Hidden=1;break;case"SheetVeryHidden":R.Hidden=2;break}else T=l.index+l[0].length;break;case"header":h["!margins"]||l0(h["!margins"]={},"xlml"),isNaN(+Xn(l[0]).Margin)||(h["!margins"].header=+Xn(l[0]).Margin);break;case"footer":h["!margins"]||l0(h["!margins"]={},"xlml"),isNaN(+Xn(l[0]).Margin)||(h["!margins"].footer=+Xn(l[0]).Margin);break;case"pagemargins":var Z=Xn(l[0]);h["!margins"]||l0(h["!margins"]={},"xlml"),isNaN(+Z.Top)||(h["!margins"].top=+Z.Top),isNaN(+Z.Left)||(h["!margins"].left=+Z.Left),isNaN(+Z.Right)||(h["!margins"].right=+Z.Right),isNaN(+Z.Bottom)||(h["!margins"].bottom=+Z.Bottom);break;case"displayrighttoleft":H.Views||(H.Views=[]),H.Views[0]||(H.Views[0]={}),H.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:I=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:I=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:I=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:I=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:I=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:I=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:I=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:I=!1}break;case"smarttags":break;default:I=!1;break}if(I||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?khe(E,J,B,n.slice(T,l.index)):(B=l,T=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var me={};return!r.bookSheets&&!r.bookProps&&(me.Sheets=d),me.SheetNames=f,me.Workbook=H,me.SSF=ya(Gn),me.Props=F,me.Custprops=E,me}function V4(e,t){switch(cC(t=t||{}),t.type||"base64"){case"base64":return ak(lc(e),t);case"binary":case"buffer":case"file":return ak(e,t);case"array":return ak(kh(e),t)}}function Ehe(e,t){var r=[];return e.Props&&r.push(Zie(e.Props,t)),e.Custprops&&r.push(eae(e.Props,e.Custprops)),r.join("")}function The(){return""}function Phe(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var s=[];s.push(ln("NumberFormat",null,{"ss:Format":Vi(Gn[n.numFmtId])}));var o={"ss:ID":"s"+(21+i)};r.push(ln("Style",s.join(""),o))}),ln("Styles",r.join(""))}function LU(e){return ln("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+nC(e.Ref,{r:0,c:0})})}function Ohe(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(LU(i)))}return ln("Names",r.join(""))}function Mhe(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],o=0;o<i.length;++o){var l=i[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||s.push(LU(l)))}return s.join("")}function Lhe(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(ln("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(ln("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(ln("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(ln("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(ho("ProtectContents","True")),e["!protect"].objects&&i.push(ho("ProtectObjects","True")),e["!protect"].scenarios&&i.push(ho("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(ho("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(ho("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":ln("WorksheetOptions",i.join(""),{xmlns:Yl.x})}function Rhe(e){return e.map(function(t){var r=rie(t.t||""),n=ln("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ln("Comment",n,{"ss:Author":t.a})}).join("")}function Fhe(e,t,r,n,i,s,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Vi(nC(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=Pa(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Vi(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Vi(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=o.c||u[d].s.r!=o.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=df[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Gn[14]);break;case"s":f="String",h=tie(e.v||"");break}var p=Ah(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+p),l["ss:Index"]=o.c+1;var m=e.v!=null?h:"",g=e.t=="z"?"":'<Data ss:Type="'+f+'">'+m+"</Data>";return(e.c||[]).length>0&&(g+=Rhe(e.c)),ln("Cell",g,l)}function Bhe(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Dm(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Ihe(e,t,r,n){if(!e["!ref"])return"";var i=Ni(e["!ref"]),s=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(y,b){hh(y);var v=!!y.width,w=MS(b,y),S={"ss:Index":b+1};v&&(S["ss:Width"]=g1(w.width)),y.hidden&&(S["ss:Hidden"]="1"),l.push(ln("Column",null,S))});for(var c=Array.isArray(e),u=i.s.r;u<=i.e.r;++u){for(var d=[Bhe(u,(e["!rows"]||[])[u])],f=i.s.c;f<=i.e.c;++f){var h=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>f)&&!(s[o].s.r>u)&&!(s[o].e.c<f)&&!(s[o].e.r<u)){(s[o].s.c!=f||s[o].s.r!=u)&&(h=!0);break}if(!h){var p={r:u,c:f},m=Yn(p),g=c?(e[u]||[])[f]:e[m];d.push(Fhe(g,m,e,t,r,n,p))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function Dhe(e,t,r){var n=[],i=r.SheetNames[e],s=r.Sheets[i],o=s?Mhe(s,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=s?Ihe(s,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(Lhe(s,t,e,r)),n.join("")}function $he(e,t){t||(t={}),e.SSF||(e.SSF=ya(Gn)),e.SSF&&(og(),AS(e.SSF),t.revssf=CS(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Ah(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Ehe(e,t)),r.push(The()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(ln("Worksheet",Dhe(n,t,e),{"ss:Name":Vi(e.SheetNames[n])}));return r[2]=Phe(e,t),r[3]=Ohe(e),ls+ln("Workbook",r.join(""),{xmlns:Yl.ss,"xmlns:o":Yl.o,"xmlns:x":Yl.x,"xmlns:ss":Yl.ss,"xmlns:dt":Yl.dt,"xmlns:html":Yl.html})}function Uhe(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Oie(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=Mie(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var zhe=[60,1084,2066,2165,2175];function Whe(e,t,r,n,i){var s=n,o=[],l=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(l)}o.push(l),r.l+=s;for(var c=Ld(r,r.l),u=G4[c],d=0;u!=null&&zhe.indexOf(c)>-1;)s=Ld(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),l=r.slice(d,r.l+4+s),o.push(l),r.l+=4+s,u=G4[c=Ld(r,r.l)];var f=Vs(o);fo(f,0);var h=0;f.lens=[];for(var p=0;p<o.length;++p)f.lens.push(h),h+=o[p].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,i)}function Lu(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Gn[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||df[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=u1(e.v):e.w=S0(e.v):e.w=Uc(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&sg(Gn[n]||String(n))){var i=Yh(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Tb(e,t,r){return{v:e,ixfe:t,t:r}}function qhe(e,t){var r={opts:{}},n={},i=t.dense?[]:{},s={},o={},l=null,c=[],u="",d={},f,h="",p,m,g,y,b={},v=[],w,S,k=[],j=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},L={},P=function(he){return he<8?a0[he]:he<64&&j[he-8]||a0[he]},F=function(he,ye,ht){var Ge=ye.XF.data;if(!(!Ge||!Ge.patternType||!ht||!ht.cellStyles)){ye.s={},ye.s.patternType=Ge.patternType;var lt;(lt=m1(P(Ge.icvFore)))&&(ye.s.fgColor={rgb:lt}),(lt=m1(P(Ge.icvBack)))&&(ye.s.bgColor={rgb:lt})}},E=function(he,ye,ht){if(!(Y>1)&&!(ht.sheetRows&&he.r>=ht.sheetRows)){if(ht.cellStyles&&ye.XF&&ye.XF.data&&F(he,ye,ht),delete ye.ixfe,delete ye.XF,f=he,h=Yn(he),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),he.r<o.s.r&&(o.s.r=he.r),he.c<o.s.c&&(o.s.c=he.c),he.r+1>o.e.r&&(o.e.r=he.r+1),he.c+1>o.e.c&&(o.e.c=he.c+1),ht.cellFormula&&ye.f){for(var Ge=0;Ge<v.length;++Ge)if(!(v[Ge][0].s.c>he.c||v[Ge][0].s.r>he.r)&&!(v[Ge][0].e.c<he.c||v[Ge][0].e.r<he.r)){ye.F=oi(v[Ge][0]),(v[Ge][0].s.c!=he.c||v[Ge][0].s.r!=he.r)&&delete ye.f,ye.f&&(ye.f=""+Mo(v[Ge][1],o,he,G,T));break}}ht.dense?(i[he.r]||(i[he.r]=[]),i[he.r][he.c]=ye):i[h]=ye}},T={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:v,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(T.password=t.password);var B,q=[],U=[],se=[],de=[],z=!1,G=[];G.SheetNames=T.snames,G.sharedf=T.sharedf,G.arrayf=T.arrayf,G.names=[],G.XTI=[];var ie=0,Y=0,C=0,K=[],H=[],R;T.codepage=1200,fu(1200);for(var J=!1;e.l<e.length-1;){var V=e.l,X=e.read_shift(2);if(X===0&&ie===10)break;var Q=e.l===e.length?0:e.read_shift(2),ne=G4[X];if(ne&&ne.f){if(t.bookSheets&&ie===133&&X!==133)break;if(ie=X,ne.r===2||ne.r==12){var oe=e.read_shift(2);if(Q-=2,!T.enc&&oe!==X&&((oe&255)<<8|oe>>8)!==X)throw new Error("rt mismatch: "+oe+"!="+X);ne.r==12&&(e.l+=10,Q-=10)}var O={};if(X===10?O=ne.f(e,Q,T):O=Whe(X,ne,e,Q,T),Y==0&&[9,521,1033,2057].indexOf(ie)===-1)continue;switch(X){case 34:r.opts.Date1904=A.WBProps.date1904=O;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(T.enc||(e.l=0),T.enc=O,!t.password)throw new Error("File is password-protected");if(O.valid==null)throw new Error("Encryption scheme unsupported");if(!O.valid)throw new Error("Password is incorrect");break;case 92:T.lastuser=O;break;case 66:var W=Number(O);switch(W){case 21010:W=1200;break;case 32768:W=1e4;break;case 32769:W=1252;break}fu(T.codepage=W),J=!0;break;case 317:T.rrtabid=O;break;case 25:T.winlocked=O;break;case 439:r.opts.RefreshAll=O;break;case 12:r.opts.CalcCount=O;break;case 16:r.opts.CalcDelta=O;break;case 17:r.opts.CalcIter=O;break;case 13:r.opts.CalcMode=O;break;case 14:r.opts.CalcPrecision=O;break;case 95:r.opts.CalcSaveRecalc=O;break;case 15:T.CalcRefMode=O;break;case 2211:r.opts.FullCalc=O;break;case 129:O.fDialog&&(i["!type"]="dialog"),O.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),O.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:k.push(O);break;case 430:G.push([O]),G[G.length-1].XTI=[];break;case 35:case 547:G[G.length-1].push(O);break;case 24:case 536:R={Name:O.Name,Ref:Mo(O.rgce,o,null,G,T)},O.itab>0&&(R.Sheet=O.itab-1),G.names.push(R),G[0]||(G[0]=[],G[0].XTI=[]),G[G.length-1].push(O),O.Name=="_xlnm._FilterDatabase"&&O.itab>0&&O.rgce&&O.rgce[0]&&O.rgce[0][0]&&O.rgce[0][0][0]=="PtgArea3d"&&(H[O.itab-1]={ref:oi(O.rgce[0][0][1][2])});break;case 22:T.ExternCount=O;break;case 23:G.length==0&&(G[0]=[],G[0].XTI=[]),G[G.length-1].XTI=G[G.length-1].XTI.concat(O),G.XTI=G.XTI.concat(O);break;case 2196:if(T.biff<8)break;R!=null&&(R.Comment=O[1]);break;case 18:i["!protect"]=O;break;case 19:O!==0&&T.WTF&&console.error("Password verifier: "+O);break;case 133:s[O.pos]=O,T.snames.push(O.name);break;case 10:{if(--Y)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=oi(o),t.sheetRows&&t.sheetRows<=o.e.r){var ae=o.e.r;o.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=oi(o),o.e.r=ae}o.e.r++,o.e.c++}q.length>0&&(i["!merges"]=q),U.length>0&&(i["!objects"]=U),se.length>0&&(i["!cols"]=se),de.length>0&&(i["!rows"]=de),A.Sheets.push(L)}u===""?d=i:n[u]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(T.biff===8&&(T.biff={9:2,521:3,1033:4}[X]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[O.BIFFVer]||8),T.biffguess=O.BIFFVer==0,O.BIFFVer==0&&O.dt==4096&&(T.biff=5,J=!0,fu(T.codepage=28591)),T.biff==8&&O.BIFFVer==0&&O.dt==16&&(T.biff=2),Y++)break;if(i=t.dense?[]:{},T.biff<8&&!J&&(J=!0,fu(T.codepage=t.codepage||1252)),T.biff<5||O.BIFFVer==0&&O.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var I={pos:e.l-Q,name:u};s[I.pos]=I,T.snames.push(u)}else u=(s[V]||{name:""}).name;O.dt==32&&(i["!type"]="chart"),O.dt==64&&(i["!type"]="macro"),q=[],U=[],T.arrayf=v=[],se=[],de=[],z=!1,L={Hidden:(s[V]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[O.r]||[])[O.c]:i[Yn({c:O.c,r:O.r})])&&++O.c,w={ixfe:O.ixfe,XF:k[O.ixfe]||{},v:O.val,t:"n"},C>0&&(w.z=K[w.ixfe>>8&63]),Lu(w,t,r.opts.Date1904),E({c:O.c,r:O.r},w,t);break;case 5:case 517:w={ixfe:O.ixfe,XF:k[O.ixfe],v:O.val,t:O.t},C>0&&(w.z=K[w.ixfe>>8&63]),Lu(w,t,r.opts.Date1904),E({c:O.c,r:O.r},w,t);break;case 638:w={ixfe:O.ixfe,XF:k[O.ixfe],v:O.rknum,t:"n"},C>0&&(w.z=K[w.ixfe>>8&63]),Lu(w,t,r.opts.Date1904),E({c:O.c,r:O.r},w,t);break;case 189:for(var Z=O.c;Z<=O.C;++Z){var me=O.rkrec[Z-O.c][0];w={ixfe:me,XF:k[me],v:O.rkrec[Z-O.c][1],t:"n"},C>0&&(w.z=K[w.ixfe>>8&63]),Lu(w,t,r.opts.Date1904),E({c:Z,r:O.r},w,t)}break;case 6:case 518:case 1030:{if(O.val=="String"){l=O;break}if(w=Tb(O.val,O.cell.ixfe,O.tt),w.XF=k[w.ixfe],t.cellFormula){var Te=O.formula;if(Te&&Te[0]&&Te[0][0]&&Te[0][0][0]=="PtgExp"){var Ae=Te[0][0][1][0],Be=Te[0][0][1][1],Ee=Yn({r:Ae,c:Be});b[Ee]?w.f=""+Mo(O.formula,o,O.cell,G,T):w.F=((t.dense?(i[Ae]||[])[Be]:i[Ee])||{}).F}else w.f=""+Mo(O.formula,o,O.cell,G,T)}C>0&&(w.z=K[w.ixfe>>8&63]),Lu(w,t,r.opts.Date1904),E(O.cell,w,t),l=O}break;case 7:case 519:if(l)l.val=O,w=Tb(O,l.cell.ixfe,"s"),w.XF=k[w.ixfe],t.cellFormula&&(w.f=""+Mo(l.formula,o,l.cell,G,T)),C>0&&(w.z=K[w.ixfe>>8&63]),Lu(w,t,r.opts.Date1904),E(l.cell,w,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{v.push(O);var ze=Yn(O[0].s);if(p=t.dense?(i[O[0].s.r]||[])[O[0].s.c]:i[ze],t.cellFormula&&p){if(!l||!ze||!p)break;p.f=""+Mo(O[1],o,O[0],G,T),p.F=oi(O[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!l)break;b[Yn(l.cell)]=O[0],p=t.dense?(i[l.cell.r]||[])[l.cell.c]:i[Yn(l.cell)],(p||{}).f=""+Mo(O[0],o,f,G,T)}}break;case 253:w=Tb(c[O.isst].t,O.ixfe,"s"),c[O.isst].h&&(w.h=c[O.isst].h),w.XF=k[w.ixfe],C>0&&(w.z=K[w.ixfe>>8&63]),Lu(w,t,r.opts.Date1904),E({c:O.c,r:O.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:O.ixfe,XF:k[O.ixfe],t:"z"},C>0&&(w.z=K[w.ixfe>>8&63]),Lu(w,t,r.opts.Date1904),E({c:O.c,r:O.r},w,t));break;case 190:if(t.sheetStubs)for(var Xe=O.c;Xe<=O.C;++Xe){var Pt=O.ixfe[Xe-O.c];w={ixfe:Pt,XF:k[Pt],t:"z"},C>0&&(w.z=K[w.ixfe>>8&63]),Lu(w,t,r.opts.Date1904),E({c:Xe,r:O.r},w,t)}break;case 214:case 516:case 4:w=Tb(O.val,O.ixfe,"s"),w.XF=k[w.ixfe],C>0&&(w.z=K[w.ixfe>>8&63]),Lu(w,t,r.opts.Date1904),E({c:O.c,r:O.r},w,t);break;case 0:case 512:Y===1&&(o=O);break;case 252:c=O;break;case 1054:if(T.biff==4){K[C++]=O[1];for(var ft=0;ft<C+163&&Gn[ft]!=O[1];++ft);ft>=163&&$d(O[1],C+163)}else $d(O[1],O[0]);break;case 30:{K[C++]=O;for(var He=0;He<C+163&&Gn[He]!=O;++He);He>=163&&$d(O,C+163)}break;case 229:q=q.concat(O);break;case 93:U[O.cmo[0]]=T.lastobj=O;break;case 438:T.lastobj.TxO=O;break;case 127:T.lastobj.ImData=O;break;case 440:for(y=O[0].s.r;y<=O[0].e.r;++y)for(g=O[0].s.c;g<=O[0].e.c;++g)p=t.dense?(i[y]||[])[g]:i[Yn({c:g,r:y})],p&&(p.l=O[1]);break;case 2048:for(y=O[0].s.r;y<=O[0].e.r;++y)for(g=O[0].s.c;g<=O[0].e.c;++g)p=t.dense?(i[y]||[])[g]:i[Yn({c:g,r:y})],p&&p.l&&(p.l.Tooltip=O[1]);break;case 28:{if(T.biff<=5&&T.biff>=2)break;p=t.dense?(i[O[0].r]||[])[O[0].c]:i[Yn(O[0])];var tt=U[O[2]];p||(t.dense?(i[O[0].r]||(i[O[0].r]=[]),p=i[O[0].r][O[0].c]={t:"z"}):p=i[Yn(O[0])]={t:"z"},o.e.r=Math.max(o.e.r,O[0].r),o.s.r=Math.min(o.s.r,O[0].r),o.e.c=Math.max(o.e.c,O[0].c),o.s.c=Math.min(o.s.c,O[0].c)),p.c||(p.c=[]),m={a:O[1],t:tt.TxO.t},p.c.push(m)}break;case 2173:Ple(k[O.ixfe],O.ext);break;case 125:{if(!T.cellStyles)break;for(;O.e>=O.s;)se[O.e--]={width:O.w/256,level:O.level||0,hidden:!!(O.flags&1)},z||(z=!0,eC(O.w/256)),hh(se[O.e+1])}break;case 520:{var _e={};O.level!=null&&(de[O.r]=_e,_e.level=O.level),O.hidden&&(de[O.r]=_e,_e.hidden=!0),O.hpt&&(de[O.r]=_e,_e.hpt=O.hpt,_e.hpx=Dm(O.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||l0(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[X]]=O;break;case 161:i["!margins"]||l0(i["!margins"]={}),i["!margins"].header=O.header,i["!margins"].footer=O.footer;break;case 574:O.RTL&&(A.Views[0].RTL=!0);break;case 146:j=O;break;case 2198:B=O;break;case 140:S=O;break;case 442:u?L.CodeName=O||L.name:A.WBProps.CodeName=O||"ThisWorkbook";break}}else ne||console.error("Missing Info for XLS Record 0x"+X.toString(16)),e.l+=Q}return r.SheetNames=Ga(s).sort(function(Se,he){return Number(Se)-Number(he)}).map(function(Se){return s[Se].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&H.forEach(function(Se,he){r.Sheets[r.SheetNames[he]]["!autofilter"]=Se}),r.Strings=c,r.SSF=ya(Gn),T.enc&&(r.Encryption=T.enc),B&&(r.Themes=B),r.Metadata={},S!==void 0&&(r.Metadata.Country=S),G.names.length>0&&(A.Names=G.names),r.Workbook=A,r}var Lx={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Hhe(e,t,r){var n=Wn.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=RP(n,$4,Lx.DSI);for(var s in i)t[s]=i[s]}catch(u){if(r.WTF)throw u}var o=Wn.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=RP(o,U4,Lx.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(M$(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Vhe(e,t){var r=[],n=[],i=[],s=0,o,l=dP($4,"n"),c=dP(U4,"n");if(e.Props)for(o=Ga(e.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:i).push([o[s],e.Props[o[s]]]);if(e.Custprops)for(o=Ga(e.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:i).push([o[s],e.Custprops[o[s]]]);var u=[];for(s=0;s<i.length;++s)$$.indexOf(i[s][0])>-1||O$.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);n.length&&Wn.utils.cfb_add(t,"/SummaryInformation",FP(n,Lx.SI,c,U4)),(r.length||u.length)&&Wn.utils.cfb_add(t,"/DocumentSummaryInformation",FP(r,Lx.DSI,l,$4,u.length?u:null,Lx.UDI))}function RU(e,t){t||(t={}),cC(t),T3(),t.codepage&&E3(t.codepage);var r,n;if(e.FullPaths){if(Wn.find(e,"/encryption"))throw new Error("File is password-protected");r=Wn.find(e,"!CompObj"),n=Wn.find(e,"/Workbook")||Wn.find(e,"/Book")}else{switch(t.type){case"base64":e=Ql(lc(e));break;case"binary":e=Ql(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}fo(e,0),n={content:e}}var i,s;if(r&&Uhe(r),t.bookProps&&!t.bookSheets)i={};else{var o=mi?"buffer":"array";if(n&&n.content)i=qhe(n.content,t);else if((s=Wn.find(e,"PerfectOffice_MAIN"))&&s.content)i=o0.to_workbook(s.content,(t.type=o,t));else if((s=Wn.find(e,"NativeContent_MAIN"))&&s.content)i=o0.to_workbook(s.content,(t.type=o,t));else throw(s=Wn.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Wn.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=ace(e))}var l={};return e.FullPaths&&Hhe(e,l,t),i.Props=i.Custprops=l,t.bookFiles&&(i.cfb=e),i}function Ghe(e,t){var r=t||{},n=Wn.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Wn.utils.cfb_add(n,i,FU(e,r)),r.biff==8&&(e.Props||e.Custprops)&&Vhe(e,n),r.biff==8&&e.vbaraw&&sce(n,Wn.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var b1={0:{f:xde},1:{f:jde},2:{f:qde},3:{f:Mde},4:{f:Ede},5:{f:Ude},6:{f:Yde},7:{f:Bde},8:{f:rfe},9:{f:tfe},10:{f:Zde},11:{f:efe},12:{f:Nde},13:{f:Vde},14:{f:Rde},15:{f:Pde},16:{f:NU},17:{f:Qde},18:{f:Dde},19:{f:q3},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Qfe},40:{},42:{},43:{f:Yoe},44:{f:Goe},45:{f:Joe},46:{f:ele},47:{f:Zoe},48:{},49:{f:vie},50:{},51:{f:Lle},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Q$},62:{f:Kde},63:{f:Wle},64:{f:yfe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:zo,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:pfe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:_de},148:{f:vde,p:16},151:{f:lfe},152:{},153:{f:Kfe},154:{},155:{},156:{f:Vfe},157:{},158:{},159:{T:1,f:uoe},160:{T:-1},161:{T:1,f:ep},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:nfe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Ole},336:{T:-1},337:{f:Ble,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:D4},357:{},358:{},359:{},360:{T:1},361:{},362:{f:X$},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:cfe},427:{f:ufe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:ffe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Sde},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:sfe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:D4},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:ece},633:{T:1},634:{T:-1},635:{T:1,f:Jle},636:{T:-1},637:{f:kie},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Rfe},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:bfe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},G4={6:{f:nk},10:{f:Af},12:{f:ps},13:{f:ps},14:{f:Za},15:{f:Za},16:{f:Io},17:{f:Za},18:{f:Za},19:{f:ps},20:{f:zP},21:{f:zP},23:{f:X$},24:{f:qP},25:{f:Za},26:{},27:{},28:{f:bse},29:{},34:{f:Za},35:{f:WP},38:{f:Io},39:{f:Io},40:{f:Io},41:{f:Io},42:{f:Za},43:{f:Za},47:{f:Poe},49:{f:Vae},51:{f:ps},60:{},61:{f:Uae},64:{f:Za},65:{f:Hae},66:{f:ps},77:{},80:{},81:{},82:{},85:{f:ps},89:{},90:{},91:{},92:{f:Tae},93:{f:Sse},94:{},95:{f:Za},96:{},97:{},99:{f:Za},125:{f:Q$},128:{f:ose},129:{f:Oae},130:{f:ps},131:{f:Za},132:{f:Za},133:{f:Mae},134:{},140:{f:Tse},141:{f:ps},144:{},146:{f:Mse},151:{},152:{},153:{},154:{},155:{},156:{f:ps},157:{},158:{},160:{f:$se},161:{f:Fse},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:nse},190:{f:ise},193:{f:Af},197:{},198:{},199:{},200:{},201:{},202:{f:Za},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ps},220:{},221:{f:Za},222:{},224:{f:sse},225:{f:Eae},226:{f:Af},227:{},229:{f:vse},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Rae},253:{f:Kae},255:{f:Bae},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:U$},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Za},353:{f:Af},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:fse},431:{f:Za},432:{},433:{},434:{},437:{},438:{f:jse},439:{f:Za},440:{f:Ase},441:{},442:{f:ay},443:{},444:{f:ps},445:{},446:{},448:{f:Af},449:{f:$ae,r:2},450:{f:Af},512:{f:DP},513:{f:Dse},515:{f:use},516:{f:Xae},517:{f:UP},519:{f:Use},520:{f:Iae},523:{},545:{f:HP},549:{f:IP},566:{},574:{f:Wae},638:{f:rse},659:{},1048:{},1054:{f:Jae},1084:{},1212:{f:gse},2048:{f:Cse},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Nb},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Af},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Lse,r:12},2173:{f:Tle,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Za,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:mse,r:12},2197:{},2198:{f:kle,r:12},2199:{},2200:{},2201:{},2202:{f:xse,r:12},2203:{f:Af},2204:{},2205:{},2206:{},2207:{},2211:{f:Dae},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ps},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Bse},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Ose},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:DP},1:{},2:{f:Vse},3:{f:qse},4:{f:Wse},5:{f:UP},7:{f:Kse},8:{},9:{f:Nb},11:{},22:{f:ps},30:{f:ese},31:{},32:{},33:{f:HP},36:{},37:{f:IP},50:{f:Yse},62:{},52:{},67:{},68:{f:ps},69:{},86:{},126:{},127:{f:zse},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Xse},223:{},234:{},354:{},421:{},518:{f:nk},521:{f:Nb},536:{f:qP},547:{f:WP},561:{},579:{},1030:{f:nk},1033:{f:Nb},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function cn(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&U3(r)&&e.push(r)}}function Khe(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return cn(e,t,r,i);var s=t;if(!isNaN(s)){for(var o=r.parts||[],l=0,c=0,u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;var d=e.next(4);for(d.write_shift(2,s),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<i;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function cy(e,t,r){return e||(e=wr(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Yhe(e,t,r,n){var i=wr(9);return cy(i,e,t),z$(r,n||"b",i),i}function Xhe(e,t,r){var n=wr(8+2*r.length);return cy(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Qhe(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?Ms(xa(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?cn(e,2,Gse(r,n,i)):cn(e,3,Hse(r,n,i));return;case"b":case"e":cn(e,5,Yhe(r,n,t.v,t.t));return;case"s":case"str":cn(e,4,Xhe(r,n,(t.v||"").slice(0,255)));return}cn(e,1,cy(null,r,n))}function Jhe(e,t,r,n){var i=Array.isArray(t),s=Ni(t["!ref"]||"A1"),o,l="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=oi(s)}for(var u=s.s.r;u<=s.e.r;++u){l=os(u);for(var d=s.s.c;d<=s.e.c;++d){u===s.s.r&&(c[d]=Ta(d)),o=c[d]+l;var f=i?(t[u]||[])[d]:t[o];f&&Qhe(e,f,u,d)}}}function Zhe(e,t){for(var r=t||{},n=Pl(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return cn(n,r.biff==4?1033:r.biff==3?521:9,Q3(e,16,r)),Jhe(n,e.Sheets[e.SheetNames[i]],i,r),cn(n,10),n.end()}function e0e(e,t,r){cn(e,49,Gae({sz:12,name:"Arial"},r))}function t0e(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&cn(e,1054,Zae(i,t[i],r))})}function r0e(e,t){var r=wr(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),cn(e,2151,r),r=wr(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),G$(Ni(t["!ref"]||"A1"),r),r.write_shift(4,4),cn(e,2152,r)}function n0e(e,t){for(var r=0;r<16;++r)cn(e,224,$P({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){cn(e,224,$P(n,0,t))})}function i0e(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];cn(e,440,Nse(n)),n[1].Tooltip&&cn(e,2048,Ese(n))}delete t["!links"]}function a0e(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&cn(e,125,Rse(MS(i,n),i))})}}function s0e(e,t,r,n,i){var s=16+Ah(i.cellXfs,t,i);if(t.v==null&&!t.bf){cn(e,513,A0(r,n,s));return}if(t.bf)cn(e,6,Oue(t,r,n,i,s));else switch(t.t){case"d":case"n":var o=t.t=="d"?Ms(xa(t.v)):t.v;cn(e,515,dse(r,n,o,s));break;case"b":case"e":cn(e,517,cse(r,n,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var l=aC(i.Strings,t.v,i.revStrings);cn(e,253,Yae(r,n,l,s))}else cn(e,516,Qae(r,n,(t.v||"").slice(0,255),s,i));break;default:cn(e,513,A0(r,n,s))}}function o0e(e,t,r){var n=Pl(),i=r.SheetNames[e],s=r.Sheets[i]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(s),u=t.biff==8,d,f="",h=[],p=Ni(s["!ref"]||"A1"),m=u?65536:16384;if(p.e.c>255||p.e.r>=m){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,m-1)}cn(n,2057,Q3(r,16,t)),cn(n,13,Pc(1)),cn(n,12,Pc(100)),cn(n,15,Jo(!0)),cn(n,17,Jo(!1)),cn(n,16,k0(.001)),cn(n,95,Jo(!0)),cn(n,42,Jo(!1)),cn(n,43,Jo(!1)),cn(n,130,Pc(1)),cn(n,128,lse()),cn(n,131,Jo(!1)),cn(n,132,Jo(!1)),u&&a0e(n,s["!cols"]),cn(n,512,tse(p,t)),u&&(s["!links"]=[]);for(var g=p.s.r;g<=p.e.r;++g){f=os(g);for(var y=p.s.c;y<=p.e.c;++y){g===p.s.r&&(h[y]=Ta(y)),d=h[y]+f;var b=c?(s[g]||[])[y]:s[d];b&&(s0e(n,b,g,y,t),u&&b.l&&s["!links"].push([d,b.l]))}}var v=l.CodeName||l.name||i;return u&&cn(n,574,qae((o.Views||[])[0])),u&&(s["!merges"]||[]).length&&cn(n,229,wse(s["!merges"])),u&&i0e(n,s),cn(n,442,W$(v)),u&&r0e(n,s),cn(n,10),n.end()}function l0e(e,t,r){var n=Pl(),i=(e||{}).Workbook||{},s=i.Sheets||[],o=i.WBProps||{},l=r.biff==8,c=r.biff==5;if(cn(n,2057,Q3(e,5,r)),r.bookType=="xla"&&cn(n,135),cn(n,225,l?Pc(1200):null),cn(n,193,cae(2)),c&&cn(n,191),c&&cn(n,192),cn(n,226),cn(n,92,Pae("SheetJS",r)),cn(n,66,Pc(l?1200:1252)),l&&cn(n,353,Pc(0)),l&&cn(n,448),cn(n,317,Ise(e.SheetNames.length)),l&&e.vbaraw&&cn(n,211),l&&e.vbaraw){var u=o.CodeName||"ThisWorkbook";cn(n,442,W$(u))}cn(n,156,Pc(17)),cn(n,25,Jo(!1)),cn(n,18,Jo(!1)),cn(n,19,Pc(0)),l&&cn(n,431,Jo(!1)),l&&cn(n,444,Pc(0)),cn(n,61,zae()),cn(n,64,Jo(!1)),cn(n,141,Pc(0)),cn(n,34,Jo($fe(e)=="true")),cn(n,14,Jo(!0)),l&&cn(n,439,Jo(!1)),cn(n,218,Pc(0)),e0e(n,e,r),t0e(n,e.SSF,r),n0e(n,r),l&&cn(n,352,Jo(!1));var d=n.end(),f=Pl();l&&cn(f,140,Pse()),l&&r.Strings&&Khe(f,252,Fae(r.Strings)),cn(f,10);var h=f.end(),p=Pl(),m=0,g=0;for(g=0;g<e.SheetNames.length;++g)m+=(l?12:11)+(l?2:1)*e.SheetNames[g].length;var y=d.length+m+h.length;for(g=0;g<e.SheetNames.length;++g){var b=s[g]||{};cn(p,133,Lae({pos:y,hs:b.Hidden||0,dt:0,name:e.SheetNames[g]},r)),y+=t[g].length}var v=p.end();if(m!=v.length)throw new Error("BS8 "+m+" != "+v.length);var w=[];return d.length&&w.push(d),v.length&&w.push(v),h.length&&w.push(h),Vs(w)}function c0e(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=ya(Gn)),e&&e.SSF&&(og(),AS(e.SSF),r.revssf=CS(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,uC(r),r.cellXfs=[],Ah(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=o0e(i,r,e);return n.unshift(l0e(e,n,r)),Vs(n)}function FU(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Ol(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return c0e(e,t);case 4:case 3:case 2:return Zhe(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function tO(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=i.index,l=s&&s.index||e.length,c=Gne(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(o=0;o<c.length;++o){var g=c[o].trim(),y=g.slice(0,3).toLowerCase();if(y=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(y!="<td"&&y!="<th")){var b=g.split(/<\/t[dh]>/i);for(l=0;l<b.length;++l){var v=b[l].trim();if(v.match(/<t[dh]/i)){for(var w=v,S=0;w.charAt(0)=="<"&&(S=w.indexOf(">"))>-1;)w=w.slice(S+1);for(var k=0;k<m.length;++k){var j=m[k];j.s.c==d&&j.s.r<u&&u<=j.e.r&&(d=j.e.c+1,k=-1)}var A=Xn(v.slice(0,v.indexOf(">")));h=A.colspan?+A.colspan:1,((f=+A.rowspan)>1||h>1)&&m.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+h-1}});var L=A.t||A["data-t"]||"";if(!w.length){d+=h;continue}if(w=s$(w),p.s.r>u&&(p.s.r=u),p.e.r<u&&(p.e.r=u),p.s.c>d&&(p.s.c=d),p.e.c<d&&(p.e.c=d),!w.length){d+=h;continue}var P={t:"s",v:w};r.raw||!w.trim().length||L=="s"||(w==="TRUE"?P={t:"b",v:!0}:w==="FALSE"?P={t:"b",v:!1}:isNaN(gu(w))?isNaN(Bm(w).getDate())||(P={t:"d",v:xa(w)},r.cellDates||(P={t:"n",v:Ms(P.v)}),P.z=r.dateNF||Gn[14]):P={t:"n",v:gu(w)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=P):n[Yn({r:u,c:d})]=P,d+=h}}}}return n["!ref"]=oi(p),m.length&&(n["!merges"]=m),n}function u0e(e,t,r,n){for(var i=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>o)&&!(i[u].e.r<r||i[u].e.c<o)){if(i[u].s.r<r||i[u].s.c<o){l=-1;break}l=i[u].e.r-i[u].s.r+1,c=i[u].e.c-i[u].s.c+1;break}if(!(l<0)){var d=Yn({r,c:o}),f=n.dense?(e[r]||[])[o]:e[d],h=f&&f.v!=null&&(f.h||I3(f.w||(Yd(f),f.w)||""))||"",p={};l>1&&(p.rowspan=l),c>1&&(p.colspan=c),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(p["data-t"]=f&&f.t||"z",f.v!=null&&(p["data-v"]=f.v),f.z!=null&&(p["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),p.id=(n.id||"sjs")+"-"+d,s.push(ln("td",h,p))}}var m="<tr>";return m+s.join("")+"</tr>"}var d0e='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',f0e="</body></html>";function h0e(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return jh(tO(r[0],t),t);var n=hC();return r.forEach(function(i,s){pC(n,tO(i,t),"Sheet"+(s+1))}),n}function p0e(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function BU(e,t){var r=t||{},n=r.header!=null?r.header:d0e,i=r.footer!=null?r.footer:f0e,s=[n],o=Ol(e["!ref"]);r.dense=Array.isArray(e),s.push(p0e(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)s.push(u0e(e,o,l,r));return s.push("</table>"+i),s.join("")}function IU(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?Pa(n.origin):n.origin;i=o.r,s=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var d=Ol(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),i==-1&&(u.e.r=i=d.e.r+1)}var f=[],h=0,p=e["!rows"]||(e["!rows"]=[]),m=0,g=0,y=0,b=0,v=0,w=0;for(e["!cols"]||(e["!cols"]=[]);m<l.length&&g<c;++m){var S=l[m];if(rO(S)){if(n.display)continue;p[g]={hidden:!0}}var k=S.children;for(y=b=0;y<k.length;++y){var j=k[y];if(!(n.display&&rO(j))){var A=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):s$(j.innerHTML),L=j.getAttribute("data-z")||j.getAttribute("z");for(h=0;h<f.length;++h){var P=f[h];P.s.c==b+s&&P.s.r<g+i&&g+i<=P.e.r&&(b=P.e.c+1-s,h=-1)}w=+j.getAttribute("colspan")||1,((v=+j.getAttribute("rowspan")||1)>1||w>1)&&f.push({s:{r:g+i,c:b+s},e:{r:g+i+(v||1)-1,c:b+s+(w||1)-1}});var F={t:"s",v:A},E=j.getAttribute("data-t")||j.getAttribute("t")||"";A!=null&&(A.length==0?F.t=E||"z":n.raw||A.trim().length==0||E=="s"||(A==="TRUE"?F={t:"b",v:!0}:A==="FALSE"?F={t:"b",v:!1}:isNaN(gu(A))?isNaN(Bm(A).getDate())||(F={t:"d",v:xa(A)},n.cellDates||(F={t:"n",v:Ms(F.v)}),F.z=n.dateNF||Gn[14]):F={t:"n",v:gu(A)})),F.z===void 0&&L!=null&&(F.z=L);var T="",B=j.getElementsByTagName("A");if(B&&B.length)for(var q=0;q<B.length&&!(B[q].hasAttribute("href")&&(T=B[q].getAttribute("href"),T.charAt(0)!="#"));++q);T&&T.charAt(0)!="#"&&(F.l={Target:T}),n.dense?(e[g+i]||(e[g+i]=[]),e[g+i][b+s]=F):e[Yn({c:b+s,r:g+i})]=F,u.e.c<b+s&&(u.e.c=b+s),b+=w}}++g}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,g-1+i),e["!ref"]=oi(u),g>=c&&(e["!fullref"]=oi((u.e.r=l.length-m+g-1+i,u))),e}function DU(e,t){var r=t||{},n=r.dense?[]:{};return IU(n,e,t)}function m0e(e,t){return jh(DU(e,t),t)}function rO(e){var t="",r=g0e(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function g0e(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function x0e(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ai(t.replace(/<[^>]*>/g,""));return[r]}var nO={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function $U(e,t){var r=t||{},n=D3(e),i=[],s,o,l={name:""},c="",u=0,d,f,h={},p=[],m=r.dense?[]:{},g,y,b={value:""},v="",w=0,S=[],k=-1,j=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},L=0,P={},F=[],E={},T=0,B=0,q=[],U=1,se=1,de=[],z={Names:[]},G={},ie=["",""],Y=[],C={},K="",H=0,R=!1,J=!1,V=0;for(h1.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=h1.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?m["!ref"]=oi(A):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(m["!fullref"]=m["!ref"],A.e.r=r.sheetRows-1,m["!ref"]=oi(A)),F.length&&(m["!merges"]=F),q.length&&(m["!rows"]=q),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),p.push(d.name),h[d.name]=m,J=!1):g[0].charAt(g[0].length-2)!=="/"&&(d=Xn(g[0],!1),k=j=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,m=r.dense?[]:{},F=[],q=[],J=!0);break;case"table-row-group":g[1]==="/"?--L:++L;break;case"table-row":case"":if(g[1]==="/"){k+=U,U=1;break}if(f=Xn(g[0],!1),f.?k=f.-1:k==-1&&(k=0),U=+f["number-rows-repeated"]||1,U<10)for(V=0;V<U;++V)L>0&&(q[k+V]={level:L});j=-1;break;case"covered-table-cell":g[1]!=="/"&&++j,r.sheetStubs&&(r.dense?(m[k]||(m[k]=[]),m[k][j]={t:"z"}):m[Yn({r:k,c:j})]={t:"z"}),v="",S=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++j,b=Xn(g[0],!1),se=parseInt(b["number-columns-repeated"]||"1",10),y={t:"z",v:null},b.formula&&r.cellFormula!=!1&&(y.f=JP(Ai(b.formula))),(b.||b["value-type"])=="string"&&(y.t="s",y.v=Ai(b["string-value"]||""),r.dense?(m[k]||(m[k]=[]),m[k][j]=y):m[Yn({r:k,c:j})]=y),j+=se-1;else if(g[1]!=="/"){++j,v="",w=0,S=[],se=1;var X=U?k+U-1:k;if(j>A.e.c&&(A.e.c=j),j<A.s.c&&(A.s.c=j),k<A.s.r&&(A.s.r=k),X>A.e.r&&(A.e.r=X),b=Xn(g[0],!1),Y=[],C={},y={t:b.||b["value-type"],v:null},r.cellFormula)if(b.formula&&(b.formula=Ai(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(T=parseInt(b["number-matrix-rows-spanned"],10)||0,B=parseInt(b["number-matrix-columns-spanned"],10)||0,E={s:{r:k,c:j},e:{r:k+T-1,c:j+B-1}},y.F=oi(E),de.push([E,y.F])),b.formula)y.f=JP(b.formula);else for(V=0;V<de.length;++V)k>=de[V][0].s.r&&k<=de[V][0].e.r&&j>=de[V][0].s.c&&j<=de[V][0].e.c&&(y.F=de[V][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(T=parseInt(b["number-rows-spanned"],10)||0,B=parseInt(b["number-columns-spanned"],10)||0,E={s:{r:k,c:j},e:{r:k+T-1,c:j+B-1}},F.push(E)),b["number-columns-repeated"]&&(se=parseInt(b["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=pa(b["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(b.value);break;case"percentage":y.t="n",y.v=parseFloat(b.value);break;case"currency":y.t="n",y.v=parseFloat(b.value);break;case"date":y.t="d",y.v=xa(b["date-value"]),r.cellDates||(y.t="n",y.v=Ms(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=qne(b["time-value"])/86400,r.cellDates&&(y.t="d",y.v=ES(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(b.);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",b["string-value"]!=null&&(v=Ai(b["string-value"]),S=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(R=!1,y.t==="s"&&(y.v=v||"",S.length&&(y.R=S),R=w==0),G.Target&&(y.l=G),Y.length>0&&(y.c=Y,Y=[]),v&&r.cellText!==!1&&(y.w=v),R&&(y.t="z",delete y.v),(!R||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=k))for(var Q=0;Q<U;++Q){if(se=parseInt(b["number-columns-repeated"]||"1",10),r.dense)for(m[k+Q]||(m[k+Q]=[]),m[k+Q][j]=Q==0?y:ya(y);--se>0;)m[k+Q][j+se]=ya(y);else for(m[Yn({r:k+Q,c:j})]=y;--se>0;)m[Yn({r:k+Q,c:j+se})]=ya(y);A.e.c<=j&&(A.e.c=j)}se=parseInt(b["number-columns-repeated"]||"1",10),j+=se-1,se=0,y={},v="",S=[]}G={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((s=i.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((s=i.pop())[0]!==g[3])throw"Bad state: "+s;C.t=v,S.length&&(C.R=S),C.a=K,Y.push(C)}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);K="",H=0,v="",w=0,S=[];break;case"creator":g[1]==="/"?K=n.slice(H,g.index):H=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((s=i.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);v="",w=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(P[l.name]=c,(s=i.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&(c="",l=Xn(g[0],!1),i.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Xn(g[0],!1),c+=nO[g[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Xn(g[0],!1),c+=nO[g[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,g.index);break}else u=g.index+g[0].length;break;case"named-range":o=Xn(g[0],!1),ie=ik(o["cell-range-address"]);var ne={Name:o.name,Ref:ie[0]+"!"+ie[1]};J&&(ne.Sheet=p.length),z.Names.push(ne);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(g[1]==="/"&&(!b||!b["string-value"])){var oe=x0e(n.slice(w,g.index));v=(v.length>0?v+`
`:"")+oe[0]}else Xn(g[0],!1),w=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{ie=ik(Xn(g[0])["target-range-address"]),h[ie[0]]["!autofilter"]={ref:ie[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(G=Xn(g[0],!1),!G.href)break;G.Target=Ai(G.href),delete G.href,G.Target.charAt(0)=="#"&&G.Target.indexOf(".")>-1?(ie=ik(G.Target.slice(1)),G.Target="#"+ie[0]+"!"+ie[1]):G.Target.match(/^\.\.[\\\/]/)&&(G.Target=G.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var O={Sheets:h,SheetNames:p,Workbook:z};return r.bookSheets&&delete O.Sheets,O}function iO(e,t){t=t||{},Tc(e,"META-INF/manifest.xml")&&qie(hs(e,"META-INF/manifest.xml"),t);var r=Jl(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=$U(Qi(r),t);return Tc(e,"meta.xml")&&(n.Props=T$(hs(e,"meta.xml"))),n}function aO(e,t){return $U(e,t)}var y0e=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+f1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ls+t}}(),sO=function(){var e=function(s){return Vi(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,o,l){var c=[];c.push('      <table:table table:name="'+Vi(o.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,d=0,f=Ol(s["!ref"]||"A1"),h=s["!merges"]||[],p=0,m=Array.isArray(s);if(s["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var g="",y=s["!rows"]||[];for(u=0;u<f.s.r;++u)g=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+g+`></table:table-row>
`);for(;u<=f.e.r;++u){for(g=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+g+`>
`),d=0;d<f.s.c;++d)c.push(t);for(;d<=f.e.c;++d){var b=!1,v={},w="";for(p=0;p!=h.length;++p)if(!(h[p].s.c>d)&&!(h[p].s.r>u)&&!(h[p].e.c<d)&&!(h[p].e.r<u)){(h[p].s.c!=d||h[p].s.r!=u)&&(b=!0),v["table:number-columns-spanned"]=h[p].e.c-h[p].s.c+1,v["table:number-rows-spanned"]=h[p].e.r-h[p].s.r+1;break}if(b){c.push(r);continue}var S=Yn({r:u,c:d}),k=m?(s[u]||[])[d]:s[S];if(k&&k.f&&(v["table:formula"]=Vi(Iue(k.f)),k.F&&k.F.slice(0,S.length)==S)){var j=Ol(k.F);v["table:number-matrix-columns-spanned"]=j.e.c-j.s.c+1,v["table:number-matrix-rows-spanned"]=j.e.r-j.s.r+1}if(!k){c.push(t);continue}switch(k.t){case"b":w=k.v?"TRUE":"FALSE",v["office:value-type"]="boolean",v["office:boolean-value"]=k.v?"true":"false";break;case"n":w=k.w||String(k.v||0),v["office:value-type"]="float",v["office:value"]=k.v||0;break;case"s":case"str":w=k.v==null?"":k.v,v["office:value-type"]="string";break;case"d":w=k.w||xa(k.v).toISOString(),v["office:value-type"]="date",v["office:date-value"]=xa(k.v).toISOString(),v["table:style-name"]="ce1";break;default:c.push(t);continue}var A=e(w);if(k.l&&k.l.Target){var L=k.l.Target;L=L.charAt(0)=="#"?"#"+Due(L.slice(1)):L,L.charAt(0)!="#"&&!L.match(/^\w+:/)&&(L="../"+L),A=ln("text:a",A,{"xlink:href":L.replace(/&/g,"&amp;")})}c.push("          "+ln("table:table-cell",ln("text:p",A,{}),v)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},i=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;hh(f),f.ods=l;var h=u["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,l){var c=[ls],u=f1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=f1({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(E$().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),i(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(n(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function UU(e,t){if(t.bookType=="fods")return sO(e,t);var r=R3(),n="",i=[],s=[];return n="mimetype",hi(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",hi(r,n,sO(e,t)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",hi(r,n,y0e(e,t)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",hi(r,n,ls+E$()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",hi(r,n,Gie(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",hi(r,n,Hie(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function N0(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function K4(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Qi(kh(e))}function b0e(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ql(Xu(e))}function v0e(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function mh(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function oO(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function w0e(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function S0e(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=r>=0?0:128}function v1(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function zi(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Va(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ci(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=v1(e,r),s=i&7;i=Math.floor(i/8);var o=0,l;if(i==0)break;switch(s){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=v1(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:l,type:s};t[i]==null?t[i]=[u]:t[i].push(u)}return t}function so(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(zi(n*8+i.type)),i.type==2&&t.push(zi(i.data.length)),t.push(i.data))})}),mh(t)}function lC(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function jc(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=v1(e,n),s=Ci(e.slice(n[0],n[0]+i));n[0]+=i;var o={id:Va(s[1][0].data),messages:[]};s[2].forEach(function(l){var c=Ci(l.data),u=Va(c[3][0].data);o.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=s[3])!=null&&t[0]&&(o.merge=Va(s[3][0].data)>>>0>0),r.push(o)}return r}function mp(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:zi(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:zi(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:zi(o.data.length)}],n[2].push({data:so(o.meta),type:2})});var s=so(n);t.push(zi(s.length)),t.push(s),i.forEach(function(o){return t.push(o)})}),mh(t)}function _0e(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=v1(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}i.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,u=0;if(s==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,s==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[mh(i)],c==0)throw new Error("Invalid offset 0");if(c>i[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(i.push(i[0].slice(-c)),u-=c;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-c,-c+u))}}var d=mh(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Ac(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(_0e(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return mh(t)}function gp(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var s=zi(n),o=s.length;t.push(s),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,r+=n}return mh(t)}function k0e(e,t,r,n){var i=N0(e),s=i.getUint32(4,!0),o=(n>1?12:8)+oO(s&(n>1?3470:398))*4,l=-1,c=-1,u=NaN,d=new Date(2001,0,1);s&512&&(l=i.getUint32(o,!0),o+=4),o+=oO(s&(n>1?12288:4096))*4,s&16&&(c=i.getUint32(o,!0),o+=4),s&32&&(u=i.getFloat64(o,!0),o+=8),s&64&&(d.setTime(d.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function j0e(e,t,r){var n=N0(e),i=n.getUint32(8,!0),s=12,o=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);i&1&&(c=w0e(e,s),s+=16),i&2&&(u=n.getFloat64(s,!0),s+=8),i&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(l=n.getUint32(s,!0),s+=4),i&16&&(o=n.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return f}function sk(e,t){var r=new Uint8Array(32),n=N0(r),i=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,S0e(r,i,e.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,i)}function ok(e,t){var r=new Uint8Array(32),n=N0(r),i=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,i)}function A0e(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return k0e(e,t,r,e[0]);case 5:return j0e(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Oo(e){var t=Ci(e);return v1(t[1][0].data)}function lO(e,t){var r=Ci(t.data),n=Va(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(o){var l=Ci(o.data),c=Va(l[1][0].data)>>>0;switch(n){case 1:s[c]=K4(l[3][0].data);break;case 8:{var u=e[Oo(l[9][0].data)][0],d=Ci(u.data),f=e[Oo(d[1][0].data)][0],h=Va(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var p=Ci(f.data);s[c]=p[3].map(function(m){return K4(m.data)}).join("")}break}}),s}function N0e(e,t){var r,n,i,s,o,l,c,u,d,f,h,p,m,g,y=Ci(e),b=Va(y[1][0].data)>>>0,v=Va(y[2][0].data)>>>0,w=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&Va(y[8][0].data)>0||!1,S,k;if((s=(i=y[7])==null?void 0:i[0])!=null&&s.data&&t!=0)S=(l=(o=y[7])==null?void 0:o[0])==null?void 0:l.data,k=(u=(c=y[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=y[4])==null?void 0:d[0])!=null&&f.data&&t!=1)S=(p=(h=y[4])==null?void 0:h[0])==null?void 0:p.data,k=(g=(m=y[3])==null?void 0:m[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var j=w?4:1,A=N0(S),L=[],P=0;P<S.length/2;++P){var F=A.getUint16(P*2,!0);F<65535&&L.push([P,F])}if(L.length!=v)throw"Expected ".concat(v," cells, found ").concat(L.length);var E=[];for(P=0;P<L.length-1;++P)E[L[P][0]]=k.subarray(L[P][1]*j,L[P+1][1]*j);return L.length>=1&&(E[L[L.length-1][0]]=k.subarray(L[L.length-1][1]*j)),{R:b,cells:E}}function C0e(e,t){var r,n=Ci(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Va(n[7][0].data)>>>0>0?1:0:-1,s=lC(n[5],function(o){return N0e(o,i)});return{nrows:Va(n[4][0].data)>>>0,data:s.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,u){if(o[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));o[l.R][u]=c}),o},[])}}function E0e(e,t,r){var n,i=Ci(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Va(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Va(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=oi(s);var o=Ci(i[4][0].data),l=lO(e,e[Oo(o[4][0].data)][0]),c=(n=o[17])!=null&&n[0]?lO(e,e[Oo(o[17][0].data)][0]):[],u=Ci(o[3][0].data),d=0;u[1].forEach(function(f){var h=Ci(f.data),p=e[Oo(h[2][0].data)][0],m=Va(p.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var g=C0e(e,p);g.data.forEach(function(y,b){y.forEach(function(v,w){var S=Yn({r:d+b,c:w}),k=A0e(v,l,c);k&&(r[S]=k)})}),d+=g.nrows})}function T0e(e,t){var r=Ci(t.data),n={"!ref":"A1"},i=e[Oo(r[2][0].data)],s=Va(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return E0e(e,i[0],n),n}function P0e(e,t){var r,n=Ci(t.data),i={name:(r=n[1])!=null&&r[0]?K4(n[1][0].data):"",sheets:[]},s=lC(n[2],Oo);return s.forEach(function(o){e[o].forEach(function(l){var c=Va(l.meta[1][0].data);c==6e3&&i.sheets.push(T0e(e,l))})}),i}function O0e(e,t){var r=hC(),n=Ci(t.data),i=lC(n[1],Oo);if(i.forEach(function(s){e[s].forEach(function(o){var l=Va(o.meta[1][0].data);if(l==2){var c=P0e(e,o);c.sheets.forEach(function(u,d){pC(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function lk(e){var t,r,n,i,s={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=Ac(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=jc(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){s[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var l=((i=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Va(s[1][0].meta[1][0].data)==1&&s[1][0];if(l||o.forEach(function(c){s[c].forEach(function(u){var d=Va(u.meta[1][0].data)>>>0;if(d==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return O0e(s,l)}function M0e(e,t,r){var n,i,s,o;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(s=e[8])==null?void 0:s[0])==null?void 0:o.data)&&Va(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=N0(e[7][0].data),d=0,f=[],h=N0(e[4][0].data),p=0,m=[],g=0;g<t.length;++g){if(t[g]==null){u.setUint16(g*2,65535,!0),h.setUint16(g*2,65535);continue}u.setUint16(g*2,d,!0),h.setUint16(g*2,p,!0);var y,b;switch(typeof t[g]){case"string":y=sk({t:"s",v:t[g]},r),b=ok({t:"s",v:t[g]},r);break;case"number":y=sk({t:"n",v:t[g]},r),b=ok({t:"n",v:t[g]},r);break;case"boolean":y=sk({t:"b",v:t[g]},r),b=ok({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}f.push(y),d+=y.length,m.push(b),p+=b.length,++c}for(e[2][0].data=zi(c);g<e[7][0].data.length/2;++g)u.setUint16(g*2,65535,!0),h.setUint16(g*2,65535,!0);return e[6][0].data=mh(f),e[3][0].data=mh(m),c}function L0e(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ol(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(oi(n)));var s=V2(r,{range:n,header:1}),o=["~Sh33tJ5~"];s.forEach(function(K){return K.forEach(function(H){typeof H=="string"&&o.push(H)})});var l={},c=[],u=Wn.read(t.numbers,{type:"base64"});u.FileIndex.map(function(K,H){return[K,u.FullPaths[H]]}).forEach(function(K){var H=K[0],R=K[1];if(H.type==2&&H.name.match(/\.iwa/)){var J=H.content,V=Ac(J),X=jc(V);X.forEach(function(Q){c.push(Q.id),l[Q.id]={deps:[],location:R,type:Va(Q.messages[0].meta[1][0].data)}})}}),c.sort(function(K,H){return K-H});var d=c.filter(function(K){return K>1}).map(function(K){return[K,zi(K)]});u.FileIndex.map(function(K,H){return[K,u.FullPaths[H]]}).forEach(function(K){var H=K[0];if(K[1],!!H.name.match(/\.iwa/)){var R=jc(Ac(H.content));R.forEach(function(J){J.messages.forEach(function(V){d.forEach(function(X){J.messages.some(function(Q){return Va(Q.meta[1][0].data)!=11006&&v0e(Q.data,X[1])})&&l[X[0]].deps.push(J.id)})})})}});for(var f=Wn.find(u,l[1].location),h=jc(Ac(f.content)),p,m=0;m<h.length;++m){var g=h[m];g.id==1&&(p=g)}var y=Oo(Ci(p.messages[0].data)[1][0].data);for(f=Wn.find(u,l[y].location),h=jc(Ac(f.content)),m=0;m<h.length;++m)g=h[m],g.id==y&&(p=g);for(y=Oo(Ci(p.messages[0].data)[2][0].data),f=Wn.find(u,l[y].location),h=jc(Ac(f.content)),m=0;m<h.length;++m)g=h[m],g.id==y&&(p=g);for(y=Oo(Ci(p.messages[0].data)[2][0].data),f=Wn.find(u,l[y].location),h=jc(Ac(f.content)),m=0;m<h.length;++m)g=h[m],g.id==y&&(p=g);var b=Ci(p.messages[0].data);{b[6][0].data=zi(n.e.r+1),b[7][0].data=zi(n.e.c+1);var v=Oo(b[46][0].data),w=Wn.find(u,l[v].location),S=jc(Ac(w.content));{for(var k=0;k<S.length&&S[k].id!=v;++k);if(S[k].id!=v)throw"Bad ColumnRowUIDMapArchive";var j=Ci(S[k].messages[0].data);j[1]=[],j[2]=[],j[3]=[];for(var A=0;A<=n.e.c;++A){var L=[];L[1]=L[2]=[{type:0,data:zi(A+420690)}],j[1].push({type:2,data:so(L)}),j[2].push({type:0,data:zi(A)}),j[3].push({type:0,data:zi(A)})}j[4]=[],j[5]=[],j[6]=[];for(var P=0;P<=n.e.r;++P)L=[],L[1]=L[2]=[{type:0,data:zi(P+726270)}],j[4].push({type:2,data:so(L)}),j[5].push({type:0,data:zi(P)}),j[6].push({type:0,data:zi(P)});S[k].messages[0].data=so(j)}w.content=gp(mp(S)),w.size=w.content.length,delete b[46];var F=Ci(b[4][0].data);{F[7][0].data=zi(n.e.r+1);var E=Ci(F[1][0].data),T=Oo(E[2][0].data);w=Wn.find(u,l[T].location),S=jc(Ac(w.content));{if(S[0].id!=T)throw"Bad HeaderStorageBucket";var B=Ci(S[0].messages[0].data);for(P=0;P<s.length;++P){var q=Ci(B[2][0].data);q[1][0].data=zi(P),q[4][0].data=zi(s[P].length),B[2][P]={type:B[2][0].type,data:so(q)}}S[0].messages[0].data=so(B)}w.content=gp(mp(S)),w.size=w.content.length;var U=Oo(F[2][0].data);w=Wn.find(u,l[U].location),S=jc(Ac(w.content));{if(S[0].id!=U)throw"Bad HeaderStorageBucket";for(B=Ci(S[0].messages[0].data),A=0;A<=n.e.c;++A)q=Ci(B[2][0].data),q[1][0].data=zi(A),q[4][0].data=zi(n.e.r+1),B[2][A]={type:B[2][0].type,data:so(q)};S[0].messages[0].data=so(B)}w.content=gp(mp(S)),w.size=w.content.length;var se=Oo(F[4][0].data);(function(){for(var K=Wn.find(u,l[se].location),H=jc(Ac(K.content)),R,J=0;J<H.length;++J){var V=H[J];V.id==se&&(R=V)}var X=Ci(R.messages[0].data);{X[3]=[];var Q=[];o.forEach(function(O,W){Q[1]=[{type:0,data:zi(W)}],Q[2]=[{type:0,data:zi(1)}],Q[3]=[{type:2,data:b0e(O)}],X[3].push({type:2,data:so(Q)})})}R.messages[0].data=so(X);var ne=mp(H),oe=gp(ne);K.content=oe,K.size=K.content.length})();var de=Ci(F[3][0].data);{var z=de[1][0];delete de[2];var G=Ci(z.data);{var ie=Oo(G[2][0].data);(function(){for(var K=Wn.find(u,l[ie].location),H=jc(Ac(K.content)),R,J=0;J<H.length;++J){var V=H[J];V.id==ie&&(R=V)}var X=Ci(R.messages[0].data);{delete X[6],delete de[7];var Q=new Uint8Array(X[5][0].data);X[5]=[];for(var ne=0,oe=0;oe<=n.e.r;++oe){var O=Ci(Q);ne+=M0e(O,s[oe],o),O[1][0].data=zi(oe),X[5].push({data:so(O),type:2})}X[1]=[{type:0,data:zi(n.e.c+1)}],X[2]=[{type:0,data:zi(n.e.r+1)}],X[3]=[{type:0,data:zi(ne)}],X[4]=[{type:0,data:zi(n.e.r+1)}]}R.messages[0].data=so(X);var W=mp(H),ae=gp(W);K.content=ae,K.size=K.content.length})()}z.data=so(G)}F[3][0].data=so(de)}b[4][0].data=so(F)}p.messages[0].data=so(b);var Y=mp(h),C=gp(Y);return f.content=C,f.size=f.content.length,u}function zU(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function cC(e){zU([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function uC(e){zU([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function R0e(e){return gi.WS.indexOf(e)>-1?"sheet":e==gi.CS?"chart":e==gi.DS?"dialog":e==gi.MS?"macro":e&&e.length?e:"sheet"}function F0e(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,R0e(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function B0e(e,t,r,n,i,s,o,l,c,u,d,f){try{s[n]=Tx(Jl(e,r,!0),t);var h=hs(e,t),p;switch(l){case"sheet":p=ahe(h,t,i,c,s[n],u,d,f);break;case"chart":if(p=she(h,t,i,c,s[n],u,d,f),!p||!p["!drawel"])break;var m=hx(p["!drawel"].Target,t),g=p1(m),y=Vle(Jl(e,m,!0),Tx(Jl(e,g,!0),m)),b=hx(y,m),v=p1(b);p=Mfe(Jl(e,b,!0),b,c,Tx(Jl(e,v,!0),b),u,p);break;case"macro":p=ohe(h,t,i,c,s[n],u,d,f);break;case"dialog":p=lhe(h,t,i,c,s[n],u,d,f);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=p;var w=[];s&&s[n]&&Ga(s[n]).forEach(function(S){var k="";if(s[n][S].Type==gi.CMNT){k=hx(s[n][S].Target,t);var j=fhe(hs(e,k,!0),k,c);if(!j||!j.length)return;GP(p,j,!1)}s[n][S].Type==gi.TCMNT&&(k=hx(s[n][S].Target,t),w=w.concat(Kle(hs(e,k,!0),c)))}),w&&w.length&&GP(p,w,!0,c.people||[])}catch(S){if(c.WTF)throw S}}function vc(e){return e.charAt(0)=="/"?e.slice(1):e}function I0e(e,t){if(og(),t=t||{},cC(t),Tc(e,"META-INF/manifest.xml")||Tc(e,"objectdata.xml"))return iO(e,t);if(Tc(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof lk<"u"){if(e.FileIndex)return lk(e);var r=Wn.utils.cfb_new();return pP(e).forEach(function(q){hi(r,q,Yne(e,q))}),lk(r)}throw new Error("Unsupported NUMBERS file")}if(!Tc(e,"[Content_Types].xml"))throw Tc(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Tc(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=pP(e),i=zie(Jl(e,"[Content_Types].xml")),s=!1,o,l;if(i.workbooks.length===0&&(l="xl/workbook.xml",hs(e,l,!0)&&i.workbooks.push(l)),i.workbooks.length===0){if(l="xl/workbook.bin",!hs(e,l,!0))throw new Error("Could not find workbook");i.workbooks.push(l),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(Px=[],i.sst)try{Px=dhe(hs(e,vc(i.sst)),i.sst,t)}catch(q){if(t.WTF)throw q}t.cellStyles&&i.themes.length&&(c=uhe(Jl(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(u=che(hs(e,vc(i.style)),i.style,c,t))}i.links.map(function(q){try{var U=Tx(Jl(e,p1(vc(q))),q);return phe(hs(e,vc(q)),U,q,t)}catch{}});var d=ihe(hs(e,vc(i.workbooks[0])),i.workbooks[0],t),f={},h="";i.coreprops.length&&(h=hs(e,vc(i.coreprops[0]),!0),h&&(f=T$(h)),i.extprops.length!==0&&(h=hs(e,vc(i.extprops[0]),!0),h&&Yie(h,f,t)));var p={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(h=Jl(e,vc(i.custprops[0]),!0),h&&(p=Qie(h,t)));var m={};if((t.bookSheets||t.bookProps)&&(d.Sheets?o=d.Sheets.map(function(U){return U.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),t.bookProps&&(m.Props=f,m.Custprops=p),t.bookSheets&&typeof o<"u"&&(m.SheetNames=o),t.bookSheets?m.SheetNames:t.bookProps))return m;o={};var g={};t.bookDeps&&i.calcchain&&(g=hhe(hs(e,vc(i.calcchain)),i.calcchain));var y=0,b={},v,w;{var S=d.Sheets;f.Worksheets=S.length,f.SheetNames=[];for(var k=0;k!=S.length;++k)f.SheetNames[k]=S[k].name}var j=s?"bin":"xml",A=i.workbooks[0].lastIndexOf("/"),L=(i.workbooks[0].slice(0,A+1)+"_rels/"+i.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");Tc(e,L)||(L="xl/_rels/workbook."+j+".rels");var P=Tx(Jl(e,L,!0),L.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=mhe(hs(e,vc(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=Xle(hs(e,vc(i.people[0])),t)),P&&(P=F0e(P,d.Sheets));var F=hs(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=f.Worksheets;++y){var E="sheet";if(P&&P[y]?(v="xl/"+P[y][1].replace(/[\/]?xl\//,""),Tc(e,v)||(v=P[y][1]),Tc(e,v)||(v=L.replace(/_rels\/.*$/,"")+P[y][1]),E=P[y][2]):(v="xl/worksheets/sheet"+(y+1-F)+"."+j,v=v.replace(/sheet0\./,"sheet.")),w=v.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(f.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var T=!1,B=0;B!=t.sheets.length;++B)typeof t.sheets[B]=="number"&&t.sheets[B]==y&&(T=1),typeof t.sheets[B]=="string"&&t.sheets[B].toLowerCase()==f.SheetNames[y].toLowerCase()&&(T=1);if(!T)continue e}}B0e(e,v,w,f.SheetNames[y],y,b,o,E,t,d,c,u)}return m={Directory:i,Workbook:d,Props:f,Custprops:p,Deps:g,Sheets:o,SheetNames:f.SheetNames,Strings:Px,Styles:u,Themes:c,SSF:ya(Gn)},t&&t.bookFiles&&(e.files?(m.keys=n,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(q,U){q=q.replace(/^Root Entry[\/]/,""),m.keys.push(q),m.files[q]=e.FileIndex[U]}))),t&&t.bookVBA&&(i.vba.length>0?m.vbaraw=hs(e,vc(i.vba[0]),!0):i.defaults&&i.defaults.bin===ice&&(m.vbaraw=hs(e,"xl/vbaProject.bin",!0))),m}function D0e(e,t){var r=t||{},n="Workbook",i=Wn.find(e,n);try{if(n="/!DataSpaces/Version",i=Wn.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(moe(i.content),n="/!DataSpaces/DataSpaceMap",i=Wn.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=xoe(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Wn.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=yoe(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Wn.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);voe(i.content)}catch{}if(n="/EncryptionInfo",i=Wn.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=woe(i.content);if(n="/EncryptedPackage",i=Wn.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],i.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function $0e(e,t){return t.bookType=="ods"?UU(e,t):t.bookType=="numbers"?L0e(e,t):t.bookType=="xlsb"?U0e(e,t):z0e(e,t)}function U0e(e,t){em=1024,e&&!e.SSF&&(e.SSF=ya(Gn)),e&&e.SSF&&(og(),AS(e.SSF),t.revssf=CS(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ox?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=mU.indexOf(t.bookType)>-1,i=Y3();uC(t=t||{});var s=R3(),o="",l=0;if(t.cellXfs=[],Ah(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",hi(s,o,P$(e.Props,t)),i.coreprops.push(o),Wi(t.rels,2,o,gi.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,hi(s,o,L$(e.Props)),i.extprops.push(o),Wi(t.rels,3,o,gi.EXT_PROPS),e.Custprops!==e.Props&&Ga(e.Custprops||{}).length>0&&(o="docProps/custom.xml",hi(s,o,R$(e.Custprops)),i.custprops.push(o),Wi(t.rels,4,o,gi.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,hi(s,o,xhe(l-1,o,t,e,d)),i.sheets.push(o),Wi(t.wbrels,-1,"worksheets/sheet"+l+"."+r,gi.WS[0])}if(f){var p=f["!comments"],m=!1,g="";p&&p.length>0&&(g="xl/comments"+l+"."+r,hi(s,g,vhe(p,g)),i.comments.push(g),Wi(d,-1,"../comments"+l+"."+r,gi.CMNT),m=!0),f["!legacy"]&&m&&hi(s,"xl/drawings/vmlDrawing"+l+".vml",hU(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&hi(s,p1(o),mm(d))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,hi(s,o,bhe(t.Strings,o,t)),i.strs.push(o),Wi(t.wbrels,-1,"sharedStrings."+r,gi.SST)),o="xl/workbook."+r,hi(s,o,ghe(e,o)),i.workbooks.push(o),Wi(t.rels,1,o,gi.WB),o="xl/theme/theme1.xml",hi(s,o,tC(e.Themes,t)),i.themes.push(o),Wi(t.wbrels,-1,"theme/theme1.xml",gi.THEME),o="xl/styles."+r,hi(s,o,yhe(e,o,t)),i.styles.push(o),Wi(t.wbrels,-1,"styles."+r,gi.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",hi(s,o,e.vbaraw),i.vba.push(o),Wi(t.wbrels,-1,"vbaProject.bin",gi.VBA)),o="xl/metadata."+r,hi(s,o,whe(o)),i.metadata.push(o),Wi(t.wbrels,-1,"metadata."+r,gi.XLMETA),hi(s,"[Content_Types].xml",C$(i,t)),hi(s,"_rels/.rels",mm(t.rels)),hi(s,"xl/_rels/workbook."+r+".rels",mm(t.wbrels)),delete t.revssf,delete t.ssf,s}function z0e(e,t){em=1024,e&&!e.SSF&&(e.SSF=ya(Gn)),e&&e.SSF&&(og(),AS(e.SSF),t.revssf=CS(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ox?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=mU.indexOf(t.bookType)>-1,i=Y3();uC(t=t||{});var s=R3(),o="",l=0;if(t.cellXfs=[],Ah(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",hi(s,o,P$(e.Props,t)),i.coreprops.push(o),Wi(t.rels,2,o,gi.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,hi(s,o,L$(e.Props)),i.extprops.push(o),Wi(t.rels,3,o,gi.EXT_PROPS),e.Custprops!==e.Props&&Ga(e.Custprops||{}).length>0&&(o="docProps/custom.xml",hi(s,o,R$(e.Custprops)),i.custprops.push(o),Wi(t.rels,4,o,gi.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,hi(s,o,AU(l-1,t,e,f)),i.sheets.push(o),Wi(t.wbrels,-1,"worksheets/sheet"+l+"."+r,gi.WS[0])}if(h){var m=h["!comments"],g=!1,y="";if(m&&m.length>0){var b=!1;m.forEach(function(v){v[1].forEach(function(w){w.T==!0&&(b=!0)})}),b&&(y="xl/threadedComments/threadedComment"+l+"."+r,hi(s,y,Yle(m,d,t)),i.threadedcomments.push(y),Wi(f,-1,"../threadedComments/threadedComment"+l+"."+r,gi.TCMNT)),y="xl/comments"+l+"."+r,hi(s,y,pU(m)),i.comments.push(y),Wi(f,-1,"../comments"+l+"."+r,gi.CMNT),g=!0}h["!legacy"]&&g&&hi(s,"xl/drawings/vmlDrawing"+l+".vml",hU(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&hi(s,p1(o),mm(f))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,hi(s,o,tU(t.Strings,t)),i.strs.push(o),Wi(t.wbrels,-1,"sharedStrings."+r,gi.SST)),o="xl/workbook."+r,hi(s,o,PU(e)),i.workbooks.push(o),Wi(t.rels,1,o,gi.WB),o="xl/theme/theme1.xml",hi(s,o,tC(e.Themes,t)),i.themes.push(o),Wi(t.wbrels,-1,"theme/theme1.xml",gi.THEME),o="xl/styles."+r,hi(s,o,cU(e,t)),i.styles.push(o),Wi(t.wbrels,-1,"styles."+r,gi.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",hi(s,o,e.vbaraw),i.vba.push(o),Wi(t.wbrels,-1,"vbaProject.bin",gi.VBA)),o="xl/metadata."+r,hi(s,o,fU()),i.metadata.push(o),Wi(t.wbrels,-1,"metadata."+r,gi.XLMETA),d.length>1&&(o="xl/persons/person.xml",hi(s,o,Qle(d)),i.people.push(o),Wi(t.wbrels,-1,"persons/person.xml",gi.PEOPLE)),hi(s,"[Content_Types].xml",C$(i,t)),hi(s,"_rels/.rels",mm(t.rels)),hi(s,"xl/_rels/workbook."+r+".rels",mm(t.wbrels)),delete t.revssf,delete t.ssf,s}function dC(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=lc(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function W0e(e,t){return Wn.find(e,"EncryptedPackage")?D0e(e,t):RU(e,t)}function q0e(e,t){var r,n=e,i=t||{};return i.type||(i.type=mi&&Buffer.isBuffer(e)?"buffer":"base64"),r=n$(n,i),I0e(r,i)}function WU(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return V4(e.slice(r),t);default:break e}return Im.to_workbook(e,t)}function H0e(e,t){var r="",n=dC(e,t);switch(t.type){case"base64":r=lc(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=_0(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Qi(r)),t.type="binary",WU(r,t)}function V0e(e,t){var r=e;return t.type=="base64"&&(r=lc(r)),r=l1.utils.decode(1200,r.slice(2),"str"),t.type="binary",WU(r,t)}function G0e(e){return e.match(/[^\x00-\x7F]/)?Xu(e):e}function ck(e,t,r,n){return n?(r.type="string",Im.to_workbook(e,r)):Im.to_workbook(t,r)}function C0(e,t){T3();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return C0(new Uint8Array(e),(r=ya(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),xm={},r.dateNF&&(xm.dateNF=r.dateNF),r.type||(r.type=mi&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=mi?"buffer":"binary",n=Une(e),typeof Uint8Array<"u"&&!mi&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=G0e(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=ya(r),r.type="array",C0(P3(n),r)}switch((i=dC(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return W0e(Wn.read(n,r),r);break;case 9:if(i[1]<=8)return RU(n,r);break;case 60:return V4(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return Jse(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return Z$.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?q0e(n,r):ck(e,n,r,s);case 239:return i[3]===60?V4(n,r):ck(e,n,r,s);case 255:if(i[1]===254)return V0e(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return o0.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return o0.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return H4.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return sU.to_workbook(n,r);break;case 10:case 13:case 32:return H0e(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Qse.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?H4.to_workbook(n,r):ck(e,n,r,s)}function qU(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return ry(t.file,Wn.write(e,{type:mi?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Wn.write(e,t)}function K0e(e,t){var r=ya(t||{}),n=$0e(e,r);return Y0e(n,r)}function Y0e(e,t){var r={},n=mi?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?Wn.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(jS(i))}return t.password&&typeof encrypt_agile<"u"?qU(encrypt_agile(i,t.password),t):t.type==="file"?ry(t.file,i):t.type=="string"?Qi(i):i}function X0e(e,t){var r=t||{},n=Ghe(e,r);return qU(n,r)}function Uu(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return c1(Xu(n));case"binary":return Xu(n);case"string":return e;case"file":return ry(t.file,n,"utf8");case"buffer":return mi?cf(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Uu(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Q0e(e,t){switch(t.type){case"base64":return c1(e);case"binary":return e;case"string":return e;case"file":return ry(t.file,e,"binary");case"buffer":return mi?cf(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Pb(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?c1(r):t.type=="string"?Qi(r):r;case"file":return ry(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function HU(e,t){T3(),Wfe(e);var r=ya(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=HU(e,r);return r.type="array",jS(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Uu($he(e,r),r);case"slk":case"sylk":return Uu(J$.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return Uu(BU(e.Sheets[e.SheetNames[i]],r),r);case"txt":return Q0e(VU(e.Sheets[e.SheetNames[i]],r),r);case"csv":return Uu(fC(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return Uu(Z$.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return Pb(H4.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return Uu(Im.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return Uu(sU.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return Uu(eU.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return Uu(UU(e,r),r);case"wk1":return Pb(o0.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return Pb(o0.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Pb(FU(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),X0e(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return K0e(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function J0e(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function uy(e,t,r){var n={};return n.type="file",n.file=t,J0e(n),HU(e,n)}function Z0e(e,t,r,n,i,s,o,l){var c=os(r),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!o||e[r])for(var p=t.s.c;p<=t.e.c;++p){var m=o?e[r][p]:e[n[p]+c];if(m===void 0||m.t===void 0){if(u===void 0)continue;s[p]!=null&&(h[s[p]]=u);continue}var g=m.v;switch(m.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[p]!=null){if(g==null)if(m.t=="e"&&g===null)h[s[p]]=null;else if(u!==void 0)h[s[p]]=u;else if(d&&g===null)h[s[p]]=null;else continue;else h[s[p]]=d&&(m.t!=="n"||m.t==="n"&&l.rawNumbers!==!1)?g:Yd(m,g,l);g!=null&&(f=!1)}}return{row:h,isempty:f}}function V2(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=Ni(d);break;case"number":c=Ni(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(i=0);var f=os(c.s.r),h=[],p=[],m=0,g=0,y=Array.isArray(e),b=c.s.r,v=0,w={};y&&!e[b]&&(e[b]=[]);var S=u.skipHidden&&e["!cols"]||[],k=u.skipHidden&&e["!rows"]||[];for(v=c.s.c;v<=c.e.c;++v)if(!(S[v]||{}).hidden)switch(h[v]=Ta(v),r=y?e[b][v]:e[h[v]+f],n){case 1:s[v]=v-c.s.c;break;case 2:s[v]=h[v];break;case 3:s[v]=u.header[v-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=Yd(r,null,u),g=w[o]||0,!g)w[o]=1;else{do l=o+"_"+g++;while(w[l]);w[o]=g,w[l]=1}s[v]=l}for(b=c.s.r+i;b<=c.e.r;++b)if(!(k[b]||{}).hidden){var j=Z0e(e,c,b,h,n,s,y,u);(j.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(p[m++]=j.row)}return p.length=m,p}var cO=/"/g;function epe(e,t,r,n,i,s,o,l){for(var c=!0,u=[],d="",f=os(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var p=l.dense?(e[r]||[])[h]:e[n[h]+f];if(p==null)d="";else if(p.v!=null){c=!1,d=""+(l.rawNumbers&&p.t=="n"?p.v:Yd(p,null,l));for(var m=0,g=0;m!==d.length;++m)if((g=d.charCodeAt(m))===i||g===s||g===34||l.forceQuotes){d='"'+d.replace(cO,'""')+'"';break}d=="ID"&&(d='"ID"')}else p.f!=null&&!p.F?(c=!1,d="="+p.f,d.indexOf(",")>=0&&(d='"'+d.replace(cO,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(o)}function fC(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=Ni(e["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],m=i.s.c;m<=i.e.c;++m)(h[m]||{}).hidden||(f[m]=Ta(m));for(var g=0,y=i.s.r;y<=i.e.r;++y)(p[y]||{}).hidden||(d=epe(e,i,y,f,o,c,s,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((g++?l:"")+d)));return delete n.dense,r.join("")}function VU(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=fC(e,t);return r}function tpe(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=Ni(e["!ref"]),s="",o=[],l,c=[],u=Array.isArray(e);for(l=i.s.c;l<=i.e.c;++l)o[l]=Ta(l);for(var d=i.s.r;d<=i.e.r;++d)for(s=os(d),l=i.s.c;l<=i.e.c;++l)if(t=o[l]+s,r=u?(e[d]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function GU(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},o=0,l=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Pa(n.origin):n.origin;o=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:o+t.length-1+i}};if(s["!ref"]){var f=Ni(s["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),o==-1&&(o=f.e.r+1,d.e.r=o+t.length-1+i)}else o==-1&&(o=0,d.e.r=t.length-1+i);var h=n.header||[],p=0;t.forEach(function(g,y){Ga(g).forEach(function(b){(p=h.indexOf(b))==-1&&(h[p=h.length]=b);var v=g[b],w="z",S="",k=Yn({c:l+p,r:o+y+i});u=w1(s,k),v&&typeof v=="object"&&!(v instanceof Date)?s[k]=v:(typeof v=="number"?w="n":typeof v=="boolean"?w="b":typeof v=="string"?w="s":v instanceof Date?(w="d",n.cellDates||(w="n",v=Ms(v)),S=n.dateNF||Gn[14]):v===null&&n.nullError&&(w="e",v=0),u?(u.t=w,u.v=v,delete u.w,delete u.R,S&&(u.z=S)):s[k]=u={t:w,v},S&&(u.z=S))})}),d.e.c=Math.max(d.e.c,l+h.length-1);var m=os(o);if(i)for(p=0;p<h.length;++p)s[Ta(p+l)+m]={t:"s",v:h[p]};return s["!ref"]=oi(d),s}function rpe(e,t){return GU(null,e,t)}function w1(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Pa(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?w1(e,Yn(t)):w1(e,Yn({r:t,c:r||0}))}function npe(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function hC(){return{SheetNames:[],Sheets:{}}}function pC(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=o+i)!=-1;++i);}if(TU(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function ipe(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=npe(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function ape(e,t){return e.z=t,e}function KU(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function spe(e,t,r){return KU(e,"#"+t,r)}function ope(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function lpe(e,t,r,n){for(var i=typeof t!="string"?t:Ni(t),s=typeof t=="string"?t:oi(t),o=i.s.r;o<=i.e.r;++o)for(var l=i.s.c;l<=i.e.c;++l){var c=w1(e,o,l);c.t="n",c.F=s,delete c.v,o==i.s.r&&l==i.s.c&&(c.f=r,n&&(c.D=!0))}return e}var vs={encode_col:Ta,encode_row:os,encode_cell:Yn,encode_range:oi,decode_col:W3,decode_row:z3,split_cell:bie,decode_cell:Pa,decode_range:Ol,format_cell:Yd,sheet_add_aoa:w$,sheet_add_json:GU,sheet_add_dom:IU,aoa_to_sheet:lg,json_to_sheet:rpe,table_to_sheet:DU,table_to_book:m0e,sheet_to_csv:fC,sheet_to_txt:VU,sheet_to_json:V2,sheet_to_html:BU,sheet_to_formulae:tpe,sheet_to_row_object_array:V2,sheet_get_cell:w1,book_new:hC,book_append_sheet:pC,book_set_sheet_visibility:ipe,cell_set_number_format:ape,cell_set_hyperlink:KU,cell_set_internal_link:spe,cell_add_comment:ope,sheet_set_array_formula:lpe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function Hi(e){"@babel/helpers - typeof";return Hi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hi(e)}var wu=Uint8Array,tc=Uint16Array,mC=Int32Array,gC=new wu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),xC=new wu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),uO=new wu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),YU=function(e,t){for(var r=new tc(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var i=new mC(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)i[s]=s-r[n]<<5|n;return{b:r,r:i}},XU=YU(gC,2),cpe=XU.b,Y4=XU.r;cpe[28]=258,Y4[258]=28;var upe=YU(xC,0),dO=upe.r,X4=new tc(32768);for(var ma=0;ma<32768;++ma){var Nf=(ma&43690)>>1|(ma&21845)<<1;Nf=(Nf&52428)>>2|(Nf&13107)<<2,Nf=(Nf&61680)>>4|(Nf&3855)<<4,X4[ma]=((Nf&65280)>>8|(Nf&255)<<8)>>1}var Rx=function(e,t,r){for(var n=e.length,i=0,s=new tc(t);i<n;++i)e[i]&&++s[e[i]-1];var o=new tc(t);for(i=1;i<t;++i)o[i]=o[i-1]+s[i-1]<<1;var l;if(r){l=new tc(1<<t);var c=15-t;for(i=0;i<n;++i)if(e[i])for(var u=i<<4|e[i],d=t-e[i],f=o[e[i]-1]++<<d,h=f|(1<<d)-1;f<=h;++f)l[X4[f]>>c]=u}else for(l=new tc(n),i=0;i<n;++i)e[i]&&(l[i]=X4[o[e[i]-1]++]>>15-e[i]);return l},E0=new wu(288);for(var ma=0;ma<144;++ma)E0[ma]=8;for(var ma=144;ma<256;++ma)E0[ma]=9;for(var ma=256;ma<280;++ma)E0[ma]=7;for(var ma=280;ma<288;++ma)E0[ma]=8;var G2=new wu(32);for(var ma=0;ma<32;++ma)G2[ma]=5;var dpe=Rx(E0,9,0),fpe=Rx(G2,5,0),QU=function(e){return(e+7)/8|0},hpe=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new wu(e.subarray(t,r))},bd=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},qg=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},uk=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var i=r.length,s=r.slice();if(!i)return{t:ZU,l:0};if(i==1){var o=new wu(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(k,j){return k.f-j.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],u=0,d=1,f=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};d!=i-1;)l=r[r[u].f<r[f].f?u++:f++],c=r[u!=d&&r[u].f<r[f].f?u++:f++],r[d++]={s:-1,f:l.f+c.f,l,r:c};for(var h=s[0].s,n=1;n<i;++n)s[n].s>h&&(h=s[n].s);var p=new tc(h+1),m=Q4(r[d-1],p,0);if(m>t){var n=0,g=0,y=m-t,b=1<<y;for(s.sort(function(j,A){return p[A.s]-p[j.s]||j.f-A.f});n<i;++n){var v=s[n].s;if(p[v]>t)g+=b-(1<<m-p[v]),p[v]=t;else break}for(g>>=y;g>0;){var w=s[n].s;p[w]<t?g-=1<<t-p[w]++-1:++n}for(;n>=0&&g;--n){var S=s[n].s;p[S]==t&&(--p[S],++g)}m=t}return{t:new wu(p),l:m}},Q4=function(e,t,r){return e.s==-1?Math.max(Q4(e.l,t,r+1),Q4(e.r,t,r+1)):t[e.s]=r},fO=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new tc(++t),n=0,i=e[0],s=1,o=function(c){r[n++]=c},l=1;l<=t;++l)if(e[l]==i&&l!=t)++s;else{if(!i&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(i),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(i);s=1,i=e[l]}return{c:r.subarray(0,n),n:t}},Hg=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},JU=function(e,t,r){var n=r.length,i=QU(t+2);e[i]=n&255,e[i+1]=n>>8,e[i+2]=e[i]^255,e[i+3]=e[i+1]^255;for(var s=0;s<n;++s)e[i+s+4]=r[s];return(i+4+n)*8},hO=function(e,t,r,n,i,s,o,l,c,u,d){bd(t,d++,r),++i[256];for(var f=uk(i,15),h=f.t,p=f.l,m=uk(s,15),g=m.t,y=m.l,b=fO(h),v=b.c,w=b.n,S=fO(g),k=S.c,j=S.n,A=new tc(19),L=0;L<v.length;++L)++A[v[L]&31];for(var L=0;L<k.length;++L)++A[k[L]&31];for(var P=uk(A,7),F=P.t,E=P.l,T=19;T>4&&!F[uO[T-1]];--T);var B=u+5<<3,q=Hg(i,E0)+Hg(s,G2)+o,U=Hg(i,h)+Hg(s,g)+o+14+3*T+Hg(A,F)+2*A[16]+3*A[17]+7*A[18];if(c>=0&&B<=q&&B<=U)return JU(t,d,e.subarray(c,c+u));var se,de,z,G;if(bd(t,d,1+(U<q)),d+=2,U<q){se=Rx(h,p,0),de=h,z=Rx(g,y,0),G=g;var ie=Rx(F,E,0);bd(t,d,w-257),bd(t,d+5,j-1),bd(t,d+10,T-4),d+=14;for(var L=0;L<T;++L)bd(t,d+3*L,F[uO[L]]);d+=3*T;for(var Y=[v,k],C=0;C<2;++C)for(var K=Y[C],L=0;L<K.length;++L){var H=K[L]&31;bd(t,d,ie[H]),d+=F[H],H>15&&(bd(t,d,K[L]>>5&127),d+=K[L]>>12)}}else se=dpe,de=E0,z=fpe,G=G2;for(var L=0;L<l;++L){var R=n[L];if(R>255){var H=R>>18&31;qg(t,d,se[H+257]),d+=de[H+257],H>7&&(bd(t,d,R>>23&31),d+=gC[H]);var J=R&31;qg(t,d,z[J]),d+=G[J],J>3&&(qg(t,d,R>>5&8191),d+=xC[J])}else qg(t,d,se[R]),d+=de[R]}return qg(t,d,se[256]),d+de[256]},ppe=new mC([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),ZU=new wu(0),mpe=function(e,t,r,n,i,s){var o=s.z||e.length,l=new wu(n+o+5*(1+Math.ceil(o/7e3))+i),c=l.subarray(n,l.length-i),u=s.l,d=(s.r||0)&7;if(t){d&&(c[0]=s.r>>3);for(var f=ppe[t-1],h=f>>13,p=f&8191,m=(1<<r)-1,g=s.p||new tc(32768),y=s.h||new tc(m+1),b=Math.ceil(r/3),v=2*b,w=function(ae){return(e[ae]^e[ae+1]<<b^e[ae+2]<<v)&m},S=new mC(25e3),k=new tc(288),j=new tc(32),A=0,L=0,P=s.i||0,F=0,E=s.w||0,T=0;P+2<o;++P){var B=w(P),q=P&32767,U=y[B];if(g[q]=U,y[B]=q,E<=P){var se=o-P;if((A>7e3||F>24576)&&(se>423||!u)){d=hO(e,c,0,S,k,j,L,F,T,P-T,d),F=A=L=0,T=P;for(var de=0;de<286;++de)k[de]=0;for(var de=0;de<30;++de)j[de]=0}var z=2,G=0,ie=p,Y=q-U&32767;if(se>2&&B==w(P-Y))for(var C=Math.min(h,se)-1,K=Math.min(32767,P),H=Math.min(258,se);Y<=K&&--ie&&q!=U;){if(e[P+z]==e[P+z-Y]){for(var R=0;R<H&&e[P+R]==e[P+R-Y];++R);if(R>z){if(z=R,G=Y,R>C)break;for(var J=Math.min(Y,R-2),V=0,de=0;de<J;++de){var X=P-Y+de&32767,Q=g[X],ne=X-Q&32767;ne>V&&(V=ne,U=X)}}}q=U,U=g[q],Y+=q-U&32767}if(G){S[F++]=268435456|Y4[z]<<18|dO[G];var oe=Y4[z]&31,O=dO[G]&31;L+=gC[oe]+xC[O],++k[257+oe],++j[O],E=P+z,++A}else S[F++]=e[P],++k[e[P]]}}for(P=Math.max(P,E);P<o;++P)S[F++]=e[P],++k[e[P]];d=hO(e,c,u,S,k,j,L,F,T,P-T,d),u||(s.r=d&7|c[d/8|0]<<3,d-=7,s.h=y,s.p=g,s.i=P,s.w=E)}else{for(var P=s.w||0;P<o+u;P+=65535){var W=P+65535;W>=o&&(c[d/8|0]=u,W=o),d=JU(c,d+1,e.subarray(P,W))}s.i=o}return hpe(l,0,n+QU(d)+i)},ez=function(){var e=1,t=0;return{p:function(r){for(var n=e,i=t,s=r.length|0,o=0;o!=s;){for(var l=Math.min(o+2655,s);o<l;++o)i+=n+=r[o];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}e=n,t=i},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},gpe=function(e,t,r,n,i){if(!i&&(i={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),o=new wu(s.length+e.length);o.set(s),o.set(e,s.length),e=o,i.w=s.length}return mpe(e,t.level==null?6:t.level,t.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,i)},tz=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},xpe=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var i=ez();i.p(t.dictionary),tz(e,2,i.d())}};function J4(e,t){t||(t={});var r=ez();r.p(e);var n=gpe(e,t,t.dictionary?6:2,4);return xpe(n,t),tz(n,n.length-4,r.d()),n}var ype=typeof TextDecoder<"u"&&new TextDecoder,bpe=0;try{ype.decode(ZU,{stream:!0}),bpe=1}catch{}function vpe(e){if(Array.isArray(e))return e}function wpe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,s,o,l=[],c=!0,u=!1;try{if(s=(r=r.call(e)).next,t!==0)for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,i=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}function pO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Spe(e,t){if(e){if(typeof e=="string")return pO(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?pO(e,t):void 0}}function _pe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mO(e,t){return vpe(e)||wpe(e,t)||Spe(e,t)||_pe()}function gO(e,t="utf8"){return new TextDecoder(t).decode(e)}const kpe=new TextEncoder;function jpe(e){return kpe.encode(e)}const Ape=1024*8,Npe=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),dk={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class yC{constructor(t=Ape,r={}){Oi(this,"buffer");Oi(this,"byteLength");Oi(this,"byteOffset");Oi(this,"length");Oi(this,"offset");Oi(this,"lastWrittenByte");Oi(this,"littleEndian");Oi(this,"_data");Oi(this,"_mark");Oi(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const i=r.offset?r.offset>>>0:0,s=t.byteLength-i;let o=i;(ArrayBuffer.isView(t)||t instanceof yC)&&(t.byteLength!==t.buffer.byteLength&&(o=t.byteOffset+i),t=t.buffer),n?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=t,this.length=s,this.byteLength=s,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,s),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,i=new Uint8Array(n);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=dk[r].BYTES_PER_ELEMENT*t,i=this.byteOffset+this.offset,s=this.buffer.slice(i,i+n);if(this.littleEndian===Npe&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(i,i+n));l.reverse();const c=new dk[r](l.buffer);return this.offset+=n,c.reverse(),c}const o=new dk[r](s);return this.offset+=n,o}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return gO(this.readBytes(t))}decodeText(t=1,r="utf8"){return gO(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(jpe(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function ug(e){let t=e.length;for(;--t>=0;)e[t]=0}const Cpe=3,Epe=258,rz=29,Tpe=256,Ppe=Tpe+1+rz,nz=30,Ope=512,Mpe=new Array((Ppe+2)*2);ug(Mpe);const Lpe=new Array(nz*2);ug(Lpe);const Rpe=new Array(Ope);ug(Rpe);const Fpe=new Array(Epe-Cpe+1);ug(Fpe);const Bpe=new Array(rz);ug(Bpe);const Ipe=new Array(nz);ug(Ipe);const Dpe=(e,t,r,n)=>{let i=e&65535|0,s=e>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do i=i+t[n++]|0,s=s+i|0;while(--o);i%=65521,s%=65521}return i|s<<16|0};var Z4=Dpe;const $pe=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},Upe=new Uint32Array($pe()),zpe=(e,t,r,n)=>{const i=Upe,s=n+r;e^=-1;for(let o=n;o<s;o++)e=e>>>8^i[(e^t[o])&255];return e^-1};var Ru=zpe,eA={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},iz={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const Wpe=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var qpe=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)Wpe(r,n)&&(e[n]=r[n])}}return e},Hpe=e=>{let t=0;for(let n=0,i=e.length;n<i;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,i=0,s=e.length;n<s;n++){let o=e[n];r.set(o,i),i+=o.length}return r},az={assign:qpe,flattenChunks:Hpe};let sz=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{sz=!1}const S1=new Uint8Array(256);for(let e=0;e<256;e++)S1[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;S1[254]=S1[254]=1;var Vpe=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,i,s,o=e.length,l=0;for(i=0;i<o;i++)r=e.charCodeAt(i),(r&64512)===55296&&i+1<o&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(l),s=0,i=0;s<l;i++)r=e.charCodeAt(i),(r&64512)===55296&&i+1<o&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?t[s++]=r:r<2048?(t[s++]=192|r>>>6,t[s++]=128|r&63):r<65536?(t[s++]=224|r>>>12,t[s++]=128|r>>>6&63,t[s++]=128|r&63):(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63,t[s++]=128|r>>>6&63,t[s++]=128|r&63);return t};const Gpe=(e,t)=>{if(t<65534&&e.subarray&&sz)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var Kpe=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,i;const s=new Array(r*2);for(i=0,n=0;n<r;){let o=e[n++];if(o<128){s[i++]=o;continue}let l=S1[o];if(l>4){s[i++]=65533,n+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&n<r;)o=o<<6|e[n++]&63,l--;if(l>1){s[i++]=65533;continue}o<65536?s[i++]=o:(o-=65536,s[i++]=55296|o>>10&1023,s[i++]=56320|o&1023)}return Gpe(s,i)},Ype=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+S1[e[r]]>t?r:t},tA={string2buf:Vpe,buf2string:Kpe,utf8border:Ype};function Xpe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Qpe=Xpe;const Ob=16209,Jpe=16191;var Zpe=function(t,r){let n,i,s,o,l,c,u,d,f,h,p,m,g,y,b,v,w,S,k,j,A,L,P,F;const E=t.state;n=t.next_in,P=t.input,i=n+(t.avail_in-5),s=t.next_out,F=t.output,o=s-(r-t.avail_out),l=s+(t.avail_out-257),c=E.dmax,u=E.wsize,d=E.whave,f=E.wnext,h=E.window,p=E.hold,m=E.bits,g=E.lencode,y=E.distcode,b=(1<<E.lenbits)-1,v=(1<<E.distbits)-1;e:do{m<15&&(p+=P[n++]<<m,m+=8,p+=P[n++]<<m,m+=8),w=g[p&b];t:for(;;){if(S=w>>>24,p>>>=S,m-=S,S=w>>>16&255,S===0)F[s++]=w&65535;else if(S&16){k=w&65535,S&=15,S&&(m<S&&(p+=P[n++]<<m,m+=8),k+=p&(1<<S)-1,p>>>=S,m-=S),m<15&&(p+=P[n++]<<m,m+=8,p+=P[n++]<<m,m+=8),w=y[p&v];r:for(;;){if(S=w>>>24,p>>>=S,m-=S,S=w>>>16&255,S&16){if(j=w&65535,S&=15,m<S&&(p+=P[n++]<<m,m+=8,m<S&&(p+=P[n++]<<m,m+=8)),j+=p&(1<<S)-1,j>c){t.msg="invalid distance too far back",E.mode=Ob;break e}if(p>>>=S,m-=S,S=s-o,j>S){if(S=j-S,S>d&&E.sane){t.msg="invalid distance too far back",E.mode=Ob;break e}if(A=0,L=h,f===0){if(A+=u-S,S<k){k-=S;do F[s++]=h[A++];while(--S);A=s-j,L=F}}else if(f<S){if(A+=u+f-S,S-=f,S<k){k-=S;do F[s++]=h[A++];while(--S);if(A=0,f<k){S=f,k-=S;do F[s++]=h[A++];while(--S);A=s-j,L=F}}}else if(A+=f-S,S<k){k-=S;do F[s++]=h[A++];while(--S);A=s-j,L=F}for(;k>2;)F[s++]=L[A++],F[s++]=L[A++],F[s++]=L[A++],k-=3;k&&(F[s++]=L[A++],k>1&&(F[s++]=L[A++]))}else{A=s-j;do F[s++]=F[A++],F[s++]=F[A++],F[s++]=F[A++],k-=3;while(k>2);k&&(F[s++]=F[A++],k>1&&(F[s++]=F[A++]))}}else if(S&64){t.msg="invalid distance code",E.mode=Ob;break e}else{w=y[(w&65535)+(p&(1<<S)-1)];continue r}break}}else if(S&64)if(S&32){E.mode=Jpe;break e}else{t.msg="invalid literal/length code",E.mode=Ob;break e}else{w=g[(w&65535)+(p&(1<<S)-1)];continue t}break}}while(n<i&&s<l);k=m>>3,n-=k,m-=k<<3,p&=(1<<m)-1,t.next_in=n,t.next_out=s,t.avail_in=n<i?5+(i-n):5-(n-i),t.avail_out=s<l?257+(l-s):257-(s-l),E.hold=p,E.bits=m};const xp=15,xO=852,yO=592,bO=0,fk=1,vO=2,eme=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),tme=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),rme=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),nme=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),ime=(e,t,r,n,i,s,o,l)=>{const c=l.bits;let u=0,d=0,f=0,h=0,p=0,m=0,g=0,y=0,b=0,v=0,w,S,k,j,A,L=null,P;const F=new Uint16Array(xp+1),E=new Uint16Array(xp+1);let T=null,B,q,U;for(u=0;u<=xp;u++)F[u]=0;for(d=0;d<n;d++)F[t[r+d]]++;for(p=c,h=xp;h>=1&&F[h]===0;h--);if(p>h&&(p=h),h===0)return i[s++]=1<<24|64<<16|0,i[s++]=1<<24|64<<16|0,l.bits=1,0;for(f=1;f<h&&F[f]===0;f++);for(p<f&&(p=f),y=1,u=1;u<=xp;u++)if(y<<=1,y-=F[u],y<0)return-1;if(y>0&&(e===bO||h!==1))return-1;for(E[1]=0,u=1;u<xp;u++)E[u+1]=E[u]+F[u];for(d=0;d<n;d++)t[r+d]!==0&&(o[E[t[r+d]]++]=d);if(e===bO?(L=T=o,P=20):e===fk?(L=eme,T=tme,P=257):(L=rme,T=nme,P=0),v=0,d=0,u=f,A=s,m=p,g=0,k=-1,b=1<<p,j=b-1,e===fk&&b>xO||e===vO&&b>yO)return 1;for(;;){B=u-g,o[d]+1<P?(q=0,U=o[d]):o[d]>=P?(q=T[o[d]-P],U=L[o[d]-P]):(q=96,U=0),w=1<<u-g,S=1<<m,f=S;do S-=w,i[A+(v>>g)+S]=B<<24|q<<16|U|0;while(S!==0);for(w=1<<u-1;v&w;)w>>=1;if(w!==0?(v&=w-1,v+=w):v=0,d++,--F[u]===0){if(u===h)break;u=t[r+o[d]]}if(u>p&&(v&j)!==k){for(g===0&&(g=p),A+=f,m=u-g,y=1<<m;m+g<h&&(y-=F[m+g],!(y<=0));)m++,y<<=1;if(b+=1<<m,e===fk&&b>xO||e===vO&&b>yO)return 1;k=v&j,i[k]=p<<24|m<<16|A-s|0}}return v!==0&&(i[A+v]=u-g<<24|64<<16|0),l.bits=p,0};var Fx=ime;const ame=0,oz=1,lz=2,{Z_FINISH:wO,Z_BLOCK:sme,Z_TREES:Mb,Z_OK:T0,Z_STREAM_END:ome,Z_NEED_DICT:lme,Z_STREAM_ERROR:zc,Z_DATA_ERROR:cz,Z_MEM_ERROR:uz,Z_BUF_ERROR:cme,Z_DEFLATED:SO}=iz,LS=16180,_O=16181,kO=16182,jO=16183,AO=16184,NO=16185,CO=16186,EO=16187,TO=16188,PO=16189,K2=16190,vd=16191,hk=16192,OO=16193,pk=16194,MO=16195,LO=16196,RO=16197,FO=16198,Lb=16199,Rb=16200,BO=16201,IO=16202,DO=16203,$O=16204,UO=16205,mk=16206,zO=16207,WO=16208,va=16209,dz=16210,fz=16211,ume=852,dme=592,fme=15,hme=fme,qO=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function pme(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const rp=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<LS||t.mode>fz?1:0},hz=e=>{if(rp(e))return zc;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=LS,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(ume),t.distcode=t.distdyn=new Int32Array(dme),t.sane=1,t.back=-1,T0},pz=e=>{if(rp(e))return zc;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,hz(e)},mz=(e,t)=>{let r;if(rp(e))return zc;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?zc:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,pz(e))},gz=(e,t)=>{if(!e)return zc;const r=new pme;e.state=r,r.strm=e,r.window=null,r.mode=LS;const n=mz(e,t);return n!==T0&&(e.state=null),n},mme=e=>gz(e,hme);let HO=!0,gk,xk;const gme=e=>{if(HO){gk=new Int32Array(512),xk=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Fx(oz,e.lens,0,288,gk,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Fx(lz,e.lens,0,32,xk,0,e.work,{bits:5}),HO=!1}e.lencode=gk,e.lenbits=9,e.distcode=xk,e.distbits=5},xz=(e,t,r,n)=>{let i;const s=e.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(t.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>n&&(i=n),s.window.set(t.subarray(r-n,r-n+i),s.wnext),n-=i,n?(s.window.set(t.subarray(r-n,r),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0},xme=(e,t)=>{let r,n,i,s,o,l,c,u,d,f,h,p,m,g,y=0,b,v,w,S,k,j,A,L;const P=new Uint8Array(4);let F,E;const T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(rp(e)||!e.output||!e.input&&e.avail_in!==0)return zc;r=e.state,r.mode===vd&&(r.mode=hk),o=e.next_out,i=e.output,c=e.avail_out,s=e.next_in,n=e.input,l=e.avail_in,u=r.hold,d=r.bits,f=l,h=c,L=T0;e:for(;;)switch(r.mode){case LS:if(r.wrap===0){r.mode=hk;break}for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&2&&u===35615){r.wbits===0&&(r.wbits=15),r.check=0,P[0]=u&255,P[1]=u>>>8&255,r.check=Ru(r.check,P,2,0),u=0,d=0,r.mode=_O;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){e.msg="incorrect header check",r.mode=va;break}if((u&15)!==SO){e.msg="unknown compression method",r.mode=va;break}if(u>>>=4,d-=4,A=(u&15)+8,r.wbits===0&&(r.wbits=A),A>15||A>r.wbits){e.msg="invalid window size",r.mode=va;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=u&512?PO:vd,u=0,d=0;break;case _O:for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.flags=u,(r.flags&255)!==SO){e.msg="unknown compression method",r.mode=va;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=va;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&r.wrap&4&&(P[0]=u&255,P[1]=u>>>8&255,r.check=Ru(r.check,P,2,0)),u=0,d=0,r.mode=kO;case kO:for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.head&&(r.head.time=u),r.flags&512&&r.wrap&4&&(P[0]=u&255,P[1]=u>>>8&255,P[2]=u>>>16&255,P[3]=u>>>24&255,r.check=Ru(r.check,P,4,0)),u=0,d=0,r.mode=jO;case jO:for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&r.wrap&4&&(P[0]=u&255,P[1]=u>>>8&255,r.check=Ru(r.check,P,2,0)),u=0,d=0,r.mode=AO;case AO:if(r.flags&1024){for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&r.wrap&4&&(P[0]=u&255,P[1]=u>>>8&255,r.check=Ru(r.check,P,2,0)),u=0,d=0}else r.head&&(r.head.extra=null);r.mode=NO;case NO:if(r.flags&1024&&(p=r.length,p>l&&(p=l),p&&(r.head&&(A=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(s,s+p),A)),r.flags&512&&r.wrap&4&&(r.check=Ru(r.check,n,p,s)),l-=p,s+=p,r.length-=p),r.length))break e;r.length=0,r.mode=CO;case CO:if(r.flags&2048){if(l===0)break e;p=0;do A=n[s+p++],r.head&&A&&r.length<65536&&(r.head.name+=String.fromCharCode(A));while(A&&p<l);if(r.flags&512&&r.wrap&4&&(r.check=Ru(r.check,n,p,s)),l-=p,s+=p,A)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=EO;case EO:if(r.flags&4096){if(l===0)break e;p=0;do A=n[s+p++],r.head&&A&&r.length<65536&&(r.head.comment+=String.fromCharCode(A));while(A&&p<l);if(r.flags&512&&r.wrap&4&&(r.check=Ru(r.check,n,p,s)),l-=p,s+=p,A)break e}else r.head&&(r.head.comment=null);r.mode=TO;case TO:if(r.flags&512){for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&4&&u!==(r.check&65535)){e.msg="header crc mismatch",r.mode=va;break}u=0,d=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=vd;break;case PO:for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}e.adler=r.check=qO(u),u=0,d=0,r.mode=K2;case K2:if(r.havedict===0)return e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=u,r.bits=d,lme;e.adler=r.check=1,r.mode=vd;case vd:if(t===sme||t===Mb)break e;case hk:if(r.last){u>>>=d&7,d-=d&7,r.mode=mk;break}for(;d<3;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}switch(r.last=u&1,u>>>=1,d-=1,u&3){case 0:r.mode=OO;break;case 1:if(gme(r),r.mode=Lb,t===Mb){u>>>=2,d-=2;break e}break;case 2:r.mode=LO;break;case 3:e.msg="invalid block type",r.mode=va}u>>>=2,d-=2;break;case OO:for(u>>>=d&7,d-=d&7;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if((u&65535)!==(u>>>16^65535)){e.msg="invalid stored block lengths",r.mode=va;break}if(r.length=u&65535,u=0,d=0,r.mode=pk,t===Mb)break e;case pk:r.mode=MO;case MO:if(p=r.length,p){if(p>l&&(p=l),p>c&&(p=c),p===0)break e;i.set(n.subarray(s,s+p),o),l-=p,s+=p,c-=p,o+=p,r.length-=p;break}r.mode=vd;break;case LO:for(;d<14;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.nlen=(u&31)+257,u>>>=5,d-=5,r.ndist=(u&31)+1,u>>>=5,d-=5,r.ncode=(u&15)+4,u>>>=4,d-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=va;break}r.have=0,r.mode=RO;case RO:for(;r.have<r.ncode;){for(;d<3;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.lens[T[r.have++]]=u&7,u>>>=3,d-=3}for(;r.have<19;)r.lens[T[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,F={bits:r.lenbits},L=Fx(ame,r.lens,0,19,r.lencode,0,r.work,F),r.lenbits=F.bits,L){e.msg="invalid code lengths set",r.mode=va;break}r.have=0,r.mode=FO;case FO:for(;r.have<r.nlen+r.ndist;){for(;y=r.lencode[u&(1<<r.lenbits)-1],b=y>>>24,v=y>>>16&255,w=y&65535,!(b<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(w<16)u>>>=b,d-=b,r.lens[r.have++]=w;else{if(w===16){for(E=b+2;d<E;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(u>>>=b,d-=b,r.have===0){e.msg="invalid bit length repeat",r.mode=va;break}A=r.lens[r.have-1],p=3+(u&3),u>>>=2,d-=2}else if(w===17){for(E=b+3;d<E;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=b,d-=b,A=0,p=3+(u&7),u>>>=3,d-=3}else{for(E=b+7;d<E;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=b,d-=b,A=0,p=11+(u&127),u>>>=7,d-=7}if(r.have+p>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=va;break}for(;p--;)r.lens[r.have++]=A}}if(r.mode===va)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=va;break}if(r.lenbits=9,F={bits:r.lenbits},L=Fx(oz,r.lens,0,r.nlen,r.lencode,0,r.work,F),r.lenbits=F.bits,L){e.msg="invalid literal/lengths set",r.mode=va;break}if(r.distbits=6,r.distcode=r.distdyn,F={bits:r.distbits},L=Fx(lz,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,F),r.distbits=F.bits,L){e.msg="invalid distances set",r.mode=va;break}if(r.mode=Lb,t===Mb)break e;case Lb:r.mode=Rb;case Rb:if(l>=6&&c>=258){e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=u,r.bits=d,Zpe(e,h),o=e.next_out,i=e.output,c=e.avail_out,s=e.next_in,n=e.input,l=e.avail_in,u=r.hold,d=r.bits,r.mode===vd&&(r.back=-1);break}for(r.back=0;y=r.lencode[u&(1<<r.lenbits)-1],b=y>>>24,v=y>>>16&255,w=y&65535,!(b<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(v&&!(v&240)){for(S=b,k=v,j=w;y=r.lencode[j+((u&(1<<S+k)-1)>>S)],b=y>>>24,v=y>>>16&255,w=y&65535,!(S+b<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=S,d-=S,r.back+=S}if(u>>>=b,d-=b,r.back+=b,r.length=w,v===0){r.mode=UO;break}if(v&32){r.back=-1,r.mode=vd;break}if(v&64){e.msg="invalid literal/length code",r.mode=va;break}r.extra=v&15,r.mode=BO;case BO:if(r.extra){for(E=r.extra;d<E;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=IO;case IO:for(;y=r.distcode[u&(1<<r.distbits)-1],b=y>>>24,v=y>>>16&255,w=y&65535,!(b<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(!(v&240)){for(S=b,k=v,j=w;y=r.distcode[j+((u&(1<<S+k)-1)>>S)],b=y>>>24,v=y>>>16&255,w=y&65535,!(S+b<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=S,d-=S,r.back+=S}if(u>>>=b,d-=b,r.back+=b,v&64){e.msg="invalid distance code",r.mode=va;break}r.offset=w,r.extra=v&15,r.mode=DO;case DO:if(r.extra){for(E=r.extra;d<E;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=va;break}r.mode=$O;case $O:if(c===0)break e;if(p=h-c,r.offset>p){if(p=r.offset-p,p>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=va;break}p>r.wnext?(p-=r.wnext,m=r.wsize-p):m=r.wnext-p,p>r.length&&(p=r.length),g=r.window}else g=i,m=o-r.offset,p=r.length;p>c&&(p=c),c-=p,r.length-=p;do i[o++]=g[m++];while(--p);r.length===0&&(r.mode=Rb);break;case UO:if(c===0)break e;i[o++]=r.length,c--,r.mode=Rb;break;case mk:if(r.wrap){for(;d<32;){if(l===0)break e;l--,u|=n[s++]<<d,d+=8}if(h-=c,e.total_out+=h,r.total+=h,r.wrap&4&&h&&(e.adler=r.check=r.flags?Ru(r.check,i,h,o-h):Z4(r.check,i,h,o-h)),h=c,r.wrap&4&&(r.flags?u:qO(u))!==r.check){e.msg="incorrect data check",r.mode=va;break}u=0,d=0}r.mode=zO;case zO:if(r.wrap&&r.flags){for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&4&&u!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=va;break}u=0,d=0}r.mode=WO;case WO:L=ome;break e;case va:L=cz;break e;case dz:return uz;case fz:default:return zc}return e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=u,r.bits=d,(r.wsize||h!==e.avail_out&&r.mode<va&&(r.mode<mk||t!==wO))&&xz(e,e.output,e.next_out,h-e.avail_out),f-=e.avail_in,h-=e.avail_out,e.total_in+=f,e.total_out+=h,r.total+=h,r.wrap&4&&h&&(e.adler=r.check=r.flags?Ru(r.check,i,h,e.next_out-h):Z4(r.check,i,h,e.next_out-h)),e.data_type=r.bits+(r.last?64:0)+(r.mode===vd?128:0)+(r.mode===Lb||r.mode===pk?256:0),(f===0&&h===0||t===wO)&&L===T0&&(L=cme),L},yme=e=>{if(rp(e))return zc;let t=e.state;return t.window&&(t.window=null),e.state=null,T0},bme=(e,t)=>{if(rp(e))return zc;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,T0):zc},vme=(e,t)=>{const r=t.length;let n,i,s;return rp(e)||(n=e.state,n.wrap!==0&&n.mode!==K2)?zc:n.mode===K2&&(i=1,i=Z4(i,t,r,0),i!==n.check)?cz:(s=xz(e,t,r,r),s?(n.mode=dz,uz):(n.havedict=1,T0))};var wme=pz,Sme=mz,_me=hz,kme=mme,jme=gz,Ame=xme,Nme=yme,Cme=bme,Eme=vme,Tme="pako inflate (from Nodeca project)",Cd={inflateReset:wme,inflateReset2:Sme,inflateResetKeep:_me,inflateInit:kme,inflateInit2:jme,inflate:Ame,inflateEnd:Nme,inflateGetHeader:Cme,inflateSetDictionary:Eme,inflateInfo:Tme};function Pme(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Ome=Pme;const yz=Object.prototype.toString,{Z_NO_FLUSH:Mme,Z_FINISH:Lme,Z_OK:_1,Z_STREAM_END:yk,Z_NEED_DICT:bk,Z_STREAM_ERROR:Rme,Z_DATA_ERROR:VO,Z_MEM_ERROR:Fme}=iz;function dy(e){this.options=az.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Qpe,this.strm.avail_out=0;let r=Cd.inflateInit2(this.strm,t.windowBits);if(r!==_1)throw new Error(eA[r]);if(this.header=new Ome,Cd.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=tA.string2buf(t.dictionary):yz.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Cd.inflateSetDictionary(this.strm,t.dictionary),r!==_1)))throw new Error(eA[r])}dy.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let s,o,l;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?Lme:Mme,yz.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),s=Cd.inflate(r,o),s===bk&&i&&(s=Cd.inflateSetDictionary(r,i),s===_1?s=Cd.inflate(r,o):s===VO&&(s=bk));r.avail_in>0&&s===yk&&r.state.wrap>0&&e[r.next_in]!==0;)Cd.inflateReset(r),s=Cd.inflate(r,o);switch(s){case Rme:case VO:case bk:case Fme:return this.onEnd(s),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||s===yk))if(this.options.to==="string"){let c=tA.utf8border(r.output,r.next_out),u=r.next_out-c,d=tA.buf2string(r.output,c);r.next_out=u,r.avail_out=n-u,u&&r.output.set(r.output.subarray(c,c+u),0),this.onData(d)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(s===_1&&l===0)){if(s===yk)return s=Cd.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};dy.prototype.onData=function(e){this.chunks.push(e)};dy.prototype.onEnd=function(e){e===_1&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=az.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Bme(e,t){const r=new dy(t);if(r.push(e),r.err)throw r.msg||eA[r.err];return r.result}var Ime=dy,Dme=Bme,$me={Inflate:Ime,inflate:Dme};const{Inflate:Ume,inflate:zme}=$me;var GO=Ume,Wme=zme;const bz=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;bz[e]=t}const KO=4294967295;function qme(e,t,r){let n=e;for(let i=0;i<r;i++)n=bz[(n^t[i])&255]^n>>>8;return n}function Hme(e,t){return(qme(KO,e,t)^KO)>>>0}function YO(e,t,r){const n=e.readUint32(),i=Hme(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(i!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${i}`)}function vz(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function wz(e,t,r,n){let i=0;for(;i<n;i++)t[i]=e[i];for(;i<r;i++)t[i]=e[i]+t[i-n]&255}function Sz(e,t,r,n){let i=0;if(r.length===0)for(;i<n;i++)t[i]=e[i];else for(;i<n;i++)t[i]=e[i]+r[i]&255}function _z(e,t,r,n,i){let s=0;if(r.length===0){for(;s<i;s++)t[s]=e[s];for(;s<n;s++)t[s]=e[s]+(t[s-i]>>1)&255}else{for(;s<i;s++)t[s]=e[s]+(r[s]>>1)&255;for(;s<n;s++)t[s]=e[s]+(t[s-i]+r[s]>>1)&255}}function kz(e,t,r,n,i){let s=0;if(r.length===0){for(;s<i;s++)t[s]=e[s];for(;s<n;s++)t[s]=e[s]+t[s-i]&255}else{for(;s<i;s++)t[s]=e[s]+r[s]&255;for(;s<n;s++)t[s]=e[s]+Vme(t[s-i],r[s],r[s-i])&255}}function Vme(e,t,r){const n=e+t-r,i=Math.abs(n-e),s=Math.abs(n-t),o=Math.abs(n-r);return i<=s&&i<=o?e:s<=o?t:r}function Gme(e,t,r,n,i,s){switch(e){case 0:vz(t,r,i);break;case 1:wz(t,r,i,s);break;case 2:Sz(t,r,n,i);break;case 3:_z(t,r,n,i,s);break;case 4:kz(t,r,n,i,s);break;default:throw new Error(`Unsupported filter: ${e}`)}}const Kme=new Uint16Array([255]),Yme=new Uint8Array(Kme.buffer),Xme=Yme[0]===255;function Qme(e){const{data:t,width:r,height:n,channels:i,depth:s}=e,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(s/8)*i,c=new Uint8Array(n*r*l);let u=0;for(let d=0;d<7;d++){const f=o[d],h=Math.ceil((r-f.x)/f.xStep),p=Math.ceil((n-f.y)/f.yStep);if(h<=0||p<=0)continue;const m=h*l,g=new Uint8Array(m);for(let y=0;y<p;y++){const b=t[u++],v=t.subarray(u,u+m);u+=m;const w=new Uint8Array(m);Gme(b,v,w,g,m,l),g.set(w);for(let S=0;S<h;S++){const k=f.x+S*f.xStep,j=f.y+y*f.yStep;if(!(k>=r||j>=n))for(let A=0;A<l;A++)c[(j*r+k)*l+A]=w[S*l+A]}}}if(s===16){const d=new Uint16Array(c.buffer);if(Xme)for(let f=0;f<d.length;f++)d[f]=Jme(d[f]);return d}else return c}function Jme(e){return(e&255)<<8|e>>8&255}const Zme=new Uint16Array([255]),ege=new Uint8Array(Zme.buffer),tge=ege[0]===255,rge=new Uint8Array(0);function XO(e){const{data:t,width:r,height:n,channels:i,depth:s}=e,o=Math.ceil(s/8)*i,l=Math.ceil(s/8*i*r),c=new Uint8Array(n*l);let u=rge,d=0,f,h;for(let p=0;p<n;p++){switch(f=t.subarray(d+1,d+1+l),h=c.subarray(p*l,(p+1)*l),t[d]){case 0:vz(f,h,l);break;case 1:wz(f,h,l,o);break;case 2:Sz(f,h,u,l);break;case 3:_z(f,h,u,l,o);break;case 4:kz(f,h,u,l,o);break;default:throw new Error(`Unsupported filter: ${t[d]}`)}u=h,d+=l+1}if(s===16){const p=new Uint16Array(c.buffer);if(tge)for(let m=0;m<p.length;m++)p[m]=nge(p[m]);return p}else return c}function nge(e){return(e&255)<<8|e>>8&255}const zv=Uint8Array.of(137,80,78,71,13,10,26,10);function QO(e){if(!ige(e.readBytes(zv.length)))throw new Error("wrong PNG signature")}function ige(e){if(e.length<zv.length)return!1;for(let t=0;t<zv.length;t++)if(e[t]!==zv[t])return!1;return!0}const age="tEXt",sge=0,jz=new TextDecoder("latin1");function oge(e){if(cge(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const lge=/^[\u0000-\u00FF]*$/;function cge(e){if(!lge.test(e))throw new Error("invalid latin1 text")}function uge(e,t,r){const n=Az(t);e[n]=dge(t,r-n.length-1)}function Az(e){for(e.mark();e.readByte()!==sge;);const t=e.offset;e.reset();const r=jz.decode(e.readBytes(t-e.offset-1));return e.skip(1),oge(r),r}function dge(e,t){return jz.decode(e.readBytes(t))}const Wl={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},vk={UNKNOWN:-1,DEFLATE:0},JO={UNKNOWN:-1,ADAPTIVE:0},wk={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Fb={NONE:0,BACKGROUND:1,PREVIOUS:2},Sk={SOURCE:0,OVER:1};class fge extends yC{constructor(r,n={}){super(r);Oi(this,"_checkCrc");Oi(this,"_inflator");Oi(this,"_png");Oi(this,"_apng");Oi(this,"_end");Oi(this,"_hasPalette");Oi(this,"_palette");Oi(this,"_hasTransparency");Oi(this,"_transparency");Oi(this,"_compressionMethod");Oi(this,"_filterMethod");Oi(this,"_interlaceMethod");Oi(this,"_colorType");Oi(this,"_isAnimated");Oi(this,"_numberOfFrames");Oi(this,"_numberOfPlays");Oi(this,"_frames");Oi(this,"_writingDataChunks");const{checkCrc:i=!1}=n;this._checkCrc=i,this._inflator=new GO,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=vk.UNKNOWN,this._filterMethod=JO.UNKNOWN,this._interlaceMethod=wk.UNKNOWN,this._colorType=Wl.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(QO(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(QO(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const i=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case age:uge(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-i!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?YO(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const i=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=i+r;break}if(this.offset-i!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?YO(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=hge(this.readUint8());const n=this.readUint8();this._colorType=n;let i;switch(n){case Wl.GREYSCALE:i=1;break;case Wl.TRUECOLOUR:i=3;break;case Wl.INDEXED_COLOUR:i=1;break;case Wl.GREYSCALE_ALPHA:i=2;break;case Wl.TRUECOLOUR_ALPHA:i=4;break;case Wl.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=i,this._compressionMethod=this.readUint8(),this._compressionMethod!==vk.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const i=[];this._palette=i;for(let s=0;s<n;s++)i.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,i=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,i,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,i=this.offset+this.byteOffset;if(i+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,i,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case Wl.GREYSCALE:case Wl.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case Wl.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const i=this.readByte();this._palette[n].push(i)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case Wl.UNKNOWN:case Wl.GREYSCALE_ALPHA:case Wl.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=Az(this),i=this.readUint8();if(i!==vk.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${i}`);const s=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:Wme(s)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),i=this.readByte();this._png.resolution={x:r,y:n,unit:i}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},i=this._frames.at(r);if(i){if(i.data=XO({data:i.data,width:i.width,height:i.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||i.xOffset===0&&i.yOffset===0&&i.width===this._png.width&&i.height===this._png.height)n.data=i.data;else{const s=this._apng.frames.at(r-1);this.disposeFrame(i,s,n),this.addFrameDataToCanvas(n,i)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,i){switch(r.disposeOp){case Fb.NONE:break;case Fb.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let o=0;o<this._png.width;o++){const l=(s*r.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)i.data[l+c]=0}break;case Fb.PREVIOUS:i.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const i=1<<this._png.depth,s=(o,l)=>{const c=((o+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,u=(o*n.width+l)*this._png.channels;return{index:c,frameIndex:u}};switch(n.blendOp){case Sk.SOURCE:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let d=0;d<this._png.channels;d++)r.data[c+d]=n.data[u+d]}break;case Sk.OVER:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let d=0;d<this._png.channels;d++){const f=n.data[u+this._png.channels-1]/i,h=d%(this._png.channels-1)===0?1:n.data[u+d],p=Math.floor(f*h+(1-f)*r.data[c+d]);r.data[c+d]+=p}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==JO.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===wk.NO_INTERLACE)this._png.data=XO({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===wk.ADAM7)this._png.data=Qme({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Fb.NONE,blendOp:Sk.SOURCE,data:r}),this._inflator=new GO,this._writingDataChunks=!1}}function hge(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var ZO;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(ZO||(ZO={}));function pge(e,t){return new fge(e,t).decode()}var Qn=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function _k(){Qn.console&&typeof Qn.console.log=="function"&&Qn.console.log.apply(Qn.console,arguments)}var ia={log:_k,warn:function(e){Qn.console&&(typeof Qn.console.warn=="function"?Qn.console.warn.apply(Qn.console,arguments):_k.call(null,arguments))},error:function(e){Qn.console&&(typeof Qn.console.error=="function"?Qn.console.error.apply(Qn.console,arguments):_k(e))}};function kk(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){Dh(n.response,t,r)},n.onerror=function(){ia.error("could not download file")},n.send()}function eM(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function Bb(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var Dh=Qn.saveAs||((typeof window>"u"?"undefined":Hi(window))!=="object"||window!==Qn?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=Qn.URL||Qn.webkitURL,i=document.createElement("a");t=t||e.name||"download",i.download=t,i.rel="noopener",typeof e=="string"?(i.href=e,i.origin!==location.origin?eM(i.href)?kk(e,t,r):Bb(i,i.target="_blank"):Bb(i)):(i.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){Bb(i)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(eM(e))kk(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){Bb(n)})}else navigator.msSaveOrOpenBlob(function(i,s){return s===void 0?s={autoBom:!1}:Hi(s)!=="object"&&(ia.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return kk(e,t,r);var i=e.type==="application/octet-stream",s=/constructor/i.test(Qn.HTMLElement)||Qn.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||i&&s)&&(typeof FileReader>"u"?"undefined":Hi(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var d=l.result;d=o?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},l.readAsDataURL(e)}else{var c=Qn.URL||Qn.webkitURL,u=c.createObjectURL(e);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Nz(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,s=r[n].process,o=i.exec(e);o&&(t=s(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}var Wv=Qn.atob.bind(Qn),tM=Qn.btoa.bind(Qn);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function jk(e,t){var r=e[0],n=e[1],i=e[2],s=e[3];r=jo(r,n,i,s,t[0],7,-680876936),s=jo(s,r,n,i,t[1],12,-389564586),i=jo(i,s,r,n,t[2],17,606105819),n=jo(n,i,s,r,t[3],22,-1044525330),r=jo(r,n,i,s,t[4],7,-176418897),s=jo(s,r,n,i,t[5],12,1200080426),i=jo(i,s,r,n,t[6],17,-1473231341),n=jo(n,i,s,r,t[7],22,-45705983),r=jo(r,n,i,s,t[8],7,1770035416),s=jo(s,r,n,i,t[9],12,-1958414417),i=jo(i,s,r,n,t[10],17,-42063),n=jo(n,i,s,r,t[11],22,-1990404162),r=jo(r,n,i,s,t[12],7,1804603682),s=jo(s,r,n,i,t[13],12,-40341101),i=jo(i,s,r,n,t[14],17,-1502002290),r=Ao(r,n=jo(n,i,s,r,t[15],22,1236535329),i,s,t[1],5,-165796510),s=Ao(s,r,n,i,t[6],9,-1069501632),i=Ao(i,s,r,n,t[11],14,643717713),n=Ao(n,i,s,r,t[0],20,-373897302),r=Ao(r,n,i,s,t[5],5,-701558691),s=Ao(s,r,n,i,t[10],9,38016083),i=Ao(i,s,r,n,t[15],14,-660478335),n=Ao(n,i,s,r,t[4],20,-405537848),r=Ao(r,n,i,s,t[9],5,568446438),s=Ao(s,r,n,i,t[14],9,-1019803690),i=Ao(i,s,r,n,t[3],14,-187363961),n=Ao(n,i,s,r,t[8],20,1163531501),r=Ao(r,n,i,s,t[13],5,-1444681467),s=Ao(s,r,n,i,t[2],9,-51403784),i=Ao(i,s,r,n,t[7],14,1735328473),r=No(r,n=Ao(n,i,s,r,t[12],20,-1926607734),i,s,t[5],4,-378558),s=No(s,r,n,i,t[8],11,-2022574463),i=No(i,s,r,n,t[11],16,1839030562),n=No(n,i,s,r,t[14],23,-35309556),r=No(r,n,i,s,t[1],4,-1530992060),s=No(s,r,n,i,t[4],11,1272893353),i=No(i,s,r,n,t[7],16,-155497632),n=No(n,i,s,r,t[10],23,-1094730640),r=No(r,n,i,s,t[13],4,681279174),s=No(s,r,n,i,t[0],11,-358537222),i=No(i,s,r,n,t[3],16,-722521979),n=No(n,i,s,r,t[6],23,76029189),r=No(r,n,i,s,t[9],4,-640364487),s=No(s,r,n,i,t[12],11,-421815835),i=No(i,s,r,n,t[15],16,530742520),r=Co(r,n=No(n,i,s,r,t[2],23,-995338651),i,s,t[0],6,-198630844),s=Co(s,r,n,i,t[7],10,1126891415),i=Co(i,s,r,n,t[14],15,-1416354905),n=Co(n,i,s,r,t[5],21,-57434055),r=Co(r,n,i,s,t[12],6,1700485571),s=Co(s,r,n,i,t[3],10,-1894986606),i=Co(i,s,r,n,t[10],15,-1051523),n=Co(n,i,s,r,t[1],21,-2054922799),r=Co(r,n,i,s,t[8],6,1873313359),s=Co(s,r,n,i,t[15],10,-30611744),i=Co(i,s,r,n,t[6],15,-1560198380),n=Co(n,i,s,r,t[13],21,1309151649),r=Co(r,n,i,s,t[4],6,-145523070),s=Co(s,r,n,i,t[11],10,-1120210379),i=Co(i,s,r,n,t[2],15,718787259),n=Co(n,i,s,r,t[9],21,-343485551),e[0]=Kf(r,e[0]),e[1]=Kf(n,e[1]),e[2]=Kf(i,e[2]),e[3]=Kf(s,e[3])}function RS(e,t,r,n,i,s){return t=Kf(Kf(t,e),Kf(n,s)),Kf(t<<i|t>>>32-i,r)}function jo(e,t,r,n,i,s,o){return RS(t&r|~t&n,e,t,i,s,o)}function Ao(e,t,r,n,i,s,o){return RS(t&n|r&~n,e,t,i,s,o)}function No(e,t,r,n,i,s,o){return RS(t^r^n,e,t,i,s,o)}function Co(e,t,r,n,i,s,o){return RS(r^(t|~n),e,t,i,s,o)}function Cz(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)jk(n,mge(e.substring(t-64,t)));e=e.substring(t-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)i[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(i[t>>2]|=128<<(t%4<<3),t>55)for(jk(n,i),t=0;t<16;t++)i[t]=0;return i[14]=8*r,jk(n,i),n}function mge(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var rM="0123456789abcdef".split("");function gge(e){for(var t="",r=0;r<4;r++)t+=rM[e>>8*r+4&15]+rM[e>>8*r&15];return t}function xge(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function rA(e){return Cz(e).map(xge).join("")}var yge=function(e){for(var t=0;t<e.length;t++)e[t]=gge(e[t]);return e.join("")}(Cz("hello"))!="5d41402abc4b2a76b9719d911017c592";function Kf(e,t){if(yge){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function nA(e,t){var r,n,i,s;if(e!==r){for(var o=(i=e,s=1+(256/e.length|0),new Array(s+1).join(i)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var d=l[c];u=(u+d+o.charCodeAt(c))%256,l[c]=l[u],l[u]=d}r=e,n=l}else l=n;var f=t.length,h=0,p=0,m="";for(c=0;c<f;c++)p=(p+(d=l[h=(h+1)%256]))%256,l[h]=l[p],l[p]=d,o=l[(l[h]+l[p])%256],m+=String.fromCharCode(t.charCodeAt(c)^o);return m}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var nM={print:4,modify:8,copy:16,"annot-forms":32};function Fp(e,t,r,n){this.v=1,this.r=2;var i=192;e.forEach(function(l){if(nM.perm!==void 0)throw new Error("Invalid permission: "+l);i+=nM[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(t+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^i)),this.encryptionKey=rA(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=nA(this.encryptionKey,this.padding)}function Bp(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var i=e.charCodeAt(n);t+=i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?"#"+("0"+i.toString(16)).slice(-2):e[n]}return t}function iM(e){if(Hi(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var s=Math.random().toString(35);return t[r][s]=[n,!!i],s},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var s in t[r]){var o=t[r][s];try{o[0].apply(e,n)}catch(l){Qn.console&&ia.error("jsPDF PubSub Error",l.message,l)}o[1]&&i.push(s)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Y2(e){if(!(this instanceof Y2))return new Y2(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function Ez(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function qh(e,t,r,n,i){if(!(this instanceof qh))return new qh(e,t,r,n,i);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,Ez.call(this,n,i)}function tm(e,t,r,n,i){if(!(this instanceof tm))return new tm(e,t,r,n,i);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,Ez.call(this,n,i)}function Un(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],s=arguments[3],o=[],l=1,c=16,u="S",d=null;Hi(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,i=e.format||i,s=e.compress||e.compressPdf||s,(d=e.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),l=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),u=e.defaultPathOperation||"S"),o=e.filters||(s===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var f=e.putOnlyUsedFonts||!1,h={},p={internal:{},__private__:{}};p.__private__.PubSub=iM;var m="1.3",g=p.__private__.getPdfVersion=function(){return m};p.__private__.setPdfVersion=function(M){m=M};var y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};p.__private__.getPageFormats=function(){return y};var b=p.__private__.getPageFormat=function(M){return y[M]};i=i||"a4";var v="compat",w="advanced",S=v;function k(){this.saveGraphicsState(),I(new je(he,0,0,-he,0,Hn()*he).toString()+" cm"),this.setFontSize(this.getFontSize()/he),u="n",S=w}function j(){this.restoreGraphicsState(),u="S",S=v}var A=p.__private__.combineFontStyleAndFontWeight=function(M,ce){if(M=="bold"&&ce=="normal"||M=="bold"&&ce==400||M=="normal"&&ce=="italic"||M=="bold"&&ce=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ce&&(M=ce==400||ce==="normal"?M==="italic"?"italic":"normal":ce!=700&&ce!=="bold"||M!=="normal"?(ce==700?"bold":ce)+""+M:"bold"),M};p.advancedAPI=function(M){var ce=S===v;return ce&&k.call(this),typeof M!="function"||(M(this),ce&&j.call(this)),this},p.compatAPI=function(M){var ce=S===w;return ce&&j.call(this),typeof M!="function"||(M(this),ce&&k.call(this)),this},p.isAdvancedAPI=function(){return S===w};var L,P=function(M){if(S!==w)throw new Error(M+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},F=p.roundToPrecision=p.__private__.roundToPrecision=function(M,ce){var Le=t||ce;if(isNaN(M)||isNaN(Le))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return M.toFixed(Le).replace(/0+$/,"")};L=p.hpf=p.__private__.hpf=typeof c=="number"?function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.hpf");return F(M,c)}:c==="smart"?function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.hpf");return F(M,M>-1&&M<1?16:5)}:function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.hpf");return F(M,16)};var E=p.f2=p.__private__.f2=function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.f2");return F(M,2)},T=p.__private__.f3=function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.f3");return F(M,3)},B=p.scale=p.__private__.scale=function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.scale");return S===v?M*he:S===w?M:void 0},q=function(M){return B(function(ce){return S===v?Hn()-ce:S===w?ce:void 0}(M))};p.__private__.setPrecision=p.setPrecision=function(M){typeof parseInt(M,10)=="number"&&(t=parseInt(M,10))};var U,se="00000000000000000000000000000000",de=p.__private__.getFileId=function(){return se},z=p.__private__.setFileId=function(M){return se=M!==void 0&&/^[a-fA-F0-9]{32}$/.test(M)?M.toUpperCase():se.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(Ue=new Fp(d.userPermissions,d.userPassword,d.ownerPassword,se)),se};p.setFileId=function(M){return z(M),this},p.getFileId=function(){return de()};var G=p.__private__.convertDateToPDFDate=function(M){var ce=M.getTimezoneOffset(),Le=ce<0?"+":"-",it=Math.floor(Math.abs(ce/60)),At=Math.abs(ce%60),lr=[Le,H(it),"'",H(At),"'"].join("");return["D:",M.getFullYear(),H(M.getMonth()+1),H(M.getDate()),H(M.getHours()),H(M.getMinutes()),H(M.getSeconds()),lr].join("")},ie=p.__private__.convertPDFDateToDate=function(M){var ce=parseInt(M.substr(2,4),10),Le=parseInt(M.substr(6,2),10)-1,it=parseInt(M.substr(8,2),10),At=parseInt(M.substr(10,2),10),lr=parseInt(M.substr(12,2),10),nr=parseInt(M.substr(14,2),10);return new Date(ce,Le,it,At,lr,nr,0)},Y=p.__private__.setCreationDate=function(M){var ce;if(M===void 0&&(M=new Date),M instanceof Date)ce=G(M);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(M))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ce=M}return U=ce},C=p.__private__.getCreationDate=function(M){var ce=U;return M==="jsDate"&&(ce=ie(U)),ce};p.setCreationDate=function(M){return Y(M),this},p.getCreationDate=function(M){return C(M)};var K,H=p.__private__.padd2=function(M){return("0"+parseInt(M)).slice(-2)},R=p.__private__.padd2Hex=function(M){return("00"+(M=M.toString())).substr(M.length)},J=0,V=[],X=[],Q=0,ne=[],oe=[],O=!1,W=X;p.__private__.setCustomOutputDestination=function(M){O=!0,W=M};var ae=function(M){O||(W=M)};p.__private__.resetCustomOutputDestination=function(){O=!1,W=X};var I=p.__private__.out=function(M){return M=M.toString(),Q+=M.length+1,W.push(M),W},Z=p.__private__.write=function(M){return I(arguments.length===1?M.toString():Array.prototype.join.call(arguments," "))},me=p.__private__.getArrayBuffer=function(M){for(var ce=M.length,Le=new ArrayBuffer(ce),it=new Uint8Array(Le);ce--;)it[ce]=M.charCodeAt(ce);return Le},Te=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];p.__private__.getStandardFonts=function(){return Te};var Ae=e.fontSize||16;p.__private__.setFontSize=p.setFontSize=function(M){return Ae=S===w?M/he:M,this};var Be,Ee=p.__private__.getFontSize=p.getFontSize=function(){return S===v?Ae:Ae*he},ze=e.R2L||!1;p.__private__.setR2L=p.setR2L=function(M){return ze=M,this},p.__private__.getR2L=p.getR2L=function(){return ze};var Xe,Pt=p.__private__.setZoomMode=function(M){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(M))Be=M;else if(isNaN(M)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(M)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+M+'" is not recognized.');Be=M}else Be=parseInt(M,10)};p.__private__.getZoomMode=function(){return Be};var ft,He=p.__private__.setPageMode=function(M){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(M)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+M+'" is not recognized.');Xe=M};p.__private__.getPageMode=function(){return Xe};var tt=p.__private__.setLayoutMode=function(M){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(M)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+M+'" is not recognized.');ft=M};p.__private__.getLayoutMode=function(){return ft},p.__private__.setDisplayMode=p.setDisplayMode=function(M,ce,Le){return Pt(M),tt(ce),He(Le),this};var _e={title:"",subject:"",author:"",keywords:"",creator:""};p.__private__.getDocumentProperty=function(M){if(Object.keys(_e).indexOf(M)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return _e[M]},p.__private__.getDocumentProperties=function(){return _e},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(M){for(var ce in _e)_e.hasOwnProperty(ce)&&M[ce]&&(_e[ce]=M[ce]);return this},p.__private__.setDocumentProperty=function(M,ce){if(Object.keys(_e).indexOf(M)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return _e[M]=ce};var Se,he,ye,ht,Ge,lt={},jt={},wt=[],yt={},Fr={},Tt={},hr={},rn=null,en=0,$r=[],Kr=new iM(p),Rn=e.hotfixes||[],Pr={},Sn={},Me=[],je=function M(ce,Le,it,At,lr,nr){if(!(this instanceof M))return new M(ce,Le,it,At,lr,nr);isNaN(ce)&&(ce=1),isNaN(Le)&&(Le=0),isNaN(it)&&(it=0),isNaN(At)&&(At=1),isNaN(lr)&&(lr=0),isNaN(nr)&&(nr=0),this._matrix=[ce,Le,it,At,lr,nr]};Object.defineProperty(je.prototype,"sx",{get:function(){return this._matrix[0]},set:function(M){this._matrix[0]=M}}),Object.defineProperty(je.prototype,"shy",{get:function(){return this._matrix[1]},set:function(M){this._matrix[1]=M}}),Object.defineProperty(je.prototype,"shx",{get:function(){return this._matrix[2]},set:function(M){this._matrix[2]=M}}),Object.defineProperty(je.prototype,"sy",{get:function(){return this._matrix[3]},set:function(M){this._matrix[3]=M}}),Object.defineProperty(je.prototype,"tx",{get:function(){return this._matrix[4]},set:function(M){this._matrix[4]=M}}),Object.defineProperty(je.prototype,"ty",{get:function(){return this._matrix[5]},set:function(M){this._matrix[5]=M}}),Object.defineProperty(je.prototype,"a",{get:function(){return this._matrix[0]},set:function(M){this._matrix[0]=M}}),Object.defineProperty(je.prototype,"b",{get:function(){return this._matrix[1]},set:function(M){this._matrix[1]=M}}),Object.defineProperty(je.prototype,"c",{get:function(){return this._matrix[2]},set:function(M){this._matrix[2]=M}}),Object.defineProperty(je.prototype,"d",{get:function(){return this._matrix[3]},set:function(M){this._matrix[3]=M}}),Object.defineProperty(je.prototype,"e",{get:function(){return this._matrix[4]},set:function(M){this._matrix[4]=M}}),Object.defineProperty(je.prototype,"f",{get:function(){return this._matrix[5]},set:function(M){this._matrix[5]=M}}),Object.defineProperty(je.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(je.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(je.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(je.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),je.prototype.join=function(M){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(L).join(M)},je.prototype.multiply=function(M){var ce=M.sx*this.sx+M.shy*this.shx,Le=M.sx*this.shy+M.shy*this.sy,it=M.shx*this.sx+M.sy*this.shx,At=M.shx*this.shy+M.sy*this.sy,lr=M.tx*this.sx+M.ty*this.shx+this.tx,nr=M.tx*this.shy+M.ty*this.sy+this.ty;return new je(ce,Le,it,At,lr,nr)},je.prototype.decompose=function(){var M=this.sx,ce=this.shy,Le=this.shx,it=this.sy,At=this.tx,lr=this.ty,nr=Math.sqrt(M*M+ce*ce),yr=(M/=nr)*Le+(ce/=nr)*it;Le-=M*yr,it-=ce*yr;var Wr=Math.sqrt(Le*Le+it*it);return yr/=Wr,M*(it/=Wr)<ce*(Le/=Wr)&&(M=-M,ce=-ce,yr=-yr,nr=-nr),{scale:new je(nr,0,0,Wr,0,0),translate:new je(1,0,0,1,At,lr),rotate:new je(M,ce,-ce,M,0,0),skew:new je(1,0,yr,1,0,0)}},je.prototype.toString=function(M){return this.join(" ")},je.prototype.inversed=function(){var M=this.sx,ce=this.shy,Le=this.shx,it=this.sy,At=this.tx,lr=this.ty,nr=1/(M*it-ce*Le),yr=it*nr,Wr=-ce*nr,Vr=-Le*nr,dn=M*nr;return new je(yr,Wr,Vr,dn,-yr*At-Vr*lr,-Wr*At-dn*lr)},je.prototype.applyToPoint=function(M){var ce=M.x*this.sx+M.y*this.shx+this.tx,Le=M.x*this.shy+M.y*this.sy+this.ty;return new gn(ce,Le)},je.prototype.applyToRectangle=function(M){var ce=this.applyToPoint(M),Le=this.applyToPoint(new gn(M.x+M.w,M.y+M.h));return new fn(ce.x,ce.y,Le.x-ce.x,Le.y-ce.y)},je.prototype.clone=function(){var M=this.sx,ce=this.shy,Le=this.shx,it=this.sy,At=this.tx,lr=this.ty;return new je(M,ce,Le,it,At,lr)},p.Matrix=je;var Mt=p.matrixMult=function(M,ce){return ce.multiply(M)},pt=new je(1,0,0,1,0,0);p.unitMatrix=p.identityMatrix=pt;var Ut=function(M,ce){if(!Fr[M]){var Le=(ce instanceof qh?"Sh":"P")+(Object.keys(yt).length+1).toString(10);ce.id=Le,Fr[M]=Le,yt[Le]=ce,Kr.publish("addPattern",ce)}};p.ShadingPattern=qh,p.TilingPattern=tm,p.addShadingPattern=function(M,ce){return P("addShadingPattern()"),Ut(M,ce),this},p.beginTilingPattern=function(M){P("beginTilingPattern()"),at(M.boundingBox[0],M.boundingBox[1],M.boundingBox[2]-M.boundingBox[0],M.boundingBox[3]-M.boundingBox[1],M.matrix)},p.endTilingPattern=function(M,ce){P("endTilingPattern()"),ce.stream=oe[K].join(`
`),Ut(M,ce),Kr.publish("endTilingPattern",ce),Me.pop().restore()};var ir,fr=p.__private__.newObject=function(){var M=vr();return re(M,!0),M},vr=p.__private__.newObjectDeferred=function(){return J++,V[J]=function(){return Q},J},re=function(M,ce){return ce=typeof ce=="boolean"&&ce,V[M]=Q,ce&&I(M+" 0 obj"),M},le=p.__private__.newAdditionalObject=function(){var M={objId:vr(),content:""};return ne.push(M),M},te=vr(),ue=vr(),Ne=p.__private__.decodeColorString=function(M){var ce=M.split(" ");if(ce.length!==2||ce[1]!=="g"&&ce[1]!=="G")ce.length!==5||ce[4]!=="k"&&ce[4]!=="K"||(ce=[(1-ce[0])*(1-ce[3]),(1-ce[1])*(1-ce[3]),(1-ce[2])*(1-ce[3]),"r"]);else{var Le=parseFloat(ce[0]);ce=[Le,Le,Le,"r"]}for(var it="#",At=0;At<3;At++)it+=("0"+Math.floor(255*parseFloat(ce[At])).toString(16)).slice(-2);return it},ke=p.__private__.encodeColorString=function(M){var ce;typeof M=="string"&&(M={ch1:M});var Le=M.ch1,it=M.ch2,At=M.ch3,lr=M.ch4,nr=M.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Le=="string"&&Le.charAt(0)!=="#"){var yr=new Nz(Le);if(yr.ok)Le=yr.toHex();else if(!/^\d*\.?\d*$/.test(Le))throw new Error('Invalid color "'+Le+'" passed to jsPDF.encodeColorString.')}if(typeof Le=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Le)&&(Le="#"+Le[1]+Le[1]+Le[2]+Le[2]+Le[3]+Le[3]),typeof Le=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Le)){var Wr=parseInt(Le.substr(1),16);Le=Wr>>16&255,it=Wr>>8&255,At=255&Wr}if(it===void 0||lr===void 0&&Le===it&&it===At)ce=typeof Le=="string"?Le+" "+nr[0]:M.precision===2?E(Le/255)+" "+nr[0]:T(Le/255)+" "+nr[0];else if(lr===void 0||Hi(lr)==="object"){if(lr&&!isNaN(lr.a)&&lr.a===0)return["1.","1.","1.",nr[1]].join(" ");ce=typeof Le=="string"?[Le,it,At,nr[1]].join(" "):M.precision===2?[E(Le/255),E(it/255),E(At/255),nr[1]].join(" "):[T(Le/255),T(it/255),T(At/255),nr[1]].join(" ")}else ce=typeof Le=="string"?[Le,it,At,lr,nr[2]].join(" "):M.precision===2?[E(Le),E(it),E(At),E(lr),nr[2]].join(" "):[T(Le),T(it),T(At),T(lr),nr[2]].join(" ");return ce},vt=p.__private__.getFilters=function(){return o},rt=p.__private__.putStream=function(M){var ce=(M=M||{}).data||"",Le=M.filters||vt(),it=M.alreadyAppliedFilters||[],At=M.addLength1||!1,lr=ce.length,nr=M.objectId,yr=function(Ke){return Ke};if(d!==null&&nr===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(yr=Ue.encryptor(nr,0));var Wr={};Le===!0&&(Le=["FlateEncode"]);var Vr=M.additionalKeyValues||[],dn=(Wr=Un.API.processDataByFilters!==void 0?Un.API.processDataByFilters(ce,Le):{data:ce,reverseChain:[]}).reverseChain+(Array.isArray(it)?it.join(" "):it.toString());if(Wr.data.length!==0&&(Vr.push({key:"Length",value:Wr.data.length}),At===!0&&Vr.push({key:"Length1",value:lr})),dn.length!=0)if(dn.split("/").length-1==1)Vr.push({key:"Filter",value:dn});else{Vr.push({key:"Filter",value:"["+dn+"]"});for(var Pn=0;Pn<Vr.length;Pn+=1)if(Vr[Pn].key==="DecodeParms"){for(var li=[],fe=0;fe<Wr.reverseChain.split("/").length-1;fe+=1)li.push("null");li.push(Vr[Pn].value),Vr[Pn].value="["+li.join(" ")+"]"}}I("<<");for(var xe=0;xe<Vr.length;xe++)I("/"+Vr[xe].key+" "+Vr[xe].value);I(">>"),Wr.data.length!==0&&(I("stream"),I(yr(Wr.data)),I("endstream"))},De=p.__private__.putPage=function(M){var ce=M.number,Le=M.data,it=M.objId,At=M.contentsObjId;re(it,!0),I("<</Type /Page"),I("/Parent "+M.rootDictionaryObjId+" 0 R"),I("/Resources "+M.resourceDictionaryObjId+" 0 R"),I("/MediaBox ["+parseFloat(L(M.mediaBox.bottomLeftX))+" "+parseFloat(L(M.mediaBox.bottomLeftY))+" "+L(M.mediaBox.topRightX)+" "+L(M.mediaBox.topRightY)+"]"),M.cropBox!==null&&I("/CropBox ["+L(M.cropBox.bottomLeftX)+" "+L(M.cropBox.bottomLeftY)+" "+L(M.cropBox.topRightX)+" "+L(M.cropBox.topRightY)+"]"),M.bleedBox!==null&&I("/BleedBox ["+L(M.bleedBox.bottomLeftX)+" "+L(M.bleedBox.bottomLeftY)+" "+L(M.bleedBox.topRightX)+" "+L(M.bleedBox.topRightY)+"]"),M.trimBox!==null&&I("/TrimBox ["+L(M.trimBox.bottomLeftX)+" "+L(M.trimBox.bottomLeftY)+" "+L(M.trimBox.topRightX)+" "+L(M.trimBox.topRightY)+"]"),M.artBox!==null&&I("/ArtBox ["+L(M.artBox.bottomLeftX)+" "+L(M.artBox.bottomLeftY)+" "+L(M.artBox.topRightX)+" "+L(M.artBox.topRightY)+"]"),typeof M.userUnit=="number"&&M.userUnit!==1&&I("/UserUnit "+M.userUnit),Kr.publish("putPage",{objId:it,pageContext:$r[ce],pageNumber:ce,page:Le}),I("/Contents "+At+" 0 R"),I(">>"),I("endobj");var lr=Le.join(`
`);return S===w&&(lr+=`
Q`),re(At,!0),rt({data:lr,filters:vt(),objectId:At}),I("endobj"),it},We=p.__private__.putPages=function(){var M,ce,Le=[];for(M=1;M<=en;M++)$r[M].objId=vr(),$r[M].contentsObjId=vr();for(M=1;M<=en;M++)Le.push(De({number:M,data:oe[M],objId:$r[M].objId,contentsObjId:$r[M].contentsObjId,mediaBox:$r[M].mediaBox,cropBox:$r[M].cropBox,bleedBox:$r[M].bleedBox,trimBox:$r[M].trimBox,artBox:$r[M].artBox,userUnit:$r[M].userUnit,rootDictionaryObjId:te,resourceDictionaryObjId:ue}));re(te,!0),I("<</Type /Pages");var it="/Kids [";for(ce=0;ce<en;ce++)it+=Le[ce]+" 0 R ";I(it+"]"),I("/Count "+en),I(">>"),I("endobj"),Kr.publish("postPutPages")},st=function(M){Kr.publish("putFont",{font:M,out:I,newObject:fr,putStream:rt}),M.isAlreadyPutted!==!0&&(M.objectNumber=fr(),I("<<"),I("/Type /Font"),I("/BaseFont /"+Bp(M.postScriptName)),I("/Subtype /Type1"),typeof M.encoding=="string"&&I("/Encoding /"+M.encoding),I("/FirstChar 32"),I("/LastChar 255"),I(">>"),I("endobj"))},zt=function(M){M.objectNumber=fr();var ce=[];ce.push({key:"Type",value:"/XObject"}),ce.push({key:"Subtype",value:"/Form"}),ce.push({key:"BBox",value:"["+[L(M.x),L(M.y),L(M.x+M.width),L(M.y+M.height)].join(" ")+"]"}),ce.push({key:"Matrix",value:"["+M.matrix.toString()+"]"});var Le=M.pages[1].join(`
`);rt({data:Le,additionalKeyValues:ce,objectId:M.objectNumber}),I("endobj")},Wt=function(M,ce){ce||(ce=21);var Le=fr(),it=function(nr,yr){var Wr,Vr=[],dn=1/(yr-1);for(Wr=0;Wr<1;Wr+=dn)Vr.push(Wr);if(Vr.push(1),nr[0].offset!=0){var Pn={offset:0,color:nr[0].color};nr.unshift(Pn)}if(nr[nr.length-1].offset!=1){var li={offset:1,color:nr[nr.length-1].color};nr.push(li)}for(var fe="",xe=0,Ke=0;Ke<Vr.length;Ke++){for(Wr=Vr[Ke];Wr>nr[xe+1].offset;)xe++;var Fe=nr[xe].offset,gt=(Wr-Fe)/(nr[xe+1].offset-Fe),dr=nr[xe].color,Ft=nr[xe+1].color;fe+=R(Math.round((1-gt)*dr[0]+gt*Ft[0]).toString(16))+R(Math.round((1-gt)*dr[1]+gt*Ft[1]).toString(16))+R(Math.round((1-gt)*dr[2]+gt*Ft[2]).toString(16))}return fe.trim()}(M.colors,ce),At=[];At.push({key:"FunctionType",value:"0"}),At.push({key:"Domain",value:"[0.0 1.0]"}),At.push({key:"Size",value:"["+ce+"]"}),At.push({key:"BitsPerSample",value:"8"}),At.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),At.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),rt({data:it,additionalKeyValues:At,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Le}),I("endobj"),M.objectNumber=fr(),I("<< /ShadingType "+M.type),I("/ColorSpace /DeviceRGB");var lr="/Coords ["+L(parseFloat(M.coords[0]))+" "+L(parseFloat(M.coords[1]))+" ";M.type===2?lr+=L(parseFloat(M.coords[2]))+" "+L(parseFloat(M.coords[3])):lr+=L(parseFloat(M.coords[2]))+" "+L(parseFloat(M.coords[3]))+" "+L(parseFloat(M.coords[4]))+" "+L(parseFloat(M.coords[5])),I(lr+="]"),M.matrix&&I("/Matrix ["+M.matrix.toString()+"]"),I("/Function "+Le+" 0 R"),I("/Extend [true true]"),I(">>"),I("endobj")},xt=function(M,ce){var Le=vr(),it=fr();ce.push({resourcesOid:Le,objectOid:it}),M.objectNumber=it;var At=[];At.push({key:"Type",value:"/Pattern"}),At.push({key:"PatternType",value:"1"}),At.push({key:"PaintType",value:"1"}),At.push({key:"TilingType",value:"1"}),At.push({key:"BBox",value:"["+M.boundingBox.map(L).join(" ")+"]"}),At.push({key:"XStep",value:L(M.xStep)}),At.push({key:"YStep",value:L(M.yStep)}),At.push({key:"Resources",value:Le+" 0 R"}),M.matrix&&At.push({key:"Matrix",value:"["+M.matrix.toString()+"]"}),rt({data:M.stream,additionalKeyValues:At,objectId:M.objectNumber}),I("endobj")},Dt=function(M){for(var ce in M.objectNumber=fr(),I("<<"),M)switch(ce){case"opacity":I("/ca "+E(M[ce]));break;case"stroke-opacity":I("/CA "+E(M[ce]))}I(">>"),I("endobj")},Vt=function(M){re(M.resourcesOid,!0),I("<<"),I("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var ce in I("/Font <<"),lt)lt.hasOwnProperty(ce)&&(f===!1||f===!0&&h.hasOwnProperty(ce))&&I("/"+ce+" "+lt[ce].objectNumber+" 0 R");I(">>")}(),function(){if(Object.keys(yt).length>0){for(var ce in I("/Shading <<"),yt)yt.hasOwnProperty(ce)&&yt[ce]instanceof qh&&yt[ce].objectNumber>=0&&I("/"+ce+" "+yt[ce].objectNumber+" 0 R");Kr.publish("putShadingPatternDict"),I(">>")}}(),function(ce){if(Object.keys(yt).length>0){for(var Le in I("/Pattern <<"),yt)yt.hasOwnProperty(Le)&&yt[Le]instanceof p.TilingPattern&&yt[Le].objectNumber>=0&&yt[Le].objectNumber<ce&&I("/"+Le+" "+yt[Le].objectNumber+" 0 R");Kr.publish("putTilingPatternDict"),I(">>")}}(M.objectOid),function(){if(Object.keys(Tt).length>0){var ce;for(ce in I("/ExtGState <<"),Tt)Tt.hasOwnProperty(ce)&&Tt[ce].objectNumber>=0&&I("/"+ce+" "+Tt[ce].objectNumber+" 0 R");Kr.publish("putGStateDict"),I(">>")}}(),function(){for(var ce in I("/XObject <<"),Pr)Pr.hasOwnProperty(ce)&&Pr[ce].objectNumber>=0&&I("/"+ce+" "+Pr[ce].objectNumber+" 0 R");Kr.publish("putXobjectDict"),I(">>")}(),I(">>"),I("endobj")},gr=function(M){jt[M.fontName]=jt[M.fontName]||{},jt[M.fontName][M.fontStyle]=M.id},sr=function(M,ce,Le,it,At){var lr={id:"F"+(Object.keys(lt).length+1).toString(10),postScriptName:M,fontName:ce,fontStyle:Le,encoding:it,isStandardFont:At||!1,metadata:{}};return Kr.publish("addFont",{font:lr,instance:this}),lt[lr.id]=lr,gr(lr),lr.id},Lr=p.__private__.pdfEscape=p.pdfEscape=function(M,ce){return function(Le,it){var At,lr,nr,yr,Wr,Vr,dn,Pn,li;if(nr=(it=it||{}).sourceEncoding||"Unicode",Wr=it.outputEncoding,(it.autoencode||Wr)&&lt[Se].metadata&&lt[Se].metadata[nr]&&lt[Se].metadata[nr].encoding&&(yr=lt[Se].metadata[nr].encoding,!Wr&&lt[Se].encoding&&(Wr=lt[Se].encoding),!Wr&&yr.codePages&&(Wr=yr.codePages[0]),typeof Wr=="string"&&(Wr=yr[Wr]),Wr)){for(dn=!1,Vr=[],At=0,lr=Le.length;At<lr;At++)(Pn=Wr[Le.charCodeAt(At)])?Vr.push(String.fromCharCode(Pn)):Vr.push(Le[At]),Vr[At].charCodeAt(0)>>8&&(dn=!0);Le=Vr.join("")}for(At=Le.length;dn===void 0&&At!==0;)Le.charCodeAt(At-1)>>8&&(dn=!0),At--;if(!dn)return Le;for(Vr=it.noBOM?[]:[254,255],At=0,lr=Le.length;At<lr;At++){if((li=(Pn=Le.charCodeAt(At))>>8)>>8)throw new Error("Character at position "+At+" of string '"+Le+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Vr.push(li),Vr.push(Pn-(li<<8))}return String.fromCharCode.apply(void 0,Vr)}(M,ce).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Zr=p.__private__.beginPage=function(M){oe[++en]=[],$r[en]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(M[0]),topRightY:Number(M[1])}},zr(en),ae(oe[K])},Er=function(M,ce){var Le,it,At;switch(r=ce||r,typeof M=="string"&&(Le=b(M.toLowerCase()),Array.isArray(Le)&&(it=Le[0],At=Le[1])),Array.isArray(M)&&(it=M[0]*he,At=M[1]*he),isNaN(it)&&(it=i[0],At=i[1]),(it>14400||At>14400)&&(ia.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),it=Math.min(14400,it),At=Math.min(14400,At)),i=[it,At],r.substr(0,1)){case"l":At>it&&(i=[At,it]);break;case"p":it>At&&(i=[At,it])}Zr(i),St(Ze),I($e),hn!==0&&I(hn+" J"),Tn!==0&&I(Tn+" j"),Kr.publish("addPage",{pageNumber:en})},qt=function(M){M>0&&M<=en&&(oe.splice(M,1),$r.splice(M,1),en--,K>en&&(K=en),this.setPage(K))},zr=function(M){M>0&&M<=en&&(K=M)},bn=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return oe.length-1},or=function(M,ce,Le){var it,At=void 0;return Le=Le||{},M=M!==void 0?M:lt[Se].fontName,ce=ce!==void 0?ce:lt[Se].fontStyle,it=M.toLowerCase(),jt[it]!==void 0&&jt[it][ce]!==void 0?At=jt[it][ce]:jt[M]!==void 0&&jt[M][ce]!==void 0?At=jt[M][ce]:Le.disableWarning===!1&&ia.warn("Unable to look up font label for font '"+M+"', '"+ce+"'. Refer to getFontList() for available fonts."),At||Le.noFallback||(At=jt.times[ce])==null&&(At=jt.times.normal),At},kr=p.__private__.putInfo=function(){var M=fr(),ce=function(it){return it};for(var Le in d!==null&&(ce=Ue.encryptor(M,0)),I("<<"),I("/Producer ("+Lr(ce("jsPDF "+Un.version))+")"),_e)_e.hasOwnProperty(Le)&&_e[Le]&&I("/"+Le.substr(0,1).toUpperCase()+Le.substr(1)+" ("+Lr(ce(_e[Le]))+")");I("/CreationDate ("+Lr(ce(U))+")"),I(">>"),I("endobj")},Tr=p.__private__.putCatalog=function(M){var ce=(M=M||{}).rootDictionaryObjId||te;switch(fr(),I("<<"),I("/Type /Catalog"),I("/Pages "+ce+" 0 R"),Be||(Be="fullwidth"),Be){case"fullwidth":I("/OpenAction [3 0 R /FitH null]");break;case"fullheight":I("/OpenAction [3 0 R /FitV null]");break;case"fullpage":I("/OpenAction [3 0 R /Fit]");break;case"original":I("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Le=""+Be;Le.substr(Le.length-1)==="%"&&(Be=parseInt(Be)/100),typeof Be=="number"&&I("/OpenAction [3 0 R /XYZ null null "+E(Be)+"]")}switch(ft||(ft="continuous"),ft){case"continuous":I("/PageLayout /OneColumn");break;case"single":I("/PageLayout /SinglePage");break;case"two":case"twoleft":I("/PageLayout /TwoColumnLeft");break;case"tworight":I("/PageLayout /TwoColumnRight")}Xe&&I("/PageMode /"+Xe),Kr.publish("putCatalog"),I(">>"),I("endobj")},Or=p.__private__.putTrailer=function(){I("trailer"),I("<<"),I("/Size "+(J+1)),I("/Root "+J+" 0 R"),I("/Info "+(J-1)+" 0 R"),d!==null&&I("/Encrypt "+Ue.oid+" 0 R"),I("/ID [ <"+se+"> <"+se+"> ]"),I(">>")},Gt=p.__private__.putHeader=function(){I("%PDF-"+m),I("%")},ur=p.__private__.putXRef=function(){var M="0000000000";I("xref"),I("0 "+(J+1)),I("0000000000 65535 f ");for(var ce=1;ce<=J;ce++)typeof V[ce]=="function"?I((M+V[ce]()).slice(-10)+" 00000 n "):V[ce]!==void 0?I((M+V[ce]).slice(-10)+" 00000 n "):I("0000000000 00000 n ")},Ve=p.__private__.buildDocument=function(){var M;J=0,Q=0,X=[],V=[],ne=[],te=vr(),ue=vr(),ae(X),Kr.publish("buildDocument"),Gt(),We(),function(){Kr.publish("putAdditionalObjects");for(var Le=0;Le<ne.length;Le++){var it=ne[Le];re(it.objId,!0),I(it.content),I("endobj")}Kr.publish("postPutAdditionalObjects")}(),M=[],function(){for(var Le in lt)lt.hasOwnProperty(Le)&&(f===!1||f===!0&&h.hasOwnProperty(Le))&&st(lt[Le])}(),function(){var Le;for(Le in Tt)Tt.hasOwnProperty(Le)&&Dt(Tt[Le])}(),function(){for(var Le in Pr)Pr.hasOwnProperty(Le)&&zt(Pr[Le])}(),function(Le){var it;for(it in yt)yt.hasOwnProperty(it)&&(yt[it]instanceof qh?Wt(yt[it]):yt[it]instanceof tm&&xt(yt[it],Le))}(M),Kr.publish("putResources"),M.forEach(Vt),Vt({resourcesOid:ue,objectOid:Number.MAX_SAFE_INTEGER}),Kr.publish("postPutResources"),d!==null&&(Ue.oid=fr(),I("<<"),I("/Filter /Standard"),I("/V "+Ue.v),I("/R "+Ue.r),I("/U <"+Ue.toHexString(Ue.U)+">"),I("/O <"+Ue.toHexString(Ue.O)+">"),I("/P "+Ue.P),I(">>"),I("endobj")),kr(),Tr();var ce=Q;return ur(),Or(),I("startxref"),I(""+ce),I("%%EOF"),ae(oe[K]),X.join(`
`)},Rt=p.__private__.getBlob=function(M){return new Blob([me(M)],{type:"application/pdf"})},_t=p.output=p.__private__.output=(ir=function(M,ce){switch(typeof(ce=ce||{})=="string"?ce={filename:ce}:ce.filename=ce.filename||"generated.pdf",M){case void 0:return Ve();case"save":p.save(ce.filename);break;case"arraybuffer":return me(Ve());case"blob":return Rt(Ve());case"bloburi":case"bloburl":if(Qn.URL!==void 0&&typeof Qn.URL.createObjectURL=="function")return Qn.URL&&Qn.URL.createObjectURL(Rt(Ve()))||void 0;ia.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Le="",it=Ve();try{Le=tM(it)}catch{Le=tM(unescape(encodeURIComponent(it)))}return"data:application/pdf;filename="+ce.filename+";base64,"+Le;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Qn)==="[object Window]"){var At="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",lr=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ce.pdfObjectUrl&&(At=ce.pdfObjectUrl,lr="");var nr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+At+'"'+lr+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ce)+");<\/script></body></html>",yr=Qn.open();return yr!==null&&yr.document.write(nr),yr}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Qn)==="[object Window]"){var Wr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ce.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ce.filename+'" width="500px" height="400px" /></body></html>',Vr=Qn.open();if(Vr!==null){Vr.document.write(Wr);var dn=this;Vr.document.documentElement.querySelector("#pdfViewer").onload=function(){Vr.document.title=ce.filename,Vr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(dn.output("bloburl"))}}return Vr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Qn)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Pn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ce)+'"></iframe></body></html>',li=Qn.open();if(li!==null&&(li.document.write(Pn),li.document.title=ce.filename),li||typeof safari>"u")return li;break;case"datauri":case"dataurl":return Qn.document.location.href=this.output("datauristring",ce);default:return null}},ir.foo=function(){try{return ir.apply(this,arguments)}catch(Le){var M=Le.stack||"";~M.indexOf(" at ")&&(M=M.split(" at ")[1]);var ce="Error in function "+M.split(`
`)[0].split("<")[0]+": "+Le.message;if(!Qn.console)throw new Error(ce);Qn.console.error(ce,Le),Qn.alert&&alert(ce)}},ir.foo.bar=ir,ir.foo),Xt=function(M){return Array.isArray(Rn)===!0&&Rn.indexOf(M)>-1};switch(n){case"pt":he=1;break;case"mm":he=72/25.4;break;case"cm":he=72/2.54;break;case"in":he=72;break;case"px":he=Xt("px_scaling")==1?.75:96/72;break;case"pc":case"em":he=12;break;case"ex":he=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);he=n}var Ue=null;Y(),z();var Ct=p.__private__.getPageInfo=p.getPageInfo=function(M){if(isNaN(M)||M%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:$r[M].objId,pageNumber:M,pageContext:$r[M]}},et=p.__private__.getPageInfoByObjId=function(M){if(isNaN(M)||M%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ce in $r)if($r[ce].objId===M)break;return Ct(ce)},ut=p.__private__.getCurrentPageInfo=p.getCurrentPageInfo=function(){return{objId:$r[K].objId,pageNumber:K,pageContext:$r[K]}};p.addPage=function(){return Er.apply(this,arguments),this},p.setPage=function(){return zr.apply(this,arguments),ae.call(this,oe[K]),this},p.insertPage=function(M){return this.addPage(),this.movePage(K,M),this},p.movePage=function(M,ce){var Le,it;if(M>ce){Le=oe[M],it=$r[M];for(var At=M;At>ce;At--)oe[At]=oe[At-1],$r[At]=$r[At-1];oe[ce]=Le,$r[ce]=it,this.setPage(ce)}else if(M<ce){Le=oe[M],it=$r[M];for(var lr=M;lr<ce;lr++)oe[lr]=oe[lr+1],$r[lr]=$r[lr+1];oe[ce]=Le,$r[ce]=it,this.setPage(ce)}return this},p.deletePage=function(){return qt.apply(this,arguments),this},p.__private__.text=p.text=function(M,ce,Le,it,At){var lr,nr,yr,Wr,Vr,dn,Pn,li,fe,xe=(it=it||{}).scope||this;if(typeof M=="number"&&typeof ce=="number"&&(typeof Le=="string"||Array.isArray(Le))){var Ke=Le;Le=ce,ce=M,M=Ke}if(arguments[3]instanceof je==0?(yr=arguments[4],Wr=arguments[5],Hi(Pn=arguments[3])==="object"&&Pn!==null||(typeof yr=="string"&&(Wr=yr,yr=null),typeof Pn=="string"&&(Wr=Pn,Pn=null),typeof Pn=="number"&&(yr=Pn,Pn=null),it={flags:Pn,angle:yr,align:Wr})):(P("The transform parameter of text() with a Matrix value"),fe=At),isNaN(ce)||isNaN(Le)||M==null)throw new Error("Invalid arguments passed to jsPDF.text");if(M.length===0)return xe;var Fe,gt="",dr=typeof it.lineHeightFactor=="number"?it.lineHeightFactor:Ie,Ft=xe.internal.scaleFactor;function jr(Bi){return Bi=Bi.split("	").join(Array(it.TabLen||9).join(" ")),Lr(Bi,Pn)}function Ar(Bi){for(var ta,Xa=Bi.concat(),_s=[],md=Xa.length;md--;)typeof(ta=Xa.shift())=="string"?_s.push(ta):Array.isArray(Bi)&&(ta.length===1||ta[1]===void 0&&ta[2]===void 0)?_s.push(ta[0]):_s.push([ta[0],ta[1],ta[2]]);return _s}function qr(Bi,ta){var Xa;if(typeof Bi=="string")Xa=ta(Bi)[0];else if(Array.isArray(Bi)){for(var _s,md,jg=Bi.concat(),dp=[],$y=jg.length;$y--;)typeof(_s=jg.shift())=="string"?dp.push(ta(_s)[0]):Array.isArray(_s)&&typeof _s[0]=="string"&&(md=ta(_s[0],_s[1],_s[2]),dp.push([md[0],md[1],md[2]]));Xa=dp}return Xa}var Qr=!1,Ur=!0;if(typeof M=="string")Qr=!0;else if(Array.isArray(M)){var Xr=M.concat();nr=[];for(var br,Mr=Xr.length;Mr--;)(typeof(br=Xr.shift())!="string"||Array.isArray(br)&&typeof br[0]!="string")&&(Ur=!1);Qr=Ur}if(Qr===!1)throw new Error('Type of text must be string or Array. "'+M+'" is not recognized.');typeof M=="string"&&(M=M.match(/[\r?\n]/)?M.split(/\r\n|\r|\n/g):[M]);var un=Ae/xe.internal.scaleFactor,kn=un*(dr-1);switch(it.baseline){case"bottom":Le-=kn;break;case"top":Le+=un-kn;break;case"hanging":Le+=un-2*kn;break;case"middle":Le+=un/2-kn}if((dn=it.maxWidth||0)>0&&(typeof M=="string"?M=xe.splitTextToSize(M,dn):Object.prototype.toString.call(M)==="[object Array]"&&(M=M.reduce(function(Bi,ta){return Bi.concat(xe.splitTextToSize(ta,dn))},[]))),lr={text:M,x:ce,y:Le,options:it,mutex:{pdfEscape:Lr,activeFontKey:Se,fonts:lt,activeFontSize:Ae}},Kr.publish("preProcessText",lr),M=lr.text,yr=(it=lr.options).angle,fe instanceof je==0&&yr&&typeof yr=="number"){yr*=Math.PI/180,it.rotationDirection===0&&(yr=-yr),S===w&&(yr=-yr);var vn=Math.cos(yr),Cn=Math.sin(yr);fe=new je(vn,Cn,-Cn,vn,0,0)}else yr&&yr instanceof je&&(fe=yr);S!==w||fe||(fe=pt),(Vr=it.charSpace||sn)!==void 0&&(gt+=L(B(Vr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(li=it.horizontalScale)!==void 0&&(gt+=L(100*li)+` Tz
`),it.lang;var In=-1,Fn=it.renderingMode!==void 0?it.renderingMode:it.stroke,ci=xe.internal.getCurrentPageInfo().pageContext;switch(Fn){case 0:case!1:case"fill":In=0;break;case 1:case!0:case"stroke":In=1;break;case 2:case"fillThenStroke":In=2;break;case 3:case"invisible":In=3;break;case 4:case"fillAndAddForClipping":In=4;break;case 5:case"strokeAndAddPathForClipping":In=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":In=6;break;case 7:case"addToPathForClipping":In=7}var xi=ci.usedRenderingMode!==void 0?ci.usedRenderingMode:-1;In!==-1?gt+=In+` Tr
`:xi!==-1&&(gt+=`0 Tr
`),In!==-1&&(ci.usedRenderingMode=In),Wr=it.align||"left";var Fi,Ho=Ae*dr,Vo=xe.internal.pageSize.getWidth(),Rl=lt[Se];Vr=it.charSpace||sn,dn=it.maxWidth||0,Pn=Object.assign({autoencode:!0,noBOM:!0},it.flags);var Zs=[],Fl=function(Bi){return xe.getStringUnitWidth(Bi,{font:Rl,charSpace:Vr,fontSize:Ae,doKerning:!1})*Ae/Ft};if(Object.prototype.toString.call(M)==="[object Array]"){var Ya;nr=Ar(M),Wr!=="left"&&(Fi=nr.map(Fl));var Zi,Di=0;if(Wr==="right"){ce-=Fi[0],M=[],Mr=nr.length;for(var ba=0;ba<Mr;ba++)ba===0?(Zi=$t(ce),Ya=qe(Le)):(Zi=B(Di-Fi[ba]),Ya=-Ho),M.push([nr[ba],Zi,Ya]),Di=Fi[ba]}else if(Wr==="center"){ce-=Fi[0]/2,M=[],Mr=nr.length;for(var cs=0;cs<Mr;cs++)cs===0?(Zi=$t(ce),Ya=qe(Le)):(Zi=B((Di-Fi[cs])/2),Ya=-Ho),M.push([nr[cs],Zi,Ya]),Di=Fi[cs]}else if(Wr==="left"){M=[],Mr=nr.length;for(var Yc=0;Yc<Mr;Yc++)M.push(nr[Yc])}else if(Wr==="justify"&&Rl.encoding==="Identity-H"){M=[],Mr=nr.length,dn=dn!==0?dn:Vo;for(var Xc=0,qn=0;qn<Mr;qn++)if(Ya=qn===0?qe(Le):-Ho,Zi=qn===0?$t(ce):Xc,qn<Mr-1){var _i=B((dn-Fi[qn])/(nr[qn].split(" ").length-1)),ea=nr[qn].split(" ");M.push([ea[0]+" ",Zi,Ya]),Xc=0;for(var bo=1;bo<ea.length;bo++){var Qc=(Fl(ea[bo-1]+" "+ea[bo])-Fl(ea[bo]))*Ft+_i;bo==ea.length-1?M.push([ea[bo],Qc,0]):M.push([ea[bo]+" ",Qc,0]),Xc-=Qc}}else M.push([nr[qn],Zi,Ya]);M.push(["",Xc,0])}else{if(Wr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(M=[],Mr=nr.length,dn=dn!==0?dn:Vo,qn=0;qn<Mr;qn++){Ya=qn===0?qe(Le):-Ho,Zi=qn===0?$t(ce):0;var pc=nr[qn].split(" ").length-1,Jc=pc>0?(dn-Fi[qn])/pc:0;qn<Mr-1?Zs.push(L(B(Jc))):Zs.push(0),M.push([nr[qn],Zi,Ya])}}}(typeof it.R2L=="boolean"?it.R2L:ze)===!0&&(M=qr(M,function(Bi,ta,Xa){return[Bi.split("").reverse().join(""),ta,Xa]})),lr={text:M,x:ce,y:Le,options:it,mutex:{pdfEscape:Lr,activeFontKey:Se,fonts:lt,activeFontSize:Ae}},Kr.publish("postProcessText",lr),M=lr.text,Fe=lr.mutex.isHex||!1;var mc=lt[Se].encoding;mc!=="WinAnsiEncoding"&&mc!=="StandardEncoding"||(M=qr(M,function(Bi,ta,Xa){return[jr(Bi),ta,Xa]})),nr=Ar(M),M=[];for(var vo,fl,hl,gc=Array.isArray(nr[0])?1:0,pl="",Cu=function(Bi,ta,Xa){var _s="";return Xa instanceof je?(Xa=typeof it.angle=="number"?Mt(Xa,new je(1,0,0,1,Bi,ta)):Mt(new je(1,0,0,1,Bi,ta),Xa),S===w&&(Xa=Mt(new je(1,0,0,-1,0,0),Xa)),_s=Xa.join(" ")+` Tm
`):_s=L(Bi)+" "+L(ta)+` Td
`,_s},xc=0;xc<nr.length;xc++){switch(pl="",gc){case 1:hl=(Fe?"<":"(")+nr[xc][0]+(Fe?">":")"),vo=parseFloat(nr[xc][1]),fl=parseFloat(nr[xc][2]);break;case 0:hl=(Fe?"<":"(")+nr[xc]+(Fe?">":")"),vo=$t(ce),fl=qe(Le)}Zs!==void 0&&Zs[xc]!==void 0&&(pl=Zs[xc]+` Tw
`),xc===0?M.push(pl+Cu(vo,fl,fe)+hl):gc===0?M.push(pl+hl):gc===1&&M.push(pl+Cu(vo,fl,fe)+hl)}M=gc===0?M.join(` Tj
T* `):M.join(` Tj
`),M+=` Tj
`;var Eu=`BT
/`;return Eu+=Se+" "+Ae+` Tf
`,Eu+=L(Ae*dr)+` TL
`,Eu+=It+`
`,Eu+=gt,Eu+=M,I(Eu+="ET"),h[Se]=!0,xe};var Bt=p.__private__.clip=p.clip=function(M){return I(M==="evenodd"?"W*":"W"),this};p.clipEvenOdd=function(){return Bt("evenodd")},p.__private__.discardPath=p.discardPath=function(){return I("n"),this};var Kt=p.__private__.isValidStyle=function(M){var ce=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(M)!==-1&&(ce=!0),ce};p.__private__.setDefaultPathOperation=p.setDefaultPathOperation=function(M){return Kt(M)&&(u=M),this};var Jt=p.__private__.getStyle=p.getStyle=function(M){var ce=u;switch(M){case"D":case"S":ce="S";break;case"F":ce="f";break;case"FD":case"DF":ce="B";break;case"f":case"f*":case"B":case"B*":ce=M}return ce},ar=p.close=function(){return I("h"),this};p.stroke=function(){return I("S"),this},p.fill=function(M){return nt("f",M),this},p.fillEvenOdd=function(M){return nt("f*",M),this},p.fillStroke=function(M){return nt("B",M),this},p.fillStrokeEvenOdd=function(M){return nt("B*",M),this};var nt=function(M,ce){Hi(ce)==="object"?Ot(ce,M):I(M)},Ht=function(M){M===null||S===w&&M===void 0||(M=Jt(M),I(M))};function Pe(M,ce,Le,it,At){var lr=new tm(ce||this.boundingBox,Le||this.xStep,it||this.yStep,this.gState,At||this.matrix);lr.stream=this.stream;var nr=M+"$$"+this.cloneIndex+++"$$";return Ut(nr,lr),lr}var Ot=function(M,ce){var Le=Fr[M.key],it=yt[Le];if(it instanceof qh)I("q"),I(mt(ce)),it.gState&&p.setGState(it.gState),I(M.matrix.toString()+" cm"),I("/"+Le+" sh"),I("Q");else if(it instanceof tm){var At=new je(1,0,0,-1,0,Hn());M.matrix&&(At=At.multiply(M.matrix||pt),Le=Pe.call(it,M.key,M.boundingBox,M.xStep,M.yStep,At).id),I("q"),I("/Pattern cs"),I("/"+Le+" scn"),it.gState&&p.setGState(it.gState),I(ce),I("Q")}},mt=function(M){switch(M){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Nt=p.moveTo=function(M,ce){return I(L(B(M))+" "+L(q(ce))+" m"),this},er=p.lineTo=function(M,ce){return I(L(B(M))+" "+L(q(ce))+" l"),this},pr=p.curveTo=function(M,ce,Le,it,At,lr){return I([L(B(M)),L(q(ce)),L(B(Le)),L(q(it)),L(B(At)),L(q(lr)),"c"].join(" ")),this};p.__private__.line=p.line=function(M,ce,Le,it,At){if(isNaN(M)||isNaN(ce)||isNaN(Le)||isNaN(it)||!Kt(At))throw new Error("Invalid arguments passed to jsPDF.line");return S===v?this.lines([[Le-M,it-ce]],M,ce,[1,1],At||"S"):this.lines([[Le-M,it-ce]],M,ce,[1,1]).stroke()},p.__private__.lines=p.lines=function(M,ce,Le,it,At,lr){var nr,yr,Wr,Vr,dn,Pn,li,fe,xe,Ke,Fe,gt;if(typeof M=="number"&&(gt=Le,Le=ce,ce=M,M=gt),it=it||[1,1],lr=lr||!1,isNaN(ce)||isNaN(Le)||!Array.isArray(M)||!Array.isArray(it)||!Kt(At)||typeof lr!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Nt(ce,Le),nr=it[0],yr=it[1],Vr=M.length,Ke=ce,Fe=Le,Wr=0;Wr<Vr;Wr++)(dn=M[Wr]).length===2?(Ke=dn[0]*nr+Ke,Fe=dn[1]*yr+Fe,er(Ke,Fe)):(Pn=dn[0]*nr+Ke,li=dn[1]*yr+Fe,fe=dn[2]*nr+Ke,xe=dn[3]*yr+Fe,Ke=dn[4]*nr+Ke,Fe=dn[5]*yr+Fe,pr(Pn,li,fe,xe,Ke,Fe));return lr&&ar(),Ht(At),this},p.path=function(M){for(var ce=0;ce<M.length;ce++){var Le=M[ce],it=Le.c;switch(Le.op){case"m":Nt(it[0],it[1]);break;case"l":er(it[0],it[1]);break;case"c":pr.apply(this,it);break;case"h":ar()}}return this},p.__private__.rect=p.rect=function(M,ce,Le,it,At){if(isNaN(M)||isNaN(ce)||isNaN(Le)||isNaN(it)||!Kt(At))throw new Error("Invalid arguments passed to jsPDF.rect");return S===v&&(it=-it),I([L(B(M)),L(q(ce)),L(B(Le)),L(B(it)),"re"].join(" ")),Ht(At),this},p.__private__.triangle=p.triangle=function(M,ce,Le,it,At,lr,nr){if(isNaN(M)||isNaN(ce)||isNaN(Le)||isNaN(it)||isNaN(At)||isNaN(lr)||!Kt(nr))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Le-M,it-ce],[At-Le,lr-it],[M-At,ce-lr]],M,ce,[1,1],nr,!0),this},p.__private__.roundedRect=p.roundedRect=function(M,ce,Le,it,At,lr,nr){if(isNaN(M)||isNaN(ce)||isNaN(Le)||isNaN(it)||isNaN(At)||isNaN(lr)||!Kt(nr))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var yr=4/3*(Math.SQRT2-1);return At=Math.min(At,.5*Le),lr=Math.min(lr,.5*it),this.lines([[Le-2*At,0],[At*yr,0,At,lr-lr*yr,At,lr],[0,it-2*lr],[0,lr*yr,-At*yr,lr,-At,lr],[2*At-Le,0],[-At*yr,0,-At,-lr*yr,-At,-lr],[0,2*lr-it],[0,-lr*yr,At*yr,-lr,At,-lr]],M+At,ce,[1,1],nr,!0),this},p.__private__.ellipse=p.ellipse=function(M,ce,Le,it,At){if(isNaN(M)||isNaN(ce)||isNaN(Le)||isNaN(it)||!Kt(At))throw new Error("Invalid arguments passed to jsPDF.ellipse");var lr=4/3*(Math.SQRT2-1)*Le,nr=4/3*(Math.SQRT2-1)*it;return Nt(M+Le,ce),pr(M+Le,ce-nr,M+lr,ce-it,M,ce-it),pr(M-lr,ce-it,M-Le,ce-nr,M-Le,ce),pr(M-Le,ce+nr,M-lr,ce+it,M,ce+it),pr(M+lr,ce+it,M+Le,ce+nr,M+Le,ce),Ht(At),this},p.__private__.circle=p.circle=function(M,ce,Le,it){if(isNaN(M)||isNaN(ce)||isNaN(Le)||!Kt(it))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(M,ce,Le,Le,it)},p.setFont=function(M,ce,Le){return Le&&(ce=A(ce,Le)),Se=or(M,ce,{disableWarning:!1}),this};var we=p.__private__.getFont=p.getFont=function(){return lt[or.apply(p,arguments)]};p.__private__.getFontList=p.getFontList=function(){var M,ce,Le={};for(M in jt)if(jt.hasOwnProperty(M))for(ce in Le[M]=[],jt[M])jt[M].hasOwnProperty(ce)&&Le[M].push(ce);return Le},p.addFont=function(M,ce,Le,it,At){var lr=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&lr.indexOf(arguments[3])!==-1?At=arguments[3]:arguments[3]&&lr.indexOf(arguments[3])==-1&&(Le=A(Le,it)),sr.call(this,M,ce,Le,At=At||"Identity-H")};var Ie,Ze=e.lineWidth||.200025,bt=p.__private__.getLineWidth=p.getLineWidth=function(){return Ze},St=p.__private__.setLineWidth=p.setLineWidth=function(M){return Ze=M,I(L(B(M))+" w"),this};p.__private__.setLineDash=Un.API.setLineDash=Un.API.setLineDashPattern=function(M,ce){if(M=M||[],ce=ce||0,isNaN(ce)||!Array.isArray(M))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return M=M.map(function(Le){return L(B(Le))}).join(" "),ce=L(B(ce)),I("["+M+"] "+ce+" d"),this};var Sr=p.__private__.getLineHeight=p.getLineHeight=function(){return Ae*Ie};p.__private__.getLineHeight=p.getLineHeight=function(){return Ae*Ie};var Yr=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(M){return typeof(M=M||1.15)=="number"&&(Ie=M),this},ct=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return Ie};Yr(e.lineHeight);var $t=p.__private__.getHorizontalCoordinate=function(M){return B(M)},qe=p.__private__.getVerticalCoordinate=function(M){return S===w?M:$r[K].mediaBox.topRightY-$r[K].mediaBox.bottomLeftY-B(M)},Ye=p.__private__.getHorizontalCoordinateString=p.getHorizontalCoordinateString=function(M){return L($t(M))},ot=p.__private__.getVerticalCoordinateString=p.getVerticalCoordinateString=function(M){return L(qe(M))},$e=e.strokeColor||"0 G";p.__private__.getStrokeColor=p.getDrawColor=function(){return Ne($e)},p.__private__.setStrokeColor=p.setDrawColor=function(M,ce,Le,it){return $e=ke({ch1:M,ch2:ce,ch3:Le,ch4:it,pdfColorType:"draw",precision:2}),I($e),this};var kt=e.fillColor||"0 g";p.__private__.getFillColor=p.getFillColor=function(){return Ne(kt)},p.__private__.setFillColor=p.setFillColor=function(M,ce,Le,it){return kt=ke({ch1:M,ch2:ce,ch3:Le,ch4:it,pdfColorType:"fill",precision:2}),I(kt),this};var It=e.textColor||"0 g",Zt=p.__private__.getTextColor=p.getTextColor=function(){return Ne(It)};p.__private__.setTextColor=p.setTextColor=function(M,ce,Le,it){return It=ke({ch1:M,ch2:ce,ch3:Le,ch4:it,pdfColorType:"text",precision:3}),this};var sn=e.charSpace,mn=p.__private__.getCharSpace=p.getCharSpace=function(){return parseFloat(sn||0)};p.__private__.setCharSpace=p.setCharSpace=function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return sn=M,this};var hn=0;p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},p.__private__.setLineCap=p.setLineCap=function(M){var ce=p.CapJoinStyles[M];if(ce===void 0)throw new Error("Line cap style of '"+M+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return hn=ce,I(ce+" J"),this};var Tn=0;p.__private__.setLineJoin=p.setLineJoin=function(M){var ce=p.CapJoinStyles[M];if(ce===void 0)throw new Error("Line join style of '"+M+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Tn=ce,I(ce+" j"),this},p.__private__.setLineMiterLimit=p.__private__.setMiterLimit=p.setLineMiterLimit=p.setMiterLimit=function(M){if(M=M||0,isNaN(M))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return I(L(B(M))+" M"),this},p.GState=Y2,p.setGState=function(M){(M=typeof M=="string"?Tt[hr[M]]:Ir(null,M)).equals(rn)||(I("/"+M.id+" gs"),rn=M)};var Ir=function(M,ce){if(!M||!hr[M]){var Le=!1;for(var it in Tt)if(Tt.hasOwnProperty(it)&&Tt[it].equals(ce)){Le=!0;break}if(Le)ce=Tt[it];else{var At="GS"+(Object.keys(Tt).length+1).toString(10);Tt[At]=ce,ce.id=At}return M&&(hr[M]=ce.id),Kr.publish("addGState",ce),ce}};p.addGState=function(M,ce){return Ir(M,ce),this},p.saveGraphicsState=function(){return I("q"),wt.push({key:Se,size:Ae,color:It}),this},p.restoreGraphicsState=function(){I("Q");var M=wt.pop();return Se=M.key,Ae=M.size,It=M.color,rn=null,this},p.setCurrentTransformationMatrix=function(M){return I(M.toString()+" cm"),this},p.comment=function(M){return I("#"+M),this};var gn=function(M,ce){var Le=M||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Le},set:function(lr){isNaN(lr)||(Le=parseFloat(lr))}});var it=ce||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return it},set:function(lr){isNaN(lr)||(it=parseFloat(lr))}});var At="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return At},set:function(lr){At=lr.toString()}}),this},fn=function(M,ce,Le,it){gn.call(this,M,ce),this.type="rect";var At=Le||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return At},set:function(nr){isNaN(nr)||(At=parseFloat(nr))}});var lr=it||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return lr},set:function(nr){isNaN(nr)||(lr=parseFloat(nr))}}),this},ve=function(){this.page=en,this.currentPage=K,this.pages=oe.slice(0),this.pagesContext=$r.slice(0),this.x=ye,this.y=ht,this.matrix=Ge,this.width=dt(K),this.height=nn(K),this.outputDestination=W,this.id="",this.objectNumber=-1};ve.prototype.restore=function(){en=this.page,K=this.currentPage,$r=this.pagesContext,oe=this.pages,ye=this.x,ht=this.y,Ge=this.matrix,Rr(K,this.width),tn(K,this.height),W=this.outputDestination};var at=function(M,ce,Le,it,At){Me.push(new ve),en=K=0,oe=[],ye=M,ht=ce,Ge=At,Zr([Le,it])};for(var Re in p.beginFormObject=function(M,ce,Le,it,At){return at(M,ce,Le,it,At),this},p.endFormObject=function(M){return function(ce){if(Sn[ce])Me.pop().restore();else{var Le=new ve,it="Xo"+(Object.keys(Pr).length+1).toString(10);Le.id=it,Sn[ce]=it,Pr[it]=Le,Kr.publish("addFormObject",Le),Me.pop().restore()}}(M),this},p.doFormObject=function(M,ce){var Le=Pr[Sn[M]];return I("q"),I(ce.toString()+" cm"),I("/"+Le.id+" Do"),I("Q"),this},p.getFormObject=function(M){var ce=Pr[Sn[M]];return{x:ce.x,y:ce.y,width:ce.width,height:ce.height,matrix:ce.matrix}},p.save=function(M,ce){return M=M||"generated.pdf",(ce=ce||{}).returnPromise=ce.returnPromise||!1,ce.returnPromise===!1?(Dh(Rt(Ve()),M),typeof Dh.unload=="function"&&Qn.setTimeout&&setTimeout(Dh.unload,911),this):new Promise(function(Le,it){try{var At=Dh(Rt(Ve()),M);typeof Dh.unload=="function"&&Qn.setTimeout&&setTimeout(Dh.unload,911),Le(At)}catch(lr){it(lr.message)}})},Un.API)Un.API.hasOwnProperty(Re)&&(Re==="events"&&Un.API.events.length?function(M,ce){var Le,it,At;for(At=ce.length-1;At!==-1;At--)Le=ce[At][0],it=ce[At][1],M.subscribe.apply(M,[Le].concat(typeof it=="function"?[it]:it))}(Kr,Un.API.events):p[Re]=Un.API[Re]);function dt(M){return $r[M].mediaBox.topRightX-$r[M].mediaBox.bottomLeftX}function Rr(M,ce){$r[M].mediaBox.topRightX=ce+$r[M].mediaBox.bottomLeftX}function nn(M){return $r[M].mediaBox.topRightY-$r[M].mediaBox.bottomLeftY}function tn(M,ce){$r[M].mediaBox.topRightY=ce+$r[M].mediaBox.bottomLeftY}var _n=p.getPageWidth=function(M){return dt(M=M||K)/he},zn=p.setPageWidth=function(M,ce){Rr(M,ce*he)},Hn=p.getPageHeight=function(M){return nn(M=M||K)/he},ri=p.setPageHeight=function(M,ce){tn(M,ce*he)};return p.internal={pdfEscape:Lr,getStyle:Jt,getFont:we,getFontSize:Ee,getCharSpace:mn,getTextColor:Zt,getLineHeight:Sr,getLineHeightFactor:ct,getLineWidth:bt,write:Z,getHorizontalCoordinate:$t,getVerticalCoordinate:qe,getCoordinateString:Ye,getVerticalCoordinateString:ot,collections:{},newObject:fr,newAdditionalObject:le,newObjectDeferred:vr,newObjectDeferredBegin:re,getFilters:vt,putStream:rt,events:Kr,scaleFactor:he,pageSize:{getWidth:function(){return _n(K)},setWidth:function(M){zn(K,M)},getHeight:function(){return Hn(K)},setHeight:function(M){ri(K,M)}},encryptionOptions:d,encryption:Ue,getEncryptor:function(M){return d!==null?Ue.encryptor(M,0):function(ce){return ce}},output:_t,getNumberOfPages:bn,get pages(){return oe},out:I,f2:E,f3:T,getPageInfo:Ct,getPageInfoByObjId:et,getCurrentPageInfo:ut,getPDFVersion:g,Point:gn,Rectangle:fn,Matrix:je,hasHotfix:Xt},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return _n(K)},set:function(M){zn(K,M)},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return Hn(K)},set:function(M){ri(K,M)},enumerable:!0,configurable:!0}),(function(M){for(var ce=0,Le=Te.length;ce<Le;ce++){var it=sr.call(this,M[ce][0],M[ce][1],M[ce][2],Te[ce][3],!0);f===!1&&(h[it]=!0);var At=M[ce][0].split("-");gr({id:it,fontName:At[0],fontStyle:At[1]||""})}Kr.publish("addFonts",{fonts:lt,dictionary:jt})}).call(p,Te),Se="F1",Er(i,r),Kr.publish("initialized"),p}Fp.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},Fp.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Fp.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},Fp.prototype.processOwnerPassword=function(e,t){return nA(rA(t).substr(0,5),e)},Fp.prototype.encryptor=function(e,t){var r=rA(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return nA(r,n)}},Y2.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||Hi(e)!==Hi(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},Un.API={events:[]},Un.version="4.1.0";var $a=Un.API,bC=1,np=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},yp=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},X2=function(e){return e.toString().replace(/#/g,"#23").replace(/[\s\n\r()<>[\]{}\/%]/g,function(t){var r=t.charCodeAt(0).toString(16).toUpperCase();return"#"+(r.length===1?"0"+r:r)})},Zn=function(e){return e.toFixed(2)},Cf=function(e){return e.toFixed(5)};$a.__acroform__={};var Ml=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},aM=function(e){return e*bC},zu=function(e){var t=new Pz,r=On.internal.getHeight(e)||0,n=On.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Zn(n)),Number(Zn(r))],t},bge=$a.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},vge=$a.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},wge=$a.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},rs=$a.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return wge(e,t-1)},ns=$a.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return bge(e,t-1)},is=$a.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return vge(e,t-1)},Sge=$a.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,i=e[0],s=e[1],o=e[2],l=e[3],c={};return c.lowerLeft_X=r(i)||0,c.lowerLeft_Y=n(s+l)||0,c.upperRight_X=r(i+o)||0,c.upperRight_Y=n(s)||0,[Number(Zn(c.lowerLeft_X)),Number(Zn(c.lowerLeft_Y)),Number(Zn(c.upperRight_X)),Number(Zn(c.upperRight_Y))]},_ge=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=iA(e,r),i=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+i+" "+Zn(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=zu(e);return s.scope=e.scope,s.stream=t.join(`
`),s}},iA=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},i=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");i=e.multiline?i.map(function(E){return E.split(`
`)}):i.map(function(E){return[E]});var s=r,o=On.internal.getHeight(e)||0;o=o<0?-o:o;var l=On.internal.getWidth(e)||0;l=l<0?-l:l;var c=function(E,T,B){if(E+1<i.length){var q=T+" "+i[E+1][0];return Ib(q,e,B).width<=l-4}return!1};s++;e:for(;s>0;){t="",s--;var u,d,f=Ib("3",e,s).height,h=e.multiline?o-s:(o-f)/2,p=h+=2,m=0,g=0,y=0;if(s<=0){t=`(...) Tj
`,t+="% Width of Text: "+Ib(t,e,s=12).width+", FieldWidth:"+l+`
`;break}for(var b="",v=0,w=0;w<i.length;w++)if(i.hasOwnProperty(w)){var S=!1;if(i[w].length!==1&&y!==i[w].length-1){if((f+2)*(v+2)+2>o)continue e;b+=i[w][y],S=!0,g=w,w--}else{b=(b+=i[w][y]+" ").substr(b.length-1)==" "?b.substr(0,b.length-1):b;var k=parseInt(w),j=c(k,b,s),A=w>=i.length-1;if(j&&!A){b+=" ",y=0;continue}if(j||A){if(A)g=k;else if(e.multiline&&(f+2)*(v+2)+2>o)continue e}else{if(!e.multiline||(f+2)*(v+2)+2>o)continue e;g=k}}for(var L="",P=m;P<=g;P++){var F=i[P];if(e.multiline){if(P===g){L+=F[y]+" ",y=(y+1)%F.length;continue}if(P===m){L+=F[F.length-1]+" ";continue}}L+=F[0]+" "}switch(L=L.substr(L.length-1)==" "?L.substr(0,L.length-1):L,d=Ib(L,e,s).width,e.textAlign){case"right":u=l-d-2;break;case"center":u=(l-d)/2;break;default:u=2}t+=Zn(u)+" "+Zn(p)+` Td
`,t+="("+np(L)+`) Tj
`,t+=-Zn(u)+` 0 Td
`,p=-(s+2),d=0,m=S?g:g+1,v++,b=""}break}return n.text=t,n.fontSize=s,n},Ib=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),i=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},kge={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},jge=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},Age=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(ju.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(kge)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");bC=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new Oz,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var s=n[i];s.objId=void 0,s.hasAnnotation&&jge(s,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,i){var s=!n;for(var o in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],u=l.Rect;if(l.Rect&&(l.Rect=Sge(l.Rect,i)),i.internal.newObjectDeferredBegin(l.objId,!0),l.DA=On.createDefaultAppearanceStream(l),Hi(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var d=_ge(l);c.push({key:"AP",value:"<</N "+d+">>"}),i.internal.acroformPlugin.xForms.push(d)}if(l.appearanceStreamContent){var f="";for(var h in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(h)){var p=l.appearanceStreamContent[h];if(f+="/"+h+" ",f+="<<",Object.keys(p).length>=1||Array.isArray(p)){for(var o in p)if(p.hasOwnProperty(o)){var m=p[o];typeof m=="function"&&(m=m.call(i,l)),f+="/"+o+" "+m+" ",i.internal.acroformPlugin.xForms.indexOf(m)>=0||i.internal.acroformPlugin.xForms.push(m)}}else typeof(m=p)=="function"&&(m=m.call(i,l)),f+="/"+o+" "+m,i.internal.acroformPlugin.xForms.indexOf(m)>=0||i.internal.acroformPlugin.xForms.push(m);f+=">>"}c.push({key:"AP",value:`<<
`+f+">>"})}i.internal.putStream({additionalKeyValues:c,objectId:l.objId}),i.internal.out("endobj")}s&&function(g,y){for(var b in g)if(g.hasOwnProperty(b)){var v=b,w=g[b];y.internal.newObjectDeferredBegin(w.objId,!0),Hi(w)==="object"&&typeof w.putStream=="function"&&w.putStream(),delete g[v]}}(i.internal.acroformPlugin.xForms,i)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},Tz=$a.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(o){return o};if(Array.isArray(e)){for(var i="[",s=0;s<e.length;s++)switch(s!==0&&(i+=" "),Hi(e[s])){case"boolean":case"number":case"object":i+=e[s].toString();break;case"string":e[s].substr(0,1)==="/"?i+="/"+X2(e[s].substr(1)):(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),i+="("+np(n(e[s].toString()))+")")}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Ak=function(e,t,r){var n=function(i){return i};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+np(n(e))+")"},Qu=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Qu.prototype.toString=function(){return this.objId+" 0 R"},Qu.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Qu.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],i=this[n];i&&(Array.isArray(i)?e.push({key:n,value:Tz(i,this.objId,this.scope)}):i instanceof Qu?(i.scope=this.scope,e.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&e.push({key:n,value:i}))}return e};var Pz=function(){Qu.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};Ml(Pz,Qu);var Oz=function(){Qu.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+np(r(e))+")"}},set:function(r){e=r}})};Ml(Oz,Qu);var ju=function e(){Qu.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute F supplied.');t=b}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!rs(t,3)},set:function(b){b?this.F=ns(t,3):this.F=is(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute Ff supplied.');r=b}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(b){n=b!==void 0?b:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(b){n[0]=b}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(b){n[1]=b}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(b){n[2]=b}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(b){n[3]=b}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(b){switch(b){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=b;break;default:throw new Error('Invalid value "'+b+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof Q2)return;s="FieldObject"+e.FieldNum++}var b=function(v){return v};return this.scope&&(b=this.scope.internal.getEncryptor(this.objId)),"("+np(b(s))+")"},set:function(b){s=b.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(b){s=b}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(b){o=b}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(b){l=b}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(b){c=b}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/bC:u},set:function(b){u=b}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(b){d=b}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof Q2||this instanceof c0))return Ak(f,this.objId,this.scope)},set:function(b){b=b.toString(),f=b}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof Hs==0?Ak(h,this.objId,this.scope):h},set:function(b){b=b.toString(),h=this instanceof Hs==0?b.substr(0,1)==="("?yp(b.substr(1,b.length-2)):yp(b):b}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Hs==1?yp(h.substr(1,h.length-1)):h},set:function(b){b=b.toString(),h=this instanceof Hs==1?"/"+X2(b):b}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(b){this.V=b}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Hs==0?Ak(p,this.objId,this.scope):p},set:function(b){b=b.toString(),p=this instanceof Hs==0?b.substr(0,1)==="("?yp(b.substr(1,b.length-2)):yp(b):b}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Hs==1?yp(p.substr(1,p.length-1)):p},set:function(b){b=b.toString(),p=this instanceof Hs==1?"/"+X2(b):b}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var m,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(b){b=!!b,g=b}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(m)return m},set:function(b){m=b}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,1)},set:function(b){b?this.Ff=ns(this.Ff,1):this.Ff=is(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,2)},set:function(b){b?this.Ff=ns(this.Ff,2):this.Ff=is(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,3)},set:function(b){b?this.Ff=ns(this.Ff,3):this.Ff=is(this.Ff,3)}});var y=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(y!==null)return y},set:function(b){if([0,1,2].indexOf(b)===-1)throw new Error('Invalid value "'+b+'" for attribute Q supplied.');y=b}}),Object.defineProperty(this,"textAlign",{get:function(){var b;switch(y){case 0:default:b="left";break;case 1:b="center";break;case 2:b="right"}return b},configurable:!0,enumerable:!0,set:function(b){switch(b){case"right":case 2:y=2;break;case"center":case 1:y=1;break;default:y=0}}})};Ml(ju,Qu);var ym=function(){ju.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Tz(t,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=function(s,o,l){l||(l=1);for(var c,u=[];c=o.exec(s);)u.push(c[l]);return u}(n,/\((.*?)\)/g)),t=i}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,18)},set:function(r){r?this.Ff=ns(this.Ff,18):this.Ff=is(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=ns(this.Ff,19):this.Ff=is(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,20)},set:function(r){r?(this.Ff=ns(this.Ff,20),t.sort()):this.Ff=is(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,22)},set:function(r){r?this.Ff=ns(this.Ff,22):this.Ff=is(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,23)},set:function(r){r?this.Ff=ns(this.Ff,23):this.Ff=is(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,27)},set:function(r){r?this.Ff=ns(this.Ff,27):this.Ff=is(this.Ff,27)}}),this.hasAppearanceStream=!1};Ml(ym,ju);var bm=function(){ym.call(this),this.fontName="helvetica",this.combo=!1};Ml(bm,ym);var vm=function(){bm.call(this),this.combo=!0};Ml(vm,bm);var qv=function(){vm.call(this),this.edit=!0};Ml(qv,vm);var Hs=function(){ju.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,15)},set:function(r){r?this.Ff=ns(this.Ff,15):this.Ff=is(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,16)},set:function(r){r?this.Ff=ns(this.Ff,16):this.Ff=is(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,17)},set:function(r){r?this.Ff=ns(this.Ff,17):this.Ff=is(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,26)},set:function(r){r?this.Ff=ns(this.Ff,26):this.Ff=is(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,i=[];for(n in i.push("<<"),t)i.push("/"+n+" ("+np(r(t[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){Hi(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+X2(r)}})};Ml(Hs,ju);var Hv=function(){Hs.call(this),this.pushButton=!0};Ml(Hv,Hs);var wm=function(){Hs.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Ml(wm,Hs);var Q2=function(){var e,t;ju.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(i){e=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(i){t=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(l){return l};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),n)o.push("/"+s+" ("+np(i(n[s]))+")");return o.push(">>"),o.join(`
`)},set:function(i){Hi(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=On.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ml(Q2,ju),wm.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},wm.prototype.createOption=function(e){var t=new Q2;return t.Parent=this,t.optionName=e,this.Kids.push(t),Nge.call(this.scope,t),t};var Vv=function(){Hs.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=On.CheckBox.createAppearanceStream()};Ml(Vv,Hs);var c0=function(){ju.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,13)},set:function(t){t?this.Ff=ns(this.Ff,13):this.Ff=is(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,21)},set:function(t){t?this.Ff=ns(this.Ff,21):this.Ff=is(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,23)},set:function(t){t?this.Ff=ns(this.Ff,23):this.Ff=is(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,24)},set:function(t){t?this.Ff=ns(this.Ff,24):this.Ff=is(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,25)},set:function(t){t?this.Ff=ns(this.Ff,25):this.Ff=is(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,26)},set:function(t){t?this.Ff=ns(this.Ff,26):this.Ff=is(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ml(c0,ju);var Gv=function(){c0.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,14)},set:function(e){e?this.Ff=ns(this.Ff,14):this.Ff=is(this.Ff,14)}}),this.password=!0};Ml(Gv,c0);var On={CheckBox:{createAppearanceStream:function(){return{N:{On:On.CheckBox.YesNormal},D:{On:On.CheckBox.YesPushDown,Off:On.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=zu(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,i=e.scope.__private__.encodeColorString(e.color),s=iA(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Zn(On.internal.getWidth(e))+" "+Zn(On.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Zn(s.fontSize)+" Tf "+i),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=zu(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),i=[],s=On.internal.getHeight(e),o=On.internal.getWidth(e),l=iA(e,e.caption);return i.push("1 g"),i.push("0 0 "+Zn(o)+" "+Zn(s)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+Zn(o-1)+" "+Zn(s-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+Zn(l.fontSize)+" Tf "+n),i.push(l.text),i.push("ET"),i.push("Q"),t.stream=i.join(`
`),t},OffPushDown:function(e){var t=zu(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Zn(On.internal.getWidth(e))+" "+Zn(On.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:On.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=On.RadioButton.Circle.YesNormal,t.D[e]=On.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=zu(e);t.scope=e.scope;var r=[],n=On.internal.getWidth(e)<=On.internal.getHeight(e)?On.internal.getWidth(e)/4:On.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=On.internal.Bezier_C,s=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Cf(On.internal.getWidth(e)/2)+" "+Cf(On.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=zu(e);t.scope=e.scope;var r=[],n=On.internal.getWidth(e)<=On.internal.getHeight(e)?On.internal.getWidth(e)/4:On.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),s=Number((i*On.internal.Bezier_C).toFixed(5)),o=Number((n*On.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Cf(On.internal.getWidth(e)/2)+" "+Cf(On.internal.getHeight(e)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),r.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),r.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),r.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Cf(On.internal.getWidth(e)/2)+" "+Cf(On.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=zu(e);t.scope=e.scope;var r=[],n=On.internal.getWidth(e)<=On.internal.getHeight(e)?On.internal.getWidth(e)/4:On.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),s=Number((i*On.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Cf(On.internal.getWidth(e)/2)+" "+Cf(On.internal.getHeight(e)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),r.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),r.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),r.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:On.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=On.RadioButton.Cross.YesNormal,t.D[e]=On.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=zu(e);t.scope=e.scope;var r=[],n=On.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Zn(On.internal.getWidth(e)-2)+" "+Zn(On.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Zn(n.x1.x)+" "+Zn(n.x1.y)+" m"),r.push(Zn(n.x2.x)+" "+Zn(n.x2.y)+" l"),r.push(Zn(n.x4.x)+" "+Zn(n.x4.y)+" m"),r.push(Zn(n.x3.x)+" "+Zn(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=zu(e);t.scope=e.scope;var r=On.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+Zn(On.internal.getWidth(e))+" "+Zn(On.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Zn(On.internal.getWidth(e)-2)+" "+Zn(On.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Zn(r.x1.x)+" "+Zn(r.x1.y)+" m"),n.push(Zn(r.x2.x)+" "+Zn(r.x2.y)+" l"),n.push(Zn(r.x4.x)+" "+Zn(r.x4.y)+" m"),n.push(Zn(r.x3.x)+" "+Zn(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=zu(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Zn(On.internal.getWidth(e))+" "+Zn(On.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};On.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=On.internal.getWidth(e),r=On.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},On.internal.getWidth=function(e){var t=0;return Hi(e)==="object"&&(t=aM(e.Rect[2])),t},On.internal.getHeight=function(e){var t=0;return Hi(e)==="object"&&(t=aM(e.Rect[3])),t};var Nge=$a.addField=function(e){if(Age(this,e),!(e instanceof ju))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};$a.AcroFormChoiceField=ym,$a.AcroFormListBox=bm,$a.AcroFormComboBox=vm,$a.AcroFormEditBox=qv,$a.AcroFormButton=Hs,$a.AcroFormPushButton=Hv,$a.AcroFormRadioButton=wm,$a.AcroFormCheckBox=Vv,$a.AcroFormTextField=c0,$a.AcroFormPasswordField=Gv,$a.AcroFormAppearance=On,$a.AcroForm={ChoiceField:ym,ListBox:bm,ComboBox:vm,EditBox:qv,Button:Hs,PushButton:Hv,RadioButton:wm,CheckBox:Vv,TextField:c0,PasswordField:Gv,Appearance:On},Un.AcroForm={ChoiceField:ym,ListBox:bm,ComboBox:vm,EditBox:qv,Button:Hs,PushButton:Hv,RadioButton:wm,CheckBox:Vv,TextField:c0,PasswordField:Gv,Appearance:On};Un.AcroForm;function Mz(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=e.__addimage__.getImageFileTypeByImageData=function(E,T){var B,q,U,se,de,z=r;if((T=T||r)==="RGBA"||E.data!==void 0&&E.data instanceof Uint8ClampedArray&&"height"in E&&"width"in E)return"RGBA";if(j(E))for(de in n)for(U=n[de],B=0;B<U.length;B+=1){for(se=!0,q=0;q<U[B].length;q+=1)if(U[B][q]!==void 0&&U[B][q]!==E[q]){se=!1;break}if(se===!0){z=de;break}}else for(de in n)for(U=n[de],B=0;B<U.length;B+=1){for(se=!0,q=0;q<U[B].length;q+=1)if(U[B][q]!==void 0&&U[B][q]!==E.charCodeAt(q)){se=!1;break}if(se===!0){z=de;break}}return z===r&&T!==r&&(z=T),z},s=function E(T){for(var B=this.internal.write,q=this.internal.putStream,U=(0,this.internal.getFilters)();U.indexOf("FlateEncode")!==-1;)U.splice(U.indexOf("FlateEncode"),1);T.objectId=this.internal.newObject();var se=[];if(se.push({key:"Type",value:"/XObject"}),se.push({key:"Subtype",value:"/Image"}),se.push({key:"Width",value:T.width}),se.push({key:"Height",value:T.height}),T.colorSpace===b.INDEXED?se.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(T.palette.length/3-1)+" "+("sMask"in T&&T.sMask!==void 0?T.objectId+2:T.objectId+1)+" 0 R]"}):(se.push({key:"ColorSpace",value:"/"+T.colorSpace}),T.colorSpace===b.DEVICE_CMYK&&se.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),se.push({key:"BitsPerComponent",value:T.bitsPerComponent}),"decodeParameters"in T&&T.decodeParameters!==void 0&&se.push({key:"DecodeParms",value:"<<"+T.decodeParameters+">>"}),"transparency"in T&&Array.isArray(T.transparency)&&T.transparency.length>0){for(var de="",z=0,G=T.transparency.length;z<G;z++)de+=T.transparency[z]+" "+T.transparency[z]+" ";se.push({key:"Mask",value:"["+de+"]"})}T.sMask!==void 0&&se.push({key:"SMask",value:T.objectId+1+" 0 R"});var ie=T.filter!==void 0?["/"+T.filter]:void 0;if(q({data:T.data,additionalKeyValues:se,alreadyAppliedFilters:ie,objectId:T.objectId}),B("endobj"),"sMask"in T&&T.sMask!==void 0){var Y,C=(Y=T.sMaskBitsPerComponent)!==null&&Y!==void 0?Y:T.bitsPerComponent,K={width:T.width,height:T.height,colorSpace:"DeviceGray",bitsPerComponent:C,data:T.sMask};"filter"in T&&(K.decodeParameters="/Predictor ".concat(T.predictor," /Colors 1 /BitsPerComponent ").concat(C," /Columns ").concat(T.width),K.filter=T.filter),E.call(this,K)}if(T.colorSpace===b.INDEXED){var H=this.internal.newObject();q({data:L(new Uint8Array(T.palette)),objectId:H}),B("endobj")}},o=function(){var E=this.internal.collections[t+"images"];for(var T in E)s.call(this,E[T])},l=function(){var E,T=this.internal.collections[t+"images"],B=this.internal.write;for(var q in T)B("/I"+(E=T[q]).index,E.objectId,"0","R")},c=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},u=function(){var E=this.internal.collections[t+"images"];return c.call(this),E},d=function(){return Object.keys(this.internal.collections[t+"images"]).length},f=function(E){return typeof e["process"+E.toUpperCase()]=="function"},h=function(E){return Hi(E)==="object"&&E.nodeType===1},p=function(E,T){if(E.nodeName==="IMG"&&E.hasAttribute("src")){var B=""+E.getAttribute("src");if(B.indexOf("data:image/")===0)return Wv(unescape(B).split("base64,").pop());var q=e.loadFile(B,!0);if(q!==void 0)return q}if(E.nodeName==="CANVAS"){if(E.width===0||E.height===0)throw new Error("Given canvas must have data. Canvas width: "+E.width+", height: "+E.height);var U;switch(T){case"PNG":U="image/png";break;case"WEBP":U="image/webp";break;default:U="image/jpeg"}return Wv(E.toDataURL(U,1).split("base64,").pop())}},m=function(E){var T=this.internal.collections[t+"images"];if(T){for(var B in T)if(E===T[B].alias)return T[B]}},g=function(E,T,B){return E||T||(E=-96,T=-96),E<0&&(E=-1*B.width*72/E/this.internal.scaleFactor),T<0&&(T=-1*B.height*72/T/this.internal.scaleFactor),E===0&&(E=T*B.width/B.height),T===0&&(T=E*B.height/B.width),[E,T]},y=function(E,T,B,q,U,se){var de=g.call(this,B,q,U),z=this.internal.getCoordinateString,G=this.internal.getVerticalCoordinateString,ie=u.call(this);if(B=de[0],q=de[1],ie[U.index]=U,se){se*=Math.PI/180;var Y=Math.cos(se),C=Math.sin(se),K=function(R){return R.toFixed(4)},H=[K(Y),K(C),K(-1*C),K(Y),0,0,"cm"]}this.internal.write("q"),se?(this.internal.write([1,"0","0",1,z(E),G(T+q),"cm"].join(" ")),this.internal.write(H.join(" ")),this.internal.write([z(B),"0","0",z(q),"0","0","cm"].join(" "))):this.internal.write([z(B),"0","0",z(q),z(E),G(T+q),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+U.index+" Do"),this.internal.write("Q")},b=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var v=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=e.__addimage__.sHashCode=function(E){var T,B,q=0;if(typeof E=="string")for(B=E.length,T=0;T<B;T++)q=(q<<5)-q+E.charCodeAt(T),q|=0;else if(j(E))for(B=E.byteLength/2,T=0;T<B;T++)q=(q<<5)-q+E[T],q|=0;return q},S=e.__addimage__.validateStringAsBase64=function(E){(E=E||"").toString().trim();var T=!0;return E.length===0&&(T=!1),E.length%4!=0&&(T=!1),/^[A-Za-z0-9+/]+$/.test(E.substr(0,E.length-2))===!1&&(T=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(E.substr(-2))===!1&&(T=!1),T},k=e.__addimage__.extractImageFromDataUrl=function(E){if(E==null||!(E=E.trim()).startsWith("data:"))return null;var T=E.indexOf(",");return T<0?null:E.substring(0,T).trim().endsWith("base64")?E.substring(T+1):null};e.__addimage__.isArrayBuffer=function(E){return E instanceof ArrayBuffer};var j=e.__addimage__.isArrayBufferView=function(E){return E instanceof Int8Array||E instanceof Uint8Array||E instanceof Uint8ClampedArray||E instanceof Int16Array||E instanceof Uint16Array||E instanceof Int32Array||E instanceof Uint32Array||E instanceof Float32Array||E instanceof Float64Array},A=e.__addimage__.binaryStringToUint8Array=function(E){for(var T=E.length,B=new Uint8Array(T),q=0;q<T;q++)B[q]=E.charCodeAt(q);return B},L=e.__addimage__.arrayBufferToBinaryString=function(E){for(var T="",B=j(E)?E:new Uint8Array(E),q=0;q<B.length;q+=8192)T+=String.fromCharCode.apply(null,B.subarray(q,q+8192));return T};e.addImage=function(){var E,T,B,q,U,se,de,z,G;if(typeof arguments[1]=="number"?(T=r,B=arguments[1],q=arguments[2],U=arguments[3],se=arguments[4],de=arguments[5],z=arguments[6],G=arguments[7]):(T=arguments[1],B=arguments[2],q=arguments[3],U=arguments[4],se=arguments[5],de=arguments[6],z=arguments[7],G=arguments[8]),Hi(E=arguments[0])==="object"&&!h(E)&&"imageData"in E){var ie=E;E=ie.imageData,T=ie.format||T||r,B=ie.x||B||0,q=ie.y||q||0,U=ie.w||ie.width||U,se=ie.h||ie.height||se,de=ie.alias||de,z=ie.compression||z,G=ie.rotation||ie.angle||G}var Y=this.internal.getFilters();if(z===void 0&&Y.indexOf("FlateEncode")!==-1&&(z="SLOW"),isNaN(B)||isNaN(q))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var C=P.call(this,E,T,de,z);return y.call(this,B,q,U,se,C,G),this};var P=function(E,T,B,q){var U,se,de;if(typeof E=="string"&&i(E)===r){E=unescape(E);var z=F(E,!1);(z!==""||(z=e.loadFile(E,!0))!==void 0)&&(E=z)}if(h(E)&&(E=p(E,T)),T=i(E,T),!f(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(((de=B)==null||de.length===0)&&(B=function(G){return typeof G=="string"||j(G)?w(G):j(G.data)?w(G.data):null}(E)),(U=m.call(this,B))||(E instanceof Uint8Array||T==="RGBA"||(se=E,E=A(E)),U=this["process"+T.toUpperCase()](E,d.call(this),B,function(G){return G&&typeof G=="string"&&(G=G.toUpperCase()),G in e.image_compression?G:v.NONE}(q),se)),!U)throw new Error("An unknown error occurred whilst processing the image.");return U},F=e.__addimage__.convertBase64ToBinaryString=function(E,T){T=typeof T!="boolean"||T;var B,q="";if(typeof E=="string"){var U;B=(U=k(E))!==null&&U!==void 0?U:E;try{q=Wv(B)}catch(se){if(T)throw S(B)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+se.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return q};e.getImageProperties=function(E){var T,B,q="";if(h(E)&&(E=p(E)),typeof E=="string"&&i(E)===r&&((q=F(E,!1))===""&&(q=e.loadFile(E)||""),E=q),B=i(E),!f(B))throw new Error("addImage does not support files of type '"+B+"', please ensure that a plugin for '"+B+"' support is added.");if(E instanceof Uint8Array||(E=A(E)),!(T=this["process"+B.toUpperCase()](E)))throw new Error("An unknown error occurred whilst processing the image");return T.fileType=B,T}})(Un.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};Un.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,i,s,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,d=!1,f=0;f<u.length&&!d;f++)switch((n=u[f]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var h=0;h<u.length;h++){n=u[h];var p=this.internal.pdfEscape,m=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),y=this.internal.newAdditionalObject(),b=this.internal.getEncryptor(g.objId),v=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(i="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+p(b(n.contents))+")",s+=" /Popup "+y.objId+" 0 R",s+=" /P "+c.objId+" 0 R",s+=" /T ("+p(b(v))+") >>",g.content=s;var w=g.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+w,n.open&&(s+=" /Open true"),s+=" >>",y.content=s,this.internal.write(g.objId,"0 R",y.objId,"0 R");break;case"freetext":i="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var S=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+p(m(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+S+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var k=this.annotations._nameMap[n.options.name];n.options.pageNumber=k.page,n.options.top=k.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+p(m(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;default:var j=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+j+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,i,s,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+i),h:u(n+s)},options:o,type:"link"})},e.textWithLink=function(r,n,i,s){var o,l,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){l=s.maxWidth;var d=this.splitTextToSize(r,l).length;o=Math.ceil(u*d)}else l=c,o=u;return this.text(r,n,i,s),i+=.2*u,s.align==="center"&&(n-=c/2),s.align==="right"&&(n-=c),this.link(n,i-u,l,o,s),c},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(Un.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];e.__arabicParser__={};var s=e.__arabicParser__.isInArabicSubstitutionA=function(g){return t[g.charCodeAt(0)]!==void 0},o=e.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},l=e.__arabicParser__.isArabicEndLetter=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(g){return o(g)&&i.indexOf(g.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length>=1};var u=e.__arabicParser__.arabicLetterHasFinalForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length>=3};var d=e.__arabicParser__.arabicLetterHasMedialForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length==4},f=e.__arabicParser__.resolveLigatures=function(g){var y=0,b=r,v="",w=0;for(y=0;y<g.length;y+=1)b[g.charCodeAt(y)]!==void 0?(w++,typeof(b=b[g.charCodeAt(y)])=="number"&&(v+=String.fromCharCode(b),b=r,w=0),y===g.length-1&&(b=r,v+=g.charAt(y-(w-1)),y-=w-1,w=0)):(b=r,v+=g.charAt(y-w),y-=w,w=0);return v};e.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&n[g.charCodeAt(0)]!==void 0};var h=e.__arabicParser__.getCorrectForm=function(g,y,b){return o(g)?s(g)===!1?-1:!u(g)||!o(y)&&!o(b)||!o(b)&&l(y)||l(g)&&!o(y)||l(g)&&c(y)||l(g)&&l(y)?0:d(g)&&o(y)&&!l(y)&&o(b)&&u(b)?3:l(g)||!o(b)?1:2:-1},p=function(g){var y=0,b=0,v=0,w="",S="",k="",j=(g=g||"").split("\\s+"),A=[];for(y=0;y<j.length;y+=1){for(A.push(""),b=0;b<j[y].length;b+=1)w=j[y][b],S=j[y][b-1],k=j[y][b+1],o(w)?(v=h(w,S,k),A[y]+=v!==-1?String.fromCharCode(t[w.charCodeAt(0)][v]):w):A[y]+=w;A[y]=f(A[y])}return A.join(" ")},m=e.__arabicParser__.processArabic=e.processArabic=function(){var g,y=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,b=[];if(Array.isArray(y)){var v=0;for(b=[],v=0;v<y.length;v+=1)Array.isArray(y[v])?b.push([p(y[v][0]),y[v][1],y[v][2]]):b.push([p(y[v])]);g=b}else g=p(y);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};e.events.push(["preProcessText",m])}(Un.API),Un.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(l){i=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(l){s=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Un.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(g){c=g}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var h=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var p=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return p},set:function(g){p=g}});var m=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return m},set:function(g){m=g}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,u){n.call(this);var d=(u=u||{}).fontSize||this.getFontSize(),f=u.font||this.getFont(),h=u.scaleFactor||this.internal.scaleFactor,p=0,m=0,g=0,y=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var b=u.maxWidth;b>0?typeof c=="string"?c=this.splitTextToSize(c,b):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(w,S){return w.concat(y.splitTextToSize(S,b))},[])):c=Array.isArray(c)?c:[c];for(var v=0;v<c.length;v++)p<(g=this.getStringUnitWidth(c[v],{font:f})*d)&&(p=g);return p!==0&&(m=c.length),{w:p/=h,h:Math.max((m*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/h,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var c;c=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var u=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,f=this.internal.__cell__.margins||t,h=this.internal.__cell__.tableHeaderRow,p=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=f.top,p&&h&&(this.printHeaderRow(c.lineNumber,!0),c.y+=h[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};e.table=function(c,u,d,f,h){if(n.call(this),!d)throw new Error("No data for PDF table.");var p,m,g,y,b=[],v=[],w=[],S={},k={},j=[],A=[],L=(h=h||{}).autoSize||!1,P=h.printHeaders!==!1,F=h.css&&h.css["font-size"]!==void 0?16*h.css["font-size"]:h.fontSize||12,E=h.margins||Object.assign({width:this.getPageWidth()},t),T=typeof h.padding=="number"?h.padding:3,B=h.headerBackgroundColor||"#c8c8c8",q=h.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=P,this.internal.__cell__.margins=E,this.internal.__cell__.table_font_size=F,this.internal.__cell__.padding=T,this.internal.__cell__.headerBackgroundColor=B,this.internal.__cell__.headerTextColor=q,this.setFontSize(F),f==null)v=b=Object.keys(d[0]),w=b.map(function(){return"left"});else if(Array.isArray(f)&&Hi(f[0])==="object")for(b=f.map(function(ie){return ie.name}),v=f.map(function(ie){return ie.prompt||ie.name||""}),w=f.map(function(ie){return ie.align||"left"}),p=0;p<f.length;p+=1)k[f[p].name]=.7499990551181103*f[p].width;else Array.isArray(f)&&typeof f[0]=="string"&&(v=b=f,w=b.map(function(){return"left"}));if(L||Array.isArray(f)&&typeof f[0]=="string")for(p=0;p<b.length;p+=1){for(S[y=b[p]]=d.map(function(ie){return ie[y]}),this.setFont(void 0,"bold"),j.push(this.getTextDimensions(v[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),m=S[y],this.setFont(void 0,"normal"),g=0;g<m.length;g+=1)j.push(this.getTextDimensions(m[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);k[y]=Math.max.apply(null,j)+T+T,j=[]}if(P){var U={};for(p=0;p<b.length;p+=1)U[b[p]]={},U[b[p]].text=v[p],U[b[p]].align=w[p];var se=l.call(this,U,k);A=b.map(function(ie){return new s(c,u,k[ie],se,U[ie].text,void 0,U[ie].align)}),this.setTableHeaderRow(A),this.printHeaderRow(1,!1)}var de=f.reduce(function(ie,Y){return ie[Y.name]=Y.align,ie},{});for(p=0;p<d.length;p+=1){"rowStart"in h&&h.rowStart instanceof Function&&h.rowStart({row:p,data:d[p]},this);var z=l.call(this,d[p],k);for(g=0;g<b.length;g+=1){var G=d[p][b[g]];"cellStart"in h&&h.cellStart instanceof Function&&h.cellStart({row:p,col:g,data:G},this),o.call(this,new s(c,u,k[b[g]],z,G,p+2,de[b[g]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var d=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,h=this.internal.scaleFactor;return Object.keys(c).map(function(p){var m=c[p];return this.splitTextToSize(m.hasOwnProperty("text")?m.text:m,u[p]-d-d)},this).map(function(p){return this.getLineHeightFactor()*p.length*f/h+d+d},this).reduce(function(p,m){return Math.max(p,m)},0)};e.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var h=[],p=0;p<this.internal.__cell__.tableHeaderRow.length;p+=1){d=this.internal.__cell__.tableHeaderRow[p].clone(),u&&(d.y=this.internal.__cell__.margins.top||0,h.push(d)),d.lineNumber=c;var m=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,d),this.setTextColor(m)}h.length>0&&this.setTableHeaderRow(h),this.setFont(void 0,"normal"),r=!1}}(Un.API);var Lz={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Rz=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],aA=Mz(Rz),Fz=[100,200,300,400,500,600,700,800,900],Cge=Mz(Fz);function Nk(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(s){return Lz[s=s||"normal"]?s:"normal"}(e.style),n=function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400}(e.weight),i=function(s){return typeof aA[s=s||"normal"]=="number"?s:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:i,src:e.src||[],ref:e.ref||{name:t,style:[i,r,n].join(" ")}}}function sM(e,t,r,n){var i;for(i=r;i>=0&&i<t.length;i+=n)if(e[t[i]])return e[t[i]];for(i=r;i>=0&&i<t.length;i-=n)if(e[t[i]])return e[t[i]]}var Ege={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},oM={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function lM(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function cM(e){return e.trimLeft()}function Tge(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function Pge(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var bp,Db,uM,dM,fM,Ck=["times"];function hM(e,t,r,n,i){var s=4,o=mM;switch(i){case Un.API.image_compression.FAST:s=1,o=pM;break;case Un.API.image_compression.MEDIUM:s=6,o=gM;break;case Un.API.image_compression.SLOW:s=9,o=xM}e=function(c,u,d,f){for(var h,p=c.length/u,m=new Uint8Array(c.length+p),g=[Oge,pM,mM,gM,xM],y=0;y<p;y+=1){var b=y*u,v=c.subarray(b,b+u);if(f)m.set(f(v,d,h),b+y);else{for(var w=g.length,S=[],k=0;k<w;k+=1)S[k]=g[k](v,d,h);var j=Lge(S.concat());m.set(S[j],b+y)}h=v}return m}(e,t,Math.ceil(r*n/8),o);var l=J4(e,{level:s});return Un.API.__addimage__.arrayBufferToBinaryString(l)}function Oge(e){var t=Array.apply([],e);return t.unshift(0),t}function pM(e,t){var r=e.length,n=[];n[0]=1;for(var i=0;i<r;i+=1){var s=e[i-t]||0;n[i+1]=e[i]-s+256&255}return n}function mM(e,t,r){var n=e.length,i=[];i[0]=2;for(var s=0;s<n;s+=1){var o=r&&r[s]||0;i[s+1]=e[s]-o+256&255}return i}function gM(e,t,r){var n=e.length,i=[];i[0]=3;for(var s=0;s<n;s+=1){var o=e[s-t]||0,l=r&&r[s]||0;i[s+1]=e[s]+256-(o+l>>>1)&255}return i}function xM(e,t,r){var n=e.length,i=[];i[0]=4;for(var s=0;s<n;s+=1){var o=Mge(e[s-t]||0,r&&r[s]||0,r&&r[s-t]||0);i[s+1]=e[s]-o+256&255}return i}function Mge(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),i=Math.abs(e-r),s=Math.abs(e+t-r-r);return n<=i&&n<=s?e:i<=s?t:r}function Lge(e){var t=e.map(function(r){return r.reduce(function(n,i){return n+Math.abs(i)},0)});return t.indexOf(Math.min.apply(null,t))}function Ek(e,t,r){var n=t*r,i=Math.floor(n/8),s=16-(n-8*i+r),o=(1<<r)-1;return Bz(e,i)>>s&o}function yM(e,t,r,n){var i=r*n,s=Math.floor(i/8),o=16-(i-8*s+n),l=(1<<n)-1,c=(t&l)<<o;(function(u,d,f){if(d+1<u.byteLength)u.setUint16(d,f,!1);else{var h=f>>8&255;u.setUint8(d,h)}})(e,s,Bz(e,s)&~(l<<o)&65535|c)}function Bz(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function Rge(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,i=e[t++],s=i>>7,o=1<<1+(7&i);e[t++],e[t++];var l=null,c=null;s&&(l=t,c=o,t+=3*o);var u=!0,d=[],f=0,h=null,p=0,m=null;for(this.width=r,this.height=n;u&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,m=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((E=e[t++])>=0))throw Error("Invalid block size");if(E===0)break;t+=E}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var g=e[t++];f=e[t++]|e[t++]<<8,h=e[t++],1&g||(h=null),p=g>>2&7,t++;break;case 254:for(;;){if(!((E=e[t++])>=0))throw Error("Invalid block size");if(E===0)break;t+=E}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var y=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,v=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,S=e[t++],k=S>>6&1,j=1<<1+(7&S),A=l,L=c,P=!1;S>>7&&(P=!0,A=t,L=j,t+=3*j);var F=t;for(t++;;){var E;if(!((E=e[t++])>=0))throw Error("Invalid block size");if(E===0)break;t+=E}d.push({x:y,y:b,width:v,height:w,has_local_palette:P,palette_offset:A,palette_size:L,data_offset:F,data_length:t-F,transparent_index:h,interlaced:!!k,delay:f,disposal:p});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return m},this.frameInfo=function(T){if(T<0||T>=d.length)throw new Error("Frame index out of range.");return d[T]},this.decodeAndBlitFrameBGRA=function(T,B){var q=this.frameInfo(T),U=q.width*q.height,se=new Uint8Array(U);bM(e,q.data_offset,se,U);var de=q.palette_offset,z=q.transparent_index;z===null&&(z=256);var G=q.width,ie=r-G,Y=G,C=4*(q.y*r+q.x),K=4*((q.y+q.height)*r+q.x),H=C,R=4*ie;q.interlaced===!0&&(R+=4*r*7);for(var J=8,V=0,X=se.length;V<X;++V){var Q=se[V];if(Y===0&&(Y=G,(H+=R)>=K&&(R=4*ie+4*r*(J-1),H=C+(G+ie)*(J<<1),J>>=1)),Q===z)H+=4;else{var ne=e[de+3*Q],oe=e[de+3*Q+1],O=e[de+3*Q+2];B[H++]=O,B[H++]=oe,B[H++]=ne,B[H++]=255}--Y}},this.decodeAndBlitFrameRGBA=function(T,B){var q=this.frameInfo(T),U=q.width*q.height,se=new Uint8Array(U);bM(e,q.data_offset,se,U);var de=q.palette_offset,z=q.transparent_index;z===null&&(z=256);var G=q.width,ie=r-G,Y=G,C=4*(q.y*r+q.x),K=4*((q.y+q.height)*r+q.x),H=C,R=4*ie;q.interlaced===!0&&(R+=4*r*7);for(var J=8,V=0,X=se.length;V<X;++V){var Q=se[V];if(Y===0&&(Y=G,(H+=R)>=K&&(R=4*ie+4*r*(J-1),H=C+(G+ie)*(J<<1),J>>=1)),Q===z)H+=4;else{var ne=e[de+3*Q],oe=e[de+3*Q+1],O=e[de+3*Q+2];B[H++]=ne,B[H++]=oe,B[H++]=O,B[H++]=255}--Y}}}function bM(e,t,r,n){for(var i=e[t++],s=1<<i,o=s+1,l=o+1,c=i+1,u=(1<<c)-1,d=0,f=0,h=0,p=e[t++],m=new Int32Array(4096),g=null;;){for(;d<16&&p!==0;)f|=e[t++]<<d,d+=8,p===1?p=e[t++]:--p;if(d<c)break;var y=f&u;if(f>>=c,d-=c,y!==s){if(y===o)break;for(var b=y<l?y:g,v=0,w=b;w>s;)w=m[w]>>8,++v;var S=w;if(h+v+(b!==y?1:0)>n)return void ia.log("Warning, gif stream longer than expected.");r[h++]=S;var k=h+=v;for(b!==y&&(r[h++]=S),w=b;v--;)w=m[w],r[--k]=255&w,w>>=8;g!==null&&l<4096&&(m[l++]=g<<8|S,l>=u+1&&c<12&&(++c,u=u<<1|1)),g=y}else l=o+1,u=(1<<(c=i+1))-1,g=null}return h!==n&&ia.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Tk(e){var t,r,n,i,s,o=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),d=new Array(64),f=new Array(65535),h=new Array(65535),p=new Array(64),m=new Array(64),g=[],y=0,b=7,v=new Array(64),w=new Array(64),S=new Array(64),k=new Array(256),j=new Array(2048),A=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],L=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],P=[0,1,2,3,4,5,6,7,8,9,10,11],F=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],E=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],B=[0,1,2,3,4,5,6,7,8,9,10,11],q=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],U=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function se(C,K){for(var H=0,R=0,J=new Array,V=1;V<=16;V++){for(var X=1;X<=C[V];X++)J[K[R]]=[],J[K[R]][0]=H,J[K[R]][1]=V,R++,H++;H*=2}return J}function de(C){for(var K=C[0],H=C[1]-1;H>=0;)K&1<<H&&(y|=1<<b),H--,--b<0&&(y==255?(z(255),z(0)):z(y),b=7,y=0)}function z(C){g.push(C)}function G(C){z(C>>8&255),z(255&C)}function ie(C,K,H,R,J){for(var V,X=J[0],Q=J[240],ne=function(Ae,Be){var Ee,ze,Xe,Pt,ft,He,tt,_e,Se,he,ye=0;for(Se=0;Se<8;++Se){Ee=Ae[ye],ze=Ae[ye+1],Xe=Ae[ye+2],Pt=Ae[ye+3],ft=Ae[ye+4],He=Ae[ye+5],tt=Ae[ye+6];var ht=Ee+(_e=Ae[ye+7]),Ge=Ee-_e,lt=ze+tt,jt=ze-tt,wt=Xe+He,yt=Xe-He,Fr=Pt+ft,Tt=Pt-ft,hr=ht+Fr,rn=ht-Fr,en=lt+wt,$r=lt-wt;Ae[ye]=hr+en,Ae[ye+4]=hr-en;var Kr=.707106781*($r+rn);Ae[ye+2]=rn+Kr,Ae[ye+6]=rn-Kr;var Rn=.382683433*((hr=Tt+yt)-($r=jt+Ge)),Pr=.5411961*hr+Rn,Sn=1.306562965*$r+Rn,Me=.707106781*(en=yt+jt),je=Ge+Me,Mt=Ge-Me;Ae[ye+5]=Mt+Pr,Ae[ye+3]=Mt-Pr,Ae[ye+1]=je+Sn,Ae[ye+7]=je-Sn,ye+=8}for(ye=0,Se=0;Se<8;++Se){Ee=Ae[ye],ze=Ae[ye+8],Xe=Ae[ye+16],Pt=Ae[ye+24],ft=Ae[ye+32],He=Ae[ye+40],tt=Ae[ye+48];var pt=Ee+(_e=Ae[ye+56]),Ut=Ee-_e,ir=ze+tt,fr=ze-tt,vr=Xe+He,re=Xe-He,le=Pt+ft,te=Pt-ft,ue=pt+le,Ne=pt-le,ke=ir+vr,vt=ir-vr;Ae[ye]=ue+ke,Ae[ye+32]=ue-ke;var rt=.707106781*(vt+Ne);Ae[ye+16]=Ne+rt,Ae[ye+48]=Ne-rt;var De=.382683433*((ue=te+re)-(vt=fr+Ut)),We=.5411961*ue+De,st=1.306562965*vt+De,zt=.707106781*(ke=re+fr),Wt=Ut+zt,xt=Ut-zt;Ae[ye+40]=xt+We,Ae[ye+24]=xt-We,Ae[ye+8]=Wt+st,Ae[ye+56]=Wt-st,ye++}for(Se=0;Se<64;++Se)he=Ae[Se]*Be[Se],p[Se]=he>0?he+.5|0:he-.5|0;return p}(C,K),oe=0;oe<64;++oe)m[A[oe]]=ne[oe];var O=m[0]-H;H=m[0],O==0?de(R[0]):(de(R[h[V=32767+O]]),de(f[V]));for(var W=63;W>0&&m[W]==0;)W--;if(W==0)return de(X),H;for(var ae,I=1;I<=W;){for(var Z=I;m[I]==0&&I<=W;)++I;var me=I-Z;if(me>=16){ae=me>>4;for(var Te=1;Te<=ae;++Te)de(Q);me&=15}V=32767+m[I],de(J[(me<<4)+h[V]]),de(f[V]),I++}return W!=63&&de(X),H}function Y(C){C=Math.min(Math.max(C,1),100),s!=C&&(function(K){for(var H=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],R=0;R<64;R++){var J=o((H[R]*K+50)/100);J=Math.min(Math.max(J,1),255),l[A[R]]=J}for(var V=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],X=0;X<64;X++){var Q=o((V[X]*K+50)/100);Q=Math.min(Math.max(Q,1),255),c[A[X]]=Q}for(var ne=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],oe=0,O=0;O<8;O++)for(var W=0;W<8;W++)u[oe]=1/(l[A[oe]]*ne[O]*ne[W]*8),d[oe]=1/(c[A[oe]]*ne[O]*ne[W]*8),oe++}(C<50?Math.floor(5e3/C):Math.floor(200-2*C)),s=C)}this.encode=function(C,K){K&&Y(K),g=new Array,y=0,b=7,G(65496),G(65504),G(16),z(74),z(70),z(73),z(70),z(0),z(1),z(1),z(0),G(1),G(1),z(0),z(0),function(){G(65499),G(132),z(0);for(var ze=0;ze<64;ze++)z(l[ze]);z(1);for(var Xe=0;Xe<64;Xe++)z(c[Xe])}(),function(ze,Xe){G(65472),G(17),z(8),G(Xe),G(ze),z(3),z(1),z(17),z(0),z(2),z(17),z(1),z(3),z(17),z(1)}(C.width,C.height),function(){G(65476),G(418),z(0);for(var ze=0;ze<16;ze++)z(L[ze+1]);for(var Xe=0;Xe<=11;Xe++)z(P[Xe]);z(16);for(var Pt=0;Pt<16;Pt++)z(F[Pt+1]);for(var ft=0;ft<=161;ft++)z(E[ft]);z(1);for(var He=0;He<16;He++)z(T[He+1]);for(var tt=0;tt<=11;tt++)z(B[tt]);z(17);for(var _e=0;_e<16;_e++)z(q[_e+1]);for(var Se=0;Se<=161;Se++)z(U[Se])}(),G(65498),G(12),z(3),z(1),z(0),z(2),z(17),z(3),z(17),z(0),z(63),z(0);var H=0,R=0,J=0;y=0,b=7,this.encode.displayName="_encode_";for(var V,X,Q,ne,oe,O,W,ae,I,Z=C.data,me=C.width,Te=C.height,Ae=4*me,Be=0;Be<Te;){for(V=0;V<Ae;){for(oe=Ae*Be+V,W=-1,ae=0,I=0;I<64;I++)O=oe+(ae=I>>3)*Ae+(W=4*(7&I)),Be+ae>=Te&&(O-=Ae*(Be+1+ae-Te)),V+W>=Ae&&(O-=V+W-Ae+4),X=Z[O++],Q=Z[O++],ne=Z[O++],v[I]=(j[X]+j[Q+256|0]+j[ne+512|0]>>16)-128,w[I]=(j[X+768|0]+j[Q+1024|0]+j[ne+1280|0]>>16)-128,S[I]=(j[X+1280|0]+j[Q+1536|0]+j[ne+1792|0]>>16)-128;H=ie(v,u,H,t,n),R=ie(w,d,R,r,i),J=ie(S,d,J,r,i),V+=32}Be+=8}if(b>=0){var Ee=[];Ee[1]=b+1,Ee[0]=(1<<b+1)-1,de(Ee)}return G(65497),new Uint8Array(g)},e=e||50,function(){for(var C=String.fromCharCode,K=0;K<256;K++)k[K]=C(K)}(),t=se(L,P),r=se(T,B),n=se(F,E),i=se(q,U),function(){for(var C=1,K=2,H=1;H<=15;H++){for(var R=C;R<K;R++)h[32767+R]=H,f[32767+R]=[],f[32767+R][1]=H,f[32767+R][0]=R;for(var J=-(K-1);J<=-C;J++)h[32767+J]=H,f[32767+J]=[],f[32767+J][1]=H,f[32767+J][0]=K-1+J;C<<=1,K<<=1}}(),function(){for(var C=0;C<256;C++)j[C]=19595*C,j[C+256|0]=38470*C,j[C+512|0]=7471*C+32768,j[C+768|0]=-11059*C,j[C+1024|0]=-21709*C,j[C+1280|0]=32768*C+8421375,j[C+1536|0]=-27439*C,j[C+1792|0]=-5329*C}(),Y(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function iu(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function vM(e){function t(P){if(!P)throw Error("assert :P")}function r(P,F,E){for(var T=0;4>T;T++)if(P[F+T]!=E.charCodeAt(T))return!0;return!1}function n(P,F,E,T,B){for(var q=0;q<B;q++)P[F+q]=E[T+q]}function i(P,F,E,T){for(var B=0;B<T;B++)P[F+B]=E}function s(P){return new Int32Array(P)}function o(P,F){for(var E=[],T=0;T<P;T++)E.push(new F);return E}function l(P,F){var E=[];return function T(B,q,U){for(var se=U[q],de=0;de<se&&(B.push(U.length>q+1?[]:new F),!(U.length<q+1));de++)T(B[de],q+1,U)}(E,0,P),E}var c=function(){var P=this;function F(_,N){for(var D=1<<N-1>>>0;_&D;)D>>>=1;return D?(_&D-1)+D:_}function E(_,N,D,ee,pe){t(!(ee%D));do _[N+(ee-=D)]=pe;while(0<ee)}function T(_,N,D,ee,pe){if(t(2328>=pe),512>=pe)var ge=s(512);else if((ge=s(pe))==null)return 0;return function(be,Ce,Oe,Qe,Et,rr){var Je,Lt,Yt=Ce,_r=1<<Oe,tr=s(16),Nr=s(16);for(t(Et!=0),t(Qe!=null),t(be!=null),t(0<Oe),Lt=0;Lt<Et;++Lt){if(15<Qe[Lt])return 0;++tr[Qe[Lt]]}if(tr[0]==Et)return 0;for(Nr[1]=0,Je=1;15>Je;++Je){if(tr[Je]>1<<Je)return 0;Nr[Je+1]=Nr[Je]+tr[Je]}for(Lt=0;Lt<Et;++Lt)Je=Qe[Lt],0<Qe[Lt]&&(rr[Nr[Je]++]=Lt);if(Nr[15]==1)return(Qe=new B).g=0,Qe.value=rr[0],E(be,Yt,1,_r,Qe),_r;var Cr,Gr=-1,Dr=_r-1,$n=0,En=1,ui=1,Mn=1<<Oe;for(Lt=0,Je=1,Et=2;Je<=Oe;++Je,Et<<=1){if(En+=ui<<=1,0>(ui-=tr[Je]))return 0;for(;0<tr[Je];--tr[Je])(Qe=new B).g=Je,Qe.value=rr[Lt++],E(be,Yt+$n,Et,Mn,Qe),$n=F($n,Je)}for(Je=Oe+1,Et=2;15>=Je;++Je,Et<<=1){if(En+=ui<<=1,0>(ui-=tr[Je]))return 0;for(;0<tr[Je];--tr[Je]){if(Qe=new B,($n&Dr)!=Gr){for(Yt+=Mn,Cr=1<<(Gr=Je)-Oe;15>Gr&&!(0>=(Cr-=tr[Gr]));)++Gr,Cr<<=1;_r+=Mn=1<<(Cr=Gr-Oe),be[Ce+(Gr=$n&Dr)].g=Cr+Oe,be[Ce+Gr].value=Yt-Ce-Gr}Qe.g=Je-Oe,Qe.value=rr[Lt++],E(be,Yt+($n>>Oe),Et,Mn,Qe),$n=F($n,Je)}}return En!=2*Nr[15]-1?0:_r}(_,N,D,ee,pe,ge)}function B(){this.value=this.g=0}function q(){this.value=this.g=0}function U(){this.G=o(5,B),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Fl,q)}function se(_,N,D,ee){t(_!=null),t(N!=null),t(2147483648>ee),_.Ca=254,_.I=0,_.b=-8,_.Ka=0,_.oa=N,_.pa=D,_.Jd=N,_.Yc=D+ee,_.Zc=4<=ee?D+ee-4+1:D,X(_)}function de(_,N){for(var D=0;0<N--;)D|=ne(_,128)<<N;return D}function z(_,N){var D=de(_,N);return Q(_)?-D:D}function G(_,N,D,ee){var pe,ge=0;for(t(_!=null),t(N!=null),t(4294967288>ee),_.Sb=ee,_.Ra=0,_.u=0,_.h=0,4<ee&&(ee=4),pe=0;pe<ee;++pe)ge+=N[D+pe]<<8*pe;_.Ra=ge,_.bb=ee,_.oa=N,_.pa=D}function ie(_){for(;8<=_.u&&_.bb<_.Sb;)_.Ra>>>=8,_.Ra+=_.oa[_.pa+_.bb]<<Di-8>>>0,++_.bb,_.u-=8;R(_)&&(_.h=1,_.u=0)}function Y(_,N){if(t(0<=N),!_.h&&N<=Zi){var D=H(_)&Ya[N];return _.u+=N,ie(_),D}return _.h=1,_.u=0}function C(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function K(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function H(_){return _.Ra>>>(_.u&Di-1)>>>0}function R(_){return t(_.bb<=_.Sb),_.h||_.bb==_.Sb&&_.u>Di}function J(_,N){_.u=N,_.h=R(_)}function V(_){_.u>=ba&&(t(_.u>=ba),ie(_))}function X(_){t(_!=null&&_.oa!=null),_.pa<_.Zc?(_.I=(_.oa[_.pa++]|_.I<<8)>>>0,_.b+=8):(t(_!=null&&_.oa!=null),_.pa<_.Yc?(_.b+=8,_.I=_.oa[_.pa++]|_.I<<8):_.Ka?_.b=0:(_.I<<=8,_.b+=8,_.Ka=1))}function Q(_){return de(_,1)}function ne(_,N){var D=_.Ca;0>_.b&&X(_);var ee=_.b,pe=D*N>>>8,ge=(_.I>>>ee>pe)+0;for(ge?(D-=pe,_.I-=pe+1<<ee>>>0):D=pe+1,ee=D,pe=0;256<=ee;)pe+=8,ee>>=8;return ee=7^pe+cs[ee],_.b-=ee,_.Ca=(D<<ee)-1,ge}function oe(_,N,D){_[N+0]=D>>24&255,_[N+1]=D>>16&255,_[N+2]=D>>8&255,_[N+3]=255&D}function O(_,N){return _[N+0]|_[N+1]<<8}function W(_,N){return O(_,N)|_[N+2]<<16}function ae(_,N){return O(_,N)|O(_,N+2)<<16}function I(_,N){var D=1<<N;return t(_!=null),t(0<N),_.X=s(D),_.X==null?0:(_.Mb=32-N,_.Xa=N,1)}function Z(_,N){t(_!=null),t(N!=null),t(_.Xa==N.Xa),n(N.X,0,_.X,0,1<<N.Xa)}function me(){this.X=[],this.Xa=this.Mb=0}function Te(_,N,D,ee){t(D!=null),t(ee!=null);var pe=D[0],ge=ee[0];return pe==0&&(pe=(_*ge+N/2)/N),ge==0&&(ge=(N*pe+_/2)/_),0>=pe||0>=ge?0:(D[0]=pe,ee[0]=ge,1)}function Ae(_,N){return _+(1<<N)-1>>>N}function Be(_,N){return((4278255360&_)+(4278255360&N)>>>0&4278255360)+((16711935&_)+(16711935&N)>>>0&16711935)>>>0}function Ee(_,N){P[N]=function(D,ee,pe,ge,be,Ce,Oe){var Qe;for(Qe=0;Qe<be;++Qe){var Et=P[_](Ce[Oe+Qe-1],pe,ge+Qe);Ce[Oe+Qe]=Be(D[ee+Qe],Et)}}}function ze(){this.ud=this.hd=this.jd=0}function Xe(_,N){return((4278124286&(_^N))>>>1)+(_&N)>>>0}function Pt(_){return 0<=_&&256>_?_:0>_?0:255<_?255:void 0}function ft(_,N){return Pt(_+(_-N+.5>>1))}function He(_,N,D){return Math.abs(N-D)-Math.abs(_-D)}function tt(_,N,D,ee,pe,ge,be){for(ee=ge[be-1],D=0;D<pe;++D)ge[be+D]=ee=Be(_[N+D],ee)}function _e(_,N,D,ee,pe){var ge;for(ge=0;ge<D;++ge){var be=_[N+ge],Ce=be>>8&255,Oe=16711935&(Oe=(Oe=16711935&be)+((Ce<<16)+Ce));ee[pe+ge]=(4278255360&be)+Oe>>>0}}function Se(_,N){N.jd=255&_,N.hd=_>>8&255,N.ud=_>>16&255}function he(_,N,D,ee,pe,ge){var be;for(be=0;be<ee;++be){var Ce=N[D+be],Oe=Ce>>>8,Qe=Ce,Et=255&(Et=(Et=Ce>>>16)+((_.jd<<24>>24)*(Oe<<24>>24)>>>5));Qe=255&(Qe=(Qe+=(_.hd<<24>>24)*(Oe<<24>>24)>>>5)+((_.ud<<24>>24)*(Et<<24>>24)>>>5)),pe[ge+be]=(4278255360&Ce)+(Et<<16)+Qe}}function ye(_,N,D,ee,pe){P[N]=function(ge,be,Ce,Oe,Qe,Et,rr,Je,Lt){for(Oe=rr;Oe<Je;++Oe)for(rr=0;rr<Lt;++rr)Qe[Et++]=pe(Ce[ee(ge[be++])])},P[_]=function(ge,be,Ce,Oe,Qe,Et,rr){var Je=8>>ge.b,Lt=ge.Ea,Yt=ge.K[0],_r=ge.w;if(8>Je)for(ge=(1<<ge.b)-1,_r=(1<<Je)-1;be<Ce;++be){var tr,Nr=0;for(tr=0;tr<Lt;++tr)tr&ge||(Nr=ee(Oe[Qe++])),Et[rr++]=pe(Yt[Nr&_r]),Nr>>=Je}else P["VP8LMapColor"+D](Oe,Qe,Yt,_r,Et,rr,be,Ce,Lt)}}function ht(_,N,D,ee,pe){for(D=N+D;N<D;){var ge=_[N++];ee[pe++]=ge>>16&255,ee[pe++]=ge>>8&255,ee[pe++]=255&ge}}function Ge(_,N,D,ee,pe){for(D=N+D;N<D;){var ge=_[N++];ee[pe++]=ge>>16&255,ee[pe++]=ge>>8&255,ee[pe++]=255&ge,ee[pe++]=ge>>24&255}}function lt(_,N,D,ee,pe){for(D=N+D;N<D;){var ge=(be=_[N++])>>16&240|be>>12&15,be=240&be|be>>28&15;ee[pe++]=ge,ee[pe++]=be}}function jt(_,N,D,ee,pe){for(D=N+D;N<D;){var ge=(be=_[N++])>>16&248|be>>13&7,be=be>>5&224|be>>3&31;ee[pe++]=ge,ee[pe++]=be}}function wt(_,N,D,ee,pe){for(D=N+D;N<D;){var ge=_[N++];ee[pe++]=255&ge,ee[pe++]=ge>>8&255,ee[pe++]=ge>>16&255}}function yt(_,N,D,ee,pe,ge){if(ge==0)for(D=N+D;N<D;)oe(ee,((ge=_[N++])[0]>>24|ge[1]>>8&65280|ge[2]<<8&16711680|ge[3]<<24)>>>0),pe+=32;else n(ee,pe,_,N,D)}function Fr(_,N){P[N][0]=P[_+"0"],P[N][1]=P[_+"1"],P[N][2]=P[_+"2"],P[N][3]=P[_+"3"],P[N][4]=P[_+"4"],P[N][5]=P[_+"5"],P[N][6]=P[_+"6"],P[N][7]=P[_+"7"],P[N][8]=P[_+"8"],P[N][9]=P[_+"9"],P[N][10]=P[_+"10"],P[N][11]=P[_+"11"],P[N][12]=P[_+"12"],P[N][13]=P[_+"13"],P[N][14]=P[_+"0"],P[N][15]=P[_+"0"]}function Tt(_){return _==e5||_==t5||_==Vy||_==r5}function hr(){this.eb=[],this.size=this.A=this.fb=0}function rn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function en(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new hr,this.f.kb=new rn,this.sd=null}function $r(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Kr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Rn(_){return alert("todo:WebPSamplerProcessPlane"),_.T}function Pr(_,N){var D=_.T,ee=N.ba.f.RGBA,pe=ee.eb,ge=ee.fb+_.ka*ee.A,be=bc[N.ba.S],Ce=_.y,Oe=_.O,Qe=_.f,Et=_.N,rr=_.ea,Je=_.W,Lt=N.cc,Yt=N.dc,_r=N.Mc,tr=N.Nc,Nr=_.ka,Cr=_.ka+_.T,Gr=_.U,Dr=Gr+1>>1;for(Nr==0?be(Ce,Oe,null,null,Qe,Et,rr,Je,Qe,Et,rr,Je,pe,ge,null,null,Gr):(be(N.ec,N.fc,Ce,Oe,Lt,Yt,_r,tr,Qe,Et,rr,Je,pe,ge-ee.A,pe,ge,Gr),++D);Nr+2<Cr;Nr+=2)Lt=Qe,Yt=Et,_r=rr,tr=Je,Et+=_.Rc,Je+=_.Rc,ge+=2*ee.A,be(Ce,(Oe+=2*_.fa)-_.fa,Ce,Oe,Lt,Yt,_r,tr,Qe,Et,rr,Je,pe,ge-ee.A,pe,ge,Gr);return Oe+=_.fa,_.j+Cr<_.o?(n(N.ec,N.fc,Ce,Oe,Gr),n(N.cc,N.dc,Qe,Et,Dr),n(N.Mc,N.Nc,rr,Je,Dr),D--):1&Cr||be(Ce,Oe,null,null,Qe,Et,rr,Je,Qe,Et,rr,Je,pe,ge+ee.A,null,null,Gr),D}function Sn(_,N,D){var ee=_.F,pe=[_.J];if(ee!=null){var ge=_.U,be=N.ba.S,Ce=be==Hy||be==Vy;N=N.ba.f.RGBA;var Oe=[0],Qe=_.ka;Oe[0]=_.T,_.Kb&&(Qe==0?--Oe[0]:(--Qe,pe[0]-=_.width),_.j+_.ka+_.T==_.o&&(Oe[0]=_.o-_.j-Qe));var Et=N.eb;Qe=N.fb+Qe*N.A,_=R6(ee,pe[0],_.width,ge,Oe,Et,Qe+(Ce?0:3),N.A),t(D==Oe),_&&Tt(be)&&Ag(Et,Qe,Ce,ge,Oe,N.A)}return 0}function Me(_){var N=_.ma,D=N.ba.S,ee=11>D,pe=D==Wy||D==qy||D==Hy||D==Z_||D==12||Tt(D);if(N.memory=null,N.Ib=null,N.Jb=null,N.Nd=null,!Vo(N.Oa,_,pe?11:12))return 0;if(pe&&Tt(D)&&Ar(),_.da)alert("todo:use_scaling");else{if(ee){if(N.Ib=Rn,_.Kb){if(D=_.U+1>>1,N.memory=s(_.U+2*D),N.memory==null)return 0;N.ec=N.memory,N.fc=0,N.cc=N.ec,N.dc=N.fc+_.U,N.Mc=N.cc,N.Nc=N.dc+D,N.Ib=Pr,Ar()}}else alert("todo:EmitYUV");pe&&(N.Jb=Sn,ee&&Ft())}if(ee&&!Q6){for(_=0;256>_;++_)KK[_]=89858*(_-128)+Ky>>Gy,QK[_]=-22014*(_-128)+Ky,XK[_]=-45773*(_-128),YK[_]=113618*(_-128)+Ky>>Gy;for(_=Cg;_<a5;++_)N=76283*(_-16)+Ky>>Gy,JK[_-Cg]=kr(N,255),ZK[_-Cg]=kr(N+8>>4,15);Q6=1}return 1}function je(_){var N=_.ma,D=_.U,ee=_.T;return t(!(1&_.ka)),0>=D||0>=ee?0:(D=N.Ib(_,N),N.Jb!=null&&N.Jb(_,N,D),N.Dc+=D,1)}function Mt(_){_.ma.memory=null}function pt(_,N,D,ee){return Y(_,8)!=47?0:(N[0]=Y(_,14)+1,D[0]=Y(_,14)+1,ee[0]=Y(_,1),Y(_,3)!=0?0:!_.h)}function Ut(_,N){if(4>_)return _+1;var D=_-2>>1;return(2+(1&_)<<D)+Y(N,D)+1}function ir(_,N){return 120<N?N-120:1<=(D=((D=LK[N-1])>>4)*_+(8-(15&D)))?D:1;var D}function fr(_,N,D){var ee=H(D),pe=_[N+=255&ee].g-8;return 0<pe&&(J(D,D.u+8),ee=H(D),N+=_[N].value,N+=ee&(1<<pe)-1),J(D,D.u+_[N].g),_[N].value}function vr(_,N,D){return D.g+=_.g,D.value+=_.value<<N>>>0,t(8>=D.g),_.g}function re(_,N,D){var ee=_.xc;return t((N=ee==0?0:_.vc[_.md*(D>>ee)+(N>>ee)])<_.Wb),_.Ya[N]}function le(_,N,D,ee){var pe=_.ab,ge=_.c*N,be=_.C;N=be+N;var Ce=D,Oe=ee;for(ee=_.Ta,D=_.Ua;0<pe--;){var Qe=_.gc[pe],Et=be,rr=N,Je=Ce,Lt=Oe,Yt=(Oe=ee,Ce=D,Qe.Ea);switch(t(Et<rr),t(rr<=Qe.nc),Qe.hc){case 2:qn(Je,Lt,(rr-Et)*Yt,Oe,Ce);break;case 0:var _r=Et,tr=rr,Nr=Oe,Cr=Ce,Gr=(Mn=Qe).Ea;_r==0&&(Yc(Je,Lt,null,null,1,Nr,Cr),tt(Je,Lt+1,0,0,Gr-1,Nr,Cr+1),Lt+=Gr,Cr+=Gr,++_r);for(var Dr=1<<Mn.b,$n=Dr-1,En=Ae(Gr,Mn.b),ui=Mn.K,Mn=Mn.w+(_r>>Mn.b)*En;_r<tr;){var vi=ui,ks=Mn,di=1;for(Xc(Je,Lt,Nr,Cr-Gr,1,Nr,Cr);di<Gr;){var Ln=(di&~$n)+Dr;Ln>Gr&&(Ln=Gr),(0,pc[vi[ks++]>>8&15])(Je,Lt+ +di,Nr,Cr+di-Gr,Ln-di,Nr,Cr+di),di=Ln}Lt+=Gr,Cr+=Gr,++_r&$n||(Mn+=En)}rr!=Qe.nc&&n(Oe,Ce-Yt,Oe,Ce+(rr-Et-1)*Yt,Yt);break;case 1:for(Yt=Je,tr=Lt,Gr=(Je=Qe.Ea)-(Cr=Je&~(Nr=(Lt=1<<Qe.b)-1)),_r=Ae(Je,Qe.b),Dr=Qe.K,Qe=Qe.w+(Et>>Qe.b)*_r;Et<rr;){for($n=Dr,En=Qe,ui=new ze,Mn=tr+Cr,vi=tr+Je;tr<Mn;)Se($n[En++],ui),Jc(ui,Yt,tr,Lt,Oe,Ce),tr+=Lt,Ce+=Lt;tr<vi&&(Se($n[En++],ui),Jc(ui,Yt,tr,Gr,Oe,Ce),tr+=Gr,Ce+=Gr),++Et&Nr||(Qe+=_r)}break;case 3:if(Je==Oe&&Lt==Ce&&0<Qe.b){for(tr=Oe,Je=Yt=Ce+(rr-Et)*Yt-(Cr=(rr-Et)*Ae(Qe.Ea,Qe.b)),Lt=Oe,Nr=Ce,_r=[],Cr=(Gr=Cr)-1;0<=Cr;--Cr)_r[Cr]=Lt[Nr+Cr];for(Cr=Gr-1;0<=Cr;--Cr)tr[Je+Cr]=_r[Cr];_i(Qe,Et,rr,Oe,Yt,Oe,Ce)}else _i(Qe,Et,rr,Je,Lt,Oe,Ce)}Ce=ee,Oe=D}Oe!=D&&n(ee,D,Ce,Oe,ge)}function te(_,N){var D=_.V,ee=_.Ba+_.c*_.C,pe=N-_.C;if(t(N<=_.l.o),t(16>=pe),0<pe){var ge=_.l,be=_.Ta,Ce=_.Ua,Oe=ge.width;if(le(_,pe,D,ee),pe=Ce=[Ce],t((D=_.C)<(ee=N)),t(ge.v<ge.va),ee>ge.o&&(ee=ge.o),D<ge.j){var Qe=ge.j-D;D=ge.j,pe[0]+=Qe*Oe}if(D>=ee?D=0:(pe[0]+=4*ge.v,ge.ka=D-ge.j,ge.U=ge.va-ge.v,ge.T=ee-D,D=1),D){if(Ce=Ce[0],11>(D=_.ca).S){var Et=D.f.RGBA,rr=(ee=D.S,pe=ge.U,ge=ge.T,Qe=Et.eb,Et.A),Je=ge;for(Et=Et.fb+_.Ma*Et.A;0<Je--;){var Lt=be,Yt=Ce,_r=pe,tr=Qe,Nr=Et;switch(ee){case zy:mc(Lt,Yt,_r,tr,Nr);break;case Wy:vo(Lt,Yt,_r,tr,Nr);break;case e5:vo(Lt,Yt,_r,tr,Nr),Ag(tr,Nr,0,_r,1,0);break;case z6:gc(Lt,Yt,_r,tr,Nr);break;case qy:yt(Lt,Yt,_r,tr,Nr,1);break;case t5:yt(Lt,Yt,_r,tr,Nr,1),Ag(tr,Nr,0,_r,1,0);break;case Hy:yt(Lt,Yt,_r,tr,Nr,0);break;case Vy:yt(Lt,Yt,_r,tr,Nr,0),Ag(tr,Nr,1,_r,1,0);break;case Z_:fl(Lt,Yt,_r,tr,Nr);break;case r5:fl(Lt,Yt,_r,tr,Nr),L6(tr,Nr,_r,1,0);break;case W6:hl(Lt,Yt,_r,tr,Nr);break;default:t(0)}Ce+=Oe,Et+=rr}_.Ma+=ge}else alert("todo:EmitRescaledRowsYUVA");t(_.Ma<=D.height)}}_.C=N,t(_.C<=_.i)}function ue(_){var N;if(0<_.ua)return 0;for(N=0;N<_.Wb;++N){var D=_.Ya[N].G,ee=_.Ya[N].H;if(0<D[1][ee[1]+0].g||0<D[2][ee[2]+0].g||0<D[3][ee[3]+0].g)return 0}return 1}function Ne(_,N,D,ee,pe,ge){if(_.Z!=0){var be=_.qd,Ce=_.rd;for(t(bf[_.Z]!=null);N<D;++N)bf[_.Z](be,Ce,ee,pe,ee,pe,ge),be=ee,Ce=pe,pe+=ge;_.qd=be,_.rd=Ce}}function ke(_,N){var D=_.l.ma,ee=D.Z==0||D.Z==1?_.l.j:_.C;if(ee=_.C<ee?ee:_.C,t(N<=_.l.o),N>ee){var pe=_.l.width,ge=D.ca,be=D.tb+pe*ee,Ce=_.V,Oe=_.Ba+_.c*ee,Qe=_.gc;t(_.ab==1),t(Qe[0].hc==3),bo(Qe[0],ee,N,Ce,Oe,ge,be),Ne(D,ee,N,ge,be,pe)}_.C=_.Ma=N}function vt(_,N,D,ee,pe,ge,be){var Ce=_.$/ee,Oe=_.$%ee,Qe=_.m,Et=_.s,rr=D+_.$,Je=rr;pe=D+ee*pe;var Lt=D+ee*ge,Yt=280+Et.ua,_r=_.Pb?Ce:16777216,tr=0<Et.ua?Et.Wa:null,Nr=Et.wc,Cr=rr<Lt?re(Et,Oe,Ce):null;t(_.C<ge),t(Lt<=pe);var Gr=!1;e:for(;;){for(;Gr||rr<Lt;){var Dr=0;if(Ce>=_r){var $n=rr-D;t((_r=_).Pb),_r.wd=_r.m,_r.xd=$n,0<_r.s.ua&&Z(_r.s.Wa,_r.s.vb),_r=Ce+FK}if(Oe&Nr||(Cr=re(Et,Oe,Ce)),t(Cr!=null),Cr.Qb&&(N[rr]=Cr.qb,Gr=!0),!Gr)if(V(Qe),Cr.jc){Dr=Qe,$n=N;var En=rr,ui=Cr.pd[H(Dr)&Fl-1];t(Cr.jc),256>ui.g?(J(Dr,Dr.u+ui.g),$n[En]=ui.value,Dr=0):(J(Dr,Dr.u+ui.g-256),t(256<=ui.value),Dr=ui.value),Dr==0&&(Gr=!0)}else Dr=fr(Cr.G[0],Cr.H[0],Qe);if(Qe.h)break;if(Gr||256>Dr){if(!Gr)if(Cr.nd)N[rr]=(Cr.qb|Dr<<8)>>>0;else{if(V(Qe),Gr=fr(Cr.G[1],Cr.H[1],Qe),V(Qe),$n=fr(Cr.G[2],Cr.H[2],Qe),En=fr(Cr.G[3],Cr.H[3],Qe),Qe.h)break;N[rr]=(En<<24|Gr<<16|Dr<<8|$n)>>>0}if(Gr=!1,++rr,++Oe>=ee&&(Oe=0,++Ce,be!=null&&Ce<=ge&&!(Ce%16)&&be(_,Ce),tr!=null))for(;Je<rr;)Dr=N[Je++],tr.X[(506832829*Dr&4294967295)>>>tr.Mb]=Dr}else if(280>Dr){if(Dr=Ut(Dr-256,Qe),$n=fr(Cr.G[4],Cr.H[4],Qe),V(Qe),$n=ir(ee,$n=Ut($n,Qe)),Qe.h)break;if(rr-D<$n||pe-rr<Dr)break e;for(En=0;En<Dr;++En)N[rr+En]=N[rr+En-$n];for(rr+=Dr,Oe+=Dr;Oe>=ee;)Oe-=ee,++Ce,be!=null&&Ce<=ge&&!(Ce%16)&&be(_,Ce);if(t(rr<=pe),Oe&Nr&&(Cr=re(Et,Oe,Ce)),tr!=null)for(;Je<rr;)Dr=N[Je++],tr.X[(506832829*Dr&4294967295)>>>tr.Mb]=Dr}else{if(!(Dr<Yt))break e;for(Gr=Dr-280,t(tr!=null);Je<rr;)Dr=N[Je++],tr.X[(506832829*Dr&4294967295)>>>tr.Mb]=Dr;Dr=rr,t(!(Gr>>>($n=tr).Xa)),N[Dr]=$n.X[Gr],Gr=!0}Gr||t(Qe.h==R(Qe))}if(_.Pb&&Qe.h&&rr<pe)t(_.m.h),_.a=5,_.m=_.wd,_.$=_.xd,0<_.s.ua&&Z(_.s.vb,_.s.Wa);else{if(Qe.h)break e;be!=null&&be(_,Ce>ge?ge:Ce),_.a=0,_.$=rr-D}return 1}return _.a=3,0}function rt(_){t(_!=null),_.vc=null,_.yc=null,_.Ya=null;var N=_.Wa;N!=null&&(N.X=null),_.vb=null,t(_!=null)}function De(){var _=new Vr;return _==null?null:(_.a=0,_.xb=V6,Fr("Predictor","VP8LPredictors"),Fr("Predictor","VP8LPredictors_C"),Fr("PredictorAdd","VP8LPredictorsAdd"),Fr("PredictorAdd","VP8LPredictorsAdd_C"),qn=_e,Jc=he,mc=ht,vo=Ge,fl=lt,hl=jt,gc=wt,P.VP8LMapColor32b=ea,P.VP8LMapColor8b=Qc,_)}function We(_,N,D,ee,pe){var ge=1,be=[_],Ce=[N],Oe=ee.m,Qe=ee.s,Et=null,rr=0;e:for(;;){if(D)for(;ge&&Y(Oe,1);){var Je=be,Lt=Ce,Yt=ee,_r=1,tr=Yt.m,Nr=Yt.gc[Yt.ab],Cr=Y(tr,2);if(Yt.Oc&1<<Cr)ge=0;else{switch(Yt.Oc|=1<<Cr,Nr.hc=Cr,Nr.Ea=Je[0],Nr.nc=Lt[0],Nr.K=[null],++Yt.ab,t(4>=Yt.ab),Cr){case 0:case 1:Nr.b=Y(tr,3)+2,_r=We(Ae(Nr.Ea,Nr.b),Ae(Nr.nc,Nr.b),0,Yt,Nr.K),Nr.K=Nr.K[0];break;case 3:var Gr,Dr=Y(tr,8)+1,$n=16<Dr?0:4<Dr?1:2<Dr?2:3;if(Je[0]=Ae(Nr.Ea,$n),Nr.b=$n,Gr=_r=We(Dr,1,0,Yt,Nr.K)){var En,ui=Dr,Mn=Nr,vi=1<<(8>>Mn.b),ks=s(vi);if(ks==null)Gr=0;else{var di=Mn.K[0],Ln=Mn.w;for(ks[0]=Mn.K[0][0],En=1;En<1*ui;++En)ks[En]=Be(di[Ln+En],ks[En-1]);for(;En<4*vi;++En)ks[En]=0;Mn.K[0]=null,Mn.K[0]=ks,Gr=1}}_r=Gr;break;case 2:break;default:t(0)}ge=_r}}if(be=be[0],Ce=Ce[0],ge&&Y(Oe,1)&&!(ge=1<=(rr=Y(Oe,4))&&11>=rr)){ee.a=3;break e}var pn;if(pn=ge)t:{var Qa,ni,wi,da=ee,eo=be,Go=Ce,Ba=rr,wo=D,Ko=da.m,js=da.s,ki=[null],$i=1,Ia=0,Ui=RK[Ba];r:for(;;){if(wo&&Y(Ko,1)){var to=Y(Ko,3)+2,eu=Ae(eo,to),Ja=Ae(Go,to),ml=eu*Ja;if(!We(eu,Ja,0,da,ki))break r;for(ki=ki[0],js.xc=to,Qa=0;Qa<ml;++Qa){var ra=ki[Qa]>>8&65535;ki[Qa]=ra,ra>=$i&&($i=ra+1)}}if(Ko.h)break r;for(ni=0;5>ni;++ni){var As=q6[ni];!ni&&0<Ba&&(As+=1<<Ba),Ia<As&&(Ia=As)}var Il=o($i*Ui,B),Yo=$i,Dl=o(Yo,U);if(Dl==null)var $l=null;else t(65536>=Yo),$l=Dl;var gl=s(Ia);if($l==null||gl==null||Il==null){da.a=1;break r}var Ul=Il;for(Qa=wi=0;Qa<$i;++Qa){var sa=$l[Qa],zl=sa.G,tu=sa.H,Ph=0,xd=1,ro=0;for(ni=0;5>ni;++ni){As=q6[ni],zl[ni]=Ul,tu[ni]=wi,!ni&&0<Ba&&(As+=1<<Ba);i:{var Xy,s5=As,Qy=da,Eg=gl,rY=Ul,nY=wi,o5=0,vf=Qy.m,iY=Y(vf,1);if(i(Eg,0,0,s5),iY){var aY=Y(vf,1)+1,sY=Y(vf,1),eT=Y(vf,sY==0?1:8);Eg[eT]=1,aY==2&&(Eg[eT=Y(vf,8)]=1);var Jy=1}else{var tT=s(19),rT=Y(vf,4)+4;if(19<rT){Qy.a=3;var Zy=0;break i}for(Xy=0;Xy<rT;++Xy)tT[MK[Xy]]=Y(vf,3);var l5=void 0,Tg=void 0,nT=Qy,oY=tT,eb=s5,iT=Eg,c5=0,wf=nT.m,aT=8,sT=o(128,B);n:for(;T(sT,0,7,oY,19);){if(Y(wf,1)){var lY=2+2*Y(wf,3);if((l5=2+Y(wf,lY))>eb)break n}else l5=eb;for(Tg=0;Tg<eb&&l5--;){V(wf);var oT=sT[0+(127&H(wf))];J(wf,wf.u+oT.g);var fp=oT.value;if(16>fp)iT[Tg++]=fp,fp!=0&&(aT=fp);else{var cY=fp==16,lT=fp-16,uY=PK[lT],cT=Y(wf,TK[lT])+uY;if(Tg+cT>eb)break n;for(var dY=cY?aT:0;0<cT--;)iT[Tg++]=dY}}c5=1;break n}c5||(nT.a=3),Jy=c5}(Jy=Jy&&!vf.h)&&(o5=T(rY,nY,8,Eg,s5)),Jy&&o5!=0?Zy=o5:(Qy.a=3,Zy=0)}if(Zy==0)break r;if(xd&&OK[ni]==1&&(xd=Ul[wi].g==0),Ph+=Ul[wi].g,wi+=Zy,3>=ni){var Pg,u5=gl[0];for(Pg=1;Pg<As;++Pg)gl[Pg]>u5&&(u5=gl[Pg]);ro+=u5}}if(sa.nd=xd,sa.Qb=0,xd&&(sa.qb=(zl[3][tu[3]+0].value<<24|zl[1][tu[1]+0].value<<16|zl[2][tu[2]+0].value)>>>0,Ph==0&&256>zl[0][tu[0]+0].value&&(sa.Qb=1,sa.qb+=zl[0][tu[0]+0].value<<8)),sa.jc=!sa.Qb&&6>ro,sa.jc){var tb,yd=sa;for(tb=0;tb<Fl;++tb){var Sf=tb,_f=yd.pd[Sf],rb=yd.G[0][yd.H[0]+Sf];256<=rb.value?(_f.g=rb.g+256,_f.value=rb.value):(_f.g=0,_f.value=0,Sf>>=vr(rb,8,_f),Sf>>=vr(yd.G[1][yd.H[1]+Sf],16,_f),Sf>>=vr(yd.G[2][yd.H[2]+Sf],0,_f),vr(yd.G[3][yd.H[3]+Sf],24,_f))}}}js.vc=ki,js.Wb=$i,js.Ya=$l,js.yc=Il,pn=1;break t}pn=0}if(!(ge=pn)){ee.a=3;break e}if(0<rr){if(Qe.ua=1<<rr,!I(Qe.Wa,rr)){ee.a=1,ge=0;break e}}else Qe.ua=0;var d5=ee,uT=be,fY=Ce,f5=d5.s,h5=f5.xc;if(d5.c=uT,d5.i=fY,f5.md=Ae(uT,h5),f5.wc=h5==0?-1:(1<<h5)-1,D){ee.xb=WK;break e}if((Et=s(be*Ce))==null){ee.a=1,ge=0;break e}ge=(ge=vt(ee,Et,0,be,Ce,Ce,null))&&!Oe.h;break e}return ge?(pe!=null?pe[0]=Et:(t(Et==null),t(D)),ee.$=0,D||rt(Qe)):rt(Qe),ge}function st(_,N){var D=_.c*_.i,ee=D+N+16*N;return t(_.c<=N),_.V=s(ee),_.V==null?(_.Ta=null,_.Ua=0,_.a=1,0):(_.Ta=_.V,_.Ua=_.Ba+D+N,1)}function zt(_,N){var D=_.C,ee=N-D,pe=_.V,ge=_.Ba+_.c*D;for(t(N<=_.l.o);0<ee;){var be=16<ee?16:ee,Ce=_.l.ma,Oe=_.l.width,Qe=Oe*be,Et=Ce.ca,rr=Ce.tb+Oe*D,Je=_.Ta,Lt=_.Ua;le(_,be,pe,ge),F6(Je,Lt,Et,rr,Qe),Ne(Ce,D,D+be,Et,rr,Oe),ee-=be,pe+=be*_.c,D+=be}t(D==N),_.C=_.Ma=N}function Wt(){this.ub=this.yd=this.td=this.Rb=0}function xt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Dt(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Vt(){this.Yb=function(){var _=[];return function N(D,ee,pe){for(var ge=pe[ee],be=0;be<ge&&(D.push(pe.length>ee+1?[]:0),!(pe.length<ee+1));be++)N(D[be],ee+1,pe)}(_,0,[3,11]),_}()}function gr(){this.jb=s(3),this.Wc=l([4,8],Vt),this.Xc=l([4,17],Vt)}function sr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Lr(){this.ld=this.La=this.dd=this.tc=0}function Zr(){this.Na=this.la=0}function Er(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function qt(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function zr(){this.uc=this.M=this.Nb=0,this.wa=Array(new Lr),this.Y=0,this.ya=Array(new qt),this.aa=0,this.l=new Tr}function bn(){this.y=s(16),this.f=s(8),this.ea=s(8)}function or(){this.cb=this.a=0,this.sc="",this.m=new C,this.Od=new Wt,this.Kc=new xt,this.ed=new sr,this.Qa=new Dt,this.Ic=this.$c=this.Aa=0,this.D=new zr,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,C),this.ia=0,this.pb=o(4,Er),this.Pa=new gr,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new bn),this.Hd=0,this.rb=Array(new Zr),this.sb=0,this.wa=Array(new Lr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new qt),this.L=this.aa=0,this.gd=l([4,2],Lr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function kr(_,N){return 0>_?0:_>N?N:_}function Tr(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Or(){var _=new or;return _!=null&&(_.a=0,_.sc="OK",_.cb=0,_.Xb=0,Ng||(Ng=Rt)),_}function Gt(_,N,D){return _.a==0&&(_.a=N,_.sc=D,_.cb=0),0}function ur(_,N,D){return 3<=D&&_[N+0]==157&&_[N+1]==1&&_[N+2]==42}function Ve(_,N){if(_==null)return 0;if(_.a=0,_.sc="OK",N==null)return Gt(_,2,"null VP8Io passed to VP8GetHeaders()");var D=N.data,ee=N.w,pe=N.ha;if(4>pe)return Gt(_,7,"Truncated header.");var ge=D[ee+0]|D[ee+1]<<8|D[ee+2]<<16,be=_.Od;if(be.Rb=!(1&ge),be.td=ge>>1&7,be.yd=ge>>4&1,be.ub=ge>>5,3<be.td)return Gt(_,3,"Incorrect keyframe parameters.");if(!be.yd)return Gt(_,4,"Frame not displayable.");ee+=3,pe-=3;var Ce=_.Kc;if(be.Rb){if(7>pe)return Gt(_,7,"cannot parse picture header");if(!ur(D,ee,pe))return Gt(_,3,"Bad code word");Ce.c=16383&(D[ee+4]<<8|D[ee+3]),Ce.Td=D[ee+4]>>6,Ce.i=16383&(D[ee+6]<<8|D[ee+5]),Ce.Ud=D[ee+6]>>6,ee+=7,pe-=7,_.za=Ce.c+15>>4,_.Ub=Ce.i+15>>4,N.width=Ce.c,N.height=Ce.i,N.Da=0,N.j=0,N.v=0,N.va=N.width,N.o=N.height,N.da=0,N.ib=N.width,N.hb=N.height,N.U=N.width,N.T=N.height,i((ge=_.Pa).jb,0,255,ge.jb.length),t((ge=_.Qa)!=null),ge.Cb=0,ge.Bb=0,ge.Fb=1,i(ge.Zb,0,0,ge.Zb.length),i(ge.Lb,0,0,ge.Lb)}if(be.ub>pe)return Gt(_,7,"bad partition length");se(ge=_.m,D,ee,be.ub),ee+=be.ub,pe-=be.ub,be.Rb&&(Ce.Ld=Q(ge),Ce.Kd=Q(ge)),Ce=_.Qa;var Oe,Qe=_.Pa;if(t(ge!=null),t(Ce!=null),Ce.Cb=Q(ge),Ce.Cb){if(Ce.Bb=Q(ge),Q(ge)){for(Ce.Fb=Q(ge),Oe=0;4>Oe;++Oe)Ce.Zb[Oe]=Q(ge)?z(ge,7):0;for(Oe=0;4>Oe;++Oe)Ce.Lb[Oe]=Q(ge)?z(ge,6):0}if(Ce.Bb)for(Oe=0;3>Oe;++Oe)Qe.jb[Oe]=Q(ge)?de(ge,8):255}else Ce.Bb=0;if(ge.Ka)return Gt(_,3,"cannot parse segment header");if((Ce=_.ed).zd=Q(ge),Ce.Tb=de(ge,6),Ce.wb=de(ge,3),Ce.Pc=Q(ge),Ce.Pc&&Q(ge)){for(Qe=0;4>Qe;++Qe)Q(ge)&&(Ce.vd[Qe]=z(ge,6));for(Qe=0;4>Qe;++Qe)Q(ge)&&(Ce.od[Qe]=z(ge,6))}if(_.L=Ce.Tb==0?0:Ce.zd?1:2,ge.Ka)return Gt(_,3,"cannot parse filter header");var Et=pe;if(pe=Oe=ee,ee=Oe+Et,Ce=Et,_.Xb=(1<<de(_.m,2))-1,Et<3*(Qe=_.Xb))D=7;else{for(Oe+=3*Qe,Ce-=3*Qe,Et=0;Et<Qe;++Et){var rr=D[pe+0]|D[pe+1]<<8|D[pe+2]<<16;rr>Ce&&(rr=Ce),se(_.Jc[+Et],D,Oe,rr),Oe+=rr,Ce-=rr,pe+=3}se(_.Jc[+Qe],D,Oe,Ce),D=Oe<ee?0:5}if(D!=0)return Gt(_,D,"cannot parse partitions");for(D=de(Oe=_.m,7),pe=Q(Oe)?z(Oe,4):0,ee=Q(Oe)?z(Oe,4):0,Ce=Q(Oe)?z(Oe,4):0,Qe=Q(Oe)?z(Oe,4):0,Oe=Q(Oe)?z(Oe,4):0,Et=_.Qa,rr=0;4>rr;++rr){if(Et.Cb){var Je=Et.Zb[rr];Et.Fb||(Je+=D)}else{if(0<rr){_.pb[rr]=_.pb[0];continue}Je=D}var Lt=_.pb[rr];Lt.Sc[0]=n5[kr(Je+pe,127)],Lt.Sc[1]=i5[kr(Je+0,127)],Lt.Eb[0]=2*n5[kr(Je+ee,127)],Lt.Eb[1]=101581*i5[kr(Je+Ce,127)]>>16,8>Lt.Eb[1]&&(Lt.Eb[1]=8),Lt.Qc[0]=n5[kr(Je+Qe,117)],Lt.Qc[1]=i5[kr(Je+Oe,127)],Lt.lc=Je+Oe}if(!be.Rb)return Gt(_,4,"Not a key frame.");for(Q(ge),be=_.Pa,D=0;4>D;++D){for(pe=0;8>pe;++pe)for(ee=0;3>ee;++ee)for(Ce=0;11>Ce;++Ce)Qe=ne(ge,UK[D][pe][ee][Ce])?de(ge,8):DK[D][pe][ee][Ce],be.Wc[D][pe].Yb[ee][Ce]=Qe;for(pe=0;17>pe;++pe)be.Xc[D][pe]=be.Wc[D][zK[pe]]}return _.kc=Q(ge),_.kc&&(_.Bd=de(ge,8)),_.cb=1}function Rt(_,N,D,ee,pe,ge,be){var Ce=N[pe].Yb[D];for(D=0;16>pe;++pe){if(!ne(_,Ce[D+0]))return pe;for(;!ne(_,Ce[D+1]);)if(Ce=N[++pe].Yb[0],D=0,pe==16)return 16;var Oe=N[pe+1].Yb;if(ne(_,Ce[D+2])){var Qe=_,Et=0;if(ne(Qe,(Je=Ce)[(rr=D)+3]))if(ne(Qe,Je[rr+6])){for(Ce=0,rr=2*(Et=ne(Qe,Je[rr+8]))+(Je=ne(Qe,Je[rr+9+Et])),Et=0,Je=BK[rr];Je[Ce];++Ce)Et+=Et+ne(Qe,Je[Ce]);Et+=3+(8<<rr)}else ne(Qe,Je[rr+7])?(Et=7+2*ne(Qe,165),Et+=ne(Qe,145)):Et=5+ne(Qe,159);else Et=ne(Qe,Je[rr+4])?3+ne(Qe,Je[rr+5]):2;Ce=Oe[2]}else Et=1,Ce=Oe[1];Oe=be+IK[pe],0>(Qe=_).b&&X(Qe);var rr,Je=Qe.b,Lt=(rr=Qe.Ca>>1)-(Qe.I>>Je)>>31;--Qe.b,Qe.Ca+=Lt,Qe.Ca|=1,Qe.I-=(rr+1&Lt)<<Je,ge[Oe]=((Et^Lt)-Lt)*ee[(0<pe)+0]}return 16}function _t(_){var N=_.rb[_.sb-1];N.la=0,N.Na=0,i(_.zc,0,0,_.zc.length),_.ja=0}function Xt(_,N,D,ee,pe){pe=_[N+D+32*ee]+(pe>>3),_[N+D+32*ee]=-256&pe?0>pe?0:255:pe}function Ue(_,N,D,ee,pe,ge){Xt(_,N,0,D,ee+pe),Xt(_,N,1,D,ee+ge),Xt(_,N,2,D,ee-ge),Xt(_,N,3,D,ee-pe)}function Ct(_){return(20091*_>>16)+_}function et(_,N,D,ee){var pe,ge=0,be=s(16);for(pe=0;4>pe;++pe){var Ce=_[N+0]+_[N+8],Oe=_[N+0]-_[N+8],Qe=(35468*_[N+4]>>16)-Ct(_[N+12]),Et=Ct(_[N+4])+(35468*_[N+12]>>16);be[ge+0]=Ce+Et,be[ge+1]=Oe+Qe,be[ge+2]=Oe-Qe,be[ge+3]=Ce-Et,ge+=4,N++}for(pe=ge=0;4>pe;++pe)Ce=(_=be[ge+0]+4)+be[ge+8],Oe=_-be[ge+8],Qe=(35468*be[ge+4]>>16)-Ct(be[ge+12]),Xt(D,ee,0,0,Ce+(Et=Ct(be[ge+4])+(35468*be[ge+12]>>16))),Xt(D,ee,1,0,Oe+Qe),Xt(D,ee,2,0,Oe-Qe),Xt(D,ee,3,0,Ce-Et),ge++,ee+=32}function ut(_,N,D,ee){var pe=_[N+0]+4,ge=35468*_[N+4]>>16,be=Ct(_[N+4]),Ce=35468*_[N+1]>>16;Ue(D,ee,0,pe+be,_=Ct(_[N+1]),Ce),Ue(D,ee,1,pe+ge,_,Ce),Ue(D,ee,2,pe-ge,_,Ce),Ue(D,ee,3,pe-be,_,Ce)}function Bt(_,N,D,ee,pe){et(_,N,D,ee),pe&&et(_,N+16,D,ee+4)}function Kt(_,N,D,ee){Cu(_,N+0,D,ee,1),Cu(_,N+32,D,ee+128,1)}function Jt(_,N,D,ee){var pe;for(_=_[N+0]+4,pe=0;4>pe;++pe)for(N=0;4>N;++N)Xt(D,ee,N,pe,_)}function ar(_,N,D,ee){_[N+0]&&Bi(_,N+0,D,ee),_[N+16]&&Bi(_,N+16,D,ee+4),_[N+32]&&Bi(_,N+32,D,ee+128),_[N+48]&&Bi(_,N+48,D,ee+128+4)}function nt(_,N,D,ee){var pe,ge=s(16);for(pe=0;4>pe;++pe){var be=_[N+0+pe]+_[N+12+pe],Ce=_[N+4+pe]+_[N+8+pe],Oe=_[N+4+pe]-_[N+8+pe],Qe=_[N+0+pe]-_[N+12+pe];ge[0+pe]=be+Ce,ge[8+pe]=be-Ce,ge[4+pe]=Qe+Oe,ge[12+pe]=Qe-Oe}for(pe=0;4>pe;++pe)be=(_=ge[0+4*pe]+3)+ge[3+4*pe],Ce=ge[1+4*pe]+ge[2+4*pe],Oe=ge[1+4*pe]-ge[2+4*pe],Qe=_-ge[3+4*pe],D[ee+0]=be+Ce>>3,D[ee+16]=Qe+Oe>>3,D[ee+32]=be-Ce>>3,D[ee+48]=Qe-Oe>>3,ee+=64}function Ht(_,N,D){var ee,pe=N-32,ge=Bl,be=255-_[pe-1];for(ee=0;ee<D;++ee){var Ce,Oe=ge,Qe=be+_[N-1];for(Ce=0;Ce<D;++Ce)_[N+Ce]=Oe[Qe+_[pe+Ce]];N+=32}}function Pe(_,N){Ht(_,N,4)}function Ot(_,N){Ht(_,N,8)}function mt(_,N){Ht(_,N,16)}function Nt(_,N){var D;for(D=0;16>D;++D)n(_,N+32*D,_,N-32,16)}function er(_,N){var D;for(D=16;0<D;--D)i(_,N,_[N-1],16),N+=32}function pr(_,N,D){var ee;for(ee=0;16>ee;++ee)i(N,D+32*ee,_,16)}function we(_,N){var D,ee=16;for(D=0;16>D;++D)ee+=_[N-1+32*D]+_[N+D-32];pr(ee>>5,_,N)}function Ie(_,N){var D,ee=8;for(D=0;16>D;++D)ee+=_[N-1+32*D];pr(ee>>4,_,N)}function Ze(_,N){var D,ee=8;for(D=0;16>D;++D)ee+=_[N+D-32];pr(ee>>4,_,N)}function bt(_,N){pr(128,_,N)}function St(_,N,D){return _+2*N+D+2>>2}function Sr(_,N){var D,ee=N-32;for(ee=new Uint8Array([St(_[ee-1],_[ee+0],_[ee+1]),St(_[ee+0],_[ee+1],_[ee+2]),St(_[ee+1],_[ee+2],_[ee+3]),St(_[ee+2],_[ee+3],_[ee+4])]),D=0;4>D;++D)n(_,N+32*D,ee,0,ee.length)}function Yr(_,N){var D=_[N-1],ee=_[N-1+32],pe=_[N-1+64],ge=_[N-1+96];oe(_,N+0,16843009*St(_[N-1-32],D,ee)),oe(_,N+32,16843009*St(D,ee,pe)),oe(_,N+64,16843009*St(ee,pe,ge)),oe(_,N+96,16843009*St(pe,ge,ge))}function ct(_,N){var D,ee=4;for(D=0;4>D;++D)ee+=_[N+D-32]+_[N-1+32*D];for(ee>>=3,D=0;4>D;++D)i(_,N+32*D,ee,4)}function $t(_,N){var D=_[N-1+0],ee=_[N-1+32],pe=_[N-1+64],ge=_[N-1-32],be=_[N+0-32],Ce=_[N+1-32],Oe=_[N+2-32],Qe=_[N+3-32];_[N+0+96]=St(ee,pe,_[N-1+96]),_[N+1+96]=_[N+0+64]=St(D,ee,pe),_[N+2+96]=_[N+1+64]=_[N+0+32]=St(ge,D,ee),_[N+3+96]=_[N+2+64]=_[N+1+32]=_[N+0+0]=St(be,ge,D),_[N+3+64]=_[N+2+32]=_[N+1+0]=St(Ce,be,ge),_[N+3+32]=_[N+2+0]=St(Oe,Ce,be),_[N+3+0]=St(Qe,Oe,Ce)}function qe(_,N){var D=_[N+1-32],ee=_[N+2-32],pe=_[N+3-32],ge=_[N+4-32],be=_[N+5-32],Ce=_[N+6-32],Oe=_[N+7-32];_[N+0+0]=St(_[N+0-32],D,ee),_[N+1+0]=_[N+0+32]=St(D,ee,pe),_[N+2+0]=_[N+1+32]=_[N+0+64]=St(ee,pe,ge),_[N+3+0]=_[N+2+32]=_[N+1+64]=_[N+0+96]=St(pe,ge,be),_[N+3+32]=_[N+2+64]=_[N+1+96]=St(ge,be,Ce),_[N+3+64]=_[N+2+96]=St(be,Ce,Oe),_[N+3+96]=St(Ce,Oe,Oe)}function Ye(_,N){var D=_[N-1+0],ee=_[N-1+32],pe=_[N-1+64],ge=_[N-1-32],be=_[N+0-32],Ce=_[N+1-32],Oe=_[N+2-32],Qe=_[N+3-32];_[N+0+0]=_[N+1+64]=ge+be+1>>1,_[N+1+0]=_[N+2+64]=be+Ce+1>>1,_[N+2+0]=_[N+3+64]=Ce+Oe+1>>1,_[N+3+0]=Oe+Qe+1>>1,_[N+0+96]=St(pe,ee,D),_[N+0+64]=St(ee,D,ge),_[N+0+32]=_[N+1+96]=St(D,ge,be),_[N+1+32]=_[N+2+96]=St(ge,be,Ce),_[N+2+32]=_[N+3+96]=St(be,Ce,Oe),_[N+3+32]=St(Ce,Oe,Qe)}function ot(_,N){var D=_[N+0-32],ee=_[N+1-32],pe=_[N+2-32],ge=_[N+3-32],be=_[N+4-32],Ce=_[N+5-32],Oe=_[N+6-32],Qe=_[N+7-32];_[N+0+0]=D+ee+1>>1,_[N+1+0]=_[N+0+64]=ee+pe+1>>1,_[N+2+0]=_[N+1+64]=pe+ge+1>>1,_[N+3+0]=_[N+2+64]=ge+be+1>>1,_[N+0+32]=St(D,ee,pe),_[N+1+32]=_[N+0+96]=St(ee,pe,ge),_[N+2+32]=_[N+1+96]=St(pe,ge,be),_[N+3+32]=_[N+2+96]=St(ge,be,Ce),_[N+3+64]=St(be,Ce,Oe),_[N+3+96]=St(Ce,Oe,Qe)}function $e(_,N){var D=_[N-1+0],ee=_[N-1+32],pe=_[N-1+64],ge=_[N-1+96];_[N+0+0]=D+ee+1>>1,_[N+2+0]=_[N+0+32]=ee+pe+1>>1,_[N+2+32]=_[N+0+64]=pe+ge+1>>1,_[N+1+0]=St(D,ee,pe),_[N+3+0]=_[N+1+32]=St(ee,pe,ge),_[N+3+32]=_[N+1+64]=St(pe,ge,ge),_[N+3+64]=_[N+2+64]=_[N+0+96]=_[N+1+96]=_[N+2+96]=_[N+3+96]=ge}function kt(_,N){var D=_[N-1+0],ee=_[N-1+32],pe=_[N-1+64],ge=_[N-1+96],be=_[N-1-32],Ce=_[N+0-32],Oe=_[N+1-32],Qe=_[N+2-32];_[N+0+0]=_[N+2+32]=D+be+1>>1,_[N+0+32]=_[N+2+64]=ee+D+1>>1,_[N+0+64]=_[N+2+96]=pe+ee+1>>1,_[N+0+96]=ge+pe+1>>1,_[N+3+0]=St(Ce,Oe,Qe),_[N+2+0]=St(be,Ce,Oe),_[N+1+0]=_[N+3+32]=St(D,be,Ce),_[N+1+32]=_[N+3+64]=St(ee,D,be),_[N+1+64]=_[N+3+96]=St(pe,ee,D),_[N+1+96]=St(ge,pe,ee)}function It(_,N){var D;for(D=0;8>D;++D)n(_,N+32*D,_,N-32,8)}function Zt(_,N){var D;for(D=0;8>D;++D)i(_,N,_[N-1],8),N+=32}function sn(_,N,D){var ee;for(ee=0;8>ee;++ee)i(N,D+32*ee,_,8)}function mn(_,N){var D,ee=8;for(D=0;8>D;++D)ee+=_[N+D-32]+_[N-1+32*D];sn(ee>>4,_,N)}function hn(_,N){var D,ee=4;for(D=0;8>D;++D)ee+=_[N+D-32];sn(ee>>3,_,N)}function Tn(_,N){var D,ee=4;for(D=0;8>D;++D)ee+=_[N-1+32*D];sn(ee>>3,_,N)}function Ir(_,N){sn(128,_,N)}function gn(_,N,D){var ee=_[N-D],pe=_[N+0],ge=3*(pe-ee)+J_[1020+_[N-2*D]-_[N+D]],be=Uy[112+(ge+4>>3)];_[N-D]=Bl[255+ee+Uy[112+(ge+3>>3)]],_[N+0]=Bl[255+pe-be]}function fn(_,N,D,ee){var pe=_[N+0],ge=_[N+D];return yc[255+_[N-2*D]-_[N-D]]>ee||yc[255+ge-pe]>ee}function ve(_,N,D,ee){return 4*yc[255+_[N-D]-_[N+0]]+yc[255+_[N-2*D]-_[N+D]]<=ee}function at(_,N,D,ee,pe){var ge=_[N-3*D],be=_[N-2*D],Ce=_[N-D],Oe=_[N+0],Qe=_[N+D],Et=_[N+2*D],rr=_[N+3*D];return 4*yc[255+Ce-Oe]+yc[255+be-Qe]>ee?0:yc[255+_[N-4*D]-ge]<=pe&&yc[255+ge-be]<=pe&&yc[255+be-Ce]<=pe&&yc[255+rr-Et]<=pe&&yc[255+Et-Qe]<=pe&&yc[255+Qe-Oe]<=pe}function Re(_,N,D,ee){var pe=2*ee+1;for(ee=0;16>ee;++ee)ve(_,N+ee,D,pe)&&gn(_,N+ee,D)}function dt(_,N,D,ee){var pe=2*ee+1;for(ee=0;16>ee;++ee)ve(_,N+ee*D,1,pe)&&gn(_,N+ee*D,1)}function Rr(_,N,D,ee){var pe;for(pe=3;0<pe;--pe)Re(_,N+=4*D,D,ee)}function nn(_,N,D,ee){var pe;for(pe=3;0<pe;--pe)dt(_,N+=4,D,ee)}function tn(_,N,D,ee,pe,ge,be,Ce){for(ge=2*ge+1;0<pe--;){if(at(_,N,D,ge,be))if(fn(_,N,D,Ce))gn(_,N,D);else{var Oe=_,Qe=N,Et=D,rr=Oe[Qe-2*Et],Je=Oe[Qe-Et],Lt=Oe[Qe+0],Yt=Oe[Qe+Et],_r=Oe[Qe+2*Et],tr=27*(Cr=J_[1020+3*(Lt-Je)+J_[1020+rr-Yt]])+63>>7,Nr=18*Cr+63>>7,Cr=9*Cr+63>>7;Oe[Qe-3*Et]=Bl[255+Oe[Qe-3*Et]+Cr],Oe[Qe-2*Et]=Bl[255+rr+Nr],Oe[Qe-Et]=Bl[255+Je+tr],Oe[Qe+0]=Bl[255+Lt-tr],Oe[Qe+Et]=Bl[255+Yt-Nr],Oe[Qe+2*Et]=Bl[255+_r-Cr]}N+=ee}}function _n(_,N,D,ee,pe,ge,be,Ce){for(ge=2*ge+1;0<pe--;){if(at(_,N,D,ge,be))if(fn(_,N,D,Ce))gn(_,N,D);else{var Oe=_,Qe=N,Et=D,rr=Oe[Qe-Et],Je=Oe[Qe+0],Lt=Oe[Qe+Et],Yt=Uy[112+(4+(_r=3*(Je-rr))>>3)],_r=Uy[112+(_r+3>>3)],tr=Yt+1>>1;Oe[Qe-2*Et]=Bl[255+Oe[Qe-2*Et]+tr],Oe[Qe-Et]=Bl[255+rr+_r],Oe[Qe+0]=Bl[255+Je-Yt],Oe[Qe+Et]=Bl[255+Lt-tr]}N+=ee}}function zn(_,N,D,ee,pe,ge){tn(_,N,D,1,16,ee,pe,ge)}function Hn(_,N,D,ee,pe,ge){tn(_,N,1,D,16,ee,pe,ge)}function ri(_,N,D,ee,pe,ge){var be;for(be=3;0<be;--be)_n(_,N+=4*D,D,1,16,ee,pe,ge)}function M(_,N,D,ee,pe,ge){var be;for(be=3;0<be;--be)_n(_,N+=4,1,D,16,ee,pe,ge)}function ce(_,N,D,ee,pe,ge,be,Ce){tn(_,N,pe,1,8,ge,be,Ce),tn(D,ee,pe,1,8,ge,be,Ce)}function Le(_,N,D,ee,pe,ge,be,Ce){tn(_,N,1,pe,8,ge,be,Ce),tn(D,ee,1,pe,8,ge,be,Ce)}function it(_,N,D,ee,pe,ge,be,Ce){_n(_,N+4*pe,pe,1,8,ge,be,Ce),_n(D,ee+4*pe,pe,1,8,ge,be,Ce)}function At(_,N,D,ee,pe,ge,be,Ce){_n(_,N+4,1,pe,8,ge,be,Ce),_n(D,ee+4,1,pe,8,ge,be,Ce)}function lr(){this.ba=new en,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Kr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function nr(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function yr(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Wr(){this.ua=0,this.Wa=new me,this.vb=new me,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new U,this.yc=new B}function Vr(){this.xb=this.a=0,this.l=new Tr,this.ca=new en,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new K,this.Pb=0,this.wd=new K,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Wr,this.ab=0,this.gc=o(4,yr),this.Oc=0}function dn(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Tr,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Pn(_,N,D,ee,pe,ge,be){for(_=_==null?0:_[N+0],N=0;N<be;++N)pe[ge+N]=_+D[ee+N]&255,_=pe[ge+N]}function li(_,N,D,ee,pe,ge,be){var Ce;if(_==null)Pn(null,null,D,ee,pe,ge,be);else for(Ce=0;Ce<be;++Ce)pe[ge+Ce]=_[N+Ce]+D[ee+Ce]&255}function fe(_,N,D,ee,pe,ge,be){if(_==null)Pn(null,null,D,ee,pe,ge,be);else{var Ce,Oe=_[N+0],Qe=Oe,Et=Oe;for(Ce=0;Ce<be;++Ce)Qe=Et+(Oe=_[N+Ce])-Qe,Et=D[ee+Ce]+(-256&Qe?0>Qe?0:255:Qe)&255,Qe=Oe,pe[ge+Ce]=Et}}function xe(_,N,D,ee){var pe=N.width,ge=N.o;if(t(_!=null&&N!=null),0>D||0>=ee||D+ee>ge)return null;if(!_.Cc){if(_.ga==null){var be;if(_.ga=new dn,(be=_.ga==null)||(be=N.width*N.o,t(_.Gb.length==0),_.Gb=s(be),_.Uc=0,_.Gb==null?be=0:(_.mb=_.Gb,_.nb=_.Uc,_.rc=null,be=1),be=!be),!be){be=_.ga;var Ce=_.Fa,Oe=_.P,Qe=_.qc,Et=_.mb,rr=_.nb,Je=Oe+1,Lt=Qe-1,Yt=be.l;if(t(Ce!=null&&Et!=null&&N!=null),bf[0]=null,bf[1]=Pn,bf[2]=li,bf[3]=fe,be.ca=Et,be.tb=rr,be.c=N.width,be.i=N.height,t(0<be.c&&0<be.i),1>=Qe)N=0;else if(be.$a=3&Ce[Oe+0],be.Z=Ce[Oe+0]>>2&3,be.Lc=Ce[Oe+0]>>4&3,Oe=Ce[Oe+0]>>6&3,0>be.$a||1<be.$a||4<=be.Z||1<be.Lc||Oe)N=0;else if(Yt.put=je,Yt.ac=Me,Yt.bc=Mt,Yt.ma=be,Yt.width=N.width,Yt.height=N.height,Yt.Da=N.Da,Yt.v=N.v,Yt.va=N.va,Yt.j=N.j,Yt.o=N.o,be.$a)e:{t(be.$a==1),N=De();t:for(;;){if(N==null){N=0;break e}if(t(be!=null),be.mc=N,N.c=be.c,N.i=be.i,N.l=be.l,N.l.ma=be,N.l.width=be.c,N.l.height=be.i,N.a=0,G(N.m,Ce,Je,Lt),!We(be.c,be.i,1,N,null)||(N.ab==1&&N.gc[0].hc==3&&ue(N.s)?(be.ic=1,Ce=N.c*N.i,N.Ta=null,N.Ua=0,N.V=s(Ce),N.Ba=0,N.V==null?(N.a=1,N=0):N=1):(be.ic=0,N=st(N,be.c)),!N))break t;N=1;break e}be.mc=null,N=0}else N=Lt>=be.c*be.i;be=!N}if(be)return null;_.ga.Lc!=1?_.Ga=0:ee=ge-D}t(_.ga!=null),t(D+ee<=ge);e:{if(N=(Ce=_.ga).c,ge=Ce.l.o,Ce.$a==0){if(Je=_.rc,Lt=_.Vc,Yt=_.Fa,Oe=_.P+1+D*N,Qe=_.mb,Et=_.nb+D*N,t(Oe<=_.P+_.qc),Ce.Z!=0)for(t(bf[Ce.Z]!=null),be=0;be<ee;++be)bf[Ce.Z](Je,Lt,Yt,Oe,Qe,Et,N),Je=Qe,Lt=Et,Et+=N,Oe+=N;else for(be=0;be<ee;++be)n(Qe,Et,Yt,Oe,N),Je=Qe,Lt=Et,Et+=N,Oe+=N;_.rc=Je,_.Vc=Lt}else{if(t(Ce.mc!=null),N=D+ee,t((be=Ce.mc)!=null),t(N<=be.i),be.C>=N)N=1;else if(Ce.ic||Ft(),Ce.ic){Ce=be.V,Je=be.Ba,Lt=be.c;var _r=be.i,tr=(Yt=1,Oe=be.$/Lt,Qe=be.$%Lt,Et=be.m,rr=be.s,be.$),Nr=Lt*_r,Cr=Lt*N,Gr=rr.wc,Dr=tr<Cr?re(rr,Qe,Oe):null;t(tr<=Nr),t(N<=_r),t(ue(rr));t:for(;;){for(;!Et.h&&tr<Cr;){if(Qe&Gr||(Dr=re(rr,Qe,Oe)),t(Dr!=null),V(Et),256>(_r=fr(Dr.G[0],Dr.H[0],Et)))Ce[Je+tr]=_r,++tr,++Qe>=Lt&&(Qe=0,++Oe<=N&&!(Oe%16)&&ke(be,Oe));else{if(!(280>_r)){Yt=0;break t}_r=Ut(_r-256,Et);var $n,En=fr(Dr.G[4],Dr.H[4],Et);if(V(Et),!(tr>=(En=ir(Lt,En=Ut(En,Et)))&&Nr-tr>=_r)){Yt=0;break t}for($n=0;$n<_r;++$n)Ce[Je+tr+$n]=Ce[Je+tr+$n-En];for(tr+=_r,Qe+=_r;Qe>=Lt;)Qe-=Lt,++Oe<=N&&!(Oe%16)&&ke(be,Oe);tr<Cr&&Qe&Gr&&(Dr=re(rr,Qe,Oe))}t(Et.h==R(Et))}ke(be,Oe>N?N:Oe);break t}!Yt||Et.h&&tr<Nr?(Yt=0,be.a=Et.h?5:3):be.$=tr,N=Yt}else N=vt(be,be.V,be.Ba,be.c,be.i,N,zt);if(!N){ee=0;break e}}D+ee>=ge&&(_.Cc=1),ee=1}if(!ee)return null;if(_.Cc&&((ee=_.ga)!=null&&(ee.mc=null),_.ga=null,0<_.Ga))return alert("todo:WebPDequantizeLevels"),null}return _.nb+D*pe}function Ke(_,N,D,ee,pe,ge){for(;0<pe--;){var be,Ce=_,Oe=N+(D?1:0),Qe=_,Et=N+(D?0:3);for(be=0;be<ee;++be){var rr=Qe[Et+4*be];rr!=255&&(rr*=32897,Ce[Oe+4*be+0]=Ce[Oe+4*be+0]*rr>>23,Ce[Oe+4*be+1]=Ce[Oe+4*be+1]*rr>>23,Ce[Oe+4*be+2]=Ce[Oe+4*be+2]*rr>>23)}N+=ge}}function Fe(_,N,D,ee,pe){for(;0<ee--;){var ge;for(ge=0;ge<D;++ge){var be=_[N+2*ge+0],Ce=15&(Qe=_[N+2*ge+1]),Oe=4369*Ce,Qe=(240&Qe|Qe>>4)*Oe>>16;_[N+2*ge+0]=(240&be|be>>4)*Oe>>16&240|(15&be|be<<4)*Oe>>16>>4&15,_[N+2*ge+1]=240&Qe|Ce}N+=pe}}function gt(_,N,D,ee,pe,ge,be,Ce){var Oe,Qe,Et=255;for(Qe=0;Qe<pe;++Qe){for(Oe=0;Oe<ee;++Oe){var rr=_[N+Oe];ge[be+4*Oe]=rr,Et&=rr}N+=D,be+=Ce}return Et!=255}function dr(_,N,D,ee,pe){var ge;for(ge=0;ge<pe;++ge)D[ee+ge]=_[N+ge]>>8}function Ft(){Ag=Ke,L6=Fe,R6=gt,F6=dr}function jr(_,N,D){P[_]=function(ee,pe,ge,be,Ce,Oe,Qe,Et,rr,Je,Lt,Yt,_r,tr,Nr,Cr,Gr){var Dr,$n=Gr-1>>1,En=Ce[Oe+0]|Qe[Et+0]<<16,ui=rr[Je+0]|Lt[Yt+0]<<16;t(ee!=null);var Mn=3*En+ui+131074>>2;for(N(ee[pe+0],255&Mn,Mn>>16,_r,tr),ge!=null&&(Mn=3*ui+En+131074>>2,N(ge[be+0],255&Mn,Mn>>16,Nr,Cr)),Dr=1;Dr<=$n;++Dr){var vi=Ce[Oe+Dr]|Qe[Et+Dr]<<16,ks=rr[Je+Dr]|Lt[Yt+Dr]<<16,di=En+vi+ui+ks+524296,Ln=di+2*(vi+ui)>>3;Mn=Ln+En>>1,En=(di=di+2*(En+ks)>>3)+vi>>1,N(ee[pe+2*Dr-1],255&Mn,Mn>>16,_r,tr+(2*Dr-1)*D),N(ee[pe+2*Dr-0],255&En,En>>16,_r,tr+(2*Dr-0)*D),ge!=null&&(Mn=di+ui>>1,En=Ln+ks>>1,N(ge[be+2*Dr-1],255&Mn,Mn>>16,Nr,Cr+(2*Dr-1)*D),N(ge[be+2*Dr+0],255&En,En>>16,Nr,Cr+(2*Dr+0)*D)),En=vi,ui=ks}1&Gr||(Mn=3*En+ui+131074>>2,N(ee[pe+Gr-1],255&Mn,Mn>>16,_r,tr+(Gr-1)*D),ge!=null&&(Mn=3*ui+En+131074>>2,N(ge[be+Gr-1],255&Mn,Mn>>16,Nr,Cr+(Gr-1)*D)))}}function Ar(){bc[zy]=qK,bc[Wy]=G6,bc[z6]=HK,bc[qy]=K6,bc[Hy]=Y6,bc[Z_]=X6,bc[W6]=VK,bc[e5]=G6,bc[t5]=K6,bc[Vy]=Y6,bc[r5]=X6}function qr(_){return _&-16384?0>_?0:255:_>>GK}function Qr(_,N){return qr((19077*_>>8)+(26149*N>>8)-14234)}function Ur(_,N,D){return qr((19077*_>>8)-(6419*N>>8)-(13320*D>>8)+8708)}function Xr(_,N){return qr((19077*_>>8)+(33050*N>>8)-17685)}function br(_,N,D,ee,pe){ee[pe+0]=Qr(_,D),ee[pe+1]=Ur(_,N,D),ee[pe+2]=Xr(_,N)}function Mr(_,N,D,ee,pe){ee[pe+0]=Xr(_,N),ee[pe+1]=Ur(_,N,D),ee[pe+2]=Qr(_,D)}function un(_,N,D,ee,pe){var ge=Ur(_,N,D);N=ge<<3&224|Xr(_,N)>>3,ee[pe+0]=248&Qr(_,D)|ge>>5,ee[pe+1]=N}function kn(_,N,D,ee,pe){var ge=240&Xr(_,N)|15;ee[pe+0]=240&Qr(_,D)|Ur(_,N,D)>>4,ee[pe+1]=ge}function vn(_,N,D,ee,pe){ee[pe+0]=255,br(_,N,D,ee,pe+1)}function Cn(_,N,D,ee,pe){Mr(_,N,D,ee,pe),ee[pe+3]=255}function In(_,N,D,ee,pe){br(_,N,D,ee,pe),ee[pe+3]=255}function Fn(_,N,D){P[_]=function(ee,pe,ge,be,Ce,Oe,Qe,Et,rr){for(var Je=Et+(-2&rr)*D;Et!=Je;)N(ee[pe+0],ge[be+0],Ce[Oe+0],Qe,Et),N(ee[pe+1],ge[be+0],Ce[Oe+0],Qe,Et+D),pe+=2,++be,++Oe,Et+=2*D;1&rr&&N(ee[pe+0],ge[be+0],Ce[Oe+0],Qe,Et)}}function ci(_,N,D){return D==0?_==0?N==0?6:5:N==0?4:0:D}function xi(_,N,D,ee,pe){switch(_>>>30){case 3:Cu(N,D,ee,pe,0);break;case 2:xc(N,D,ee,pe);break;case 1:Bi(N,D,ee,pe)}}function Fi(_,N){var D,ee,pe=N.M,ge=N.Nb,be=_.oc,Ce=_.pc+40,Oe=_.oc,Qe=_.pc+584,Et=_.oc,rr=_.pc+600;for(D=0;16>D;++D)be[Ce+32*D-1]=129;for(D=0;8>D;++D)Oe[Qe+32*D-1]=129,Et[rr+32*D-1]=129;for(0<pe?be[Ce-1-32]=Oe[Qe-1-32]=Et[rr-1-32]=129:(i(be,Ce-32-1,127,21),i(Oe,Qe-32-1,127,9),i(Et,rr-32-1,127,9)),ee=0;ee<_.za;++ee){var Je=N.ya[N.aa+ee];if(0<ee){for(D=-1;16>D;++D)n(be,Ce+32*D-4,be,Ce+32*D+12,4);for(D=-1;8>D;++D)n(Oe,Qe+32*D-4,Oe,Qe+32*D+4,4),n(Et,rr+32*D-4,Et,rr+32*D+4,4)}var Lt=_.Gd,Yt=_.Hd+ee,_r=Je.ad,tr=Je.Hc;if(0<pe&&(n(be,Ce-32,Lt[Yt].y,0,16),n(Oe,Qe-32,Lt[Yt].f,0,8),n(Et,rr-32,Lt[Yt].ea,0,8)),Je.Za){var Nr=be,Cr=Ce-32+16;for(0<pe&&(ee>=_.za-1?i(Nr,Cr,Lt[Yt].y[15],4):n(Nr,Cr,Lt[Yt+1].y,0,4)),D=0;4>D;D++)Nr[Cr+128+D]=Nr[Cr+256+D]=Nr[Cr+384+D]=Nr[Cr+0+D];for(D=0;16>D;++D,tr<<=2)Nr=be,Cr=Ce+J6[D],Zc[Je.Ob[D]](Nr,Cr),xi(tr,_r,16*+D,Nr,Cr)}else if(Nr=ci(ee,pe,Je.Ob[0]),yf[Nr](be,Ce),tr!=0)for(D=0;16>D;++D,tr<<=2)xi(tr,_r,16*+D,be,Ce+J6[D]);for(D=Je.Gc,Nr=ci(ee,pe,Je.Dd),gd[Nr](Oe,Qe),gd[Nr](Et,rr),tr=_r,Nr=Oe,Cr=Qe,255&(Je=0|D)&&(170&Je?Eu(tr,256,Nr,Cr):ta(tr,256,Nr,Cr)),Je=Et,tr=rr,255&(D>>=8)&&(170&D?Eu(_r,320,Je,tr):ta(_r,320,Je,tr)),pe<_.Ub-1&&(n(Lt[Yt].y,0,be,Ce+480,16),n(Lt[Yt].f,0,Oe,Qe+224,8),n(Lt[Yt].ea,0,Et,rr+224,8)),D=8*ge*_.B,Lt=_.sa,Yt=_.ta+16*ee+16*ge*_.R,_r=_.qa,Je=_.ra+8*ee+D,tr=_.Ha,Nr=_.Ia+8*ee+D,D=0;16>D;++D)n(Lt,Yt+D*_.R,be,Ce+32*D,16);for(D=0;8>D;++D)n(_r,Je+D*_.B,Oe,Qe+32*D,8),n(tr,Nr+D*_.B,Et,rr+32*D,8)}}function Ho(_,N,D,ee,pe,ge,be,Ce,Oe){var Qe=[0],Et=[0],rr=0,Je=Oe!=null?Oe.kd:0,Lt=Oe??new nr;if(_==null||12>D)return 7;Lt.data=_,Lt.w=N,Lt.ha=D,N=[N],D=[D],Lt.gb=[Lt.gb];e:{var Yt=N,_r=D,tr=Lt.gb;if(t(_!=null),t(_r!=null),t(tr!=null),tr[0]=0,12<=_r[0]&&!r(_,Yt[0],"RIFF")){if(r(_,Yt[0]+8,"WEBP")){tr=3;break e}var Nr=ae(_,Yt[0]+4);if(12>Nr||4294967286<Nr){tr=3;break e}if(Je&&Nr>_r[0]-8){tr=7;break e}tr[0]=Nr,Yt[0]+=12,_r[0]-=12}tr=0}if(tr!=0)return tr;for(Nr=0<Lt.gb[0],D=D[0];;){e:{var Cr=_;_r=N,tr=D;var Gr=Qe,Dr=Et,$n=Yt=[0];if((Mn=rr=[rr])[0]=0,8>tr[0])tr=7;else{if(!r(Cr,_r[0],"VP8X")){if(ae(Cr,_r[0]+4)!=10){tr=3;break e}if(18>tr[0]){tr=7;break e}var En=ae(Cr,_r[0]+8),ui=1+W(Cr,_r[0]+12);if(2147483648<=ui*(Cr=1+W(Cr,_r[0]+15))){tr=3;break e}$n!=null&&($n[0]=En),Gr!=null&&(Gr[0]=ui),Dr!=null&&(Dr[0]=Cr),_r[0]+=18,tr[0]-=18,Mn[0]=1}tr=0}}if(rr=rr[0],Yt=Yt[0],tr!=0)return tr;if(_r=!!(2&Yt),!Nr&&rr)return 3;if(ge!=null&&(ge[0]=!!(16&Yt)),be!=null&&(be[0]=_r),Ce!=null&&(Ce[0]=0),be=Qe[0],Yt=Et[0],rr&&_r&&Oe==null){tr=0;break}if(4>D){tr=7;break}if(Nr&&rr||!Nr&&!rr&&!r(_,N[0],"ALPH")){D=[D],Lt.na=[Lt.na],Lt.P=[Lt.P],Lt.Sa=[Lt.Sa];e:{En=_,tr=N,Nr=D;var Mn=Lt.gb;Gr=Lt.na,Dr=Lt.P,$n=Lt.Sa,ui=22,t(En!=null),t(Nr!=null),Cr=tr[0];var vi=Nr[0];for(t(Gr!=null),t($n!=null),Gr[0]=null,Dr[0]=null,$n[0]=0;;){if(tr[0]=Cr,Nr[0]=vi,8>vi){tr=7;break e}var ks=ae(En,Cr+4);if(4294967286<ks){tr=3;break e}var di=8+ks+1&-2;if(ui+=di,0<Mn&&ui>Mn){tr=3;break e}if(!r(En,Cr,"VP8 ")||!r(En,Cr,"VP8L")){tr=0;break e}if(vi[0]<di){tr=7;break e}r(En,Cr,"ALPH")||(Gr[0]=En,Dr[0]=Cr+8,$n[0]=ks),Cr+=di,vi-=di}}if(D=D[0],Lt.na=Lt.na[0],Lt.P=Lt.P[0],Lt.Sa=Lt.Sa[0],tr!=0)break}D=[D],Lt.Ja=[Lt.Ja],Lt.xa=[Lt.xa];e:if(Mn=_,tr=N,Nr=D,Gr=Lt.gb[0],Dr=Lt.Ja,$n=Lt.xa,En=tr[0],Cr=!r(Mn,En,"VP8 "),ui=!r(Mn,En,"VP8L"),t(Mn!=null),t(Nr!=null),t(Dr!=null),t($n!=null),8>Nr[0])tr=7;else{if(Cr||ui){if(Mn=ae(Mn,En+4),12<=Gr&&Mn>Gr-12){tr=3;break e}if(Je&&Mn>Nr[0]-8){tr=7;break e}Dr[0]=Mn,tr[0]+=8,Nr[0]-=8,$n[0]=ui}else $n[0]=5<=Nr[0]&&Mn[En+0]==47&&!(Mn[En+4]>>5),Dr[0]=Nr[0];tr=0}if(D=D[0],Lt.Ja=Lt.Ja[0],Lt.xa=Lt.xa[0],N=N[0],tr!=0)break;if(4294967286<Lt.Ja)return 3;if(Ce==null||_r||(Ce[0]=Lt.xa?2:1),be=[be],Yt=[Yt],Lt.xa){if(5>D){tr=7;break}Ce=be,Je=Yt,_r=ge,_==null||5>D?_=0:5<=D&&_[N+0]==47&&!(_[N+4]>>5)?(Nr=[0],Mn=[0],Gr=[0],G(Dr=new K,_,N,D),pt(Dr,Nr,Mn,Gr)?(Ce!=null&&(Ce[0]=Nr[0]),Je!=null&&(Je[0]=Mn[0]),_r!=null&&(_r[0]=Gr[0]),_=1):_=0):_=0}else{if(10>D){tr=7;break}Ce=Yt,_==null||10>D||!ur(_,N+3,D-3)?_=0:(Je=_[N+0]|_[N+1]<<8|_[N+2]<<16,_r=16383&(_[N+7]<<8|_[N+6]),_=16383&(_[N+9]<<8|_[N+8]),1&Je||3<(Je>>1&7)||!(Je>>4&1)||Je>>5>=Lt.Ja||!_r||!_?_=0:(be&&(be[0]=_r),Ce&&(Ce[0]=_),_=1))}if(!_||(be=be[0],Yt=Yt[0],rr&&(Qe[0]!=be||Et[0]!=Yt)))return 3;Oe!=null&&(Oe[0]=Lt,Oe.offset=N-Oe.w,t(4294967286>N-Oe.w),t(Oe.offset==Oe.ha-D));break}return tr==0||tr==7&&rr&&Oe==null?(ge!=null&&(ge[0]|=Lt.na!=null&&0<Lt.na.length),ee!=null&&(ee[0]=be),pe!=null&&(pe[0]=Yt),0):tr}function Vo(_,N,D){var ee=N.width,pe=N.height,ge=0,be=0,Ce=ee,Oe=pe;if(N.Da=_!=null&&0<_.Da,N.Da&&(Ce=_.cd,Oe=_.bd,ge=_.v,be=_.j,11>D||(ge&=-2,be&=-2),0>ge||0>be||0>=Ce||0>=Oe||ge+Ce>ee||be+Oe>pe))return 0;if(N.v=ge,N.j=be,N.va=ge+Ce,N.o=be+Oe,N.U=Ce,N.T=Oe,N.da=_!=null&&0<_.da,N.da){if(!Te(Ce,Oe,D=[_.ib],ge=[_.hb]))return 0;N.ib=D[0],N.hb=ge[0]}return N.ob=_!=null&&_.ob,N.Kb=_==null||!_.Sd,N.da&&(N.ob=N.ib<3*ee/4&&N.hb<3*pe/4,N.Kb=0),1}function Rl(_){if(_==null)return 2;if(11>_.S){var N=_.f.RGBA;N.fb+=(_.height-1)*N.A,N.A=-N.A}else N=_.f.kb,_=_.height,N.O+=(_-1)*N.fa,N.fa=-N.fa,N.N+=(_-1>>1)*N.Ab,N.Ab=-N.Ab,N.W+=(_-1>>1)*N.Db,N.Db=-N.Db,N.F!=null&&(N.J+=(_-1)*N.lb,N.lb=-N.lb);return 0}function Zs(_,N,D,ee){if(ee==null||0>=_||0>=N)return 2;if(D!=null){if(D.Da){var pe=D.cd,ge=D.bd,be=-2&D.v,Ce=-2&D.j;if(0>be||0>Ce||0>=pe||0>=ge||be+pe>_||Ce+ge>N)return 2;_=pe,N=ge}if(D.da){if(!Te(_,N,pe=[D.ib],ge=[D.hb]))return 2;_=pe[0],N=ge[0]}}ee.width=_,ee.height=N;e:{var Oe=ee.width,Qe=ee.height;if(_=ee.S,0>=Oe||0>=Qe||!(_>=zy&&13>_))_=2;else{if(0>=ee.Rd&&ee.sd==null){be=ge=pe=N=0;var Et=(Ce=Oe*Z6[_])*Qe;if(11>_||(ge=(Qe+1)/2*(N=(Oe+1)/2),_==12&&(be=(pe=Oe)*Qe)),(Qe=s(Et+2*ge+be))==null){_=1;break e}ee.sd=Qe,11>_?((Oe=ee.f.RGBA).eb=Qe,Oe.fb=0,Oe.A=Ce,Oe.size=Et):((Oe=ee.f.kb).y=Qe,Oe.O=0,Oe.fa=Ce,Oe.Fd=Et,Oe.f=Qe,Oe.N=0+Et,Oe.Ab=N,Oe.Cd=ge,Oe.ea=Qe,Oe.W=0+Et+ge,Oe.Db=N,Oe.Ed=ge,_==12&&(Oe.F=Qe,Oe.J=0+Et+2*ge),Oe.Tc=be,Oe.lb=pe)}if(N=1,pe=ee.S,ge=ee.width,be=ee.height,pe>=zy&&13>pe)if(11>pe)_=ee.f.RGBA,N&=(Ce=Math.abs(_.A))*(be-1)+ge<=_.size,N&=Ce>=ge*Z6[pe],N&=_.eb!=null;else{_=ee.f.kb,Ce=(ge+1)/2,Et=(be+1)/2,Oe=Math.abs(_.fa),Qe=Math.abs(_.Ab);var rr=Math.abs(_.Db),Je=Math.abs(_.lb),Lt=Je*(be-1)+ge;N&=Oe*(be-1)+ge<=_.Fd,N&=Qe*(Et-1)+Ce<=_.Cd,N=(N&=rr*(Et-1)+Ce<=_.Ed)&Oe>=ge&Qe>=Ce&rr>=Ce,N&=_.y!=null,N&=_.f!=null,N&=_.ea!=null,pe==12&&(N&=Je>=ge,N&=Lt<=_.Tc,N&=_.F!=null)}else N=0;_=N?0:2}}return _!=0||D!=null&&D.fd&&(_=Rl(ee)),_}var Fl=64,Ya=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Zi=24,Di=32,ba=8,cs=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ee("Predictor0","PredictorAdd0"),P.Predictor0=function(){return 4278190080},P.Predictor1=function(_){return _},P.Predictor2=function(_,N,D){return N[D+0]},P.Predictor3=function(_,N,D){return N[D+1]},P.Predictor4=function(_,N,D){return N[D-1]},P.Predictor5=function(_,N,D){return Xe(Xe(_,N[D+1]),N[D+0])},P.Predictor6=function(_,N,D){return Xe(_,N[D-1])},P.Predictor7=function(_,N,D){return Xe(_,N[D+0])},P.Predictor8=function(_,N,D){return Xe(N[D-1],N[D+0])},P.Predictor9=function(_,N,D){return Xe(N[D+0],N[D+1])},P.Predictor10=function(_,N,D){return Xe(Xe(_,N[D-1]),Xe(N[D+0],N[D+1]))},P.Predictor11=function(_,N,D){var ee=N[D+0];return 0>=He(ee>>24&255,_>>24&255,(N=N[D-1])>>24&255)+He(ee>>16&255,_>>16&255,N>>16&255)+He(ee>>8&255,_>>8&255,N>>8&255)+He(255&ee,255&_,255&N)?ee:_},P.Predictor12=function(_,N,D){var ee=N[D+0];return(Pt((_>>24&255)+(ee>>24&255)-((N=N[D-1])>>24&255))<<24|Pt((_>>16&255)+(ee>>16&255)-(N>>16&255))<<16|Pt((_>>8&255)+(ee>>8&255)-(N>>8&255))<<8|Pt((255&_)+(255&ee)-(255&N)))>>>0},P.Predictor13=function(_,N,D){var ee=N[D-1];return(ft((_=Xe(_,N[D+0]))>>24&255,ee>>24&255)<<24|ft(_>>16&255,ee>>16&255)<<16|ft(_>>8&255,ee>>8&255)<<8|ft(255&_,255&ee))>>>0};var Yc=P.PredictorAdd0;P.PredictorAdd1=tt,Ee("Predictor2","PredictorAdd2"),Ee("Predictor3","PredictorAdd3"),Ee("Predictor4","PredictorAdd4"),Ee("Predictor5","PredictorAdd5"),Ee("Predictor6","PredictorAdd6"),Ee("Predictor7","PredictorAdd7"),Ee("Predictor8","PredictorAdd8"),Ee("Predictor9","PredictorAdd9"),Ee("Predictor10","PredictorAdd10"),Ee("Predictor11","PredictorAdd11"),Ee("Predictor12","PredictorAdd12"),Ee("Predictor13","PredictorAdd13");var Xc=P.PredictorAdd2;ye("ColorIndexInverseTransform","MapARGB","32b",function(_){return _>>8&255},function(_){return _}),ye("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(_){return _},function(_){return _>>8&255});var qn,_i=P.ColorIndexInverseTransform,ea=P.MapARGB,bo=P.VP8LColorIndexInverseTransformAlpha,Qc=P.MapAlpha,pc=P.VP8LPredictorsAdd=[];pc.length=16,(P.VP8LPredictors=[]).length=16,(P.VP8LPredictorsAdd_C=[]).length=16,(P.VP8LPredictors_C=[]).length=16;var Jc,mc,vo,fl,hl,gc,pl,Cu,xc,Eu,Bi,ta,Xa,_s,md,jg,dp,$y,C6,E6,T6,P6,O6,M6,Ag,L6,R6,F6,B6=s(511),I6=s(2041),D6=s(225),$6=s(767),U6=0,J_=I6,Uy=D6,Bl=$6,yc=B6,zy=0,Wy=1,z6=2,qy=3,Hy=4,Z_=5,W6=6,e5=7,t5=8,Vy=9,r5=10,TK=[2,3,7],PK=[3,3,11],q6=[280,256,256,256,40],OK=[0,1,1,1,0],MK=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],LK=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],RK=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],FK=8,n5=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],i5=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Ng=null,BK=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],IK=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],H6=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],DK=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],$K=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],UK=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],zK=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],yf=[],Zc=[],gd=[],WK=1,V6=2,bf=[],bc=[];jr("UpsampleRgbLinePair",br,3),jr("UpsampleBgrLinePair",Mr,3),jr("UpsampleRgbaLinePair",In,4),jr("UpsampleBgraLinePair",Cn,4),jr("UpsampleArgbLinePair",vn,4),jr("UpsampleRgba4444LinePair",kn,2),jr("UpsampleRgb565LinePair",un,2);var qK=P.UpsampleRgbLinePair,HK=P.UpsampleBgrLinePair,G6=P.UpsampleRgbaLinePair,K6=P.UpsampleBgraLinePair,Y6=P.UpsampleArgbLinePair,X6=P.UpsampleRgba4444LinePair,VK=P.UpsampleRgb565LinePair,Gy=16,Ky=1<<Gy-1,Cg=-227,a5=482,GK=6,Q6=0,KK=s(256),YK=s(256),XK=s(256),QK=s(256),JK=s(a5-Cg),ZK=s(a5-Cg);Fn("YuvToRgbRow",br,3),Fn("YuvToBgrRow",Mr,3),Fn("YuvToRgbaRow",In,4),Fn("YuvToBgraRow",Cn,4),Fn("YuvToArgbRow",vn,4),Fn("YuvToRgba4444Row",kn,2),Fn("YuvToRgb565Row",un,2);var J6=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Yy=[0,2,8],eY=[8,7,6,4,4,2,2,2,1,1,1,1],tY=1;this.WebPDecodeRGBA=function(_,N,D,ee,pe){var ge=Wy,be=new lr,Ce=new en;be.ba=Ce,Ce.S=ge,Ce.width=[Ce.width],Ce.height=[Ce.height];var Oe=Ce.width,Qe=Ce.height,Et=new $r;if(Et==null||_==null)var rr=2;else t(Et!=null),rr=Ho(_,N,D,Et.width,Et.height,Et.Pd,Et.Qd,Et.format,null);if(rr!=0?Oe=0:(Oe!=null&&(Oe[0]=Et.width[0]),Qe!=null&&(Qe[0]=Et.height[0]),Oe=1),Oe){Ce.width=Ce.width[0],Ce.height=Ce.height[0],ee!=null&&(ee[0]=Ce.width),pe!=null&&(pe[0]=Ce.height);e:{if(ee=new Tr,(pe=new nr).data=_,pe.w=N,pe.ha=D,pe.kd=1,N=[0],t(pe!=null),((_=Ho(pe.data,pe.w,pe.ha,null,null,null,N,null,pe))==0||_==7)&&N[0]&&(_=4),(N=_)==0){if(t(be!=null),ee.data=pe.data,ee.w=pe.w+pe.offset,ee.ha=pe.ha-pe.offset,ee.put=je,ee.ac=Me,ee.bc=Mt,ee.ma=be,pe.xa){if((_=De())==null){be=1;break e}if(function(Je,Lt){var Yt=[0],_r=[0],tr=[0];t:for(;;){if(Je==null)return 0;if(Lt==null)return Je.a=2,0;if(Je.l=Lt,Je.a=0,G(Je.m,Lt.data,Lt.w,Lt.ha),!pt(Je.m,Yt,_r,tr)){Je.a=3;break t}if(Je.xb=V6,Lt.width=Yt[0],Lt.height=_r[0],!We(Yt[0],_r[0],1,Je,null))break t;return 1}return t(Je.a!=0),0}(_,ee)){if(ee=(N=Zs(ee.width,ee.height,be.Oa,be.ba))==0){t:{ee=_;r:for(;;){if(ee==null){ee=0;break t}if(t(ee.s.yc!=null),t(ee.s.Ya!=null),t(0<ee.s.Wb),t((D=ee.l)!=null),t((pe=D.ma)!=null),ee.xb!=0){if(ee.ca=pe.ba,ee.tb=pe.tb,t(ee.ca!=null),!Vo(pe.Oa,D,qy)){ee.a=2;break r}if(!st(ee,D.width)||D.da)break r;if((D.da||Tt(ee.ca.S))&&Ft(),11>ee.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),ee.ca.f.kb.F!=null&&Ft()),ee.Pb&&0<ee.s.ua&&ee.s.vb.X==null&&!I(ee.s.vb,ee.s.Wa.Xa)){ee.a=1;break r}ee.xb=0}if(!vt(ee,ee.V,ee.Ba,ee.c,ee.i,D.o,te))break r;pe.Dc=ee.Ma,ee=1;break t}t(ee.a!=0),ee=0}ee=!ee}ee&&(N=_.a)}else N=_.a}else{if((_=new Or)==null){be=1;break e}if(_.Fa=pe.na,_.P=pe.P,_.qc=pe.Sa,Ve(_,ee)){if((N=Zs(ee.width,ee.height,be.Oa,be.ba))==0){if(_.Aa=0,D=be.Oa,t((pe=_)!=null),D!=null){if(0<(Oe=0>(Oe=D.Md)?0:100<Oe?255:255*Oe/100)){for(Qe=Et=0;4>Qe;++Qe)12>(rr=pe.pb[Qe]).lc&&(rr.ia=Oe*eY[0>rr.lc?0:rr.lc]>>3),Et|=rr.ia;Et&&(alert("todo:VP8InitRandom"),pe.ia=1)}pe.Ga=D.Id,100<pe.Ga?pe.Ga=100:0>pe.Ga&&(pe.Ga=0)}(function(Je,Lt){if(Je==null)return 0;if(Lt==null)return Gt(Je,2,"NULL VP8Io parameter in VP8Decode().");if(!Je.cb&&!Ve(Je,Lt))return 0;if(t(Je.cb),Lt.ac==null||Lt.ac(Lt)){Lt.ob&&(Je.L=0);var Yt=Yy[Je.L];if(Je.L==2?(Je.yb=0,Je.zb=0):(Je.yb=Lt.v-Yt>>4,Je.zb=Lt.j-Yt>>4,0>Je.yb&&(Je.yb=0),0>Je.zb&&(Je.zb=0)),Je.Va=Lt.o+15+Yt>>4,Je.Hb=Lt.va+15+Yt>>4,Je.Hb>Je.za&&(Je.Hb=Je.za),Je.Va>Je.Ub&&(Je.Va=Je.Ub),0<Je.L){var _r=Je.ed;for(Yt=0;4>Yt;++Yt){var tr;if(Je.Qa.Cb){var Nr=Je.Qa.Lb[Yt];Je.Qa.Fb||(Nr+=_r.Tb)}else Nr=_r.Tb;for(tr=0;1>=tr;++tr){var Cr=Je.gd[Yt][tr],Gr=Nr;if(_r.Pc&&(Gr+=_r.vd[0],tr&&(Gr+=_r.od[0])),0<(Gr=0>Gr?0:63<Gr?63:Gr)){var Dr=Gr;0<_r.wb&&(Dr=4<_r.wb?Dr>>2:Dr>>1)>9-_r.wb&&(Dr=9-_r.wb),1>Dr&&(Dr=1),Cr.dd=Dr,Cr.tc=2*Gr+Dr,Cr.ld=40<=Gr?2:15<=Gr?1:0}else Cr.tc=0;Cr.La=tr}}}Yt=0}else Gt(Je,6,"Frame setup failed"),Yt=Je.a;if(Yt=Yt==0){if(Yt){Je.$c=0,0<Je.Aa||(Je.Ic=tY);t:{Yt=Je.Ic,_r=4*(Dr=Je.za);var $n=32*Dr,En=Dr+1,ui=0<Je.L?Dr*(0<Je.Aa?2:1):0,Mn=(Je.Aa==2?2:1)*Dr;if((Cr=_r+832+(tr=3*(16*Yt+Yy[Je.L])/2*$n)+(Nr=Je.Fa!=null&&0<Je.Fa.length?Je.Kc.c*Je.Kc.i:0))!=Cr)Yt=0;else{if(Cr>Je.Vb){if(Je.Vb=0,Je.Ec=s(Cr),Je.Fc=0,Je.Ec==null){Yt=Gt(Je,1,"no memory during frame initialization.");break t}Je.Vb=Cr}Cr=Je.Ec,Gr=Je.Fc,Je.Ac=Cr,Je.Bc=Gr,Gr+=_r,Je.Gd=o($n,bn),Je.Hd=0,Je.rb=o(En+1,Zr),Je.sb=1,Je.wa=ui?o(ui,Lr):null,Je.Y=0,Je.D.Nb=0,Je.D.wa=Je.wa,Je.D.Y=Je.Y,0<Je.Aa&&(Je.D.Y+=Dr),t(!0),Je.oc=Cr,Je.pc=Gr,Gr+=832,Je.ya=o(Mn,qt),Je.aa=0,Je.D.ya=Je.ya,Je.D.aa=Je.aa,Je.Aa==2&&(Je.D.aa+=Dr),Je.R=16*Dr,Je.B=8*Dr,Dr=($n=Yy[Je.L])*Je.R,$n=$n/2*Je.B,Je.sa=Cr,Je.ta=Gr+Dr,Je.qa=Je.sa,Je.ra=Je.ta+16*Yt*Je.R+$n,Je.Ha=Je.qa,Je.Ia=Je.ra+8*Yt*Je.B+$n,Je.$c=0,Gr+=tr,Je.mb=Nr?Cr:null,Je.nb=Nr?Gr:null,t(Gr+Nr<=Je.Fc+Je.Vb),_t(Je),i(Je.Ac,Je.Bc,0,_r),Yt=1}}if(Yt){if(Lt.ka=0,Lt.y=Je.sa,Lt.O=Je.ta,Lt.f=Je.qa,Lt.N=Je.ra,Lt.ea=Je.Ha,Lt.Vd=Je.Ia,Lt.fa=Je.R,Lt.Rc=Je.B,Lt.F=null,Lt.J=0,!U6){for(Yt=-255;255>=Yt;++Yt)B6[255+Yt]=0>Yt?-Yt:Yt;for(Yt=-1020;1020>=Yt;++Yt)I6[1020+Yt]=-128>Yt?-128:127<Yt?127:Yt;for(Yt=-112;112>=Yt;++Yt)D6[112+Yt]=-16>Yt?-16:15<Yt?15:Yt;for(Yt=-255;510>=Yt;++Yt)$6[255+Yt]=0>Yt?0:255<Yt?255:Yt;U6=1}pl=nt,Cu=Bt,Eu=Kt,Bi=Jt,ta=ar,xc=ut,Xa=zn,_s=Hn,md=ce,jg=Le,dp=ri,$y=M,C6=it,E6=At,T6=Re,P6=dt,O6=Rr,M6=nn,Zc[0]=ct,Zc[1]=Pe,Zc[2]=Sr,Zc[3]=Yr,Zc[4]=$t,Zc[5]=Ye,Zc[6]=qe,Zc[7]=ot,Zc[8]=kt,Zc[9]=$e,yf[0]=we,yf[1]=mt,yf[2]=Nt,yf[3]=er,yf[4]=Ie,yf[5]=Ze,yf[6]=bt,gd[0]=mn,gd[1]=Ot,gd[2]=It,gd[3]=Zt,gd[4]=Tn,gd[5]=hn,gd[6]=Ir,Yt=1}else Yt=0}Yt&&(Yt=function(vi,ks){for(vi.M=0;vi.M<vi.Va;++vi.M){var di,Ln=vi.Jc[vi.M&vi.Xb],pn=vi.m,Qa=vi;for(di=0;di<Qa.za;++di){var ni=pn,wi=Qa,da=wi.Ac,eo=wi.Bc+4*di,Go=wi.zc,Ba=wi.ya[wi.aa+di];if(wi.Qa.Bb?Ba.$b=ne(ni,wi.Pa.jb[0])?2+ne(ni,wi.Pa.jb[2]):ne(ni,wi.Pa.jb[1]):Ba.$b=0,wi.kc&&(Ba.Ad=ne(ni,wi.Bd)),Ba.Za=!ne(ni,145)+0,Ba.Za){var wo=Ba.Ob,Ko=0;for(wi=0;4>wi;++wi){var js,ki=Go[0+wi];for(js=0;4>js;++js){ki=$K[da[eo+js]][ki];for(var $i=H6[ne(ni,ki[0])];0<$i;)$i=H6[2*$i+ne(ni,ki[$i])];ki=-$i,da[eo+js]=ki}n(wo,Ko,da,eo,4),Ko+=4,Go[0+wi]=ki}}else ki=ne(ni,156)?ne(ni,128)?1:3:ne(ni,163)?2:0,Ba.Ob[0]=ki,i(da,eo,ki,4),i(Go,0,ki,4);Ba.Dd=ne(ni,142)?ne(ni,114)?ne(ni,183)?1:3:2:0}if(Qa.m.Ka)return Gt(vi,7,"Premature end-of-partition0 encountered.");for(;vi.ja<vi.za;++vi.ja){if(Qa=Ln,ni=(pn=vi).rb[pn.sb-1],da=pn.rb[pn.sb+pn.ja],di=pn.ya[pn.aa+pn.ja],eo=pn.kc?di.Ad:0)ni.la=da.la=0,di.Za||(ni.Na=da.Na=0),di.Hc=0,di.Gc=0,di.ia=0;else{var Ia,Ui;if(ni=da,da=Qa,eo=pn.Pa.Xc,Go=pn.ya[pn.aa+pn.ja],Ba=pn.pb[Go.$b],wi=Go.ad,wo=0,Ko=pn.rb[pn.sb-1],ki=js=0,i(wi,wo,0,384),Go.Za)var to=0,eu=eo[3];else{$i=s(16);var Ja=ni.Na+Ko.Na;if(Ja=Ng(da,eo[1],Ja,Ba.Eb,0,$i,0),ni.Na=Ko.Na=(0<Ja)+0,1<Ja)pl($i,0,wi,wo);else{var ml=$i[0]+3>>3;for($i=0;256>$i;$i+=16)wi[wo+$i]=ml}to=1,eu=eo[0]}var ra=15&ni.la,As=15&Ko.la;for($i=0;4>$i;++$i){var Il=1&As;for(ml=Ui=0;4>ml;++ml)ra=ra>>1|(Il=(Ja=Ng(da,eu,Ja=Il+(1&ra),Ba.Sc,to,wi,wo))>to)<<7,Ui=Ui<<2|(3<Ja?3:1<Ja?2:wi[wo+0]!=0),wo+=16;ra>>=4,As=As>>1|Il<<7,js=(js<<8|Ui)>>>0}for(eu=ra,to=As>>4,Ia=0;4>Ia;Ia+=2){for(Ui=0,ra=ni.la>>4+Ia,As=Ko.la>>4+Ia,$i=0;2>$i;++$i){for(Il=1&As,ml=0;2>ml;++ml)Ja=Il+(1&ra),ra=ra>>1|(Il=0<(Ja=Ng(da,eo[2],Ja,Ba.Qc,0,wi,wo)))<<3,Ui=Ui<<2|(3<Ja?3:1<Ja?2:wi[wo+0]!=0),wo+=16;ra>>=2,As=As>>1|Il<<5}ki|=Ui<<4*Ia,eu|=ra<<4<<Ia,to|=(240&As)<<Ia}ni.la=eu,Ko.la=to,Go.Hc=js,Go.Gc=ki,Go.ia=43690&ki?0:Ba.ia,eo=!(js|ki)}if(0<pn.L&&(pn.wa[pn.Y+pn.ja]=pn.gd[di.$b][di.Za],pn.wa[pn.Y+pn.ja].La|=!eo),Qa.Ka)return Gt(vi,7,"Premature end-of-file encountered.")}if(_t(vi),pn=ks,Qa=1,di=(Ln=vi).D,ni=0<Ln.L&&Ln.M>=Ln.zb&&Ln.M<=Ln.Va,Ln.Aa==0)t:{if(di.M=Ln.M,di.uc=ni,Fi(Ln,di),Qa=1,di=(Ui=Ln.D).Nb,ni=(ki=Yy[Ln.L])*Ln.R,da=ki/2*Ln.B,$i=16*di*Ln.R,ml=8*di*Ln.B,eo=Ln.sa,Go=Ln.ta-ni+$i,Ba=Ln.qa,wi=Ln.ra-da+ml,wo=Ln.Ha,Ko=Ln.Ia-da+ml,As=(ra=Ui.M)==0,js=ra>=Ln.Va-1,Ln.Aa==2&&Fi(Ln,Ui),Ui.uc)for(Il=(Ja=Ln).D.M,t(Ja.D.uc),Ui=Ja.yb;Ui<Ja.Hb;++Ui){to=Ui,eu=Il;var Yo=(Dl=(ro=Ja).D).Nb;Ia=ro.R;var Dl=Dl.wa[Dl.Y+to],$l=ro.sa,gl=ro.ta+16*Yo*Ia+16*to,Ul=Dl.dd,sa=Dl.tc;if(sa!=0)if(t(3<=sa),ro.L==1)0<to&&P6($l,gl,Ia,sa+4),Dl.La&&M6($l,gl,Ia,sa),0<eu&&T6($l,gl,Ia,sa+4),Dl.La&&O6($l,gl,Ia,sa);else{var zl=ro.B,tu=ro.qa,Ph=ro.ra+8*Yo*zl+8*to,xd=ro.Ha,ro=ro.Ia+8*Yo*zl+8*to;Yo=Dl.ld,0<to&&(_s($l,gl,Ia,sa+4,Ul,Yo),jg(tu,Ph,xd,ro,zl,sa+4,Ul,Yo)),Dl.La&&($y($l,gl,Ia,sa,Ul,Yo),E6(tu,Ph,xd,ro,zl,sa,Ul,Yo)),0<eu&&(Xa($l,gl,Ia,sa+4,Ul,Yo),md(tu,Ph,xd,ro,zl,sa+4,Ul,Yo)),Dl.La&&(dp($l,gl,Ia,sa,Ul,Yo),C6(tu,Ph,xd,ro,zl,sa,Ul,Yo))}}if(Ln.ia&&alert("todo:DitherRow"),pn.put!=null){if(Ui=16*ra,ra=16*(ra+1),As?(pn.y=Ln.sa,pn.O=Ln.ta+$i,pn.f=Ln.qa,pn.N=Ln.ra+ml,pn.ea=Ln.Ha,pn.W=Ln.Ia+ml):(Ui-=ki,pn.y=eo,pn.O=Go,pn.f=Ba,pn.N=wi,pn.ea=wo,pn.W=Ko),js||(ra-=ki),ra>pn.o&&(ra=pn.o),pn.F=null,pn.J=null,Ln.Fa!=null&&0<Ln.Fa.length&&Ui<ra&&(pn.J=xe(Ln,pn,Ui,ra-Ui),pn.F=Ln.mb,pn.F==null&&pn.F.length==0)){Qa=Gt(Ln,3,"Could not decode alpha data.");break t}Ui<pn.j&&(ki=pn.j-Ui,Ui=pn.j,t(!(1&ki)),pn.O+=Ln.R*ki,pn.N+=Ln.B*(ki>>1),pn.W+=Ln.B*(ki>>1),pn.F!=null&&(pn.J+=pn.width*ki)),Ui<ra&&(pn.O+=pn.v,pn.N+=pn.v>>1,pn.W+=pn.v>>1,pn.F!=null&&(pn.J+=pn.v),pn.ka=Ui-pn.j,pn.U=pn.va-pn.v,pn.T=ra-Ui,Qa=pn.put(pn))}di+1!=Ln.Ic||js||(n(Ln.sa,Ln.ta-ni,eo,Go+16*Ln.R,ni),n(Ln.qa,Ln.ra-da,Ba,wi+8*Ln.B,da),n(Ln.Ha,Ln.Ia-da,wo,Ko+8*Ln.B,da))}if(!Qa)return Gt(vi,6,"Output aborted.")}return 1}(Je,Lt)),Lt.bc!=null&&Lt.bc(Lt),Yt&=1}return Yt?(Je.cb=0,Yt):0})(_,ee)||(N=_.a)}}else N=_.a}N==0&&be.Oa!=null&&be.Oa.fd&&(N=Rl(be.ba))}be=N}ge=be!=0?null:11>ge?Ce.f.RGBA.eb:Ce.f.kb.y}else ge=null;return ge};var Z6=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(P,F){for(var E="",T=0;T<4;T++)E+=String.fromCharCode(P[F++]);return E}function d(P,F){return P[F+0]|P[F+1]<<8}function f(P,F){return(P[F+0]|P[F+1]<<8|P[F+2]<<16)>>>0}function h(P,F){return(P[F+0]|P[F+1]<<8|P[F+2]<<16|P[F+3]<<24)>>>0}new c;var p=[0],m=[0],g=[],y=new c,b=e,v=function(P,F){var E={},T=0,B=!1,q=0,U=0;if(E.frames=[],!function(C,K){for(var H=0;H<4;H++)if(C[K+H]!="RIFF".charCodeAt(H))return!0;return!1}(P,F)){for(h(P,F+=4),F+=8;F<P.length;){var se=u(P,F),de=h(P,F+=4);F+=4;var z=de+(1&de);switch(se){case"VP8 ":case"VP8L":E.frames[T]===void 0&&(E.frames[T]={}),(Y=E.frames[T]).src_off=B?U:F-8,Y.src_size=q+de+8,T++,B&&(B=!1,q=0,U=0);break;case"VP8X":(Y=E.header={}).feature_flags=P[F];var G=F+4;Y.canvas_width=1+f(P,G),G+=3,Y.canvas_height=1+f(P,G),G+=3;break;case"ALPH":B=!0,q=z+8,U=F-8;break;case"ANIM":(Y=E.header).bgcolor=h(P,F),G=F+4,Y.loop_count=d(P,G),G+=2;break;case"ANMF":var ie,Y;(Y=E.frames[T]={}).offset_x=2*f(P,F),F+=3,Y.offset_y=2*f(P,F),F+=3,Y.width=1+f(P,F),F+=3,Y.height=1+f(P,F),F+=3,Y.duration=f(P,F),F+=3,ie=P[F++],Y.dispose=1&ie,Y.blend=ie>>1&1}se!="ANMF"&&(F+=z)}return E}}(b,0);v.response=b,v.rgbaoutput=!0,v.dataurl=!1;var w=v.header?v.header:null,S=v.frames?v.frames:null;if(w){w.loop_counter=w.loop_count,p=[w.canvas_height],m=[w.canvas_width];for(var k=0;k<S.length&&S[k].blend!=0;k++);}var j=S[0],A=y.WebPDecodeRGBA(b,j.src_off,j.src_size,m,p);j.rgba=A,j.imgwidth=m[0],j.imgheight=p[0];for(var L=0;L<m[0]*p[0]*4;L++)g[L]=A[L];return this.width=m,this.height=p,this.data=g,this}/** ====================================================================
 * @license
 * jsPDF XMP metadata plugin
 * Copyright (c) 2016 Jussi Utunen, u-jussi@suomi24.fi
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 */function Fge(){var e,t=this.internal.__metadata__.metadata,r=unescape(encodeURIComponent(t));e=this.internal.__metadata__.rawXml?r:'<x:xmpmeta xmlns:x="adobe:ns:meta/"><rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceUri+'"><jspdf:metadata>'+r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")+"</jspdf:metadata></rdf:Description></rdf:RDF></x:xmpmeta>",this.internal.__metadata__.metadataObjectNumber=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+e.length+" >>"),this.internal.write("stream"),this.internal.write(e),this.internal.write("endstream"),this.internal.write("endobj")}function Bge(){this.internal.__metadata__.metadataObjectNumber&&this.internal.write("/Metadata "+this.internal.__metadata__.metadataObjectNumber+" 0 R")}(function(e){var t,r,n,i,s,o,l,c,u,d=function(C){return C=C||{},this.isStrokeTransparent=C.isStrokeTransparent||!1,this.strokeOpacity=C.strokeOpacity||1,this.strokeStyle=C.strokeStyle||"#000000",this.fillStyle=C.fillStyle||"#000000",this.isFillTransparent=C.isFillTransparent||!1,this.fillOpacity=C.fillOpacity||1,this.font=C.font||"10px sans-serif",this.textBaseline=C.textBaseline||"alphabetic",this.textAlign=C.textAlign||"left",this.lineWidth=C.lineWidth||1,this.lineJoin=C.lineJoin||"miter",this.lineCap=C.lineCap||"butt",this.path=C.path||[],this.transform=C.transform!==void 0?C.transform.clone():new c,this.globalCompositeOperation=C.globalCompositeOperation||"normal",this.globalAlpha=C.globalAlpha||1,this.clip_path=C.clip_path||[],this.currentPoint=C.currentPoint||new o,this.miterLimit=C.miterLimit||10,this.lastPoint=C.lastPoint||new o,this.lineDashOffset=C.lineDashOffset||0,this.lineDash=C.lineDash||[],this.margin=C.margin||[0,0,0,0],this.prevPageLastElemOffset=C.prevPageLastElemOffset||0,this.ignoreClearRect=typeof C.ignoreClearRect!="boolean"||C.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new f(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new d}]);var f=function(C){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var K=C;Object.defineProperty(this,"pdf",{get:function(){return K}});var H=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return H},set:function(I){H=!!I}});var R=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return R},set:function(I){R=!!I}});var J=0;Object.defineProperty(this,"posX",{get:function(){return J},set:function(I){isNaN(I)||(J=I)}});var V=0;Object.defineProperty(this,"posY",{get:function(){return V},set:function(I){isNaN(I)||(V=I)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(I){var Z;typeof I=="number"?Z=[I,I,I,I]:((Z=new Array(4))[0]=I[0],Z[1]=I.length>=2?I[1]:Z[0],Z[2]=I.length>=3?I[2]:Z[0],Z[3]=I.length>=4?I[3]:Z[1]),u.margin=Z}});var X=!1;Object.defineProperty(this,"autoPaging",{get:function(){return X},set:function(I){X=I}});var Q=0;Object.defineProperty(this,"lastBreak",{get:function(){return Q},set:function(I){Q=I}});var ne=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ne},set:function(I){ne=I}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(I){I instanceof d&&(u=I)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(I){u.path=I}});var oe=[];Object.defineProperty(this,"ctxStack",{get:function(){return oe},set:function(I){oe=I}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(I){var Z;Z=h(I),this.ctx.fillStyle=Z.style,this.ctx.isFillTransparent=Z.a===0,this.ctx.fillOpacity=Z.a,this.pdf.setFillColor(Z.r,Z.g,Z.b,{a:Z.a}),this.pdf.setTextColor(Z.r,Z.g,Z.b,{a:Z.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(I){var Z=h(I);this.ctx.strokeStyle=Z.style,this.ctx.isStrokeTransparent=Z.a===0,this.ctx.strokeOpacity=Z.a,Z.a===0?this.pdf.setDrawColor(255,255,255):(Z.a,this.pdf.setDrawColor(Z.r,Z.g,Z.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(I){["butt","round","square"].indexOf(I)!==-1&&(this.ctx.lineCap=I,this.pdf.setLineCap(I))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(I){isNaN(I)||(this.ctx.lineWidth=I,this.pdf.setLineWidth(I))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(I){["bevel","round","miter"].indexOf(I)!==-1&&(this.ctx.lineJoin=I,this.pdf.setLineJoin(I))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(I){isNaN(I)||(this.ctx.miterLimit=I,this.pdf.setMiterLimit(I))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(I){this.ctx.textBaseline=I}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(I){["right","end","center","left","start"].indexOf(I)!==-1&&(this.ctx.textAlign=I)}});var O=null,W=null,ae=null;Object.defineProperty(this,"fontFaces",{get:function(){return ae},set:function(I){O=null,W=null,ae=I}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(I){var Z;if(this.ctx.font=I,(Z=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(I))!==null){var me=Z[1];Z[2];var Te=Z[3],Ae=Z[4];Z[5];var Be=Z[6],Ee=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ae)[2];Ae=Math.floor(Ee==="px"?parseFloat(Ae)*this.pdf.internal.scaleFactor:Ee==="em"?parseFloat(Ae)*this.pdf.getFontSize():parseFloat(Ae)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ae);var ze=function(ye){var ht,Ge,lt=[],jt=ye.trim();if(jt==="")return Ck;if(jt in oM)return[oM[jt]];for(;jt!=="";){switch(Ge=null,ht=(jt=cM(jt)).charAt(0)){case'"':case"'":Ge=Tge(jt.substring(1),ht);break;default:Ge=Pge(jt)}if(Ge===null||(lt.push(Ge[0]),(jt=cM(Ge[1]))!==""&&jt.charAt(0)!==","))return Ck;jt=jt.replace(/^,/,"")}return lt}(Be);if(this.fontFaces){var Xe=function(ye,ht){var Ge=ye.getFontList(),lt=JSON.stringify(Ge);if(O===null||W!==lt){var jt=function(wt){var yt=[];return Object.keys(wt).forEach(function(Fr){wt[Fr].forEach(function(Tt){var hr=null;switch(Tt){case"bold":hr={family:Fr,weight:"bold"};break;case"italic":hr={family:Fr,style:"italic"};break;case"bolditalic":hr={family:Fr,weight:"bold",style:"italic"};break;case"":case"normal":hr={family:Fr}}hr!==null&&(hr.ref={name:Fr,style:Tt},yt.push(hr))})}),yt}(Ge);O=function(wt){for(var yt={},Fr=0;Fr<wt.length;++Fr){var Tt=Nk(wt[Fr]),hr=Tt.family,rn=Tt.stretch,en=Tt.style,$r=Tt.weight;yt[hr]=yt[hr]||{},yt[hr][rn]=yt[hr][rn]||{},yt[hr][rn][en]=yt[hr][rn][en]||{},yt[hr][rn][en][$r]=Tt}return yt}(jt.concat(ht)),W=lt}return O}(this.pdf,this.fontFaces),Pt=ze.map(function(ye){return{family:ye,stretch:"normal",weight:Te,style:me}}),ft=function(ye,ht,Ge){for(var lt=(Ge=Ge||{}).defaultFontFamily||"times",jt=Object.assign({},Ege,Ge.genericFontFamilies||{}),wt=null,yt=null,Fr=0;Fr<ht.length;++Fr)if(jt[(wt=Nk(ht[Fr])).family]&&(wt.family=jt[wt.family]),ye.hasOwnProperty(wt.family)){yt=ye[wt.family];break}if(!(yt=yt||ye[lt]))throw new Error("Could not find a font-family for the rule '"+lM(wt)+"' and default family '"+lt+"'.");if(yt=function(Tt,hr){if(hr[Tt])return hr[Tt];var rn=aA[Tt],en=rn<=aA.normal?-1:1,$r=sM(hr,Rz,rn,en);if(!$r)throw new Error("Could not find a matching font-stretch value for "+Tt);return $r}(wt.stretch,yt),yt=function(Tt,hr){if(hr[Tt])return hr[Tt];for(var rn=Lz[Tt],en=0;en<rn.length;++en)if(hr[rn[en]])return hr[rn[en]];throw new Error("Could not find a matching font-style for "+Tt)}(wt.style,yt),!(yt=function(Tt,hr){if(hr[Tt])return hr[Tt];if(Tt===400&&hr[500])return hr[500];if(Tt===500&&hr[400])return hr[400];var rn=Cge[Tt],en=sM(hr,Fz,rn,Tt<400?-1:1);if(!en)throw new Error("Could not find a matching font-weight for value "+Tt);return en}(wt.weight,yt)))throw new Error("Failed to resolve a font for the rule '"+lM(wt)+"'.");return yt}(Xe,Pt);this.pdf.setFont(ft.ref.name,ft.ref.style)}else{var He="";(Te==="bold"||parseInt(Te,10)>=700||me==="bold")&&(He="bold"),me==="italic"&&(He+="italic"),He.length===0&&(He="normal");for(var tt="",_e={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Se=0;Se<ze.length;Se++){if(this.pdf.internal.getFont(ze[Se],He,{noFallback:!0,disableWarning:!0})!==void 0){tt=ze[Se];break}if(He==="bolditalic"&&this.pdf.internal.getFont(ze[Se],"bold",{noFallback:!0,disableWarning:!0})!==void 0)tt=ze[Se],He="bold";else if(this.pdf.internal.getFont(ze[Se],"normal",{noFallback:!0,disableWarning:!0})!==void 0){tt=ze[Se],He="normal";break}}if(tt===""){for(var he=0;he<ze.length;he++)if(_e[ze[he]]){tt=_e[ze[he]];break}}tt=tt===""?"Times":tt,this.pdf.setFont(tt,He)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(I){this.ctx.globalCompositeOperation=I}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(I){this.ctx.globalAlpha=I}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(I){this.ctx.lineDashOffset=I,Y.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(I){this.ctx.lineDash=I,Y.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(I){this.ctx.ignoreClearRect=!!I}})};f.prototype.setLineDash=function(C){this.lineDash=C},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){S.call(this,"fill",!1)},f.prototype.stroke=function(){S.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(C,K){if(isNaN(C)||isNaN(K))throw ia.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var H=this.ctx.transform.applyToPoint(new o(C,K));this.path.push({type:"mt",x:H.x,y:H.y}),this.ctx.lastPoint=new o(C,K)},f.prototype.closePath=function(){var C=new o(0,0),K=0;for(K=this.path.length-1;K!==-1;K--)if(this.path[K].type==="begin"&&Hi(this.path[K+1])==="object"&&typeof this.path[K+1].x=="number"){C=new o(this.path[K+1].x,this.path[K+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(C.x,C.y)},f.prototype.lineTo=function(C,K){if(isNaN(C)||isNaN(K))throw ia.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var H=this.ctx.transform.applyToPoint(new o(C,K));this.path.push({type:"lt",x:H.x,y:H.y}),this.ctx.lastPoint=new o(H.x,H.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),S.call(this,null,!0)},f.prototype.quadraticCurveTo=function(C,K,H,R){if(isNaN(H)||isNaN(R)||isNaN(C)||isNaN(K))throw ia.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var J=this.ctx.transform.applyToPoint(new o(H,R)),V=this.ctx.transform.applyToPoint(new o(C,K));this.path.push({type:"qct",x1:V.x,y1:V.y,x:J.x,y:J.y}),this.ctx.lastPoint=new o(J.x,J.y)},f.prototype.bezierCurveTo=function(C,K,H,R,J,V){if(isNaN(J)||isNaN(V)||isNaN(C)||isNaN(K)||isNaN(H)||isNaN(R))throw ia.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var X=this.ctx.transform.applyToPoint(new o(J,V)),Q=this.ctx.transform.applyToPoint(new o(C,K)),ne=this.ctx.transform.applyToPoint(new o(H,R));this.path.push({type:"bct",x1:Q.x,y1:Q.y,x2:ne.x,y2:ne.y,x:X.x,y:X.y}),this.ctx.lastPoint=new o(X.x,X.y)},f.prototype.arc=function(C,K,H,R,J,V){if(isNaN(C)||isNaN(K)||isNaN(H)||isNaN(R)||isNaN(J))throw ia.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(V=!!V,!this.ctx.transform.isIdentity){var X=this.ctx.transform.applyToPoint(new o(C,K));C=X.x,K=X.y;var Q=this.ctx.transform.applyToPoint(new o(0,H)),ne=this.ctx.transform.applyToPoint(new o(0,0));H=Math.sqrt(Math.pow(Q.x-ne.x,2)+Math.pow(Q.y-ne.y,2))}Math.abs(J-R)>=2*Math.PI&&(R=0,J=2*Math.PI),this.path.push({type:"arc",x:C,y:K,radius:H,startAngle:R,endAngle:J,counterclockwise:V})},f.prototype.arcTo=function(C,K,H,R,J){throw new Error("arcTo not implemented.")},f.prototype.rect=function(C,K,H,R){if(isNaN(C)||isNaN(K)||isNaN(H)||isNaN(R))throw ia.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(C,K),this.lineTo(C+H,K),this.lineTo(C+H,K+R),this.lineTo(C,K+R),this.lineTo(C,K),this.lineTo(C+H,K),this.lineTo(C,K)},f.prototype.fillRect=function(C,K,H,R){if(isNaN(C)||isNaN(K)||isNaN(H)||isNaN(R))throw ia.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!p.call(this)){var J={};this.lineCap!=="butt"&&(J.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(J.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(C,K,H,R),this.fill(),J.hasOwnProperty("lineCap")&&(this.lineCap=J.lineCap),J.hasOwnProperty("lineJoin")&&(this.lineJoin=J.lineJoin)}},f.prototype.strokeRect=function(C,K,H,R){if(isNaN(C)||isNaN(K)||isNaN(H)||isNaN(R))throw ia.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(C,K,H,R),this.stroke())},f.prototype.clearRect=function(C,K,H,R){if(isNaN(C)||isNaN(K)||isNaN(H)||isNaN(R))throw ia.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(C,K,H,R))},f.prototype.save=function(C){C=typeof C!="boolean"||C;for(var K=this.pdf.internal.getCurrentPageInfo().pageNumber,H=0;H<this.pdf.internal.getNumberOfPages();H++)this.pdf.setPage(H+1),this.pdf.internal.out("q");if(this.pdf.setPage(K),C){this.ctx.fontSize=this.pdf.internal.getFontSize();var R=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=R}},f.prototype.restore=function(C){C=typeof C!="boolean"||C;for(var K=this.pdf.internal.getCurrentPageInfo().pageNumber,H=0;H<this.pdf.internal.getNumberOfPages();H++)this.pdf.setPage(H+1),this.pdf.internal.out("Q");this.pdf.setPage(K),C&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var h=function(C){var K,H,R,J;if(C.isCanvasGradient===!0&&(C=C.getColor()),!C)return{r:0,g:0,b:0,a:0,style:C};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(C))K=0,H=0,R=0,J=0;else{var V=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(C);if(V!==null)K=parseInt(V[1]),H=parseInt(V[2]),R=parseInt(V[3]),J=1;else if((V=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(C))!==null)K=parseInt(V[1]),H=parseInt(V[2]),R=parseInt(V[3]),J=parseFloat(V[4]);else{if(J=1,typeof C=="string"&&C.charAt(0)!=="#"){var X=new Nz(C);C=X.ok?X.toHex():"#000000"}C.length===4?(K=C.substring(1,2),K+=K,H=C.substring(2,3),H+=H,R=C.substring(3,4),R+=R):(K=C.substring(1,3),H=C.substring(3,5),R=C.substring(5,7)),K=parseInt(K,16),H=parseInt(H,16),R=parseInt(R,16)}}return{r:K,g:H,b:R,a:J,style:C}},p=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},m=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(C,K,H,R){if(isNaN(K)||isNaN(H)||typeof C!="string")throw ia.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(R=isNaN(R)?void 0:R,!p.call(this)){var J=z(this.ctx.transform.rotation),V=this.ctx.transform.scaleX;T.call(this,{text:C,x:K,y:H,scale:V,angle:J,align:this.textAlign,maxWidth:R})}},f.prototype.strokeText=function(C,K,H,R){if(isNaN(K)||isNaN(H)||typeof C!="string")throw ia.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){R=isNaN(R)?void 0:R;var J=z(this.ctx.transform.rotation),V=this.ctx.transform.scaleX;T.call(this,{text:C,x:K,y:H,scale:V,renderingMode:"stroke",angle:J,align:this.textAlign,maxWidth:R})}},f.prototype.measureText=function(C){if(typeof C!="string")throw ia.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var K=this.pdf,H=this.pdf.internal.scaleFactor,R=K.internal.getFontSize(),J=K.getStringUnitWidth(C)*R/K.internal.scaleFactor;return new function(V){var X=(V=V||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return X}}),this}({width:J*=Math.round(96*H/72*1e4)/1e4})},f.prototype.scale=function(C,K){if(isNaN(C)||isNaN(K))throw ia.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var H=new c(C,0,0,K,0,0);this.ctx.transform=this.ctx.transform.multiply(H)},f.prototype.rotate=function(C){if(isNaN(C))throw ia.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var K=new c(Math.cos(C),Math.sin(C),-Math.sin(C),Math.cos(C),0,0);this.ctx.transform=this.ctx.transform.multiply(K)},f.prototype.translate=function(C,K){if(isNaN(C)||isNaN(K))throw ia.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var H=new c(1,0,0,1,C,K);this.ctx.transform=this.ctx.transform.multiply(H)},f.prototype.transform=function(C,K,H,R,J,V){if(isNaN(C)||isNaN(K)||isNaN(H)||isNaN(R)||isNaN(J)||isNaN(V))throw ia.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var X=new c(C,K,H,R,J,V);this.ctx.transform=this.ctx.transform.multiply(X)},f.prototype.setTransform=function(C,K,H,R,J,V){C=isNaN(C)?1:C,K=isNaN(K)?0:K,H=isNaN(H)?0:H,R=isNaN(R)?1:R,J=isNaN(J)?0:J,V=isNaN(V)?0:V,this.ctx.transform=new c(C,K,H,R,J,V)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(C,K,H,R,J,V,X,Q,ne){var oe=this.pdf.getImageProperties(C),O=1,W=1,ae=1,I=1;R!==void 0&&Q!==void 0&&(ae=Q/R,I=ne/J,O=oe.width/R*Q/R,W=oe.height/J*ne/J),V===void 0&&(V=K,X=H,K=0,H=0),R!==void 0&&Q===void 0&&(Q=R,ne=J),R===void 0&&Q===void 0&&(Q=oe.width,ne=oe.height);var Z=this.ctx.transform.decompose(),me=z(Z.rotate.shx),Te=new c,Ae=(Te=(Te=(Te=Te.multiply(Z.translate)).multiply(Z.skew)).multiply(Z.scale)).applyToRectangle(new l(V-K*ae,X-H*I,R*O,J*W));if(this.autoPaging){for(var Be,Ee=y.call(this,Ae),ze=[],Xe=0;Xe<Ee.length;Xe+=1)ze.indexOf(Ee[Xe])===-1&&ze.push(Ee[Xe]);w(ze);for(var Pt=ze[0],ft=ze[ze.length-1],He=Pt;He<ft+1;He++){this.pdf.setPage(He);var tt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],_e=He===1?this.posY+this.margin[0]:this.margin[0],Se=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],he=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ye=He===1?0:Se+(He-2)*he;if(this.ctx.clip_path.length!==0){var ht=this.path;Be=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(Be,this.posX+this.margin[3],-ye+_e+this.ctx.prevPageLastElemOffset),k.call(this,"fill",!0),this.path=ht}var Ge=JSON.parse(JSON.stringify(Ae));Ge=v([Ge],this.posX+this.margin[3],-ye+_e+this.ctx.prevPageLastElemOffset)[0];var lt=(He>Pt||He<ft)&&g.call(this);lt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],tt,he,null).clip().discardPath()),this.pdf.addImage(C,"JPEG",Ge.x,Ge.y,Ge.w,Ge.h,null,null,me),lt&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(C,"JPEG",Ae.x,Ae.y,Ae.w,Ae.h,null,null,me)};var y=function(C,K,H){var R=[];K=K||this.pdf.internal.pageSize.width,H=H||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var J=this.posY+this.ctx.prevPageLastElemOffset;switch(C.type){default:case"mt":case"lt":R.push(Math.floor((C.y+J)/H)+1);break;case"arc":R.push(Math.floor((C.y+J-C.radius)/H)+1),R.push(Math.floor((C.y+J+C.radius)/H)+1);break;case"qct":var V=G(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x,C.y);R.push(Math.floor((V.y+J)/H)+1),R.push(Math.floor((V.y+V.h+J)/H)+1);break;case"bct":var X=ie(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x2,C.y2,C.x,C.y);R.push(Math.floor((X.y+J)/H)+1),R.push(Math.floor((X.y+X.h+J)/H)+1);break;case"rect":R.push(Math.floor((C.y+J)/H)+1),R.push(Math.floor((C.y+C.h+J)/H)+1)}for(var Q=0;Q<R.length;Q+=1)for(;this.pdf.internal.getNumberOfPages()<R[Q];)b.call(this);return R},b=function(){var C=this.fillStyle,K=this.strokeStyle,H=this.font,R=this.lineCap,J=this.lineWidth,V=this.lineJoin;this.pdf.addPage(),this.fillStyle=C,this.strokeStyle=K,this.font=H,this.lineCap=R,this.lineWidth=J,this.lineJoin=V},v=function(C,K,H){for(var R=0;R<C.length;R++)switch(C[R].type){case"bct":C[R].x2+=K,C[R].y2+=H;case"qct":C[R].x1+=K,C[R].y1+=H;default:C[R].x+=K,C[R].y+=H}return C},w=function(C){return C.sort(function(K,H){return K-H})},S=function(C,K){var H=this.fillStyle,R=this.strokeStyle,J=this.lineCap,V=this.lineWidth,X=Math.abs(V*this.ctx.transform.scaleX),Q=this.lineJoin;if(this.autoPaging){for(var ne,oe,O=JSON.parse(JSON.stringify(this.path)),W=JSON.parse(JSON.stringify(this.path)),ae=[],I=0;I<W.length;I++)if(W[I].x!==void 0)for(var Z=y.call(this,W[I]),me=0;me<Z.length;me+=1)ae.indexOf(Z[me])===-1&&ae.push(Z[me]);for(var Te=0;Te<ae.length;Te++)for(;this.pdf.internal.getNumberOfPages()<ae[Te];)b.call(this);w(ae);for(var Ae=ae[0],Be=ae[ae.length-1],Ee=Ae;Ee<Be+1;Ee++){this.pdf.setPage(Ee),this.fillStyle=H,this.strokeStyle=R,this.lineCap=J,this.lineWidth=X,this.lineJoin=Q;var ze=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Xe=Ee===1?this.posY+this.margin[0]:this.margin[0],Pt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ft=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],He=Ee===1?0:Pt+(Ee-2)*ft;if(this.ctx.clip_path.length!==0){var tt=this.path;ne=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(ne,this.posX+this.margin[3],-He+Xe+this.ctx.prevPageLastElemOffset),k.call(this,C,!0),this.path=tt}if(oe=JSON.parse(JSON.stringify(O)),this.path=v(oe,this.posX+this.margin[3],-He+Xe+this.ctx.prevPageLastElemOffset),K===!1||Ee===0){var _e=(Ee>Ae||Ee<Be)&&g.call(this);_e&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ze,ft,null).clip().discardPath()),k.call(this,C,K),_e&&this.pdf.restoreGraphicsState()}this.lineWidth=V}this.path=O}else this.lineWidth=X,k.call(this,C,K),this.lineWidth=V},k=function(C,K){if((C!=="stroke"||K||!m.call(this))&&(C==="stroke"||K||!p.call(this))){for(var H,R,J=[],V=this.path,X=0;X<V.length;X++){var Q=V[X];switch(Q.type){case"begin":J.push({begin:!0});break;case"close":J.push({close:!0});break;case"mt":J.push({start:Q,deltas:[],abs:[]});break;case"lt":var ne=J.length;if(V[X-1]&&!isNaN(V[X-1].x)&&(H=[Q.x-V[X-1].x,Q.y-V[X-1].y],ne>0)){for(;ne>=0;ne--)if(J[ne-1].close!==!0&&J[ne-1].begin!==!0){J[ne-1].deltas.push(H),J[ne-1].abs.push(Q);break}}break;case"bct":H=[Q.x1-V[X-1].x,Q.y1-V[X-1].y,Q.x2-V[X-1].x,Q.y2-V[X-1].y,Q.x-V[X-1].x,Q.y-V[X-1].y],J[J.length-1].deltas.push(H);break;case"qct":var oe=V[X-1].x+2/3*(Q.x1-V[X-1].x),O=V[X-1].y+2/3*(Q.y1-V[X-1].y),W=Q.x+2/3*(Q.x1-Q.x),ae=Q.y+2/3*(Q.y1-Q.y),I=Q.x,Z=Q.y;H=[oe-V[X-1].x,O-V[X-1].y,W-V[X-1].x,ae-V[X-1].y,I-V[X-1].x,Z-V[X-1].y],J[J.length-1].deltas.push(H);break;case"arc":J.push({deltas:[],abs:[],arc:!0}),Array.isArray(J[J.length-1].abs)&&J[J.length-1].abs.push(Q)}}R=K?null:C==="stroke"?"stroke":"fill";for(var me=!1,Te=0;Te<J.length;Te++)if(J[Te].arc)for(var Ae=J[Te].abs,Be=0;Be<Ae.length;Be++){var Ee=Ae[Be];Ee.type==="arc"?L.call(this,Ee.x,Ee.y,Ee.radius,Ee.startAngle,Ee.endAngle,Ee.counterclockwise,void 0,K,!me):B.call(this,Ee.x,Ee.y),me=!0}else if(J[Te].close===!0)this.pdf.internal.out("h"),me=!1;else if(J[Te].begin!==!0){var ze=J[Te].start.x,Xe=J[Te].start.y;q.call(this,J[Te].deltas,ze,Xe),me=!0}R&&P.call(this,R),K&&F.call(this)}},j=function(C){var K=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,H=K*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return C-H;case"top":return C+K-H;case"hanging":return C+K-2*H;case"middle":return C+K/2-H;default:return C}},A=function(C){return C+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var C=function(){};return C.colorStops=[],C.addColorStop=function(K,H){this.colorStops.push([K,H])},C.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},C.isCanvasGradient=!0,C},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var L=function(C,K,H,R,J,V,X,Q,ne){for(var oe=se.call(this,H,R,J,V),O=0;O<oe.length;O++){var W=oe[O];O===0&&(ne?E.call(this,W.x1+C,W.y1+K):B.call(this,W.x1+C,W.y1+K)),U.call(this,C,K,W.x2,W.y2,W.x3,W.y3,W.x4,W.y4)}Q?F.call(this):P.call(this,X)},P=function(C){switch(C){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},F=function(){this.pdf.clip(),this.pdf.discardPath()},E=function(C,K){this.pdf.internal.out(r(C)+" "+n(K)+" m")},T=function(C){var K;switch(C.align){case"right":case"end":K="right";break;case"center":K="center";break;default:K="left"}var H,R,J,V=this.pdf.getTextDimensions(C.text),X=j.call(this,C.y),Q=A.call(this,X)-V.h,ne=this.ctx.transform.applyToPoint(new o(C.x,X));if(this.autoPaging){var oe=this.ctx.transform.decompose(),O=new c;O=(O=(O=O.multiply(oe.translate)).multiply(oe.skew)).multiply(oe.scale);for(var W=this.ctx.transform.applyToRectangle(new l(C.x,X,V.w,V.h)),ae=O.applyToRectangle(new l(C.x,Q,V.w,V.h)),I=y.call(this,ae),Z=[],me=0;me<I.length;me+=1)Z.indexOf(I[me])===-1&&Z.push(I[me]);w(Z);for(var Te=Z[0],Ae=Z[Z.length-1],Be=Te;Be<Ae+1;Be++){this.pdf.setPage(Be);var Ee=Be===1?this.posY+this.margin[0]:this.margin[0],ze=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Xe=this.pdf.internal.pageSize.height-this.margin[2],Pt=Xe-this.margin[0],ft=this.pdf.internal.pageSize.width-this.margin[1],He=ft-this.margin[3],tt=Be===1?0:ze+(Be-2)*Pt;if(this.ctx.clip_path.length!==0){var _e=this.path;H=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(H,this.posX+this.margin[3],-1*tt+Ee),k.call(this,"fill",!0),this.path=_e}var Se=v([JSON.parse(JSON.stringify(ae))],this.posX+this.margin[3],-tt+Ee+this.ctx.prevPageLastElemOffset)[0];C.scale>=.01&&(R=this.pdf.internal.getFontSize(),this.pdf.setFontSize(R*C.scale),J=this.lineWidth,this.lineWidth=J*C.scale);var he=this.autoPaging!=="text";if(he||Se.y+Se.h<=Xe){if(he||Se.y>=Ee&&Se.x<=ft){var ye=he?C.text:this.pdf.splitTextToSize(C.text,C.maxWidth||ft-Se.x)[0],ht=v([JSON.parse(JSON.stringify(W))],this.posX+this.margin[3],-tt+Ee+this.ctx.prevPageLastElemOffset)[0],Ge=he&&(Be>Te||Be<Ae)&&g.call(this);Ge&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],He,Pt,null).clip().discardPath()),this.pdf.text(ye,ht.x,ht.y,{angle:C.angle,align:K,renderingMode:C.renderingMode}),Ge&&this.pdf.restoreGraphicsState()}}else Se.y<Xe&&(this.ctx.prevPageLastElemOffset+=Xe-Se.y);C.scale>=.01&&(this.pdf.setFontSize(R),this.lineWidth=J)}}else C.scale>=.01&&(R=this.pdf.internal.getFontSize(),this.pdf.setFontSize(R*C.scale),J=this.lineWidth,this.lineWidth=J*C.scale),this.pdf.text(C.text,ne.x+this.posX,ne.y+this.posY,{angle:C.angle,align:K,renderingMode:C.renderingMode,maxWidth:C.maxWidth}),C.scale>=.01&&(this.pdf.setFontSize(R),this.lineWidth=J)},B=function(C,K,H,R){H=H||0,R=R||0,this.pdf.internal.out(r(C+H)+" "+n(K+R)+" l")},q=function(C,K,H){return this.pdf.lines(C,K,H,null,null)},U=function(C,K,H,R,J,V,X,Q){this.pdf.internal.out([t(i(H+C)),t(s(R+K)),t(i(J+C)),t(s(V+K)),t(i(X+C)),t(s(Q+K)),"c"].join(" "))},se=function(C,K,H,R){for(var J=2*Math.PI,V=Math.PI/2;K>H;)K-=J;var X=Math.abs(H-K);X<J&&R&&(X=J-X);for(var Q=[],ne=R?-1:1,oe=K;X>1e-5;){var O=oe+ne*Math.min(X,V);Q.push(de.call(this,C,oe,O)),X-=Math.abs(O-oe),oe=O}return Q},de=function(C,K,H){var R=(H-K)/2,J=C*Math.cos(R),V=C*Math.sin(R),X=J,Q=-V,ne=X*X+Q*Q,oe=ne+X*J+Q*V,O=4/3*(Math.sqrt(2*ne*oe)-oe)/(X*V-Q*J),W=X-O*Q,ae=Q+O*X,I=W,Z=-ae,me=R+K,Te=Math.cos(me),Ae=Math.sin(me);return{x1:C*Math.cos(K),y1:C*Math.sin(K),x2:W*Te-ae*Ae,y2:W*Ae+ae*Te,x3:I*Te-Z*Ae,y3:I*Ae+Z*Te,x4:C*Math.cos(H),y4:C*Math.sin(H)}},z=function(C){return 180*C/Math.PI},G=function(C,K,H,R,J,V){var X=C+.5*(H-C),Q=K+.5*(R-K),ne=J+.5*(H-J),oe=V+.5*(R-V),O=Math.min(C,J,X,ne),W=Math.max(C,J,X,ne),ae=Math.min(K,V,Q,oe),I=Math.max(K,V,Q,oe);return new l(O,ae,W-O,I-ae)},ie=function(C,K,H,R,J,V,X,Q){var ne,oe,O,W,ae,I,Z,me,Te,Ae,Be,Ee,ze,Xe,Pt=H-C,ft=R-K,He=J-H,tt=V-R,_e=X-J,Se=Q-V;for(oe=0;oe<41;oe++)Te=(Z=(O=C+(ne=oe/40)*Pt)+ne*((ae=H+ne*He)-O))+ne*(ae+ne*(J+ne*_e-ae)-Z),Ae=(me=(W=K+ne*ft)+ne*((I=R+ne*tt)-W))+ne*(I+ne*(V+ne*Se-I)-me),oe==0?(Be=Te,Ee=Ae,ze=Te,Xe=Ae):(Be=Math.min(Be,Te),Ee=Math.min(Ee,Ae),ze=Math.max(ze,Te),Xe=Math.max(Xe,Ae));return new l(Math.round(Be),Math.round(Ee),Math.round(ze-Be),Math.round(Xe-Ee))},Y=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var C,K,H=(C=this.ctx.lineDash,K=this.ctx.lineDashOffset,JSON.stringify({lineDash:C,lineDashOffset:K}));this.prevLineDash!==H&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=H)}}})(Un.API),function(e){var t=function(o){var l,c,u,d,f,h,p,m,g,y;for(c=[],u=0,d=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;d>u;u+=4)(f=(o.charCodeAt(u)<<24)+(o.charCodeAt(u+1)<<16)+(o.charCodeAt(u+2)<<8)+o.charCodeAt(u+3))!==0?(h=(f=((f=((f=((f=(f-(y=f%85))/85)-(g=f%85))/85)-(m=f%85))/85)-(p=f%85))/85)%85,c.push(h+33,p+33,m+33,g+33,y+33)):c.push(122);return function(b,v){for(var w=v;w>0;w--)b.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(o){var l,c,u,d,f,h=String,p="length",m=255,g="charCodeAt",y="slice",b="replace";for(o[y](-2),o=o[y](0,-2)[b](/\s/g,"")[b]("z","!!!!!"),u=[],d=0,f=(o+=l="uuuuu"[y](o[p]%5||5))[p];f>d;d+=5)c=52200625*(o[g](d)-33)+614125*(o[g](d+1)-33)+7225*(o[g](d+2)-33)+85*(o[g](d+3)-33)+(o[g](d+4)-33),u.push(m&c>>24,m&c>>16,m&c>>8,m&c);return function(v,w){for(var S=w;S>0;S--)v.pop()}(u,l[p]),h.fromCharCode.apply(h,u)},n=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},i=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",u=0;u<o.length;u+=2)c+=String.fromCharCode("0x"+(o[u]+o[u+1]));return c},s=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=J4(l)).reduce(function(u,d){return u+String.fromCharCode(d)},"")};e.processDataByFilters=function(o,l){var c=0,u=o||"",d=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":u=r(u),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=t(u),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=i(u),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=n(u),d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=s(u),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:u,reverseChain:d.reverse().join(" ")}}}(Un.API),function(e){e.loadFile=function(t,r,n){return function(i,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,u,d){var f=new XMLHttpRequest,h=0,p=function(m){var g=m.length,y=[],b=String.fromCharCode;for(h=0;h<g;h+=1)y.push(b(255&m.charCodeAt(h)));return y.join("")};if(f.open("GET",c,!u),f.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(f.onload=function(){f.status===200?d(p(this.responseText)):d(void 0)}),f.send(null),u&&f.status===200)return p(f.responseText)}(i,s,o)}catch{}return l}(t,r,n)},e.allowFsRead=void 0,e.loadImageFile=e.loadFile}(Un.API),function(e){function t(){return(Qn.html2canvas?Promise.resolve(Qn.html2canvas):dm(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(Qn.DOMPurify?Promise.resolve(Qn.DOMPurify):dm(()=>import("./purify.es-B9ZVCkUG.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=Hi(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},i=function(l,c){var u=document.createElement(l);for(var d in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[d]=c.style[d];return u},s=function l(c,u){for(var d=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),f=c.firstChild;f;f=f.nextSibling)u!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||d.appendChild(l(f,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(d.value=c.value),d.addEventListener("load",function(){d.scrollTop=c.scrollTop,d.scrollLeft=c.scrollLeft},!0)),d},o=function l(c){var u=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),d=l.convert(Promise.resolve(),u);return(d=d.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(u){switch(n(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(u){return this.set({src:i("div",{innerHTML:l,dompurify:u})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var u=this.opt.jsPDF,d=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,h=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete h.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=d,d)for(var p=0;p<d.length;++p){var m=d[p],g=m.src.find(function(y){return y.format==="truetype"});g&&u.addFont(g.url,m.ref.name,m.ref.style)}return h.windowHeight=h.windowHeight||0,h.windowHeight=h.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):h.windowHeight,u.context2d.save(!0),c(this.prop.container,h)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(u){if(u in o.template.prop)return function(){this.prop[u]=l[u]};switch(u){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[u]=l[u]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var u=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(u):u})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(u,d){return Math.floor(u*d/72*96)}return this.then(function(){(l=l||Un.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,u,d){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,u,d){return this.setProgress(l?this.progress.val+l:null,c||null,u?this.progress.n+u:null,d?this.progress.stack.concat(d):null)},o.prototype.then=function(l,c){var u=this;return this.thenCore(l,c,function(d,f){return u.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(h){return u.updateProgress(null,d),h}).then(d,f).then(function(h){return u.updateProgress(1),h})})},o.prototype.thenCore=function(l,c,u){u=u||Promise.prototype.then;var d=this;l&&(l=l.bind(d)),c&&(c=c.bind(d));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?d:o.convert(Object.assign({},d),Promise.prototype),h=u.call(f,l,c);return o.convert(h,d.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(u){c=c.thenCore(u)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,Un.getPageSize=function(l,c,u){if(Hi(l)==="object"){var d=l;l=d.orientation,c=d.unit||c,u=d.format||u}c=c||"mm",u=u||"a4",l=(""+(l||"P")).toLowerCase();var f,h=(""+u).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+c}var m,g=0,y=0;if(p.hasOwnProperty(h))g=p[h][1]/f,y=p[h][0]/f;else try{g=u[1],y=u[0]}catch{throw new Error("Invalid format: "+u)}if(l==="p"||l==="portrait")l="p",y>g&&(m=y,y=g,g=m);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",g>y&&(m=y,y=g,g=m)}return{width:y,height:g,unit:c,k:f,orientation:l}},e.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(Nk):null;var u=new o(c);return c.worker?u:u.from(l).doCallback()}}(Un.API),Un.API.addJS=function(e){var t,r,n=e;return this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(t+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),r=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+n+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){t!==void 0&&r!==void 0&&this.internal.out("/Names <</JavaScript "+t+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),s=0;s<i.length;s++){var o=i[s],l=n.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,d=[];for(s=0;s<u;s++){var f=r.internal.newObject();d.push(f);var h=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+h.objId+" 0 R /XYZ null null null]>> endobj")}var p=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<d.length;s++)r.internal.write("(page_"+(s+1)+")"+d[s]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+p+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,s){var o={title:i,options:s,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var o=n.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var s=0;s<i.children.length;s++)n.count++,this.count_r(n,i.children[s]);return n.count}}])}(Un.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,i,s,o,l){var c,u=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(f){for(var h,p=256*f.charCodeAt(4)+f.charCodeAt(5),m=f.length,g={width:0,height:0,numcomponents:1},y=4;y<m;y+=2){if(y+=p,t.indexOf(f.charCodeAt(y+1))!==-1){h=256*f.charCodeAt(y+5)+f.charCodeAt(y+6),g={width:256*f.charCodeAt(y+7)+f.charCodeAt(y+8),height:h,numcomponents:f.charCodeAt(y+9)};break}p=256*f.charCodeAt(y+2)+f.charCodeAt(y+3)}return g}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}d={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:n,alias:i}}return d}}(Un.API),Un.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var i,s=pge(e,{checkCrc:!0}),o=s.width,l=s.height,c=s.channels,u=s.palette,d=s.depth;i=u&&c===1?function(L){for(var P=L.width,F=L.height,E=L.data,T=L.palette,B=L.depth,q=!1,U=[],se=[],de=void 0,z=!1,G=0,ie=0;ie<T.length;ie++){var Y=mO(T[ie],4),C=Y[0],K=Y[1],H=Y[2],R=Y[3];U.push(C,K,H),R!=null&&(R===0?(G++,se.length<1&&se.push(ie)):R<255&&(z=!0))}if(z||G>1){q=!0,se=void 0;var J=P*F;de=new Uint8Array(J);for(var V=new DataView(E.buffer),X=0;X<J;X++){var Q=Ek(V,X,B),ne=mO(T[Q],4)[3];de[X]=ne}}else G===0&&(se=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:q?8:void 0,colorBytes:E,alphaBytes:de,needSMask:q,palette:U,mask:se}}(s):c===2||c===4?function(L){for(var P=L.data,F=L.width,E=L.height,T=L.channels,B=L.depth,q=T===2?"DeviceGray":"DeviceRGB",U=T-1,se=F*E,de=U,z=se*de,G=1*se,ie=Math.ceil(z*B/8),Y=Math.ceil(G*B/8),C=new Uint8Array(ie),K=new Uint8Array(Y),H=new DataView(P.buffer),R=new DataView(C.buffer),J=new DataView(K.buffer),V=!1,X=0;X<se;X++){for(var Q=X*T,ne=0;ne<de;ne++)yM(R,Ek(H,Q+ne,B),X*de+ne,B);var oe=Ek(H,Q+de,B);oe<(1<<B)-1&&(V=!0),yM(J,oe,1*X,B)}return{colorSpace:q,colorsPerPixel:U,sMaskBitsPerComponent:V?B:void 0,colorBytes:C,alphaBytes:K,needSMask:V}}(s):function(L){var P=L.data,F=L.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:F,colorsPerPixel:F==="DeviceGray"?1:3,colorBytes:P instanceof Uint16Array?function(E){for(var T=E.length,B=new Uint8Array(2*T),q=new DataView(B.buffer,B.byteOffset,B.byteLength),U=0;U<T;U++)q.setUint16(2*U,E[U],!1);return B}(P):P,needSMask:!1}}(s);var f,h,p,m=i,g=m.colorSpace,y=m.colorsPerPixel,b=m.sMaskBitsPerComponent,v=m.colorBytes,w=m.alphaBytes,S=m.needSMask,k=m.palette,j=m.mask,A=null;return n!==Un.API.image_compression.NONE&&typeof J4=="function"?(A=function(L){var P;switch(L){case Un.API.image_compression.FAST:P=11;break;case Un.API.image_compression.MEDIUM:P=13;break;case Un.API.image_compression.SLOW:P=14;break;default:P=12}return P}(n),f=this.decode.FLATE_DECODE,h="/Predictor ".concat(A," /Colors ").concat(y," /BitsPerComponent ").concat(d," /Columns ").concat(o),e=hM(v,Math.ceil(o*y*d/8),y,d,n),S&&(p=hM(w,Math.ceil(o*b/8),1,b,n))):(f=void 0,h=void 0,e=v,S&&(p=w)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(p&&this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),{alias:r,data:e,index:t,filter:f,decodeParameters:h,transparency:j,palette:k,sMask:p,predictor:A,width:o,height:l,bitsPerComponent:d,sMaskBitsPerComponent:b,colorSpace:g}}},function(e){e.processGIF89A=function(t,r,n,i){var s=new Rge(t),o=s.width,l=s.height,c=[];s.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:o,height:l},d=new Tk(100).encode(u,100);return e.processJPEG.call(this,d,r,n,i)},e.processGIF87A=e.processGIF89A}(Un.API),iu.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:i,green:n,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},iu.prototype.parseBGR=function(){this.pos=this.offset;var e="bit"+this.bitPP,t=this.width*this.height*4;if(t>536870912)throw new Error("Image dimensions exceed 512MB, which is too large.");this.data=new Uint8Array(t);try{this[e]()}catch(r){ia.log("bit decode error:"+r)}},iu.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,i=0;i<t;i++)for(var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*i*4,l=0;l<8&&8*i+l<this.width;l++){var c=this.palette[s>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},iu.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<e;i++){var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*i*4,l=s>>4,c=15&s,u=this.palette[l];if(this.data[o]=u.blue,this.data[o+1]=u.green,this.data[o+2]=u.red,this.data[o+3]=255,2*i+1>=this.width)break;u=this.palette[c],this.data[o+4]=u.blue,this.data[o+4+1]=u.green,this.data[o+4+2]=u.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},iu.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*n;if(i<this.palette.length){var o=this.palette[i];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}e!==0&&(this.pos+=4-e)}},iu.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,l=(s>>5&t)/t*255|0,c=(s>>10&t)/t*255|0,u=s>>15?255:0,d=n*this.width*4+4*i;this.data[d]=c,this.data[d+1]=l,this.data[d+2]=o,this.data[d+3]=u}this.pos+=e}},iu.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&t)/t*255|0,c=(o>>5&r)/r*255|0,u=(o>>11)/t*255|0,d=i*this.width*4+4*s;this.data[d]=u,this.data[d+1]=c,this.data[d+2]=l,this.data[d+3]=255}this.pos+=e}},iu.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=s,this.data[o+1]=i,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},iu.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=s,this.data[l+1]=i,this.data[l+2]=n,this.data[l+3]=o}},iu.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,i){var s=new iu(t,!1),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new Tk(100).encode(c,100);return e.processJPEG.call(this,u,r,n,i)}}(Un.API),vM.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,i){var s=new vM(t),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new Tk(100).encode(c,100);return e.processJPEG.call(this,u,r,n,i)}}(Un.API),Un.API.processRGBA=function(e,t,r){for(var n=e.data,i=n.length,s=new Uint8Array(i/4*3),o=new Uint8Array(i/4),l=0,c=0,u=0;u<i;u+=4){var d=n[u],f=n[u+1],h=n[u+2],p=n[u+3];s[l++]=d,s[l++]=f,s[l++]=h,o[c++]=p}var m=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:m,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Un.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},bp=Un.API,Db=bp.getCharWidthsArray=function(e,t){var r,n,i=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:i.metadata.Unicode.widths,c=l.fof?l.fof:1,u=t.kerning?t.kerning:i.metadata.Unicode.kerning,d=u.fof?u.fof:1,f=t.doKerning!==!1,h=0,p=e.length,m=0,g=l[0]||c,y=[];for(r=0;r<p;r++)n=e.charCodeAt(r),typeof i.metadata.widthOfString=="function"?y.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+o*(1e3/s)||0)/1e3):(h=f&&Hi(u[n])==="object"&&!isNaN(parseInt(u[n][m],10))?u[n][m]/d:0,y.push((l[n]||g)/c+h)),m=n;return y},uM=bp.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),i=t.charSpace||this.internal.getCharSpace();return bp.processArabic&&(e=bp.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,i)/r:Db.apply(this,arguments).reduce(function(s,o){return s+o},0)},dM=function(e,t,r,n){for(var i=[],s=0,o=e.length,l=0;s!==o&&l+t[s]<r;)l+=t[s],s++;i.push(e.slice(0,s));var c=s;for(l=0;s!==o;)l+t[s]>n&&(i.push(e.slice(c,s)),l=0,c=s),l+=t[s],s++;return c!==s&&i.push(e.slice(c,s)),i},fM=function(e,t,r){r||(r={});var n,i,s,o,l,c,u,d=[],f=[d],h=r.textIndent||0,p=0,m=0,g=e.split(" "),y=Db.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var b=Array(c).join(" "),v=[];g.map(function(S){(S=S.split(/\s*\n/)).length>1?v=v.concat(S.map(function(k,j){return(j&&k.length?`
`:"")+k})):v.push(S[0])}),g=v,c=uM.apply(this,[b,r])}for(s=0,o=g.length;s<o;s++){var w=0;if(n=g[s],c&&n[0]==`
`&&(n=n.substr(1),w=1),h+p+(m=(i=Db.apply(this,[n,r])).reduce(function(S,k){return S+k},0))>t||w){if(m>t){for(l=dM.apply(this,[n,i,t-(h+p),t]),d.push(l.shift()),d=[l.pop()];l.length;)f.push([l.shift()]);m=i.slice(n.length-(d[0]?d[0].length:0)).reduce(function(S,k){return S+k},0)}else d=[n];f.push(d),h=m+c,p=y}else d.push(n),h+=p+m,p=y}return u=c?function(S,k){return(k?b:"")+S.join(" ")}:function(S){return S.join(" ")},f.map(u)},bp.splitTextToSize=function(e,t,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var f=this.internal.getFont(d.fontName,d.fontStyle),h="Unicode";return f.metadata[h]?{widths:f.metadata[h].widths||{0:1},kerning:f.metadata[h].kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/i;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,s.lineIndent=r.lineIndent;var l,c,u=[];for(l=0,c=n.length;l<c;l++)u=u.concat(fM.apply(this,[n[l],o,s]));return u},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},i={},s=0;s<16;s++)n[r[s]]=t[s],i[t[s]]=r[s];var o=function(h){return"0x"+parseInt(h,10).toString(16)},l=e.__fontmetrics__.compress=function(h){var p,m,g,y,b=["{"];for(var v in h){if(p=h[v],isNaN(parseInt(v,10))?m="'"+v+"'":(v=parseInt(v,10),m=(m=o(v).slice(2)).slice(0,-1)+i[m.slice(-1)]),typeof p=="number")p<0?(g=o(p).slice(3),y="-"):(g=o(p).slice(2),y=""),g=y+g.slice(0,-1)+i[g.slice(-1)];else{if(Hi(p)!=="object")throw new Error("Don't know what to do with value type "+Hi(p)+".");g=l(p)}b.push(m+g)}return b.push("}"),b.join("")},c=e.__fontmetrics__.uncompress=function(h){if(typeof h!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,m,g,y,b={},v=1,w=b,S=[],k="",j="",A=h.length-1,L=1;L<A;L+=1)(y=h[L])=="'"?p?(g=p.join(""),p=void 0):p=[]:p?p.push(y):y=="{"?(S.push([w,g]),w={},g=void 0):y=="}"?((m=S.pop())[0][m[1]]=w,g=void 0,w=m[0]):y=="-"?v=-1:g===void 0?n.hasOwnProperty(y)?(k+=n[y],g=parseInt(k,16)*v,v=1,k=""):k+=y:n.hasOwnProperty(y)?(j+=n[y],w[g]=parseInt(j,16)*v,v=1,g=void 0,j=""):j+=y;return b},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},f={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(h){var p=h.font,m=f.Unicode[p.postScriptName];m&&(p.metadata.Unicode={},p.metadata.Unicode.widths=m.widths,p.metadata.Unicode.kerning=m.kerning);var g=d.Unicode[p.postScriptName];g&&(p.metadata.Unicode.encoding=g,p.encoding=g.codePages[0])}])}(Un.API),function(e){var t=function(r){for(var n=r.length,i=new Uint8Array(n),s=0;s<n;s++)i[s]=r.charCodeAt(s);return i};e.API.events.push(["addFont",function(r){var n=void 0,i=r.font,s=r.instance;if(!i.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=s.existsFileInVFS(i.postScriptName)===!1?s.loadFile(i.postScriptName):s.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?t(l):t(Wv(l)),o.metadata=e.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(i,n)}}])}(Un),Un.API.addSvgAsImage=function(e,t,r,n,i,s,o,l){if(isNaN(t)||isNaN(r))throw ia.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(i))throw ia.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=i;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var d={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return(Qn.canvg?Promise.resolve(Qn.canvg):dm(()=>import("./index.es-CXNoY6J0.js"),[])).catch(function(h){return Promise.reject(new Error("Could not load canvg: "+h))}).then(function(h){return h.default?h.default:h}).then(function(h){return h.fromString(u,e,d)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(h){return h.render(d)}).then(function(){f.addImage(c.toDataURL("image/jpeg",1),t,r,n,i,o,l)})},Un.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(t,r);return this},Un.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,i,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],u=0,d=0,f=0;function h(m,g){var y,b=!1;for(y=0;y<m.length;y+=1)m[y]===g&&(b=!0);return b}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var p=l.length;for(f=0;f<p;f+=1)r[l[f]].value=r[l[f]].defaultValue,r[l[f]].explicitSet=!1}if(Hi(e)==="object"){for(i in e)if(s=e[i],h(l,i)&&s!==void 0){if(r[i].type==="boolean"&&typeof s=="boolean")r[i].value=s;else if(r[i].type==="name"&&h(r[i].valueSet,s))r[i].value=s;else if(r[i].type==="integer"&&Number.isInteger(s))r[i].value=s;else if(r[i].type==="array"){for(u=0;u<s.length;u+=1)if(n=!0,s[u].length===1&&typeof s[u][0]=="number")c.push(String(s[u]-1));else if(s[u].length>1){for(d=0;d<s[u].length;d+=1)typeof s[u][d]!="number"&&(n=!1);n===!0&&c.push([s[u][0]-1,s[u][1]-1].join(" "))}r[i].value="["+c.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var m,g=[];for(m in r)r[m].explicitSet===!0&&(r[m].type==="name"?g.push("/"+m+" /"+r[m].value):g.push("/"+m+" "+r[m].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},Un.API.addMetadata=function(e,t){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:e,namespaceUri:t??"http://jspdf.default.namespaceuri/",rawXml:typeof t=="boolean"&&t},this.internal.events.subscribe("putCatalog",Bge),this.internal.events.subscribe("postPutResources",Fge)),this},function(e){var t=e.API,r=t.pdfEscape16=function(s,o){for(var l,c=o.metadata.Unicode.widths,u=["","0","00","000","0000"],d=[""],f=0,h=s.length;f<h;++f){if(l=o.metadata.characterToGlyph(s.charCodeAt(f)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=s.charCodeAt(f),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return d.join("");l=l.toString(16),d.push(u[4-l.length],l)}return d.join("")},n=function(s){var o,l,c,u,d,f,h;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],f=0,h=(l=Object.keys(s).sort(function(p,m){return p-m})).length;f<h;f++)o=l[f],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(u=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+u+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="Identity-H"){for(var f=l.metadata.Unicode.widths,h=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),p="",m=0;m<h.length;m++)p+=String.fromCharCode(h[m]);var g=u();d({data:p,addLength1:!0,objectId:g}),c("endobj");var y=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:y}),c("endobj");var b=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Bp(l.fontName)),c("/FontFile2 "+g+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var v=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+Bp(l.fontName)),c("/FontDescriptor "+b+" 0 R"),c("/W "+e.API.PDFObject.convert(f)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+y+" 0 R"),c("/BaseFont /"+Bp(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+v+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]),t.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var f=l.metadata.rawData,h="",p=0;p<f.length;p++)h+=String.fromCharCode(f[p]);var m=u();d({data:h,addLength1:!0,objectId:m}),c("endobj");var g=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:g}),c("endobj");var y=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+m+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Bp(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var b=0;b<l.metadata.hmtx.widths.length;b++)l.metadata.hmtx.widths[b]=parseInt(l.metadata.hmtx.widths[b]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+Bp(l.fontName)+"/FontDescriptor "+y+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]);var i=function(s){var o,l=s.text||"",c=s.x,u=s.y,d=s.options||{},f=s.mutex||{},h=f.pdfEscape,p=f.activeFontKey,m=f.fonts,g=p,y="",b=0,v="",w=m[g].encoding;if(m[g].encoding!=="Identity-H")return{text:l,x:c,y:u,options:d,mutex:f};for(v=l,g=p,Array.isArray(l)&&(v=l[0]),b=0;b<v.length;b+=1)m[g].metadata.hasOwnProperty("cmap")&&(o=m[g].metadata.cmap.unicode.codeMap[v[b].charCodeAt(0)]),o||v[b].charCodeAt(0)<256&&m[g].metadata.hasOwnProperty("Unicode")?y+=v[b]:y+="";var S="";return parseInt(g.slice(1))<14||w==="WinAnsiEncoding"?S=h(y,g).split("").map(function(k){return k.charCodeAt(0).toString(16)}).join(""):w==="Identity-H"&&(S=r(y,m[g])),f.isHex=!0,{text:S,x:c,y:u,options:d,mutex:f}};t.events.push(["postProcessText",function(s){var o=s.text||"",l=[],c={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var u=0;for(u=0;u<o.length;u+=1)Array.isArray(o[u])&&o[u].length===3?l.push([i(Object.assign({},c,{text:o[u][0]})).text,o[u][1],o[u][2]]):l.push(i(Object.assign({},c,{text:o[u]})).text);s.text=l}else s.text=i(Object.assign({},c,{text:o})).text}])}(Un),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(Un.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var i,s,o,l,c,u,d,f=t,h=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],p=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],m={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},y=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],b=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),v=!1,w=0;this.__bidiEngine__={};var S=function(E){var T=E.charCodeAt(),B=T>>8,q=g[B];return q!==void 0?f[256*q+(255&T)]:B===252||B===253?"AL":b.test(B)?"L":B===8?"R":"N"},k=function(E){for(var T,B=0;B<E.length;B++){if((T=S(E.charAt(B)))==="L")return!1;if(T==="R")return!0}return!1},j=function(E,T,B,q){var U,se,de,z,G=T[q];switch(G){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":v=!1;break;case"N":case"AN":break;case"EN":v&&(G="AN");break;case"AL":v=!0,G="R";break;case"WS":case"BN":G="N";break;case"CS":q<1||q+1>=T.length||(U=B[q-1])!=="EN"&&U!=="AN"||(se=T[q+1])!=="EN"&&se!=="AN"?G="N":v&&(se="AN"),G=se===U?se:"N";break;case"ES":G=(U=q>0?B[q-1]:"B")==="EN"&&q+1<T.length&&T[q+1]==="EN"?"EN":"N";break;case"ET":if(q>0&&B[q-1]==="EN"){G="EN";break}if(v){G="N";break}for(de=q+1,z=T.length;de<z&&T[de]==="ET";)de++;G=de<z&&T[de]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(z=T.length,de=q+1;de<z&&T[de]==="NSM";)de++;if(de<z){var ie=E[q],Y=ie>=1425&&ie<=2303||ie===64286;if(U=T[de],Y&&(U==="R"||U==="AL")){G="R";break}}}G=q<1||(U=T[q-1])==="B"?"N":B[q-1];break;case"B":v=!1,i=!0,G=w;break;case"S":s=!0,G="N"}return G},A=function(E,T,B){var q=E.split("");return B&&L(q,B,{hiLevel:w}),q.reverse(),T&&T.reverse(),q.join("")},L=function(E,T,B){var q,U,se,de,z,G=-1,ie=E.length,Y=0,C=[],K=w?p:h,H=[];for(v=!1,i=!1,s=!1,U=0;U<ie;U++)H[U]=S(E[U]);for(se=0;se<ie;se++){if(z=Y,C[se]=j(E,H,C,se),q=240&(Y=K[z][m[C[se]]]),Y&=15,T[se]=de=K[Y][5],q>0)if(q===16){for(U=G;U<se;U++)T[U]=1;G=-1}else G=-1;if(K[Y][6])G===-1&&(G=se);else if(G>-1){for(U=G;U<se;U++)T[U]=de;G=-1}H[se]==="B"&&(T[se]=0),B.hiLevel|=de}s&&function(R,J,V){for(var X=0;X<V;X++)if(R[X]==="S"){J[X]=w;for(var Q=X-1;Q>=0&&R[Q]==="WS";Q--)J[Q]=w}}(H,T,ie)},P=function(E,T,B,q,U){if(!(U.hiLevel<E)){if(E===1&&w===1&&!i)return T.reverse(),void(B&&B.reverse());for(var se,de,z,G,ie=T.length,Y=0;Y<ie;){if(q[Y]>=E){for(z=Y+1;z<ie&&q[z]>=E;)z++;for(G=Y,de=z-1;G<de;G++,de--)se=T[G],T[G]=T[de],T[de]=se,B&&(se=B[G],B[G]=B[de],B[de]=se);Y=z}Y++}}},F=function(E,T,B){var q=E.split(""),U={hiLevel:w};return B||(B=[]),L(q,B,U),function(se,de,z){if(z.hiLevel!==0&&d)for(var G,ie=0;ie<se.length;ie++)de[ie]===1&&(G=y.indexOf(se[ie]))>=0&&(se[ie]=y[G+1])}(q,B,U),P(2,q,T,B,U),P(1,q,T,B,U),q.join("")};return this.__bidiEngine__.doBidiReorder=function(E,T,B){if(function(U,se){if(se)for(var de=0;de<U.length;de++)se[de]=de;l===void 0&&(l=k(U)),u===void 0&&(u=k(U))}(E,T),o||!c||u)if(o&&c&&l^u)w=l?1:0,E=A(E,T,B);else if(!o&&c&&u)w=l?1:0,E=F(E,T,B),E=A(E,T);else if(!o||l||c||u){if(o&&!c&&l^u)E=A(E,T),l?(w=0,E=F(E,T,B)):(w=1,E=F(E,T,B),E=A(E,T));else if(o&&l&&!c&&u)w=1,E=F(E,T,B),E=A(E,T);else if(!o&&!c&&l^u){var q=d;l?(w=1,E=F(E,T,B),w=0,d=!1,E=F(E,T,B),d=q):(w=0,E=F(E,T,B),E=A(E,T),w=1,d=!1,E=F(E,T,B),d=q,E=A(E,T))}}else w=0,E=F(E,T,B);else w=l?1:0,E=F(E,T,B);return E},this.__bidiEngine__.setOptions=function(E){E&&(o=E.isInputVisual,c=E.isOutputVisual,l=E.isInputRtl,u=E.isOutputRtl,d=E.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var i=n.text;n.x,n.y;var s=n.options||{};n.mutex,s.lang;var o=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(i)==="[object Array]"){var l=0;for(o=[],l=0;l<i.length;l+=1)Object.prototype.toString.call(i[l])==="[object Array]"?o.push([r.doBidiReorder(i[l][0]),i[l][1],i[l][2]]):o.push([r.doBidiReorder(i[l])]);n.text=o}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])}(Un),Un.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new gh(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new Jge(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new Ige(this.contents),this.head=new $ge(this),this.name=new Hge(this),this.cmap=new Iz(this),this.toUnicode={},this.hhea=new Uge(this),this.maxp=new Vge(this),this.hmtx=new Gge(this),this.post=new Wge(this),this.os2=new zge(this),this.loca=new Qge(this),this.glyf=new Kge(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,i,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,u;for(u=[],o=0,l=(c=this.bbox).length;o<l;o++)t=c[o],u.push(Math.round(t*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),32768&(r=i>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var i,s,o,l;for(o=0,s=0,l=(t=""+t).length;0<=l?s<l:s>l;s=0<=l?++s:--s)i=t.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return o*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var Au,gh=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,i;for(i=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(t.charCodeAt(r)));return i},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,i,s,o,l,c;return t=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^s)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*i+16777216*s+65536*o+256*l+c},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,i,s;for(s=[],n=0,i=t.length;n<i;n++)r=t[n],s.push(this.writeByte(r));return s},e}(),Ige=function(){var e;function t(r){var n,i,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,s=this.tableCount;0<=s?i<s:i>s;i=0<=s?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,i,s,o,l,c,u,d,f,h,p,m,g;for(g in p=Object.keys(r).length,c=Math.log(2),f=16*Math.floor(Math.log(p)/c),o=Math.floor(f/c),d=16*p-f,(i=new gh).writeInt(this.scalarType),i.writeShort(p),i.writeShort(f),i.writeShort(o),i.writeShort(d),s=16*p,u=i.pos+s,l=null,m=[],r)for(h=r[g],i.writeString(g),i.writeInt(e(h)),i.writeInt(u),i.writeInt(h.length),m=m.concat(h),g==="head"&&(l=u),u+=h.length;u%4;)m.push(0),u++;return i.write(m),n=2981146554-e(i.data),i.pos=l+8,i.writeUInt32(n),i.data},e=function(r){var n,i,s,o;for(r=Dz.call(r);r.length%4;)r.push(0);for(s=new gh(r),i=0,n=0,o=r.length;n<o;n=n+=4)i+=s.readUInt32();return 4294967295&i},t}(),Dge={}.hasOwnProperty,fd=function(e,t){for(var r in t)Dge.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};Au=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var $ge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return fd(e,Au),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new gh).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),wM=function(){function e(t,r){var n,i,s,o,l,c,u,d,f,h,p,m,g,y,b,v,w;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),f=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(p=t.readUInt16(),h=p/2,t.pos+=6,s=function(){var S,k;for(k=[],c=S=0;0<=h?S<h:S>h;c=0<=h?++S:--S)k.push(t.readUInt16());return k}(),t.pos+=2,g=function(){var S,k;for(k=[],c=S=0;0<=h?S<h:S>h;c=0<=h?++S:--S)k.push(t.readUInt16());return k}(),u=function(){var S,k;for(k=[],c=S=0;0<=h?S<h:S>h;c=0<=h?++S:--S)k.push(t.readUInt16());return k}(),d=function(){var S,k;for(k=[],c=S=0;0<=h?S<h:S>h;c=0<=h?++S:--S)k.push(t.readUInt16());return k}(),i=(this.length-t.pos+this.offset)/2,l=function(){var S,k;for(k=[],c=S=0;0<=i?S<i:S>i;c=0<=i?++S:--S)k.push(t.readUInt16());return k}(),c=b=0,w=s.length;b<w;c=++b)for(y=s[c],n=v=m=g[c];m<=y?v<=y:v>=y;n=m<=y?++v:--v)d[c]===0?o=n+u[c]:(o=l[d[c]/2+(n-m)-(h-c)]||0)!==0&&(o+=u[c]),this.codeMap[n]=65535&o}t.pos=f}return e.encode=function(t,r){var n,i,s,o,l,c,u,d,f,h,p,m,g,y,b,v,w,S,k,j,A,L,P,F,E,T,B,q,U,se,de,z,G,ie,Y,C,K,H,R,J,V,X,Q,ne,oe,O;switch(q=new gh,o=Object.keys(t).sort(function(W,ae){return W-ae}),r){case"macroman":for(g=0,y=function(){var W=[];for(m=0;m<256;++m)W.push(0);return W}(),v={0:0},s={},U=0,G=o.length;U<G;U++)v[Q=t[i=o[U]]]==null&&(v[Q]=++g),s[i]={old:t[i],new:v[t[i]]},y[i]=v[t[i]];return q.writeUInt16(1),q.writeUInt16(0),q.writeUInt32(12),q.writeUInt16(0),q.writeUInt16(262),q.writeUInt16(0),q.write(y),{charMap:s,subtable:q.data,maxGlyphID:g+1};case"unicode":for(T=[],f=[],w=0,v={},n={},b=u=null,se=0,ie=o.length;se<ie;se++)v[k=t[i=o[se]]]==null&&(v[k]=++w),n[i]={old:k,new:v[k]},l=v[k]-i,b!=null&&l===u||(b&&f.push(b),T.push(i),u=l),b=i;for(b&&f.push(b),f.push(65535),T.push(65535),F=2*(P=T.length),L=2*Math.pow(Math.log(P)/Math.LN2,2),h=Math.log(L/2)/Math.LN2,A=2*P-L,c=[],j=[],p=[],m=de=0,Y=T.length;de<Y;m=++de){if(E=T[m],d=f[m],E===65535){c.push(0),j.push(0);break}if(E-(B=n[E].new)>=32768)for(c.push(0),j.push(2*(p.length+P-m)),i=z=E;E<=d?z<=d:z>=d;i=E<=d?++z:--z)p.push(n[i].new);else c.push(B-E),j.push(0)}for(q.writeUInt16(3),q.writeUInt16(1),q.writeUInt32(12),q.writeUInt16(4),q.writeUInt16(16+8*P+2*p.length),q.writeUInt16(0),q.writeUInt16(F),q.writeUInt16(L),q.writeUInt16(h),q.writeUInt16(A),V=0,C=f.length;V<C;V++)i=f[V],q.writeUInt16(i);for(q.writeUInt16(0),X=0,K=T.length;X<K;X++)i=T[X],q.writeUInt16(i);for(ne=0,H=c.length;ne<H;ne++)l=c[ne],q.writeUInt16(l);for(oe=0,R=j.length;oe<R;oe++)S=j[oe],q.writeUInt16(S);for(O=0,J=p.length;O<J;O++)g=p[O],q.writeUInt16(g);return{charMap:n,subtable:q.data,maxGlyphID:w+1}}},e}(),Iz=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return fd(e,Au),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,i;for(t.pos=this.offset,this.version=t.readUInt16(),i=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=i?n<i:n>i;n=0<=i?++n:--n)r=new wM(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,i;return r==null&&(r="macroman"),n=wM.encode(t,r),(i=new gh).writeUInt16(0),i.writeUInt16(1),n.table=i.data.concat(n.subtable),n},e}(),Uge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return fd(e,Au),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),zge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return fd(e,Au),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),Wge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return fd(e,Au),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,i;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(n=t.readUInt16(),this.glyphNameIndex=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],i=[];t.pos<this.offset+this.length;)r=t.readByte(),i.push(this.names.push(t.readString(r)));return i;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=(function(){var o,l,c;for(c=[],s=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;s=0<=l?++o:--o)c.push(t.readUInt32());return c}).call(this)}},e}(),qge=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},Hge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return fd(e,Au),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,i,s,o,l,c,u,d,f,h;for(t.pos=this.offset,t.readShort(),r=t.readShort(),l=t.readShort(),n=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+l+t.readShort()});for(c={},s=d=0,f=n.length;d<f;s=++d)i=n[s],t.pos=i.offset,u=t.readString(i.length),o=new qge(u,i),c[h=i.nameID]==null&&(c[h]=[]),c[i.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e}(),Vge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return fd(e,Au),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),Gge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return fd(e,Au),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,i,s,o,l,c;for(t.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,d;for(d=[],r=u=0;0<=i?u<i:u>i;r=0<=i?++u:--u)d.push(t.readInt16());return d}(),this.widths=(function(){var u,d,f,h;for(h=[],u=0,d=(f=this.metrics).length;u<d;u++)s=f[u],h.push(s.advance);return h}).call(this),n=this.widths[this.widths.length-1],c=[],r=o=0;0<=i?o<i:o>i;r=0<=i?++o:--o)c.push(this.widths.push(n));return c},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),Dz=[].slice,Kge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return fd(e,Au),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,i,s,o,l,c,u,d,f;return t in this.cache?this.cache[t]:(s=this.file.loca,r=this.file.contents,n=s.indexOf(t),(i=s.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,o=(l=new gh(r.read(i))).readShort(),u=l.readShort(),f=l.readShort(),c=l.readShort(),d=l.readShort(),this.cache[t]=o===-1?new Xge(l,u,f,c,d):new Yge(l,o,u,f,c,d),this.cache[t]))},e.prototype.encode=function(t,r,n){var i,s,o,l,c;for(o=[],s=[],l=0,c=r.length;l<c;l++)i=t[r[l]],s.push(o.length),i&&(o=o.concat(i.encode(n)));return s.push(o.length),{table:o,offsets:s}},e}(),Yge=function(){function e(t,r,n,i,s,o){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=s,this.yMax=o,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),Xge=function(){function e(t,r,n,i,s){var o,l;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new gh(Dz.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),Qge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return fd(e,Au),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var i,s;for(s=[],n=0,i=this.length;n<i;n+=2)s.push(2*t.readUInt16());return s}).call(this):(function(){var i,s;for(s=[],n=0,i=this.length;n<i;n+=4)s.push(t.readUInt32());return s}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),i=0,s=0,o=0;o<n.length;++o)if(n[o]=i,s<r.length&&r[s]==o){++s,n[o]=i;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(i+=c)}for(var u=new Array(4*n.length),d=0;d<n.length;++d)u[4*d+3]=255&n[d],u[4*d+2]=(65280&n[d])>>8,u[4*d+1]=(16711680&n[d])>>16,u[4*d]=(4278190080&n[d])>>24;return u},e}(),Jge=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,i,s;for(r in i=this.font.cmap.tables[0].codeMap,t={},s=this.subset)n=s[r],t[r]=i[n];return t},e.prototype.glyphsFor=function(t){var r,n,i,s,o,l,c;for(i={},o=0,l=t.length;o<l;o++)i[s=t[o]]=this.font.glyf.glyphFor(s);for(s in r=[],i)(n=i[s])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(s in c=this.glyphsFor(r))n=c[s],i[s]=n;return i},e.prototype.encode=function(t,r){var n,i,s,o,l,c,u,d,f,h,p,m,g,y,b;for(i in n=Iz.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),p={0:0},b=n.charMap)p[(c=b[i]).old]=c.new;for(m in h=n.maxGlyphID,o)m in p||(p[m]=h++);return d=function(v){var w,S;for(w in S={},v)S[v[w]]=w;return S}(p),f=Object.keys(d).sort(function(v,w){return v-w}),g=function(){var v,w,S;for(S=[],v=0,w=f.length;v<w;v++)l=f[v],S.push(d[l]);return S}(),s=this.font.glyf.encode(o,g,p),u=this.font.loca.encode(s.offsets,g),y={cmap:this.font.cmap.raw(),glyf:s.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(y["OS/2"]=this.font.os2.raw()),this.font.directory.encode(y)},e}();Un.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,i,s,o;if(Array.isArray(r))return"["+function(){var l,c,u;for(u=[],l=0,c=r.length;l<c;l++)n=r[l],u.push(t.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in s=["<<"],r)o=r[i],s.push("/"+i+" "+t.convert(o));return s.push(">>"),s.join(`
`)}return""+r},t}();const Zge="/assets/logo-BRcnjZP7.jpg",exe="K RAMAKRISHNAN COLLEGE OF TECHNOLOGY, Autonomous";function $z(e){return String(e||"").trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_-]/g,"").slice(0,64)}function $b(e,t,r){const n=String(t??"");if(!n)return"";if(e.getTextWidth(n)<=r)return n;const i="",s=e.getTextWidth(i);if(s>=r)return"";let o=0,l=n.length;for(;o<l;){const c=Math.ceil((o+l)/2),u=n.slice(0,c);e.getTextWidth(u)+s<=r?o=c:l=c-1}return n.slice(0,Math.max(0,o))+i}function SM(e,t){const r=URL.createObjectURL(t),n=document.createElement("a");n.href=r,n.download=e,n.click(),setTimeout(()=>URL.revokeObjectURL(r),500)}async function txe(){var e;try{const t=await xr("/api/accounts/me/",{method:"GET"});if(!t.ok)return"";const r=await t.json(),n=String((r==null?void 0:r.username)||"").trim(),i=String(((e=r==null?void 0:r.profile)==null?void 0:e.staff_id)||"").trim();return n||i||""}catch{return""}}function Uz(e){const t=String(e.collegeName||exe).trim(),r=String(e.courseName||"").trim(),n=String(e.courseCode||"").trim(),i=String(e.staffName||"").trim(),s=String(e.className||"").trim();return[t,`Course Name: ${r||"-"}`,`Course Code: ${n||"-"}`,`Staff Name: ${i||"-"}`,`Class Name: ${s||"-"}`]}function rxe(e,t){const r=Uz(e),n=["S.No","Reg No","Name","Total"],i=t.map(s=>[s.sno,s.regNo,s.name,s.total]);return[...r.map(s=>[s,"","",""]),[""],[n[0],n[1],n[2],n[3]],...i]}function nxe(e,t,r){const i=vs.book_new(),s=[];for(let l=0;l<r.length;l+=45)s.push(r.slice(l,l+45));s.length===0&&s.push([]),s.forEach((l,c)=>{const u=vs.aoa_to_sheet(rxe(t,l));u["!freeze"]={xSplit:0,ySplit:7},u["!cols"]=[{wch:6},{wch:16},{wch:34},{wch:12}],vs.book_append_sheet(i,u,s.length>1?`Page_${c+1}`:"Sheet1")});const o=`${$z(e)||"marks"}_totals.xlsx`;uy(i,o)}function ixe(e,t){if(e.availableH=Math.max(60,e.bottomY-e.tableTopY),t.length<=1){e.colsNeeded=1,e.rowsPerCol=Math.max(1,t.length),e.colW=e.availableW;return}e.colsNeeded=2,e.colW=(e.availableW-e.colGap)/2;const r=Math.max(1,Math.ceil(t.length/2)),n=()=>e.headerRowH+r*e.rowH<=e.availableH;let i=0;for(;i++<30&&!n()&&e.rowH>6;)e.tableFont=Math.max(5,e.tableFont-.25),e.rowH=Math.max(6,e.rowH-1),e.headerRowH=Math.max(9,e.headerRowH-1);e.rowsPerCol=r}function _M(e,t,r){const n=new Un({orientation:e,unit:"pt",format:"a4"}),i=n.internal.pageSize.getWidth(),s=n.internal.pageSize.getHeight(),o=32,l=34,c=s-28,u=i-o*2,d=12,f=l,h=Math.max(60,c-f);let p=8,m=12,g=14;const y=10,b=()=>{const A=Math.max(1,Math.floor((h-g)/m)),L=Math.max(1,Math.ceil(r.length/A)),P=(u-y*(L-1))/L;return{rowsPerCol:A,colsNeeded:L,colW:P}};let{rowsPerCol:v,colsNeeded:w,colW:S}=b();const k=150;let j=0;for(;j++<12&&S<k&&w>1;)p=Math.max(6,p-.5),m=Math.max(9,m-1),g=Math.max(11,g-1),{rowsPerCol:v,colsNeeded:w,colW:S}=b();return{doc:n,marginX:o,topY:l,bottomY:c,tableTopY:f,availableW:u,availableH:h,tableFont:p,headerFont:d,rowH:m,headerRowH:g,colGap:y,colsNeeded:w,rowsPerCol:v,colW:S}}function axe(e,t,r,n){const i=t.tableTopY,s={sno:.12,reg:.3,name:.43,total:.15},o=t.colW*s.sno,l=t.colW*s.reg,c=t.colW*s.name,u=t.colW*s.total,d=3;e.setFontSize(t.tableFont);const f=[17,24,39],h=[255,255,255],p=[180,180,180];for(let m=0;m<t.colsNeeded;m++){const g=t.marginX+m*(t.colW+t.colGap);let y=i;e.setFillColor(f[0],f[1],f[2]),e.rect(g,y,t.colW,t.headerRowH,"F"),e.setTextColor(h[0],h[1],h[2]);const b=y+t.headerRowH-4;e.text("S.No",g+d,b),e.text("Reg No",g+o+d,b),e.text("Name",g+o+l+d,b),e.text("Total",g+o+l+c+d,b),e.setDrawColor(p[0],p[1],p[2]),e.rect(g,y,t.colW,t.headerRowH),e.line(g+o,y,g+o,y+t.headerRowH),e.line(g+o+l,y,g+o+l,y+t.headerRowH),e.line(g+o+l+c,y,g+o+l+c,y+t.headerRowH),y+=t.headerRowH,e.setTextColor(0,0,0);const v=m*t.rowsPerCol,w=Math.min(n.length,v+t.rowsPerCol);for(let S=v;S<w;S++){const k=n[S],j=y+(S-v)*t.rowH;e.rect(g,j,t.colW,t.rowH),e.line(g+o,j,g+o,j+t.rowH),e.line(g+o+l,j,g+o+l,j+t.rowH),e.line(g+o+l+c,j,g+o+l+c,j+t.rowH);const A=j+t.rowH-3,L=$b(e,String((k==null?void 0:k.sno)??""),Math.max(0,o-d*2)),P=$b(e,String((k==null?void 0:k.regNo)??""),Math.max(0,l-d*2)),F=$b(e,String((k==null?void 0:k.name)??""),Math.max(0,c-d*2)),E=$b(e,String((k==null?void 0:k.total)??""),Math.max(0,u-d*2));e.text(L,g+d,A),e.text(P,g+o+d,A),e.text(F,g+o+l+d,A),e.text(E,g+o+l+c+d,A)}}}async function sxe(e){try{const t=await fetch(e,{cache:"no-cache"});if(!t.ok)return null;const r=await t.blob();return await new Promise(n=>{const i=new FileReader;i.onload=()=>n(String(i.result||"")),i.onerror=()=>n(null),i.readAsDataURL(r)})}catch{return null}}async function oxe(e,t,r,n){const i=String((r==null?void 0:r.bannerUrl)||Zge),s=(r==null?void 0:r.bannerUrl)||i,o=await sxe(s),l=n.length>=55;let c=0;if(o)try{const h=new Image;h.src=o,await new Promise(A=>{h.onload=()=>A(!0),h.onerror=()=>A(!0)});const p=h.naturalWidth||h.width||1,m=h.naturalHeight||h.height||1,g=t.doc.internal.pageSize.getWidth(),y=l?135:170,b=g-2*t.marginX,v=p/m;let w=b,S=w/v;S>y&&(S=y,w=S*v);const k=(g-w)/2,j=12;t.doc.addImage(o,"PNG",k,j,w,S),c=S,t.tableTopY=j+S+(l?10:14)}catch{}else t.tableTopY=t.topY;const u=t.tableTopY;e.setFontSize(l?8:9),e.setTextColor(0,0,0);const d=[];r.courseName&&d.push(`Course Name: ${r.courseName}`),r.courseCode&&d.push(`Course Code: ${r.courseCode}`),r.staffName&&d.push(`Staff Name: ${r.staffName}`),r.className&&d.push(`Class Name: ${r.className}`);const f=l?10:11;for(let h=0;h<d.length;h++)e.text(d[h],t.marginX,u+h*f);return t.tableTopY=u+d.length*f+(l?6:10),ixe(t,n),axe(e,t,r,n)}async function Pk(e,t,r){const n=_M("portrait",t,r),s=n.colsNeeded>=4?_M("landscape",t,r):n;await oxe(s.doc,s,t,r);const o=s.doc.output("blob"),l=`${$z(e)||"marks"}_totals.pdf`;return{blob:o,filename:l}}function lxe(e,t,r){e.innerHTML="";const n=Uz(t),i=document.createElement("div");i.style.display="flex",i.style.flexDirection="column",i.style.gap="2px",i.style.marginBottom="10px",n.forEach(d=>{const f=document.createElement("div");f.textContent=d,f.style.fontWeight=d===n[0]?"900":"700",f.style.fontSize=d===n[0]?"14px":"12px",i.appendChild(f)}),e.appendChild(i);const s=document.createElement("div");s.className="obe-table-wrapper",s.style.maxHeight="420px",s.style.overflow="auto";const o=document.createElement("table");o.className="obe-table",o.style.minWidth="unset";const l=document.createElement("thead"),c=document.createElement("tr");["S.No","Reg No","Name","Total"].forEach(d=>{const f=document.createElement("th");f.textContent=d,c.appendChild(f)}),l.appendChild(c),o.appendChild(l);const u=document.createElement("tbody");r.forEach(d=>{const f=document.createElement("tr");[d.sno,d.regNo,d.name,d.total].forEach(h=>{const p=document.createElement("td");p.textContent=String(h??""),f.appendChild(p)}),u.appendChild(f)}),o.appendChild(u),s.appendChild(o),e.appendChild(s)}function cxe(e,t){e.innerHTML="";const r=URL.createObjectURL(t),n=document.createElement("iframe");return n.src=r,n.style.width="100%",n.style.height="520px",n.style.border="1px solid rgba(226,232,240,0.9)",n.style.borderRadius="10px",e.appendChild(n),()=>URL.revokeObjectURL(r)}async function uxe(e){if(typeof document>"u"||typeof window>"u"){const{blob:S,filename:k}=await Pk(e.filenameBase,e.meta,e.rows);SM(k,S);return}const t=document.createElement("div");t.setAttribute("role","dialog"),t.setAttribute("aria-modal","true"),t.style.position="fixed",t.style.inset="0",t.style.background="rgba(0,0,0,0.35)",t.style.display="grid",t.style.placeItems="center",t.style.padding="16px",t.style.zIndex="9999";const r=document.createElement("div");r.className="obe-card",r.style.width="min(980px, 100%)",r.style.maxHeight="min(92vh, 900px)",r.style.overflow="auto";const n=document.createElement("div");n.textContent="Preview totals before download",n.style.fontWeight="950",n.style.fontSize="14px",n.style.marginBottom="10px";const i=document.createElement("div");i.style.display="flex",i.style.gap="8px",i.style.flexWrap="wrap",i.style.alignItems="center",i.style.justifyContent="space-between",i.style.marginBottom="10px";const s=document.createElement("div");s.style.display="flex",s.style.gap="8px",s.style.flexWrap="wrap";const o=document.createElement("button");o.className="obe-btn obe-btn-secondary",o.textContent="Excel preview";const l=document.createElement("button");l.className="obe-btn obe-btn-primary",l.textContent="PDF preview",s.appendChild(o),s.appendChild(l);const c=document.createElement("div");c.style.display="flex",c.style.gap="8px",c.style.flexWrap="wrap";const u=document.createElement("button");u.className="obe-btn",u.textContent="Close";const d=document.createElement("button");d.className="obe-btn obe-btn-success",d.textContent="Download",c.appendChild(u),c.appendChild(d),i.appendChild(s),i.appendChild(c);const f=document.createElement("div");r.appendChild(n),r.appendChild(i),r.appendChild(f),t.appendChild(r);let h="pdf",p=null,m=null;const g=()=>{o.className=h==="excel"?"obe-btn obe-btn-primary":"obe-btn obe-btn-secondary",l.className=h==="pdf"?"obe-btn obe-btn-primary":"obe-btn obe-btn-secondary"},y=async()=>{if(p&&(p(),p=null),f.innerHTML="",g(),h==="excel"){m=null,lxe(f,e.meta,e.rows);return}m=await Pk(e.filenameBase,e.meta,e.rows),p=cxe(f,m.blob)};let b=!1;const v=()=>{if(!b){b=!0,p&&p();try{window.removeEventListener("keydown",w),t.remove()}catch{}}},w=S=>{S.key==="Escape"&&v()};t.addEventListener("click",S=>{S.target===t&&v()}),u.addEventListener("click",v),o.addEventListener("click",()=>{h="excel",y()}),l.addEventListener("click",()=>{h="pdf",y()}),d.addEventListener("click",async()=>{if(h==="excel"){nxe(e.filenameBase,e.meta,e.rows);return}const S=m||await Pk(e.filenameBase,e.meta,e.rows);SM(S.filename,S.blob)}),window.addEventListener("keydown",w),document.body.appendChild(t),y()}async function fy(e){const t={...e.meta};t.staffName||(t.staffName=await txe());const r=(e.rows||[]).filter(n=>n&&n.regNo);await uxe({filenameBase:e.filenameBase,meta:t,rows:r})}const Ok={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},kM=[{key:"q1",label:"Q1",max:2,co:1,btl:1},{key:"q2",label:"Q2",max:2,co:1,btl:3},{key:"q3",label:"Q3",max:2,co:1,btl:4},{key:"q4",label:"Q4",max:2,co:2,btl:1},{key:"q5",label:"Q5",max:2,co:2,btl:1},{key:"q6",label:"Q6",max:2,co:2,btl:2},{key:"q7",label:"Q7",max:16,co:1,btl:2},{key:"q8",label:"Q8",max:16,co:2,btl:3},{key:"q9",label:"Q9",max:16,co:"1&2",btl:5}];function jM(e){if(e==="both")return"both";if(e==="1&2"||e==="3&4")return e;if(typeof e=="string"){const r=e.trim();if(r==="1&2"||r==="1,2"||r==="1/2"||r==="2/1")return"1&2";if(r==="3&4"||r==="3,4"||r==="3/4"||r==="4/3")return"3&4";if(r==="5")return 5;if(r==="4")return 4;if(r==="3")return 3;if(r==="2")return 2;if(r==="1")return 1}if(Array.isArray(e)){const r=e.map(n=>Number(n)).filter(n=>Number.isFinite(n));if(r.includes(3)&&r.includes(4))return"3&4";if(r.includes(1)&&r.includes(2))return"1&2";if(r.includes(4))return 4;if(r.includes(3))return 3;if(r.includes(2))return 2;if(r.includes(1))return 1}const t=Number(e);return t===5?5:t===4?4:t===3?3:t===2?2:t===34?"3&4":t===12?"1&2":1}function dxe(e){return e==="cia2"?{a:3,b:4}:{a:1,b:2}}function sA(e){return e==="both"||e==="1&2"||e==="3&4"}function fxe(e,t){if(sA(e))return{a:.5,b:.5};const r=t.a===3,n=e===t.a||r&&e===1,i=e===t.b||r&&e===2;return n?{a:1,b:0}:i?{a:0,b:1}:{a:0,b:0}}function Ub(e,t,r){const n=e[t];if(!n)return{a:0,b:0};if(sA(n.co))return{a:.5,b:.5};const i=e.some(l=>sA(l.co)),s=t===e.length-1,o=String(n.key||"").toLowerCase()==="q9"||String(n.label||"").toLowerCase().includes("q9");return!i&&s&&o?{a:.5,b:.5}:fxe(n.co,r)}function Oh(e){return Object.fromEntries((e||[]).map(t=>[t.key,t.btl]))}function wd(e,t,r){return Math.max(t,Math.min(r,e))}function Sd(e,t){if(!t)return"-";const r=e/t*100;if(!Number.isFinite(r))return"-";const n=r.toFixed(1);return n.endsWith(".0")?n.slice(0,-2):n}function zb(e,t){return`${e}_sheet_${t}`}function hxe(e,t){if(!t.length)return;const r=Object.keys(t[0]),n=[r.join(",")].concat(t.map(l=>r.map(c=>{const u=l[c],d=String(u??"").replace(/\n/g," ");return d.includes(",")||d.includes('"')?`"${d.replace(/"/g,'""')}"`:d}).join(","))).join(`
`),i=new Blob([n],{type:"text/csv"}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function zz({subjectId:e,teachingAssignmentId:t,assessmentKey:r,classType:n,questionPaperType:i}){const s=r||"cia1",o=s==="cia2"?"CIA 2":"CIA 1",l=x.useMemo(()=>dxe(s),[s]),[c,u]=x.useState(null),[d,f]=x.useState(null),[h,p]=x.useState(null),[m,g]=x.useState(null),y=x.useMemo(()=>{const we=String(ti(n)||"").trim().toUpperCase();return we?we==="THEORY"?"THEORY":we:""},[n]),b=x.useMemo(()=>{const we=String(i??"").trim().toUpperCase();return we==="QP2"?"QP2":we==="QP1"?"QP1":""},[i]);x.useEffect(()=>{let we=!0;return(async()=>{var Yr,ct;if(!y){p(null);return}const Ze=y==="THEORY"&&b||null,bt=s==="cia2"?"CIA2":"CIA1";let St=null,Sr=[];try{St=await ah({class_type:y,question_paper_type:Ze,exam:bt}),Sr=Array.isArray((Yr=St==null?void 0:St.pattern)==null?void 0:Yr.marks)?St.pattern.marks:[]}catch{}if(!Sr.length)try{St=await ah({class_type:y,question_paper_type:Ze,exam:"CIA"}),Sr=Array.isArray((ct=St==null?void 0:St.pattern)==null?void 0:ct.marks)?St.pattern.marks:[]}catch{}we&&p(Sr.length?St.pattern:null)})(),()=>{we=!1}},[y,b,s]);const v=x.useMemo(()=>{var St,Sr,Yr,ct;const we=((Sr=(St=c==null?void 0:c.assessments)==null?void 0:St[s])==null?void 0:Sr.questions)??((ct=(Yr=c==null?void 0:c.assessments)==null?void 0:Yr.cia1)==null?void 0:ct.questions),Ie=Array.isArray(we)&&we.length?we.map($t=>({key:String(($t==null?void 0:$t.key)||""),label:String(($t==null?void 0:$t.label)||($t==null?void 0:$t.key)||""),max:Number(($t==null?void 0:$t.max)||0),co:jM($t==null?void 0:$t.co),btl:Math.min(6,Math.max(1,Number(($t==null?void 0:$t.btl)||1)))})).filter($t=>$t.key):kM,Ze=Array.isArray(h==null?void 0:h.marks)?h.marks:null,bt=Array.isArray(h==null?void 0:h.cos)?h.cos:null;return Array.isArray(Ze)&&Ze.length?Ze.map(($t,qe)=>{const Ye=Ie[qe],ot=bt?bt[qe]:void 0;return{key:`q${qe+1}`,label:`Q${qe+1}`,max:Number($t)||0,co:ot!=null?jM(ot):(Ye==null?void 0:Ye.co)??l.a,btl:(Ye==null?void 0:Ye.btl)??1}}).filter($t=>!!$t.key):Ie},[c,s,h,l.a]),[w,S]=x.useState(!1),[k,j]=x.useState(!1),[A,L]=x.useState(!1),[P,F]=x.useState(null),[E,T]=x.useState([]),[B,q]=x.useState({}),[U,se]=x.useState(null),[de,z]=x.useState(null),[G,ie]=x.useState(!1),[Y,C]=x.useState(!1),[K,H]=x.useState(null),[R,J]=x.useState(null),V=x.useRef(null),[X,Q]=x.useState(!1),[ne,oe]=x.useState(""),[O,W]=x.useState(!1),[ae,I]=x.useState(null),[Z,me]=x.useState(!1),[Te,Ae]=x.useState(null),[Be,Ee]=x.useState(null),{data:ze,loading:Xe,error:Pt,remainingSeconds:ft,publishAllowed:He,refresh:tt}=V0({assessment:s,subjectCode:e,teachingAssignmentId:t}),_e=!!(ze!=null&&ze.global_override_active&&(ze==null?void 0:ze.global_is_open)===!1),{data:Se,refresh:he}=G0({assessment:s,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:ye}=oc({assessment:s,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!1}}),{data:ht}=oc({assessment:s,subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:t,options:{poll:!1}}),[Ge,lt]=x.useState(""),[jt,wt]=x.useState(!1),[yt,Fr]=x.useState(null),[Tt,hr]=x.useState({termLabel:"KRCT AY25-26",batchLabel:e,questionBtl:Oh(kM),rowsByStudentId:{},markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null}),rn=x.useRef(null),[en,$r]=x.useState(!1),[Kr,Rn]=x.useState(null),[Pr,Sn]=x.useState(!1),[Me,je]=x.useState(null),[Mt,pt]=x.useState([]),[Ut,ir]=x.useState([]),[fr,vr]=x.useState([]),[re,le]=x.useState(null);x.useEffect(()=>{le(null),I(null)},[e]);const te=!!de||!!(Se!=null&&Se.exists&&(Se!=null&&Se.is_published)),ue=!!Tt.markManagerLocked;Tt.markManagerSnapshot!=null;const Ne=ht!=null&&ht.approval_until?String(ht.approval_until):null,ke=ye!=null&&ye.approval_until?String(ye.approval_until):null,vt=!!(ht!=null&&ht.allowed_by_approval)&&!!Ne&&Ne!==((re==null?void 0:re.markEntryApprovalUntil)??null),rt=!!(ye!=null&&ye.allowed_by_approval)&&!!ke&&ke!==((re==null?void 0:re.markManagerApprovalUntil)??null),De=te?!!(Se!=null&&Se.entry_open)||vt||rt:!0,We=!!(te&&!De),st=!!(_e||(te?!De:!ue)),zt=!!(te&&We),{pending:Wt,pendingUntilMs:xt,setPendingUntilMs:Dt,refresh:Vt}=K0({enabled:!!zt&&!!e,assessment:s,subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:t});Y0(!!X||!!G||!!Kr);function gr(we,Ie){return JSON.stringify({assessmentKey:s,totalsMax:bn,questions:(v||[]).map(Ze=>({key:Ze.key,label:Ze.label,max:Ze.max})),questionBtl:we,mark_manager:{questions:(Ie==null?void 0:Ie.questions)??[],marks:(Ie==null?void 0:Ie.marks)??[],btls:(Ie==null?void 0:Ie.btls)??[]}})}async function sr(){if(e){Sn(!0),je(null);try{const we=await il({assessment:s,subject_code:String(e),scope:"MARK_MANAGER",reason:`Edit request: Mark Manager changes for ${o} ${e}`,teaching_assignment_id:t});alert(al(we))}catch(we){const Ie=sl(we,"Request failed");je(Ie),alert(`Edit request failed: ${Ie}`)}finally{Sn(!1)}}}async function Lr(){if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}if(Wt){I("Edit request is pending. Please wait for approval.");return}const Ie=String(ne||"").trim();if(!Ie){I("Reason is required.");return}W(!0);try{const Ze=await il({assessment:s,subject_code:String(e),scope:"MARK_ENTRY",reason:Ie,teaching_assignment_id:t});I(al(Ze).replace(/\n/g,"  ")),Q(!1),oe(""),Dt(Date.now()+24*60*60*1e3);try{Vt({silent:!0})}catch{}he({silent:!0})}catch(Ze){const bt=sl(Ze,"Request failed");alert(`Edit request failed: ${bt}`)}finally{W(!1)}}async function Zr(){if(O)return;if(Wt){I("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}F(null),I(null),oe(""),Q(!0)}x.useEffect(()=>{if(!e||!te||De)return;const we=window.setInterval(()=>{he({silent:!0})},3e4);return()=>window.clearInterval(we)},[De,te,e,he]);const Er=x.useRef(!!De);x.useEffect(()=>{if(!e||!te)return;if(Er.current||!De){Er.current=!!De;return}let Ie=!0;return(async()=>{try{const Ze=await ei(s,e);if(!Ie)return;const bt=Ze==null?void 0:Ze.draft;bt&&typeof bt=="object"?hr(St=>({...St,termLabel:String(bt.termLabel||St.termLabel),batchLabel:e,questionBtl:bt.questionBtl&&typeof bt.questionBtl=="object"?bt.questionBtl:St.questionBtl,rowsByStudentId:bt.rowsByStudentId&&typeof bt.rowsByStudentId=="object"?bt.rowsByStudentId:St.rowsByStudentId,markManagerLocked:bt.markManagerLocked??St.markManagerLocked,markManagerSnapshot:bt.markManagerSnapshot??St.markManagerSnapshot,markManagerApprovalUntil:bt.markManagerApprovalUntil??St.markManagerApprovalUntil})):qt(!0)}catch{try{qt(!0)}catch{}}})(),Er.current=!!De,()=>{Ie=!1}},[De,te,e,s]);const qt=async we=>{if(e){we||(H(null),C(!0));try{const Ie=await w0(s,e,t),Ze=Ie&&Ie.data!=null?Ie.data:null;J(Ze)}catch(Ie){we||H((Ie==null?void 0:Ie.message)||"Failed to load published sheet")}finally{we||C(!1)}}};x.useEffect(()=>{G&&(J(null),qt(!1))},[G,e,s]);async function zr(){if(e){Sn(!0),je(null);try{const we=gr(Tt.questionBtl,{questions:Mt,marks:Ut,btls:fr}),Ie=ye!=null&&ye.approval_until?String(ye.approval_until):Tt.markManagerApprovalUntil||null,Ze={...Tt,markManagerLocked:!0,markManagerSnapshot:we,markManagerApprovalUntil:Ie},bt={termLabel:Ze.termLabel,batchLabel:e,questionBtl:Ze.questionBtl,rowsByStudentId:Ze.rowsByStudentId,markManagerLocked:Ze.markManagerLocked,markManagerSnapshot:Ze.markManagerSnapshot,markManagerApprovalUntil:Ze.markManagerApprovalUntil};hr(Ze),Rn(null),await Ri(s,e,bt),se(new Date().toLocaleString());try{await dh(s,String(e),t),he({silent:!0})}catch(St){console.warn("confirmMarkManagerLock failed",St)}}catch(we){je((we==null?void 0:we.message)||"Save failed")}finally{Sn(!1)}}}x.useEffect(()=>{if(!(!Kr||Kr.mode!=="confirm"))try{if(Tt.markManagerSnapshot){const we=JSON.parse(String(Tt.markManagerSnapshot)),Ie=we&&we.mark_manager||{};pt(Array.isArray(Ie.questions)?Ie.questions.map(Ze=>Number(Ze)).filter(Ze=>Number.isFinite(Ze)):[]),ir(Array.isArray(Ie.marks)?Ie.marks.map(Ze=>Number(Ze)).filter(Ze=>Number.isFinite(Ze)):[]),vr(Array.isArray(Ie.btls)?Ie.btls.map(Ze=>Number(Ze)).filter(Ze=>Number.isFinite(Ze)):[])}else pt([]),ir([]),vr([])}catch{pt([]),ir([]),vr([])}},[Kr]),x.useEffect(()=>{let we=!0;return(async()=>{try{const Ie=await ku();if(!we)return;u(Ie||null),f(null),hr(Ze=>({...Ze,termLabel:String((Ie==null?void 0:Ie.termLabel)||Ze.termLabel||"KRCT AY25-26"),batchLabel:e}))}catch(Ie){if(!we)return;u(null),f((Ie==null?void 0:Ie.message)||"Failed to load OBE Master config; using derived maxima from questions.")}})(),()=>{we=!1}},[e]),x.useEffect(()=>{let we=!0;return(async()=>{if(e){S(!0),F(null);try{let Ze=null,bt=null;try{bt=(await fc()||[]).find($e=>{const kt=String($e.subject_code||"").trim().toUpperCase()===String(e||"").trim().toUpperCase();return(t?$e.id===t:!1)||kt})}catch{}if(bt&&bt.elective_subject_id&&!bt.section_id)try{const ot=await xr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(bt.elective_subject_id))}`);if(ot.ok){const $e=await ot.json();Ze={students:((Array.isArray($e.results)?$e.results:Array.isArray($e)?$e:$e.items||[])||[]).map(It=>({id:Number(It.student_id??It.id),reg_no:String(It.reg_no??It.regno??""),name:String(It.name??It.full_name??It.username??""),section:It.section_name??It.section??null})),marks:{}}}}catch(ot){console.warn("Elective-choices fetch failed, falling back:",ot)}if(!Ze)try{Ze=await L9(s,e,t)}catch(ot){if(console.warn("CIA marks fetch failed:",ot),bt&&bt.id)try{Ze={students:(await Vc(bt.id)).students||[],marks:{}}}catch{console.warn("TA roster fallback failed")}if(!Ze)throw ot}if(!we)return;let St=(Ze.students||[]).slice().sort((ot,$e)=>{const kt=String((ot==null?void 0:ot.name)||"").trim().toLowerCase(),It=String(($e==null?void 0:$e.name)||"").trim().toLowerCase();if(kt&&It){const Zt=kt.localeCompare(It);if(Zt)return Zt}else if(kt||It)return kt?-1:1;return String((ot==null?void 0:ot.reg_no)||"").localeCompare(String(($e==null?void 0:$e.reg_no)||""),void 0,{numeric:!0,sensitivity:"base"})});T(St),g((Ze==null?void 0:Ze.subject)||null);const Sr=Ze.marks||{},Yr={};for(const[ot,$e]of Object.entries(Sr)){const kt=Number(ot);if(!Number.isFinite(kt))continue;if($e==null||$e===""){Yr[kt]=null;continue}const It=Number($e);Yr[kt]=Number.isFinite(It)?It:null}q(Yr);try{let ot=null;if(s==="cia1"?ot=await ty(e):ot=await w0("cia2",e),ot&&ot.data&&typeof ot.data=="object"){const $e=ot.data,kt=$e.rowsByStudentId||$e.rows||$e.sheet&&$e.sheet.rowsByStudentId||{},It={};for(const[mn,hn]of Object.entries(kt||{})){const Tn=String(mn),Ir=hn,gn={},fn=Ir.q||Ir.answers||Ir.questions||Ir;if(fn&&typeof fn=="object")for(const[ve,at]of Object.entries(fn)){const Re=Number(at);gn[ve]=Number.isFinite(Re)?Re:""}It[Tn]={studentId:Number(Tn)||0,absent:!!Ir.absent,absentKind:Ir.absentKind||void 0,reg_no:String(Ir.reg_no||Ir.reg_no_text||""),q:gn}}const Zt=Array.isArray($e.questions)?Object.fromEntries($e.questions.map(mn=>[String(mn.key||mn.label||""),Number(mn.btl||mn.btl_level||1)])):Oh(v),sn=Object.fromEntries(Object.entries(Zt).map(([mn,hn])=>{const Tn=Number(hn);return Number.isFinite(Tn)&&Tn>=1&&Tn<=6?[mn,Tn]:[mn,""]}));hr({termLabel:String($e.termLabel||(c==null?void 0:c.termLabel)||"KRCT AY25-26"),batchLabel:e,questionBtl:sn,rowsByStudentId:It}),z(new Date().toLocaleString());try{Kn(zb(s,e),{termLabel:String($e.termLabel||(c==null?void 0:c.termLabel)||"KRCT AY25-26"),batchLabel:e,questionBtl:sn,rowsByStudentId:It})}catch{}}}catch{}const ct=Jn(zb(s,e)),$t=ct&&typeof ct=="object"?{termLabel:c!=null&&c.termLabel?String(c.termLabel):String(ct.termLabel||"KRCT AY25-26"),batchLabel:e,questionBtl:ct.questionBtl&&typeof ct.questionBtl=="object"?ct.questionBtl:Oh(v),rowsByStudentId:ct.rowsByStudentId&&typeof ct.rowsByStudentId=="object"?ct.rowsByStudentId:{}}:{termLabel:String((c==null?void 0:c.termLabel)||"KRCT AY25-26"),batchLabel:e,questionBtl:Oh(v),rowsByStudentId:{}},qe={...Oh(v),...$t.questionBtl||{}};for(const ot of v){const $e=qe[ot.key];$e===""||$e===1||$e===2||$e===3||$e===4||$e===5||$e===6||(qe[ot.key]="")}const Ye={...$t.rowsByStudentId};for(const ot of Ze.students||[]){const $e=String(ot.id);if(Ye[$e]){const kt=!!Ye[$e].absent,It=String(Ye[$e].absentKind||"").toUpperCase(),Zt=kt?It==="ML"||It==="SKL"||It==="AL"?It:"AL":void 0;Ye[$e]={studentId:ot.id,absent:kt,absentKind:Zt,reg_no:ot.reg_no||"",q:{...Ye[$e].q}}}else Ye[$e]={studentId:ot.id,absent:!1,absentKind:void 0,reg_no:ot.reg_no||"",q:Object.fromEntries(v.map(kt=>[kt.key,""]))};for(const kt of v)kt.key in(Ye[$e].q||{})||(Ye[$e].q[kt.key]="")}hr({...$t,questionBtl:qe,termLabel:$t.termLabel||String((c==null?void 0:c.termLabel)||"KRCT AY25-26"),batchLabel:e,rowsByStudentId:Ye})}catch(Ze){if(!we)return;F((Ze==null?void 0:Ze.message)||`Failed to load ${o} roster`)}finally{we&&S(!1)}}})(),()=>{we=!1}},[e,t,c,v,s,o]),x.useEffect(()=>{let we=!0;return(async()=>{if(e)try{const Ie=await ei(s,e);if(!we)return;const Ze=Ie==null?void 0:Ie.draft;if(Ze&&typeof Ze=="object"){hr(bt=>({...bt,termLabel:String(Ze.termLabel||bt.termLabel),batchLabel:e,questionBtl:Ze.questionBtl&&typeof Ze.questionBtl=="object"?Ze.questionBtl:bt.questionBtl,rowsByStudentId:Ze.rowsByStudentId&&typeof Ze.rowsByStudentId=="object"?Ze.rowsByStudentId:bt.rowsByStudentId}));try{const bt=zb(s,e);Kn(bt,{termLabel:String(Ze.termLabel||"KRCT AY25-26"),batchLabel:String(e),questionBtl:Ze.questionBtl&&typeof Ze.questionBtl=="object"?Ze.questionBtl:Oh(v),rowsByStudentId:Ze.rowsByStudentId&&typeof Ze.rowsByStudentId=="object"?Ze.rowsByStudentId:{}})}catch{}}}catch{if(!we)return}})(),()=>{we=!1}},[e,s,v]);const bn=x.useMemo(()=>v.reduce((we,Ie)=>we+Ie.max,0),[v]),or=x.useMemo(()=>{let we=0,Ie=0;for(let Ze=0;Ze<v.length;Ze++){const bt=v[Ze],St=Ub(v,Ze,l);we+=bt.max*St.a,Ie+=bt.max*St.b}return{a:we,b:Ie}},[v,l]),kr=x.useMemo(()=>{var bt,St,Sr,Yr;const we=((St=(bt=c==null?void 0:c.assessments)==null?void 0:bt[s])==null?void 0:St.coMax)??((Yr=(Sr=c==null?void 0:c.assessments)==null?void 0:Sr.cia1)==null?void 0:Yr.coMax),Ie=Number((we==null?void 0:we[`co${l.a}`])??(we==null?void 0:we.co1)),Ze=Number((we==null?void 0:we[`co${l.b}`])??(we==null?void 0:we.co2));return{a:Number.isFinite(Ie)?Math.max(0,Ie):or.a,b:Number.isFinite(Ze)?Math.max(0,Ze):or.b}},[c,or,s,l]),Tr=x.useMemo(()=>{const we=new Set;for(const Ie of v){const Ze=(Tt.questionBtl||{})[Ie.key];(Ze===1||Ze===2||Ze===3||Ze===4||Ze===5||Ze===6)&&we.add(Ze)}return[1,2,3,4,5,6].filter(Ie=>we.has(Ie))},[Tt.questionBtl,v]),Or=x.useMemo(()=>{const we={1:0,2:0,3:0,4:0,5:0,6:0};for(const Ie of v){const Ze=(Tt.questionBtl||{})[Ie.key];(Ze===1||Ze===2||Ze===3||Ze===4||Ze===5||Ze===6)&&(we[Ze]+=Ie.max)}return we},[Tt.questionBtl,v]),Gt=x.useMemo(()=>{var Ze,bt,St,Sr;const we=((bt=(Ze=c==null?void 0:c.assessments)==null?void 0:Ze[s])==null?void 0:bt.btlMax)??((Sr=(St=c==null?void 0:c.assessments)==null?void 0:St.cia1)==null?void 0:Sr.btlMax),Ie=(Yr,ct)=>{const $t=Number(we==null?void 0:we[Yr]);return Number.isFinite($t)?Math.max(0,$t):ct};return{1:Ie("1",Or[1]),2:Ie("2",Or[2]),3:Ie("3",Or[3]),4:Ie("4",Or[4]),5:Ie("5",Or[5]),6:Ie("6",Or[6])}},[c,Or,s]),ur=(we,Ie)=>{A||st||hr(Ze=>{const bt=String(we),St=Ze.rowsByStudentId[bt]||{studentId:we,absent:!1,absentKind:void 0,reg_no:"",q:Object.fromEntries(v.map(Yr=>[Yr.key,""]))},Sr=Ie?{...St,absent:!0,absentKind:St.absentKind||"AL",q:Object.fromEntries(v.map(Yr=>[Yr.key,""]))}:{...St,absent:!1,absentKind:void 0};return{...Ze,rowsByStudentId:{...Ze.rowsByStudentId,[bt]:Sr}}})},Ve=(we,Ie)=>{A||st||hr(Ze=>{const bt=String(we),St=Ze.rowsByStudentId[bt]||{studentId:we,absent:!0,absentKind:"AL",reg_no:"",q:Object.fromEntries(v.map(Sr=>[Sr.key,""]))};return{...Ze,rowsByStudentId:{...Ze.rowsByStudentId,[bt]:{...St,absent:!0,absentKind:Ie}}}})},Rt=(we,Ie)=>{if(A||_e)return;const Ze=Tt.markManagerSnapshot!=null;ue&&Ze||We||hr(bt=>({...bt,questionBtl:{...bt.questionBtl||Oh(v),[we]:Ie}}))};x.useEffect(()=>{if(!e)return;let we=!1;const Ie=setTimeout(async()=>{try{const Ze={termLabel:Tt.termLabel,batchLabel:e,questionBtl:Tt.questionBtl,rowsByStudentId:Tt.rowsByStudentId};await Ri(s,e,Ze);try{const bt=zb(s,e);Kn(bt,{termLabel:Tt.termLabel,batchLabel:e,questionBtl:Tt.questionBtl,rowsByStudentId:Tt.rowsByStudentId})}catch{}we||se(new Date().toLocaleString())}catch{}},700);return()=>{we=!0,clearTimeout(Ie)}},[Tt.questionBtl,e,Tt.rowsByStudentId,s]);const _t=(we,Ie,Ze)=>{A||st||hr(bt=>{const St=String(we),Sr=bt.rowsByStudentId[St]||{studentId:we,absent:!1,absentKind:void 0,reg_no:"",q:Object.fromEntries(v.map(It=>[It.key,""]))},Yr=!!Sr.absent,ct=Yr?String(Sr.absentKind||"AL").toUpperCase():"";if(Yr&&!!!(Z&&Yr))return bt;const qe=v.find(It=>It.key===Ie),Ye=(qe==null?void 0:qe.max)??bn,ot=Ze===""?"":wd(Number(Ze||0),0,Ye),$e=Sr.absent?Sr.absentKind||"AL":null,kt=$e==="ML"?60:$e==="SKL"?75:null;return kt!=null&&v.reduce((Zt,sn)=>{const mn=sn.key===Ie?ot:(Sr.q||{})[sn.key];return Zt+wd(Number(mn||0),0,sn.max)},0)>kt?(Ee({title:"Mark limit exceeded",message:ct==="ML"?"For malpractice the total mark assigned is 60":"For Sick leave the Total mark assigned is 75"}),bt):{...bt,rowsByStudentId:{...bt.rowsByStudentId,[St]:{...Sr,q:{...Sr.q||{},[Ie]:ot}}}}})},Xt=we=>!we||!we.q?!1:v.some(Ie=>{const Ze=we.q[Ie.key];return Ze!==""&&Ze!==null&&Ze!==void 0});x.useMemo(()=>{const we={};for(const Ie of E){const Ze=Tt.rowsByStudentId[String(Ie.id)];if(!Ze){we[Ie.id]=null;continue}if(Ze.absent&&String(Ze.absentKind||"AL").toUpperCase()==="AL"){we[Ie.id]=0;continue}const bt=v.reduce((St,Sr)=>{var Yr;return St+wd(Number(((Yr=Ze.q)==null?void 0:Yr[Sr.key])||0),0,Sr.max)},0);we[Ie.id]=bt}return we},[E,Tt.rowsByStudentId,v]);const Ue=x.useRef(Tt);Ue.current=Tt,x.useEffect(()=>{const we=()=>{if(!e||E.length===0||st||_e)return;const Ie=Ue.current,Ze={termLabel:Ie.termLabel,batchLabel:e,questionBtl:Ie.questionBtl,rowsByStudentId:Ie.rowsByStudentId};Ri(s,e,Ze).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",we),()=>window.removeEventListener("obe:before-tab-switch",we)},[e,s,E.length,st,_e]);const Ct=async()=>{j(!0),F(null);try{const we={termLabel:Tt.termLabel,batchLabel:e,questionBtl:Tt.questionBtl,rowsByStudentId:Tt.rowsByStudentId};await Ri(s,e,we),se(new Date().toLocaleString())}catch(we){F((we==null?void 0:we.message)||`Failed to save ${o} draft`)}finally{j(!1)}},et=async()=>{var we;if(e){if(_e){F("Publishing is locked by IQAC.");return}if(!He){F("Publish window is closed. Please request IQAC approval.");return}if(te&&We){if(Wt){F("Edit request is pending. Please wait for approval.");return}await Zr();return}L(!0),F(null),I(null);try{const Ie={};for(const[bt,St]of Object.entries(Tt.rowsByStudentId||{})){const Sr=St||{},Yr=Xt(Sr);Sr.absent&&Yr?Ie[bt]={...Sr,absent:!1,absentKind:void 0}:Ie[bt]=Sr}const Ze={...Tt,batchLabel:e,questions:v,rowsByStudentId:Ie};await M9(s,e,Ze,t),z(new Date().toLocaleString()),le({markEntryApprovalUntil:Ne,markManagerApprovalUntil:ke}),hr(bt=>({...bt,markManagerLocked:!0})),tt(),he({silent:!0}),qt(!0);try{console.debug("obe:published dispatch",{assessment:s,subjectId:e}),window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:s}}))}catch{}setTimeout(()=>{try{if(G&&V.current){const bt=V.current;bt.scrollTop=bt.scrollHeight}}catch{}},50)}catch(Ie){const Ze=Ie==null?void 0:Ie.status;if(String(((we=Ie==null?void 0:Ie.body)==null?void 0:we.detail)||(Ie==null?void 0:Ie.message)||""),Ze===423){z(bt=>bt||new Date().toLocaleString()),tt(),he({silent:!0}),F(null),await Zr();return}F((Ie==null?void 0:Ie.message)||`Failed to publish ${o}`)}finally{L(!1)}}},ut=async()=>{wt(!0),Fr(null),F(null);try{await _h({assessment:s,subject_code:e,reason:Ge,teaching_assignment_id:t}),Fr("Request sent to IQAC for approval.")}catch(we){F((we==null?void 0:we.message)||"Failed to request approval")}finally{wt(!1),tt()}},Bt=()=>{const we=E.map((Ie,Ze)=>{const bt=Tt.rowsByStudentId[String(Ie.id)]||{studentId:Ie.id,absent:!1,absentKind:void 0,q:Object.fromEntries(v.map(It=>[It.key,""]))},St=Xt(bt),Sr=!!(bt.absent&&!St),Yr=Sr?String(bt.absentKind||"AL"):"";if(Sr){const It=Object.fromEntries(v.map(Zt=>[Zt.key,""]));return{sno:Ze+1,registerNo:Ie.reg_no,name:Ie.name,absent:1,absentKind:Yr,...It,total:"ABSENT",[`co${l.a}_mark`]:"",[`co${l.a}_pct`]:"",[`co${l.b}_mark`]:"",[`co${l.b}_pct`]:"",...Object.fromEntries(Tr.flatMap(Zt=>[[`btl${Zt}_mark`,""],[`btl${Zt}_pct`,""]]))}}const ct=0,$t="",qe=Object.fromEntries(v.map(It=>{var Zt;return[It.key,wd(Number(((Zt=bt.q)==null?void 0:Zt[It.key])||0),0,It.max)]})),Ye=v.reduce((It,Zt)=>It+Number(qe[Zt.key]||0),0);let ot=0,$e=0;for(let It=0;It<v.length;It++){const Zt=v[It],sn=Ub(v,It,l),mn=Number(qe[Zt.key]||0);ot+=mn*sn.a,$e+=mn*sn.b}const kt={1:0,2:0,3:0,4:0,5:0,6:0};for(const It of v){const Zt=(Tt.questionBtl||{})[It.key];(Zt===1||Zt===2||Zt===3||Zt===4||Zt===5||Zt===6)&&(kt[Zt]+=Number(qe[It.key]||0))}return{sno:Ze+1,registerNo:Ie.reg_no,name:Ie.name,absent:ct,absentKind:$t,...qe,total:Ye,[`co${l.a}_mark`]:ot,[`co${l.a}_pct`]:Sd(ot,kr.a),[`co${l.b}_mark`]:$e,[`co${l.b}_pct`]:Sd($e,kr.b),...Object.fromEntries(Tr.flatMap(It=>[[`btl${It}_mark`,kt[It]],[`btl${It}_pct`,Sd(kt[It],Gt[It])]]))}});hxe(`${e}_${s.toUpperCase()}_sheet.csv`,we)},Kt=async()=>{try{const we=new URLSearchParams;t&&we.set("teaching_assignment_id",String(t)),b&&we.set("question_paper_type",String(b));const bt=`${(Ok==null?void 0:Ok.VITE_API_BASE)||(typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":"https://db.krgi.co.in")}/api/obe/cia-export-template/${encodeURIComponent(s)}/${encodeURIComponent(e)}${we.toString()?`?${we.toString()}`:""}`,St=await xr(bt,{method:"GET"});if(!St.ok){const $t=await St.text();throw new Error($t||`Export failed (${St.status})`)}const Sr=await St.blob(),Yr=window.URL.createObjectURL(Sr),ct=document.createElement("a");ct.href=Yr,ct.download=`${e}_${s.toUpperCase()}_template.xlsx`,document.body.appendChild(ct),ct.click(),window.URL.revokeObjectURL(Yr),document.body.removeChild(ct)}catch(we){alert((we==null?void 0:we.message)||"Failed to export Excel")}},Jt=async()=>{const we=E.map((bt,St)=>{const Sr=Tt.rowsByStudentId[String(bt.id)]||{studentId:bt.id,absent:!1,q:Object.fromEntries(v.map(Ye=>[Ye.key,""]))},Yr=Xt(Sr);if(!!(Sr.absent&&!Yr))return{sno:St+1,regNo:String(bt.reg_no||""),name:String(bt.name||""),total:"ABSENT"};const $t=Object.fromEntries(v.map(Ye=>{var ot;return[Ye.key,wd(Number(((ot=Sr.q)==null?void 0:ot[Ye.key])||0),0,Ye.max)]})),qe=v.reduce((Ye,ot)=>Ye+Number($t[ot.key]||0),0);return{sno:St+1,regNo:String(bt.reg_no||""),name:String(bt.name||""),total:qe}}),Ie=String((m==null?void 0:m.name)||"").trim(),Ze=String((m==null?void 0:m.code)||e||"").trim();await fy({filenameBase:`${e}_${o}`,meta:{courseName:Ie,courseCode:Ze,className:String((m==null?void 0:m.className)||"")},rows:we})},ar=async we=>{if(!(A||st||en)){$r(!0);try{const Ie=await we.arrayBuffer(),Ze=C0(Ie,{type:"array"}),bt=Ze.Sheets[Ze.SheetNames[0]],St=vs.sheet_to_json(bt,{header:1});if(St.length<2)throw new Error("Excel file is empty or has no data rows");const Sr=St[0],Yr=Sr.findIndex(Zt=>String(Zt||"").toLowerCase().includes("register")),ct=Sr.findIndex(Zt=>String(Zt||"").toLowerCase().includes("status"));if(Yr===-1)throw new Error('Could not find "Register No" column in Excel file');const $t=2,qe=ct!==-1?ct:Sr.length,Ye=[];for(let Zt=$t;Zt<qe;Zt++){const sn=String(Sr[Zt]||"").trim();if(!sn)continue;const mn=sn.match(/^([QqOo]\d+|[A-Za-z]\d*)/);if(!mn)continue;const hn=mn[1].toUpperCase();if(b==="QP2"&&hn==="Q10"){Ye.push({colIdx:Zt,qKey:"q9",mode:"sum"});continue}if(b==="QP2"&&hn==="Q9"){Ye.push({colIdx:Zt,qKey:"q9",mode:"set"});continue}const Tn=v.find(Ir=>Ir.label.toUpperCase()===hn||Ir.key.toUpperCase()===hn.toUpperCase());Tn&&Ye.push({colIdx:Zt,qKey:Tn.key,mode:"set"})}if(Ye.length===0)throw new Error("No matching question columns found in Excel file");const ot=new Map;E.forEach(Zt=>{const sn=String(Zt.reg_no||"").trim().toUpperCase();sn&&ot.set(sn,Zt)});let $e=0,kt=0;const It={...Tt.rowsByStudentId};for(let Zt=1;Zt<St.length;Zt++){const sn=St[Zt];if(!sn||sn.length===0)continue;const mn=String(sn[Yr]||"").trim().toUpperCase();if(!mn)continue;const hn=ot.get(mn);if(!hn){kt++;continue}const Tn=String(hn.id),Ir=It[Tn]||{studentId:hn.id,absent:!1,absentKind:void 0,reg_no:hn.reg_no,q:Object.fromEntries(v.map(Re=>[Re.key,""]))},gn={...Ir.q};let fn=!1;const ve={};for(const{colIdx:Re,qKey:dt,mode:Rr}of Ye){const nn=sn[Re];if(nn==null||nn===""){Rr==="set"&&(gn[dt]="");continue}const tn=Number(nn);if(!Number.isFinite(tn)){Rr==="set"&&(gn[dt]="");continue}if(Rr==="sum"){ve[dt]=(ve[dt]??0)+tn;continue}const _n=v.find(Hn=>Hn.key===dt),zn=(_n==null?void 0:_n.max)??bn;gn[dt]=wd(tn,0,zn),fn=!0}for(const[Re,dt]of Object.entries(ve)){const Rr=Number(gn[Re]===""?0:gn[Re]||0),nn=v.find(zn=>zn.key===Re),tn=(nn==null?void 0:nn.max)??bn,_n=wd(Rr+dt,0,tn);gn[Re]=_n,fn=!0}let at=Ir.absent;ct!==-1&&(at=String(sn[ct]||"").trim().toLowerCase()==="absent"),It[Tn]={...Ir,q:gn,absent:at},(fn||at!==Ir.absent)&&$e++}hr(Zt=>({...Zt,rowsByStudentId:It})),alert(`Import successful!
Imported: ${$e} students
Skipped: ${kt} rows (no matching register number)`)}catch(Ie){alert(`Failed to import Excel: ${(Ie==null?void 0:Ie.message)||"Unknown error"}`),console.error("Import error:",Ie)}finally{$r(!1),rn.current&&(rn.current.value="")}}},nt=we=>{var Ze;const Ie=(Ze=we.target.files)==null?void 0:Ze[0];Ie&&ar(Ie)},Ht=()=>{rn.current&&rn.current.click()};if(w)return a.jsxs("div",{style:{color:"#6b7280"},children:["Loading ",o," roster"]});const Pe=E.some(we=>{var Ie;return!!((Ie=Tt.rowsByStudentId[String(we.id)])!=null&&Ie.absent)}),Ot=Z?E.filter(we=>{var Ie;return Te&&Te.length?Te.includes(we.id):!!((Ie=Tt.rowsByStudentId[String(we.id)])!=null&&Ie.absent)}):E,mt={border:"1px solid #111",padding:"4px 4px",background:"#ecfdf5",color:"#065f46",textAlign:"center",fontWeight:700,fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},Nt={border:"1px solid #111",padding:"4px 4px",fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},er={width:"100%",border:"none",outline:"none",background:"transparent",fontSize:11},pr=32;return a.jsxs(ag,{children:[Be?a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(15,23,42,0.45)",display:"flex",alignItems:"center",justifyContent:"center",padding:16,zIndex:50},onClick:()=>Ee(null),children:a.jsxs("div",{style:{width:"min(520px, 100%)",background:"#fff",borderRadius:14,border:"1px solid rgba(15,23,42,0.10)",boxShadow:"0 20px 60px rgba(2,6,23,0.25)",padding:14},onClick:we=>we.stopPropagation(),children:[a.jsx("div",{style:{fontWeight:900,marginBottom:6},children:Be.title}),a.jsx("div",{style:{fontSize:13,color:"#334155",marginBottom:12},children:Be.message}),a.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:a.jsx("button",{className:"obe-btn",onClick:()=>Ee(null),children:"Close"})})]})}):null,P&&a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:P}),d&&a.jsx("div",{style:{background:"#fffbeb",border:"1px solid #f59e0b55",color:"#92400e",padding:10,borderRadius:10,marginBottom:10},children:d}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",marginBottom:10},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsxs("button",{className:"obe-btn obe-btn-secondary",disabled:!Pe,onClick:()=>{if(Z)return;const we=E.filter(Ie=>{var Ze;return!!((Ze=Tt.rowsByStudentId[String(Ie.id)])!=null&&Ze.absent)}).map(Ie=>Ie.id);Ae(we),me(!0)},title:Pe?"Filter the table to show only absentees":"No absentees marked yet",style:Z?{background:"linear-gradient(180deg, #111827, #334155)",color:"#fff",borderColor:"rgba(2,6,23,0.12)"}:void 0,children:["Show absentees list",Z?a.jsx("span",{onClick:we=>{we.stopPropagation(),me(!1),Ae(null)},role:"button","aria-label":"Close absentees list",title:"Close absentees list",style:{marginLeft:10,display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:999,background:"rgba(255,255,255,0.18)",border:"1px solid rgba(255,255,255,0.25)",fontWeight:900,lineHeight:1,cursor:"pointer",userSelect:"none"},children:""}):null]}),a.jsx("button",{onClick:Bt,className:"obe-btn obe-btn-secondary",disabled:E.length===0,children:"Export CSV"}),a.jsx("button",{onClick:Kt,className:"obe-btn obe-btn-secondary",disabled:E.length===0,children:"Export Excel"}),a.jsx("button",{onClick:Ht,className:"obe-btn obe-btn-secondary",disabled:en||E.length===0||st||_e,children:en?"Importing":"Import Excel"}),a.jsx("input",{ref:rn,type:"file",accept:".xlsx,.xls",onChange:nt,style:{display:"none"}})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:Jt,className:"obe-btn obe-btn-secondary",disabled:E.length===0,children:"Download"}),a.jsx("button",{onClick:Ct,className:"obe-btn obe-btn-success",disabled:k||E.length===0||st||_e,children:k?"Saving":"Save Draft"}),a.jsx("button",{onClick:et,disabled:zt?Wt:A||E.length===0||!He||st||_e,className:"obe-btn obe-btn-primary",children:zt?Wt?"Request Pending":"Request Edit":A?"Publishing":"Publish"}),U&&a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Saved: ",U]}),de&&a.jsxs("div",{style:{fontSize:12,color:"#16a34a",alignSelf:"center"},children:["Published: ",de]})]})]}),a.jsx("div",{style:{marginBottom:10,fontSize:12,color:He?"#065f46":"#b91c1c"},children:Xe?"Checking publish due time":Pt||(ze!=null&&ze.due_at?a.jsxs(a.Fragment,{children:["Due: ",new Date(ze.due_at).toLocaleString(),"  Remaining: ",ng(ft),ze.allowed_by_approval&&ze.approval_until?a.jsxs(a.Fragment,{children:["  Approved until ",new Date(ze.approval_until).toLocaleString()]}):null]}):"Due time not set by IQAC.")}),_e?a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),a.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:a.jsx("button",{className:"obe-btn",onClick:()=>tt(),disabled:Xe,children:"Refresh"})})]}):He?null:a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fecaca",background:"#fff7ed",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publish time is over"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:"Send a request to IQAC to approve publishing."}),a.jsx("textarea",{value:Ge,onChange:we=>lt(we.target.value),placeholder:"Reason (optional)",rows:3,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:[a.jsx("button",{className:"obe-btn",onClick:()=>tt(),disabled:jt||Xe,children:"Refresh"}),a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:ut,disabled:jt,children:jt?"Requesting":"Request Approval"})]}),yt?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:yt}):null]}),a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff",marginBottom:10},children:a.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[a.jsxs("label",{style:{fontSize:12,color:"#374151"},children:["Term",a.jsx("div",{style:{marginLeft:8,padding:6,border:"1px solid #d1d5db",borderRadius:8,minWidth:160},children:Tt.termLabel})]}),a.jsxs("label",{style:{fontSize:12,color:"#374151"},children:["Sheet Label",a.jsx("div",{style:{marginLeft:8,padding:6,border:"1px solid #d1d5db",borderRadius:8,minWidth:160},children:Tt.batchLabel})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Total max: ",bn," | Questions: ",v.length," | COs: ",l.a,"",l.b," | BTLs: 16"]})]})}),E.length===0?a.jsx("div",{style:{color:"#6b7280",fontSize:14,padding:"12px 0"},children:"No students found for this subject."}):a.jsxs("div",{style:{position:"relative"},children:[a.jsxs(ig,{locked:_e,children:[a.jsxs("div",{style:{marginBottom:10,width:"100%",maxWidth:1200,marginLeft:"auto",marginRight:"auto"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"Mark Manager"}),a.jsxs("div",{style:{border:"1px solid #fcd34d",background:ue?"#f3f4f6":"#fff7ed",padding:12,borderRadius:12,width:"100%",display:"flex",justifyContent:"space-between",gap:10,alignItems:"center",flexWrap:"wrap"},children:[a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"baseline",flexWrap:"wrap",minWidth:0},children:[a.jsx("div",{style:{fontWeight:950,color:"#111827"},children:"BTL configuration"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Set BTL per question in the BTL row, then confirm."})]}),a.jsx("div",{style:{display:"flex",gap:8},children:a.jsx("button",{className:"obe-btn obe-btn-success",disabled:!e||Pr,onClick:()=>Rn({mode:ue?"request":"confirm"}),children:ue?"Edit":"Save"})})]}),Me?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#991b1b"},children:Me}):null]}),a.jsx("div",{className:"obe-table-wrapper",style:{width:"100%",maxWidth:"100%",overflowX:"scroll",overflowY:"hidden",WebkitOverflowScrolling:"touch",overscrollBehaviorX:"contain",scrollbarGutter:"stable",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{className:"obe-table",style:{width:"max-content",minWidth:"100%",tableLayout:"auto",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:mt,colSpan:4+v.length+1+4+Tr.length*2,children:[Tt.termLabel," | ",Tt.batchLabel," | ",o]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...mt,width:pr,minWidth:pr},rowSpan:3,children:"S.No"}),a.jsx("th",{style:{...mt,minWidth:70,overflow:"visible",textOverflow:"clip"},rowSpan:3,children:"R.No"}),a.jsx("th",{style:{...mt,minWidth:240,overflow:"visible",textOverflow:"clip"},rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:{...mt,minWidth:88},rowSpan:3,children:"AB"}),a.jsx("th",{style:mt,colSpan:v.length,children:"QUESTIONS"}),a.jsx("th",{style:mt,rowSpan:3,children:"Total"}),a.jsx("th",{style:mt,colSpan:4,children:"CO ATTAINMENT"}),Tr.length?a.jsx("th",{style:mt,colSpan:Tr.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[v.map(we=>a.jsx("th",{style:{...mt,width:46,minWidth:46},children:we.label},we.key)),a.jsxs("th",{style:mt,colSpan:2,children:["CO-",l.a]}),a.jsxs("th",{style:mt,colSpan:2,children:["CO-",l.b]}),Tr.map(we=>a.jsxs("th",{style:mt,colSpan:2,children:["BTL-",we]},`btl-head-${we}`))]}),a.jsxs("tr",{children:[v.map(we=>a.jsx("th",{style:{...mt,width:46,minWidth:46},children:we.max},we.key)),Array.from({length:2+Tr.length}).flatMap((we,Ie)=>a.jsxs(on.Fragment,{children:[a.jsx("th",{style:mt,children:a.jsx("div",{style:{whiteSpace:"pre-line",lineHeight:"0.9",fontSize:"0.7em"},children:`M
A
R
K`})}),a.jsx("th",{style:mt,children:"%"})]},Ie))]})]}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...Nt,fontWeight:700,textAlign:"center"},colSpan:3}),a.jsx("td",{style:{...Nt,fontWeight:700,textAlign:"center"},children:"BTL"}),v.map(we=>a.jsx("td",{style:{...Nt,textAlign:"center"},children:(()=>{const Ie=(Tt.questionBtl||{})[we.key]??"",Ze=Ie===""?"-":String(Ie);return a.jsxs("div",{style:{position:"relative",minWidth:44},children:[a.jsx("div",{style:{width:"100%",fontSize:12,padding:"2px 4px",border:"1px solid #d1d5db",borderRadius:8,background:"#fff",textAlign:"center",userSelect:"none"},title:`BTL: ${Ze}`,children:Ze}),a.jsxs("select",{"aria-label":`BTL for ${we.label}`,value:Ie,onChange:bt=>Rt(we.key,bt.target.value===""?"":Number(bt.target.value)),style:{position:"absolute",inset:0,width:"100%",height:"100%",opacity:0,cursor:"pointer",appearance:"none",WebkitAppearance:"none",MozAppearance:"none"},children:[a.jsx("option",{value:"",children:"-"}),[1,2,3,4,5,6].map(bt=>a.jsx("option",{value:bt,children:bt},bt))]})]})})()},`btl-select-${we.key}`)),a.jsx("td",{style:{...Nt,fontWeight:700,textAlign:"center"}}),a.jsx("td",{style:{...Nt,fontWeight:700,textAlign:"center"},colSpan:4}),Tr.map(we=>a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...Nt,fontWeight:700,textAlign:"center"}}),a.jsx("td",{style:{...Nt,fontWeight:700,textAlign:"center"}})]},`btl-pad-${we}`))]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...Nt,fontWeight:700,textAlign:"center"},colSpan:3,children:"Name / Max Marks"}),a.jsx("td",{style:{...Nt,fontWeight:700,textAlign:"center"},children:"-"}),v.map(we=>a.jsx("td",{style:{...Nt,fontWeight:700,textAlign:"center"},children:we.max},we.key)),a.jsx("td",{style:{...Nt,fontWeight:700,textAlign:"center"},children:bn}),a.jsx("td",{style:{...Nt,fontWeight:700,textAlign:"center"},children:kr.a}),a.jsx("td",{style:{...Nt,fontWeight:700,textAlign:"center"},children:"%"}),a.jsx("td",{style:{...Nt,fontWeight:700,textAlign:"center"},children:kr.b}),a.jsx("td",{style:{...Nt,fontWeight:700,textAlign:"center"},children:"%"}),Tr.map(we=>a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...Nt,fontWeight:700,textAlign:"center"},children:Gt[we]}),a.jsx("td",{style:{...Nt,fontWeight:700,textAlign:"center"},children:"%"})]},`btl-max-${we}`))]}),Ot.map((we,Ie)=>{const Ze=Tt.rowsByStudentId[String(we.id)]||{studentId:we.id,reg_no:we.reg_no??"",absent:!1,absentKind:void 0,q:Object.fromEntries(v.map($e=>[$e.key,""]))},bt=Object.fromEntries(v.map($e=>{var kt;return[$e.key,wd(Number(((kt=Ze.q)==null?void 0:kt[$e.key])||0),0,$e.max)]})),St=v.reduce(($e,kt)=>$e+Number(bt[kt.key]||0),0);let Sr=0,Yr=0;for(let $e=0;$e<v.length;$e++){const kt=v[$e],It=Ub(v,$e,l),Zt=Number(bt[kt.key]||0);Sr+=Zt*It.a,Yr+=Zt*It.b}const ct={1:0,2:0,3:0,4:0,5:0,6:0};for(const $e of v){const kt=(Tt.questionBtl||{})[$e.key];(kt===1||kt===2||kt===3||kt===4||kt===5||kt===6)&&(ct[kt]+=Number(bt[$e.key]||0))}const $t=Ze.absent?{background:"#f1f5f9"}:void 0;Ze.absent&&String(Ze.absentKind||"AL").toUpperCase();const qe=!!(Z&&Ze.absent),Ye=!!(A||st||_e||We),ot=B[we.id];return a.jsxs("tr",{style:$t,children:[a.jsx("td",{style:{...Nt,textAlign:"center",width:pr,minWidth:pr,paddingLeft:2,paddingRight:2},children:Ie+1}),a.jsx("td",{style:{...Nt,minWidth:70,overflow:"visible",textOverflow:"clip"},children:AM(Ze.reg_no)}),a.jsx("td",{style:{...Nt,minWidth:240,overflow:"visible",textOverflow:"clip"},children:we.name}),a.jsx("td",{style:{...Nt,textAlign:"center",minWidth:88},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[a.jsx("input",{type:"checkbox",checked:Ze.absent,disabled:Ye,onChange:$e=>ur(we.id,$e.target.checked)}),Ze.absent?a.jsxs("div",{className:"obe-ios-select",title:"Absent type",children:[a.jsx("span",{className:"obe-ios-select-value",children:String(Ze.absentKind||"AL")}),a.jsxs("select",{"aria-label":"Absent type",value:Ze.absentKind||"AL",disabled:Ye,onChange:$e=>Ve(we.id,$e.target.value),children:[a.jsx("option",{value:"AL",children:"AL"}),a.jsx("option",{value:"ML",children:"ML"}),a.jsx("option",{value:"SKL",children:"SKL"})]})]}):null]})}),v.map($e=>{var kt,It,Zt;return a.jsx("td",{style:{...Nt,textAlign:"center",width:46,minWidth:46},children:a.jsx("input",{style:{...er,textAlign:"center"},type:"number",min:0,max:$e.max,disabled:Ye||Ze.absent&&!qe,value:((kt=Ze.q)==null?void 0:kt[$e.key])===""||((It=Ze.q)==null?void 0:It[$e.key])==null?"":Number(((Zt=Ze.q)==null?void 0:Zt[$e.key])||0),onChange:sn=>{const mn=sn.target.value;if(mn==="")return sn.currentTarget.setCustomValidity(""),_t(we.id,$e.key,"");const hn=Number(mn);if(Number.isFinite(hn)){if(hn>$e.max){sn.currentTarget.setCustomValidity(`Max mark is ${$e.max}`),sn.currentTarget.reportValidity(),window.setTimeout(()=>sn.currentTarget.setCustomValidity(""),0);return}sn.currentTarget.setCustomValidity(""),_t(we.id,$e.key,hn)}}})},$e.key)}),a.jsx("td",{style:{...Nt,textAlign:"center",fontWeight:700},title:ot!=null?`Server total: ${ot}`:void 0,children:St}),a.jsx("td",{style:{...Nt,textAlign:"center"},children:Sr}),a.jsx("td",{style:{...Nt,textAlign:"center"},children:a.jsx("span",{className:"obe-pct-badge",children:Sd(Sr,kr.a)})}),a.jsx("td",{style:{...Nt,textAlign:"center"},children:Yr}),a.jsx("td",{style:{...Nt,textAlign:"center"},children:a.jsx("span",{className:"obe-pct-badge",children:Sd(Yr,kr.b)})}),Tr.map($e=>a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...Nt,textAlign:"center"},children:ct[$e]}),a.jsx("td",{style:{...Nt,textAlign:"center"},children:a.jsx("span",{className:"obe-pct-badge",children:Sd(ct[$e],Gt[$e])})})]},`btl-row-${we.id}-${$e}`))]},we.id)})]})]})})]}),st&&!_e?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{position:"absolute",inset:0,background:te?"rgba(240,253,244,0.55)":"rgba(239,246,255,0.65)",border:`1px solid ${te?"rgba(22,163,74,0.25)":"rgba(59,130,246,0.25)"}`,borderRadius:12,pointerEvents:"none"}}),a.jsxs("div",{style:{position:"absolute",left:"50%",top:16,transform:"translateX(-50%)",zIndex:40,width:320,background:"#fff",border:"1px solid #e5e7eb",padding:12,borderRadius:12,boxShadow:"0 6px 18px rgba(17,24,39,0.06)",display:"flex",flexDirection:"column",gap:10,alignItems:"stretch"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:950,color:"#111827"},children:te?"Published  Locked":"Table Locked"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:4},children:te?"Marks are published. Use View to inspect or Request Edit to ask IQAC for access.":"Confirm the Mark Manager to unlock student entry."}),te&&ae?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:ae}):null]}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",flexWrap:"wrap"},children:te?a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn",onClick:()=>ie(!0),children:"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",onClick:async()=>{await Zr()},disabled:O||Wt,children:Wt?"Request Pending":"Request Edit"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>Rn({mode:"confirm"}),disabled:!e||Pr,children:"Save Mark Manager"}),a.jsx("button",{className:"obe-btn",onClick:()=>sr(),disabled:Pr,children:"Request Access"})]})})]})]}):null]}),Kr?a.jsx(xs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:9999},onClick:()=>{Pr||Rn(null)},children:a.jsxs("div",{style:{width:"min(760px,96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:we=>we.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:Kr.mode==="confirm"?`Confirmation - ${o}`:`Request Edit - ${o}`}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:String(e||"")})]}),Kr.mode==="confirm"?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"Confirm the selected BTL settings. After confirming, Mark Manager will be locked and the table will be editable."}),a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Question"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Max"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"BTL"})]})}),a.jsx("tbody",{children:v.map(we=>a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:we.label}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:we.max}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:a.jsxs("select",{value:(Tt.questionBtl||{})[we.key]===""?"":String((Tt.questionBtl||{})[we.key]),onChange:Ie=>{const Ze=Ie.target.value===""?"":Number(Ie.target.value);Rt(we.key,Ze)},style:{padding:"6px 8px",borderRadius:6,border:"1px solid #e5e7eb",background:"#fff"},disabled:Pr||_e,children:[a.jsx("option",{value:"",children:"-"}),[1,2,3,4,5,6].map(Ie=>a.jsx("option",{value:String(Ie),children:Ie},Ie))]})})]},we.key))})]})})]}):a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. Mark Manager will remain locked until IQAC approves."}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[a.jsx("button",{className:"obe-btn",disabled:Pr,onClick:()=>Rn(null),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:Pr||!e,onClick:async()=>{if(e){if(Kr.mode==="request"){Rn(null),await sr();return}await zr()}},children:Kr.mode==="confirm"?"Confirm":"Send Request"})]})]})})}):null,G?a.jsx(xs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>ie(!1),children:a.jsxs("div",{style:{width:"min(1100px, 96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:0,display:"flex",flexDirection:"column"},onClick:we=>we.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"12px 14px",borderBottom:"1px solid #eef2f7"},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Only"}),a.jsx("button",{onClick:we=>{we.stopPropagation(),ie(!1)},"aria-label":"Close",style:{marginLeft:"auto",border:"none",background:"transparent",fontSize:20,lineHeight:1,cursor:"pointer"},children:""})]}),a.jsxs("div",{style:{padding:14},children:[Y?a.jsx("div",{style:{color:"#6b7280"},children:"Loading published sheet"}):null,K?a.jsx("div",{style:{color:"#991b1b",fontSize:12,marginBottom:8},children:K}):null]}),R&&(R.rowsByStudentId||R.rows_by_student_id)?a.jsx("div",{ref:V,style:{overflow:"auto",border:"1px solid #e5e7eb",borderRadius:12,maxHeight:"60vh"},children:a.jsxs("table",{className:"obe-table",style:{width:"max-content",minWidth:"100%",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:mt,colSpan:6+Tr.length*2,children:[Tt.termLabel," | ",Tt.batchLabel," | ",o," (PUBLISHED)"]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...mt,width:pr,minWidth:pr},children:"S.No"}),a.jsx("th",{style:{...mt,minWidth:70,overflow:"visible",textOverflow:"clip"},children:"R.No"}),a.jsx("th",{style:{...mt,minWidth:240,overflow:"visible",textOverflow:"clip"},children:"Name of the Students"}),a.jsx("th",{style:mt,children:"Total"}),a.jsxs("th",{style:mt,colSpan:2,children:["CO-",l.a]}),a.jsxs("th",{style:mt,colSpan:2,children:["CO-",l.b]}),Tr.map(we=>a.jsxs("th",{style:mt,colSpan:2,children:["BTL-",we]},`pv_btl_${we}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:mt}),a.jsx("th",{style:mt}),a.jsx("th",{style:mt}),a.jsx("th",{style:mt}),Array.from({length:2+Tr.length}).flatMap((we,Ie)=>a.jsxs(on.Fragment,{children:[a.jsx("th",{style:mt,children:"Mark"}),a.jsx("th",{style:mt,children:"%"})]},`pv_hdr_${Ie}`))]})]}),a.jsx("tbody",{children:E.map((we,Ie)=>{var Ye;const Ze=R.rowsByStudentId||R.rows_by_student_id||{},bt=Ze[String(we.id)]||Ze[we.id]||{},St=bt.q||{},Sr=Object.fromEntries(v.map(ot=>[ot.key,wd(Number((St==null?void 0:St[ot.key])||0),0,ot.max)])),Yr=v.reduce((ot,$e)=>ot+Number(Sr[$e.key]||0),0);let ct=0,$t=0;for(let ot=0;ot<v.length;ot++){const $e=v[ot],kt=Ub(v,ot,l),It=Number(Sr[$e.key]||0);ct+=It*kt.a,$t+=It*kt.b}const qe={1:0,2:0,3:0,4:0,5:0,6:0};for(const ot of v){const $e=(R.questionBtl||R.question_btl||Tt.questionBtl||{})[ot.key];if($e===1||$e===2||$e===3||$e===4||$e===5||$e===6){const kt=$e;qe[kt]+=Number(Sr[ot.key]||0)}}return a.jsxs("tr",{children:[a.jsx("td",{style:{...Nt,textAlign:"center",width:pr,minWidth:pr,paddingLeft:2,paddingRight:2},children:Ie+1}),a.jsx("td",{style:{...Nt,minWidth:70,overflow:"visible",textOverflow:"clip"},children:AM(bt.reg_no||((Ye=Tt.rowsByStudentId[String(we.id)])==null?void 0:Ye.reg_no)||"")}),a.jsx("td",{style:{...Nt,minWidth:240,overflow:"visible",textOverflow:"clip"},children:we.name}),a.jsx("td",{style:{...Nt,textAlign:"center",fontWeight:900},children:Yr}),a.jsx("td",{style:{...Nt,textAlign:"center"},children:Math.round(ct)}),a.jsx("td",{style:{...Nt,textAlign:"center"},children:a.jsx("span",{className:"obe-pct-badge",children:Sd(ct,kr.a)})}),a.jsx("td",{style:{...Nt,textAlign:"center"},children:Math.round($t)}),a.jsx("td",{style:{...Nt,textAlign:"center"},children:a.jsx("span",{className:"obe-pct-badge",children:Sd($t,kr.b)})}),Tr.map(ot=>a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...Nt,textAlign:"center"},children:Math.round(qe[ot])}),a.jsx("td",{style:{...Nt,textAlign:"center"},children:a.jsx("span",{className:"obe-pct-badge",children:Sd(qe[ot],Gt[ot])})})]},`pv_btl_${we.id}_${ot}`))]},`pv_${we.id}`)})})]})}):Y?null:a.jsx("div",{style:{color:"#6b7280"},children:"No published sheet found."}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{className:"obe-btn",onClick:()=>ie(!1),children:"Close"})})]})})}):null,X?a.jsx(xs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>{O||Q(!1)},children:a.jsxs("div",{style:{width:"min(560px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:we=>we.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[o,"  ",String(e||"")]})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",xt?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:ne,onChange:we=>oe(we.target.value),placeholder:"Explain why you need to edit (required)",rows:4,className:"obe-input",style:{resize:"vertical"}})]}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:12},children:[a.jsx("button",{className:"obe-btn",disabled:O,onClick:()=>Q(!1),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:O||Wt||!e||!String(ne||"").trim(),onClick:Lr,children:O?"Requesting":Wt?"Request Pending":"Send Request"})]})]})})}):null]})}function AM(e){return e.slice(-8)}function pxe(e){return a.jsx(zz,{...e,assessmentKey:"cia2"})}const mxe=5,gxe=20,xxe=10;function Dn(e,t,r){return Math.max(t,Math.min(r,e))}function wc(e){return Math.round(e*10)/10}function ds(e){if(e===""||e==null)return"";const t=Number(e);return Number.isFinite(t)?t:""}function Wb(e){if(e===""||e==null||typeof e=="string"&&e.trim()==="")return null;const t=Number(e);return Number.isFinite(t)?t:null}function Na(e,t){if(!t)return"-";const r=e/t*100;return`${Number.isFinite(r)?r.toFixed(0):0}`}function yxe(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const l=r.localeCompare(n);if(l)return l}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim(),o=i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"});return o||0}function bxe(e,t){return`${e}_sheet_${t}`}function vxe(e,t){if(!t.length)return;const r=Object.keys(t[0]),n=[r.join(",")].concat(t.map(l=>r.map(c=>{const u=l[c],d=String(u??"").replace(/\n/g," ");return d.includes(",")||d.includes('"')?`"${d.replace(/"/g,'""')}"`:d}).join(","))).join(`
`),i=new Blob([n],{type:"text/csv"}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function vp(e){return e.slice(-8)}function Wz({subjectId:e,teachingAssignmentId:t,assessmentKey:r,skipMarkManager:n=!1}){var Rt,_t,Xt;const i=r||"formative1",s=i==="formative2"?"Formative 2":"Formative 1",o=i==="formative2"?3:1,l=i==="formative2"?4:2,[c,u]=x.useState(!1),[d,f]=x.useState(null),[h,p]=x.useState([]),[m,g]=x.useState(null),[y,b]=x.useState({skill1:3,skill2:4,att1:3,att2:4}),[v,w]=x.useState(!1),[S,k]=x.useState(!1),[j,A]=x.useState(null),[L,P]=x.useState(null),[F,E]=x.useState(!1),T=x.useRef(null),[B,q]=x.useState(!1),{data:U,loading:se,error:de,remainingSeconds:z,publishAllowed:G,refresh:ie}=V0({assessment:i,subjectCode:String(e||""),teachingAssignmentId:t}),Y=!!(U!=null&&U.global_override_active&&(U==null?void 0:U.global_is_open)===!1),[C,K]=x.useState(""),[H,R]=x.useState(!1),[J,V]=x.useState(null),[X,Q]=x.useState(null),[ne,oe]=x.useState({termLabel:"KRCT AY25-26",batchLabel:e||"",rowsByStudentId:{},markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null}),{data:O,refresh:W}=G0({assessment:i,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:ae,refresh:I}=oc({assessment:i,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!0}}),{data:Z,refresh:me}=oc({assessment:i,subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:t,options:{poll:!0}}),[Te,Ae]=x.useState(null),Be=!!L||!!(O!=null&&O.exists&&(O!=null&&O.is_published)),Ee=n?!0:!!ne.markManagerLocked,ze=Z!=null&&Z.approval_until?String(Z.approval_until):null,Xe=ae!=null&&ae.approval_until?String(ae.approval_until):null,Pt=!!(Z!=null&&Z.allowed_by_approval)&&!!ze&&ze!==((Te==null?void 0:Te.markEntryApprovalUntil)??null),ft=!!(ae!=null&&ae.allowed_by_approval)&&!!Xe&&Xe!==((Te==null?void 0:Te.markManagerApprovalUntil)??null),He=Be?!!(O!=null&&O.entry_open)||Pt||ft:!0,tt=!!(Be&&!He),_e=!!(Be&&tt),Se=!!(Be&&tt),he=n?!!(Y||Be&&!He):!!(Y||(Be?!He:!Ee)),ye=n?!0:ne.markManagerSnapshot!=null||!!Be,[ht,Ge]=x.useState(null),[lt,jt]=x.useState(!1),wt=Be,[yt,Fr]=x.useState(!1),[Tt,hr]=x.useState(null),[rn,en]=x.useState(!1),[$r,Kr]=x.useState(null),[Rn,Pr]=x.useState(!1),[Sn,Me]=x.useState(""),[je,Mt]=x.useState(!1),{pending:pt,pendingUntilMs:Ut,setPendingUntilMs:ir,refresh:fr}=K0({enabled:!!Se&&!!e,assessment:i,subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:t});Y0(!!Rn||!!yt||!!ht);const vr=String((X==null?void 0:X.termLabel)||"KRCT AY25-26"),re=((Rt=X==null?void 0:X.assessments)==null?void 0:Rt[i])??((_t=X==null?void 0:X.assessments)==null?void 0:_t.formative1)??{},le=Number.isFinite(Number(re==null?void 0:re.maxPart))?Number(re.maxPart):mxe,te=Number.isFinite(Number(re==null?void 0:re.maxTotal))?Number(re.maxTotal):gxe,ue=Number.isFinite(Number(re==null?void 0:re.maxCo))?Number(re.maxCo):xxe,Ne=x.useMemo(()=>{const Ue=ne.markManagerSnapshot;if(!Ue)return null;try{const Ct=JSON.parse(String(Ue)),et=Ct==null?void 0:Ct.partBtl;if(!et||typeof et!="object")return null;const ut={};for(const Bt of["skill1","skill2","att1","att2"]){const Kt=et[Bt];ut[Bt]=Kt===""||Kt==null?"":Number(Kt),ut[Bt]===""||Number.isFinite(ut[Bt])&&ut[Bt]>=1&&ut[Bt]<=6||(ut[Bt]="")}return ut}catch{return null}},[ne.markManagerSnapshot]);x.useEffect(()=>{Ae(null)},[e]);const ke=Ne||y,vt=async Ue=>{if(e){Ue||(Kr(null),en(!0));try{const Ct=await v0(i,e),et=Ct&&Ct.marks&&typeof Ct.marks=="object"?Ct.marks:null;et&&Object.keys(et).length?hr(et):hr(null)}catch(Ct){Ue||Kr((Ct==null?void 0:Ct.message)||"Failed to load published marks")}finally{Ue||en(!1)}}};x.useEffect(()=>{yt&&(hr(null),vt(!1))},[yt,e,i]);const rt=x.useRef(!!He);x.useEffect(()=>{if(!e||!Be)return;if(rt.current||!He){rt.current=!!He;return}let Ct=!0;return(async()=>{try{const et=await ei(i,String(e));if(!Ct)return;const ut=et==null?void 0:et.draft,Bt=ut==null?void 0:ut.sheet,Kt=ut==null?void 0:ut.partBtl;if(Bt&&typeof Bt=="object"&&typeof Bt.rowsByStudentId=="object"&&oe(Jt=>({...Jt,termLabel:String(Bt.termLabel||vr||"KRCT AY25-26"),batchLabel:String(e),rowsByStudentId:Bt.rowsByStudentId||{},markManagerLocked:typeof Bt.markManagerLocked=="boolean"?Bt.markManagerLocked:!!(Bt.markManagerSnapshot??Jt.markManagerSnapshot),markManagerSnapshot:Bt.markManagerSnapshot??Jt.markManagerSnapshot??null,markManagerApprovalUntil:Bt.markManagerApprovalUntil??Jt.markManagerApprovalUntil??null})),Kt&&typeof Kt=="object"){const Jt={};for(const ar of["skill1","skill2","att1","att2"]){const nt=Kt[ar];Jt[ar]=nt===""||nt==null?"":Number(nt),Jt[ar]===""||Number.isFinite(Jt[ar])&&Jt[ar]>=1&&Jt[ar]<=6||(Jt[ar]="")}b(Jt)}}catch{}})(),rt.current=!!He,()=>{Ct=!1}},[He,Be,e,i,vr]),x.useEffect(()=>{if(!e||!Be||He)return;const Ue=window.setInterval(()=>{W({silent:!0});try{me==null||me({silent:!0}),I==null||I({silent:!0})}catch{}},3e4);return()=>window.clearInterval(Ue)},[He,Be,e,W,me,I]);async function De(){if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}if(pt){alert("Edit request is pending. Please wait for approval.");return}const Ct=String(Sn||"").trim();if(!Ct){alert("Reason is required.");return}Mt(!0);const et=new Date,ut=Z!=null&&Z.approval_until?String(Z.approval_until):null;try{const Bt=await il({assessment:i,subject_code:String(e),scope:"MARK_ENTRY",reason:Ct,teaching_assignment_id:t});alert(al(Bt)),Pr(!1),Me(""),ir(Date.now()+24*60*60*1e3);try{fr({silent:!0})}catch{}const Kt=Number(Bt==null?void 0:Bt.id),ar=et.getTime()-2e3;(async()=>{if(!e)return;const nt=36,Ht=5e3;for(let Pe=0;Pe<nt;Pe++){try{const Ot=await Lm({assessment:i,subject_code:String(e),scope:"MARK_ENTRY",teaching_assignment_id:t}),mt=Ot==null?void 0:Ot.result;if(!(mt&&Number.isFinite(Kt)&&mt.id!==Kt)){if((mt==null?void 0:mt.status)==="APPROVED"&&(mt!=null&&mt.is_active)){const Nt=mt.reviewed_at?new Date(mt.reviewed_at).getTime():NaN;if(!(!Number.isFinite(Nt)||Nt<ar)){try{me==null||me({silent:!0}),W({silent:!0})}catch{}alert("IQAC approved the edit request. You can now edit marks.");return}}else if((mt==null?void 0:mt.status)==="REJECTED"){const Nt=mt.reviewed_at?new Date(mt.reviewed_at).getTime():NaN;if(!(!Number.isFinite(Nt)||Nt<ar)){alert("IQAC rejected the edit request.");return}}}}catch{try{const mt=await o1(i,String(e),"MARK_ENTRY",t),Nt=mt!=null&&mt.approval_until?String(mt.approval_until):null;if(mt!=null&&mt.allowed_by_approval&&Nt&&Nt!==ut){try{me==null||me({silent:!0}),W({silent:!0})}catch{}alert("IQAC approved the edit request. You can now edit marks.");return}}catch{}}await new Promise(Ot=>setTimeout(Ot,Ht))}alert("Edit request still pending. Please try again later.")})()}catch(Bt){const Kt=sl(Bt,"Request failed");alert(`Edit request failed: ${Kt}`)}finally{Mt(!1)}}x.useEffect(()=>{let Ue=!0;return(async()=>{try{const Ct=await ku();if(!Ue)return;Q(Ct||null),oe(et=>({...et,termLabel:String((Ct==null?void 0:Ct.termLabel)||et.termLabel||"KRCT AY25-26"),batchLabel:e||et.batchLabel}))}catch{}})(),()=>{Ue=!1}},[e]);const We=x.useMemo(()=>e?bxe(i,e):"",[i,e]),st=x.useMemo(()=>[{key:"skill1",label:"Skill 1",max:le},{key:"skill2",label:"Skill 2",max:le},{key:"att1",label:"Attitude 1",max:le},{key:"att2",label:"Attitude 2",max:le}],[le]);(Xt=st[st.length-1])==null||Xt.key;const zt=x.useMemo(()=>{const Ue=new Set;for(const Ct of Object.keys(y)){const et=y[Ct];(et===1||et===2||et===3||et===4||et===5||et===6)&&Ue.add(et)}return[1,2,3,4,5,6].filter(Ct=>Ue.has(Ct))},[y]),Wt=x.useMemo(()=>12+zt.length*2,[zt.length]);x.useEffect(()=>{if(e){const Ue=`${i}_part_btl_${e}`,Ct=Jn(Ue);if(Ct&&typeof Ct=="object")try{const et={};for(const ut of Object.keys(y)){const Bt=Ct[ut];et[ut]=Bt===""||Bt==null?"":Number(Bt),et[ut]===""||Number.isFinite(et[ut])&&et[ut]>=1&&et[ut]<=6||(et[ut]="")}b(et)}catch{}}},[e,i]),x.useEffect(()=>{if(!e)return;const Ue=`${i}_part_btl_${e}`;try{Kn(Ue,y)}catch{}},[y,e,i]);const xt=Ue=>JSON.stringify({assessmentKey:i,partBtl:Ue,maxPart:le,maxTotal:te});async function Dt(){if(e){jt(!0);try{const Ue=xt(y),Ct=ae!=null&&ae.approval_until?String(ae.approval_until):ne.markManagerApprovalUntil||null,et={...ne,markManagerLocked:!0,markManagerSnapshot:Ue,markManagerApprovalUntil:Ct},ut={sheet:et,partBtl:y,markManagerLocked:et.markManagerLocked,markManagerSnapshot:et.markManagerSnapshot,markManagerApprovalUntil:et.markManagerApprovalUntil};oe(et),Ge(null),await Ri(i,String(e),ut),A(new Date().toLocaleString());try{await dh(i,String(e),t),W({silent:!0})}catch{}}catch{}finally{jt(!1)}}}async function Vt(){if(!e)return;jt(!0);const Ue=new Date,Ct=ae!=null&&ae.approval_until?String(ae.approval_until):null;try{const et=await il({assessment:i,subject_code:String(e),scope:"MARK_MANAGER",reason:`Request mark-manager edit for ${e}`,teaching_assignment_id:t});alert(al(et));const ut=Number(et==null?void 0:et.id),Kt=Ue.getTime()-2e3;(async()=>{if(!e)return;const Jt=36,ar=5e3;for(let nt=0;nt<Jt;nt++){try{const Ht=await Lm({assessment:i,subject_code:String(e),scope:"MARK_MANAGER",teaching_assignment_id:t}),Pe=Ht==null?void 0:Ht.result;if(!(Pe&&Number.isFinite(ut)&&Pe.id!==ut)){if((Pe==null?void 0:Pe.status)==="APPROVED"&&(Pe!=null&&Pe.is_active)){const Ot=Pe.reviewed_at?new Date(Pe.reviewed_at).getTime():NaN;if(!(!Number.isFinite(Ot)||Ot<Kt)){try{I==null||I({silent:!0}),W({silent:!0})}catch{}alert("IQAC approved the mark-manager edit request. You can now edit mark-manager settings.");return}}else if((Pe==null?void 0:Pe.status)==="REJECTED"){const Ot=Pe.reviewed_at?new Date(Pe.reviewed_at).getTime():NaN;if(!(!Number.isFinite(Ot)||Ot<Kt)){alert("IQAC rejected the mark-manager edit request.");return}}}}catch{try{const Pe=await o1(i,String(e),"MARK_MANAGER",t),Ot=Pe!=null&&Pe.approval_until?String(Pe.approval_until):null;if(Pe!=null&&Pe.allowed_by_approval&&Ot&&Ot!==Ct){try{I==null||I({silent:!0}),W({silent:!0})}catch{}alert("IQAC approved the mark-manager edit request. You can now edit mark-manager settings.");return}}catch{}}await new Promise(Ht=>setTimeout(Ht,ar))}alert("Edit request still pending. Please try again later.")})()}catch(et){const ut=sl(et,"Request failed");alert(`Edit request failed: ${ut}`)}finally{jt(!1)}}x.useEffect(()=>{if(!e)return;let Ue=!1;const Ct=setTimeout(async()=>{try{await Ri(i,e,{sheet:ne,partBtl:y});try{We&&Kn(We,{termLabel:ne.termLabel,batchLabel:ne.batchLabel,rowsByStudentId:ne.rowsByStudentId})}catch{}Ue||A(new Date().toLocaleString())}catch{}},700);return()=>{Ue=!0,clearTimeout(Ct)}},[y,e,i,ne,We]),x.useEffect(()=>{let Ue=!0;return(async()=>{if(e)try{const Ct=await ei(i,e);if(!Ue)return;const et=Ct==null?void 0:Ct.draft,ut=et==null?void 0:et.sheet,Bt=et==null?void 0:et.partBtl,Kt=et==null?void 0:et.selectedBtls;if(ut&&typeof ut=="object"&&typeof ut.rowsByStudentId=="object"){oe({termLabel:String(ut.termLabel||vr||"KRCT AY25-26"),batchLabel:String(e),rowsByStudentId:ut.rowsByStudentId||{},markManagerLocked:typeof ut.markManagerLocked=="boolean"?ut.markManagerLocked:!!ut.markManagerSnapshot,markManagerSnapshot:ut.markManagerSnapshot??null,markManagerApprovalUntil:ut.markManagerApprovalUntil??null});try{We&&Kn(We,{termLabel:String(ut.termLabel||vr||"KRCT AY25-26"),batchLabel:String(e),rowsByStudentId:ut.rowsByStudentId||{}})}catch{}}if(Bt&&typeof Bt=="object"){const Jt={};for(const ar of Object.keys(y)){const nt=Bt[ar];Jt[ar]=nt===""||nt==null?"":Number(nt),Jt[ar]===""||Number.isFinite(Jt[ar])&&Jt[ar]>=1&&Jt[ar]<=6||(Jt[ar]="")}b(Jt);try{const ar=`${i}_part_btl_${e}`;Kn(ar,Jt)}catch{}}else if(Array.isArray(Kt)){const Jt=nt=>Number.isFinite(nt)&&nt>=1&&nt<=6,ar=Kt.map(nt=>Number(nt)).filter(Jt);if(ar.length===1){const nt={skill1:ar[0],skill2:ar[0],att1:ar[0],att2:ar[0]};b(nt);try{const Ht=`${i}_part_btl_${e}`;Kn(Ht,nt)}catch{}}else if(ar.length>=2){const nt={skill1:ar[0],skill2:ar[1],att1:ar[0],att2:ar[1]};b(nt);try{const Ht=`${i}_part_btl_${e}`;Kn(Ht,nt)}catch{}}}}catch{}})(),()=>{Ue=!1}},[e,vr,i,We]),x.useEffect(()=>{let Ue=!0;return(async()=>{if(e){u(!0),f(null);try{let et=[],ut=null;try{const nt=await fc();console.log("[Formative] My TAs:",nt==null?void 0:nt.length,"for subject:",e,"teachingAssignmentId:",t),ut=(nt||[]).find(Ht=>{const Pe=String(Ht.subject_code||"").trim().toUpperCase()===String(e||"").trim().toUpperCase();return(t?Ht.id===t:!1)||Pe}),ut?console.log("[Formative] Found TA match:",ut.id,"elective_subject_id:",ut.elective_subject_id,"section_id:",ut.section_id):console.log("[Formative] No TA match found in user TAs")}catch(nt){console.warn("[Formative] My TAs fetch failed:",nt)}if(ut&&ut.elective_subject_id&&!ut.section_id){console.log("[Formative] Detected elective, fetching elective-choices for elective_subject_id:",ut.elective_subject_id);try{const nt=await xr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(ut.elective_subject_id))}`);if(nt.ok){const Ht=await nt.json(),Pe=Array.isArray(Ht.results)?Ht.results:Array.isArray(Ht)?Ht:Ht.items||[];console.log("[Formative] Elective choices returned:",Pe==null?void 0:Pe.length,"students"),et=(Pe||[]).map(Ot=>({id:Number(Ot.student_id??Ot.id),reg_no:String(Ot.reg_no??Ot.regno??""),name:String(Ot.name??Ot.full_name??Ot.username??""),section:Ot.section_name??Ot.section??null})).filter(Ot=>Number.isFinite(Ot.id)),Ue&&g({subject_name:ut.subject_name,section:ut.section_name||"Elective"})}else console.warn("[Formative] Elective-choices API returned error:",nt.status)}catch(nt){console.warn("[Formative] Elective-choices fetch failed:",nt)}}if(!et.length&&ut&&ut.id){console.log("[Formative] Fetching regular TA roster for TA ID:",ut.id);try{et=((await Vc(ut.id)).students||[]).map(Ht=>({id:Number(Ht.id),reg_no:String(Ht.reg_no??""),name:String(Ht.name??""),section:Ht.section??null})).filter(Ht=>Number.isFinite(Ht.id)),console.log("[Formative] Regular roster returned:",et.length,"students"),Ue&&g({subject_name:ut.subject_name,section:ut.section_name})}catch(nt){console.warn("[Formative] TA roster fetch failed:",nt)}}console.log("[Formative] Final roster count:",et.length),et.sort(yxe),Ue&&p(et);let Bt=null;try{const nt=await v0(i,e);nt&&nt.marks&&typeof nt.marks=="object"&&Object.keys(nt.marks||{}).length&&(Bt=nt.marks,P(new Date().toLocaleString()))}catch{}const Kt=We?Jn(We):null,Jt=Bt?{termLabel:X!=null&&X.termLabel?String(X.termLabel):vr||"KRCT AY25-26",batchLabel:String(e||""),rowsByStudentId:Object.fromEntries(Object.entries(Bt).map(([nt,Ht])=>[nt,{studentId:Number(nt),skill1:ds(Ht==null?void 0:Ht.skill1),skill2:ds(Ht==null?void 0:Ht.skill2),att1:ds(Ht==null?void 0:Ht.att1),att2:ds(Ht==null?void 0:Ht.att2)}]))}:Kt&&typeof Kt=="object"?{termLabel:X!=null&&X.termLabel?String(X.termLabel):String(Kt.termLabel||"KRCT AY25-26"),batchLabel:String(e||Kt.batchLabel||""),rowsByStudentId:Kt.rowsByStudentId&&typeof Kt.rowsByStudentId=="object"?Kt.rowsByStudentId:{}}:{termLabel:vr||"KRCT AY25-26",batchLabel:String(e||""),rowsByStudentId:{}},ar={...Jt.rowsByStudentId};for(const nt of et){const Ht=String(nt.id),Pe=ar[Ht];ar[Ht]={studentId:nt.id,skill1:typeof(Pe==null?void 0:Pe.skill1)=="number"?Dn(Number(Pe==null?void 0:Pe.skill1),0,le):"",skill2:typeof(Pe==null?void 0:Pe.skill2)=="number"?Dn(Number(Pe==null?void 0:Pe.skill2),0,le):"",att1:typeof(Pe==null?void 0:Pe.att1)=="number"?Dn(Number(Pe==null?void 0:Pe.att1),0,le):"",att2:typeof(Pe==null?void 0:Pe.att2)=="number"?Dn(Number(Pe==null?void 0:Pe.att2),0,le):""}}oe({...Jt,termLabel:Jt.termLabel||vr,batchLabel:String(e||Jt.batchLabel||""),rowsByStudentId:ar})}catch(et){if(!Ue)return;f((et==null?void 0:et.message)||`Failed to load ${s} roster`),p([])}finally{Ue&&u(!1)}}})(),()=>{Ue=!1}},[e,We,X,vr,le,s]);const gr=(Ue,Ct)=>{he||tt||oe(et=>{const ut=String(Ue),Kt={...et.rowsByStudentId[ut]||{studentId:Ue,skill1:"",skill2:"",att1:"",att2:""},...Ct,studentId:Ue},Jt=ar=>{if(ar===""||ar==null)return"";const nt=Number(ar),Ht=Number.isFinite(nt)?Math.round(nt):NaN,Pe=Dn(Ht,0,le);return Number.isFinite(Pe)?Pe:""};return{...et,rowsByStudentId:{...et.rowsByStudentId,[ut]:{...Kt,skill1:Jt(Kt.skill1),skill2:Jt(Kt.skill2),att1:Jt(Kt.att1),att2:Jt(Kt.att2)}}}})},sr=async()=>{if(e){w(!0),f(null);try{await Ri(i,e,{sheet:ne,partBtl:y}),A(new Date().toLocaleString())}catch(Ue){f((Ue==null?void 0:Ue.message)||`Failed to save ${s} draft`)}finally{w(!1)}}},Lr=x.useRef(ne);Lr.current=ne;const Zr=x.useRef(y);Zr.current=y,x.useEffect(()=>{const Ue=()=>{if(!e||h.length===0)return;const Ct={sheet:Lr.current,partBtl:Zr.current};Ri(i,e,Ct).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",Ue),()=>window.removeEventListener("obe:before-tab-switch",Ue)},[e,i,h.length]);const Er=async()=>{if(!e)return;if(Y){f("Publishing is locked by IQAC.");return}if(!G){f("Publish window is closed. Please request IQAC approval.");return}if(Be&&tt){if(pt){f("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}Pr(!0);return}k(!0),f(null);const Ue=L,Ct=ne.markManagerLocked,et=Te,ut={markEntryApprovalUntil:ze,markManagerApprovalUntil:Xe};try{P(new Date().toLocaleString()),Ae(ut),oe(Bt=>({...Bt,markManagerLocked:!0})),await P9(i,e,ne,t),ie(),W({silent:!0}),vt(!0);try{window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:i}}))}catch{}}catch(Bt){const Kt=String((Bt==null?void 0:Bt.message)||"");Kt.includes("locked after publish")||Kt.includes("Marks entry is locked")?(P(new Date().toLocaleString()),Ae(ut),oe(Jt=>({...Jt,markManagerLocked:!0})),f(null)):(P(Ue??null),oe(Jt=>({...Jt,markManagerLocked:Ct})),Ae(et??null),f(Kt||`Failed to publish ${s}`))}finally{try{if(e){const Bt=await yS(i,String(e),t);Bt!=null&&Bt.exists&&(Bt!=null&&Bt.is_published)&&(P(new Date().toLocaleString()),oe(Kt=>({...Kt,markManagerLocked:!0})),Ae(Kt=>Kt??ut),vt(!0),W({silent:!0}),ie(),f(null))}}catch{}k(!1)}},qt=()=>{if(!e)return;const Ue=h.map((Ct,et)=>{const ut=ne.rowsByStudentId[String(Ct.id)]||{studentId:Ct.id,skill1:"",skill2:"",att1:"",att2:""},Bt=typeof ut.skill1=="number"?Dn(Number(ut.skill1),0,le):null,Kt=typeof ut.skill2=="number"?Dn(Number(ut.skill2),0,le):null,Jt=typeof ut.att1=="number"?Dn(Number(ut.att1),0,le):null,ar=typeof ut.att2=="number"?Dn(Number(ut.att2),0,le):null,nt=Bt!=null&&Kt!=null&&Jt!=null&&ar!=null?Dn(Bt+Kt+Jt+ar,0,te):"",Ht=Bt!=null&&Jt!=null?Dn(Bt+Jt,0,ue):"",Pe=Kt!=null&&ar!=null?Dn(Kt+ar,0,ue):"",Ot=[0,0,0,0,0,0];for(const pr of st){const we=y[pr.key];(we===1||we===2||we===3||we===4||we===5||we===6)&&(Ot[we-1]+=pr.max)}const mt=zt.map(pr=>pr-1),Nt=typeof nt=="number"&&mt.length?wc(nt/mt.length):"",er=Ot.map((pr,we)=>Nt===""||!mt.includes(we)?"":pr>0?Dn(Nt,0,pr):wc(Nt));return{sno:et+1,registerNo:Ct.reg_no,name:Ct.name,skill1:Bt??"",skill2:Kt??"",att1:Jt??"",att2:ar??"",total:nt===""?"":nt,[`co${o}_mark`]:Ht===""?"":Ht,[`co${o}_pct`]:Ht===""?"":Na(Ht,ue),[`co${l}_mark`]:Pe===""?"":Pe,[`co${l}_pct`]:Pe===""?"":Na(Pe,ue),btl1_mark:er[0]??"",btl1_pct:er[0]===""?"":Na(Number(er[0]),Ot[0]),btl2_mark:er[1]??"",btl2_pct:er[1]===""?"":Na(Number(er[1]),Ot[1]),btl3_mark:er[2]??"",btl3_pct:er[2]===""?"":Na(Number(er[2]),Ot[2]),btl4_mark:er[3]??"",btl4_pct:er[3]===""?"":Na(Number(er[3]),Ot[3]),btl5_mark:er[4]??"",btl5_pct:er[4]===""?"":Na(Number(er[4]),Ot[4]),btl6_mark:er[5]??"",btl6_pct:er[5]===""?"":Na(Number(er[5]),Ot[5])}});vxe(`${e}_${i.toUpperCase()}_sheet.csv`,Ue)},zr=async()=>{if(!e)return;const Ue=h.map((Ct,et)=>{const ut=ne.rowsByStudentId[String(Ct.id)]||{studentId:Ct.id,skill1:"",skill2:"",att1:"",att2:""},Bt=typeof ut.skill1=="number"?Dn(Number(ut.skill1),0,le):null,Kt=typeof ut.skill2=="number"?Dn(Number(ut.skill2),0,le):null,Jt=typeof ut.att1=="number"?Dn(Number(ut.att1),0,le):null,ar=typeof ut.att2=="number"?Dn(Number(ut.att2),0,le):null,nt=Bt!=null&&Kt!=null&&Jt!=null&&ar!=null?Dn(Bt+Kt+Jt+ar,0,te):"";return{sno:et+1,regNo:String(Ct.reg_no||""),name:String(Ct.name||""),total:nt===""?"":nt}});await fy({filenameBase:`${e}_${s}`,meta:{courseName:String((m==null?void 0:m.subject_name)||""),courseCode:String(e||""),className:String((m==null?void 0:m.section)||"")},rows:Ue})};function bn(Ue){return String(Ue??"").trim().toLowerCase().replace(/\s+/g," ")}const or=()=>{if(!e||!h.length)return;const Ue=Kt=>`${Kt} (${Number(le).toFixed(2)})`,Ct=["Register No","Student Name",Ue("Skill 1"),Ue("Skill 2"),Ue("Attitude 1"),Ue("Attitude 2"),"Status"],et=h.map(Kt=>{const Jt=ne.rowsByStudentId[String(Kt.id)];return[Kt.reg_no,Kt.name,(Jt==null?void 0:Jt.skill1)??"",(Jt==null?void 0:Jt.skill2)??"",(Jt==null?void 0:Jt.att1)??"",(Jt==null?void 0:Jt.att2)??"","present"]}),ut=vs.aoa_to_sheet([Ct,...et]);ut["!freeze"]={xSplit:0,ySplit:1};const Bt=vs.book_new();vs.book_append_sheet(Bt,ut,s),uy(Bt,`${e}_${i.toUpperCase()}_template.xlsx`)},kr=()=>{var Ue;he||tt||(Ue=T.current)==null||Ue.click()},Tr=async Ue=>{var Ct;if(e&&!(he||tt)){q(!0);try{const et=await Ue.arrayBuffer(),ut=C0(et,{type:"array"}),Bt=(Ct=ut.SheetNames)==null?void 0:Ct[0];if(!Bt)throw new Error("No sheet found in the Excel file.");const Kt=ut.Sheets[Bt],Jt=vs.sheet_to_json(Kt,{header:1});if(!Jt.length)throw new Error("Excel sheet is empty.");const ar=(Jt[0]||[]).map(bn),nt=Ie=>ar.findIndex(Ze=>Ie(Ze)),Ht=nt(Ie=>Ie==="register no"||Ie==="reg no"||Ie.includes("register")),Pe=nt(Ie=>Ie.startsWith("skill 1")||Ie.startsWith("skill1")),Ot=nt(Ie=>Ie.startsWith("skill 2")||Ie.startsWith("skill2")),mt=nt(Ie=>Ie.startsWith("attitude 1")||Ie.startsWith("att1")||Ie.startsWith("attitude1")),Nt=nt(Ie=>Ie.startsWith("attitude 2")||Ie.startsWith("att2")||Ie.startsWith("attitude2")),er=nt(Ie=>Ie==="status"||Ie.includes("status"));if(Ht<0)throw new Error("Could not find Register No column.");const pr=new Map;for(const Ie of h){const Ze=String(Ie.reg_no||"").trim();Ze&&pr.set(Ze,Ie.id);const bt=vp(Ze);bt&&pr.set(bt,Ie.id)}const we=Ie=>Ie==null||!Number.isFinite(Ie)||Ie<=0?"":Dn(Number(Ie),1,le);oe(Ie=>{const Ze={...Ie.rowsByStudentId};for(let bt=1;bt<Jt.length;bt++){const St=Jt[bt]||[],Sr=String(St[Ht]??"").trim();if(!Sr)continue;const Yr=pr.get(Sr);if(!Yr)continue;const $t=(er>=0?String(St[er]??""):"").trim().toLowerCase(),qe=$t==="absent"||$t==="ab"||$t==="a",Ye=Ze[String(Yr)]||{studentId:Yr,skill1:"",skill2:"",att1:"",att2:""};if(qe){Ze[String(Yr)]={...Ye,skill1:"",skill2:"",att1:"",att2:""};continue}const ot=Pe>=0?we(Wb(St[Pe])):Ye.skill1,$e=Ot>=0?we(Wb(St[Ot])):Ye.skill2,kt=mt>=0?we(Wb(St[mt])):Ye.att1,It=Nt>=0?we(Wb(St[Nt])):Ye.att2;Ze[String(Yr)]={...Ye,studentId:Yr,skill1:ot,skill2:$e,att1:kt,att2:It}}return{...Ie,rowsByStudentId:Ze}})}finally{q(!1)}}},Or=async Ue=>{var et;const Ct=(et=Ue.target.files)==null?void 0:et[0];if(Ue.target.value="",!!Ct)try{await Tr(Ct)}catch(ut){f((ut==null?void 0:ut.message)||"Failed to import Excel")}};if(!e)return a.jsxs("div",{style:{color:"#6b7280"},children:["Select a course to start ",s," entry."]});if(c)return a.jsxs("div",{style:{color:"#6b7280"},children:["Loading ",s," roster"]});const Gt={border:"1px solid #111",padding:"6px 6px",background:"#ecfdf5",color:"#065f46",textAlign:"center",fontWeight:700,fontSize:12,whiteSpace:"nowrap"},ur={border:"1px solid #111",padding:"6px 6px",fontSize:12,whiteSpace:"nowrap"},Ve={width:"100%",border:"none",outline:"none",background:"transparent",fontSize:12,textAlign:"center"};return a.jsxs(ag,{children:[d&&a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10},children:d}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",marginBottom:10},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{onClick:qt,className:"obe-btn obe-btn-secondary",disabled:h.length===0,children:"Export CSV"}),a.jsx("button",{onClick:or,className:"obe-btn obe-btn-secondary",disabled:h.length===0,children:"Export Excel"}),a.jsx("button",{onClick:kr,className:"obe-btn obe-btn-secondary",disabled:h.length===0||he||tt||B,children:B?"Importing":"Import Excel"}),a.jsx("input",{ref:T,type:"file",accept:".xlsx,.xls",style:{display:"none"},onChange:Or})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:zr,className:"obe-btn obe-btn-secondary",disabled:h.length===0,children:"Download"}),a.jsx("button",{onClick:sr,className:"obe-btn obe-btn-success",disabled:v||h.length===0,children:v?"Saving":"Save Draft"}),a.jsx("button",{onClick:Er,disabled:Se?pt:S||h.length===0||!G||Y,className:"obe-btn obe-btn-primary",children:Se?pt?"Request Pending":"Request Edit":S?"Publishing":"Publish"}),j&&a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Draft: ",j]}),L&&a.jsxs("div",{style:{fontSize:12,color:"#16a34a",alignSelf:"center"},children:["Published: ",L]})]})]}),a.jsx("div",{style:{marginBottom:10,fontSize:12,color:G?"#065f46":"#b91c1c"},children:se?"Checking publish due time":de||(U!=null&&U.due_at?a.jsxs(a.Fragment,{children:["Due: ",new Date(U.due_at).toLocaleString(),"  Remaining: ",ng(z),U.allowed_by_approval&&U.approval_until?a.jsxs(a.Fragment,{children:["  Approved until ",new Date(U.approval_until).toLocaleString()]}):null]}):"Due time not set by IQAC.")}),Y?a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),a.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:a.jsx("button",{className:"obe-btn",onClick:()=>ie(),disabled:se,children:"Refresh"})})]}):null,a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff",marginBottom:10},children:a.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[a.jsxs("label",{style:{fontSize:12,color:"#374151",display:"flex",alignItems:"center"},children:["Term",a.jsx("div",{style:{marginLeft:8,padding:6,border:"1px solid #d1d5db",borderRadius:8,minWidth:160},children:ne.termLabel})]}),a.jsxs("label",{style:{fontSize:12,color:"#374151",display:"flex",alignItems:"center"},children:["Sheet Label",a.jsx("div",{style:{marginLeft:8,padding:6,border:"1px solid #d1d5db",borderRadius:8,minWidth:160},children:ne.batchLabel})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Skill/Attitude max: ",le," each | Total: ",te," | CO-",o,": ",ue," | CO-",l,": ",ue]})]})}),h.length===0?a.jsx("div",{style:{color:"#6b7280",fontSize:14,padding:"12px 0"},children:"No students found for this subject."}):a.jsx(ig,{locked:Y,children:ye?F&&Be?a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10,position:"relative"},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Only"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280",marginRight:36},children:[s,"  ",String(e||"")]}),a.jsx("button",{className:"obe-btn",onClick:()=>E(!1),style:{position:"absolute",right:0,top:0},children:"Close"})]}),rn?a.jsx("div",{style:{color:"#6b7280"},children:"Loading published marks"}):null,$r?a.jsx("div",{style:{color:"#991b1b",fontSize:12,marginBottom:8},children:$r}):null,Tt&&Object.keys(Tt).length||h.length?a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{className:"obe-table",style:{width:"max-content",minWidth:"100%",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:Gt,colSpan:Wt,children:[ne.termLabel," | ",ne.batchLabel," | ",s.toUpperCase()," (PUBLISHED)"]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...Gt,width:42,minWidth:42},children:"S.No"}),a.jsx("th",{style:Gt,children:"Register No."}),a.jsx("th",{style:Gt,children:"Name of the Students"}),a.jsx("th",{style:Gt,children:"Skill 1"}),a.jsx("th",{style:Gt,children:"Skill 2"}),a.jsx("th",{style:Gt,children:"Att 1"}),a.jsx("th",{style:Gt,children:"Att 2"}),a.jsx("th",{style:Gt,children:"Total"}),a.jsxs("th",{style:Gt,colSpan:2,children:["CO-",o]}),a.jsxs("th",{style:Gt,colSpan:2,children:["CO-",l]}),zt.map(Ue=>a.jsxs("th",{style:Gt,colSpan:2,children:["BTL-",Ue]},`pv_btl_${Ue}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:Gt}),a.jsx("th",{style:Gt}),a.jsx("th",{style:Gt}),a.jsx("th",{style:Gt}),a.jsx("th",{style:Gt}),a.jsx("th",{style:Gt}),a.jsx("th",{style:Gt}),a.jsx("th",{style:Gt}),a.jsx("th",{style:Gt,children:"Mark"}),a.jsx("th",{style:Gt,children:"%"}),a.jsx("th",{style:Gt,children:"Mark"}),a.jsx("th",{style:Gt,children:"%"}),zt.map(Ue=>a.jsxs(on.Fragment,{children:[a.jsx("th",{style:Gt,children:"Mark"}),a.jsx("th",{style:Gt,children:"%"})]},`pv_btl_sub_${Ue}`))]})]}),a.jsx("tbody",{children:h.length?h.map((Ue,Ct)=>{const et=Tt&&Tt[String(Ue.id)]||{},ut=typeof et.skill1=="number"?Dn(Number(et.skill1),1,le):ds(et.skill1),Bt=typeof et.skill2=="number"?Dn(Number(et.skill2),1,le):ds(et.skill2),Kt=typeof et.att1=="number"?Dn(Number(et.att1),1,le):ds(et.att1),Jt=typeof et.att2=="number"?Dn(Number(et.att2),1,le):ds(et.att2),ar=ut!==""&&Bt!==""&&Kt!==""&&Jt!==""?Dn(ut+Bt+Kt+Jt,0,te):"",nt=ut!==""&&Kt!==""?Dn(ut+Kt,0,ue):"",Ht=Bt!==""&&Jt!==""?Dn(Bt+Jt,0,ue):"",Pe=[0,0,0,0,0,0];for(const er of st){const pr=ke[er.key];(pr===1||pr===2||pr===3||pr===4||pr===5||pr===6)&&(Pe[pr-1]+=er.max)}const Ot=zt.map(er=>er-1),mt=typeof ar=="number"&&Ot.length?wc(ar/Ot.length):"",Nt=Pe.map((er,pr)=>mt===""||!Ot.includes(pr)?"":er>0?Dn(mt,0,er):wc(mt));return a.jsxs("tr",{children:[a.jsx("td",{style:{...ur,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Ct+1}),a.jsx("td",{style:ur,children:vp(Ue.reg_no)}),a.jsx("td",{style:ur,children:Ue.name||""}),a.jsx("td",{style:{...ur,textAlign:"center"},children:ut}),a.jsx("td",{style:{...ur,textAlign:"center"},children:Bt}),a.jsx("td",{style:{...ur,textAlign:"center"},children:Kt}),a.jsx("td",{style:{...ur,textAlign:"center"},children:Jt}),a.jsx("td",{style:{...ur,textAlign:"center",fontWeight:700},children:ar}),a.jsx("td",{style:{...ur,textAlign:"center"},children:nt}),a.jsx("td",{style:{...ur,textAlign:"center"},children:nt===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(nt,ue)})}),a.jsx("td",{style:{...ur,textAlign:"center"},children:Ht}),a.jsx("td",{style:{...ur,textAlign:"center"},children:Ht===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(Ht,ue)})}),zt.map(er=>{const pr=er-1,we=Nt[pr],Ie=Pe[pr]??0;return a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...ur,textAlign:"center"},children:we}),a.jsx("td",{style:{...ur,textAlign:"center"},children:we===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(Number(we),Ie)})})]},`pv_btl_cells_${Ue.id}_${er}`)})]},`pv_${Ue.id}`)}):Object.keys(Tt||{}).map((Ue,Ct)=>{const et=Tt[Ue]||{},ut=typeof et.skill1=="number"?Dn(Number(et.skill1),1,le):ds(et.skill1),Bt=typeof et.skill2=="number"?Dn(Number(et.skill2),1,le):ds(et.skill2),Kt=typeof et.att1=="number"?Dn(Number(et.att1),1,le):ds(et.att1),Jt=typeof et.att2=="number"?Dn(Number(et.att2),1,le):ds(et.att2),ar=ut!==""&&Bt!==""&&Kt!==""&&Jt!==""?Dn(ut+Bt+Kt+Jt,0,te):"",nt=ut!==""&&Kt!==""?Dn(ut+Kt,0,ue):"",Ht=Bt!==""&&Jt!==""?Dn(Bt+Jt,0,ue):"",Pe=[0,0,0,0,0,0];for(const er of st){const pr=ke[er.key];(pr===1||pr===2||pr===3||pr===4||pr===5||pr===6)&&(Pe[pr-1]+=er.max)}const Ot=zt.map(er=>er-1),mt=typeof ar=="number"&&Ot.length?wc(ar/Ot.length):"",Nt=Pe.map((er,pr)=>mt===""||!Ot.includes(pr)?"":er>0?Dn(mt,0,er):wc(mt));return a.jsxs("tr",{children:[a.jsx("td",{style:{...ur,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Ct+1}),a.jsx("td",{style:ur,children:vp(String(et.reg_no??Ue))}),a.jsx("td",{style:ur,children:et.name||""}),a.jsx("td",{style:{...ur,textAlign:"center"},children:ut}),a.jsx("td",{style:{...ur,textAlign:"center"},children:Bt}),a.jsx("td",{style:{...ur,textAlign:"center"},children:Kt}),a.jsx("td",{style:{...ur,textAlign:"center"},children:Jt}),a.jsx("td",{style:{...ur,textAlign:"center",fontWeight:700},children:ar}),a.jsx("td",{style:{...ur,textAlign:"center"},children:nt}),a.jsx("td",{style:{...ur,textAlign:"center"},children:nt===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(nt,ue)})}),a.jsx("td",{style:{...ur,textAlign:"center"},children:Ht}),a.jsx("td",{style:{...ur,textAlign:"center"},children:Ht===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(Ht,ue)})}),zt.map(er=>{const pr=er-1,we=Nt[pr],Ie=Pe[pr]??0;return a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...ur,textAlign:"center"},children:we}),a.jsx("td",{style:{...ur,textAlign:"center"},children:we===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(Number(we),Ie)})})]},`pv_btl_cells_${Ue}_${er}`)})]},`pv_${Ue}`)})})]})}):rn?null:a.jsx("div",{style:{color:"#6b7280"},children:"No published marks found."}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{className:"obe-btn",onClick:()=>E(!1),children:"Close"})})]}):a.jsxs("div",{className:"obe-table-wrapper",style:{position:"relative"},children:[a.jsxs("table",{className:"obe-table",style:{minWidth:1200,pointerEvents:_e?"none":"auto"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:Gt,colSpan:Wt,children:[ne.termLabel," | ",ne.batchLabel," | ",s.toUpperCase()]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...Gt,width:42,minWidth:42},rowSpan:3,children:"S.No"}),a.jsx("th",{style:Gt,rowSpan:3,children:"Register No."}),a.jsx("th",{style:Gt,rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:Gt,colSpan:2,children:"Skill"}),a.jsx("th",{style:Gt,colSpan:2,children:"Attitude"}),a.jsx("th",{style:Gt,rowSpan:3,children:"Total"}),a.jsx("th",{style:Gt,colSpan:4,children:"CIA 1"}),zt.length?a.jsx("th",{style:Gt,colSpan:zt.length*2,children:"BTL"}):null]}),a.jsxs("tr",{children:[a.jsx("th",{style:Gt,children:"1"}),a.jsx("th",{style:Gt,children:"2"}),a.jsx("th",{style:Gt,children:"1"}),a.jsx("th",{style:Gt,children:"2"}),a.jsxs("th",{style:Gt,colSpan:2,children:["CO-",o]}),a.jsxs("th",{style:Gt,colSpan:2,children:["CO-",l]}),zt.map(Ue=>a.jsxs("th",{style:Gt,colSpan:2,children:["BTL-",Ue]},`btlhead-${Ue}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:Gt}),a.jsx("th",{style:Gt}),a.jsx("th",{style:Gt}),a.jsx("th",{style:Gt}),a.jsx("th",{style:Gt,children:"Mark"}),a.jsx("th",{style:Gt,children:"%"}),a.jsx("th",{style:Gt,children:"Mark"}),a.jsx("th",{style:Gt,children:"%"}),zt.map(Ue=>a.jsxs(on.Fragment,{children:[a.jsx("th",{style:Gt,children:"Mark"}),a.jsx("th",{style:Gt,children:"%"})]},`btl-sub-${Ue}`))]})]}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...ur,fontWeight:700,textAlign:"center"}}),a.jsx("td",{style:{...ur,fontWeight:700,textAlign:"center"}}),a.jsx("td",{style:{...ur,fontWeight:700,textAlign:"center"},children:"BTL"}),st.map(Ue=>a.jsx("td",{style:{...ur,textAlign:"center"},children:(()=>{const Ct=y[Ue.key]??"",et=Ct===""?"-":String(Ct);return a.jsxs("div",{style:{position:"relative",minWidth:44},children:[a.jsx("div",{style:{width:"100%",fontSize:12,padding:"2px 4px",border:"1px solid #d1d5db",borderRadius:8,background:"#fff",textAlign:"center",userSelect:"none"},title:`BTL: ${et}`,children:et}),a.jsxs("select",{"aria-label":`BTL for ${Ue.label}`,value:Ct,onChange:ut=>{if(Y)return;const Bt=ne.markManagerSnapshot!=null;Ee&&Bt||tt||b(Kt=>({...Kt||{},[Ue.key]:ut.target.value===""?"":Number(ut.target.value)}))},style:{position:"absolute",inset:0,width:"100%",height:"100%",opacity:0,cursor:"pointer",appearance:"none",WebkitAppearance:"none",MozAppearance:"none"},children:[a.jsx("option",{value:"",children:"-"}),[1,2,3,4,5,6].map(ut=>a.jsx("option",{value:ut,children:ut},ut))]})]})})()},`btl-select-${Ue.key}`)),a.jsx("td",{style:{...ur,fontWeight:700,textAlign:"center"}}),a.jsx("td",{style:{...ur,fontWeight:700,textAlign:"center"},colSpan:4}),zt.map(Ue=>a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...ur,fontWeight:700,textAlign:"center"}}),a.jsx("td",{style:{...ur,fontWeight:700,textAlign:"center"}})]},`btl-pad-${Ue}`))]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...ur,fontWeight:700,textAlign:"center"},colSpan:3,children:"Name / Max Marks"}),a.jsx("td",{style:{...ur,fontWeight:700,textAlign:"center"},children:le}),a.jsx("td",{style:{...ur,fontWeight:700,textAlign:"center"},children:le}),a.jsx("td",{style:{...ur,fontWeight:700,textAlign:"center"},children:le}),a.jsx("td",{style:{...ur,fontWeight:700,textAlign:"center"},children:le}),a.jsx("td",{style:{...ur,fontWeight:700,textAlign:"center"},children:te}),a.jsx("td",{style:{...ur,fontWeight:700,textAlign:"center"},children:ue}),a.jsx("td",{style:{...ur,fontWeight:700,textAlign:"center"},children:"%"}),a.jsx("td",{style:{...ur,fontWeight:700,textAlign:"center"},children:ue}),a.jsx("td",{style:{...ur,fontWeight:700,textAlign:"center"},children:"%"})]}),h.map((Ue,Ct)=>{const et=ne.rowsByStudentId[String(Ue.id)]||{studentId:Ue.id,skill1:"",skill2:"",att1:"",att2:""},ut=typeof et.skill1=="number"?Dn(Number(et.skill1),0,le):"",Bt=typeof et.skill2=="number"?Dn(Number(et.skill2),0,le):"",Kt=typeof et.att1=="number"?Dn(Number(et.att1),0,le):"",Jt=typeof et.att2=="number"?Dn(Number(et.att2),0,le):"",ar=ut!==""&&Bt!==""&&Kt!==""&&Jt!==""?Dn(ut+Bt+Kt+Jt,0,te):"",nt=ut!==""&&Kt!==""?Dn(ut+Kt,0,ue):"",Ht=Bt!==""&&Jt!==""?Dn(Bt+Jt,0,ue):"",Pe=[0,0,0,0,0,0];for(const we of st){const Ie=y[we.key];(Ie===1||Ie===2||Ie===3||Ie===4||Ie===5||Ie===6)&&(Pe[Ie-1]+=we.max)}const Ot=zt.map(we=>we-1),mt=typeof ar=="number"&&Ot.length?wc(ar/Ot.length):"",Nt=Pe.map((we,Ie)=>mt===""||!Ot.includes(Ie)?"":we>0?Dn(mt,0,we):wc(mt)),pr=zt.length===0||he||tt||Y;return a.jsxs("tr",{children:[a.jsx("td",{style:{...ur,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Ct+1}),a.jsx("td",{style:ur,children:vp(Ue.reg_no)}),a.jsx("td",{style:ur,children:Ue.name||""}),a.jsx("td",{style:ur,children:a.jsx("input",{style:Ve,type:"number",min:0,max:le,value:et.skill1===""?"":et.skill1,disabled:pr,onChange:we=>{const Ie=we.target.value;if(Ie==="")return we.currentTarget.setCustomValidity(""),gr(Ue.id,{skill1:""});const Ze=Number(Ie);if(Number.isFinite(Ze)){if(Ze>le){we.currentTarget.setCustomValidity(`Max mark is ${le}`),we.currentTarget.reportValidity(),window.setTimeout(()=>we.currentTarget.setCustomValidity(""),0);return}we.currentTarget.setCustomValidity(""),gr(Ue.id,{skill1:Ze})}}})}),a.jsx("td",{style:ur,children:a.jsx("input",{style:Ve,type:"number",min:0,max:le,value:et.skill2===""?"":et.skill2,disabled:pr,onChange:we=>{const Ie=we.target.value;if(Ie==="")return we.currentTarget.setCustomValidity(""),gr(Ue.id,{skill2:""});const Ze=Number(Ie);if(Number.isFinite(Ze)){if(Ze>le){we.currentTarget.setCustomValidity(`Max mark is ${le}`),we.currentTarget.reportValidity(),window.setTimeout(()=>we.currentTarget.setCustomValidity(""),0);return}we.currentTarget.setCustomValidity(""),gr(Ue.id,{skill2:Ze})}}})}),a.jsx("td",{style:ur,children:a.jsx("input",{style:Ve,type:"number",min:0,max:le,value:et.att1===""?"":et.att1,disabled:pr,onChange:we=>{const Ie=we.target.value;if(Ie==="")return we.currentTarget.setCustomValidity(""),gr(Ue.id,{att1:""});const Ze=Number(Ie);if(Number.isFinite(Ze)){if(Ze>le){we.currentTarget.setCustomValidity(`Max mark is ${le}`),we.currentTarget.reportValidity(),window.setTimeout(()=>we.currentTarget.setCustomValidity(""),0);return}we.currentTarget.setCustomValidity(""),gr(Ue.id,{att1:Ze})}}})}),a.jsx("td",{style:ur,children:a.jsx("input",{style:Ve,type:"number",min:0,max:le,value:et.att2===""?"":et.att2,disabled:pr,onChange:we=>{const Ie=we.target.value;if(Ie==="")return we.currentTarget.setCustomValidity(""),gr(Ue.id,{att2:""});const Ze=Number(Ie);if(Number.isFinite(Ze)){if(Ze>le){we.currentTarget.setCustomValidity(`Max mark is ${le}`),we.currentTarget.reportValidity(),window.setTimeout(()=>we.currentTarget.setCustomValidity(""),0);return}we.currentTarget.setCustomValidity(""),gr(Ue.id,{att2:Ze})}}})}),a.jsx("td",{style:{...ur,textAlign:"center",fontWeight:700},children:ar}),a.jsx("td",{style:{...ur,textAlign:"center"},children:nt}),a.jsx("td",{style:{...ur,textAlign:"center"},children:nt===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(nt,ue)})}),a.jsx("td",{style:{...ur,textAlign:"center"},children:Ht}),a.jsx("td",{style:{...ur,textAlign:"center"},children:Ht===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(Ht,ue)})}),zt.map(we=>{const Ie=we-1,Ze=Nt[Ie],bt=Pe[Ie]??0;return a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...ur,textAlign:"center"},children:Ze}),a.jsx("td",{style:{...ur,textAlign:"center"},children:Ze===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(Number(Ze),bt)})})]},`btl-cells-${we}`)})]},Ue.id)})]})]}),zt.length===0&&a.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(255,255,255,0.85)",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:10,padding:20,borderRadius:6},children:[a.jsx("div",{style:{fontSize:16,fontWeight:700},children:"BTL values not selected"}),a.jsx("div",{style:{color:"#6b7280"},children:"Assign BTL values in the BTL row below Skill/Attitude to enable entry."}),a.jsx("div",{style:{display:"flex",gap:8},children:a.jsx("button",{onClick:()=>{if(Y)return;const Ue=ne.markManagerSnapshot!=null;Ee&&Ue||tt||b({skill1:3,skill2:4,att1:3,att2:4})},style:{padding:"6px 10px"},children:"Quick: BTL-3/4"})})]}),he&&!Y&&!_e?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(239,246,255,0.65)",border:"1px solid rgba(59,130,246,0.25)",borderRadius:6,pointerEvents:"none"}}),a.jsxs("div",{style:{position:"absolute",left:"50%",top:16,transform:"translateX(-50%)",zIndex:40,width:280,background:"#fff",border:"1px solid #e5e7eb",padding:12,borderRadius:12,boxShadow:"0 6px 18px rgba(17,24,39,0.06)",display:"flex",flexDirection:"column",gap:10,alignItems:"stretch"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:950,color:"#111827"},children:"Table Locked"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:4},children:"Confirm the Mark Manager to unlock the student list."})]}),a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",flexWrap:"wrap"},children:[a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>Ge({mode:"confirm"}),disabled:!e||lt,children:"Save Mark Manager"}),a.jsx("button",{className:"obe-btn",onClick:()=>Vt(),disabled:lt,children:"Request Access"})]})]})]}):null,_e&&!Y?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{position:"absolute",inset:0,background:"linear-gradient(180deg, rgba(34,197,94,0.18) 0%, rgba(16,185,129,0.26) 100%)",border:"1px solid rgba(22,163,74,0.25)",borderRadius:6,pointerEvents:"none"}}),a.jsxs("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:40,width:320,background:"#fff",border:"1px solid #e5e7eb",padding:12,borderRadius:12,boxShadow:"0 6px 18px rgba(17,24,39,0.06)",display:"flex",flexDirection:"column",gap:10,alignItems:"stretch"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:950,color:"#065f46"},children:"Published  Locked"}),a.jsx("div",{style:{fontSize:12,color:"#065f46",marginTop:4},children:"Marks are published. Use View or Request Edit to ask IQAC for access."})]}),a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",flexWrap:"wrap"},children:[a.jsx("button",{className:"obe-btn",onClick:()=>{E(!0),hr(null);try{vt(!1)}catch{}},children:"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:pt,onClick:async()=>{if(pt){alert("Edit request is pending. Please wait.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}Pr(!0)},children:pt?"Request Pending":"Request Edit"})]})]})]}):null]}):a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:20,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:900,fontSize:16},children:wt?"Published  Locked":"Table Locked"}),a.jsx("div",{style:{color:"#6b7280",marginTop:8},children:wt?"Marks published. Use View or Request Edit to ask IQAC for access.":"Confirm the Mark Manager to unlock the student list."}),a.jsx("div",{style:{display:"flex",gap:8,marginTop:12,justifyContent:"flex-end"},children:wt?a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn",onClick:()=>{E(!0),hr(null);try{vt(!1)}catch{}},children:"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:pt,onClick:async()=>{if(pt){alert("Edit request is pending. Please wait.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}Pr(!0)},children:pt?"Request Pending":"Request Edit"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>Ge({mode:"confirm"}),disabled:!e||lt,children:"Save Mark Manager"}),a.jsx("button",{className:"obe-btn",onClick:()=>Vt(),disabled:lt,children:"Request Access"})]})})]})}),ht&&!n?a.jsx(xs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:9999},onClick:()=>{lt||Ge(null)},children:a.jsxs("div",{style:{width:"min(640px,96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Ue=>Ue.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:ht.mode==="confirm"?`Confirmation - ${s}`:`Request Edit - ${s}`}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:String(e||"")})]}),ht.mode==="confirm"?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"Confirm the selected BTL settings. After confirming, Mark Manager will be locked and the table will be editable."}),a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Item"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Value"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"Skill/Attitude max"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:le})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"Total max"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:te})]}),a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:["CO-",o," max"]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:ue})]}),a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:["CO-",l," max"]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:ue})]}),st.map(Ue=>a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:[Ue.label," BTL"]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:a.jsxs("select",{className:"obe-input","aria-label":`BTL for ${Ue.label}`,value:y[Ue.key]??"",disabled:lt||Y||tt,onChange:Ct=>{if(Y||tt)return;const et=Ct.target.value;b(ut=>({...ut||{},[Ue.key]:et===""?"":Number(et)}))},style:{minWidth:110},children:[a.jsx("option",{value:"",children:"-"}),[1,2,3,4,5,6].map(Ct=>a.jsx("option",{value:Ct,children:Ct},Ct))]})})]},`mm_${Ue.key}`))]})]})})]}):a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. Mark Manager will remain locked until IQAC approves."}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[a.jsx("button",{className:"obe-btn",disabled:lt,onClick:()=>Ge(null),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:lt||!e,onClick:async()=>{if(e){if(ht.mode==="request"){Ge(null),await Vt();return}await Dt()}},children:ht.mode==="confirm"?"Confirm":"Send Request"})]})]})})}):null,yt?a.jsx(xs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>Fr(!1),children:a.jsxs("div",{style:{width:"min(1100px, 96vw)",maxHeight:"90vh",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Ue=>Ue.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10,position:"relative"},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Only"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280",marginRight:36},children:[s,"  ",String(e||"")]}),a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>Fr(!1),style:{position:"absolute",right:0,top:0},children:"Close"})]}),rn?a.jsx("div",{style:{color:"#6b7280"},children:"Loading published marks"}):null,$r?a.jsx("div",{style:{color:"#991b1b",fontSize:12,marginBottom:8},children:$r}):null,Tt&&Object.keys(Tt).length||h.length?a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{className:"obe-table",style:{width:"max-content",minWidth:"100%",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:Gt,colSpan:Wt,children:[ne.termLabel," | ",ne.batchLabel," | ",s.toUpperCase()," (PUBLISHED)"]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...Gt,width:42,minWidth:42},children:"S.No"}),a.jsx("th",{style:Gt,children:"Register No."}),a.jsx("th",{style:Gt,children:"Name of the Students"}),a.jsx("th",{style:Gt,children:"Skill 1"}),a.jsx("th",{style:Gt,children:"Skill 2"}),a.jsx("th",{style:Gt,children:"Att 1"}),a.jsx("th",{style:Gt,children:"Att 2"}),a.jsx("th",{style:Gt,children:"Total"}),a.jsxs("th",{style:Gt,colSpan:2,children:["CO-",o]}),a.jsxs("th",{style:Gt,colSpan:2,children:["CO-",l]}),zt.map(Ue=>a.jsxs("th",{style:Gt,colSpan:2,children:["BTL-",Ue]},`pv_btl_${Ue}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:Gt}),a.jsx("th",{style:Gt}),a.jsx("th",{style:Gt}),a.jsx("th",{style:Gt}),a.jsx("th",{style:Gt}),a.jsx("th",{style:Gt}),a.jsx("th",{style:Gt}),a.jsx("th",{style:Gt}),a.jsx("th",{style:Gt,children:"Mark"}),a.jsx("th",{style:Gt,children:"%"}),a.jsx("th",{style:Gt,children:"Mark"}),a.jsx("th",{style:Gt,children:"%"}),zt.map(Ue=>a.jsxs(on.Fragment,{children:[a.jsx("th",{style:Gt,children:"Mark"}),a.jsx("th",{style:Gt,children:"%"})]},`pv_btl_sub_${Ue}`))]})]}),a.jsx("tbody",{children:h.length?h.map((Ue,Ct)=>{const et=Tt&&Tt[String(Ue.id)]||{},ut=typeof et.skill1=="number"?Dn(Number(et.skill1),1,le):ds(et.skill1),Bt=typeof et.skill2=="number"?Dn(Number(et.skill2),1,le):ds(et.skill2),Kt=typeof et.att1=="number"?Dn(Number(et.att1),1,le):ds(et.att1),Jt=typeof et.att2=="number"?Dn(Number(et.att2),1,le):ds(et.att2),ar=ut!==""&&Bt!==""&&Kt!==""&&Jt!==""?Dn(ut+Bt+Kt+Jt,0,te):"",nt=ut!==""&&Kt!==""?Dn(ut+Kt,0,ue):"",Ht=Bt!==""&&Jt!==""?Dn(Bt+Jt,0,ue):"",Pe=[0,0,0,0,0,0];for(const er of st){const pr=ke[er.key];(pr===1||pr===2||pr===3||pr===4||pr===5||pr===6)&&(Pe[pr-1]+=er.max)}const Ot=zt.map(er=>er-1),mt=typeof ar=="number"&&Ot.length?wc(ar/Ot.length):"",Nt=Pe.map((er,pr)=>mt===""||!Ot.includes(pr)?"":er>0?Dn(mt,0,er):wc(mt));return a.jsxs("tr",{children:[a.jsx("td",{style:{...ur,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Ct+1}),a.jsx("td",{style:ur,children:vp(Ue.reg_no)}),a.jsx("td",{style:ur,children:Ue.name||""}),a.jsx("td",{style:{...ur,textAlign:"center"},children:ut}),a.jsx("td",{style:{...ur,textAlign:"center"},children:Bt}),a.jsx("td",{style:{...ur,textAlign:"center"},children:Kt}),a.jsx("td",{style:{...ur,textAlign:"center"},children:Jt}),a.jsx("td",{style:{...ur,textAlign:"center",fontWeight:700},children:ar}),a.jsx("td",{style:{...ur,textAlign:"center"},children:nt}),a.jsx("td",{style:{...ur,textAlign:"center"},children:nt===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(nt,ue)})}),a.jsx("td",{style:{...ur,textAlign:"center"},children:Ht}),a.jsx("td",{style:{...ur,textAlign:"center"},children:Ht===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(Ht,ue)})}),zt.map(er=>{const pr=er-1,we=Nt[pr],Ie=Pe[pr]??0;return a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...ur,textAlign:"center"},children:we}),a.jsx("td",{style:{...ur,textAlign:"center"},children:we===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(Number(we),Ie)})})]},`pv_btl_cells_${Ue.id}_${er}`)})]},`pv_${Ue.id}`)}):Object.keys(Tt||{}).map((Ue,Ct)=>{const et=Tt[Ue]||{},ut=typeof et.skill1=="number"?Dn(Number(et.skill1),1,le):ds(et.skill1),Bt=typeof et.skill2=="number"?Dn(Number(et.skill2),1,le):ds(et.skill2),Kt=typeof et.att1=="number"?Dn(Number(et.att1),1,le):ds(et.att1),Jt=typeof et.att2=="number"?Dn(Number(et.att2),1,le):ds(et.att2),ar=ut!==""&&Bt!==""&&Kt!==""&&Jt!==""?Dn(ut+Bt+Kt+Jt,0,te):"",nt=ut!==""&&Kt!==""?Dn(ut+Kt,0,ue):"",Ht=Bt!==""&&Jt!==""?Dn(Bt+Jt,0,ue):"",Pe=[0,0,0,0,0,0];for(const er of st){const pr=ke[er.key];(pr===1||pr===2||pr===3||pr===4||pr===5||pr===6)&&(Pe[pr-1]+=er.max)}const Ot=zt.map(er=>er-1),mt=typeof ar=="number"&&Ot.length?wc(ar/Ot.length):"",Nt=Pe.map((er,pr)=>mt===""||!Ot.includes(pr)?"":er>0?Dn(mt,0,er):wc(mt));return a.jsxs("tr",{children:[a.jsx("td",{style:{...ur,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Ct+1}),a.jsx("td",{style:ur,children:vp(String(et.reg_no??Ue))}),a.jsx("td",{style:ur,children:et.name||""}),a.jsx("td",{style:{...ur,textAlign:"center"},children:ut}),a.jsx("td",{style:{...ur,textAlign:"center"},children:Bt}),a.jsx("td",{style:{...ur,textAlign:"center"},children:Kt}),a.jsx("td",{style:{...ur,textAlign:"center"},children:Jt}),a.jsx("td",{style:{...ur,textAlign:"center",fontWeight:700},children:ar}),a.jsx("td",{style:{...ur,textAlign:"center"},children:nt}),a.jsx("td",{style:{...ur,textAlign:"center"},children:nt===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(nt,ue)})}),a.jsx("td",{style:{...ur,textAlign:"center"},children:Ht}),a.jsx("td",{style:{...ur,textAlign:"center"},children:Ht===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(Ht,ue)})}),zt.map(er=>{const pr=er-1,we=Nt[pr],Ie=Pe[pr]??0;return a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...ur,textAlign:"center"},children:we}),a.jsx("td",{style:{...ur,textAlign:"center"},children:we===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(Number(we),Ie)})})]},`pv_btl_cells_${Ue}_${er}`)})]},`pv_${Ue}`)})})]})}):rn?null:a.jsx("div",{style:{color:"#6b7280"},children:"No published marks found."}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>Fr(!1),children:"Close"})})]})})}):null,Rn?a.jsx(xs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>{je||Pr(!1)},children:a.jsxs("div",{style:{width:"min(560px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Ue=>Ue.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[s,"  ",String(e||"")]})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",Ut?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:Sn,onChange:Ue=>Me(Ue.target.value),placeholder:"Explain why you need to edit (required)",rows:4,className:"obe-input",style:{resize:"vertical"}})]}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:12},children:[a.jsx("button",{className:"obe-btn",disabled:je,onClick:()=>Pr(!1),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:je||pt||!e||!String(Sn||"").trim(),onClick:De,title:pt?"Request pending (up to 24 hours)":void 0,children:je?"Requesting":pt?"Request Pending":"Send Request"})]})]})})}):null,We&&a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Saved key: ",a.jsx("span",{style:{fontFamily:"monospace"},children:We})]})]})}function wxe(e){return a.jsx(Wz,{...e,assessmentKey:"formative2"})}const Sxe=new URL("https://static.vecteezy.com/system/resources/thumbnails/014/585/778/small/gold-locked-padlock-png.png",import.meta.url).href,Us=5,Gl=25,Eo=30,_xe={1:20,2:20,3:10,4:20,5:20};function kxe(e,t){const r=String(e??"").trim(),n=String(t??"").trim(),i=r.replace(/[^0-9]/g,""),s=n.replace(/[^0-9]/g,"");if(i&&s)try{const o=BigInt(i),l=BigInt(s);if(o<l)return-1;if(o>l)return 1}catch{if(i.length!==s.length)return i.length-s.length;if(i<s)return-1;if(i>s)return 1}else{if(i&&!s)return-1;if(!i&&s)return 1}return r<n?-1:r>n?1:0}function jxe(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const i=r.localeCompare(n);if(i)return i}else if(r||n)return r?-1:1;return kxe(e==null?void 0:e.reg_no,t==null?void 0:t.reg_no)}function oa(e,t,r){return Number.isFinite(e)?Math.max(t,Math.min(r,Math.trunc(e))):t}function Axe(e,t){return`${e}_sheet_${t}`}function Ed(e,t){const r=Array.isArray(e)?e:[],n=[];for(let i=0;i<t;i++){const s=r[i];if(s===""||s==null){n.push("");continue}const o=typeof s=="number"?s:Number(s);n.push(Number.isFinite(o)?o:"")}return n}function Df(e,t){const r=Array.isArray(e)?e:[],n=[];for(let i=0;i<t;i++){const s=r[i],o=typeof s=="number"?s:Number(s);o===1||o===2||o===3||o===4||o===5||o===6?n.push(o):n.push(1)}return n}function qb(e){const t=e.filter(r=>typeof r=="number"&&Number.isFinite(r));return t.length?t.reduce((r,n)=>r+n,0)/t.length:null}function NM(e){const t=e&&typeof e=="object"?e:{},r={};for(const n of Object.keys(t)){const i=t[n];if(i===""||i==null){r[n]="";continue}const s=typeof i=="number"?i:Number(i);r[n]=Number.isFinite(s)?s:""}return r}function Nxe(e){let t=0;for(const r of Object.values(e||{}))typeof r=="number"&&Number.isFinite(r)&&(t+=r);return t}function Hb(e,t){if(e==null)return"";if(!Number.isFinite(t)||t<=0)return"0";const r=e/t*100;return`${Number.isFinite(r)?r.toFixed(0):0}`}function Ef(e,t,r,n){const i=e.coConfigs&&typeof e.coConfigs=="object"?e.coConfigs:{},s={};for(const o of t){const l=String(o),c=i[l];if(c&&typeof c=="object"&&"enabled"in c){const u=oa(Number(c.expCount??Us),0,12);s[l]={enabled:!!c.enabled,expCount:u,expMax:oa(Number(c.expMax??Gl),0,100),btl:Df(c.btl,u)}}else if(o===r){const u=oa(Number(e.expCountA??Us),0,12);s[l]={enabled:!!(e.coAEnabled??!0),expCount:u,expMax:oa(Number(e.expMaxA??Gl),0,100),btl:Df(e.btlsA,u)}}else if(o===n){const u=oa(Number(e.expCountB??Us),0,12);s[l]={enabled:!!(e.coBEnabled??!0),expCount:u,expMax:oa(Number(e.expMaxB??Gl),0,100),btl:Df(e.btlsB,u)}}else s[l]={enabled:!1,expCount:Us,expMax:Gl,btl:Array.from({length:Us},()=>1)}}return s}function Mk(e,t,r,n,i){const s=e==null?void 0:e.marksByCo;if(s&&typeof s=="object"){const o=s[String(t)];if(Array.isArray(o))return Ed(o,r)}return t===n?Ed(e==null?void 0:e.marksA,r):t===i?Ed(e==null?void 0:e.marksB,r):Array.from({length:r},()=>"")}function J2({subjectId:e,teachingAssignmentId:t,assessmentKey:r,label:n,coA:i,coB:s,allCos:o,showCia1Embed:l,cia1Embed:c}){const u=r==="review1"||r==="review2",d=r==="formative1"||r==="formative2",f=x.useMemo(()=>o&&o.length>0?o:[i,s],[o,i,s]),h=x.useMemo(()=>u?[i,s]:f,[u,f,i,s]),[p,m]=x.useState(!1),[g,y]=x.useState(null),[b,v]=x.useState([]),[w,S]=x.useState(null),[k,j]=x.useState(!1),[A,L]=x.useState(null),[P,F]=x.useState(null),[E,T]=x.useState(!1),[B,q]=x.useState(null),[U,se]=x.useState(!1),[de,z]=x.useState(""),[G,ie]=x.useState(!1),[Y,C]=x.useState(null),[K,H]=x.useState(!1),[R,J]=x.useState(null),[V,X]=x.useState(!1),[Q,ne]=x.useState(null),[oe,O]=x.useState(null),[W,ae]=x.useState(!1),[I,Z]=x.useState(""),[me,Te]=x.useState(!1),[Ae,Be]=x.useState(null),[Ee,ze]=x.useState(null),[Xe,Pt]=x.useState(!1),[ft,He]=x.useState({sheet:{termLabel:"KRCT AY25-26",batchLabel:e||"",coAEnabled:!0,coBEnabled:!0,ciaExamEnabled:!0,ciaExamMax:Eo,expCountA:Us,expCountB:Us,btlsA:Array.from({length:Us},()=>1),btlsB:Array.from({length:Us},()=>1),rowsByStudentId:{},expMaxA:Gl,expMaxB:Gl,markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null}}),tt=x.useMemo(()=>e?Axe(r,e):"",[r,e]),{data:_e,publishAllowed:Se,remainingSeconds:he,loading:ye,error:ht,refresh:Ge}=V0({assessment:r,subjectCode:String(e||""),teachingAssignmentId:t}),{data:lt,refresh:jt}=G0({assessment:r,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:wt}=oc({assessment:r,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!1}}),yt=!!B||!!(lt!=null&&lt.exists&&(lt!=null&&lt.is_published)),Fr=lt!=null&&lt.exists?!!(lt!=null&&lt.entry_open):!0,Tt=!!(yt&&!Fr),{pending:hr,pendingUntilMs:rn,setPendingUntilMs:en,refresh:$r}=K0({enabled:!!(yt&&Tt)&&!!e,assessment:r,subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:t});Y0(!!U||!!oe||!!K);const Kr=!!(_e!=null&&_e.global_override_active&&(_e==null?void 0:_e.global_is_open)===!1);x.useEffect(()=>{let Ve=!0;return(async()=>{try{const Rt=await ku();if(!Ve)return;S(Rt||null),He(_t=>({..._t,sheet:{..._t.sheet,termLabel:String((Rt==null?void 0:Rt.termLabel)||_t.sheet.termLabel||"KRCT AY25-26"),batchLabel:e||_t.sheet.batchLabel}}))}catch{}})(),()=>{Ve=!1}},[e]),x.useEffect(()=>{let Ve=!0;return(async()=>{if(e)try{const Rt=await ei(r,e);if(!Ve)return;const _t=Rt==null?void 0:Rt.draft;if(_t&&typeof _t=="object"&&_t.sheet&&typeof _t.sheet=="object"){const Xt=!!(_t.sheet.coAEnabled??!0),Ue=!!(_t.sheet.coBEnabled??!0),Ct=!!(_t.sheet.ciaExamEnabled??!0);let et=Number(_t.sheet.ciaExamMax);if(d)et=Eo;else if(!Number.isFinite(et)||et<0)try{const we=_t.sheet.coConfigs&&typeof _t.sheet.coConfigs=="object"?_t.sheet.coConfigs:null,Ie=[];if(we)for(const[bt,St]of Object.entries(we)){const Sr=Number(bt);Number.isFinite(Sr)&&St&&typeof St=="object"&&St.enabled===!0&&Ie.push(Math.trunc(Sr))}else Xt&&Ie.push(i),Ue&&Ie.push(s);const Ze=Ie.reduce((bt,St)=>bt+Number(_xe[St]??0),0);et=Ze>0?Ze:Eo}catch{et=Eo}const ut=d?Eo:oa(et,0,200),Bt=oa(Number(_t.sheet.expCountA??Us),0,12),Kt=oa(Number(_t.sheet.expCountB??Us),0,12),Jt=Df(_t.sheet.btlsA,Bt),ar=Df(_t.sheet.btlsB,Kt),nt={},Ht=_t.sheet.rowsByStudentId&&typeof _t.sheet.rowsByStudentId=="object"?_t.sheet.rowsByStudentId:{};for(const[we,Ie]of Object.entries(Ht)){const Ze=Ie&&typeof Ie=="object"?Ie:{},bt=Ed(Ze.marksA,Bt),St=Ed(Ze.marksB,Kt),Sr=NM(Ze.caaExamByCo),Yr=Ze.ciaExam,ct=Yr===""||Yr==null?"":Number(Yr);let $t=ct===""?"":Number.isFinite(ct)?ct:"";if($t===""&&Sr&&Object.keys(Sr).length){const qe=Nxe(Sr);qe>0&&($t=qe)}typeof $t=="number"&&Number.isFinite($t)&&($t=Math.max(0,Math.min(ut,Math.trunc($t)))),nt[String(we)]={...Ze,studentId:Number.isFinite(Number(Ze.studentId))?Number(Ze.studentId):Number(we),marksA:bt,marksB:St,ciaExam:$t,caaExamByCo:Sr}}const Pe=_t.sheet.markManagerSnapshot??null,Ot=_t.sheet.markManagerApprovalUntil??null,mt=_t.sheet.markManagerLocked,Nt=typeof mt=="boolean"?mt:!!Pe;He({sheet:{termLabel:String(_t.sheet.termLabel||(w==null?void 0:w.termLabel)||"KRCT AY25-26"),batchLabel:String(e),coAEnabled:Xt,coBEnabled:Ue,ciaExamEnabled:Ct,ciaExamMax:ut,expCountA:Bt,expMaxA:oa(Number(_t.sheet.expMaxA??Gl),0,100),expCountB:Kt,expMaxB:oa(Number(_t.sheet.expMaxB??Gl),0,100),btlsA:Jt,btlsB:ar,coConfigs:_t.sheet.coConfigs&&typeof _t.sheet.coConfigs=="object"?_t.sheet.coConfigs:void 0,rowsByStudentId:nt,markManagerLocked:Nt,markManagerSnapshot:Pe,markManagerApprovalUntil:Ot}});try{tt&&Kn(tt,{rowsByStudentId:_t.sheet.rowsByStudentId||{}})}catch{}const er=(Rt==null?void 0:Rt.updated_at)??null,pr=(Rt==null?void 0:Rt.updated_by)??null;if(er)try{L(new Date(String(er)).toLocaleString())}catch{L(String(er))}pr&&F(String(pr.name||pr.username||pr.id||""))}else{const Xt=tt?Jn(tt):null,Ue=Xt!=null&&Xt.rowsByStudentId&&typeof Xt.rowsByStudentId=="object"?Xt.rowsByStudentId:{};He(Ct=>({...Ct,sheet:{...Ct.sheet,batchLabel:String(e),rowsByStudentId:Ue}}))}}catch{}})(),()=>{Ve=!1}},[r,e,tt,w]),x.useEffect(()=>{let Ve=!0;return(async()=>{if(!t){v([]);return}m(!0),y(null);try{const Rt=await Vc(t);if(!Ve)return;const Xt=[...(Rt==null?void 0:Rt.students)||[]].sort((Ue,Ct)=>jxe(Ue,Ct));v(Xt)}catch(Rt){if(!Ve)return;v([]),y((Rt==null?void 0:Rt.message)||"Failed to load roster")}finally{Ve&&m(!1)}})(),()=>{Ve=!1}},[t]),x.useEffect(()=>{e&&b.length!==0&&He(Ve=>{const Rt=oa(Number(Ve.sheet.expCountA??Us),0,12),_t=oa(Number(Ve.sheet.expCountB??Us),0,12),Xt=Df(Ve.sheet.btlsA,Rt),Ue=Df(Ve.sheet.btlsB,_t),Ct={...Ve.sheet.rowsByStudentId||{}};for(const et of b){const ut=String(et.id),Bt=Ct[ut];if(!Bt)Ct[ut]={studentId:et.id,marksA:Array.from({length:Rt},()=>""),marksB:Array.from({length:_t},()=>""),caaExamByCo:{},ciaExam:""};else{const Kt=Ed(Bt.marksA,Rt),Jt=Ed(Bt.marksB,_t),ar=Bt.ciaExam,nt=ar===""||ar==null?"":Number(ar),Ht=nt===""?"":Number.isFinite(nt)?nt:"",Pe=NM(Bt.caaExamByCo);Ct[ut]={...Bt,marksA:Kt,marksB:Jt,ciaExam:Ht,caaExamByCo:Pe}}}return{...Ve,sheet:{...Ve.sheet,batchLabel:String(e),expCountA:Rt,expCountB:_t,btlsA:Xt,btlsB:Ue,rowsByStudentId:Ct}}})},[b,e]),x.useEffect(()=>{if(tt)try{Kn(tt,{rowsByStudentId:ft.sheet.rowsByStudentId})}catch{}},[ft.sheet.rowsByStudentId,tt]),x.useEffect(()=>{if(!e)return;if(lt!=null&&lt.exists){const _t=!!(lt!=null&&lt.mark_manager_locked);!!ft.sheet.markManagerLocked!==_t&&He(Xt=>({...Xt,sheet:{...Xt.sheet,markManagerLocked:_t}}));return}const Ve=!!(wt!=null&&wt.allowed_by_approval),Rt=wt!=null&&wt.approval_until?String(wt.approval_until):null;if(Ve&&Rt){(ft.sheet.markManagerApprovalUntil?String(ft.sheet.markManagerApprovalUntil):null)!==Rt&&He(Xt=>({...Xt,sheet:{...Xt.sheet,markManagerLocked:!1,markManagerApprovalUntil:Rt}}));return}},[e,lt==null?void 0:lt.exists,lt==null?void 0:lt.mark_manager_locked,wt==null?void 0:wt.allowed_by_approval,wt==null?void 0:wt.approval_until,ft.sheet.markManagerLocked,ft.sheet.markManagerApprovalUntil]),x.useEffect(()=>{if(!e)return;let Ve=!1;const Rt=setTimeout(async()=>{try{await Ri(r,e,ft),Ve||L(new Date().toLocaleString())}catch{}},900);return()=>{Ve=!0,clearTimeout(Rt)}},[r,e,ft]);const Rn=x.useMemo(()=>Ef(ft.sheet,f,i,s),[ft.sheet,f,i,s]),Pr=x.useMemo(()=>h.filter(Ve=>{var Rt;return(Rt=Rn[String(Ve)])==null?void 0:Rt.enabled}).map(Ve=>{const Rt=Rn[String(Ve)];return{coNumber:Ve,expCount:Rt.expCount,expMax:Rt.expMax,btl:Rt.btl}}),[Rn,h]),Sn=x.useMemo(()=>Pr.reduce((Ve,Rt)=>Ve+Rt.expCount,0),[Pr]),Me=Pr.length>0,je=ft.sheet.ciaExamEnabled!==!1,Mt=x.useMemo(()=>{if(d)return Eo;const Ve=Number(ft.sheet.ciaExamMax??Eo);return oa(Number.isFinite(Ve)?Ve:Eo,0,200)},[d,ft.sheet.ciaExamMax]),pt=x.useMemo(()=>{if(Sn===0)return[];const Ve=new Set;for(const Rt of Pr)for(const _t of Rt.btl.slice(0,Rt.expCount))Ve.add(_t);return[1,2,3,4,5,6].filter(Rt=>Ve.has(Rt))},[Pr,Sn]),Ut=Me?Pr.length*2:2,ir=x.useMemo(()=>Pr.reduce((Ve,Rt)=>Math.max(Ve,Rt.expMax),Gl),[Pr]),fr=Rn[String(i)],vr=Rn[String(s)];fr!=null&&fr.enabled,vr!=null&&vr.enabled,oa(Number((fr==null?void 0:fr.expCount)??Us),0,12),oa(Number((vr==null?void 0:vr.expCount)??Us),0,12),oa(Number((fr==null?void 0:fr.expMax)??Gl),0,100),oa(Number((vr==null?void 0:vr.expMax)??Gl),0,100);const re=!!ft.sheet.markManagerLocked,le=re,te=!!(Kr||lt!=null&&lt.exists&&!(lt!=null&&lt.entry_open));function ue(Ve,Rt){He(_t=>{if(_t.sheet.markManagerLocked)return _t;const Xt=Ef(_t.sheet,f,i,s);return Xt[String(Ve)]={...Xt[String(Ve)],enabled:Rt},{..._t,sheet:{..._t.sheet,coConfigs:Xt}}})}function Ne(Ve,Rt){const _t=oa(Number(Rt),0,100);He(Xt=>{if(Xt.sheet.markManagerLocked)return Xt;const Ue=Ef(Xt.sheet,f,i,s);return Ue[String(Ve)]={...Ue[String(Ve)],expMax:_t},{...Xt,sheet:{...Xt.sheet,coConfigs:Ue}}})}function ke(Ve,Rt){const _t=oa(Rt,0,12);He(Xt=>{if(Xt.sheet.markManagerLocked)return Xt;const Ue=Ef(Xt.sheet,f,i,s),Ct=Ue[String(Ve)];Ue[String(Ve)]={...Ct,expCount:_t,btl:Df(Ct.btl,_t)};const et={...Xt.sheet.rowsByStudentId||{}};for(const ut of Object.keys(et)){const Bt=et[ut],Kt=Bt.marksByCo&&typeof Bt.marksByCo=="object"?{...Bt.marksByCo}:{};Kt[String(Ve)]=Ed(Kt[String(Ve)],_t),et[ut]={...Bt,marksByCo:Kt}}return{...Xt,sheet:{...Xt.sheet,coConfigs:Ue,rowsByStudentId:et}}})}function vt(Ve,Rt,_t){He(Xt=>{if(Tt||Kr)return Xt;const Ue=Ef(Xt.sheet,f,i,s),Ct=Ue[String(Ve)],et=[...Ct.btl];return et[Rt]=_t,Ue[String(Ve)]={...Ct,btl:et},{...Xt,sheet:{...Xt.sheet,coConfigs:Ue}}})}function rt(Ve){He(Rt=>Rt.sheet.markManagerLocked?Rt:{...Rt,sheet:{...Rt.sheet,ciaExamEnabled:!!Ve}})}function De(Ve){const Rt=d?Eo:oa(Number(Ve),0,200);He(_t=>_t.sheet.markManagerLocked?_t:{..._t,sheet:{..._t.sheet,ciaExamMax:Rt}})}function We(Ve){const Rt=Ef(Ve,f,i,s),_t=f.filter(Ct=>{var et;return(et=Rt[String(Ct)])==null?void 0:et.enabled}).map(Ct=>{const et=Rt[String(Ct)];return{co:Ct,expCount:et.expCount,expMax:et.expMax}}),Xt=!!(Ve.ciaExamEnabled??!0),Ue=d?Eo:oa(Number(Ve.ciaExamMax??Eo),0,200);return JSON.stringify({enabled:_t,ciaExamEnabled:Xt,ciaExamMax:Ue})}async function st(){if(e){ae(!0),ze(null);try{const Ve=await il({assessment:r,subject_code:String(e),scope:"MARK_MANAGER",reason:`Edit request: Mark Manager changes for ${n}`,teaching_assignment_id:t});alert(al(Ve))}catch(Ve){const Rt=sl(Ve,"Request failed");ze(Rt),alert(`Edit request failed: ${Rt}`)}finally{ae(!1)}}}function zt(Ve,Rt,_t,Xt){He(Ue=>{var Ht;const Ct=String(Ve),ut=Ef(Ue.sheet,f,i,s)[String(Rt)],Bt=ut?ut.expMax:Gl,Kt=ut?ut.expCount:Us,Jt=(Ht=Ue.sheet.rowsByStudentId)==null?void 0:Ht[Ct],ar=Jt!=null&&Jt.marksByCo&&typeof Jt.marksByCo=="object"?{...Jt.marksByCo}:{},nt=[...Ed(ar[String(Rt)]??Mk(Jt,Rt,Kt,i,s),Kt)];if(Xt===""||Xt==null)nt[_t]="";else{const Pe=Number(Xt);nt[_t]=Number.isFinite(Pe)?Math.max(0,Math.min(Bt,Math.trunc(Pe))):""}return ar[String(Rt)]=nt,{...Ue,sheet:{...Ue.sheet,rowsByStudentId:{...Ue.sheet.rowsByStudentId,[Ct]:{...Jt||{studentId:Ve,marksA:[],marksB:[]},marksByCo:ar}}}}})}function Wt(Ve,Rt){He(_t=>{var et;const Xt=String(Ve),Ue=(et=_t.sheet.rowsByStudentId)==null?void 0:et[Xt];let Ct="";if(Rt===""||Rt==null)Ct="";else{const ut=Number(Rt),Bt=d?Eo:oa(Number(_t.sheet.ciaExamMax??Eo),0,200);Ct=Number.isFinite(ut)?Math.max(0,Math.min(Bt,Math.trunc(ut))):""}return{..._t,sheet:{..._t.sheet,rowsByStudentId:{..._t.sheet.rowsByStudentId,[Xt]:{...Ue||{studentId:Ve,marksA:[],marksB:[]},ciaExam:Ct}}}}})}async function xt(){if(e){j(!0);try{await Ri(r,e,ft),L(new Date().toLocaleString())}catch(Ve){alert((Ve==null?void 0:Ve.message)||"Draft save failed")}finally{j(!1)}}}const Dt=on.useRef(ft);Dt.current=ft,x.useEffect(()=>{const Ve=()=>{!e||te||Ri(r,e,Dt.current).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",Ve),()=>window.removeEventListener("obe:before-tab-switch",Ve)},[e,r,te]);async function Vt(){if(!e||!window.confirm("Reset all lab marks for this sheet? This clears the draft (students + experiments + CIA Exam)."))return;const Rt=oa(Number(ft.sheet.expCountA??Us),0,12),_t=oa(Number(ft.sheet.expCountB??Us),0,12),Xt={};for(const Ct of b)Xt[String(Ct.id)]={studentId:Ct.id,marksA:Array.from({length:Rt},()=>""),marksB:Array.from({length:_t},()=>""),caaExamByCo:{},ciaExam:""};const Ue={sheet:{...ft.sheet,rowsByStudentId:Xt}};He(Ue);try{tt&&Kn(tt,{rowsByStudentId:{}})}catch{}try{await Ri(r,e,Ue),L(new Date().toLocaleString())}catch{}}async function gr(){if(e){if(Kr){alert("Publishing is locked by IQAC.");return}if(!Se){alert("Publish window is closed. Please request IQAC approval.");return}if(yt&&Tt){if(hr){alert("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}se(!0);return}if(!B){T(!0);try{await _3(r,e,ft,t),q(new Date().toLocaleString()),await Lr(!1),Ge(),jt({silent:!0});try{console.debug("obe:published dispatch",{assessment:r,subjectId:e}),window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:r}}))}catch{}}catch(Ve){alert((Ve==null?void 0:Ve.message)||"Publish failed")}finally{T(!1)}}}}async function sr(){if(e){Te(!0),Be(null);try{await _h({assessment:r,subject_code:e,reason:I,teaching_assignment_id:t}),Be("Request sent to IQAC successfully."),Z(""),Ge()}catch(Ve){Be((Ve==null?void 0:Ve.message)||"Failed to send request.")}finally{Te(!1)}}}async function Lr(Ve){if(e){Ve&&X(!0),ne(null);try{const Rt=await po(r,String(e),t),_t=(Rt==null?void 0:Rt.data)??null;_t&&typeof _t=="object"&&J(_t)}catch(Rt){Ve&&ne((Rt==null?void 0:Rt.message)||"Failed to load published marks")}finally{Ve&&X(!1)}}}x.useEffect(()=>{e&&Lr(!1)},[e,r]);const Zr=on.useRef(!!Fr);x.useEffect(()=>{if(!e||!yt)return;if(Zr.current||!Fr){Zr.current=!!Fr;return}let Rt=!0;return(async()=>{try{const _t=await ei(r,String(e),t),Xt=(_t==null?void 0:_t.data)??null;if(!Rt)return;if(Xt&&typeof Xt=="object"&&Xt.sheet){He(Xt);return}}catch{}Rt&&R&&R.sheet&&He(R)})(),Zr.current=!!Fr,()=>{Rt=!1}},[Fr,yt,e,r,R]),x.useEffect(()=>{if(!e||!yt||Fr)return;const Ve=window.setInterval(()=>{jt({silent:!0})},3e4);return()=>window.clearInterval(Ve)},[Fr,yt,e,jt]),x.useEffect(()=>{K&&e&&(J(null),Lr(!0))},[K,e,r]);const Er=3+Math.max(Sn,1)+1+(je?1:0)+Ut+pt.length*2,qt={border:"1px solid #111",padding:"4px 4px",background:"#ecfdf5",color:"#065f46",textAlign:"center",fontWeight:700,fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},zr={border:"1px solid #111",padding:"4px 4px",fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},bn={width:"100%",border:"none",outline:"none",background:"transparent",fontSize:11,textAlign:"center"},or={position:"relative",border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},kr="100%",Tr={display:"flex",width:"100%",maxWidth:1200,margin:"0 auto",gap:10,flexWrap:"wrap",alignItems:"center",marginBottom:8},Or={width:20,height:20,transform:"scale(1.5)",accentColor:"#9a3412"},Gt=Xe?"markManagerGlitch 2s ease-in-out":void 0,ur={position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:40,width:360,background:"#fff",border:"1px solid #e5e7eb",padding:10,borderRadius:12,display:"flex",flexDirection:"column",gap:8,alignItems:"center",boxShadow:"0 6px 18px rgba(17,24,39,0.06)",filter:"none"};return a.jsxs(ag,{children:[a.jsx("style",{children:`
        @keyframes markManagerGlitch {
          0%, 100% { transform: translate(0,0); filter: none; }
          10% { transform: translate(-2px, 1px); }
          20% { transform: translate(2px, -1px); }
          30% { transform: translate(-1px, -2px); }
          40% { transform: translate(1px, 2px); }
          50% { transform: translate(-2px, -1px); }
          60% { transform: translate(2px, 1px); }
          70% { transform: translate(-1px, 1px); }
          80% { transform: translate(1px, -1px); }
          90% { transform: translate(-1px, 0); }
        }
        @keyframes markManagerDust {
          0% { opacity: 0.9; transform: translate(0,0) scale(1); }
          100% { opacity: 0; transform: translate(80px, -40px) scale(0.6); }
        }
        .markManagerDustParticle {
          position: absolute;
          width: 4px;
          height: 4px;
          background: #d1d5db;
          border-radius: 50%;
          animation: markManagerDust 2s ease-out forwards;
        }
      `}),a.jsxs("div",{style:{margin:"0 0 10px 0",maxWidth:"100%",width:"100%",boxSizing:"border-box",overflow:"hidden"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"COs enabled"}),a.jsxs("div",{style:{...Tr,border:"1px solid #fcd34d",background:re?"#f3f4f6":"#fff7ed",padding:12,borderRadius:12,alignItems:"stretch",animation:Gt,position:"relative",overflow:"hidden"},children:[Xe?a.jsx(a.Fragment,{children:Array.from({length:20},(Ve,Rt)=>a.jsx("div",{className:"markManagerDustParticle",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*1}s`}},Rt))}):null,a.jsxs("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",gap:10,flexWrap:"wrap"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[a.jsx(C2,{size:20,color:re?"#6b7280":"#9a3412"}),a.jsx("div",{style:{fontWeight:950,color:"#111827",fontSize:14},children:"Mark Manager"}),re&&a.jsx("span",{style:{fontSize:11,color:"#fff",background:"#dc2626",padding:"2px 8px",borderRadius:6,fontWeight:700},children:"LOCKED"}),!re&&a.jsx("span",{style:{fontSize:11,color:"#fff",background:"#16a34a",padding:"2px 8px",borderRadius:6,fontWeight:700},children:"EDITABLE"})]}),a.jsx("button",{onClick:()=>O({mode:re?"request":"confirm"}),className:"obe-btn obe-btn-success",disabled:!e||W,style:{minWidth:100},children:W?"Saving...":re?"Request Edit":"Save & Lock"})]}),a.jsxs("div",{style:{width:"100%",display:"flex",gap:10,flexWrap:"wrap",marginTop:8},children:[f.map(Ve=>{const Rt=Rn[String(Ve)],_t=re||u&&Ve!==i&&Ve!==s;return a.jsxs("label",{style:{display:"flex",gap:6,alignItems:"center",fontWeight:800,fontSize:12,color:"#111827"},children:[a.jsx("input",{type:"checkbox",checked:(Rt==null?void 0:Rt.enabled)||!1,disabled:_t,onChange:Xt=>ue(Ve,Xt.target.checked),style:Or}),"CO-",Ve]},Ve)}),a.jsxs("label",{style:{display:"flex",gap:6,alignItems:"center",fontWeight:800,fontSize:12,color:"#111827"},children:[a.jsx("input",{type:"checkbox",checked:je,disabled:re,onChange:Ve=>rt(Ve.target.checked),style:Or}),"CIA Exam"]})]}),a.jsxs("div",{style:{width:"100%",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:10,marginTop:8},children:[Pr.map(Ve=>a.jsxs("div",{style:{minWidth:0},children:[a.jsxs("div",{style:{fontSize:11,color:"#6b7280"},children:["No. of experiments (CO-",Ve.coNumber,")"]}),a.jsx("input",{type:"number",className:"obe-input",value:Ve.expCount,onChange:Rt=>ke(Ve.coNumber,Number(Rt.target.value)),min:0,max:12,disabled:re}),a.jsx("div",{style:{fontSize:11,color:"#6b7280",marginTop:6},children:"Max marks (per experiment)"}),a.jsx("input",{type:"number",className:"obe-input",value:Ve.expMax,onChange:Rt=>Ne(Ve.coNumber,Number(Rt.target.value)),min:0,max:100,disabled:re})]},Ve.coNumber)),je?a.jsxs("div",{style:{minWidth:0},children:[a.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:"CIA exam max marks"}),a.jsx("input",{type:"number",className:"obe-input",value:Mt,onChange:Ve=>De(Number(Ve.target.value)),min:0,max:d?Eo:200,disabled:re||d})]}):null]})]}),Ee?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#991b1b"},children:Ee}):null]}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",marginBottom:12},children:[a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:a.jsx("button",{onClick:Vt,className:"obe-btn obe-btn-danger",disabled:!e||!le||te,title:le?te?"Table locked after publish":"Clear all marks":"Save & Lock Mark Manager first to enable table",children:"Reset All"})}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:xt,className:"obe-btn obe-btn-success",disabled:k||!e||!le||te,title:le?te?"Table locked after publish":"Save current draft":"Save & Lock Mark Manager first to enable table",children:k?"Saving":"Save Draft"}),a.jsx("button",{onClick:gr,className:"obe-btn obe-btn-primary",disabled:Tt?hr:!e||E||!le||te||Kr||!Se,title:le?te?"Table locked after publish":Se?Kr?"Publishing locked by IQAC":"Publish marks":"Publish window closed":"Save & Lock Mark Manager first",children:Tt?hr?"Request Pending":"Request Edit":E?"Publishing":"Publish"}),A&&a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Saved: ",A]}),B&&a.jsxs("div",{style:{fontSize:12,color:"#16a34a",alignSelf:"center"},children:["Published: ",B]})]})]}),g&&a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:g}),a.jsx("div",{style:{marginBottom:10,fontSize:12,color:Se?"#065f46":"#b91c1c"},children:ye?"Checking publish due time":ht||(_e!=null&&_e.due_at?a.jsxs(a.Fragment,{children:["Due: ",new Date(_e.due_at).toLocaleString(),"  Remaining: ",ng(he),_e.allowed_by_approval&&_e.approval_until?a.jsxs(a.Fragment,{children:["  Approved until ",new Date(_e.approval_until).toLocaleString()]}):null]}):"Due time not set by IQAC.")}),Kr?a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),a.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:a.jsx("button",{className:"obe-btn",onClick:()=>Ge(),disabled:ye,children:"Refresh"})})]}):Se?null:a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fecaca",background:"#fff7ed",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publish time is over"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:"Send a request to IQAC to approve publishing."}),a.jsx("textarea",{value:I,onChange:Ve=>Z(Ve.target.value),placeholder:"Reason (optional)",rows:3,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:[a.jsx("button",{className:"obe-btn",onClick:()=>Ge(),disabled:me||ye,children:"Refresh"}),a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:sr,disabled:me,children:me?"Requesting":"Request Approval"})]}),Ae?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:Ae}):null]}),p?a.jsx("div",{style:{color:"#6b7280"},children:"Loading roster"}):b.length===0?a.jsx("div",{style:{color:"#6b7280"},children:"Select a Teaching Assignment to load students."}):le?a.jsx("div",{style:or,children:a.jsxs(ig,{locked:Kr,children:[a.jsx("div",{className:"obe-table-wrapper",style:{width:"100%",maxWidth:"100%",overflowX:"scroll",overflowY:"hidden",WebkitOverflowScrolling:"touch",overscrollBehaviorX:"contain",scrollbarGutter:"stable"},children:a.jsxs("table",{className:"obe-table",style:{minWidth:kr,width:"100%",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:qt,colSpan:Er,children:[ft.sheet.termLabel," | ",ft.sheet.batchLabel," | ",n]})}),a.jsxs("tr",{children:[a.jsx("th",{style:qt,rowSpan:5,children:"S.No"}),a.jsx("th",{style:qt,rowSpan:5,children:"Register No."}),a.jsx("th",{style:qt,rowSpan:5,children:"Name of the Students"}),a.jsx("th",{style:qt,colSpan:Math.max(1,Sn),children:"Experiments"}),a.jsx("th",{style:qt,rowSpan:5,children:"Total (Avg)"}),je?a.jsx("th",{style:qt,colSpan:1,children:"CIA EXAM"}):null,a.jsx("th",{style:qt,colSpan:Ut,children:"CO ATTAINMENT"}),pt.length?a.jsx("th",{style:qt,colSpan:pt.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[Sn===0?a.jsx("th",{style:qt,children:""}):a.jsx(a.Fragment,{children:Pr.map(Ve=>Array.from({length:Ve.expCount},(Rt,_t)=>a.jsx("th",{style:qt,children:Ve.coNumber},`co${Ve.coNumber}_${_t}`)))}),je?a.jsx("th",{style:qt,children:""}):null,Pr.map(Ve=>a.jsxs("th",{style:qt,colSpan:2,children:["CO-",Ve.coNumber]},`coatt_hdr_${Ve.coNumber}`)),pt.map(Ve=>a.jsxs("th",{style:qt,colSpan:2,children:["BTL-",Ve]},`btl_${Ve}`))]}),a.jsxs("tr",{children:[Sn===0?a.jsx("th",{style:qt,children:""}):a.jsx(a.Fragment,{children:Pr.map(Ve=>Array.from({length:Ve.expCount},(Rt,_t)=>a.jsx("th",{style:qt,children:Ve.expMax},`max_${Ve.coNumber}_${_t}`)))}),je?a.jsx("th",{style:qt,children:Mt}):null,Pr.map(Ve=>a.jsxs(on.Fragment,{children:[a.jsx("th",{style:qt,children:(Ve.expMax+(je&&Pr.length?Mt/Pr.length:0)).toFixed(0)}),a.jsx("th",{style:qt,children:"%"})]},`comax_${Ve.coNumber}`)),pt.map(Ve=>a.jsxs(on.Fragment,{children:[a.jsx("th",{style:qt,children:ir}),a.jsx("th",{style:qt,children:"%"})]},`btlmax_${Ve}`))]}),a.jsxs("tr",{children:[Sn===0?a.jsx("th",{style:qt,children:"No experiments"}):a.jsx(a.Fragment,{children:Pr.map(Ve=>Array.from({length:Ve.expCount},(Rt,_t)=>a.jsxs("th",{style:qt,children:["E",_t+1]},`e_${Ve.coNumber}_${_t}`)))}),a.jsx("th",{style:qt,colSpan:Ut+pt.length*2+(je?1:0)})]}),a.jsxs("tr",{children:[Sn===0?a.jsx("th",{style:qt,children:""}):a.jsx(a.Fragment,{children:Pr.map(Ve=>Array.from({length:Ve.expCount},(Rt,_t)=>{const Xt=Ve.btl[_t]??1,Ue=!(Tt||Kr);return a.jsx("th",{style:qt,children:Ue?a.jsx("select",{"aria-label":`BTL for CO${Ve.coNumber} E${_t+1}`,value:Xt,onChange:Ct=>vt(Ve.coNumber,_t,Number(Ct.target.value)),style:{width:"100%",minWidth:38,padding:"2px 2px",fontWeight:800,fontSize:11,textAlign:"center",border:"1px solid #d1d5db",borderRadius:4,background:"#fff",cursor:"pointer"},children:[1,2,3,4,5,6].map(Ct=>a.jsx("option",{value:Ct,children:Ct},Ct))}):a.jsx("span",{style:{fontWeight:800},children:Xt})},`btl_${Ve.coNumber}_${_t}`)}))}),a.jsx("th",{style:qt,colSpan:Ut+pt.length*2+(je?1:0)})]})]}),a.jsx("tbody",{children:Tt?a.jsx("tr",{children:a.jsx("td",{colSpan:Er,style:{padding:14,textAlign:"center",color:"#065f46",fontWeight:900},children:"Published  students hidden"})}):a.jsxs(a.Fragment,{children:[b.map((Ve,Rt)=>{var ar;const _t=(ar=ft.sheet.rowsByStudentId)==null?void 0:ar[String(Ve.id)],Xt=_t==null?void 0:_t.ciaExam,Ue=Xt===""||Xt==null?0:Number(Xt),Ct=Xt===""||Xt==null?"":Number.isFinite(Ue)?Ue:"",et=je&&Pr.length?(Number.isFinite(Ue)?Ue:0)/Pr.length:0,ut=Pr.map(nt=>{const Ht=Mk(_t,nt.coNumber,nt.expCount,i,s),Pe=Ht.slice(0,nt.expCount),Ot=nt.btl.slice(0,nt.expCount),mt=qb(Pe),er=mt!=null&&mt>0||je&&Ue>0?Number(mt??0)+et:null,pr=nt.expMax+(je&&Pr.length?Mt/Pr.length:0);return{coNumber:nt.coNumber,marks:Ht,visibleMarks:Pe,btls:Ot,coMark:er,coMax:pr}}),Bt=ut.flatMap(nt=>nt.visibleMarks),Kt=qb(Bt),Jt={};for(const nt of pt){const Ht=[];for(const Pe of ut)for(let Ot=0;Ot<Pe.visibleMarks.length;Ot++)if(Pe.btls[Ot]===nt){const mt=Pe.visibleMarks[Ot];typeof mt=="number"&&Number.isFinite(mt)&&Ht.push(mt)}Jt[nt]=Ht.length?Ht.reduce((Pe,Ot)=>Pe+Ot,0)/Ht.length:null}return a.jsxs("tr",{children:[a.jsx("td",{style:{...zr,width:"30px",minWidth:"30px",fontWeight:700},children:Rt+1}),a.jsx("td",{style:{...zr,width:"70px",minWidth:"70px",fontWeight:600},children:String(Ve.reg_no||"").slice(-8)}),a.jsx("td",{style:{...zr,fontWeight:600,whiteSpace:"nowrap"},children:String(Ve.name||"")}),ut.map(nt=>Array.from({length:nt.visibleMarks.length},(Ht,Pe)=>{const Ot=Pr.find(mt=>mt.coNumber===nt.coNumber);return a.jsx("td",{style:{...zr,padding:"2px"},children:a.jsx("input",{type:"number",value:nt.marks[Pe],onChange:mt=>{const Nt=mt.target.value;if(Nt==="")return mt.currentTarget.setCustomValidity(""),zt(Ve.id,nt.coNumber,Pe,"");const er=Number(Nt);if(Number.isFinite(er)){if(er>Ot.expMax){mt.currentTarget.setCustomValidity(`Max mark is ${Ot.expMax}`),mt.currentTarget.reportValidity(),window.setTimeout(()=>mt.currentTarget.setCustomValidity(""),0);return}mt.currentTarget.setCustomValidity(""),zt(Ve.id,nt.coNumber,Pe,er)}},style:bn,min:0,max:Ot.expMax,disabled:!le||te})},`m${Ve.id}_co${nt.coNumber}_${Pe}`)})),a.jsx("td",{style:{...zr,fontWeight:700,fontSize:"clamp(10px, 0.9vw, 11px)"},children:Kt==null?"":Kt.toFixed(1)}),je?a.jsx("td",{style:{...zr,padding:"2px"},children:a.jsx("input",{type:"number",value:Ct,onChange:nt=>{const Ht=nt.target.value;if(Ht==="")return nt.currentTarget.setCustomValidity(""),Wt(Ve.id,"");const Pe=Number(Ht);if(Number.isFinite(Pe)){if(Pe>Mt){nt.currentTarget.setCustomValidity(`Max mark is ${Mt}`),nt.currentTarget.reportValidity(),window.setTimeout(()=>nt.currentTarget.setCustomValidity(""),0);return}nt.currentTarget.setCustomValidity(""),Wt(Ve.id,Pe)}},style:bn,min:0,max:Mt,disabled:!le||te})}):null,ut.map(nt=>a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...zr,width:"28px",fontSize:"10px",padding:"2px",fontWeight:600,color:"#5f6368"},children:nt.coMark==null?"":nt.coMark.toFixed(1)}),a.jsx("td",{style:{...zr,width:"25px",fontSize:"10px",padding:"2px",fontWeight:600,color:"#5f6368"},children:Hb(nt.coMark,nt.coMax)})]},`coatt_${Ve.id}_${nt.coNumber}`)),pt.map(nt=>{const Ht=Jt[nt]??null;return a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...zr,width:"28px",fontSize:"10px",padding:"2px",fontWeight:600,color:"#5f6368"},children:Ht==null?"":Ht.toFixed(1)}),a.jsx("td",{style:{...zr,width:"25px",fontSize:"10px",padding:"2px",fontWeight:600,color:"#5f6368"},children:Hb(Ht,ir)})]},`btlcell_${Ve.id}_${nt}`)})]},Ve.id)}),b.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:Er,style:{padding:10,color:"#6b7280"},children:"No students."})}):null]})})]})}),Tt?a.jsx("div",{style:{position:"absolute",inset:0,zIndex:30,pointerEvents:"auto",background:"linear-gradient(180deg, rgba(34,197,94,0.28) 0%, rgba(16,185,129,0.36) 100%)"}}):null,re?null:a.jsxs("div",{style:ur,children:[a.jsx("div",{style:{width:100,height:72,display:"grid",placeItems:"center",background:"#fff",borderRadius:8},children:a.jsx("img",{src:"https://media.lordicon.com/icons/wired/flat/94-lock-unlock.gif",alt:"locked",style:{maxWidth:72,maxHeight:72,display:"block"}})}),a.jsxs("div",{style:{textAlign:"center"},children:[a.jsx("div",{style:{fontWeight:800,color:"#111827"},children:"Table Locked"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Confirm the Mark Manager"})]})]}),Tt?a.jsxs("div",{style:ur,children:[a.jsxs("div",{style:{textAlign:"center"},children:[a.jsx("div",{style:{fontWeight:900,color:"#065f46"},children:"Published"}),a.jsx("div",{style:{fontSize:13,color:"#065f46"},children:"Marks are locked. Request IQAC approval to edit."})]}),a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center"},children:[a.jsx("button",{type:"button",className:"obe-btn",onClick:()=>H(!0),children:"View Marks"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-success",disabled:hr,onClick:async()=>{if(hr){alert("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}se(!0)},children:hr?"Request Pending":"Request Edit"})]}),a.jsx("div",{style:{width:170,height:92,display:"grid",placeItems:"center",background:"#fff",borderRadius:10,border:"1px solid rgba(2,6,23,0.08)"},children:a.jsx("img",{src:new URL("/assets/lockong-CpAqbAhU.png",import.meta.url).toString(),alt:"locked",style:{maxWidth:150,maxHeight:80,display:"block"},onError:Ve=>{Ve.currentTarget.onerror=null,Ve.currentTarget.src=Sxe}})})]}):null]})}):a.jsxs("div",{style:{padding:"20px",textAlign:"center",background:"#fff7ed",borderRadius:12,border:"1px solid #fcd34d"},children:[a.jsx("div",{style:{fontSize:14,fontWeight:700,color:"#92400e",marginBottom:8},children:" Mark Manager Configuration Required"}),a.jsx("div",{style:{fontSize:12,color:"#78350f"},children:"Please configure and lock the Mark Manager above to enable the table."})]}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280",display:"flex",gap:18,flexWrap:"wrap"},children:[A?a.jsxs("div",{children:["Draft saved: ",A,P?a.jsxs("span",{style:{marginLeft:8,color:"#374151"},children:["by ",a.jsx("strong",{children:P})]}):null]}):null,B?a.jsxs("div",{children:["Last published: ",B]}):null]}),U?a.jsx(xs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>{G||se(!1)},children:a.jsxs("div",{style:{width:"min(560px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Ve=>Ve.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[String(r).toUpperCase()," LAB"]})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",rn?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{fontSize:13,color:"#374151",marginBottom:10,lineHeight:1.35},children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Subject:"})," ",n]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Code:"})," ",String(e||"")]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Published:"})," ",B||""]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Saved:"})," ",A||""]})]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:de,onChange:Ve=>z(Ve.target.value),placeholder:"Explain why you need to edit (required)",rows:4,className:"obe-input",style:{resize:"vertical"}})]}),Y?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#b91c1c"},children:Y}):null,a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[a.jsx("button",{type:"button",className:"obe-btn",disabled:G,onClick:()=>se(!1),children:"Cancel"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-primary",disabled:G||hr||!e||!String(de||"").trim(),onClick:async()=>{if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}if(hr){alert("Edit request is pending. Please wait.");return}const Rt=String(de||"").trim();if(!Rt){C("Reason is required.");return}ie(!0),C(null);try{const _t=await il({assessment:r,subject_code:String(e),scope:"MARK_ENTRY",reason:Rt,teaching_assignment_id:t});alert(al(_t)),se(!1),z(""),en(Date.now()+24*60*60*1e3);try{$r({silent:!0})}catch{}jt({silent:!0})}catch(_t){const Xt=sl(_t,"Request failed");C(Xt),alert(`Edit request failed: ${Xt}`)}finally{ie(!1)}},children:G?"Requesting":hr?"Request Pending":"Send Request"})]})]})})}):null,oe?a.jsx(xs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:9999},onClick:()=>{W||O(null)},children:a.jsxs("div",{style:{width:"min(760px, 96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Ve=>Ve.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:oe.mode==="confirm"?`Confirmation - ${n}`:`Request Edit - ${n}`}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:String(r).toUpperCase()})]}),oe.mode==="confirm"?a.jsxs(a.Fragment,{children:[a.jsxs("div",{style:{background:"#fffbeb",border:"1px solid #fbbf24",borderRadius:8,padding:12,marginBottom:12},children:[a.jsx("div",{style:{fontWeight:700,color:"#92400e",marginBottom:4},children:" Important"}),a.jsxs("div",{style:{fontSize:12,color:"#78350f",lineHeight:1.5},children:["After confirming, Mark Manager will be ",a.jsx("strong",{children:"locked"}),". You'll need IQAC approval to change CO selection, experiment count, or max marks."]})]}),a.jsx("div",{style:{fontSize:13,color:"#374151",marginBottom:8,fontWeight:600},children:"Review your settings:"}),a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb",fontWeight:700},children:"Item"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb",fontWeight:700},children:"Experiments"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb",fontWeight:700},children:"Max marks"})]})}),a.jsxs("tbody",{children:[Pr.length>0?Pr.map(Ve=>a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:800},children:["CO-",Ve.coNumber]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right",fontWeight:600},children:Ve.expCount}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right",fontWeight:600},children:Ve.expMax})]},Ve.coNumber)):a.jsx("tr",{children:a.jsx("td",{colSpan:3,style:{padding:10,color:"#dc2626",fontWeight:600},children:" No COs selected"})}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:800},children:"CIA Exam"}),a.jsx("td",{colSpan:2,style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right",fontWeight:600},children:je?" Enabled":" Disabled"})]})]})]})})]}):a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. Mark Manager will remain locked until IQAC approves."}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[a.jsx("button",{className:"obe-btn",disabled:W,onClick:()=>O(null),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:W||!e,onClick:async()=>{if(e){if(oe.mode==="request"){O(null),await st();return}ae(!0),ze(null),Pt(!0);try{const Ve=We(ft.sheet),Rt=wt!=null&&wt.approval_until?String(wt.approval_until):ft.sheet.markManagerApprovalUntil||null,_t={...ft,sheet:{...ft.sheet,markManagerLocked:!0,markManagerSnapshot:Ve,markManagerApprovalUntil:Rt}};await Ri(r,String(e),_t),L(new Date().toLocaleString()),await dh(r,String(e),t),await jt({silent:!1}),He(_t),O(null),alert(" Mark Manager saved and locked successfully! You can now proceed with mark entry."),setTimeout(()=>Pt(!1),1500)}catch(Ve){ze((Ve==null?void 0:Ve.message)||"Save failed"),Pt(!1),He(Rt=>({...Rt,sheet:{...Rt.sheet,markManagerLocked:!1}}))}finally{ae(!1)}}},children:W?"Saving...":oe.mode==="confirm"?" Confirm & Lock":" Send Request"})]})]})})}):null,K?a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:70},onClick:()=>H(!1),children:a.jsxs("div",{style:{width:"min(1100px, 96vw)",maxHeight:"min(80vh, 900px)",overflow:"auto",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Ve=>Ve.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Marks"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[String(r).toUpperCase()," LAB"]})]}),V?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading published marks"}):null,Q?a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:Q}):null,(()=>{const Ve=R&&R.sheet?R.sheet:ft.sheet,Rt=Ve.ciaExamEnabled!==!1,_t=d?Eo:oa(Number(Ve.ciaExamMax??Eo),0,200),Xt=Ef(Ve,f,i,s),Ue=f.filter(nt=>{var Ht;return(Ht=Xt[String(nt)])==null?void 0:Ht.enabled}).map(nt=>{const Ht=Xt[String(nt)];return{coNumber:nt,expCount:Ht.expCount,expMax:Ht.expMax,btl:Ht.btl}}),Ct=Ue.reduce((nt,Ht)=>nt+Ht.expCount,0),et=new Set;for(const nt of Ue)for(const Ht of nt.btl.slice(0,nt.expCount))et.add(Ht);const ut=[1,2,3,4,5,6].filter(nt=>et.has(nt)),Bt=Ue.reduce((nt,Ht)=>Math.max(nt,Ht.expMax),Gl),Kt=Ue.length*2,Jt=3+Math.max(Ct,1)+1+Kt+ut.length*2,ar=Math.max(920,360+(Ct+ut.length*2)*80);return a.jsx("div",{className:"obe-table-wrapper",style:{width:"100%",maxWidth:"100%",overflowX:"scroll",overflowY:"hidden",WebkitOverflowScrolling:"touch",overscrollBehaviorX:"contain",scrollbarGutter:"stable",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{className:"obe-table",style:{width:"max-content",minWidth:ar,tableLayout:"auto",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsx("th",{style:qt,colSpan:Jt,children:n})}),a.jsxs("tr",{children:[a.jsx("th",{style:qt,rowSpan:5,children:"S.No"}),a.jsx("th",{style:qt,rowSpan:5,children:"Register No."}),a.jsx("th",{style:qt,rowSpan:5,children:"Name of the Students"}),a.jsx("th",{style:qt,colSpan:Math.max(1,Ct),children:"Experiments"}),a.jsxs("th",{style:qt,rowSpan:5,children:[a.jsx("div",{children:"Total"}),a.jsx("div",{style:{fontSize:11,color:"#6b7280",fontWeight:900},children:Rt?"CIA exam":"Avg"})]}),a.jsx("th",{style:qt,colSpan:Kt,children:"CO ATTAINMENT"}),ut.length?a.jsx("th",{style:qt,colSpan:ut.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[Ct===0?a.jsx("th",{style:qt,children:""}):a.jsx(a.Fragment,{children:Ue.map(nt=>Array.from({length:nt.expCount},(Ht,Pe)=>a.jsx("th",{style:qt,children:nt.coNumber},`v_co${nt.coNumber}_${Pe}`)))}),Ue.map(nt=>a.jsxs("th",{style:qt,colSpan:2,children:["CO-",nt.coNumber]},`v_coatt_hdr_${nt.coNumber}`)),ut.map(nt=>a.jsxs("th",{style:qt,colSpan:2,children:["BTL-",nt]},`v_btl_${nt}`))]}),a.jsxs("tr",{children:[Ct===0?a.jsx("th",{style:qt,children:""}):a.jsx(a.Fragment,{children:Ue.map(nt=>Array.from({length:nt.expCount},(Ht,Pe)=>a.jsx("th",{style:qt,children:nt.expMax},`v_max_${nt.coNumber}_${Pe}`)))}),Ue.map(nt=>a.jsxs(on.Fragment,{children:[a.jsx("th",{style:qt,children:(nt.expMax+(Rt&&Ue.length?_t/Ue.length:0)).toFixed(0)}),a.jsx("th",{style:qt,children:"%"})]},`v_comax_${nt.coNumber}`)),ut.map(nt=>a.jsxs(on.Fragment,{children:[a.jsx("th",{style:qt,children:Bt}),a.jsx("th",{style:qt,children:"%"})]},`v_btlmax_${nt}`))]}),a.jsxs("tr",{children:[Ct===0?a.jsx("th",{style:qt,children:"No experiments"}):a.jsx(a.Fragment,{children:Ue.map(nt=>Array.from({length:nt.expCount},(Ht,Pe)=>a.jsxs("th",{style:qt,children:["E",Pe+1]},`v_e_${nt.coNumber}_${Pe}`)))}),a.jsx("th",{style:qt,colSpan:Kt+ut.length*2})]}),a.jsxs("tr",{children:[Ct===0?a.jsx("th",{style:qt,children:"BTL"}):a.jsx(a.Fragment,{children:Ue.map(nt=>Array.from({length:nt.expCount},(Ht,Pe)=>a.jsx("th",{style:qt,children:nt.btl[Pe]??1},`v_btl_${nt.coNumber}_${Pe}`)))}),a.jsx("th",{style:qt,colSpan:Kt+ut.length*2})]})]}),a.jsxs("tbody",{children:[b.map((nt,Ht)=>{var Ze;const Pe=(Ze=Ve==null?void 0:Ve.rowsByStudentId)==null?void 0:Ze[String(nt.id)],Ot=Pe==null?void 0:Pe.ciaExam,mt=Ot===""||Ot==null?0:Number(Ot),Nt=Rt&&Ue.length?(Number.isFinite(mt)?mt:0)/Ue.length:0,er=Ue.map(bt=>{const St=Mk(Pe,bt.coNumber,bt.expCount,i,s),Sr=St.slice(0,bt.expCount),Yr=bt.btl.slice(0,bt.expCount),ct=qb(Sr),qe=ct!=null&&ct>0||Rt&&mt>0?Number(ct??0)+Nt:null,Ye=bt.expMax+(Rt&&Ue.length?_t/Ue.length:0);return{coNumber:bt.coNumber,marks:St,visibleMarks:Sr,btls:Yr,coMark:qe,coMax:Ye}}),pr=er.flatMap(bt=>bt.visibleMarks),we=qb(pr),Ie={};for(const bt of ut){const St=[];for(const Sr of er)for(let Yr=0;Yr<Sr.visibleMarks.length;Yr++)if(Sr.btls[Yr]===bt){const ct=Sr.visibleMarks[Yr];typeof ct=="number"&&Number.isFinite(ct)&&St.push(ct)}Ie[bt]=St.length?St.reduce((Sr,Yr)=>Sr+Yr,0)/St.length:null}return a.jsxs("tr",{children:[a.jsx("td",{style:{...zr,textAlign:"center",width:42,minWidth:42},children:Ht+1}),a.jsx("td",{style:zr,children:String(nt.reg_no||"")}),a.jsx("td",{style:zr,children:String(nt.name||"")}),Ct===0?a.jsx("td",{style:{...zr,textAlign:"center",color:"#6b7280"},children:""}):a.jsx(a.Fragment,{children:er.map(bt=>bt.visibleMarks.map((St,Sr)=>a.jsx("td",{style:{...zr,width:78,minWidth:78,background:"#fff7ed",textAlign:"center",fontWeight:800},children:St??""},`v_m_${nt.id}_co${bt.coNumber}_${Sr}`)))}),a.jsx("td",{style:{...zr,textAlign:Rt?"center":"right",fontWeight:800,background:Rt?"#fff7ed":void 0},children:Rt?Number.isFinite(mt)?mt:"":we==null?"":we.toFixed(1)}),er.map(bt=>a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...zr,textAlign:"right"},children:bt.coMark==null?"":bt.coMark.toFixed(1)}),a.jsx("td",{style:{...zr,textAlign:"right"},children:Hb(bt.coMark,bt.coMax)})]},`v_coatt_${nt.id}_${bt.coNumber}`)),ut.map(bt=>{const St=Ie[bt]??null;return a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...zr,textAlign:"right"},children:St==null?"":St.toFixed(1)}),a.jsx("td",{style:{...zr,textAlign:"right"},children:Hb(St,Bt)})]},`v_btl_${nt.id}_${bt}`)})]},`v_${nt.id}`)}),b.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:Jt,style:{padding:10,color:"#6b7280"},children:"No students."})}):null]})]})})})(),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{type:"button",className:"obe-btn",onClick:()=>H(!1),children:"Close"})})]})}):null]})}new URL("https://static.vecteezy.com/system/resources/thumbnails/014/585/778/small/gold-locked-padlock-png.png",import.meta.url).href;const CM={co1:42,co2:42,co3:58,co4:42,co5:42},Cxe={1:9,2:9,3:4.5},Exe={1:3,2:3,3:1.5},wp={1:20,2:20,3:10},Lk={1:12,2:12,3:6},Rk={1:9,2:9,3:4.5,4:9,5:9},_d={1:0,2:0,3:0,4:20,5:20},Mi=5,na=25,Mh=30;function Hr(e,t,r){return Number.isFinite(e)?Math.max(t,Math.min(r,Math.trunc(e))):t}function Vb(e,t,r){return Number.isFinite(e)?Math.max(t,Math.min(r,e)):t}function Lh(e){return Math.round(e*10)/10}function Txe(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const o=r.localeCompare(n);if(o)return o}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim();return i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}function Ns(e,t){const r=Array.isArray(e)?e:[],n=[];for(let i=0;i<t;i++){const s=r[i];if(s===""||s==null){n.push("");continue}const o=typeof s=="number"?s:Number(s);n.push(Number.isFinite(o)?o:"")}return n}function Fu(e,t,r=1){const n=Array.isArray(e)?e:[],i=[];for(let s=0;s<t;s++){const o=n[s];if(o===""||o==null){i.push(r);continue}const l=typeof o=="number"?o:Number(o);i.push(Number.isFinite(l)&&l>=1&&l<=6?Math.trunc(l):r)}return i}function Gb(e){const t=e.filter(r=>typeof r=="number"&&Number.isFinite(r));return t.length?t.reduce((r,n)=>r+n,0)/t.length:null}function Kb(e,t){if(e==null)return"";if(!Number.isFinite(t)||t<=0)return"0";const r=e/t*100;return`${Number.isFinite(r)?r.toFixed(0):0}`}function EM(e){return e.reduce((t,r)=>t+(typeof r=="number"&&Number.isFinite(r)?r:0),0)}function Yb(e){const t=e&&typeof e=="object"?e:{},r={};for(const n of Object.keys(t)){const i=t[n];if(i===""||i==null){r[n]="";continue}const s=typeof i=="number"?i:Number(i);r[n]=Number.isFinite(s)?s:""}return r}function Fk(e){const t=e&&typeof e=="object"?e:{},r={};for(const n of Object.keys(t)){const i=t[n];if(i===""||i==null){r[n]="";continue}const s=typeof i=="number"?i:Number(i);r[n]=Number.isFinite(s)?s:""}return r}function Bk(e,t,r){return!Number.isFinite(e)||!Number.isFinite(t)||!Number.isFinite(r)||t<=0||r<=0?0:Math.max(0,e)/t*r}function Pxe(e,t,r){const n=Number(r[t]??0);if(n<=0)return 0;const i=e[String(t)];return typeof i!="number"||!Number.isFinite(i)?0:Math.max(0,Math.min(i,n))}function TM(e,t=7){const r=String(e??"").trim();return r?r.length<=t?r:r.slice(-t):""}function Oxe(e,t){return`${e}_sheet_${t}`}function Bx({subjectId:e,teachingAssignmentId:t,assessmentKey:r,label:n,coA:i,coB:s,skipMarkManager:o=!1,initialEnabledCos:l,itemLabel:c,itemLabelPlural:u,itemAbbrev:d,ciaExamAvailable:f,absentEnabled:h,autoSaveDraft:p,autoSaveDelayMs:m,viewerMode:g,floatPanelOnTable:y}){const[b,v]=x.useState([]),[w,S]=x.useState(!1),[k,j]=x.useState(null),[A,L]=x.useState(null),[P,F]=x.useState(!1),[E,T]=x.useState(null),[B,q]=x.useState(null),[U,se]=x.useState(!1),[de,z]=x.useState(null),[G,ie]=x.useState(!1),[Y,C]=x.useState(!1),[K,H]=x.useState(""),[R,J]=x.useState(!1),[V,X]=x.useState(""),[Q,ne]=x.useState(!1),[oe,O]=x.useState(null),[W,ae]=x.useState(null),[I,Z]=x.useState(!1),[me,Te]=x.useState(null),[Ae,Be]=x.useState(!1),[Ee,ze]=x.useState(null),[Xe,Pt]=x.useState(!1),[ft,He]=x.useState(null),[tt,_e]=x.useState(!1),[Se,he]=x.useState(null),[ye,ht]=x.useState(null),Ge=String(c||"Experiment"),lt=String(u||"Experiments"),jt=String(d||"E"),wt=f!==!1,yt=!!(h??r==="model"),Fr=!!p,Tt=Hr(Number(m??900),250,5e3),hr=x.useMemo(()=>{const xe=(Array.isArray(l)&&l.length?l:[i,s].filter(Ke=>typeof Ke=="number"&&Number.isFinite(Ke))).map(Ke=>Hr(Number(Ke),1,5));return Array.from(new Set(xe)).sort((Ke,Fe)=>Ke-Fe)},[i,s,l]),rn=x.useMemo(()=>new Set(hr.map(fe=>String(fe))),[hr]),en=x.useRef(null),$r=x.useRef(null),Kr=x.useMemo(()=>e?Oxe(r,String(e)):"",[r,e]),{data:Rn,publishAllowed:Pr,remainingSeconds:Sn,refresh:Me}=V0({assessment:r,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:je,refresh:Mt}=G0({assessment:r,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:pt}=oc({assessment:r,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!0}}),{data:Ut,refresh:ir}=oc({assessment:r,subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:t,options:{poll:!0}}),[fr,vr]=x.useState(null),re=!!de||!!(je!=null&&je.exists&&(je!=null&&je.is_published)),le=je!=null&&je.mark_entry_unblocked_until?String(je.mark_entry_unblocked_until):null,te=je!=null&&je.mark_manager_unlocked_until?String(je.mark_manager_unlocked_until):null,ue=!!le&&!!(je!=null&&je.entry_open)&&(fr==null||le!==(fr.markEntryUnblockedUntil??null)),Ne=!!te&&(fr==null||te!==(fr.markManagerUnlockedUntil??null)),ke=re?!!(je!=null&&je.entry_open)&&(fr==null||ue||Ne):!0,vt=!!(re&&!ke),rt=!!(re&&vt&&!g),{pending:De,pendingUntilMs:We,setPendingUntilMs:st,refresh:zt}=K0({enabled:!!rt&&!!e,assessment:r,subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:t});Y0(!!Ee||G||Y||Se&&Se.visible||ye&&ye.visible);const Wt=!!(Rn!=null&&Rn.global_override_active&&(Rn==null?void 0:Rn.global_is_open)===!1),[xt,Dt]=x.useState(()=>({sheet:{termLabel:"KRCT AY25-26",batchLabel:String(e||""),coANum:Hr(Number(i??1),1,5),coBNum:s==null?null:Hr(Number(s),1,5),coAEnabled:!0,coBEnabled:!!s,ciaExamEnabled:!!wt,ciaExamMax:Mh,expCountA:Mi,expCountB:s?Mi:0,expMaxA:na,expMaxB:s?na:0,btlA:Array.from({length:Mi},()=>1),btlB:s?Array.from({length:Mi},()=>1):[],coConfigs:Object.fromEntries((Array.isArray(l)&&l.length?l:[i,s].filter(fe=>typeof fe=="number"&&Number.isFinite(fe))).map(fe=>Hr(Number(fe),1,5)).filter((fe,xe,Ke)=>Ke.indexOf(fe)===xe).map(fe=>[String(fe),{enabled:!0,expCount:Mi,expMax:na,btl:Array.from({length:Mi},()=>1)}])),rowsByStudentId:{},markManagerLocked:!1,markManagerSnapshot:null}}));x.useEffect(()=>{if(!hr.length||xt.sheet.markManagerSnapshot)return;const fe=xt.sheet.coConfigs&&typeof xt.sheet.coConfigs=="object"?xt.sheet.coConfigs:{},xe=hr.filter(Ke=>!fe[String(Ke)]);xe.length&&Dt(Ke=>{const gt={...Ke.sheet.coConfigs&&typeof Ke.sheet.coConfigs=="object"?Ke.sheet.coConfigs:{}};for(const dr of xe)gt[String(dr)]={enabled:!0,expCount:Mi,expMax:na,btl:Array.from({length:Mi},()=>1)};return{...Ke,sheet:{...Ke.sheet,coConfigs:gt}}})},[xt.sheet.coConfigs,xt.sheet.markManagerSnapshot,hr]);const[Vt,gr]=x.useState(null),sr=x.useMemo(()=>ti(Vt),[Vt]),Lr=x.useMemo(()=>A3(Vt),[Vt]),Zr=sr==="TCPR",Er=x.useMemo(()=>sr==="LAB"||sr==="TCPL"||sr==="TCPR"||sr==="PRACTICAL"||sr==="PROJECT",[sr]),qt=sr==="LAB",zr=Er&&!qt&&!Zr;x.useEffect(()=>{let fe=!0;return(async()=>{try{const xe=await ku();if(!fe)return;Dt(Ke=>({...Ke,sheet:{...Ke.sheet,termLabel:String((xe==null?void 0:xe.termLabel)||Ke.sheet.termLabel||"KRCT AY25-26"),batchLabel:String(e||Ke.sheet.batchLabel||"")}}))}catch{}})(),()=>{fe=!1}},[e]),x.useEffect(()=>{let fe=!0;return(async()=>{if(e)try{const xe=String(e).trim().toUpperCase(),Ke=await Sl();if(!fe)return;const Fe=(Ke||[]).find(Ft=>String(Ft.course_code||"").trim().toUpperCase()===xe);if(Fe&&(Fe!=null&&Fe.class_type)){gr((Fe==null?void 0:Fe.class_type)??null);return}const gt=await Kd();if(!fe)return;const dr=(gt||[]).find(Ft=>String(Ft.course_code||"").trim().toUpperCase()===xe);gr((dr==null?void 0:dr.class_type)??null)}catch{fe&&gr(null)}})(),()=>{fe=!1}},[e]),x.useEffect(()=>{let fe=!0;return(async()=>{var xe,Ke;if(e)try{const Fe=await ei(r,String(e));if(!fe)return;const gt=Fe==null?void 0:Fe.draft;if(gt&&typeof gt=="object"&&gt.sheet&&typeof gt.sheet=="object"){const dr=Hr(Number(i??1),1,5),Ft=s==null?null:Hr(Number(s),1,5),jr=dr,Ar=Ft,qr=!!(gt.sheet.coAEnabled??!0),Qr=!!(gt.sheet.coBEnabled??!!Ar),Ur=wt?!!(gt.sheet.ciaExamEnabled??!0):!1,Xr=Hr(Number(gt.sheet.ciaExamMax??Mh),0,100),br=Hr(Number(gt.sheet.expCountA??Mi),0,12),Mr=Hr(Number(gt.sheet.expCountB??(Qr?Mi:0)),0,12),un=Number.isFinite(Number(gt.sheet.expMaxA))?Number(gt.sheet.expMaxA):na,kn=Number.isFinite(Number(gt.sheet.expMaxB))?Number(gt.sheet.expMaxB):Qr?na:0,vn=Fu(gt.sheet.btlA,br,1),Cn=Fu(gt.sheet.btlB,Mr,1),In=gt.sheet.coConfigs,Fn={};if(In&&typeof In=="object")for(const Di of Object.keys(In)){const ba=In[Di]||{},cs=Hr(Number(ba.expCount??Mi),0,12);Fn[Di]={enabled:!!ba.enabled,expCount:cs,expMax:Number.isFinite(Number(ba.expMax))?Number(ba.expMax):na,btl:Fu(ba.btl,cs,1)}}const ci=String(jr);if(Fn[ci]||(Fn[ci]={enabled:qr,expCount:br,expMax:un,btl:vn}),Ar!=null){const Di=String(Ar);Fn[Di]||(Fn[Di]={enabled:Qr,expCount:Mr,expMax:kn,btl:Cn})}const xi=!!(((xe=Fn[String(jr)])==null?void 0:xe.enabled)??qr),Fi=!!(Ar!=null&&(((Ke=Fn[String(Ar)])==null?void 0:Ke.enabled)??Qr)),Ho=Di=>{const ba=Di&&typeof Di=="object"?Di:{},cs={};for(const[Yc,Xc]of Object.entries(ba)){const qn=Xc&&typeof Xc=="object"?Xc:{},_i=qn!=null&&qn.marksByCo&&typeof qn.marksByCo=="object"?{...qn.marksByCo}:{},ea=qn==null?void 0:qn.ciaExam,bo=ea===""||ea==null?"":Number.isFinite(Number(ea))?Vb(Number(ea),0,Xr):"",Qc=Ns(qn==null?void 0:qn.marksA,br),pc=Ns(qn==null?void 0:qn.marksB,Mr),Jc=Ns(_i[ci],br),mc=Ar!=null?Ns(_i[String(Ar)],Mr):[],vo=gc=>gc.some(pl=>pl!==""&&pl!=null),fl=vo(Qc)?Qc:vo(Jc)?Jc:Qc,hl=Mr?vo(pc)?pc:vo(mc)?mc:pc:pc;_i[ci]=Jc,Ar!=null&&(_i[String(Ar)]=mc),cs[String(Yc)]={...qn,studentId:Number.isFinite(Number(qn==null?void 0:qn.studentId))?Number(qn.studentId):Number(Yc),marksA:fl,marksB:hl,marksByCo:_i,ciaExam:bo,caaExamByCo:Yb(qn==null?void 0:qn.caaExamByCo),ciaExamByCo:Fk(qn==null?void 0:qn.ciaExamByCo)}}return cs},Vo=gt.sheet.markManagerSnapshot??null,Rl=gt.sheet.markManagerApprovalUntil??null,Zs=gt.sheet.markManagerLocked,Fl=typeof Zs=="boolean"?Zs:!!Vo;Dt({sheet:{termLabel:String(gt.sheet.termLabel||"KRCT AY25-26"),batchLabel:String(e),coANum:jr,coBNum:Ar,coAEnabled:xi,coBEnabled:Fi,ciaExamEnabled:Ur,ciaExamMax:Xr,expCountA:br,expCountB:Mr,expMaxA:un,expMaxB:kn,btlA:vn,btlB:Cn,coConfigs:Fn,rowsByStudentId:Ho(gt.sheet.rowsByStudentId),markManagerLocked:Fl,markManagerSnapshot:Vo,markManagerApprovalUntil:Rl}});const Ya=(Fe==null?void 0:Fe.updated_at)??null,Zi=(Fe==null?void 0:Fe.updated_by)??null;if(Ya)try{T(new Date(String(Ya)).toLocaleString())}catch{T(String(Ya))}Zi&&q(String(Zi.name||Zi.username||Zi.id||""));try{Kr&&Kn(Kr,{rowsByStudentId:gt.sheet.rowsByStudentId||{}})}catch{}}else{const dr=Kr?Jn(Kr):null,Ft=dr!=null&&dr.rowsByStudentId&&typeof dr.rowsByStudentId=="object"?dr.rowsByStudentId:{},jr=Hr(Number(i??1),1,5),Ar=s==null?null:Hr(Number(s),1,5),qr=Mi,Qr=Ar!=null?Mi:0,Ur=na,Xr=Ar!=null?na:0,br=Array.from({length:qr},()=>1),Mr=Ar!=null?Array.from({length:Qr},()=>1):[],un={[String(jr)]:{enabled:!0,expCount:qr,expMax:Ur,btl:br},...Ar==null?{}:{[String(Ar)]:{enabled:!0,expCount:Qr,expMax:Xr,btl:Mr}}};Dt({sheet:{termLabel:"KRCT AY25-26",batchLabel:String(e||""),coANum:jr,coBNum:Ar,coAEnabled:!0,coBEnabled:!!Ar,ciaExamEnabled:!!wt,ciaExamMax:Mh,expCountA:qr,expCountB:Qr,expMaxA:Ur,expMaxB:Xr,btlA:br,btlB:Mr,coConfigs:un,rowsByStudentId:Ft,markManagerLocked:!1,markManagerSnapshot:null}})}}catch{}})(),()=>{fe=!1}},[r,e,Kr,i,s]),x.useEffect(()=>{let fe=!0;return(async()=>{var xe,Ke,Fe;if(!t){v([]);return}S(!0),j(null);try{let gt=null;try{const Ft=await xr(`/api/academics/teaching-assignments/${t}/`);if(Ft.ok){const jr=await Ft.json();if(jr&&jr.elective_subject_id&&!jr.section_id){const Ar=await xr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(jr.elective_subject_id))}`);if(Ar.ok){const qr=await Ar.json();gt=(Array.isArray(qr.results)?qr.results:Array.isArray(qr)?qr:qr.items||[]).map(Ur=>({id:Number(Ur.student_id??Ur.id),reg_no:String(Ur.reg_no??Ur.regno??""),name:String(Ur.name??Ur.full_name??Ur.username??""),section:Ur.section_name??Ur.section??null}))}}}}catch{}if(!gt){const Ft=await Vc(t);L({courseName:String(((xe=Ft==null?void 0:Ft.teaching_assignment)==null?void 0:xe.subject_name)||""),courseCode:String(((Ke=Ft==null?void 0:Ft.teaching_assignment)==null?void 0:Ke.subject_code)||e||""),className:String(((Fe=Ft==null?void 0:Ft.teaching_assignment)==null?void 0:Fe.section_name)||"")}),gt=((Ft==null?void 0:Ft.students)||[]).map(Ar=>({id:Number(Ar.id),reg_no:String(Ar.reg_no??""),name:String(Ar.name??""),section:Ar.section??null}))}if(!fe)return;const dr=(gt||[]).filter(Ft=>Number.isFinite(Ft.id)).sort(Txe);v(dr),Dt(Ft=>{const jr=Hr(Number(Ft.sheet.expCountA??Mi),0,12),Ar=Hr(Number(Ft.sheet.expCountB??0),0,12),qr={...Ft.sheet.rowsByStudentId||{}};for(const Qr of dr){const Ur=String(Qr.id);qr[Ur]||(qr[Ur]={studentId:Qr.id,absent:!1,absentKind:void 0,marksA:Array.from({length:jr},()=>""),marksB:Array.from({length:Ar},()=>""),marksByCo:{},caaExamByCo:{},ciaExamByCo:{},ciaExam:""})}return{...Ft,sheet:{...Ft.sheet,rowsByStudentId:qr}}})}catch(gt){if(!fe)return;v([]),j((gt==null?void 0:gt.message)||"Failed to load roster")}finally{fe&&S(!1)}})(),()=>{fe=!1}},[t]),x.useEffect(()=>{if(Kr)try{Kn(Kr,{rowsByStudentId:xt.sheet.rowsByStudentId})}catch{}},[xt.sheet.rowsByStudentId,Kr]),x.useEffect(()=>{if(!e||!!!xt.sheet.markManagerSnapshot)return;if(re&&(je!=null&&je.exists)){const Fe=!!(je!=null&&je.mark_manager_locked);!!xt.sheet.markManagerLocked!==Fe&&Dt(gt=>({...gt,sheet:{...gt.sheet,markManagerLocked:Fe}}));return}const xe=!!(pt!=null&&pt.allowed_by_approval),Ke=pt!=null&&pt.approval_until?String(pt.approval_until):null;if(xe&&Ke){const Fe=xt.sheet.markManagerApprovalUntil?String(xt.sheet.markManagerApprovalUntil):null;xt.sheet.markManagerLocked&&Fe!==Ke&&Dt(gt=>({...gt,sheet:{...gt.sheet,markManagerLocked:!1,markManagerApprovalUntil:Ke}}));return}xt.sheet.markManagerLocked||Dt(Fe=>({...Fe,sheet:{...Fe.sheet,markManagerLocked:!0}}))},[e,re,je==null?void 0:je.exists,je==null?void 0:je.mark_manager_locked,pt==null?void 0:pt.allowed_by_approval,pt==null?void 0:pt.approval_until,xt.sheet.markManagerLocked,xt.sheet.markManagerSnapshot,xt.sheet.markManagerApprovalUntil]);const bn=Hr(Number(xt.sheet.coANum??i??1),1,5),or=xt.sheet.coBNum??s??null,kr=or==null?null:Hr(Number(or),1,5),Tr=x.useMemo(()=>[1,2,3,4,5],[]),Or=x.useMemo(()=>new Set(Tr.map(fe=>String(fe))),[Tr]);Hr(Number(xt.sheet.expCountA??Mi),0,12),Hr(Number(xt.sheet.expCountB??0),0,12),xt.sheet.coAEnabled,xt.sheet.coBEnabled&&kr!=null;const Gt=x.useMemo(()=>Ot(xt.sheet),[xt.sheet]),ur=!!xt.sheet.markManagerLocked,Ve=wt?xt.sheet.ciaExamEnabled!==!1:!1,Rt=x.useMemo(()=>Zr?Hr(Number(xt.sheet.ciaExamMax??Mh),0,100):Mh,[Zr,xt.sheet.ciaExamMax]);x.useMemo(()=>mt(Gt,Ve),[Gt,Ve]);const _t=!ke,Xt=x.useMemo(()=>Object.entries(Gt||{}).filter(([fe,xe])=>Or.has(String(fe))&&!!(xe&&xe.enabled)).map(([fe,xe])=>({coNumber:Number(fe),expCount:Hr(Number(xe.expCount??0),0,12),expMax:Hr(Number(xe.expMax??0),0,100),btl:xe.btl??[]})),[Gt,Or]),Ue=x.useMemo(()=>Xt.reduce((fe,xe)=>fe+xe.expCount,0),[Xt]),Ct=Math.max(Ue,1),et=Xt.length>0,ut=x.useMemo(()=>Xt.filter(fe=>Number.isFinite(Number(wp[fe.coNumber]))),[Xt]),Bt=ut.length,Kt=x.useMemo(()=>qt&&Ve?Xt.filter(fe=>Number(_d[fe.coNumber]||0)>0):[],[Xt,qt,Ve]),Jt=qt?Ve?Kt.length:0:Ve?zr?Math.max(Bt,1):1:0,ar=et?Xt.length*2:2,nt=x.useMemo(()=>Xt.reduce((fe,xe)=>Math.max(fe,xe.expMax),0),[Xt]);x.useMemo(()=>{if(!yt)return!1;const fe=xt.sheet.rowsByStudentId||{};return Object.values(fe).some(xe=>!!(xe!=null&&xe.absent))},[yt,xt.sheet.rowsByStudentId]);function Ht(fe,xe){const Ke=fe==null?void 0:fe.marksByCo;return xe.map(Fe=>{const gt=Ke&&typeof Ke=="object"?Ke[String(Fe.coNumber)]:void 0,dr=Fe.coNumber===bn?fe==null?void 0:fe.marksA:Fe.coNumber===kr?fe==null?void 0:fe.marksB:void 0,Ft=Ns(gt??dr,Fe.expCount);return{coNumber:Fe.coNumber,expCount:Fe.expCount,expMax:Fe.expMax,marks:Ft}})}function Pe(fe,xe){const Ke=Yb(fe==null?void 0:fe.caaExamByCo),Fe=Fk(fe==null?void 0:fe.ciaExamByCo),gt=Ve&&typeof(fe==null?void 0:fe.ciaExam)=="number"&&Number.isFinite(fe==null?void 0:fe.ciaExam)?Number(fe==null?void 0:fe.ciaExam):null;if(qt){const qr=xe.map(Xr=>{const br=EM(Xr.marks),Mr=Math.max(0,Xr.expCount)*Math.max(0,Xr.expMax),un=Number(Rk[Xr.coNumber]||0),kn=Ve?Pxe(Fe,Xr.coNumber,_d):0,vn=Bk(br,Mr,un),In=br>0||kn>0?Lh(vn+kn):null,Fn=Lh(un+(Ve?Number(_d[Xr.coNumber]||0):0));return{coNumber:Xr.coNumber,mark:In,coMax:Fn}}),Qr=qr.reduce((Xr,br)=>Xr+(typeof br.mark=="number"&&Number.isFinite(br.mark)?br.mark:0),0),Ur=qr.some(Xr=>typeof Xr.mark=="number"&&Number.isFinite(Xr.mark));return{caaByCo:Ke,ciaByCo:Fe,ciaExamNumLegacy:gt,coAttainmentValues:qr,hasAnyMarks:Ur,finalTotal:Ur?Lh(Qr):""}}if(zr){let qr=0,Qr=!1;const Ur=xe.map(Xr=>{const br=EM(Xr.marks),Mr=Math.max(0,Xr.expCount)*Math.max(0,Xr.expMax),un=Number(Cxe[Xr.coNumber]||0),kn=Number(Exe[Xr.coNumber]||0),vn=Number(wp[Xr.coNumber]||0),Cn=Number(Lk[Xr.coNumber]||0),In=Bk(br,Mr,un),Fn=Ke[String(Xr.coNumber)],ci=typeof Fn=="number"&&Number.isFinite(Fn)?Fn:0,xi=Bk(ci,vn,kn),Fi=In+xi;return(br>0||ci>0)&&(Qr=!0),qr+=Fi,{coNumber:Xr.coNumber,mark:Qr?Fi:null,coMax:Cn}});return{caaByCo:Ke,ciaByCo:Fe,ciaExamNumLegacy:gt,coAttainmentValues:Ur.map(Xr=>({...Xr,mark:Qr?Xr.mark:null})),hasAnyMarks:Qr,finalTotal:Qr?Lh(qr):""}}const dr=xe.flatMap(qr=>qr.marks),Ft=Gb(dr),jr=Ft!=null||Ve&&gt!=null,Ar=xe.map(qr=>{const Qr=Gb(qr.marks),Ur=jr?(Qr??0)+(Ve?(gt??0)/2:0):null,Xr=CM[`co${qr.coNumber}`],br=Array.from({length:Hr(Number(qr.expCount??0),0,12)}).map(()=>Hr(Number(qr.expMax??na),0,100)),Mr=br.length?br.reduce((vn,Cn)=>vn+Cn,0)/br.length:0,un=Lr&&Number.isFinite(Number(Xr))?Number(Xr):Mr,kn=Zr?12:Math.round(un+(Ve?Rt/2:0)||0);return{coNumber:qr.coNumber,mark:Ur,coMax:kn}});return{caaByCo:Ke,ciaByCo:Fe,ciaExamNumLegacy:gt,coAttainmentValues:Ar,hasAnyMarks:jr,finalTotal:Ft==null&&gt==null?"":Lh((Ft??0)+(gt??0))}}x.useMemo(()=>!g&&re&&!ke?[]:!yt||!Ae?b:b.filter(fe=>{var xe,Ke;return!!((Ke=(xe=xt.sheet.rowsByStudentId)==null?void 0:xe[String(fe.id)])!=null&&Ke.absent)}),[g,re,ke,yt,b,Ae,xt.sheet.rowsByStudentId]),x.useEffect(()=>{if(!Fr||!e||_t||vt)return;$r.current!=null&&(window.clearTimeout($r.current),$r.current=null);const fe=JSON.stringify(xt);if(fe!==en.current)return $r.current=window.setTimeout(async()=>{if(e)try{F(!0),await Ri(r,String(e),xt),en.current=fe,T(new Date().toLocaleString())}catch{}finally{F(!1)}},Tt),()=>{$r.current!=null&&(window.clearTimeout($r.current),$r.current=null)}},[Fr,Tt,r,xt,vt,e,_t]);function Ot(fe){const Ke={...fe.coConfigs&&typeof fe.coConfigs=="object"?fe.coConfigs:{}};for(const Fe of[1,2,3,4,5]){const gt=String(Fe),dr=Ke[gt];if(!dr)Ke[gt]={enabled:rn.has(gt),expCount:Mi,expMax:na,btl:Array.from({length:Mi},()=>1)};else{const Ft=Hr(Number(dr.expCount??Mi),0,12);Ke[gt]={enabled:!!dr.enabled,expCount:Ft,expMax:Hr(Number(dr.expMax??na),0,100),btl:Fu(dr.btl,Ft,1)}}}return Ke}function mt(fe,xe){const Ke=Object.entries(fe).filter(([Fe,gt])=>Or.has(String(Fe))&&!!(gt!=null&&gt.enabled)).map(([Fe,gt])=>({co:Hr(Number(Fe),1,5),expCount:Hr(Number((gt==null?void 0:gt.expCount)??0),0,12),expMax:Hr(Number((gt==null?void 0:gt.expMax)??0),0,100)})).sort((Fe,gt)=>Fe.co-gt.co);return JSON.stringify({enabled:Ke,ciaExamEnabled:!!xe})}function Nt(fe){if(!fe)return null;try{const xe=JSON.parse(String(fe)),Ke=Array.isArray(xe==null?void 0:xe.enabled)?xe.enabled:[],Fe={};for(const gt of[1,2,3,4,5])Fe[String(gt)]={enabled:!1,expCount:Mi,expMax:na,btl:Array.from({length:Mi},()=>1)};for(const gt of Ke){const dr=Hr(Number(gt==null?void 0:gt.co),1,5);Fe[String(dr)]={...Fe[String(dr)],enabled:!0,expCount:Hr(Number((gt==null?void 0:gt.expCount)??Mi),0,12),expMax:Hr(Number((gt==null?void 0:gt.expMax)??na),0,100)}}return Fe}catch{return null}}function er(fe,xe,Ke,Fe){if(!fe)return 0;const gt=new Set(xe.map(Ft=>String(Ft)));let dr=0;for(const Ft of Object.values(fe)){if(!Ft||typeof Ft!="object")continue;const jr=Ft.marksByCo&&typeof Ft.marksByCo=="object"?Ft.marksByCo:{};let Ar=!1;for(const qr of xe){const Qr=String(qr);if(!gt.has(Qr))continue;const Ur=jr[Qr];if(Array.isArray(Ur)&&Ur.some(Xr=>Xr!==""&&Xr!=null)){Ar=!0;break}if(!Ar&&qr===Ke&&Array.isArray(Ft.marksA)&&Ft.marksA.some(Xr=>Xr!==""&&Xr!=null)&&(Ar=!0),!Ar&&Fe!=null&&qr===Fe&&Array.isArray(Ft.marksB)&&Ft.marksB.some(Xr=>Xr!==""&&Xr!=null)&&(Ar=!0),Ar)break}Ar&&dr++}return dr}function pr(fe){return Object.entries(fe).filter(([xe,Ke])=>Or.has(String(xe))&&!!(Ke!=null&&Ke.enabled)).map(([xe])=>Hr(Number(xe),1,5)).sort((xe,Ke)=>xe-Ke)}function we(fe,xe){const Ke=[],Fe=[],gt=[];for(const dr of[1,2,3,4,5]){const Ft=String(dr),jr=fe[Ft],Ar=xe[Ft],qr=!!(jr!=null&&jr.enabled),Qr=!!(Ar!=null&&Ar.enabled);if(!jr&&Ar){Qr&&Ke.push(dr);continue}if(jr&&!Ar){qr&&Fe.push(dr);continue}if(jr&&Ar){const Ur=Hr(Number(jr.expCount??0),0,12),Xr=Hr(Number(Ar.expCount??0),0,12),br=Hr(Number(jr.expMax??0),0,100),Mr=Hr(Number(Ar.expMax??0),0,100);(qr!==Qr||Ur!==Xr||br!==Mr)&&gt.push(dr)}}return{added:Ke,removed:Fe,changed:gt}}function Ie(fe,xe){if(!fe)return 0;let Ke=0;for(const Fe of Object.values(fe)){if(!Fe||typeof Fe!="object")continue;if(Array.isArray(Fe.marksA)&&Fe.marksA.some(jr=>jr!==""&&jr!=null)||Array.isArray(Fe.marksB)&&Fe.marksB.some(jr=>jr!==""&&jr!=null)||Fe.ciaExam!==""&&Fe.ciaExam!=null){Ke++;continue}const dr=Fe.marksByCo&&typeof Fe.marksByCo=="object"?Fe.marksByCo:{};let Ft=!1;for(const jr of xe){const Ar=dr[String(jr)];if(Array.isArray(Ar)&&Ar.some(qr=>qr!==""&&qr!=null)){Ft=!0;break}}Ft&&Ke++}return Ke}function Ze(fe){Dt(xe=>!wt||xe.sheet.markManagerLocked?xe:{...xe,sheet:{...xe.sheet,ciaExamEnabled:!!fe}})}function bt(fe){Zr&&Dt(xe=>{if(!wt||xe.sheet.markManagerLocked)return xe;const Ke=Hr(Number(fe),0,100),Fe={...xe.sheet.rowsByStudentId||{}};for(const[gt,dr]of Object.entries(Fe)){const Ft=dr&&typeof dr=="object"?dr:{},jr=Ft==null?void 0:Ft.ciaExam;typeof jr=="number"&&Number.isFinite(jr)&&(Fe[gt]={...Ft,ciaExam:Vb(jr,0,Ke)})}return{...xe,sheet:{...xe.sheet,ciaExamMax:Ke,rowsByStudentId:Fe}}})}function St(fe,xe){Dt(Ke=>{var jr;const Fe=String(fe),gt=(jr=Ke.sheet.rowsByStudentId)==null?void 0:jr[Fe];if(!gt)return Ke;const dr=Hr(Number(Ke.sheet.expCountA??Mi),0,12),Ft=Hr(Number(Ke.sheet.expCountB??0),0,12);return xe?{...Ke,sheet:{...Ke.sheet,rowsByStudentId:{...Ke.sheet.rowsByStudentId,[Fe]:{...gt,absent:!0,absentKind:gt.absentKind||"AL",marksA:Array.from({length:dr},()=>""),marksB:Array.from({length:Ft},()=>""),caaExamByCo:{},ciaExamByCo:{},ciaExam:""}}}}:{...Ke,sheet:{...Ke.sheet,rowsByStudentId:{...Ke.sheet.rowsByStudentId,[Fe]:{...gt,absent:!1,absentKind:void 0}}}}})}function Sr(fe,xe){Dt(Ke=>{var dr;const Fe=String(fe),gt=(dr=Ke.sheet.rowsByStudentId)==null?void 0:dr[Fe];return gt?{...Ke,sheet:{...Ke.sheet,rowsByStudentId:{...Ke.sheet.rowsByStudentId,[Fe]:{...gt,absent:!0,absentKind:xe}}}}:Ke})}function Yr(fe,xe){const Ke=Hr(Number(fe),1,5);Dt(Fe=>{if(Fe.sheet.markManagerLocked)return Fe;const gt=Ot(Fe.sheet),dr=String(Ke),Ft=gt[dr],jr=Hr(Number((Ft==null?void 0:Ft.expCount)??Mi),0,12),Ar=Hr(Number((Ft==null?void 0:Ft.expMax)??na),0,100),qr=Fu((Ft==null?void 0:Ft.btl)??[],jr,1);gt[dr]={enabled:!!xe,expCount:jr,expMax:Ar,btl:qr};const Qr=Hr(Number(Fe.sheet.coANum??i??1),1,5),Ur=Fe.sheet.coBNum??s??null,Xr=Ur==null?null:Hr(Number(Ur),1,5),br={...Fe.sheet,coConfigs:gt};return Ke===Qr&&(br.coAEnabled=!!xe),Xr!=null&&Ke===Xr&&(br.coBEnabled=!!xe),{...Fe,sheet:br}})}async function ct(){if(!e)return;Pt(!0),He(null);const fe=new Date,xe=je!=null&&je.mark_manager_unlocked_until?String(je.mark_manager_unlocked_until):null;try{const Ke=await il({assessment:r,subject_code:String(e),scope:"MARK_MANAGER",reason:`Edit request: Mark Manager changes for ${n}`,teaching_assignment_id:t});alert(al(Ke));const Fe=Number(Ke==null?void 0:Ke.id),gt=fe.getTime()-2e3;(async()=>{for(let jr=0;jr<36;jr++){try{const Ar=await Lm({assessment:r,subject_code:String(e),scope:"MARK_MANAGER",teaching_assignment_id:t}),qr=Ar==null?void 0:Ar.result;if(!qr)throw new Error("No status");if(Number.isFinite(Fe)&&Fe>0&&Number(qr.id)!==Fe)throw new Error("Different request");const Qr=qr.reviewed_at?new Date(String(qr.reviewed_at)).getTime():0,Ur=String(qr.status||"").toUpperCase();if(Ur==="APPROVED"&&Qr>=gt){try{Mt({silent:!0})}catch{}alert("IQAC approved the mark-manager edit request. You can now edit mark-manager settings.");return}if(Ur==="REJECTED"&&Qr>=gt){alert("IQAC rejected the mark-manager edit request.");return}}catch{try{const Ar=je!=null&&je.mark_manager_unlocked_until?String(je.mark_manager_unlocked_until):null;if(Ar&&xe&&Ar!==xe){try{Mt({silent:!0})}catch{}alert("IQAC approved the mark-manager edit request. You can now edit mark-manager settings.");return}}catch{}}await new Promise(Ar=>setTimeout(Ar,5e3))}alert("Edit request still pending. Please try again later.")})()}catch(Ke){const Fe=sl(Ke,"Request failed");He(Fe),alert(`Edit request failed: ${Fe}`)}finally{Pt(!1)}}async function $t(fe,xe=[]){if(e){Pt(!0),He(null);try{const Ke=Hr(Number(i??1),1,5),Fe=s==null?null:Hr(Number(s),1,5),gt=mt(Gt,Ve),dr=pt!=null&&pt.approval_until?String(pt.approval_until):xt.sheet.markManagerApprovalUntil||null,Ft=Gt[String(Ke)],jr=Fe==null?null:Gt[String(Fe)],Ar=!!(Ft!=null&&Ft.enabled),qr=!!(Fe!=null&&(jr!=null&&jr.enabled)),Qr=Hr(Number((Ft==null?void 0:Ft.expCount)??xt.sheet.expCountA??Mi),0,12),Ur=Hr(Number((Ft==null?void 0:Ft.expMax)??xt.sheet.expMaxA??na),0,100),Xr=Fu((Ft==null?void 0:Ft.btl)??xt.sheet.btlA,Qr,1),br=Fe==null?0:Hr(Number((jr==null?void 0:jr.expCount)??xt.sheet.expCountB??Mi),0,12),Mr=Fe==null?0:Hr(Number((jr==null?void 0:jr.expMax)??xt.sheet.expMaxB??na),0,100),un=Fe==null?[]:Fu((jr==null?void 0:jr.btl)??xt.sheet.btlB,br,1),kn=new Set(fe==="full"?[1,2,3,4,5].map(String):fe==="partial"?xe.map(Fn=>String(Hr(Number(Fn),1,5))):[]),vn=(Fn,ci,xi)=>{const Fi=Fn!=null&&Fn.marksByCo&&typeof Fn.marksByCo=="object"?Fn.marksByCo:{};return Ns(Fi[ci],xi)},Cn=Fn=>Fn.some(ci=>ci!==""&&ci!=null),In={...xt,sheet:{...xt.sheet,coANum:Ke,coBNum:Fe,coAEnabled:Ar,coBEnabled:qr,expCountA:Qr,expCountB:br,expMaxA:Ur,expMaxB:Mr,btlA:Xr,btlB:un,coConfigs:Gt,markManagerLocked:!0,markManagerSnapshot:gt,markManagerApprovalUntil:dr,rowsByStudentId:Object.fromEntries(Object.entries(xt.sheet.rowsByStudentId||{}).map(([Fn,ci])=>{const xi=ci&&typeof ci=="object"?ci:{};let Fi=xi!=null&&xi.marksByCo&&typeof xi.marksByCo=="object"?{...xi.marksByCo}:{};if(fe==="full")Fi={},xi.marksA=Array.from({length:Qr},()=>""),xi.marksB=Array.from({length:br},()=>""),xi.caaExamByCo={},xi.ciaExamByCo={},xi.ciaExam="";else if(fe==="partial"&&kn.size){const Zi=Yb(xi.caaExamByCo);for(const Di of Array.from(kn)){const ba=Gt[String(Di)],cs=Hr(Number((ba==null?void 0:ba.expCount)??0),0,12);cs>0?Fi[String(Di)]=Array.from({length:cs},()=>""):delete Fi[String(Di)],Object.prototype.hasOwnProperty.call(Zi,String(Di))&&(Zi[String(Di)]=""),Number(Di)===Ke&&(xi.marksA=Array.from({length:Qr},()=>"")),Fe!=null&&Number(Di)===Fe&&(xi.marksB=Array.from({length:br},()=>""))}xi.caaExamByCo=Zi}const Ho=Ns(xi==null?void 0:xi.marksA,Qr),Vo=Ns(xi==null?void 0:xi.marksB,br),Rl=Ns(Fi[String(Ke)]??vn(xi,String(Ke),Qr),Qr),Zs=Fe==null?[]:Ns(Fi[String(Fe)]??vn(xi,String(Fe),br),br),Fl=Cn(Ho)?Ho:Cn(Rl)?Rl:Ho,Ya=br?Cn(Vo)?Vo:Cn(Zs)?Zs:Vo:Vo;return Fi[String(Ke)]=Rl,Fe!=null&&(Fi[String(Fe)]=Zs),[Fn,{...xi,marksA:Fl,marksB:Ya,marksByCo:Fi}]}))}};Dt(In),ze(null),ht(null),_e(!0),await Ri(r,String(e),In),T(new Date().toLocaleString());try{await dh(r,String(e),t),Mt({silent:!0})}catch(Fn){console.warn("confirmMarkManagerLock failed",Fn)}}catch(Ke){He((Ke==null?void 0:Ke.message)||"Save failed")}finally{Pt(!1),setTimeout(()=>_e(!1),2e3)}}}function qe(fe,xe){const Ke=Hr(Number(xe),0,12);Dt(Fe=>{if(Fe.sheet.markManagerLocked)return Fe;const gt=Ot(Fe.sheet),dr=String(fe),Ft=gt[dr],jr=Hr(Number((Ft==null?void 0:Ft.expMax)??na),0,100);gt[dr]={enabled:!!((Ft==null?void 0:Ft.enabled)??!0),expCount:Ke,expMax:jr,btl:Fu((Ft==null?void 0:Ft.btl)??[],Ke,1)};const Ar=Hr(Number(Fe.sheet.coANum??i??1),1,5),qr=Fe.sheet.coBNum??s??null,Qr=qr==null?null:Hr(Number(qr),1,5),Ur={...Fe.sheet.rowsByStudentId||{}};for(const Xr of Object.keys(Ur)){const br=Ur[Xr],Mr=br!=null&&br.marksByCo&&typeof br.marksByCo=="object"?{...br.marksByCo}:{};Mr[dr]=Ns(Mr[dr],Ke);const un={...br,marksByCo:Mr};fe===Ar&&(un.marksA=Ns(br.marksA,Ke)),Qr!=null&&fe===Qr&&(un.marksB=Ns(br.marksB,Ke)),Ur[Xr]=un}return{...Fe,sheet:{...Fe.sheet,coConfigs:gt,expCountA:fe===Ar?Ke:Fe.sheet.expCountA,expCountB:fe===Qr?Ke:Fe.sheet.expCountB,btlA:fe===Ar?gt[dr].btl:Fe.sheet.btlA,btlB:fe===Qr?gt[dr].btl:Fe.sheet.btlB,rowsByStudentId:Ur}}})}function Ye(fe,xe){const Ke=Hr(Number(xe),0,100);Dt(Fe=>{if(Fe.sheet.markManagerLocked)return Fe;const gt=Ot(Fe.sheet),dr=String(fe),Ft=gt[dr],jr=Hr(Number((Ft==null?void 0:Ft.expCount)??Mi),0,12);gt[dr]={enabled:!!((Ft==null?void 0:Ft.enabled)??!0),expCount:jr,expMax:Ke,btl:Fu((Ft==null?void 0:Ft.btl)??[],jr,1)};const Ar=Hr(Number(Fe.sheet.coANum??i??1),1,5),qr=Fe.sheet.coBNum??s??null,Qr=qr==null?null:Hr(Number(qr),1,5),Ur=fe===Ar?Ke:Hr(Number(Fe.sheet.expMaxA??na),0,100),Xr=fe===Qr?Ke:Hr(Number(Fe.sheet.expMaxB??0),0,100),br=Hr(Number(Fe.sheet.expCountA??Mi),0,12),Mr=Hr(Number(Fe.sheet.expCountB??0),0,12),un={};for(const[kn,vn]of Object.entries(Fe.sheet.rowsByStudentId||{})){const Cn=Ns(vn.marksA,br).map(ci=>typeof ci=="number"?Hr(ci,0,Ur):""),In=Ns(vn.marksB,Mr).map(ci=>typeof ci=="number"?Hr(ci,0,Xr):""),Fn=vn!=null&&vn.marksByCo&&typeof vn.marksByCo=="object"?{...vn.marksByCo}:{};Fn[dr]=Ns(Fn[dr],jr).map(ci=>typeof ci=="number"?Hr(ci,0,Ke):""),un[kn]={...vn,marksA:Cn,marksB:In,marksByCo:Fn}}return{...Fe,sheet:{...Fe.sheet,coConfigs:gt,expMaxA:Ur,expMaxB:Xr,rowsByStudentId:un}}})}function ot(fe,xe,Ke){Dt(Fe=>{if(Fe.sheet.markManagerLocked)return Fe;const gt=Ot(Fe.sheet),dr=String(Hr(Number(fe),1,5)),Ft=gt[dr],jr=Hr(Number((Ft==null?void 0:Ft.expCount)??Mi),0,12),Ar=Fu((Ft==null?void 0:Ft.btl)??[],jr,1);xe>=0&&xe<Ar.length&&(Ar[xe]=Ke),gt[dr]={enabled:!!((Ft==null?void 0:Ft.enabled)??!1),expCount:jr,expMax:Hr(Number((Ft==null?void 0:Ft.expMax)??na),0,100),btl:Ar};const qr=Hr(Number(Fe.sheet.coANum??i??1),1,5),Qr=Fe.sheet.coBNum??s??null,Ur=Qr==null?null:Hr(Number(Qr),1,5);return{...Fe,sheet:{...Fe.sheet,coConfigs:gt,btlA:fe===qr?Ar:Fe.sheet.btlA,btlB:fe===Ur?Ar:Fe.sheet.btlB}}})}function $e(fe,xe,Ke,Fe){Dt(gt=>{var In;const dr=String(fe),Ft=(In=gt.sheet.rowsByStudentId)==null?void 0:In[dr];if(!Ft||yt&&r!=="model"&&Ft.absent)return gt;if(r==="model"){const Fn=!!Ft.absent,ci=Fn?String(Ft.absentKind||"AL").toUpperCase():"";if(Fn&&!!!(Ae&&Fn&&(ci==="ML"||ci==="SKL")))return gt}const jr=Ot(gt.sheet),Ar=String(Hr(Number(xe),1,5)),qr=jr[Ar],Qr=Hr(Number((qr==null?void 0:qr.expCount)??0),0,12),Ur=Hr(Number((qr==null?void 0:qr.expMax)??na),0,100),Xr=Ft!=null&&Ft.marksByCo&&typeof Ft.marksByCo=="object"?{...Ft.marksByCo}:{},br=Ns(Xr[Ar],Qr),Mr=Fe===""?"":Hr(Number(Fe),0,Ur);Ke>=0&&Ke<br.length&&(br[Ke]=Mr),Xr[Ar]=br;const un=Hr(Number(gt.sheet.coANum??i??1),1,5),kn=gt.sheet.coBNum??s??null,vn=kn==null?null:Hr(Number(kn),1,5),Cn={...Ft,marksByCo:Xr};return xe===un&&(Cn.marksA=Ns(Ft.marksA,Qr).map((Fn,ci)=>ci===Ke?Mr:Fn)),vn!=null&&xe===vn&&(Cn.marksB=Ns(Ft.marksB,Qr).map((Fn,ci)=>ci===Ke?Mr:Fn)),{...gt,sheet:{...gt.sheet,rowsByStudentId:{...gt.sheet.rowsByStudentId,[dr]:Cn}}}})}function kt(fe,xe){Dt(Ke=>{var jr;const Fe=String(fe),gt=(jr=Ke.sheet.rowsByStudentId)==null?void 0:jr[Fe];if(!gt||!wt||yt&&r!=="model"&&gt.absent)return Ke;if(r==="model"){const Ar=!!gt.absent,qr=Ar?String(gt.absentKind||"AL").toUpperCase():"";if(Ar&&!!!(Ae&&Ar&&(qr==="ML"||qr==="SKL")))return Ke}if(qt)return Ke;const dr=Zr?Hr(Number(Ke.sheet.ciaExamMax??Mh),0,100):Mh,Ft=xe===""?"":Hr(Number(xe),0,dr);return{...Ke,sheet:{...Ke.sheet,rowsByStudentId:{...Ke.sheet.rowsByStudentId,[Fe]:{...gt,ciaExam:Ft}}}}})}function It(fe,xe,Ke){Dt(Fe=>{var Qr;if(qt)return Fe;const gt=String(fe),dr=(Qr=Fe.sheet.rowsByStudentId)==null?void 0:Qr[gt];if(!dr||yt&&r!=="model"&&dr.absent)return Fe;if(r==="model"){const Ur=!!dr.absent,Xr=Ur?String(dr.absentKind||"AL").toUpperCase():"";if(Ur&&!!!(Ae&&Ur&&(Xr==="ML"||Xr==="SKL")))return Fe}const Ft=String(Hr(Number(xe),1,5)),jr=Number(wp[Number(Ft)]||0),Ar=Ke===""?"":Vb(Number(Ke),0,jr>0?jr:0),qr={...Yb(dr==null?void 0:dr.caaExamByCo),[Ft]:Ar};return{...Fe,sheet:{...Fe.sheet,rowsByStudentId:{...Fe.sheet.rowsByStudentId,[gt]:{...dr,caaExamByCo:qr}}}}})}function Zt(fe,xe,Ke){Dt(Fe=>{var Qr;if(!qt)return Fe;const gt=String(fe),dr=(Qr=Fe.sheet.rowsByStudentId)==null?void 0:Qr[gt];if(!dr||!wt||!Ve||yt&&r!=="model"&&dr.absent)return Fe;if(r==="model"){const Ur=!!dr.absent,Xr=Ur?String(dr.absentKind||"AL").toUpperCase():"";if(Ur&&!!!(Ae&&Ur&&(Xr==="ML"||Xr==="SKL")))return Fe}const Ft=String(Hr(Number(xe),1,5)),jr=Number(_d[Number(Ft)]||0);if(jr<=0)return Fe;const Ar=Ke===""?"":Vb(Number(Ke),0,jr),qr={...Fk(dr==null?void 0:dr.ciaExamByCo),[Ft]:Ar};return{...Fe,sheet:{...Fe.sheet,rowsByStudentId:{...Fe.sheet.rowsByStudentId,[gt]:{...dr,ciaExamByCo:qr}}}}})}async function sn(){if(e){F(!0);try{await Ri(r,String(e),xt),T(new Date().toLocaleString())}catch(fe){alert((fe==null?void 0:fe.message)||"Draft save failed")}finally{F(!1)}}}const mn=on.useRef(xt);mn.current=xt,x.useEffect(()=>{const fe=()=>{!e||_t||Ri(r,String(e),mn.current).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",fe),()=>window.removeEventListener("obe:before-tab-switch",fe)},[e,r,_t]);async function hn(){if(!e||!window.confirm(`Reset all marks for ${n}? This clears the draft for all students.`))return;const xe=Hr(Number(xt.sheet.expCountA??Mi),0,12),Ke=Hr(Number(xt.sheet.expCountB??0),0,12),Fe={};for(const dr of b)Fe[String(dr.id)]={studentId:dr.id,absent:!1,absentKind:void 0,marksA:Array.from({length:xe},()=>""),marksB:Array.from({length:Ke},()=>""),marksByCo:{},caaExamByCo:{},ciaExamByCo:{},ciaExam:""};const gt={sheet:{...xt.sheet,btlA:Array.from({length:xe},()=>1),btlB:Array.from({length:Ke},()=>1),rowsByStudentId:Fe}};Dt(gt);try{Kr&&Kn(Kr,{rowsByStudentId:{}})}catch{}try{await Ri(r,String(e),gt),T(new Date().toLocaleString())}catch{}}async function Tn(){if(!e)return;if(Wt){alert("Publishing is locked by IQAC.");return}if(!Pr){alert("Publish window is closed. Please request IQAC approval.");return}if(re&&vt&&!g){if(De){alert("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}ie(!0);return}se(!0);const fe=de,xe=fr,Ke={markEntryUnblockedUntil:le,markManagerUnlockedUntil:te};try{console.debug("publish called",{assessment:r,subjectId:e,entryOpen:ke,publishAllowed:Pr,globalLocked:Wt}),z(new Date().toLocaleString()),vr(Ke),await _3(r,String(e),xt,t),console.debug("publish succeeded",{assessment:r,subjectId:e}),await Ir(!1),Me(),Mt({silent:!0});try{console.debug("obe:published dispatch",{assessment:r,subjectId:e}),window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:r}}))}catch{}}catch(Fe){z(fe),vr(xe),alert((Fe==null?void 0:Fe.message)||"Publish failed")}finally{se(!1)}}async function Ir(fe){if(e){fe&&Z(!0),Te(null);try{const xe=await po(r,String(e),t),Ke=(xe==null?void 0:xe.data)??null;Ke&&typeof Ke=="object"&&ae(Ke)}catch(xe){fe&&Te((xe==null?void 0:xe.message)||"Failed to load published marks")}finally{fe&&Z(!1)}}}x.useEffect(()=>{if(e){if(!(je!=null&&je.exists)||!(je!=null&&je.is_published)){ae(null);return}Ir(!1)}},[e,r,je==null?void 0:je.exists,je==null?void 0:je.is_published]);const gn=on.useRef(!!ke);x.useEffect(()=>{if(!e||!re)return;if(gn.current||!ke){gn.current=!!ke;return}let xe=!0;return(async()=>{try{const Ke=await ei(r,String(e),t),Fe=(Ke==null?void 0:Ke.data)??null;if(!xe)return;if(Fe&&typeof Fe=="object"&&Fe.sheet){Dt(Fe);return}}catch{}xe&&W&&W.sheet&&Dt(W)})(),gn.current=!!ke,()=>{xe=!1}},[ke,re,e,r,W]),x.useEffect(()=>{if(!e||!re||ke)return;const fe=window.setInterval(()=>{Mt({silent:!0});try{ir==null||ir({silent:!0})}catch{}},3e4);return()=>window.clearInterval(fe)},[ke,re,e,Mt,ir]),x.useEffect(()=>{vr(null)},[e]);async function fn(){if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}const xe=String(K||"").trim();if(!xe){alert("Reason is required.");return}if(De){alert("Edit request is already pending. Please wait.");return}J(!0);const Ke=new Date,Fe=Ut!=null&&Ut.approval_until?String(Ut.approval_until):null;try{const gt=await il({assessment:r,subject_code:String(e),scope:"MARK_ENTRY",reason:xe,teaching_assignment_id:t});alert(al(gt)),ie(!1),H(""),st(Date.now()+24*60*60*1e3);try{zt({silent:!0})}catch{}const dr=Number(gt==null?void 0:gt.id),Ft=Ke.getTime()-2e3;(async()=>{for(let qr=0;qr<36;qr++){try{const Qr=await Lm({assessment:r,subject_code:String(e),scope:"MARK_ENTRY",teaching_assignment_id:t}),Ur=Qr==null?void 0:Qr.result;if(!Ur)throw new Error("No status");if(Number.isFinite(dr)&&dr>0&&Number(Ur.id)!==dr)throw new Error("Different request");const Xr=Ur.reviewed_at?new Date(String(Ur.reviewed_at)).getTime():0,br=String(Ur.status||"").toUpperCase();if(br==="APPROVED"&&Xr>=Ft){try{Mt({silent:!0}),ir==null||ir({silent:!0})}catch{}alert("IQAC approved the edit request. You can now edit marks.");return}if(br==="REJECTED"&&Xr>=Ft){alert("IQAC rejected the edit request.");return}}catch{try{const Qr=await o1(r,String(e),"MARK_ENTRY",t),Ur=Qr!=null&&Qr.approval_until?String(Qr.approval_until):null;if(Qr!=null&&Qr.allowed_by_approval&&Ur&&Ur!==Fe){try{Mt({silent:!0}),ir==null||ir({silent:!0})}catch{}alert("IQAC approved the edit request. You can now edit marks.");return}}catch{}}await new Promise(Qr=>setTimeout(Qr,5e3))}alert("Edit request still pending. Please try again later.")})()}catch(gt){const dr=sl(gt,"Request failed");alert(`Edit request failed: ${dr}`)}finally{J(!1)}}x.useEffect(()=>{Y&&e&&(ae(null),Ir(!0))},[Y,e,r]);const ve=x.useMemo(()=>{if(Ue===0)return[];const fe=new Set;for(const xe of Xt)for(let Ke=0;Ke<xe.expCount;Ke++){const Fe=xe.btl[Ke];(Fe===1||Fe===2||Fe===3||Fe===4||Fe===5||Fe===6)&&fe.add(Fe)}return[1,2,3,4,5,6].filter(xe=>fe.has(xe))},[Xt,Ue]),at=3+(yt?1:0)+Ct+1+Jt+ar+ve.length*2,Re={border:"1px solid #111",padding:"4px 4px",background:"#ecfdf5",color:"#065f46",textAlign:"center",fontWeight:700,fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},dt={border:"1px solid #111",padding:"4px 4px",fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},Rr={width:"100%",border:"none",outline:"none",background:"transparent",fontSize:11,textAlign:"center"},nn={border:"1px solid #e5e7eb",borderRadius:12,background:"#fff",padding:12},tn=40,_n=90,zn=180,Hn=56,ri=52,M=72,ce=80,Le=x.useMemo(()=>[...Array.from({length:Ct},()=>ce),ri,...Jt>0?Array.from({length:Jt},()=>ce):[],...Array.from({length:ar+ve.length*2},()=>ce)],[Ct,Jt,ar,ve.length]),it=x.useMemo(()=>{const fe=tn+_n+zn+(yt?Hn:0),xe=Le.reduce((Ke,Fe)=>Ke+Fe,0);return Math.max(900,fe+xe)},[yt,Le]),At=x.useMemo(()=>{const fe=tn+_n+zn,xe=Le.reduce((Ke,Fe)=>Ke+Fe,0);return Math.max(900,fe+xe)},[Le]),lr=(fe,xe)=>({position:"sticky",left:fe,zIndex:40,...xe!=null?{width:xe,minWidth:xe,maxWidth:xe}:null,background:Re.background}),nr=(fe,xe)=>({position:"sticky",left:fe,zIndex:25,...xe!=null?{width:xe,minWidth:xe,maxWidth:xe}:null,background:"#fff"});function yr(fe,xe,Ke){const Fe=3+(xe?1:0),gt=Math.max(0,fe-Fe);return a.jsxs("colgroup",{children:[a.jsx("col",{style:{width:tn}}),a.jsx("col",{style:{width:_n}}),a.jsx("col",{style:{width:zn}}),xe?a.jsx("col",{style:{width:Hn}}):null,Array.from({length:gt}).map((dr,Ft)=>{const jr=(Ke==null?void 0:Ke[Ft])??ce;return a.jsx("col",{style:{width:jr,minWidth:jr,maxWidth:jr}},`rest_${Ft}`)})]})}const Wr={display:"flex",width:"100%",maxWidth:1200,margin:"0 auto",gap:10,flexWrap:"wrap",alignItems:"center",marginBottom:8},Vr={width:20,height:20,transform:"scale(1.5)",accentColor:"#9a3412"},dn=tt?"markManagerGlitch 2s ease-in-out":void 0,Pn={position:"absolute",left:"50%",top:6,transform:"translateX(-50%)",zIndex:40,width:160,background:"#fff",border:"1px solid #e5e7eb",padding:10,borderRadius:12,display:"flex",flexDirection:"column",gap:8,alignItems:"center",boxShadow:"0 6px 18px rgba(17,24,39,0.06)",filter:"none"},li=async()=>{if(!e)return;const fe=b.map((xe,Ke)=>{var Ar;const Fe=(Ar=xt.sheet.rowsByStudentId)==null?void 0:Ar[String(xe.id)],gt=Ht(Fe,Xt),dr=Pe(Fe,gt),jr=!!(yt&&(Fe!=null&&Fe.absent)&&!dr.hasAnyMarks)?"ABSENT":dr.finalTotal;return{sno:Ke+1,regNo:String(xe.reg_no||""),name:String(xe.name||""),total:jr}});await fy({filenameBase:`${String(e)}_${n}`,meta:{courseName:(A==null?void 0:A.courseName)||"",courseCode:(A==null?void 0:A.courseCode)||String(e),className:(A==null?void 0:A.className)||""},rows:fe})};return a.jsxs(ag,{children:[a.jsx("style",{children:`
        @keyframes markManagerGlitch {
          0% { background: #fff7ed; transform: translateX(0); }
          10% { background: #f3f4f6; transform: translateX(-2px); }
          20% { background: #fff7ed; transform: translateX(2px); }
          30% { background: #f3f4f6; transform: translateX(-1px); }
          40% { background: #fff7ed; transform: translateX(1px); }
          50% { background: #f3f4f6; transform: translateX(0); }
          60% { background: #fff7ed; transform: translateX(-1px); }
          70% { background: #f3f4f6; transform: translateX(1px); }
          80% { background: #fff7ed; transform: translateX(0); }
          90% { background: #f3f4f6; transform: translateX(-1px); }
          100% { background: #f3f4f6; transform: translateX(0); }
        }
        @keyframes markManagerDust {
          0% { opacity: 1; transform: scale(1) rotate(0deg); }
          50% { opacity: 0.8; transform: scale(1.1) rotate(180deg); }
          100% { opacity: 0; transform: scale(0.5) rotate(360deg); }
        }
        .markManagerDustParticle {
          position: absolute;
          width: 4px;
          height: 4px;
          background: #d1d5db;
          border-radius: 50%;
          animation: markManagerDust 2s ease-out forwards;
        }
      `}),a.jsxs("div",{style:{margin:"0 0 10px 0",maxWidth:"100%",width:"100%",boxSizing:"border-box",overflow:"hidden"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"COs enabled"}),a.jsxs("div",{style:{...Wr,border:"1px solid #fcd34d",background:ur?"#f3f4f6":"#fff7ed",padding:12,borderRadius:12,alignItems:"stretch",animation:dn,position:"relative",overflow:"hidden"},children:[tt&&a.jsx(a.Fragment,{children:Array.from({length:20},(fe,xe)=>a.jsx("div",{className:"markManagerDustParticle",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*1}s`}},xe))}),a.jsxs("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",gap:10,flexWrap:"wrap"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,minWidth:0},children:[a.jsx(C2,{size:18,color:ur?"#6b7280":"#9a3412"}),a.jsx("div",{style:{fontWeight:950,color:"#111827"},children:"Mark Manager"})]}),a.jsx("div",{style:{display:"flex",gap:8,alignItems:"center"},children:a.jsx("button",{onClick:()=>{if(ur){ze({mode:"request"});return}const fe=Nt(xt.sheet.markManagerSnapshot??null);if(fe){const xe=pr(fe),Ke=pr(Gt),Fe=xe.filter(gt=>!Ke.includes(gt));if(Fe.length){const gt=Hr(Number(i??1),1,5),dr=s==null?null:Hr(Number(s),1,5),Ft=er(xt.sheet.rowsByStudentId,Fe,gt,dr);ht({visible:!0,removed:Fe,affected:Ft});return}}ze({mode:"confirm"})},className:"obe-btn obe-btn-success",disabled:!e||Xe,style:Xe?{opacity:.6,cursor:"not-allowed"}:void 0,children:ur?"Edit":"Save"})})]}),a.jsxs("div",{style:{width:"100%",display:"flex",gap:10,flexWrap:"wrap",marginTop:8},children:[Tr.map(fe=>{const xe=Gt[String(fe)],Ke=!!(xe!=null&&xe.enabled);return a.jsxs("label",{style:{display:"flex",gap:6,alignItems:"center",fontWeight:800,fontSize:12,color:"#111827"},children:[a.jsx("input",{type:"checkbox",checked:Ke,disabled:ur,onChange:Fe=>Yr(fe,Fe.target.checked),style:Vr}),"CO-",fe]},fe)}),a.jsx("label",{style:{display:"flex",gap:6,alignItems:"center",fontWeight:800,fontSize:12,color:"#111827"},children:wt?a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"checkbox",checked:Ve,disabled:ur,onChange:fe=>Ze(fe.target.checked),style:Vr}),"CIA Exam"]}):null})]}),a.jsxs("div",{style:{width:"100%",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:10,marginTop:8},children:[Zr&&wt&&Ve?a.jsxs("div",{style:{width:"100%",minWidth:0,display:"flex",flexDirection:"column",gap:6,padding:"10px 10px",border:"1px solid #e5e7eb",borderRadius:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,fontWeight:950},children:"CIA Exam"}),a.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:"Max marks"}),a.jsx("input",{type:"number",className:"obe-input",value:Rt,onChange:fe=>bt(Number(fe.target.value)),min:0,max:100,disabled:ur})]},"cfg_cia_exam"):null,Tr.map(fe=>{const xe=Gt[String(fe)];if(!!!(xe!=null&&xe.enabled))return null;const Fe=Hr(Number((xe==null?void 0:xe.expCount)??Mi),0,12),gt=Hr(Number((xe==null?void 0:xe.expMax)??na),0,100);return a.jsxs("div",{style:{width:"100%",minWidth:0,display:"flex",flexDirection:"column",gap:6,padding:"10px 10px",border:"1px solid #e5e7eb",borderRadius:12,background:"#fff"},children:[a.jsxs("div",{style:{fontSize:12,fontWeight:950},children:["CO-",fe]}),a.jsxs("div",{style:{fontSize:11,color:"#6b7280"},children:["No. of ",lt.toLowerCase()]}),a.jsx("input",{type:"number",className:"obe-input",value:Fe,onChange:dr=>qe(fe,Number(dr.target.value)),min:0,max:12,disabled:ur}),a.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:"Max marks"}),a.jsx("input",{type:"number",className:"obe-input",value:gt,onChange:dr=>Ye(fe,Number(dr.target.value)),min:0,max:100,disabled:ur})]},`cfg_${fe}`)})]})]}),ft?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#991b1b"},children:ft}):null]}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{onClick:li,className:"obe-btn obe-btn-secondary",disabled:!e||b.length===0,children:"Download"}),a.jsx("button",{onClick:hn,className:"obe-btn obe-btn-danger",disabled:!e||_t,title:_t?"Table locked  confirm Mark Manager to enable actions":void 0,children:"Reset"})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:sn,className:"obe-btn obe-btn-success",disabled:P||!e||_t,title:_t?"Table locked  confirm Mark Manager to enable actions":void 0,children:P?"Saving":"Save Draft"}),a.jsx("button",{onClick:Tn,className:"obe-btn obe-btn-primary",disabled:rt?!1:!e||U||_t||Wt||!Pr,title:_t?"Table locked  confirm Mark Manager to enable actions":Pr?Wt?"Publishing locked":"Publish":"Publish window closed",children:rt?"Request Edit":U?"Publishing":"Publish"}),E&&a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Saved: ",E]}),de&&a.jsxs("div",{style:{fontSize:12,color:"#16a34a",alignSelf:"center"},children:["Published: ",de]})]})]}),Rn&&!Wt&&Pr&&a.jsxs("div",{style:{fontSize:13,color:"#6b7280",marginBottom:6},children:["Publish window open  due by"," ",a.jsx("strong",{children:Rn.due_at?new Date(Rn.due_at).toLocaleString():""}),Sn!=null&&Sn>0&&a.jsxs("span",{children:[" (",Math.ceil(Sn/60)," min remaining)"]})]}),Wt&&a.jsx("div",{style:{background:"#fffbeb",border:"1px solid #fde68a",color:"#92400e",padding:"10px 14px",borderRadius:10,marginBottom:10,fontWeight:600},children:a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("span",{children:"Publishing disabled by IQAC"}),a.jsx("button",{className:"obe-btn obe-btn-secondary",style:{padding:"2px 10px",fontSize:12},onClick:()=>Me(),children:"Refresh"})]})}),!Wt&&!Pr&&Rn&&a.jsxs("div",{style:{background:"#fff7ed",border:"1px solid #fecaca",color:"#9a3412",padding:"10px 14px",borderRadius:10,marginBottom:10},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[a.jsx("strong",{children:"Publish time is over"}),a.jsxs("div",{style:{display:"flex",gap:6},children:[a.jsx("button",{className:"obe-btn obe-btn-secondary",style:{padding:"2px 10px",fontSize:12},onClick:()=>Me(),children:"Refresh"}),a.jsx("button",{className:"obe-btn obe-btn-primary",style:{padding:"2px 10px",fontSize:12},disabled:Q,onClick:async()=>{if(V.trim()){ne(!0),O(null);try{await _h({assessment:r,subject_code:String(e),reason:V,teaching_assignment_id:t}),O("Request sent successfully."),X("")}catch(fe){O((fe==null?void 0:fe.message)||"Request failed")}ne(!1)}},children:Q?"Sending":"Request Approval"})]})]}),a.jsx("input",{type:"text",placeholder:"Reason for approval",value:V,onChange:fe=>X(fe.target.value),style:{width:"100%",padding:"4px 8px",borderRadius:6,border:"1px solid #d1d5db",fontSize:13}}),oe&&a.jsx("div",{style:{marginTop:4,fontSize:12,color:oe.includes("success")?"#065f46":"#991b1b"},children:oe})]}),w?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading roster"}):null,k?a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:k}):null,a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Term"}),a.jsx("div",{style:{fontWeight:700},children:xt.sheet.termLabel||""})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Batch"}),a.jsx("div",{style:{fontWeight:700},children:xt.sheet.batchLabel||""})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Saved"}),a.jsx("div",{style:{fontWeight:700},children:E||""}),B?a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["by ",a.jsx("span",{style:{color:"#0369a1",fontWeight:700},children:B})]}):null]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Published"}),a.jsx("div",{style:{fontWeight:700},children:de||""})]})]}),a.jsx("div",{style:nn,children:a.jsx(ig,{locked:Wt,children:a.jsxs("div",{className:"obe-table-wrapper",style:{overflowX:"auto",position:"relative",filter:_t?"grayscale(5%)":void 0,opacity:_t?.78:1},children:[a.jsxs("table",{className:"obe-table",style:{width:"100%",minWidth:it,tableLayout:"fixed",borderCollapse:"collapse"},children:[yr(at,yt,Le),a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsx("th",{style:Re,colSpan:at,children:n})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...Re,...lr(0,tn)},rowSpan:5,children:"S.No"}),a.jsx("th",{style:{...Re,...lr(tn,_n)},rowSpan:5,children:"R.No"}),a.jsx("th",{style:{...Re,...lr(tn+_n,zn),textAlign:"left"},rowSpan:5,children:"Name of the Students"}),yt?a.jsx("th",{style:{...Re,...lr(tn+_n+zn,Hn)},rowSpan:5,children:"AB"}):null,a.jsx("th",{style:Re,colSpan:Ct,children:lt}),a.jsx("th",{style:{...Re,width:ri,minWidth:ri,maxWidth:ri},rowSpan:5,children:"AVG"}),qt?a.jsx(a.Fragment,{children:Ve&&Kt.length>0?a.jsx("th",{style:Re,colSpan:Kt.length,children:"CIA EXAM"}):null}):Ve?zr?a.jsx("th",{style:Re,colSpan:Math.max(Bt,1),children:"CIA EXAM"}):a.jsx("th",{style:{...Re,width:M,minWidth:M,maxWidth:M,overflow:"visible",textOverflow:"clip"},rowSpan:5,title:"CIA Exam",children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:2,lineHeight:1.05},children:[a.jsx("div",{style:{whiteSpace:"pre-line"},children:`CIA
EXAM`}),Zr?a.jsx("div",{style:{fontSize:12,fontWeight:900},children:Rt}):null]})}):null,a.jsx("th",{style:Re,colSpan:ar,children:"CO ATTAINMENT"}),ve.length?a.jsx("th",{style:Re,colSpan:ve.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[Ue===0?a.jsx("th",{style:Re,children:""}):a.jsx(a.Fragment,{children:Xt.map(fe=>Array.from({length:fe.expCount},(xe,Ke)=>a.jsx("th",{style:Re,children:fe.coNumber},`co_${fe.coNumber}_${Ke}`)))}),qt?a.jsx(a.Fragment,{children:Ve?Kt.map(fe=>a.jsxs("th",{style:Re,children:["CO-",fe.coNumber]},`lab_cia_co_${fe.coNumber}`)):null}):Ve&&zr?Bt>0?ut.map(fe=>a.jsxs("th",{style:Re,children:["CO-",fe.coNumber]},`caa_co_${fe.coNumber}`)):a.jsx("th",{style:Re,children:""}):null,et?Xt.map(fe=>a.jsxs("th",{style:Re,colSpan:2,children:["CO-",fe.coNumber]},`coatt_${fe.coNumber}`)):a.jsx("th",{style:Re,colSpan:2,children:""}),ve.map(fe=>a.jsxs("th",{style:Re,colSpan:2,children:["BTL-",fe]},`btl_${fe}`))]}),a.jsxs("tr",{children:[Ue===0?a.jsx("th",{style:Re,children:""}):a.jsx(a.Fragment,{children:Xt.map(fe=>Array.from({length:fe.expCount},(xe,Ke)=>a.jsx("th",{style:Re,children:fe.expMax},`max_${fe.coNumber}_${Ke}`)))}),qt?a.jsx(a.Fragment,{children:Ve?Kt.map(fe=>a.jsx("th",{style:Re,children:_d[fe.coNumber]??0},`lab_cia_max_${fe.coNumber}`)):null}):Ve&&zr?Bt>0?ut.map(fe=>a.jsx("th",{style:Re,children:wp[fe.coNumber]??0},`caa_max_${fe.coNumber}`)):a.jsx("th",{style:Re,children:""}):null,et?Xt.map(fe=>{const xe=qt?Lh(Number(Rk[fe.coNumber]||0)+(Ve?Number(_d[fe.coNumber]||0):0)):(()=>{const Ke=Number(Lk[fe.coNumber]||0),Fe=CM[`co${fe.coNumber}`],gt=Array.from({length:Hr(Number(fe.expCount??0),0,12)}).map(()=>Hr(Number(fe.expMax??na),0,100)),dr=gt.length?gt.reduce((jr,Ar)=>jr+Ar,0)/gt.length:0,Ft=Lr&&Number.isFinite(Number(Fe))?Number(Fe):dr;return zr&&Ke>0?Ke:Zr?12:Math.round(Ft+(Ve?Rt/2:0)||0)})();return a.jsxs(on.Fragment,{children:[a.jsx("th",{style:Re,children:xe}),a.jsx("th",{style:Re,children:"%"})]},`comax_${fe.coNumber}`)}):a.jsxs(a.Fragment,{children:[a.jsx("th",{style:Re,children:""}),a.jsx("th",{style:Re,children:"%"})]}),ve.map(fe=>a.jsxs(on.Fragment,{children:[a.jsx("th",{style:Re,children:nt||na}),a.jsx("th",{style:Re,children:"%"})]},`btlmax_${fe}`))]}),a.jsxs("tr",{children:[Ue===0?a.jsxs("th",{style:Re,children:["No ",lt.toLowerCase()]}):a.jsx(a.Fragment,{children:Xt.map(fe=>Array.from({length:fe.expCount},(xe,Ke)=>a.jsxs("th",{style:Re,children:[jt,Ke+1]},`e_${fe.coNumber}_${Ke}`)))}),a.jsx("th",{style:Re,colSpan:ar+ve.length*2+Jt})]}),a.jsxs("tr",{children:[Ue===0?a.jsx("th",{style:Re,children:"BTL"}):a.jsx(a.Fragment,{children:Xt.map(fe=>Array.from({length:fe.expCount},(xe,Ke)=>a.jsx("th",{style:Re,children:(()=>{var Ft;const Fe=((Ft=fe.btl)==null?void 0:Ft[Ke])??1,gt=Fe===""?"-":String(Fe);return!g&&!_t&&!vt&&!Wt?a.jsxs("select",{"aria-label":`BTL for ${Ge} ${Ke+1} (CO-${fe.coNumber})`,value:Fe,onChange:jr=>{const Ar=jr.target.value,qr=Ar===""?"":Number(Ar);ot(fe.coNumber,Ke,qr)},style:{width:"100%",minWidth:44,padding:"4px 2px",fontWeight:800,fontSize:11,textAlign:"center",border:"1px solid #d1d5db",borderRadius:4,background:"#fff",cursor:"pointer"},children:[a.jsx("option",{value:"",children:"-"}),[1,2,3,4,5,6].map(jr=>a.jsx("option",{value:jr,children:jr},jr))]}):a.jsx("span",{style:{fontWeight:800},children:gt})})()},`btl_${fe.coNumber}_${Ke}`)))}),a.jsx("th",{style:Re,colSpan:ar+ve.length*2+Jt})]})]}),a.jsxs("tbody",{children:[(!_t&&!vt?b:[]).map((fe,xe)=>{var Ur,Xr;const Ke=(Ur=xt.sheet.rowsByStudentId)==null?void 0:Ur[String(fe.id)],Fe=Ht(Ke,Xt),gt=Fe.flatMap(br=>br.marks),dr=Gb(gt),Ft=Pe(Ke,Fe),jr=et?Ft.coAttainmentValues:[],Ar=Ft.caaByCo,qr=Ft.ciaByCo,Qr={};for(const br of ve){const Mr=[];for(const un of Xt){const kn=((Xr=Fe.find(vn=>vn.coNumber===un.coNumber))==null?void 0:Xr.marks)??[];for(let vn=0;vn<Math.min(un.expCount,kn.length);vn++)if(un.btl[vn]===br){const Cn=kn[vn];typeof Cn=="number"&&Number.isFinite(Cn)&&Mr.push(Cn)}}Qr[br]=Mr.length?Mr.reduce((un,kn)=>un+kn,0)/Mr.length:null}return a.jsxs("tr",{style:_t&&xe<3?{position:"relative",zIndex:35,background:"#fff"}:void 0,children:[a.jsx("td",{style:{...dt,...nr(0,tn),textAlign:"center"},children:xe+1}),a.jsx("td",{style:{...dt,...nr(tn,_n),textAlign:"center"},title:String(fe.reg_no||""),children:TM(fe.reg_no,7)}),a.jsx("td",{style:{...dt,...nr(tn+_n,zn)},title:String(fe.name||""),children:a.jsx("span",{style:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:String(fe.name||"")})}),yt?a.jsx("td",{style:{...dt,...nr(tn+_n+zn,Hn),textAlign:"center"},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[a.jsx("input",{type:"checkbox",checked:!!(Ke!=null&&Ke.absent),onChange:br=>St(fe.id,br.target.checked),disabled:_t}),Ke!=null&&Ke.absent?a.jsxs("div",{className:"obe-ios-select",title:"Absent type",children:[a.jsx("span",{className:"obe-ios-select-value",children:String(Ke.absentKind||"AL")}),a.jsxs("select",{"aria-label":"Absent type",value:Ke.absentKind||"AL",onChange:br=>Sr(fe.id,br.target.value),disabled:_t,children:[a.jsx("option",{value:"AL",children:"AL"}),a.jsx("option",{value:"ML",children:"ML"}),a.jsx("option",{value:"SKL",children:"SKL"})]})]}):null]})}):null,Ue===0?a.jsx("td",{style:{...dt,textAlign:"center",color:"#6b7280"},children:""}):Xt.map(br=>{var un;const Mr=((un=Fe.find(kn=>kn.coNumber===br.coNumber))==null?void 0:un.marks)??[];return Array.from({length:br.expCount},(kn,vn)=>a.jsx("td",{style:{...dt,width:38,minWidth:0,padding:"2px 2px",background:"#fff7ed"},children:a.jsx("input",{type:"number",value:Mr[vn]??"",onChange:Cn=>{const In=Cn.target.value;if(In==="")return Cn.currentTarget.setCustomValidity(""),$e(fe.id,br.coNumber,vn,"");const Fn=Number(In);if(Number.isFinite(Fn)){if(Fn>br.expMax){Cn.currentTarget.setCustomValidity(`Max mark is ${br.expMax}`),Cn.currentTarget.reportValidity(),window.setTimeout(()=>Cn.currentTarget.setCustomValidity(""),0);return}Cn.currentTarget.setCustomValidity(""),$e(fe.id,br.coNumber,vn,Fn)}},style:Rr,min:0,max:br.expMax,disabled:_t})},`m_${fe.id}_${br.coNumber}_${vn}`))}),a.jsx("td",{style:{...dt,width:ri,minWidth:0,textAlign:"right",fontWeight:800},children:dr==null?"":dr.toFixed(1)}),qt?a.jsx(a.Fragment,{children:Ve?Kt.map(br=>{const Mr=Number(_d[br.coNumber]||0),un=qr[String(br.coNumber)]??"";return a.jsx("td",{style:{...dt,width:66,minWidth:0,padding:"2px 2px",background:"#fff7ed"},children:a.jsx("input",{type:"number",value:un,onChange:kn=>{const vn=kn.target.value;if(vn==="")return kn.currentTarget.setCustomValidity(""),Zt(fe.id,br.coNumber,"");const Cn=Number(vn);if(Number.isFinite(Cn)){if(Cn>Mr){kn.currentTarget.setCustomValidity(`Max mark is ${Mr}`),kn.currentTarget.reportValidity(),window.setTimeout(()=>kn.currentTarget.setCustomValidity(""),0);return}kn.currentTarget.setCustomValidity(""),Zt(fe.id,br.coNumber,Cn)}},style:Rr,min:0,max:Mr,step:.1,disabled:_t})},`lab_cia_${fe.id}_${br.coNumber}`)}):null}):Ve?zr?Bt>0?ut.map(br=>{const Mr=Number(wp[br.coNumber]||0),un=Ar[String(br.coNumber)]??"";return a.jsx("td",{style:{...dt,width:66,minWidth:0,padding:"2px 2px",background:"#fff7ed"},children:a.jsx("input",{type:"number",value:un,onChange:kn=>{const vn=kn.target.value;if(vn==="")return kn.currentTarget.setCustomValidity(""),It(fe.id,br.coNumber,"");const Cn=Number(vn);if(Number.isFinite(Cn)){if(Cn>Mr){kn.currentTarget.setCustomValidity(`Max mark is ${Mr}`),kn.currentTarget.reportValidity(),window.setTimeout(()=>kn.currentTarget.setCustomValidity(""),0);return}kn.currentTarget.setCustomValidity(""),It(fe.id,br.coNumber,Cn)}},style:Rr,min:0,max:Mr,disabled:_t})},`caa_${fe.id}_${br.coNumber}`)}):a.jsx("td",{style:{...dt,textAlign:"center",color:"#6b7280"},children:""}):a.jsx("td",{style:{...dt,width:M,minWidth:0,padding:"2px 2px",background:"#fff7ed"},children:a.jsx("input",{type:"number",value:(Ke==null?void 0:Ke.ciaExam)??"",onChange:br=>{const Mr=br.target.value;if(Mr==="")return br.currentTarget.setCustomValidity(""),kt(fe.id,"");const un=Number(Mr);if(Number.isFinite(un)){if(un>Rt){br.currentTarget.setCustomValidity(`Max mark is ${Rt}`),br.currentTarget.reportValidity(),window.setTimeout(()=>br.currentTarget.setCustomValidity(""),0);return}br.currentTarget.setCustomValidity(""),kt(fe.id,un)}},style:Rr,min:0,max:Rt,disabled:_t})}):null,et?jr.map(br=>a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...dt,textAlign:"right"},children:br.mark==null?"":br.mark.toFixed(1)}),a.jsx("td",{style:{...dt,textAlign:"right"},children:Kb(br.mark,br.coMax)})]},`coattrow_${fe.id}_${br.coNumber}`)):a.jsxs(a.Fragment,{children:[a.jsx("td",{style:{...dt,textAlign:"right"}}),a.jsx("td",{style:{...dt,textAlign:"right"}})]}),ve.map(br=>{const Mr=Qr[br]??null;return a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...dt,textAlign:"right"},children:Mr==null?"":Mr.toFixed(1)}),a.jsx("td",{style:{...dt,textAlign:"right"},children:Kb(Mr,nt||na)})]},`btlcell_${fe.id}_${br}`)})]},fe.id)}),b.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:at,style:{padding:10,color:"#6b7280"},children:"No students."})})]})]}),_t&&!vt&&!g?a.jsx("div",{style:{position:"absolute",inset:0,zIndex:30,pointerEvents:"auto",background:"linear-gradient(180deg, rgba(72, 113, 195, 0.92) 0%, rgba(51, 55, 64, 0.96) 100%)"}}):null,vt&&!g?a.jsx("div",{style:{position:"absolute",inset:0,zIndex:30,pointerEvents:"auto",background:"linear-gradient(180deg, rgba(34,197,94,0.28) 0%, rgba(16,185,129,0.36) 100%)"}}):null,_t&&!vt&&!g&&!y?a.jsxs("div",{style:Pn,children:[a.jsx("div",{style:{width:100,height:72,display:"grid",placeItems:"center",background:"#fff",borderRadius:8},children:a.jsx("img",{id:"mark-manager-float-gif",src:"https://media.lordicon.com/icons/wired/flat/94-lock-unlock.gif",alt:"gif",style:{maxWidth:72,maxHeight:72,display:"block"},onError:fe=>{console.warn("Failed to load lock GIF:",fe.currentTarget.src),fe.currentTarget.onerror=null,fe.currentTarget.src="data:image/svg+xml;utf8,"+encodeURIComponent('<svg xmlns="https://media.lordicon.com/icons/wired/flat/94-lock-unlock.gif" width="72" height="72" viewBox="0 0 24 24" fill="none" stroke="#0f172a" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="10" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>')}})}),a.jsxs("div",{style:{textAlign:"center"},children:[a.jsx("div",{style:{fontWeight:800,color:"#111827"},children:"Table Locked"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Confirm the Mark Manager"})]}),a.jsx("div",{style:{display:"flex",gap:8,marginTop:4}})]}):null,vt&&!g&&!y?a.jsxs("div",{style:Pn,children:[a.jsxs("div",{style:{textAlign:"center"},children:[a.jsx("div",{style:{fontWeight:950,color:"#065f46"},children:"Published  Locked"}),a.jsx("div",{style:{fontSize:13,color:"#065f46"},children:"Table is locked. Request IQAC approval to edit."})]}),a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center"},children:[a.jsx("button",{type:"button",className:"obe-btn",onClick:()=>C(!0),children:"View"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-success",disabled:De,onClick:async()=>{if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}ie(!0)},children:De?"Request Pending":"Request Edit"})]}),a.jsx("div",{style:{width:170,height:92,display:"grid",placeItems:"center",background:"#fff",borderRadius:10,border:"1px solid rgba(2,6,23,0.08)"},children:a.jsx("img",{id:"published-lock-image",src:new URL("/assets/lockong-CpAqbAhU.png",import.meta.url).toString(),alt:"locked",style:{maxWidth:150,maxHeight:80,display:"block"},onError:fe=>{fe.currentTarget.onerror=null,fe.currentTarget.src="https://media.lordicon.com/icons/wired/flat/1103-check-mark.gif"}})})]}):null]})})}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280",display:"flex",gap:18,flexWrap:"wrap"},children:[E?a.jsxs("div",{children:["Draft saved: ",E,B?a.jsxs("span",{style:{marginLeft:8,color:"#374151"},children:["by ",a.jsx("strong",{children:B})]}):null]}):null,de?a.jsxs("div",{children:["Last published: ",de]}):null]}),Ee?a.jsx(xs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:50},onClick:()=>{Xe||ze(null)},children:a.jsxs("div",{style:{width:"min(760px, 96vw)",maxHeight:"90vh",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:fe=>fe.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:Ee.mode==="confirm"?`Confirmation - ${n}`:`Request Edit - ${n}`}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:r.toUpperCase()})]}),Ee.mode==="confirm"?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"Confirm the selected COs and their settings. After confirming, the Mark Manager box will be locked."}),a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"CO"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:lt}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Max marks"})]})}),a.jsxs("tbody",{children:[Object.entries(Gt).filter(([fe,xe])=>Or.has(String(fe))&&!!(xe!=null&&xe.enabled)).map(([fe,xe])=>({co:Hr(Number(fe),1,5),expCount:Hr(Number((xe==null?void 0:xe.expCount)??0),0,12),expMax:Hr(Number((xe==null?void 0:xe.expMax)??0),0,100)})).sort((fe,xe)=>fe.co-xe.co).map(fe=>a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:["CO-",fe.co]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:fe.expCount}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:fe.expMax})]},fe.co)),Object.entries(Gt).filter(([fe,xe])=>Or.has(String(fe))&&!!(xe!=null&&xe.enabled)).length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:3,style:{padding:10,color:"#6b7280"},children:"No COs selected."})}):null,wt?a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"CIA Exam"}),a.jsx("td",{colSpan:2,style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:Ve?"Enabled":"Disabled"})]}):null]})]})})]}):a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. The Mark Manager will remain locked until IQAC approves."}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[a.jsx("button",{className:"obe-btn",disabled:Xe,onClick:()=>ze(null),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:rt?De:!e||U||_t||Wt||!Pr,onClick:async()=>{if(!e)return;if(Ee.mode==="request"){Pt(!0),He(null);try{const xe=W,Ke=Gt;if(xe&&xe.sheet&&xe.sheet.coConfigs){const Fe=we(Ot(xe.sheet),Ke),gt=Ie(xe.sheet.rowsByStudentId,[...Fe.removed,...Fe.changed]);if((Fe.removed.length||Fe.changed.length||Fe.added.length)&&gt>0){he({visible:!0,diff:Fe,affected:gt,mode:"request"}),Pt(!1);return}}ze(null),await ct()}finally{Pt(!1)}return}const fe=Nt(xt.sheet.markManagerSnapshot??null);if(fe){const xe=pr(fe),Ke=pr(Gt),Fe=xe.filter(gt=>!Ke.includes(gt));if(Fe.length){const gt=Hr(Number(i??1),1,5),dr=s==null?null:Hr(Number(s),1,5),Ft=er(xt.sheet.rowsByStudentId,Fe,gt,dr);ht({visible:!0,removed:Fe,affected:Ft});return}}await $t("none")},children:Ee.mode==="confirm"?"Confirm":"Send Request"})]})]})})}):null,Se&&Se.visible?a.jsx(xs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:90},onClick:()=>{Xe||he(null)},children:a.jsxs("div",{style:{width:"min(640px, 96vw)",background:"#fff",borderRadius:12,padding:14,border:"1px solid #e5e7eb"},onClick:fe=>fe.stopPropagation(),children:[a.jsx("div",{style:{fontWeight:900,marginBottom:8},children:"Mark Manager conflict with published marks"}),a.jsxs("div",{style:{color:"#374151",marginBottom:12},children:["The selected CO settings differ from the published mark sheet. ",Se.affected," student rows contain marks that may be lost."]}),a.jsxs("div",{style:{fontSize:13,color:"#374151",marginBottom:12},children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Added COs:"})," ",Se.diff.added.join(", ")||""]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Removed COs:"})," ",Se.diff.removed.join(", ")||""]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Changed COs:"})," ",Se.diff.changed.join(", ")||""]})]}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[a.jsx("button",{className:"obe-btn",onClick:()=>he(null),disabled:Xe,children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-danger",disabled:Xe,onClick:async()=>{if(e){Pt(!0);try{const fe=xt,xe=Object.fromEntries(Object.entries(fe.sheet.rowsByStudentId||{}).map(([Fe,gt])=>{var Qr;const dr=gt&&typeof gt=="object"?gt:{},Ft=Hr(Number(fe.sheet.expCountA??Mi),0,12),jr=Hr(Number(fe.sheet.expCountB??0),0,12),Ar={...dr};Ar.marksA=Array.from({length:Ft},()=>""),Ar.marksB=Array.from({length:jr},()=>""),Ar.caaExamByCo={},Ar.ciaExamByCo={},Ar.ciaExam="";const qr=Ar.marksByCo&&typeof Ar.marksByCo=="object"?{...Ar.marksByCo}:{};for(const Ur of[...Se.diff.removed.map(String),...Se.diff.changed.map(String)])qr[Ur]&&(qr[Ur]=Array.from({length:((Qr=Gt[Ur])==null?void 0:Qr.expCount)??0},()=>""));return Ar.marksByCo=qr,[Fe,Ar]})),Ke={sheet:{...fe.sheet,rowsByStudentId:xe}};if(Dt(Ke),await Ri(r,String(e),Ke),T(new Date().toLocaleString()),Se.mode==="request")he(null),ze(null),await ct();else{try{await dh(r,String(e),t),Mt({silent:!0})}catch(Fe){console.warn("confirmMarkManagerLock failed after reset",Fe)}he(null)}}catch(fe){alert((fe==null?void 0:fe.message)||"Failed to reset marks")}finally{Pt(!1)}}},children:"Reset & Continue"})]})]})})}):null,ye&&ye.visible?a.jsx(xs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:95},onClick:()=>{Xe||ht(null)},children:a.jsxs("div",{style:{width:"min(660px, 96vw)",background:"#fff",borderRadius:12,padding:14,border:"1px solid #e5e7eb"},onClick:fe=>fe.stopPropagation(),children:[a.jsx("div",{style:{fontWeight:900,marginBottom:8},children:ye.removed.length===1?`Shall I reset the CO${ye.removed[0]} column?`:"Shall I reset the removed CO columns?"}),a.jsxs("div",{style:{color:"#374151",marginBottom:10},children:["The new Mark Manager selection removed old COs.",ye.affected>0?` ${ye.affected} student rows contain marks in these columns.`:" No marks were found in these columns."]}),a.jsx("div",{style:{fontSize:13,color:"#374151",marginBottom:12},children:a.jsxs("div",{children:[a.jsx("strong",{children:"Removed COs:"})," ",ye.removed.join(", ")||""]})}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[a.jsx("button",{className:"obe-btn",onClick:()=>ht(null),disabled:Xe,children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-primary",disabled:Xe,onClick:async()=>{const fe=ye.removed;ht(null),await $t("partial",fe)},children:ye.removed.length===1?`Reset CO${ye.removed[0]} column`:"Reset removed CO columns"}),a.jsx("button",{className:"obe-btn obe-btn-danger",disabled:Xe,onClick:async()=>{ht(null),await $t("full")},children:"Reset full data"})]})]})})}):null,G?a.jsx(xs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>{R||ie(!1)},children:a.jsxs("div",{style:{width:"min(560px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:fe=>fe.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[String(r).toUpperCase()," LAB"]})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",We?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{fontSize:13,color:"#374151",marginBottom:10,lineHeight:1.35},children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Subject:"})," ",n]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Code:"})," ",String(e||"")]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Published:"})," ",de||""]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Saved:"})," ",E||""]})]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:K,onChange:fe=>H(fe.target.value),placeholder:"Explain why you need to edit (required)",rows:4,className:"obe-input",style:{resize:"vertical"}})]}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:12},children:[a.jsx("button",{type:"button",className:"obe-btn",disabled:R,onClick:()=>ie(!1),children:"Cancel"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-success",disabled:R||De||!e||!String(K||"").trim(),onClick:fn,title:De?"Request pending (up to 24 hours)":void 0,children:R?"Requesting":De?"Request Pending":"Send Request"})]})]})})}):null,Y?a.jsx(xs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:70},onClick:()=>C(!1),children:a.jsxs("div",{style:{width:"min(1100px, 96vw)",maxHeight:"min(80vh, 900px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:fe=>fe.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10,position:"relative"},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Only"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280",marginRight:36},children:[n,"  ",String(e||"")]}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-success",onClick:()=>C(!1),style:{position:"absolute",right:0,top:0},children:"Close"})]}),I?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading published marks"}):null,me?a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:me}):null,a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12,position:"relative"},children:(()=>{const fe=3+Ct+1+Jt+ar+ve.length*2;return a.jsxs("table",{className:"obe-table",style:{width:"100%",minWidth:At,tableLayout:"fixed",borderCollapse:"collapse"},children:[yr(fe,!1,Le),a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsx("th",{style:Re,colSpan:fe,children:n})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...Re,...lr(0,tn)},rowSpan:5,children:"S.No"}),a.jsx("th",{style:{...Re,...lr(tn,_n)},rowSpan:5,children:"R.No"}),a.jsx("th",{style:{...Re,...lr(tn+_n,zn),textAlign:"left"},rowSpan:5,children:"Name of the Students"}),a.jsx("th",{style:Re,colSpan:Ct,children:"Experiments"}),a.jsx("th",{style:{...Re,width:ri,minWidth:ri,maxWidth:ri},rowSpan:5,children:"AVG"}),qt?a.jsx(a.Fragment,{children:Ve&&Kt.length>0?a.jsx("th",{style:Re,colSpan:Kt.length,children:"CIA EXAM"}):null}):Ve?zr?a.jsx("th",{style:Re,colSpan:Math.max(Bt,1),children:"CIA EXAM"}):a.jsx("th",{style:{...Re,width:M,minWidth:M,maxWidth:M,overflow:"visible",textOverflow:"clip"},rowSpan:5,title:"CIA Exam",children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:2,lineHeight:1.05},children:[a.jsx("div",{style:{whiteSpace:"pre-line"},children:`CIA
EXAM`}),Zr?a.jsx("div",{style:{fontSize:12,fontWeight:900},children:Rt}):null]})}):null,a.jsx("th",{style:Re,colSpan:ar,children:"CO ATTAINMENT"}),ve.length?a.jsx("th",{style:Re,colSpan:ve.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[Ue===0?a.jsx("th",{style:Re,children:""}):a.jsx(a.Fragment,{children:Xt.map(xe=>Array.from({length:xe.expCount},(Ke,Fe)=>a.jsx("th",{style:Re,children:xe.coNumber},`co_view_${xe.coNumber}_${Fe}`)))}),qt?a.jsx(a.Fragment,{children:Ve?Kt.map(xe=>a.jsxs("th",{style:Re,children:["CO-",xe.coNumber]},`lab_cia_co_view_${xe.coNumber}`)):null}):Ve&&zr?Bt>0?ut.map(xe=>a.jsxs("th",{style:Re,children:["CO-",xe.coNumber]},`caa_co_view_${xe.coNumber}`)):a.jsx("th",{style:Re,children:""}):null,et?Xt.map(xe=>a.jsxs("th",{style:Re,colSpan:2,children:["CO-",xe.coNumber]},`coatt_view_${xe.coNumber}`)):a.jsx("th",{style:Re,colSpan:2,children:""}),ve.map(xe=>a.jsxs("th",{style:Re,colSpan:2,children:["BTL-",xe]},`btl_view_${xe}`))]}),a.jsxs("tr",{children:[Ue===0?a.jsx("th",{style:Re,children:""}):a.jsx(a.Fragment,{children:Xt.map(xe=>Array.from({length:xe.expCount},(Ke,Fe)=>a.jsx("th",{style:Re,children:xe.expMax},`max_view_${xe.coNumber}_${Fe}`)))}),qt?a.jsx(a.Fragment,{children:Ve?Kt.map(xe=>a.jsx("th",{style:Re,children:_d[xe.coNumber]??0},`lab_cia_max_view_${xe.coNumber}`)):null}):Ve&&zr?Bt>0?ut.map(xe=>a.jsx("th",{style:Re,children:wp[xe.coNumber]??0},`caa_max_view_${xe.coNumber}`)):a.jsx("th",{style:Re,children:""}):null,et?Xt.map(xe=>{const Ke=qt?Lh(Number(Rk[xe.coNumber]||0)+(Ve?Number(_d[xe.coNumber]||0):0)):(()=>{const Fe=Number(Lk[xe.coNumber]||0);return zr&&Fe>0?Fe:Zr?12:xe.expMax+(Ve?Rt/2:0)})();return a.jsxs(on.Fragment,{children:[a.jsx("th",{style:Re,children:Ke}),a.jsx("th",{style:Re,children:"%"})]},`comax_view_${xe.coNumber}`)}):a.jsxs(a.Fragment,{children:[a.jsx("th",{style:Re,children:""}),a.jsx("th",{style:Re,children:"%"})]}),ve.map(xe=>a.jsxs(on.Fragment,{children:[a.jsx("th",{style:Re,children:nt||na}),a.jsx("th",{style:Re,children:"%"})]},`btlmax_view_${xe}`))]}),a.jsxs("tr",{children:[Ue===0?a.jsx("th",{style:Re,children:"No experiments"}):a.jsx(a.Fragment,{children:Xt.map(xe=>Array.from({length:xe.expCount},(Ke,Fe)=>a.jsxs("th",{style:Re,children:["E",Fe+1]},`e_view_${xe.coNumber}_${Fe}`)))}),a.jsx("th",{style:Re,colSpan:ar+ve.length*2+Jt})]}),a.jsxs("tr",{children:[Ue===0?a.jsx("th",{style:Re,children:"BTL"}):a.jsx(a.Fragment,{children:Xt.map(xe=>Array.from({length:xe.expCount},(Ke,Fe)=>a.jsx("th",{style:Re,children:xe.btl[Fe]||1},`btlhdr_view_${xe.coNumber}_${Fe}`)))}),a.jsx("th",{style:Re,colSpan:ar+ve.length*2+Jt})]})]}),a.jsxs("tbody",{children:[b.map((xe,Ke)=>{var br,Mr;const Fe=W&&W.sheet?W.sheet:xt.sheet,gt=(br=Fe==null?void 0:Fe.rowsByStudentId)==null?void 0:br[String(xe.id)],dr=Ht(gt,Xt),Ft=dr.flatMap(un=>un.marks),jr=Gb(Ft),Ar=Pe(gt,dr),qr=et?Ar.coAttainmentValues:[],Qr=Ar.caaByCo,Ur=Ar.ciaByCo,Xr={};for(const un of ve){const kn=[];for(const vn of Xt){const Cn=((Mr=dr.find(In=>In.coNumber===vn.coNumber))==null?void 0:Mr.marks)??[];for(let In=0;In<Math.min(vn.expCount,Cn.length);In++)if(vn.btl[In]===un){const Fn=Cn[In];typeof Fn=="number"&&Number.isFinite(Fn)&&kn.push(Fn)}}Xr[un]=kn.length?kn.reduce((vn,Cn)=>vn+Cn,0)/kn.length:null}return a.jsxs("tr",{children:[a.jsx("td",{style:{...dt,...nr(0,tn),textAlign:"center"},children:Ke+1}),a.jsx("td",{style:{...dt,...nr(tn,_n)},title:String(xe.reg_no||""),children:TM(xe.reg_no,7)}),a.jsx("td",{style:{...dt,...nr(tn+_n,zn)},title:String(xe.name||""),children:a.jsx("span",{style:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:String(xe.name||"")})}),Ue===0?a.jsx("td",{style:{...dt,textAlign:"center",color:"#6b7280"},children:""}):Xt.map(un=>{var vn;const kn=((vn=dr.find(Cn=>Cn.coNumber===un.coNumber))==null?void 0:vn.marks)??[];return Array.from({length:un.expCount},(Cn,In)=>a.jsx("td",{style:{...dt,width:38,minWidth:0,padding:"2px 2px",background:"#fff7ed",textAlign:"center",fontWeight:800},children:kn[In]??""},`view_m_${xe.id}_${un.coNumber}_${In}`))}),a.jsx("td",{style:{...dt,width:ri,minWidth:0,textAlign:"right",fontWeight:800},children:jr==null?"":jr.toFixed(1)}),qt?a.jsx(a.Fragment,{children:Ve?Kt.map(un=>a.jsx("td",{style:{...dt,width:66,minWidth:0,padding:"2px 2px",background:"#fff7ed",textAlign:"center",fontWeight:800},children:Ur[String(un.coNumber)]??""},`view_lab_cia_${xe.id}_${un.coNumber}`)):null}):Ve?zr?Bt>0?ut.map(un=>a.jsx("td",{style:{...dt,width:66,minWidth:0,padding:"2px 2px",background:"#fff7ed",textAlign:"center",fontWeight:800},children:Qr[String(un.coNumber)]??""},`view_caa_${xe.id}_${un.coNumber}`)):a.jsx("td",{style:{...dt,textAlign:"center",color:"#6b7280"},children:""}):a.jsx("td",{style:{...dt,width:M,minWidth:0,padding:"2px 2px",background:"#fff7ed",textAlign:"center",fontWeight:800},children:(gt==null?void 0:gt.ciaExam)??""}):null,et?qr.map(un=>a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...dt,textAlign:"right"},children:un.mark==null?"":un.mark.toFixed(1)}),a.jsx("td",{style:{...dt,textAlign:"right"},children:Kb(un.mark,un.coMax)})]},`view_coatt_${xe.id}_${un.coNumber}`)):a.jsxs(a.Fragment,{children:[a.jsx("td",{style:{...dt,textAlign:"right"}}),a.jsx("td",{style:{...dt,textAlign:"right"}})]}),ve.map(un=>{const kn=Xr[un]??null;return a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...dt,textAlign:"right"},children:kn==null?"":kn.toFixed(1)}),a.jsx("td",{style:{...dt,textAlign:"right"},children:Kb(kn,nt||na)})]},`view_btl_${xe.id}_${un}`)})]},`view_${xe.id}`)}),b.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:at,style:{padding:10,color:"#6b7280"},children:"No students."})}):null]})]})})()}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{type:"button",className:"obe-btn",onClick:()=>C(!1),children:"Close"})})]})})}):null]})}const Mxe=[{key:"q1",label:"Q1",max:2},{key:"q2",label:"Q2",max:2},{key:"q3",label:"Q3",max:2},{key:"q4",label:"Q4",max:2},{key:"q5",label:"Q5",max:2},{key:"q6",label:"Q6",max:2},{key:"q7",label:"Q7",max:16},{key:"q8",label:"Q8",max:16},{key:"q9",label:"Q9",max:16}];function Xb(e){return String(e||"").trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_-]/g,"").slice(0,48)}function Lxe(e,t){if(!t.length)return;const r=Object.keys(t[0]),n=[r.join(",")].concat(t.map(l=>r.map(c=>{const u=l[c],d=String(u??"").replace(/\n/g," ");return d.includes(",")||d.includes('"')?`"${d.replace(/"/g,'""')}"`:d}).join(","))).join(`
`),i=new Blob([n],{type:"text/csv"}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function Rxe(e){return String(e??"").trim().toLowerCase().replace(/\s+/g," ")}function Fxe({subjectId:e,classType:t,teachingAssignmentId:r,questionPaperType:n}){const i=x.useMemo(()=>[1,2,3,4,5,6],[]),s=ve=>{const at=String(ve??"AL").trim().toUpperCase();return at==="ML"||at==="MALPRACTICE"?"ML":at==="SKL"||at==="SICK"||at==="SICKLEAVE"||at==="SL"?"SKL":"AL"},o={border:"1px solid #111",padding:"4px 4px",background:"#ecfdf5",color:"#065f46",textAlign:"center",fontWeight:700,fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},l={border:"1px solid #111",padding:"4px 4px",fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},c=32,[u,d]=x.useState([]),[f,h]=x.useState(!1),[p,m]=x.useState(null),[g,y]=x.useState(null),[b,v]=x.useState(!1),[w,S]=x.useState(!1),[k,j]=x.useState(!1),[A,L]=x.useState(null),[P,F]=x.useState(null),[E,T]=x.useState(null),[B,q]=x.useState(null),[U,se]=x.useState(!1),[de,z]=x.useState(null),G=x.useRef(!1),[ie,Y]=x.useState(!1),C=x.useRef(!1),[K,H]=x.useState(!1),[R,J]=x.useState(null),[V,X]=x.useState(null),[Q,ne]=x.useState({}),[oe,O]=x.useState({}),[W,ae]=x.useState(null),[I,Z]=x.useState(""),[me,Te]=x.useState(!1),[Ae,Be]=x.useState(null),[Ee,ze]=x.useState(!1),[Xe,Pt]=x.useState(""),[ft,He]=x.useState(!1),[tt,_e]=x.useState(!1),Se=x.useRef(null),[he,ye]=x.useState(!1),ht=x.useMemo(()=>ti(t),[t]),Ge=ht==="THEORY",lt=ht==="TCPL"||ht==="TCPR",jt=ht==="TCPR"?"TCPR":"TCPL",{data:wt,loading:yt,error:Fr,remainingSeconds:Tt,publishAllowed:hr,refresh:rn}=V0({assessment:"model",subjectCode:e,teachingAssignmentId:r}),{data:en,refresh:$r}=G0({assessment:"model",subjectCode:String(e||""),teachingAssignmentId:r,options:{poll:!1}}),{data:Kr,refresh:Rn}=oc({assessment:"model",subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:r,options:{poll:!1}}),Pr=!!E||!!(en!=null&&en.exists&&(en!=null&&en.is_published))||!!B,Sn=!!(Kr!=null&&Kr.allowed_by_approval),Me=Pr?Sn:!0,je=!!(Pr&&!Sn),Mt=!!(Pr&&je),{pending:pt,pendingUntilMs:Ut,setPendingUntilMs:ir,refresh:fr}=K0({enabled:!!Mt&&!!e,assessment:"model",subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:r});Y0(!!Ee);const vr=!!(wt!=null&&wt.global_override_active&&(wt==null?void 0:wt.global_is_open)===!1),re=!!(vr||Pr&&!Me);x.useEffect(()=>{_e(!1)},[e,r,je]);const le=x.useMemo(()=>`model_qp_type_${e}_${String(r??"none")}`,[e,r]),[te,ue]=x.useState("");x.useEffect(()=>{const ve=Rr=>{const nn=String(Rr??"").trim().toUpperCase();return nn==="QP2"?"QP2":nn==="QP1"?"QP1":""},at=ve(n);if(at){ue(at);try{Kn(le,at)}catch{}return}const Re=Jn(le),dt=ve(Re);ue(dt||"QP1")},[le,n]);const Ne=String(te??"").trim().toUpperCase();x.useEffect(()=>{let ve=!0;return(async()=>{var nn;let Re=String(ht||"").trim().toUpperCase();if(Re.startsWith("THEORY")&&(Re="THEORY"),!Re){ae(null);return}const dt=Ne==="QP2"?"QP2":Ne==="QP1"?"QP1":"",Rr=Re==="THEORY"&&dt||null;try{const tn=await ah({class_type:Re,question_paper_type:Rr,exam:"MODEL"}),_n=Array.isArray((nn=tn==null?void 0:tn.pattern)==null?void 0:nn.marks)?tn.pattern.marks:[];if(!ve)return;ae(_n.length?tn.pattern:null)}catch{if(!ve)return;ae(null)}})(),()=>{ve=!1}},[ht,Ne]);const ke=x.useMemo(()=>{const ve=Array.isArray(W==null?void 0:W.marks)?W.marks:null;return Array.isArray(ve)&&ve.length?ve.map((at,Re)=>({key:`q${Re+1}`,label:`Q${Re+1}`,max:Number(at)||0})):Mxe},[W]),vt=4+ke.length+1+4+i.length*2,rt=lt?Q||{}:oe||{},De={width:"100%",border:"none",outline:"none",background:"transparent",padding:0,margin:0,fontSize:11,textAlign:"center"},We=async ve=>{const at=!!(ve!=null&&ve.silent);if(!r){d([]),at||m(null);return}at||h(!0),at||m(null);try{try{const nn=await xr(`/api/academics/teaching-assignments/${r}/`);if(nn.ok){const tn=await nn.json();if(tn&&tn.elective_subject_id&&!tn.section_id){const _n=await xr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(tn.elective_subject_id))}`);if(!_n.ok)throw new Error(`Elective-choices fetch failed: ${_n.status}`);const zn=await _n.json(),M=((Array.isArray(zn.results)?zn.results:Array.isArray(zn)?zn:zn.items||[])||[]).map(ce=>({id:Number(ce.student_id??ce.id),reg_no:String(ce.reg_no??ce.registration_no??ce.regno??""),name:String(ce.name??ce.full_name??ce.username??""),section:ce.section_name??ce.section??null})).filter(ce=>Number.isFinite(ce.id)).sort((ce,Le)=>String(ce.name||"").localeCompare(String(Le.name||"")));d(M);return}}}catch{}const Re=await Vc(r),Rr=[...(Re==null?void 0:Re.students)||[]].sort((nn,tn)=>String(nn.name||"").localeCompare(String(tn.name||"")));d(Rr)}catch(Re){d([]),at||m((Re==null?void 0:Re.message)||"Failed to load roster")}finally{at||h(!1)}};x.useEffect(()=>{We()},[r]);const st=()=>({version:1,qpType:String(te??""),classType:String(ht??""),tcplLikeKind:jt,theoryQuestionBtl:et||{},tcplQuestionBtl:Ot||{},theorySheet:oe||{},tcplSheet:Q||{}}),zt=ve=>{if(!ve||typeof ve!="object")return;C.current=!0;const at=typeof ve.qpType=="string"?ve.qpType:null;if(at!=null){const dt=String(at||"").trim().toUpperCase()==="QP2"?"QP2":"QP1";ue(dt);try{Kn(le,dt)}catch{}}if(ve.theoryQuestionBtl&&typeof ve.theoryQuestionBtl=="object"){ut({...Ct,...ve.theoryQuestionBtl});try{Kn(Ue,{...Ct,...ve.theoryQuestionBtl})}catch{}}if(ve.tcplQuestionBtl&&typeof ve.tcplQuestionBtl=="object"){mt({...Pe,...ve.tcplQuestionBtl});try{Kn(Ht,{...Pe,...ve.tcplQuestionBtl})}catch{}}if(ve.tcplSheet&&typeof ve.tcplSheet=="object"){ne(ve.tcplSheet);try{Kn(er,ve.tcplSheet)}catch{}}if(ve.theorySheet&&typeof ve.theorySheet=="object"){O(ve.theorySheet);try{Kn(pr,ve.theorySheet)}catch{}}window.setTimeout(()=>{C.current=!1},0)},Wt=async ve=>{if(!e)return;const at=!!(ve!=null&&ve.silent);at||j(!0),at||y(null);try{const Re=await ei("model",e,r);Re!=null&&Re.draft&&zt(Re.draft),L(Re!=null&&Re.updated_at?new Date(Re.updated_at).toLocaleString():null);const dt=Re==null?void 0:Re.updated_by;F(typeof(dt==null?void 0:dt.name)=="string"?dt.name:typeof(dt==null?void 0:dt.username)=="string"?dt.username:null)}catch(Re){at||y((Re==null?void 0:Re.message)||"Failed to refresh draft")}finally{at||j(!1)}};x.useEffect(()=>{Y(!1);let ve=!0;return(async()=>{try{await Wt({silent:!0})}finally{ve&&Y(!0)}})(),()=>{ve=!1}},[e,r]);const xt=async()=>{if(e){v(!0),y(null);try{await Ri("model",e,st()),L(new Date().toLocaleString())}catch(ve){y((ve==null?void 0:ve.message)||"Draft save failed")}finally{v(!1)}}};x.useEffect(()=>{const ve=()=>{!e||je||Ri("model",e,st()).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",ve),()=>window.removeEventListener("obe:before-tab-switch",ve)},[e,je]);const Dt=async()=>{if(e){if(Pr){if(je){if(pt){y("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}ze(!0);return}y("Editing is already open for this published sheet.");return}if(vr){y("Publishing is locked by IQAC.");return}if(!hr){y("Publish window is closed. Please request IQAC approval.");return}S(!0),y(null);try{await O9(e,st(),r),T(new Date().toLocaleString()),await sr(!1),rn({silent:!0}),$r({silent:!0});try{window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:"model"}}))}catch{}}catch(ve){y((ve==null?void 0:ve.message)||"Publish failed")}finally{S(!1)}}},Vt=async()=>{if(e){Te(!0),Be(null),y(null);try{await _h({assessment:"model",subject_code:e,reason:I,teaching_assignment_id:r}),Be("Request sent to IQAC for approval.")}catch(ve){y((ve==null?void 0:ve.message)||"Failed to request approval")}finally{Te(!1),rn({silent:!0})}}},gr=async()=>{if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}if(pt){y("Edit request is pending. Please wait for approval.");return}const at=String(Xe||"").trim();if(!at){y("Reason is required.");return}He(!0),y(null);try{const Re=await il({assessment:"model",subject_code:String(e),scope:"MARK_ENTRY",reason:at,teaching_assignment_id:r});alert(al(Re)),ze(!1),Pt(""),ir(Date.now()+24*60*60*1e3);try{fr({silent:!0})}catch{}$r({silent:!0}),Rn({silent:!0})}catch(Re){const dt=sl(Re,"Failed to request edit");y(dt),alert(`Edit request failed: ${dt}`)}finally{He(!1)}};async function sr(ve,at){if(e){ve&&se(!0),z(null);try{const Re=await Rm(String(e),r),dt=(Re==null?void 0:Re.data)??null;!!(dt&&typeof dt=="object"&&Number(dt.version)===1&&(typeof dt.classType=="string"||typeof dt.qpType=="string")&&("theorySheet"in dt||"tcplSheet"in dt))?(q(dt),(at!=null&&at.applyToMain||je)&&zt(dt)):(q(null),(ve||at!=null&&at.applyToMain)&&z("No published snapshot found."))}catch(Re){(ve||at!=null&&at.applyToMain)&&z((Re==null?void 0:Re.message)||"Failed to load published sheet")}finally{ve&&se(!1)}}}x.useEffect(()=>{e&&sr(!1)},[e,r]),x.useEffect(()=>{if(e){if(!je){G.current=!1;return}if(!G.current){if(G.current=!0,B&&typeof B=="object"){zt(B);return}sr(!0,{applyToMain:!0})}}},[je,e,r]),x.useEffect(()=>{if(!e||!Pr||Me)return;const ve=window.setInterval(()=>{$r({silent:!0})},3e4);return()=>window.clearInterval(ve)},[Me,Pr,e,$r]);const Lr=x.useMemo(()=>u.length?u:Array.from({length:5},(ve,at)=>({id:-(at+1),reg_no:"",name:"",section:null})),[u]),Zr=x.useMemo(()=>Object.values(rt||{}).some(at=>!!(at!=null&&at.absent)),[rt]),Er=x.useMemo(()=>{const ve=Array.isArray(W==null?void 0:W.marks)?W.marks:null;if(Array.isArray(ve)&&ve.length&&lt)return ve.map((dt,Rr)=>({key:`q${Rr+1}`,label:`Q${Rr+1}`,max:Number(dt)||0}));const at=jt==="TCPR"?12:15,Re=jt==="TCPR"?8:10;return Array.from({length:at},(dt,Rr)=>{const nn=Rr+1;return{key:`q${nn}`,label:`Q${nn}`,max:nn<=Re?2:16}})},[jt,W,lt]),qt=x.useMemo(()=>Er.reduce((ve,at)=>ve+at.max,0),[Er]),zr=30,bn=jt==="TCPR",or=5,kr=bn?0:zr/or,Tr=jt==="TCPR"?"REVIEW":"LAB",Or=x.useMemo(()=>{const ve=Array.isArray(W==null?void 0:W.marks)?W.marks:null;return Array.isArray(ve)&&ve.length&&Ge?ve.map((at,Re)=>({key:`q${Re+1}`,label:`Q${Re+1}`,max:Number(at)||0})):[{key:"q1",label:"Q1",max:2},{key:"q2",label:"Q2",max:2},{key:"q3",label:"Q3",max:2},{key:"q4",label:"Q4",max:2},{key:"q5",label:"Q5",max:2},{key:"q6",label:"Q6",max:2},{key:"q7",label:"Q7",max:2},{key:"q8",label:"Q8",max:2},{key:"q9",label:"Q9",max:2},{key:"q10",label:"Q10",max:2},{key:"q11",label:"Q11",max:14},{key:"q12",label:"Q12",max:14},{key:"q13",label:"Q13",max:14},{key:"q14",label:"Q14",max:14},{key:"q15",label:"Q15",max:14},{key:"q16",label:"Q16",max:10}]},[W,Ge]),Gt=5,ur=x.useMemo(()=>Or.reduce((ve,at)=>ve+at.max,0),[Or]),Ve=x.useMemo(()=>{const ve=[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5,5],at=Array.isArray(W==null?void 0:W.cos)?W.cos:null;return Ge&&Array.isArray(at)&&at.length===Or.length?at.map(Re=>{const dt=Number(Re);return Number.isFinite(dt)?Math.max(1,Math.min(5,Math.trunc(dt))):1}):Or.length===ve.length?ve:Array.from({length:Or.length},(Re,dt)=>ve[dt%ve.length])},[W,Ge,Or.length]),Rt=x.useMemo(()=>{const ve=[2,2,3,3,3,2,2,3,3,3,4,4,3,3,3,5];return Or.length===ve.length?ve:Array.from({length:Or.length},(at,Re)=>ve[Re%ve.length])},[Or.length]),_t=x.useMemo(()=>{const ve=Array.from({length:Gt},()=>0);return Or.forEach((at,Re)=>{const dt=Ve[Re]??1;dt>=1&&dt<=Gt&&(ve[dt-1]+=at.max)}),ve},[Or,Ve]),Xt=x.useMemo(()=>_t,[_t]),Ue=x.useMemo(()=>`model_theory_questionBtl_${e}`,[e]),Ct=x.useMemo(()=>Object.fromEntries(Or.map((ve,at)=>{const Re=Rt[at];return[ve.key,typeof Re=="number"?Re:""]})),[Or,Rt]),[et,ut]=x.useState(Ct);x.useEffect(()=>{if(!Ge)return;const ve=Jn(Ue);ut(ve&&typeof ve=="object"?{...Ct,...ve}:Ct)},[Ge,Ue,Ct]);const Bt=(ve,at)=>{ut(Re=>{const dt={...Re||{},[ve]:at};return Kn(Ue,dt),dt})},Kt=x.useMemo(()=>Or.map((ve,at)=>{const Re=(et||{})[ve.key];if(Re===""||Re===1||Re===2||Re===3||Re===4||Re===5||Re===6)return Re;const dt=Rt[at];return typeof dt=="number"?dt:""}),[Or,et,Rt]),Jt=x.useMemo(()=>{const ve=[0,0,0,0,0,0];return Or.forEach((at,Re)=>{const dt=Kt[Re];typeof dt=="number"&&dt>=1&&dt<=6&&(ve[dt-1]+=at.max)}),ve},[Or,Kt]),ar=x.useMemo(()=>{const ve=jt==="TCPR"?[1,1,2,2,3,3,4,4,1,2,3,4]:[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5],at=Array.isArray(W==null?void 0:W.cos)?W.cos:null;return lt&&Array.isArray(at)&&at.length===Er.length?at.map(Re=>{const dt=Number(Re);return Number.isFinite(dt)?Math.max(1,Math.min(5,Math.trunc(dt))):1}):Er.length===ve.length?ve:Array.from({length:Er.length},(Re,dt)=>ve[dt%ve.length])},[W,lt,jt,Er.length]),nt=jt==="TCPR"?"tcpr":"tcpl",Ht=x.useMemo(()=>`model_${nt}_questionBtl_${e}`,[e,nt]),Pe=x.useMemo(()=>Object.fromEntries(Er.map(ve=>[ve.key,""])),[Er]),[Ot,mt]=x.useState(Pe);x.useEffect(()=>{if(!lt)return;const ve=Jn(Ht);mt(ve&&typeof ve=="object"?{...Pe,...ve}:Pe)},[lt,Ht,Pe]);const Nt=(ve,at)=>{mt(Re=>{const dt={...Re||{},[ve]:at};return Kn(Ht,dt),dt})},er=x.useMemo(()=>`model_${nt}_sheet_${e}_${String(r??"none")}`,[e,r,nt]);x.useEffect(()=>{if(!lt)return;const ve=Jn(er);ne(ve&&typeof ve=="object"?ve:{})},[lt,er]);const pr=x.useMemo(()=>`model_theory_sheet_${e}_${String(r??"none")}`,[e,r]);x.useEffect(()=>{if(lt)return;const ve=Jn(pr);O(ve&&typeof ve=="object"?ve:{})},[lt,pr]);const we=(ve,at)=>{ne(Re=>{const dt={...Re||{},[ve]:at};return Kn(er,dt),dt})},Ie=(ve,at)=>{O(Re=>{const dt={...Re||{},[ve]:at};return Kn(pr,dt),dt})},Ze=ve=>{if(lt){ne(ve),Kn(er,ve);return}O(ve),Kn(pr,ve)};x.useEffect(()=>{if(!ie||!e||je||C.current)return;let ve=!1;const at=window.setTimeout(async()=>{try{await Ri("model",e,st()),ve||L(new Date().toLocaleString())}catch{}},700);return()=>{ve=!0,window.clearTimeout(at)}},[ie,e,r,je,te,ht,et,Ot,oe,Q]);const bt=(ve,at)=>{const Re=String(ve??"");if(Re.trim()==="")return"";const dt=Number(Re);return Number.isFinite(dt)?Math.max(0,Math.min(at,dt)):""},St=ve=>{const Re=(Math.round((ve+Number.EPSILON)*10)/10).toFixed(1);return Re.endsWith(".0")?Re.slice(0,-2):Re},Sr=()=>lt?Er:Or,Yr=()=>{const ve=Sr(),at=(u||[]).map((dt,Rr)=>{const nn=Zt(dt,Rr),tn=(rt||{})[nn]||{},_n=tn.q&&typeof tn.q=="object"?tn.q:{},zn={sno:Rr+1,registerNo:String(dt.reg_no||""),name:String(dt.name||""),absent:tn.absent?"YES":"",absentKind:tn.absent?s(tn.absentKind):""};if(ve.forEach(Hn=>{const ri=_n[Hn.key],M=Number(ri);zn[Hn.label]=Number.isFinite(M)?Math.max(0,Math.min(Hn.max,M)):""}),lt){const Hn=Number(tn.lab);zn[Tr]=Number.isFinite(Hn)?Math.max(0,Math.min(zr,Hn)):""}return zn}),Re=lt?String(ht||"TCPL"):"THEORY";Lxe(`${Xb(e)}_MODEL_${Xb(Re)}.csv`,at)},ct=()=>{const ve=Sr();if(!u.length)return;const at=["Register No","Student Name",...ve.map(_n=>`${_n.label} (${_n.max})`)];lt&&at.push(`${Tr} (${zr})`),at.push("Status","Absence Kind");const Re=u.map(_n=>{const zn=[String(_n.reg_no||""),String(_n.name||"")],Hn=ve.map(()=>"");return lt?[...zn,...Hn,"","present","AL"]:[...zn,...Hn,"present","AL"]}),dt=vs.aoa_to_sheet([at,...Re]);dt["!freeze"]={xSplit:0,ySplit:1};const Rr=vs.book_new();vs.book_append_sheet(Rr,dt,"MODEL");const nn=lt?String(ht||"TCPL"):"THEORY",tn=`${Xb(e)}_MODEL_${Xb(nn)}_template.xlsx`;uy(Rr,tn)},$t=()=>{var ve;je||(ve=Se.current)==null||ve.click()},qe=async ve=>{var at;if(ve){ye(!0);try{const Re=Sr(),dt=await ve.arrayBuffer(),Rr=C0(dt,{type:"array"}),nn=(at=Rr.SheetNames)==null?void 0:at[0];if(!nn)throw new Error("No sheet found in the Excel file.");const tn=Rr.Sheets[nn],_n=vs.sheet_to_json(tn,{header:1});if(!_n.length)throw new Error("Excel sheet is empty.");const zn=(_n[0]||[]).map(Rxe),Hn=nr=>zn.findIndex(yr=>nr(yr)),ri=Hn(nr=>nr==="register no"||nr==="reg no"||nr.includes("register")),M=Hn(nr=>nr==="status"||nr.includes("status")),ce=Hn(nr=>nr==="absence kind"||nr==="absent kind"||nr==="kind");if(ri<0)throw new Error("Could not find Register No column.");const Le=Re.map(nr=>{const yr=String(nr.label||"").toLowerCase(),Wr=Hn(Vr=>Vr===yr||Vr.startsWith(yr));return{q:nr,col:Wr}}),it=lt?Hn(nr=>nr===String(Tr||"").toLowerCase()||nr.startsWith(String(Tr||"").toLowerCase())):-1,At=new Map;u.forEach((nr,yr)=>{const Wr=String(nr.reg_no||"").trim();Wr&&At.set(Wr,Zt(nr,yr))});const lr={...rt||{}};for(let nr=1;nr<_n.length;nr++){const yr=_n[nr]||[],Wr=String(yr[ri]??"").trim();if(!Wr)continue;const Vr=At.get(Wr);if(!Vr)continue;const dn=lr[Vr]||{},Pn={...dn.q||{}};Le.forEach(({q:gt,col:dr})=>{if(dr<0)return;const Ft=yr[dr],jr=Number(Ft);Pn[gt.key]=Number.isFinite(jr)?Math.max(0,Math.min(gt.max,jr)):""});const li=M>=0?String(yr[M]??"").trim().toLowerCase():"",fe=li==="absent"||li==="ab"||li==="a",xe=ce>=0?yr[ce]:"AL",Ke=s(xe),Fe={...dn,q:Pn,absent:fe,absentKind:Ke};if(lt&&it>=0){const gt=Number(yr[it]);Fe.lab=Number.isFinite(gt)?Math.max(0,Math.min(zr,gt)):""}lr[Vr]=Fe}Ze(lr)}finally{ye(!1)}}},Ye=async ve=>{var Re;const at=(Re=ve.target.files)==null?void 0:Re[0];if(ve.target.value="",!!at)try{await qe(at)}catch(dt){alert((dt==null?void 0:dt.message)||"Failed to import Excel")}},ot=x.useMemo(()=>{const ve=Array.from({length:or},()=>0);return Er.forEach((at,Re)=>{const dt=ar[Re]??1;dt>=1&&dt<=or&&(ve[dt-1]+=at.max)}),ve},[Er,ar,or]),$e=x.useMemo(()=>bn?ot.map((ve,at)=>at===4?zr:ve):ot.map(ve=>ve+kr),[ot,kr,bn,zr]),kt=x.useMemo(()=>{const ve=[0,0,0,0,0,0];return Er.forEach(at=>{const Re=(Ot||{})[at.key]??"";typeof Re=="number"&&Re>=1&&Re<=6&&(ve[Re-1]+=at.max)}),ve},[Er,Ot]),It=x.useMemo(()=>{const ve=new Set;return Er.forEach(at=>{const Re=(Ot||{})[at.key]??"";(Re===1||Re===2||Re===3||Re===4||Re===5||Re===6)&&ve.add(Re)}),ve.size===0?[1,2,3,4,5,6]:[1,2,3,4,5,6].filter(at=>ve.has(at))},[Er,Ot]),Zt=(ve,at)=>{const Re=ve==null?void 0:ve.id;if(typeof Re=="number"&&Re>0)return`id:${Re}`;const dt=String((ve==null?void 0:ve.reg_no)||"").trim();return dt?`reg:${dt}`:`idx:${at}`},sn=x.useRef({}),mn=ve=>at=>{sn.current[ve]=at},hn=ve=>{const at=sn.current[ve];if(at){at.focus();try{at.select()}catch{}}},Tn=4+Er.length+1+1+or*2+It.length*2,Ir=x.useMemo(()=>{const ve=new Set;return Or.forEach(at=>{const Re=(et||{})[at.key]??"";(Re===1||Re===2||Re===3||Re===4||Re===5||Re===6)&&ve.add(Re)}),ve.size===0?[1,2,3,4,5,6]:[1,2,3,4,5,6].filter(at=>ve.has(at))},[Or,et]),gn=4+Or.length+1+Gt*2+Ir.length*2,fn=x.useMemo(()=>K?Lr.filter((ve,at)=>{var dt;const Re=Zt(ve,at);return R&&R.length?R.includes(Re):!!((dt=(rt||{})[Re])!=null&&dt.absent)}):Lr,[Lr,K,rt,R]);return a.jsxs("div",{children:[V?a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(15,23,42,0.45)",display:"flex",alignItems:"center",justifyContent:"center",padding:16,zIndex:50},onClick:()=>X(null),children:a.jsxs("div",{style:{width:"min(520px, 100%)",background:"#fff",borderRadius:14,border:"1px solid rgba(15,23,42,0.10)",boxShadow:"0 20px 60px rgba(2,6,23,0.25)",padding:14},onClick:ve=>ve.stopPropagation(),children:[a.jsx("div",{style:{fontWeight:900,marginBottom:6},children:V.title}),a.jsx("div",{style:{fontSize:13,color:"#334155",marginBottom:12},children:V.message}),a.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:a.jsx("button",{className:"obe-btn",onClick:()=>X(null),children:"Close"})})]})}):null,a.jsxs("div",{style:{marginBottom:10,color:"#6b7280",fontSize:12},children:["Subject: ",a.jsx("b",{children:e})," | Assessment: ",a.jsx("b",{children:"MODEL"}),ht?a.jsxs(a.Fragment,{children:[" ","| Class: ",a.jsx("b",{children:ht})]}):null," ","| QP: ",a.jsx("b",{children:Ne||"QP1"})]}),f?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading roster"}):null,p?a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:p}):null,g?a.jsx("div",{style:{background:"#fff7ed",border:"1px solid #fed7aa",color:"#9a3412",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:g}):null,a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",marginBottom:10},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{onClick:Yr,className:"obe-btn obe-btn-secondary",disabled:!u.length,children:"Export CSV"}),a.jsx("button",{onClick:ct,className:"obe-btn obe-btn-secondary",disabled:!u.length,children:"Export Excel"}),a.jsx("button",{onClick:$t,className:"obe-btn obe-btn-secondary",disabled:!u.length||je||he,children:he?"Importing":"Import Excel"}),a.jsx("input",{ref:Se,type:"file",accept:".xlsx,.xls",style:{display:"none"},onChange:Ye})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:xt,className:"obe-btn obe-btn-success",disabled:b||!e||je,title:je?"Published sheets are locked (IQAC must open editing).":void 0,children:b?"Saving":"Save Draft"}),a.jsx("button",{onClick:Dt,className:"obe-btn obe-btn-primary",disabled:Mt?pt:w||u.length===0||!hr||re||vr,title:u.length===0?"No students in roster":hr?vr?"Publishing locked by IQAC":void 0:"Publish window is closed.",children:Mt?pt?"Request Pending":"Request Edit":w?"Publishing":"Publish"}),A&&a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Saved: ",A]}),E&&a.jsxs("div",{style:{fontSize:12,color:"#16a34a",alignSelf:"center"},children:["Published: ",E]})]})]}),a.jsx("div",{style:{marginBottom:10,fontSize:12,color:hr?"#065f46":"#b91c1c"},children:yt?"Checking publish due time":Fr||(wt!=null&&wt.due_at?a.jsxs(a.Fragment,{children:["Due: ",new Date(wt.due_at).toLocaleString(),"  Remaining: ",ng(Tt)]}):"Due time not set by IQAC.")}),vr?a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),a.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:a.jsx("button",{className:"obe-btn",onClick:()=>rn(),disabled:yt,children:"Refresh"})})]}):hr?null:a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fecaca",background:"#fff7ed",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publish time is over"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:"Send a request to IQAC to approve publishing."}),a.jsx("textarea",{value:I,onChange:ve=>Z(ve.target.value),placeholder:"Reason (optional)",rows:3,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:[a.jsx("button",{className:"obe-btn",onClick:()=>rn(),disabled:me||yt,children:"Refresh"}),a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:Vt,disabled:me||!e,children:me?"Requesting":"Request Approval"})]}),Ae?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:Ae}):null]}),a.jsxs("div",{style:{marginBottom:10,display:"flex",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Saved"}),a.jsx("div",{style:{fontWeight:700},children:A||""}),P?a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["by ",a.jsx("span",{style:{color:"#0369a1",fontWeight:700},children:P})]}):null]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Published"}),a.jsx("div",{style:{fontWeight:700},children:E||""}),a.jsxs("div",{style:{marginTop:8,display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{className:"obe-btn",disabled:!Pr||!e,onClick:()=>sr(!0,{applyToMain:!0}),title:Pr?void 0:"Publish first to view the published snapshot.",children:U?"Loading":"View Published"}),a.jsx("button",{className:"obe-btn",onClick:()=>$r(),disabled:!e,children:"Refresh Lock"})]}),de?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#b91c1c"},children:de}):null]})]}),je?a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Published & locked"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Editing and auto-save are disabled until IQAC opens the edit window."})]}):null,Ee?a.jsx(xs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:80},onClick:()=>ze(!1),children:a.jsxs("div",{style:{width:"min(520px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:16,border:"1px solid #e5e7eb",padding:14,boxShadow:"0 12px 30px rgba(0,0,0,0.18)"},onClick:ve=>ve.stopPropagation(),children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginTop:6,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",Ut?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:Xe,onChange:ve=>Pt(ve.target.value),placeholder:"Explain why you need to edit (required)",rows:3,className:"obe-input",style:{resize:"vertical"}})]}),a.jsxs("div",{style:{marginTop:10,display:"flex",gap:8,justifyContent:"flex-end"},children:[a.jsx("button",{className:"obe-btn",disabled:ft,onClick:()=>ze(!1),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:ft||pt||!e||!String(Xe||"").trim(),onClick:gr,children:ft?"Sending":pt?"Request Pending":"Send Request"})]})]})})}):null,a.jsx(a.Fragment,{children:a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:10},children:a.jsxs("button",{className:"obe-btn",disabled:!Zr,onClick:()=>{if(K)return;const ve=(Lr||[]).map((at,Re)=>{var dt;return{key:Zt(at,Re),isAbsent:!!((dt=(rt||{})[Zt(at,Re)])!=null&&dt.absent)}}).filter(at=>at.isAbsent).map(at=>at.key);J(ve),H(!0)},title:Zr?"Filter the table to show only absentees":"No absentees marked yet",style:K?{background:"linear-gradient(180deg, #111827, #334155)",color:"#fff",borderColor:"rgba(2,6,23,0.12)"}:void 0,children:["Show absentees list",K?a.jsx("span",{onClick:ve=>{ve.stopPropagation(),H(!1),J(null)},role:"button","aria-label":"Close absentees list",title:"Close absentees list",style:{marginLeft:10,display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:999,background:"rgba(255,255,255,0.18)",border:"1px solid rgba(255,255,255,0.25)",fontWeight:900,lineHeight:1,cursor:"pointer",userSelect:"none"},children:""}):null]})})}),a.jsxs("div",{style:{position:"relative",minHeight:je&&!tt?220:void 0},children:[Pr&&je?a.jsx("div",{style:{position:"absolute",inset:0,zIndex:30,pointerEvents:"none",background:"linear-gradient(180deg, rgba(34,197,94,0.18) 0%, rgba(16,185,129,0.24) 100%)"}}):null,Pr&&je?a.jsxs("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:40,background:"#fff",border:"1px solid #e5e7eb",padding:"10px 14px",borderRadius:999,display:"flex",alignItems:"center",gap:12,boxShadow:"0 6px 18px rgba(17,24,39,0.06)",pointerEvents:"auto",maxWidth:"min(720px, 96vw)"},children:[a.jsx("div",{style:{width:34,height:34,borderRadius:999,display:"grid",placeItems:"center",background:"#fef3c7",border:"1px solid #f59e0b33",color:"#92400e"},"aria-hidden":"true",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M7 11V8a5 5 0 0 1 10 0v3",stroke:"#92400e",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M6 11h12a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2Z",stroke:"#92400e",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),a.jsxs("div",{style:{minWidth:0},children:[a.jsx("div",{style:{fontWeight:900,fontSize:18,color:"#111827",lineHeight:1.1},children:"Published  Locked"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280",marginTop:2},children:U?"Loading published marks":de||"Marks are published. IQAC approval is required to edit."})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{className:"obe-btn",disabled:!Pr||!e,onClick:async()=>{_e(ve=>!ve);try{await sr(!0,{applyToMain:!0})}catch{}},title:Pr?void 0:"Publish first to view the published snapshot.",children:U?"Loading":"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:!e||pt,onClick:async()=>{if(pt){alert("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}ze(!0)},title:"Ask IQAC to open editing for published marks",children:pt?"Request Pending":"Request Edit"})]})]}):null,a.jsx("div",{className:"obe-table-wrapper",style:{overflowX:"auto"},children:a.jsx("table",{className:"obe-table",style:{width:"max-content",minWidth:"100%",tableLayout:"auto",pointerEvents:je?"none":void 0,opacity:je?.78:1,display:je&&!tt?"none":void 0},children:lt?a.jsxs(a.Fragment,{children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:o,colSpan:Tn,children:["MODEL (",ht||"TCPL"," Header Template)"]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,width:c,minWidth:c},rowSpan:5,children:"S.No"}),a.jsx("th",{style:{...o,minWidth:110,overflow:"visible",textOverflow:"clip"},rowSpan:5,children:"Register No."}),a.jsx("th",{style:{...o,minWidth:240,overflow:"visible",textOverflow:"clip"},rowSpan:5,children:"Name of the Students"}),a.jsx("th",{style:{...o,minWidth:92},rowSpan:5,children:"AB"}),Er.map(ve=>a.jsx("th",{style:{...o,width:40,minWidth:40},children:ve.label},ve.key)),a.jsx("th",{style:{...o,minWidth:56},rowSpan:3,children:"Total"}),a.jsx("th",{style:{...o,minWidth:56},rowSpan:3,children:Tr}),a.jsx("th",{style:o,colSpan:or*2,children:"CO ATTAINMENT"}),a.jsx("th",{style:o,colSpan:It.length*2,children:"BTL ATTAINMENT"})]}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,fontWeight:800},colSpan:Er.length,children:"COS"}),a.jsx("th",{style:o,colSpan:or*2,children:""}),a.jsx("th",{style:o,colSpan:It.length*2,children:""})]}),a.jsxs("tr",{children:[ar.map((ve,at)=>a.jsx("th",{style:{...o,width:40,minWidth:40},children:ve},`co-map-${at}`)),Array.from({length:or}).map((ve,at)=>a.jsxs("th",{style:o,colSpan:2,children:["CO-",at+1]},`co-head-${at}`)),It.map(ve=>a.jsxs("th",{style:o,colSpan:2,children:["BTL-",ve]},`btl-head-${ve}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,fontWeight:800},colSpan:Er.length,children:"BTL"}),a.jsx("th",{style:o,children:""}),a.jsx("th",{style:o,children:""}),Array.from({length:or+It.length}).flatMap((ve,at)=>a.jsxs(on.Fragment,{children:[a.jsx("th",{style:{...o,minWidth:52},children:a.jsx("div",{style:{whiteSpace:"pre-line",lineHeight:"0.9",fontSize:"0.7em"},children:`M
A
R
K`})}),a.jsx("th",{style:{...o,minWidth:34},children:"%"})]},`mkpct-${at}`))]}),a.jsxs("tr",{children:[Er.map(ve=>{const at=(Ot||{})[ve.key]??"",Re=at===""?"-":String(at);return a.jsx("th",{style:{...o,width:40,minWidth:40,padding:0},children:a.jsxs("div",{style:{position:"relative",minWidth:40},children:[a.jsx("div",{style:{width:"100%",fontSize:11,padding:"4px 4px",border:"1px solid #d1d5db",borderRadius:8,background:"#fff",textAlign:"center",userSelect:"none",margin:2},title:`BTL: ${Re}`,children:Re}),a.jsxs("select",{"aria-label":`BTL for ${ve.label}`,value:at,onChange:dt=>Nt(ve.key,dt.target.value===""?"":Number(dt.target.value)),style:{position:"absolute",inset:0,width:"100%",height:"100%",opacity:0,cursor:"pointer",appearance:"none"},children:[a.jsx("option",{value:"",children:"-"}),a.jsx("option",{value:"1",children:"1"}),a.jsx("option",{value:"2",children:"2"}),a.jsx("option",{value:"3",children:"3"}),a.jsx("option",{value:"4",children:"4"}),a.jsx("option",{value:"5",children:"5"}),a.jsx("option",{value:"6",children:"6"})]})]})},`btl-map-${ve.key}`)}),a.jsx("th",{style:o,children:""}),a.jsx("th",{style:o,children:""}),Array.from({length:or*2+It.length*2}).map((ve,at)=>a.jsx("th",{style:o,children:""},`tailblank-${at}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:o,children:"S.No"}),a.jsx("th",{style:o,children:"Register No."}),a.jsx("th",{style:o,children:"Name / Max Marks"}),a.jsx("th",{style:o,children:""}),Er.map(ve=>a.jsx("th",{style:{...o,width:40,minWidth:40},children:ve.max},`qmax-${ve.key}`)),a.jsx("th",{style:o,children:qt}),a.jsx("th",{style:o,children:"30"}),$e.flatMap((ve,at)=>a.jsxs(on.Fragment,{children:[a.jsx("th",{style:o,children:St(ve)}),a.jsx("th",{style:o,children:"%"})]},`co-max-mm-${at}`)),It.flatMap(ve=>a.jsxs(on.Fragment,{children:[a.jsx("th",{style:o,children:St(kt[ve-1]||0)}),a.jsx("th",{style:o,children:"%"})]},`btl-max-mm-${ve}`))]})]}),a.jsx("tbody",{children:fn.map((ve,at)=>a.jsx("tr",{children:(()=>{const Re=Zt(ve,at),dt=(Q||{})[Re]||{},Rr=!!dt.absent,nn=dt.lab??"",tn=Rr?s(dt.absentKind):null,_n=!!(K&&Rr&&(tn==="ML"||tn==="SKL")),zn=Rr&&tn==="AL"?0:null,Hn=Rr&&tn==="ML"?60:Rr&&tn==="SKL"?75:null,ri={};Er.forEach(fe=>{const xe=(dt.q||{})[fe.key]??"",Ke=typeof xe=="number"&&Number.isFinite(xe)?xe:0;ri[fe.key]=Math.max(0,Math.min(fe.max,Ke))});const M=typeof nn=="number"&&Number.isFinite(nn)?Math.max(0,Math.min(zr,nn)):0,ce=Object.values(ri).reduce((fe,xe)=>fe+xe,0),Le=Array.from({length:or},()=>0);if(Er.forEach((fe,xe)=>{const Ke=ar[xe]??1;Ke>=1&&Ke<=or&&(Le[Ke-1]+=ri[fe.key]||0)}),bn)Le[4]+=M;else for(let fe=0;fe<or;fe++)Le[fe]+=M/or;const it=Le.map((fe,xe)=>{const Ke=$e[xe]||0;return Ke?fe/Ke*100:0}),At=[0,0,0,0,0,0];Er.forEach(fe=>{const xe=(Ot||{})[fe.key]??"";typeof xe=="number"&&xe>=1&&xe<=6&&(At[xe-1]+=ri[fe.key]||0)});const lr=At.map((fe,xe)=>{const Ke=kt[xe]||0;return Ke?fe/Ke*100:0}),nr=fe=>{if(fe){we(Re,{...dt,absent:!0,absentKind:s(dt.absentKind),q:Object.fromEntries(Er.map(xe=>[xe.key,""])),lab:""});return}we(Re,{...dt,absent:!1,absentKind:void 0})},yr=fe=>{we(Re,{...dt,absent:!0,absentKind:s(fe)})},Wr=fe=>{Rr&&!_n||we(Re,{...dt,lab:bt(fe,zr)})},Vr=(fe,xe,Ke)=>{if(Rr&&!_n)return;const Fe=bt(xe,Ke),gt={...dt.q||{},[fe]:Fe};if(Hn!=null&&Er.reduce((Ft,jr)=>{const Ar=gt[jr.key]??"",qr=typeof Ar=="number"&&Number.isFinite(Ar)?Ar:0;return Ft+Math.max(0,Math.min(jr.max,qr))},0)>Hn){X({title:"Mark limit exceeded",message:tn==="ML"?"For malpractice the total mark assigned is 60":"For Sick leave the Total mark assigned is 75"});return}we(Re,{...dt,q:gt})},dn=[...Er.map(fe=>fe.key),"lab"],Pn=(fe,xe)=>{const Ke=dn.indexOf(fe),Fe=xe==="left"?Math.max(0,Ke-1):xe==="right"?Math.min(dn.length-1,Ke+1):Ke,gt=xe==="up"?Math.max(0,at-1):xe==="down"?Math.min(fn.length-1,at+1):at,Ft=`${Zt(fn[gt],gt)}|${dn[Fe]}`;hn(Ft)},li=fe=>xe=>{xe.key==="Tab"?(xe.preventDefault(),Pn(fe,xe.shiftKey?"left":"right")):xe.key==="ArrowLeft"?(xe.preventDefault(),Pn(fe,"left")):xe.key==="ArrowRight"?(xe.preventDefault(),Pn(fe,"right")):xe.key==="ArrowUp"||xe.key==="Enter"&&xe.shiftKey?(xe.preventDefault(),Pn(fe,"up")):(xe.key==="ArrowDown"||xe.key==="Enter")&&(xe.preventDefault(),Pn(fe,"down"))};return a.jsxs(a.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:at+1}),a.jsx("td",{style:l,children:ve.reg_no||""}),a.jsx("td",{style:l,children:ve.name||""}),a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[a.jsx("input",{type:"checkbox",checked:Rr,onChange:fe=>nr(fe.target.checked)}),Rr?a.jsxs("div",{className:"obe-ios-select",title:"Absent type",children:[a.jsx("span",{className:"obe-ios-select-value",children:tn||"AL"}),a.jsxs("select",{"aria-label":"Absent type",value:tn||"AL",onChange:fe=>yr(s(fe.target.value)),children:[a.jsx("option",{value:"AL",children:"AL"}),a.jsx("option",{value:"ML",children:"ML"}),a.jsx("option",{value:"SKL",children:"SKL"})]})]}):null]})}),Er.map(fe=>{const xe=(dt.q||{})[fe.key]??"",Ke=`${Re}|${fe.key}`;return a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsx("input",{ref:mn(Ke),type:"text",inputMode:"decimal",disabled:Rr&&!_n,value:xe===""?"":String(xe),onChange:Fe=>Vr(fe.key,Fe.target.value,fe.max),onFocus:Fe=>Fe.currentTarget.select(),onKeyDown:li(fe.key),style:De})},`${at}-${fe.key}`)}),a.jsx("td",{style:{...l,textAlign:"center",fontWeight:700},children:St(zn??ce)}),a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsx("input",{ref:mn(`${Re}|lab`),type:"text",inputMode:"decimal",disabled:Rr&&!_n,value:nn===""?"":String(nn),onChange:fe=>Wr(fe.target.value),onFocus:fe=>fe.currentTarget.select(),onKeyDown:li("lab"),style:De})}),Le.flatMap((fe,xe)=>a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:St(fe)}),a.jsx("td",{style:{...l,textAlign:"center"},children:St(it[xe])})]},`co-${at}-${xe}`)),It.flatMap(fe=>a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:St(At[fe-1]||0)}),a.jsx("td",{style:{...l,textAlign:"center"},children:St(lr[fe-1]||0)})]},`btl-${at}-${fe}`))]})})()},String(ve.id??at)))})]}):a.jsx(a.Fragment,{children:Ge?a.jsxs(a.Fragment,{children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsx("th",{style:o,colSpan:gn,children:"MODEL (THEORY Header Template)"})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,width:c,minWidth:c},rowSpan:5,children:"S.No"}),a.jsx("th",{style:{...o,minWidth:110,overflow:"visible",textOverflow:"clip"},rowSpan:5,children:"Register No."}),a.jsx("th",{style:{...o,minWidth:240,overflow:"visible",textOverflow:"clip"},rowSpan:5,children:"Name of the Students"}),a.jsx("th",{style:{...o,minWidth:92},rowSpan:5,children:"ABSENT"}),Or.map(ve=>a.jsx("th",{style:{...o,width:40,minWidth:40},children:ve.label},ve.key)),a.jsx("th",{style:{...o,minWidth:56},rowSpan:3,children:"Total"}),a.jsx("th",{style:o,colSpan:Gt*2,children:"CO ATTAINMENT"}),a.jsx("th",{style:o,colSpan:Ir.length*2,children:"BTL ATTAINMENT"})]}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,fontWeight:800},colSpan:Or.length,children:"COs"}),a.jsx("th",{style:o,colSpan:Gt*2,children:""}),a.jsx("th",{style:o,colSpan:Ir.length*2,children:""})]}),a.jsxs("tr",{children:[Ve.map((ve,at)=>a.jsx("th",{style:{...o,width:40,minWidth:40},children:ve},`theory-co-map-${at}`)),Array.from({length:Gt}).map((ve,at)=>a.jsxs("th",{style:o,colSpan:2,children:["CO-",at+1]},`theory-co-head-${at}`)),Ir.map(ve=>a.jsxs("th",{style:o,colSpan:2,children:["BTL-",ve]},`theory-btl-head-${ve}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,fontWeight:800},colSpan:Or.length,children:"BTL"}),a.jsx("th",{style:o,children:""}),Array.from({length:Gt+Ir.length}).flatMap((ve,at)=>a.jsxs(on.Fragment,{children:[a.jsx("th",{style:{...o,minWidth:52},children:a.jsx("div",{style:{whiteSpace:"pre-line",lineHeight:"0.9",fontSize:"0.7em"},children:`M
A
R
K`})}),a.jsx("th",{style:{...o,minWidth:34},children:"%"})]},`theory-mkpct-${at}`))]}),a.jsxs("tr",{children:[Or.map((ve,at)=>{const Re=(et||{})[ve.key]??"",dt=Re===""?"-":String(Re);return a.jsx("th",{style:{...o,width:40,minWidth:40,padding:0},children:a.jsxs("div",{style:{position:"relative",minWidth:40},children:[a.jsx("div",{style:{width:"100%",fontSize:11,padding:"4px 4px",border:"1px solid #d1d5db",borderRadius:8,background:"#fff",textAlign:"center",userSelect:"none",margin:2},title:`BTL: ${dt}`,children:dt}),a.jsxs("select",{"aria-label":`BTL for ${ve.label}`,value:Re,onChange:Rr=>Bt(ve.key,Rr.target.value===""?"":Number(Rr.target.value)),style:{position:"absolute",inset:0,width:"100%",height:"100%",opacity:0,cursor:"pointer",appearance:"none"},children:[a.jsx("option",{value:"",children:"-"}),a.jsx("option",{value:"1",children:"1"}),a.jsx("option",{value:"2",children:"2"}),a.jsx("option",{value:"3",children:"3"}),a.jsx("option",{value:"4",children:"4"}),a.jsx("option",{value:"5",children:"5"}),a.jsx("option",{value:"6",children:"6"})]})]})},`theory-btl-map-${ve.key}`)}),a.jsx("th",{style:o,children:""}),Array.from({length:Gt*2+Ir.length*2}).map((ve,at)=>a.jsx("th",{style:o,children:""},`theory-tailblank-${at}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:o,children:"S.No"}),a.jsx("th",{style:o,children:"Register No."}),a.jsx("th",{style:o,children:"Name / Max Marks"}),a.jsx("th",{style:o,children:""}),Or.map(ve=>a.jsx("th",{style:{...o,width:40,minWidth:40},children:ve.max},`theory-qmax-${ve.key}`)),a.jsx("th",{style:o,children:ur}),Xt.flatMap((ve,at)=>a.jsxs(on.Fragment,{children:[a.jsx("th",{style:o,children:St(ve)}),a.jsx("th",{style:o,children:"%"})]},`theory-co-max-mm-${at}`)),Ir.flatMap(ve=>a.jsxs(on.Fragment,{children:[a.jsx("th",{style:o,children:St(Jt[ve-1]||0)}),a.jsx("th",{style:o,children:"%"})]},`theory-btl-max-mm-${ve}`))]})]}),a.jsx("tbody",{children:fn.map((ve,at)=>a.jsx("tr",{children:(()=>{const Re=Zt(ve,at),dt=(rt||{})[Re]||{},Rr=!!dt.absent,nn=Rr?s(dt.absentKind):null,tn=!!(K&&Rr&&(nn==="ML"||nn==="SKL")),_n=Rr&&nn==="AL"?0:null,zn=Rr&&nn==="ML"?60:Rr&&nn==="SKL"?75:null,Hn={};Or.forEach(yr=>{const Wr=(dt.q||{})[yr.key]??"",Vr=typeof Wr=="number"&&Number.isFinite(Wr)?Wr:0;Hn[yr.key]=Math.max(0,Math.min(yr.max,Vr))});const ri=Object.values(Hn).reduce((yr,Wr)=>yr+Wr,0),M=Array.from({length:Gt},()=>0);Or.forEach((yr,Wr)=>{const Vr=Ve[Wr]??1;Vr>=1&&Vr<=Gt&&(M[Vr-1]+=Hn[yr.key]||0)});const ce=M.map((yr,Wr)=>{const Vr=Xt[Wr]||0;return Vr?yr/Vr*100:0}),Le=[0,0,0,0,0,0];Or.forEach((yr,Wr)=>{const Vr=Kt[Wr];typeof Vr=="number"&&Vr>=1&&Vr<=6&&(Le[Vr-1]+=Hn[yr.key]||0)});const it=Le.map((yr,Wr)=>{const Vr=Jt[Wr]||0;return Vr?yr/Vr*100:0}),At=yr=>{if(yr){Ie(Re,{...dt,absent:!0,absentKind:s(dt.absentKind),q:Object.fromEntries(Or.map(Wr=>[Wr.key,""]))});return}Ie(Re,{...dt,absent:!1,absentKind:void 0})},lr=yr=>{Ie(Re,{...dt,absent:!0,absentKind:s(yr)})},nr=(yr,Wr,Vr)=>{if(Rr&&!tn)return;const dn=bt(Wr,Vr),Pn={...dt.q||{},[yr]:dn};if(zn!=null&&Or.reduce((fe,xe)=>{const Ke=Pn[xe.key]??"",Fe=typeof Ke=="number"&&Number.isFinite(Ke)?Ke:0;return fe+Math.max(0,Math.min(xe.max,Fe))},0)>zn){X({title:"Mark limit exceeded",message:nn==="ML"?"For malpractice the total mark assigned is 60":"For Sick leave the Total mark assigned is 75"});return}Ie(Re,{...dt,q:Pn})};return a.jsxs(a.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:at+1}),a.jsx("td",{style:l,children:ve.reg_no||""}),a.jsx("td",{style:l,children:ve.name||""}),a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[a.jsx("input",{type:"checkbox",checked:Rr,onChange:yr=>At(yr.target.checked)}),Rr?a.jsxs("div",{className:"obe-ios-select",title:"Absent type",children:[a.jsx("span",{className:"obe-ios-select-value",children:nn||"AL"}),a.jsxs("select",{"aria-label":"Absent type",value:nn||"AL",onChange:yr=>lr(s(yr.target.value)),children:[a.jsx("option",{value:"AL",children:"AL"}),a.jsx("option",{value:"ML",children:"ML"}),a.jsx("option",{value:"SKL",children:"SKL"})]})]}):null]})}),Or.map(yr=>{const Wr=(dt.q||{})[yr.key]??"",Vr=`${Re}|${yr.key}`,dn=Or.map(fe=>fe.key),Pn=(fe,xe)=>{const Ke=Math.max(0,dn.indexOf(fe)),Fe=xe==="left"?Math.max(0,Ke-1):xe==="right"?Math.min(dn.length-1,Ke+1):Ke,gt=xe==="up"?Math.max(0,at-1):xe==="down"?Math.min(fn.length-1,at+1):at,dr=Zt(fn[gt],gt);hn(`${dr}|${dn[Fe]}`)},li=fe=>xe=>{xe.key==="Tab"?(xe.preventDefault(),Pn(fe,xe.shiftKey?"left":"right")):xe.key==="ArrowLeft"?(xe.preventDefault(),Pn(fe,"left")):xe.key==="ArrowRight"?(xe.preventDefault(),Pn(fe,"right")):xe.key==="ArrowUp"||xe.key==="Enter"&&xe.shiftKey?(xe.preventDefault(),Pn(fe,"up")):(xe.key==="ArrowDown"||xe.key==="Enter")&&(xe.preventDefault(),Pn(fe,"down"))};return a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsx("input",{ref:mn(Vr),type:"text",inputMode:"decimal",disabled:Rr&&!tn,value:Wr===""?"":String(Wr),onChange:fe=>nr(yr.key,fe.target.value,yr.max),onFocus:fe=>fe.currentTarget.select(),onKeyDown:li(yr.key),style:De})},`${at}-${yr.key}`)}),a.jsx("td",{style:{...l,textAlign:"center",fontWeight:700},children:St(_n??ri)}),M.flatMap((yr,Wr)=>a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:St(yr)}),a.jsx("td",{style:{...l,textAlign:"center"},children:St(ce[Wr])})]},`theory-co-${at}-${Wr}`)),Ir.flatMap(yr=>a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:St(Le[yr-1]||0)}),a.jsx("td",{style:{...l,textAlign:"center"},children:St(it[yr-1]||0)})]},`theory-btl-${at}-${yr}`))]})})()},String(ve.id??at)))})]}):a.jsxs(a.Fragment,{children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsx("th",{style:o,colSpan:vt,children:"MODEL (Blank Template)"})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,width:c,minWidth:c},rowSpan:3,children:"S.No"}),a.jsx("th",{style:{...o,minWidth:70,overflow:"visible",textOverflow:"clip"},rowSpan:3,children:"R.No"}),a.jsx("th",{style:{...o,minWidth:240,overflow:"visible",textOverflow:"clip"},rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:{...o,minWidth:32},rowSpan:3,children:"AB"}),a.jsx("th",{style:o,colSpan:ke.length,children:"QUESTIONS"}),a.jsx("th",{style:o,rowSpan:3,children:"Total"}),a.jsx("th",{style:o,colSpan:4,children:"CO ATTAINMENT"}),a.jsx("th",{style:o,colSpan:i.length*2,children:"BTL ATTAINMENT"})]}),a.jsxs("tr",{children:[ke.map(ve=>a.jsx("th",{style:{...o,width:46,minWidth:46},children:ve.label},ve.key)),a.jsx("th",{style:o,colSpan:2,children:"CO-1"}),a.jsx("th",{style:o,colSpan:2,children:"CO-2"}),i.map(ve=>a.jsxs("th",{style:o,colSpan:2,children:["BTL-",ve]},`btl-head-${ve}`))]}),a.jsxs("tr",{children:[ke.map(ve=>a.jsx("th",{style:{...o,width:46,minWidth:46},children:ve.max},ve.key)),Array.from({length:2+i.length}).flatMap((ve,at)=>a.jsxs(on.Fragment,{children:[a.jsx("th",{style:{...o,minWidth:52},children:a.jsx("div",{style:{whiteSpace:"pre-line",lineHeight:"0.9",fontSize:"0.7em"},children:`M
A
R
K`})}),a.jsx("th",{style:{...o,minWidth:34},children:"%"})]},at))]})]}),a.jsx("tbody",{children:fn.map((ve,at)=>a.jsxs("tr",{children:[(()=>{const Re=Zt(ve,at),dt=(rt||{})[Re]||{},Rr=!!dt.absent,nn=Rr?s(dt.absentKind):null,tn=!!(K&&Rr&&(nn==="ML"||nn==="SKL")),_n=Rr&&nn==="AL"?0:null,zn=Rr&&nn==="ML"?60:Rr&&nn==="SKL"?75:null,Hn={};ke.forEach(it=>{const At=(dt.q||{})[it.key]??"",lr=typeof At=="number"&&Number.isFinite(At)?At:0;Hn[it.key]=Math.max(0,Math.min(it.max,lr))});const ri=Object.values(Hn).reduce((it,At)=>it+At,0),M=it=>{if(it){Ie(Re,{...dt,absent:!0,absentKind:s(dt.absentKind),q:Object.fromEntries(ke.map(At=>[At.key,""]))});return}Ie(Re,{...dt,absent:!1,absentKind:void 0})},ce=it=>{Ie(Re,{...dt,absent:!0,absentKind:s(it)})},Le=(it,At,lr)=>{if(Rr&&!tn)return;const nr=bt(At,lr),yr={...dt.q||{},[it]:nr};if(zn!=null&&ke.reduce((Vr,dn)=>{const Pn=yr[dn.key]??"",li=typeof Pn=="number"&&Number.isFinite(Pn)?Pn:0;return Vr+Math.max(0,Math.min(dn.max,li))},0)>zn){X({title:"Mark limit exceeded",message:nn==="ML"?"For malpractice the total mark assigned is 60":"For Sick leave the Total mark assigned is 75"});return}Ie(Re,{...dt,q:yr})};return a.jsxs(a.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:at+1}),a.jsx("td",{style:l,children:ve.reg_no||""}),a.jsx("td",{style:l,children:ve.name||""}),a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[a.jsx("input",{type:"checkbox",checked:Rr,onChange:it=>M(it.target.checked)}),Rr?a.jsxs("div",{className:"obe-ios-select",title:"Absent type",children:[a.jsx("span",{className:"obe-ios-select-value",children:nn||"AL"}),a.jsxs("select",{"aria-label":"Absent type",value:nn||"AL",onChange:it=>ce(s(it.target.value)),children:[a.jsx("option",{value:"AL",children:"AL"}),a.jsx("option",{value:"ML",children:"ML"}),a.jsx("option",{value:"SKL",children:"SKL"})]})]}):null]})}),ke.map(it=>{const At=(dt.q||{})[it.key]??"",lr=`${Re}|${it.key}`,nr=ke.map(Vr=>Vr.key),yr=(Vr,dn)=>{const Pn=Math.max(0,nr.indexOf(Vr)),li=dn==="left"?Math.max(0,Pn-1):dn==="right"?Math.min(nr.length-1,Pn+1):Pn,fe=dn==="up"?Math.max(0,at-1):dn==="down"?Math.min(fn.length-1,at+1):at,xe=Zt(fn[fe],fe);hn(`${xe}|${nr[li]}`)},Wr=Vr=>dn=>{dn.key==="Tab"?(dn.preventDefault(),yr(Vr,dn.shiftKey?"left":"right")):dn.key==="ArrowLeft"?(dn.preventDefault(),yr(Vr,"left")):dn.key==="ArrowRight"?(dn.preventDefault(),yr(Vr,"right")):dn.key==="ArrowUp"||dn.key==="Enter"&&dn.shiftKey?(dn.preventDefault(),yr(Vr,"up")):(dn.key==="ArrowDown"||dn.key==="Enter")&&(dn.preventDefault(),yr(Vr,"down"))};return a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsx("input",{ref:mn(lr),type:"text",inputMode:"decimal",disabled:Rr&&!tn,value:At===""?"":String(At),onChange:Vr=>Le(it.key,Vr.target.value,it.max),onFocus:Vr=>Vr.currentTarget.select(),onKeyDown:Wr(it.key),style:De})},`${at}-${it.key}`)}),a.jsx("td",{style:{...l,textAlign:"center",fontWeight:700},children:St(_n??ri)})]})})(),a.jsx("td",{style:{...l,textAlign:"center"},children:""}),a.jsx("td",{style:{...l,textAlign:"center"},children:""}),a.jsx("td",{style:{...l,textAlign:"center"},children:""}),a.jsx("td",{style:{...l,textAlign:"center"},children:""}),i.flatMap(Re=>a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:""}),a.jsx("td",{style:{...l,textAlign:"center"},children:""})]},`${at}-btl-${Re}`))]},String(ve.id??at)))})]})})})})]})]})}function Ik({subjectId:e,teachingAssignmentId:t,assessmentKey:r,viewerMode:n}){const i=r==="cia1"?{label:"CIA 1 Review",coA:1,coB:2}:r==="cia2"?{label:"CIA 2 Review",coA:3,coB:4}:{label:"MODEL Review",coA:5,coB:null};return a.jsx(Bx,{subjectId:e,teachingAssignmentId:t,assessmentKey:r,skipMarkManager:!0,floatPanelOnTable:!0,label:i.label,coA:i.coA,coB:i.coB,initialEnabledCos:[1,2,3,4,5],viewerMode:!!n,itemLabel:"Content",itemLabelPlural:"Content",itemAbbrev:"Con",ciaExamAvailable:!0,absentEnabled:!0,autoSaveDraft:!0})}function Dk({subjectId:e,teachingAssignmentId:t,assessmentKey:r,viewerMode:n,classType:i}){const s=ti(i||"");if(s&&s!=="PROJECT")return a.jsx("div",{style:{color:"#6b7280"},children:"Review mark entry is available only for PROJECT class type courses."});const o=r==="cia1"?{label:"CIA 1 Review",coA:1,coB:2}:r==="cia2"?{label:"CIA 2 Review",coA:3,coB:4}:{label:"MODEL Review",coA:5,coB:null};return a.jsx(Bx,{subjectId:e,teachingAssignmentId:t,assessmentKey:r,skipMarkManager:!0,floatPanelOnTable:!0,label:o.label,coA:o.coA,coB:o.coB,initialEnabledCos:[1,2,3,4,5],viewerMode:!!n,itemLabel:"Content",itemLabelPlural:"Content",itemAbbrev:"Con",ciaExamAvailable:!0,absentEnabled:!0,autoSaveDraft:!0})}function Bxe({subjectId:e,teachingAssignmentId:t,label:r}){return a.jsx(J2,{subjectId:e,teachingAssignmentId:t,assessmentKey:"review1",label:r||"Review 1",coA:1,coB:2,allCos:[1,2,3,4,5]})}function Ixe({subjectId:e,teachingAssignmentId:t,label:r}){return a.jsx(J2,{subjectId:e,teachingAssignmentId:t,assessmentKey:"review2",label:r||"Review 2",coA:3,coB:4,allCos:[1,2,3,4,5]})}const Dxe=20,PM={co1:10,co2:10},Sp={btl1:0,btl2:0,btl3:10,btl4:10,btl5:0,btl6:0},Ip=10;function no(e,t,r){return Math.max(t,Math.min(r,e))}function ql(e){return Math.round(e*10)/10}function xl(e,t){if(e==null)return"";if(!Number.isFinite(t)||t<=0)return"0";const r=e/t*100;return`${Number.isFinite(r)?r.toFixed(0):0}`}function Kv(e){if(e===""||e==null||typeof e=="string"&&e.trim()==="")return null;const t=Number(e);return Number.isFinite(t)?t:null}function _p(e,t,r){const n=e==null?void 0:e.btlMax,i=(n==null?void 0:n[String(t)])??(n==null?void 0:n[`btl${t}`])??(n==null?void 0:n[t]),s=Kv(i);return s??r}function $xe(e){const t=Number(e);return Number.isFinite(t)&&t>0?t:Ip}function Uxe(e,t){return`${t}_sheet_${e}`}function OM(e){return String(e||"").trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_-]/g,"").slice(0,48)}function zxe(e,t){if(!t.length)return;const r=Object.keys(t[0]),n=[r.join(",")].concat(t.map(l=>r.map(c=>{const u=l[c],d=String(u??"").replace(/\n/g," ");return d.includes(",")||d.includes('"')?`"${d.replace(/"/g,'""')}"`:d}).join(","))).join(`
`),i=new Blob([n],{type:"text/csv"}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function Wxe(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const l=r.localeCompare(n);if(l)return l}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim(),o=i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"});return o||0}function $k(e){return e.slice(-8)}function qxe({subjectId:e,teachingAssignmentId:t,label:r,assessmentKey:n="ssa1"}){var Yr,ct,$t;const i=String(r||"SSA1"),s=n==="review1",o=!1,l=x.useMemo(()=>Uxe(e,n),[e,n]),c=n==="review1"?SS:rg,u=n==="review1"?C9:N9,[d,f]=x.useState(null),[h,p]=x.useState(null),[m,g]=x.useState({termLabel:"KRCT AY25-26",batchLabel:e,rows:[],markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null}),y=String((d==null?void 0:d.termLabel)||"KRCT AY25-26"),b=((Yr=d==null?void 0:d.assessments)==null?void 0:Yr.ssa1)||{},v=Number.isFinite(Number(b==null?void 0:b.maxTotal))?Number(b.maxTotal):Dxe,w=s?30:v,S={co1:Number.isFinite(Number((ct=b==null?void 0:b.coMax)==null?void 0:ct.co1))?Number(b.coMax.co1):PM.co1,co2:Number.isFinite(Number(($t=b==null?void 0:b.coMax)==null?void 0:$t.co2))?Number(b.coMax.co2):PM.co2},k=s?{co1:15,co2:15}:S,j={btl1:_p(b,1,Sp.btl1),btl2:_p(b,2,Sp.btl2),btl3:_p(b,3,Sp.btl3),btl4:_p(b,4,Sp.btl4),btl5:_p(b,5,Sp.btl5),btl6:_p(b,6,Sp.btl6)},A=s?30:Ip,L=x.useRef(null),[P,F]=x.useState(!1);x.useEffect(()=>{let qe=!0;return(async()=>{try{const Ye=await ku();if(!qe)return;f(Ye||null),g(ot=>({...ot,termLabel:String((Ye==null?void 0:Ye.termLabel)||ot.termLabel||"KRCT AY25-26"),batchLabel:e}))}catch{}})(),()=>{qe=!1}},[e]);const[E,T]=x.useState(!1),[B,q]=x.useState(null),[U,se]=x.useState(()=>s?[3,4]:[]),[de,z]=x.useState(!1),[G,ie]=x.useState(!1),[Y,C]=x.useState(null),[K,H]=x.useState(null),[R,J]=x.useState(null),[V,X]=x.useState(null),[Q,ne]=x.useState(!1),[oe,O]=x.useState(!1),[W,ae]=x.useState(""),[I,Z]=x.useState(!1),[me,Te]=x.useState(null),[Ae,Be]=x.useState(null),[Ee,ze]=x.useState(!1),[Xe,Pt]=x.useState(null),[ft,He]=x.useState(!1),[tt,_e]=x.useState(null),{data:Se,loading:he,error:ye,remainingSeconds:ht,publishAllowed:Ge,refresh:lt}=V0({assessment:n,subjectCode:e,teachingAssignmentId:t}),{data:jt,loading:wt,error:yt,refresh:Fr}=G0({assessment:n,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:Tt}=oc({assessment:n,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!1}}),{data:hr}=oc({assessment:n,subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:t,options:{poll:!1}}),rn=!!(Se!=null&&Se.global_override_active&&(Se==null?void 0:Se.global_is_open)===!1),[en,$r]=x.useState(""),[Kr,Rn]=x.useState(!1),[Pr,Sn]=x.useState(null),[Me,je]=x.useState(null),[Mt,pt]=x.useState(!1),[Ut,ir]=x.useState(null),[fr,vr]=x.useState(!1),re=!!V||!!(jt!=null&&jt.exists&&(jt!=null&&jt.is_published))||!!Ae,te=!!!(e&&!Mt)&&re,[ue,Ne]=x.useState(null);x.useEffect(()=>{Ne(null),X(null),Be(null),Pt(null),O(!1),ae(""),Te(null)},[e,n,t]);const ke=!!m.markManagerLocked,vt=hr!=null&&hr.approval_until?String(hr.approval_until):null,rt=Tt!=null&&Tt.approval_until?String(Tt.approval_until):null,De=!!(hr!=null&&hr.allowed_by_approval)&&!!vt&&vt!==((ue==null?void 0:ue.markEntryApprovalUntil)??null),We=!!(Tt!=null&&Tt.allowed_by_approval)&&!!rt&&rt!==((ue==null?void 0:ue.markManagerApprovalUntil)??null),st=re?!!(jt!=null&&jt.entry_open)||De||We:!0,zt=!!(re&&!st),{pending:Wt,pendingUntilMs:xt,setPendingUntilMs:Dt,refresh:Vt}=K0({enabled:!!(re&&zt)&&!!e,assessment:n,subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:t});Y0(!!oe||!!Me||!!Q);const gr=!!e&&(wt||!!yt||jt==null),sr=!!(rn||gr||(jt?!jt.entry_open:re?!st:!ke)),Lr=!!(rn||zt||sr),Zr=m.markManagerSnapshot!=null,Er=x.useMemo(()=>{const qe=new Set(U);return[1,2,3,4,5,6].filter(Ye=>qe.has(Ye))},[U]),qt=x.useMemo(()=>8+Er.length*2,[Er.length,o]),zr=x.useMemo(()=>{try{return m.rows.some(qe=>!!qe.absent||Object.values(qe).some(Ye=>typeof Ye=="string"&&String(Ye).toLowerCase().includes("absent")))}catch{return!1}},[m.rows]),bn=x.useMemo(()=>ft?tt&&tt.length?m.rows.filter(qe=>tt.includes(Number(qe.studentId))):m.rows.filter(qe=>!!qe.absent||Object.values(qe).some(Ye=>typeof Ye=="string"&&String(Ye).toLowerCase().includes("absent"))):m.rows,[m.rows,ft,tt]);x.useEffect(()=>{if(!e)return;try{const ot=`${n}_selected_btls_${e}`;Kn(ot,U)}catch{}let qe=!1;const Ye=setTimeout(async()=>{try{await Ri(n,e,{sheet:m,selectedBtls:U});try{l&&Kn(l,{termLabel:m.termLabel,batchLabel:m.batchLabel,rows:m.rows})}catch{}qe||H(new Date().toLocaleString())}catch{}},700);return()=>{qe=!0,clearTimeout(Ye)}},[U,e,m,n,l]),x.useEffect(()=>{if(!e)return;const qe=Jn(l);qe&&typeof qe=="object"&&Array.isArray(qe.rows)?g({termLabel:d!=null&&d.termLabel?String(d.termLabel):String(qe.termLabel||"KRCT AY25-26"),batchLabel:e,rows:qe.rows}):g({termLabel:y||"KRCT AY25-26",batchLabel:e,rows:[]})},[l,e,d,y]),x.useEffect(()=>{let qe=!0;return(async()=>{if(e)try{const Ye=await ei(n,e);if(!qe)return;const ot=Ye==null?void 0:Ye.draft,$e=ot==null?void 0:ot.sheet,kt=ot==null?void 0:ot.selectedBtls;if($e&&typeof $e=="object"&&Array.isArray($e.rows)){g(sn=>({...sn,termLabel:String($e.termLabel||y||"KRCT AY25-26"),batchLabel:e,rows:$e.rows,markManagerSnapshot:($e==null?void 0:$e.markManagerSnapshot)??sn.markManagerSnapshot??null,markManagerApprovalUntil:($e==null?void 0:$e.markManagerApprovalUntil)??sn.markManagerApprovalUntil??null,markManagerLocked:typeof($e==null?void 0:$e.markManagerLocked)=="boolean"?$e.markManagerLocked:!!(($e==null?void 0:$e.markManagerSnapshot)??sn.markManagerSnapshot)}));const It=(Ye==null?void 0:Ye.updated_at)??null,Zt=(Ye==null?void 0:Ye.updated_by)??null;if(It)try{H(new Date(String(It)).toLocaleString())}catch{H(String(It))}Zt&&J(String(Zt.name||Zt.username||Zt.id||""));try{l&&Kn(l,{termLabel:String($e.termLabel||y||"KRCT AY25-26"),batchLabel:e,rows:$e.rows})}catch{}}if(Array.isArray(kt)){se(kt.map(It=>Number(It)).filter(It=>Number.isFinite(It)));try{const It=`${n}_selected_btls_${e}`;Kn(It,kt.map(Zt=>Number(Zt)).filter(Zt=>Number.isFinite(Zt)))}catch{}}}catch{}})(),()=>{qe=!1}},[e,y,n,l]),x.useEffect(()=>{if(!e)return;if((!!(jt!=null&&jt.exists&&(jt!=null&&jt.is_published))||!!V)&&(jt!=null&&jt.exists)){const $e=!!(jt!=null&&jt.mark_manager_locked);!!m.markManagerLocked!==$e&&g(kt=>({...kt,markManagerLocked:$e}));return}const Ye=!!(Tt!=null&&Tt.allowed_by_approval),ot=Tt!=null&&Tt.approval_until?String(Tt.approval_until):null;if(Ye&&ot){if(ot===((ue==null?void 0:ue.markManagerApprovalUntil)??null))return;const $e=m.markManagerApprovalUntil?String(m.markManagerApprovalUntil):null;m.markManagerLocked&&$e!==ot&&g(kt=>({...kt,markManagerLocked:!1,markManagerApprovalUntil:ot}));return}},[e,jt==null?void 0:jt.exists,jt==null?void 0:jt.mark_manager_locked,Tt==null?void 0:Tt.allowed_by_approval,Tt==null?void 0:Tt.approval_until,m.markManagerLocked,V,ue==null?void 0:ue.markManagerApprovalUntil,m.markManagerApprovalUntil]);const or=qe=>{g(Ye=>{const ot=new Map,$e=new Map;for(const It of Ye.rows||[])typeof It.studentId=="number"&&ot.set(It.studentId,It),It.registerNo&&$e.set(String(It.registerNo),It);const kt=(qe||[]).slice().sort(Wxe).map(It=>{const Zt=ot.get(It.id)||$e.get(String(It.reg_no||""));return{studentId:It.id,section:String(It.section||""),registerNo:String(It.reg_no||""),name:String(It.name||""),total:typeof(Zt==null?void 0:Zt.total)=="number"?no(Number(Zt.total),0,w):((Zt==null?void 0:Zt.total)==="","")}});return{...Ye,rows:kt}})},kr=async()=>{var qe,Ye,ot;if(!e){q("Subject ID is required.");return}T(!0),q(null);try{let $e=[],kt=null;try{const It=await fc();console.log("[SSA1] My TAs:",It==null?void 0:It.length,"for subject:",e,"teachingAssignmentId:",t),kt=(It||[]).find(Zt=>{const sn=String(Zt.subject_code||"").trim().toUpperCase()===String(e||"").trim().toUpperCase();return(t?Zt.id===t:!1)||sn}),kt?console.log("[SSA1] Found TA match:",kt.id,"elective_subject_id:",kt.elective_subject_id,"section_id:",kt.section_id):console.log("[SSA1] No TA match found in user TAs")}catch(It){console.warn("[SSA1] My TAs fetch failed:",It)}if(kt&&kt.elective_subject_id&&!kt.section_id){console.log("[SSA1] Detected elective, fetching elective-choices for elective_subject_id:",kt.elective_subject_id);try{const It=await xr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(kt.elective_subject_id))}`);if(It.ok){const Zt=await It.json(),sn=Array.isArray(Zt.results)?Zt.results:Array.isArray(Zt)?Zt:Zt.items||[];console.log("[SSA1] Elective choices returned:",sn==null?void 0:sn.length,"students"),$e=(sn||[]).map(mn=>({id:Number(mn.student_id??mn.id),reg_no:String(mn.reg_no??mn.regno??""),name:String(mn.name??mn.full_name??mn.username??""),section:mn.section_name??mn.section??null}))}else console.warn("[SSA1] Elective-choices API returned error:",It.status)}catch(It){console.warn("[SSA1] Elective-choices fetch failed:",It)}}if(!$e.length&&kt&&kt.id){console.log("[SSA1] Fetching regular TA roster for TA ID:",kt.id);try{const It=await Vc(kt.id);$e=It.students||[],p({courseName:String(((qe=It==null?void 0:It.teaching_assignment)==null?void 0:qe.subject_name)||(kt==null?void 0:kt.subject_name)||""),courseCode:String(((Ye=It==null?void 0:It.teaching_assignment)==null?void 0:Ye.subject_code)||(kt==null?void 0:kt.subject_code)||e||""),className:String(((ot=It==null?void 0:It.teaching_assignment)==null?void 0:ot.section_name)||(kt==null?void 0:kt.section_name)||"")}),console.log("[SSA1] Regular roster returned:",$e.length,"students")}catch(It){console.warn("[SSA1] TA roster fetch failed:",It)}}console.log("[SSA1] Final roster count:",$e.length),or($e)}catch($e){q(($e==null?void 0:$e.message)||"Failed to load roster")}finally{T(!1)}};x.useEffect(()=>{e&&kr()},[t,e]);async function Tr(qe){if(e){qe&&ze(!0),Pt(null);try{const Ye=await c(String(e));Be(Ye||null)}catch(Ye){qe&&Pt((Ye==null?void 0:Ye.message)||`Failed to load published ${i} marks`)}finally{qe&&ze(!1)}}}x.useEffect(()=>{e&&Tr(!1)},[e,n,t]);const Or=x.useRef(!!st);x.useEffect(()=>{Or.current=!!st},[e,n,t,st]),x.useEffect(()=>{if(!e||!re)return;if(Or.current||!st){Or.current=!!st;return}let Ye=!0;return(async()=>{try{const ot=await ei(n,String(e));if(!Ye)return;const $e=ot==null?void 0:ot.draft,kt=$e==null?void 0:$e.sheet,It=$e==null?void 0:$e.selectedBtls;kt&&typeof kt=="object"&&Array.isArray(kt.rows)&&g(Zt=>({...Zt,termLabel:String(kt.termLabel||y||"KRCT AY25-26"),batchLabel:e,rows:kt.rows,markManagerSnapshot:(kt==null?void 0:kt.markManagerSnapshot)??Zt.markManagerSnapshot??null,markManagerApprovalUntil:(kt==null?void 0:kt.markManagerApprovalUntil)??Zt.markManagerApprovalUntil??null,markManagerLocked:typeof(kt==null?void 0:kt.markManagerLocked)=="boolean"?kt.markManagerLocked:!!((kt==null?void 0:kt.markManagerSnapshot)??Zt.markManagerSnapshot)})),Array.isArray(It)&&se(It.map(Zt=>Number(Zt)).filter(Zt=>Number.isFinite(Zt)));return}catch{}Ye&&Tr(!1)})(),Or.current=!!st,()=>{Ye=!1}},[st,re,e,n,y]),x.useEffect(()=>{if(!e||!re||st)return;const qe=window.setInterval(()=>{Fr({silent:!0})},3e4);return()=>window.clearInterval(qe)},[st,re,e,Fr]),x.useEffect(()=>{Q&&e&&(Be(null),Tr(!0))},[Q,e]);const Gt=async()=>{z(!0),C(null);try{await Ri(n,e,{sheet:m,selectedBtls:U}),H(new Date().toLocaleString())}catch(qe){C((qe==null?void 0:qe.message)||`Failed to save ${i} draft`)}finally{z(!1)}},ur=x.useRef(m);ur.current=m;const Ve=x.useRef(U);Ve.current=U,x.useEffect(()=>{const qe=()=>{if(!e||sr)return;const Ye={sheet:ur.current,selectedBtls:Ve.current};Ri(n,e,Ye).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",qe),()=>window.removeEventListener("obe:before-tab-switch",qe)},[e,n,sr]);const Rt=async()=>{if(e){if(rn){C("Publishing is locked by IQAC.");return}if(!Ge){C("Publish window is closed. Please request IQAC approval.");return}ie(!0),C(null);try{await u(e,m,t),X(new Date().toLocaleString()),Ne({markEntryApprovalUntil:vt,markManagerApprovalUntil:rt}),g(qe=>({...qe,markManagerLocked:!0})),lt(),Fr({silent:!0}),Tr(!1);try{console.debug("obe:published dispatch",{assessment:n,subjectId:e}),window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:n}}))}catch{}}catch(qe){C((qe==null?void 0:qe.message)||`Failed to publish ${i}`)}finally{ie(!1)}}},_t=async()=>{Rn(!0),Sn(null),C(null);try{await _h({assessment:n,subject_code:e,reason:en,teaching_assignment_id:t}),Sn("Request sent to IQAC for approval.")}catch(qe){C((qe==null?void 0:qe.message)||"Failed to request approval")}finally{Rn(!1),lt()}};function Xt(qe){return JSON.stringify({maxTotal:w,coMax:k,selectedBtls:U.slice(),btlMax:j})}async function Ue(){if(e){pt(!0),ir(null);try{const qe=await il({assessment:n,subject_code:String(e),scope:"MARK_MANAGER",reason:`Edit request: Mark Manager changes for ${i} ${e}`,teaching_assignment_id:t});alert(al(qe))}catch(qe){const Ye=sl(qe,"Request failed");ir(Ye),alert(`Edit request failed: ${Ye}`)}finally{pt(!1)}}}async function Ct(){if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}if(Wt){alert("Edit request is pending. Please wait for approval.");return}const Ye=String(W||"").trim();if(!Ye){Te("Reason is required.");return}Z(!0),Te(null);try{const ot=await il({assessment:n,subject_code:String(e),scope:"MARK_ENTRY",reason:Ye,teaching_assignment_id:t});alert(al(ot)),O(!1),ae(""),Dt(Date.now()+24*60*60*1e3);try{Vt({silent:!0})}catch{}Fr({silent:!0}),lt()}catch(ot){const $e=sl(ot,"Request failed");Te($e),alert(`Edit request failed: ${$e}`)}finally{Z(!1)}}async function et(){if(e){pt(!0),ir(null);try{const qe=Xt(m),Ye=Tt!=null&&Tt.approval_until?String(Tt.approval_until):m.markManagerApprovalUntil||null,ot={...m,markManagerLocked:!0,markManagerSnapshot:qe,markManagerApprovalUntil:Ye},$e={sheet:ot,selectedBtls:U};g(ot),je(null),vr(!0),await Ri(n,String(e),$e),H(new Date().toLocaleString());try{await dh(n,String(e),t),Fr({silent:!0})}catch(kt){console.warn("confirmMarkManagerLock failed",kt)}}catch(qe){ir((qe==null?void 0:qe.message)||"Save failed")}finally{pt(!1),setTimeout(()=>vr(!1),2e3)}}}const ut=()=>{confirm(`Reset ${i} marks for all students in this section?`)&&(sr||g(qe=>({...qe,rows:(qe.rows||[]).map(Ye=>({...Ye,total:""}))})))},Bt=(qe,Ye)=>{g(ot=>{const $e=ot.rows.slice(),kt=$e[qe]||{studentId:0,section:"",registerNo:"",name:"",total:""};return $e[qe]={...kt,...Ye},{...ot,rows:$e}})},Kt=()=>{const qe=m.rows.map((Ye,ot)=>{const $e=typeof Ye.total=="number"?no(Number(Ye.total),0,w):null,kt=$e==null?"":ql($e),Zt=$e==null?null:ql($e/2),sn=Zt==null?null:no(Zt,0,k.co1),mn=Zt==null?null:no(Zt,0,k.co2),hn=Er.map(at=>at-1),Ir=[j.btl1,j.btl2,j.btl3,j.btl4,j.btl5,j.btl6].map((at,Re)=>hn.includes(Re)?s?A:at>0?at:Ip:at),gn=$e==null?null:hn.length?ql($e/hn.length):0,fn=Ir.map((at,Re)=>$e==null||!hn.includes(Re)?null:at>0?no(gn,0,at):ql(gn)),ve={sno:ot+1,registerNo:Ye.registerNo,name:Ye.name,co1_mark:sn??"",co1_pct:xl(sn,k.co1),co2_mark:mn??"",co2_pct:xl(mn,k.co2),btl1_mark:fn[0]??"",btl1_pct:xl(fn[0],Ir[0]),btl2_mark:fn[1]??"",btl2_pct:xl(fn[1],Ir[1]),btl3_mark:fn[2]??"",btl3_pct:xl(fn[2],Ir[2]),btl4_mark:fn[3]??"",btl4_pct:xl(fn[3],Ir[3]),btl5_mark:fn[4]??"",btl5_pct:xl(fn[4],Ir[4]),btl6_mark:fn[5]??"",btl6_pct:xl(fn[5],Ir[5])};return ve[i]=kt,ve});zxe(`${e}_${OM(i)||"SSA1"}_sheet.csv`,qe)},Jt=()=>{if(!m.rows.length)return;const qe=Number.isFinite(Number(k.co1))?Number(k.co1):0,Ye=Number.isFinite(Number(k.co2))?Number(k.co2):0,ot=["Register No","Student Name",`Q1 (${qe.toFixed(2)})`,`Q2 (${Ye.toFixed(2)})`,"Status"],$e=m.rows.map(sn=>[sn.registerNo,sn.name,"","","present"]),kt=vs.aoa_to_sheet([ot,...$e]);kt["!freeze"]={xSplit:0,ySplit:1};const It=vs.book_new();vs.book_append_sheet(It,kt,i||"SSA1");const Zt=`${e}_${OM(i)||"SSA1"}_template.xlsx`;uy(It,Zt)},ar=async()=>{const qe=m.rows.map((Ye,ot)=>({sno:ot+1,regNo:String(Ye.registerNo||""),name:String(Ye.name||""),total:Ye.total===""?"":Number(Ye.total)}));await fy({filenameBase:`${e}_${i}`,meta:{courseName:(h==null?void 0:h.courseName)||"",courseCode:(h==null?void 0:h.courseCode)||e,className:(h==null?void 0:h.className)||""},rows:qe})};function nt(qe){return String(qe??"").trim().toLowerCase().replace(/\s+/g," ")}const Ht=()=>{var qe;sr||(qe=L.current)==null||qe.click()},Pe=async qe=>{var Ye;if(qe){F(!0);try{const ot=await qe.arrayBuffer(),$e=C0(ot,{type:"array"}),kt=(Ye=$e.SheetNames)==null?void 0:Ye[0];if(!kt)throw new Error("No sheet found in the Excel file.");const It=$e.Sheets[kt],Zt=vs.sheet_to_json(It,{header:1});if(!Zt.length)throw new Error("Excel sheet is empty.");const sn=(Zt[0]||[]).map(nt),mn=dt=>sn.findIndex(Rr=>dt(Rr)),hn=mn(dt=>dt==="register no"||dt==="reg no"||dt.includes("register")),Tn=mn(dt=>dt.startsWith("q1")),Ir=mn(dt=>dt.startsWith("q2")),gn=mn(dt=>dt==="total"||dt.includes("total")),fn=mn(dt=>dt==="status"||dt.includes("status"));if(hn<0)throw new Error("Could not find Register No column.");const ve=Number.isFinite(Number(k.co1))?Number(k.co1):0,at=Number.isFinite(Number(k.co2))?Number(k.co2):0,Re=new Map;m.rows.forEach((dt,Rr)=>{const nn=String(dt.registerNo||"").trim();nn&&Re.set(nn,Rr);const tn=$k(nn);tn&&Re.set(tn,Rr)}),g(dt=>{const Rr=dt.rows.slice();for(let nn=1;nn<Zt.length;nn++){const tn=Zt[nn]||[],_n=String(tn[hn]??"").trim();if(!_n)continue;const zn=Re.get(_n);if(zn==null)continue;const ri=(fn>=0?String(tn[fn]??""):"").trim().toLowerCase(),M=ri==="absent"||ri==="ab"||ri==="a",ce=Tn>=0?Kv(tn[Tn]):null,Le=Ir>=0?Kv(tn[Ir]):null,it=gn>=0?Kv(tn[gn]):null,At=ce==null?0:no(ce,0,ve),lr=Le==null?0:no(Le,0,at),nr=it??At+lr,yr=M?0:no(nr,0,w);Rr[zn]={...Rr[zn],total:ql(yr)}}return{...dt,rows:Rr}})}finally{F(!1)}}},Ot=async qe=>{var ot;const Ye=(ot=qe.target.files)==null?void 0:ot[0];if(qe.target.value="",!!Ye)try{await Pe(Ye)}catch($e){alert(($e==null?void 0:$e.message)||"Failed to import Excel")}},mt={padding:"10px 12px",background:"linear-gradient(180deg, rgba(11,74,111,0.06), rgba(240,249,255,0.06))",color:"#0b4a6f",textAlign:"center",fontWeight:800,fontSize:12,borderBottom:"1px solid rgba(148,163,184,0.5)",borderRight:"1px solid rgba(226,232,240,0.8)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},Nt={padding:"10px 12px",fontSize:12,borderBottom:"1px solid rgba(226,232,240,0.9)",borderRight:"1px solid rgba(226,232,240,0.8)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},er={width:"100%",padding:"8px 10px",borderRadius:10,border:"1px solid rgba(226,232,240,0.9)",outline:"none",background:"rgba(255,255,255,0.9)",fontSize:12,textAlign:"center"},pr={display:"inline-flex",alignItems:"center",gap:6,padding:"4px 8px",border:"1px solid #d1d5db",borderRadius:999,background:"#fff",cursor:"pointer",userSelect:"none",fontSize:11},we={border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},Ie=qe=>{if(rn||Mt)return;const Ye=m.markManagerSnapshot!=null;ke&&Ye||se(ot=>ot.includes(qe)?ot.filter($e=>$e!==qe):ot.concat(qe).sort(($e,kt)=>$e-kt))},Ze=!!(re&&zt),bt=async()=>{if(Wt){alert("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}Te(null),O(!0)},St=Ze?bt:Rt,Sr=Ze?Wt:!!(G||!Ge||sr);return a.jsx(a.Fragment,{children:a.jsxs(ag,{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{onClick:kr,className:"obe-btn obe-btn-secondary",disabled:E,children:E?"Loading roster":"Load/Refresh Roster"}),a.jsx("button",{onClick:ut,className:"obe-btn obe-btn-danger",disabled:!m.rows.length,children:"Reset Marks"}),a.jsxs("button",{className:"obe-btn obe-btn-secondary",disabled:!zr,onClick:()=>{if(ft)return;const qe=m.rows.filter(Ye=>!!Ye.absent||Object.values(Ye).some(ot=>typeof ot=="string"&&String(ot).toLowerCase().includes("absent"))).map(Ye=>Number(Ye.studentId)).filter(Ye=>Number.isFinite(Ye));_e(qe.length?qe:null),He(!0)},title:zr?"Filter the table to show only absentees":"No absentees marked yet",style:ft?{background:"linear-gradient(180deg, #111827, #334155)",color:"#fff",borderColor:"rgba(2,6,23,0.12)"}:void 0,children:["Show absentees list",ft?a.jsx("span",{onClick:qe=>{qe.stopPropagation(),He(!1),_e(null)},role:"button","aria-label":"Close absentees list",title:"Close absentees list",style:{marginLeft:10,display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:999,background:"rgba(255,255,255,0.18)",border:"1px solid rgba(255,255,255,0.25)",fontWeight:900,lineHeight:1,cursor:"pointer",userSelect:"none"},children:""}):null]}),a.jsx("button",{onClick:Kt,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Export CSV"}),a.jsx("button",{onClick:Jt,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Export Excel"}),a.jsx("button",{onClick:Ht,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length||sr||P,children:P?"Importing":"Import Excel"}),a.jsx("input",{ref:L,type:"file",accept:".xlsx,.xls",style:{display:"none"},onChange:Ot})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:ar,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Download"}),a.jsx("button",{onClick:Gt,className:"obe-btn obe-btn-success",disabled:de||sr,title:sr?"Table locked  confirm Mark Manager to enable actions":void 0,children:de?"Saving":"Save Draft"}),a.jsx("button",{onClick:St,className:"obe-btn obe-btn-primary",disabled:Sr,title:sr?"Table locked  confirm Mark Manager to enable actions":void 0,children:Ze?Wt?"Request Pending":"Request Edit":G?"Publishing":"Publish"})]})]}),a.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{style:we,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Term"}),a.jsx("div",{style:{fontWeight:700},children:m.termLabel||""})]}),a.jsxs("div",{style:we,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Batch"}),a.jsx("div",{style:{fontWeight:700},children:m.batchLabel||""})]}),a.jsxs("div",{style:we,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Saved"}),a.jsx("div",{style:{fontWeight:700},children:K||""}),R?a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["by ",a.jsx("span",{style:{color:"#0369a1",fontWeight:700},children:R})]}):null]}),a.jsxs("div",{style:we,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Published"}),a.jsx("div",{style:{fontWeight:700},children:V||""})]})]}),a.jsx("div",{style:{marginTop:10,fontSize:12,color:Ge?"#065f46":"#b91c1c"},children:he?"Checking publish due time":ye||(Se!=null&&Se.due_at?a.jsxs(a.Fragment,{children:["Due: ",new Date(Se.due_at).toLocaleString(),"  Remaining: ",ng(ht),Se.allowed_by_approval&&Se.approval_until?a.jsxs(a.Fragment,{children:["  Approved until ",new Date(Se.approval_until).toLocaleString()]}):null]}):"Due time not set by IQAC.")}),rn?a.jsxs("div",{style:{marginTop:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),a.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:a.jsx("button",{className:"obe-btn",onClick:()=>lt(),disabled:he,children:"Refresh"})})]}):Ge?null:a.jsxs("div",{style:{marginTop:10,border:"1px solid #fecaca",background:"#fff7ed",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publish time is over"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:"Send a request to IQAC to approve publishing."}),a.jsx("textarea",{value:en,onChange:qe=>$r(qe.target.value),placeholder:"Reason (optional)",rows:3,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:[a.jsx("button",{className:"obe-btn",onClick:()=>lt(),disabled:Kr||he,children:"Refresh"}),a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:_t,disabled:Kr,children:Kr?"Requesting":"Request Approval"})]}),Pr?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:Pr}):null]}),Q?a.jsx(xs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:70},onClick:()=>ne(!1),children:a.jsxs("div",{style:{width:"min(1100px, 96vw)",maxHeight:"min(80vh, 900px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:qe=>qe.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsxs("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:["View Published ",i]}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:i}),a.jsx("button",{onClick:qe=>{qe.stopPropagation(),ne(!1)},"aria-label":"Close",style:{marginLeft:8,border:"none",background:"transparent",fontSize:20,lineHeight:1,cursor:"pointer"},children:""})]}),Ee?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading published marks"}):null,Xe?a.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:Xe}):null,a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12,background:"#fff"},children:a.jsxs("table",{className:"ssa-modern-table",style:{borderCollapse:"separate",borderSpacing:0,width:"100%",minWidth:920},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:mt,colSpan:qt,children:[m.termLabel," | ",m.batchLabel," | ",i]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...mt,width:42,minWidth:42},rowSpan:4,children:"S.No"}),a.jsx("th",{style:mt,rowSpan:4,children:"Register No."}),a.jsx("th",{style:mt,rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:mt,children:i}),null,a.jsx("th",{style:mt,colSpan:4,children:"CO ATTAINMENT"}),Er.length?a.jsx("th",{style:mt,colSpan:Er.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[a.jsxs("th",{style:mt,children:[a.jsx("div",{style:{fontWeight:800},children:"COs"}),a.jsx("div",{style:{fontSize:12},children:"1,2"})]}),null,a.jsx("th",{style:mt,colSpan:2,children:"CO-1"}),a.jsx("th",{style:mt,colSpan:2,children:"CO-2"}),Er.map(qe=>a.jsxs("th",{style:mt,colSpan:2,children:["BTL-",qe]},`btl-head-${qe}`))]}),a.jsxs("tr",{children:[a.jsxs("th",{style:mt,children:[a.jsx("div",{style:{fontWeight:800},children:"BTL"}),a.jsx("div",{style:{fontSize:12},children:Er.length?Er.join(","):"-"})]}),null,Array.from({length:2+Er.length}).flatMap((qe,Ye)=>a.jsxs(on.Fragment,{children:[a.jsx("th",{style:mt,children:"Mark"}),a.jsx("th",{style:mt,children:"%"})]},Ye))]}),a.jsxs("tr",{children:[a.jsx("th",{style:mt,children:"Name / Max Marks"}),a.jsx("th",{style:mt,children:w}),null,a.jsx("th",{style:mt,children:k.co1}),a.jsx("th",{style:mt,children:"%"}),a.jsx("th",{style:mt,children:k.co2}),a.jsx("th",{style:mt,children:"%"}),Er.flatMap(qe=>[a.jsx("th",{style:mt,children:String(s?A:Math.max(Number(j[`btl${qe}`]??0)||0,Ip))},`btl-max-${qe}`),a.jsx("th",{style:mt,children:"%"},`btl-pct-${qe}`)])]})]}),a.jsx("tbody",{children:m.rows.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:qt,style:{padding:14,color:"#6b7280",fontSize:13},children:"No students loaded yet. Choose a Teaching Assignment above, then click Load/Refresh Roster."})}):bn.map((qe,Ye)=>{var fn;const ot=((fn=Ae==null?void 0:Ae.marks)==null?void 0:fn[String(qe.studentId)])??null,$e=ot==null||ot===""?null:no(Number(ot),0,w),It=$e==null?null:ql($e/2),Zt=It==null?null:no(It,0,k.co1),sn=It==null?null:no(It,0,k.co2),mn=Er.map(ve=>ve-1),Tn=[j.btl1,j.btl2,j.btl3,j.btl4,j.btl5,j.btl6].map((ve,at)=>mn.includes(at)?s?A:ve>0?ve:Ip:ve),Ir=$e==null?null:mn.length?ql($e/mn.length):0,gn=Tn.map((ve,at)=>$e==null||!mn.includes(at)?null:ve>0?no(Ir,0,ve):ql(Ir));return a.jsxs("tr",{style:{background:Ye%2===1?"#f8fafc":"#fff"},children:[a.jsx("td",{style:{...Nt,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Ye+1}),a.jsx("td",{style:Nt,children:$k(qe.registerNo)}),a.jsx("td",{style:Nt,children:qe.name}),a.jsx("td",{style:{...Nt,width:90,background:"#fff7ed",textAlign:"center"},children:$e==null?"":ql($e)}),null,a.jsx("td",{style:{...Nt,textAlign:"center"},children:Zt??""}),a.jsx("td",{style:{...Nt,textAlign:"center"},children:xl(Zt,k.co1)}),a.jsx("td",{style:{...Nt,textAlign:"center"},children:sn??""}),a.jsx("td",{style:{...Nt,textAlign:"center"},children:xl(sn,k.co2)}),Er.map(ve=>{const at=ve-1,Re=gn[at],dt=Tn[at];return a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...Nt,textAlign:"center"},children:Re??""}),a.jsx("td",{style:{...Nt,textAlign:"center"},children:xl(Re,dt)})]},ve)})]},String(qe.studentId||Ye))})})]})}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{className:"obe-btn",onClick:()=>ne(!1),children:"Close"})})]})})}):null,(B||Y)&&a.jsx("div",{style:{marginTop:10,color:"#b91c1c",fontSize:13},children:B||Y}),a.jsxs("div",{style:{marginTop:12,...we},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("div",{style:{fontWeight:800},children:"Mark Manager"}),a.jsx("div",{children:a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>{const qe=m.markManagerSnapshot!=null;je({mode:qe?"request":"confirm"})},disabled:!e||Mt,children:m.markManagerSnapshot?"Edit":"Save"})})]}),a.jsxs("div",{style:{marginTop:8,fontSize:13,color:"#6b7280"},children:[a.jsxs("div",{children:["Max ",i,": ",a.jsx("strong",{style:{color:"#111"},children:w})]}),a.jsxs("div",{children:["CO-1 max: ",a.jsx("strong",{style:{color:"#111"},children:k.co1}),"  CO-2 max: ",a.jsx("strong",{style:{color:"#111"},children:k.co2})]}),a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Selected BTLs:"}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[1,2,3,4,5,6].map(qe=>{const Ye=U.includes(qe),ot=!!(ke&&m.markManagerSnapshot!=null);return a.jsxs("div",{onClick:()=>Ie(qe),style:{...pr,borderColor:Ye?"#16a34a":"#cbd5e1",background:Ye?"#ecfdf5":"#fff",cursor:ot||Mt?"not-allowed":"pointer",opacity:ot?.6:1,padding:"6px 8px"},"aria-disabled":ot||Mt,children:[a.jsx("input",{type:"checkbox",checked:Ye,readOnly:!0,style:{marginRight:6}}),a.jsxs("span",{style:{fontWeight:800},children:["BTL",qe]})]},`card_btl_${qe}`)})})]})]}),Ut?a.jsx("div",{style:{marginTop:8,color:"#991b1b"},children:Ut}):null]}),a.jsx("div",{style:{marginTop:14},children:Zr?a.jsx("div",{className:"obe-table-wrapper",style:{overflowX:"auto"},children:a.jsx(ig,{locked:!!(rn||zt||re&&gr),title:rn?"Locked by IQAC":te?"Published  Locked":"Table Locked",subtitle:rn?"Publishing is turned OFF globally for this assessment.":te?"Marks are published. Request IQAC approval to edit.":"Confirm the Mark Manager",children:a.jsxs("table",{className:"ssa-modern-table",style:{borderCollapse:"separate",borderSpacing:0,width:"100%",minWidth:920},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:mt,colSpan:qt,children:[m.termLabel," | ",m.batchLabel," | ",i]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...mt,width:42,minWidth:42},rowSpan:4,children:"S.No"}),a.jsx("th",{style:mt,rowSpan:4,children:"Register No."}),a.jsx("th",{style:mt,rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:mt,children:i}),null,a.jsx("th",{style:mt,colSpan:4,children:"CO ATTAINMENT"}),Er.length?a.jsx("th",{style:mt,colSpan:Er.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[a.jsxs("th",{style:mt,children:[a.jsx("div",{style:{fontWeight:800},children:"COs"}),a.jsx("div",{style:{fontSize:12},children:"1,2"})]}),null,a.jsx("th",{style:mt,colSpan:2,children:"CO-1"}),a.jsx("th",{style:mt,colSpan:2,children:"CO-2"}),Er.map(qe=>a.jsxs("th",{style:mt,colSpan:2,children:["BTL-",qe]},`btl-head-${qe}`))]}),a.jsxs("tr",{children:[a.jsxs("th",{style:mt,children:[a.jsx("div",{style:{fontWeight:800},children:"BTL"}),a.jsx("div",{style:{fontSize:12},children:Er.length?Er.join(","):"-"})]}),null,Array.from({length:2+Er.length}).flatMap((qe,Ye)=>a.jsxs(on.Fragment,{children:[a.jsx("th",{style:mt,children:"Mark"}),a.jsx("th",{style:mt,children:"%"})]},Ye))]}),a.jsxs("tr",{children:[a.jsx("th",{style:mt,children:"Name / Max Marks"}),a.jsx("th",{style:mt,children:w}),null,a.jsx("th",{style:mt,children:k.co1}),a.jsx("th",{style:mt,children:"%"}),a.jsx("th",{style:mt,children:k.co2}),a.jsx("th",{style:mt,children:"%"}),Er.flatMap(qe=>[a.jsx("th",{style:mt,children:String(s?A:$xe(j[`btl${qe}`]))},`btl-max-${qe}`),a.jsx("th",{style:mt,children:"%"},`btl-pct-${qe}`)])]})]}),a.jsx("tbody",{children:m.rows.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:qt,style:{padding:14,color:"#6b7280",fontSize:13},children:"No students loaded yet. Choose a Teaching Assignment above, then click Load/Refresh Roster."})}):sr&&!zt?a.jsx("tr",{children:a.jsx("td",{colSpan:qt,style:{padding:20,textAlign:"center",color:"#065f46",fontWeight:900},children:"Table locked  confirm the Mark Manager to enable student marks"})}):bn.map((qe,Ye)=>{const ot=typeof qe.total=="number"?no(Number(qe.total),0,w):null,$e=ot==null?null:ql(ot/2),kt=$e==null?null:no($e,0,k.co1),It=$e==null?null:no($e,0,k.co2),Zt=Er.map(Ir=>Ir-1),mn=[j.btl1,j.btl2,j.btl3,j.btl4,j.btl5,j.btl6].map((Ir,gn)=>Zt.includes(gn)?s?A:Ir>0?Ir:Ip:Ir),hn=ot==null?null:Zt.length?ql(ot/Zt.length):0,Tn=mn.map((Ir,gn)=>ot==null||!Zt.includes(gn)?null:Ir>0?no(hn,0,Ir):ql(hn));return a.jsxs("tr",{style:{background:Ye%2===1?"#f8fafc":"#fff"},children:[a.jsx("td",{style:{...Nt,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Ye+1}),a.jsx("td",{style:Nt,children:$k(qe.registerNo)}),a.jsx("td",{style:Nt,children:qe.name}),a.jsx("td",{style:{...Nt,width:90,background:"#fff7ed"},children:Lr?a.jsx("div",{style:er,children:typeof qe.total=="number"?ql(qe.total):""}):a.jsx("input",{style:er,type:"number",value:qe.total,min:0,max:w,onChange:Ir=>{if(Lr)return;const gn=Ir.target.value;if(gn==="")return Bt(Ye,{total:""});const fn=Number(gn);if(!Number.isFinite(fn))return Bt(Ye,{total:""});if(fn>w){Ir.currentTarget.setCustomValidity(`Max mark is ${w}`),Ir.currentTarget.reportValidity(),window.setTimeout(()=>Ir.currentTarget.setCustomValidity(""),0);return}Ir.currentTarget.setCustomValidity("");const ve=no(fn,0,w);Bt(Ye,{total:ve})}})}),null,a.jsx("td",{style:{...Nt,textAlign:"center"},children:kt??""}),a.jsx("td",{style:{...Nt,textAlign:"center"},children:xl(kt,k.co1)}),a.jsx("td",{style:{...Nt,textAlign:"center"},children:It??""}),a.jsx("td",{style:{...Nt,textAlign:"center"},children:xl(It,k.co2)}),Er.map(Ir=>{const gn=Ir-1,fn=Tn[gn],ve=mn[gn];return a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...Nt,textAlign:"center"},children:fn??""}),a.jsx("td",{style:{...Nt,textAlign:"center"},children:xl(fn,ve)})]},Ir)})]},String(qe.studentId||Ye))})})]})})}):a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:20,background:"#fff"},children:a.jsxs("div",{style:{display:"grid",placeItems:"center",padding:40},children:[a.jsx("div",{style:{fontSize:40},children:""}),a.jsx("div",{style:{fontWeight:800,fontSize:16,marginTop:8},children:te?"Published  Locked":"Table Locked"}),a.jsx("div",{style:{color:"#6b7280",marginTop:6},children:te?"Marks published. Use View to inspect or Request Edit to ask IQAC for edit access.":"Confirm the Mark Manager to unlock the student list."}),a.jsx("div",{style:{display:"flex",gap:8,marginTop:12},children:te?a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn",onClick:()=>ne(!0),children:"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:Wt,onClick:bt,children:Wt?"Request Pending":"Request Edit"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>je({mode:"confirm"}),disabled:!e||Mt,children:"Save Mark Manager"}),a.jsx("button",{className:"obe-btn",onClick:()=>Ue(),disabled:Mt,children:"Request Access"})]})})]})})}),oe?a.jsx(xs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:80},onClick:()=>{I||O(!1)},children:a.jsxs("div",{style:{width:"min(560px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:qe=>qe.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[i,"  ",String(e||"")]})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",xt?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:W,onChange:qe=>ae(qe.target.value),placeholder:"Explain why you need to edit (required)",rows:4,className:"obe-input",style:{resize:"vertical"}})]}),me?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#b91c1c"},children:me}):null,a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:12},children:[a.jsx("button",{className:"obe-btn",disabled:I,onClick:()=>O(!1),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:I||Wt||!e||!String(W||"").trim(),onClick:Ct,children:I?"Requesting":Wt?"Request Pending":"Send Request"})]})]})})}):null,a.jsx("style",{children:`
        @keyframes markManagerGlitch {
          0%, 100% { transform: translate(0,0); filter: none; }
          10% { transform: translate(-2px, 1px); }
          20% { transform: translate(2px, -1px); }
          30% { transform: translate(-1px, -2px); }
          40% { transform: translate(1px, 2px); }
          50% { transform: translate(-2px, -1px); }
          60% { transform: translate(2px, 1px); }
          70% { transform: translate(-1px, 1px); }
          80% { transform: translate(1px, -1px); }
          90% { transform: translate(-1px, 0); }
        }
        @keyframes markManagerDust {
          0% { opacity: 0.9; transform: translate(0,0) scale(1); }
          100% { opacity: 0; transform: translate(80px, -40px) scale(0.6); }
        }
        .markManagerDustParticle {
          position: absolute;
          width: 4px;
          height: 4px;
          background: #d1d5db;
          border-radius: 50%;
          animation: markManagerDust 2s ease-out forwards;
        }

        /* SSA table modern look (UI-only) */
        .ssa-modern-table th:last-child,
        .ssa-modern-table td:last-child {
          border-right: none;
        }
        .ssa-modern-table tbody tr:nth-child(even) td {
          background: #fbfdff;
        }
        .ssa-modern-table tbody tr:hover td {
          background: rgba(2, 132, 199, 0.03);
        }
      `}),a.jsxs("div",{style:{position:"relative"},children:[ke?null:a.jsx("div",{style:{position:"absolute",inset:0,zIndex:30,pointerEvents:"none",background:"rgba(107, 114, 128, 0.15)"}}),ke?null:a.jsxs("div",{style:{position:"absolute",left:"50%",top:6,transform:"translateX(-50%)",zIndex:40,width:160,background:"#fff",border:"1px solid #e5e7eb",padding:10,borderRadius:12,display:"flex",flexDirection:"column",gap:8,alignItems:"center",boxShadow:"0 6px 18px rgba(17,24,39,0.06)"},children:[a.jsx("div",{style:{width:100,height:72,display:"grid",placeItems:"center",background:"#fff",borderRadius:8},children:a.jsx("img",{src:"https://media.lordicon.com/icons/wired/flat/94-lock-unlock.gif",alt:"locked",style:{maxWidth:72,maxHeight:72,display:"block"}})}),a.jsxs("div",{style:{textAlign:"center"},children:[a.jsx("div",{style:{fontWeight:800,color:"#111827"},children:"Table Locked"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Confirm the Mark Manager"})]})]})]}),Me?a.jsx(xs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:9999},onClick:()=>{Mt||je(null)},children:a.jsxs("div",{style:{width:"min(640px,96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:qe=>qe.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:Me.mode==="confirm"?`Confirmation - ${i}`:`Request Edit - ${i}`}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:i})]}),Me.mode==="confirm"?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"Confirm the selected settings. After confirming, Mark Manager will be applied and table will be editable."}),a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Item"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Value"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:["Max ",i]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:w})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"CO-1 max"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:k.co1})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"CO-2 max"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:k.co2})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"Selected BTLs"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",flexWrap:"wrap"},children:[1,2,3,4,5,6].map(qe=>{const Ye=U.includes(qe);return a.jsxs("div",{onClick:()=>se(ot=>ot.includes(qe)?ot.filter($e=>$e!==qe):[...ot,qe].sort(($e,kt)=>$e-kt)),style:{...pr,borderColor:Ye?"#16a34a":"#cbd5e1",background:Ye?"#ecfdf5":"#fff",cursor:Mt?"not-allowed":"pointer",padding:"6px 8px"},children:[a.jsx("input",{type:"checkbox",checked:Ye,readOnly:!0,style:{marginRight:6}}),a.jsxs("span",{style:{fontWeight:800},children:["BTL",qe]})]},`modal_btl_${qe}`)})})})]})]})]})})]}):a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. Mark Manager will remain locked until IQAC approves."}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[a.jsx("button",{className:"obe-btn",disabled:Mt,onClick:()=>je(null),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:Mt||!e,onClick:async()=>{if(e){if(Me.mode==="request"){je(null),await Ue();return}await et()}},children:Me.mode==="confirm"?"Confirm":"Send Request"})]})]})})}):null]})})}function Hxe({subjectId:e,teachingAssignmentId:t,label:r}){return a.jsx(qxe,{subjectId:e,teachingAssignmentId:t,assessmentKey:"ssa1",label:r||"SSA1"})}const Vxe=20,MM={co3:10,co4:10},kp={btl1:0,btl2:0,btl3:10,btl4:10,btl5:0,btl6:0},jp=10;function io(e,t,r){return Math.max(t,Math.min(r,e))}function Hl(e){return Math.round(e*10)/10}function yl(e,t){if(e==null)return"";if(!Number.isFinite(t)||t<=0)return"0";const r=e/t*100;return`${Number.isFinite(r)?r.toFixed(0):0}`}function Yv(e){if(e===""||e==null||typeof e=="string"&&e.trim()==="")return null;const t=Number(e);return Number.isFinite(t)?t:null}function Ap(e,t,r){const n=e==null?void 0:e.btlMax,i=(n==null?void 0:n[String(t)])??(n==null?void 0:n[`btl${t}`])??(n==null?void 0:n[t]),s=Yv(i);return s??r}function Gxe(e,t){return`${t}_sheet_${e}`}function LM(e){return String(e||"").trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_-]/g,"").slice(0,48)}function Kxe(e,t){if(!t.length)return;const r=Object.keys(t[0]),n=[r.join(",")].concat(t.map(l=>r.map(c=>{const u=l[c],d=String(u??"").replace(/\n/g," ");return d.includes(",")||d.includes('"')?`"${d.replace(/"/g,'""')}"`:d}).join(","))).join(`
`),i=new Blob([n],{type:"text/csv"}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function Yxe(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const l=r.localeCompare(n);if(l)return l}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim(),o=i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"});return o||0}function Qb(e){return e.slice(-8)}function Xxe({subjectId:e,teachingAssignmentId:t,label:r,assessmentKey:n="ssa2"}){var Ze,bt,St,Sr,Yr;const i=String(r||"SSA2"),s=n==="review2",o=!1,l=x.useMemo(()=>Gxe(e,n),[e,n]),c=n==="review2"?_S:ey,u=n==="review2"?T9:E9,[d,f]=x.useState(null),[h,p]=x.useState(null),[m,g]=x.useState({termLabel:"KRCT AY25-26",batchLabel:e,rows:[],markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null}),y=String((d==null?void 0:d.termLabel)||"KRCT AY25-26"),b=((Ze=d==null?void 0:d.assessments)==null?void 0:Ze.ssa2)||{},v=Number.isFinite(Number(b==null?void 0:b.maxTotal))?Number(b.maxTotal):Vxe,w=s?30:v,S={co3:Number.isFinite(Number((bt=b==null?void 0:b.coMax)==null?void 0:bt.co3))?Number(b.coMax.co3):Number.isFinite(Number((St=b==null?void 0:b.coMax)==null?void 0:St.co1))?Number(b.coMax.co1):MM.co3,co4:Number.isFinite(Number((Sr=b==null?void 0:b.coMax)==null?void 0:Sr.co4))?Number(b.coMax.co4):Number.isFinite(Number((Yr=b==null?void 0:b.coMax)==null?void 0:Yr.co2))?Number(b.coMax.co2):MM.co4},k=s?{co3:15,co4:15}:S,j={btl1:Ap(b,1,kp.btl1),btl2:Ap(b,2,kp.btl2),btl3:Ap(b,3,kp.btl3),btl4:Ap(b,4,kp.btl4),btl5:Ap(b,5,kp.btl5),btl6:Ap(b,6,kp.btl6)},A=s?30:jp,L=x.useRef(null),[P,F]=x.useState(!1);x.useEffect(()=>{let ct=!0;return(async()=>{try{const $t=await ku();if(!ct)return;f($t||null),g(qe=>({...qe,termLabel:String(($t==null?void 0:$t.termLabel)||qe.termLabel||"KRCT AY25-26"),batchLabel:e}))}catch{}})(),()=>{ct=!1}},[e]);const[E,T]=x.useState(!1),[B,q]=x.useState(null),[U,se]=x.useState(()=>s?[3,4]:[]),[de,z]=x.useState(!1),[G,ie]=x.useState(!1),[Y,C]=x.useState(null),[K,H]=x.useState(null),[R,J]=x.useState(null),[V,X]=x.useState(null),[Q,ne]=x.useState(!1),[oe,O]=x.useState(""),[W,ae]=x.useState(!1),[I,Z]=x.useState(null),[me,Te]=x.useState(!1),[Ae,Be]=x.useState(null),[Ee,ze]=x.useState(!1),[Xe,Pt]=x.useState(null),[ft,He]=x.useState(!1),{data:tt,loading:_e,error:Se,remainingSeconds:he,publishAllowed:ye,refresh:ht}=V0({assessment:n,subjectCode:e,teachingAssignmentId:t}),{data:Ge,loading:lt,error:jt,refresh:wt}=G0({assessment:n,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:yt,refresh:Fr}=oc({assessment:n,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!0}}),{data:Tt,refresh:hr}=oc({assessment:n,subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:t,options:{poll:!0}}),rn=!!(tt!=null&&tt.global_override_active&&(tt==null?void 0:tt.global_is_open)===!1),[en,$r]=x.useState(""),[Kr,Rn]=x.useState(!1),[Pr,Sn]=x.useState(null),[Me,je]=x.useState(null),[Mt,pt]=x.useState(!1),[Ut,ir]=x.useState(null),fr=!!(e&&!Mt),[vr,re]=x.useState(null);x.useEffect(()=>{re(null),X(null),Be(null),Pt(null)},[e,n,t]);const le=!!V||!!(Ge!=null&&Ge.exists&&(Ge!=null&&Ge.is_published))||!!Ae,te=!fr&&le,ue=!!m.markManagerLocked,Ne=Tt!=null&&Tt.approval_until?String(Tt.approval_until):null,ke=yt!=null&&yt.approval_until?String(yt.approval_until):null,vt=!!(Tt!=null&&Tt.allowed_by_approval)&&!!Ne&&Ne!==((vr==null?void 0:vr.markEntryApprovalUntil)??null),rt=!!(yt!=null&&yt.allowed_by_approval)&&!!ke&&ke!==((vr==null?void 0:vr.markManagerApprovalUntil)??null),De=le?!!(Ge!=null&&Ge.entry_open)||vt||rt:!0,We=!!(le&&!De),{pending:st,pendingUntilMs:zt,setPendingUntilMs:Wt,refresh:xt}=K0({enabled:!!(le&&We)&&!!e,assessment:n,subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:t});Y0(!!Q||!!Me||!!me);const Dt=!!(le&&We),Vt=async()=>{if(st){alert("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}Z(null),ne(!0)},gr=!!e&&(lt||!!jt||Ge==null),sr=!!(rn||gr||(Ge?!Ge.entry_open:le?!De:!ue)),Lr=m.markManagerSnapshot!=null,Zr=!!(rn||We||sr),Er=!!(le&&We&&ue),qt=x.useMemo(()=>{const ct=new Set(U);return[1,2,3,4,5,6].filter($t=>ct.has($t))},[U]),zr=x.useMemo(()=>8+qt.length*2,[o,qt.length]);x.useEffect(()=>{if(!e)return;try{const qe=`${n}_selected_btls_${e}`;Kn(qe,U)}catch{}let ct=!1;const $t=setTimeout(async()=>{try{await Ri(n,e,{sheet:m,selectedBtls:U});try{l&&Kn(l,{termLabel:m.termLabel,batchLabel:m.batchLabel,rows:m.rows})}catch{}ct||H(new Date().toLocaleString())}catch{}},700);return()=>{ct=!0,clearTimeout($t)}},[U,e,m,l,n]),x.useEffect(()=>{if(!e)return;const ct=Jn(l);ct&&typeof ct=="object"&&Array.isArray(ct.rows)?g({termLabel:d!=null&&d.termLabel?String(d.termLabel):String(ct.termLabel||"KRCT AY25-26"),batchLabel:e,rows:ct.rows,markManagerSnapshot:(ct==null?void 0:ct.markManagerSnapshot)??null,markManagerApprovalUntil:(ct==null?void 0:ct.markManagerApprovalUntil)??null,markManagerLocked:typeof(ct==null?void 0:ct.markManagerLocked)=="boolean"?ct.markManagerLocked:!!(ct!=null&&ct.markManagerSnapshot)}):g({termLabel:y||"KRCT AY25-26",batchLabel:e,rows:[],markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null})},[l,e,d,y]),x.useEffect(()=>{let ct=!0;return(async()=>{if(e)try{const $t=await ei(n,e);if(!ct)return;const qe=$t==null?void 0:$t.draft,Ye=qe==null?void 0:qe.sheet,ot=qe==null?void 0:qe.selectedBtls;if(Ye&&typeof Ye=="object"&&Array.isArray(Ye.rows)){g(It=>({...It,termLabel:String(Ye.termLabel||y||"KRCT AY25-26"),batchLabel:e,rows:Ye.rows,markManagerSnapshot:(Ye==null?void 0:Ye.markManagerSnapshot)??It.markManagerSnapshot??null,markManagerApprovalUntil:(Ye==null?void 0:Ye.markManagerApprovalUntil)??It.markManagerApprovalUntil??null,markManagerLocked:typeof(Ye==null?void 0:Ye.markManagerLocked)=="boolean"?Ye.markManagerLocked:!!((Ye==null?void 0:Ye.markManagerSnapshot)??It.markManagerSnapshot)}));const $e=($t==null?void 0:$t.updated_at)??null,kt=($t==null?void 0:$t.updated_by)??null;if($e)try{H(new Date(String($e)).toLocaleString())}catch{H(String($e))}kt&&J(String(kt.name||kt.username||kt.id||""));try{l&&Kn(l,{termLabel:String(Ye.termLabel||y||"KRCT AY25-26"),batchLabel:e,rows:Ye.rows})}catch{}}if(Array.isArray(ot)){const $e=ot.map(kt=>Number(kt)).filter(kt=>Number.isFinite(kt));se($e);try{const kt=`${n}_selected_btls_${e}`;Kn(kt,$e)}catch{}}}catch{}})(),()=>{ct=!1}},[e,y,l,n]),x.useEffect(()=>{if(!e)return;if((!!(Ge!=null&&Ge.exists&&(Ge!=null&&Ge.is_published))||!!V)&&(Ge!=null&&Ge.exists)){const Ye=!!(Ge!=null&&Ge.mark_manager_locked);!!m.markManagerLocked!==Ye&&g(ot=>({...ot,markManagerLocked:Ye}));return}const $t=!!(yt!=null&&yt.allowed_by_approval),qe=yt!=null&&yt.approval_until?String(yt.approval_until):null;if($t&&qe){if(qe===((vr==null?void 0:vr.markManagerApprovalUntil)??null))return;const Ye=m.markManagerApprovalUntil?String(m.markManagerApprovalUntil):null;m.markManagerLocked&&Ye!==qe&&g(ot=>({...ot,markManagerLocked:!1,markManagerApprovalUntil:qe}));return}},[e,Ge==null?void 0:Ge.exists,Ge==null?void 0:Ge.is_published,Ge==null?void 0:Ge.mark_manager_locked,yt==null?void 0:yt.allowed_by_approval,yt==null?void 0:yt.approval_until,m.markManagerLocked,m.markManagerApprovalUntil,V,vr==null?void 0:vr.markManagerApprovalUntil]);const bn=ct=>{g($t=>{const qe=new Map,Ye=new Map;for(const $e of $t.rows||[])typeof $e.studentId=="number"&&qe.set($e.studentId,$e),$e.registerNo&&Ye.set(String($e.registerNo),$e);const ot=(ct||[]).slice().sort(Yxe).map($e=>{const kt=qe.get($e.id)||Ye.get(String($e.reg_no||""));return{studentId:$e.id,section:String($e.section||""),registerNo:String($e.reg_no||""),name:String($e.name||""),total:typeof(kt==null?void 0:kt.total)=="number"?io(Number(kt.total),0,w):((kt==null?void 0:kt.total)==="","")}});return{...$t,rows:ot}})},or=async()=>{var ct,$t,qe;if(!e){q("Subject ID is required.");return}T(!0),q(null);try{let Ye=[],ot=null;try{const $e=await fc();console.log("[SSA2] My TAs:",$e==null?void 0:$e.length,"for subject:",e,"teachingAssignmentId:",t),ot=($e||[]).find(kt=>{const It=String(kt.subject_code||"").trim().toUpperCase()===String(e||"").trim().toUpperCase();return(t?kt.id===t:!1)||It}),ot?console.log("[SSA2] Found TA match:",ot.id,"elective_subject_id:",ot.elective_subject_id,"section_id:",ot.section_id):console.log("[SSA2] No TA match found in user TAs")}catch($e){console.warn("[SSA2] My TAs fetch failed:",$e)}if(ot&&ot.elective_subject_id&&!ot.section_id){console.log("[SSA2] Detected elective, fetching elective-choices for elective_subject_id:",ot.elective_subject_id);try{const $e=await xr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(ot.elective_subject_id))}`);if($e.ok){const kt=await $e.json(),It=Array.isArray(kt.results)?kt.results:Array.isArray(kt)?kt:kt.items||[];console.log("[SSA2] Elective choices returned:",It==null?void 0:It.length,"students"),Ye=(It||[]).map(Zt=>({id:Number(Zt.student_id??Zt.id),reg_no:String(Zt.reg_no??Zt.regno??""),name:String(Zt.name??Zt.full_name??Zt.username??""),section:Zt.section_name??Zt.section??null}))}else console.warn("[SSA2] Elective-choices API returned error:",$e.status)}catch($e){console.warn("[SSA2] Elective-choices fetch failed:",$e)}}if(!Ye.length&&ot&&ot.id){console.log("[SSA2] Fetching regular TA roster for TA ID:",ot.id);try{const $e=await Vc(ot.id);Ye=$e.students||[],p({courseName:String(((ct=$e==null?void 0:$e.teaching_assignment)==null?void 0:ct.subject_name)||(ot==null?void 0:ot.subject_name)||""),courseCode:String((($t=$e==null?void 0:$e.teaching_assignment)==null?void 0:$t.subject_code)||(ot==null?void 0:ot.subject_code)||e||""),className:String(((qe=$e==null?void 0:$e.teaching_assignment)==null?void 0:qe.section_name)||(ot==null?void 0:ot.section_name)||"")}),console.log("[SSA2] Regular roster returned:",Ye.length,"students")}catch($e){console.warn("[SSA2] TA roster fetch failed:",$e)}}console.log("[SSA2] Final roster count:",Ye.length),bn(Ye)}catch(Ye){q((Ye==null?void 0:Ye.message)||"Failed to load roster")}finally{T(!1)}};x.useEffect(()=>{e&&or()},[t,e]);async function kr(ct){if(e){ct&&ze(!0),Pt(null);try{const $t=await c(String(e));Be($t||null)}catch($t){ct&&Pt(($t==null?void 0:$t.message)||`Failed to load published ${i} marks`)}finally{ct&&ze(!1)}}}x.useEffect(()=>{e&&kr(!1)},[e,n,t]);const Tr=x.useRef(!!De);x.useEffect(()=>{Tr.current=!!De},[e,n,t,De]);const Or=x.useRef(null);async function Gt(ct=!0){try{if(ht(),wt({silent:!1}),await kr(ct),t)try{await or()}catch{}}catch{}}x.useEffect(()=>{if(!e||!le)return;if(Tr.current||!De){Tr.current=!!De;return}let $t=!0;return(async()=>{try{const qe=await ei(n,String(e));if(!$t)return;const Ye=qe==null?void 0:qe.draft,ot=Ye==null?void 0:Ye.sheet,$e=Ye==null?void 0:Ye.selectedBtls;ot&&typeof ot=="object"&&Array.isArray(ot.rows)&&g(kt=>({...kt,termLabel:String(ot.termLabel||y||"KRCT AY25-26"),batchLabel:e,rows:ot.rows,markManagerSnapshot:(ot==null?void 0:ot.markManagerSnapshot)??kt.markManagerSnapshot??null,markManagerApprovalUntil:(ot==null?void 0:ot.markManagerApprovalUntil)??kt.markManagerApprovalUntil??null,markManagerLocked:typeof(ot==null?void 0:ot.markManagerLocked)=="boolean"?ot.markManagerLocked:!!((ot==null?void 0:ot.markManagerSnapshot)??kt.markManagerSnapshot)})),Array.isArray($e)&&se($e.map(kt=>Number(kt)).filter(kt=>Number.isFinite(kt)));return}catch{}$t&&kr(!1)})(),Tr.current=!!De,()=>{$t=!1}},[De,le,e,n,y]),x.useEffect(()=>{if(!e||!le||De)return;const ct=window.setInterval(()=>{wt({silent:!0})},3e4);return()=>window.clearInterval(ct)},[De,le,e,wt]),x.useEffect(()=>{me&&e&&(Be(null),kr(!0))},[me,e]);const ur=async()=>{z(!0),C(null);try{await Ri(n,e,{sheet:m,selectedBtls:U}),H(new Date().toLocaleString())}catch(ct){C((ct==null?void 0:ct.message)||`Failed to save ${i} draft`)}finally{z(!1)}},Ve=x.useRef(m);Ve.current=m;const Rt=x.useRef(U);Rt.current=U,x.useEffect(()=>{const ct=()=>{if(!e||sr)return;const $t={sheet:Ve.current,selectedBtls:Rt.current};Ri(n,e,$t).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",ct),()=>window.removeEventListener("obe:before-tab-switch",ct)},[e,n,sr]);const _t=async()=>{if(e){if(rn){C("Publishing is locked by IQAC.");return}if(!ye){C("Publish window is closed. Please request IQAC approval.");return}if(le&&We){if(st){C("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}ne(!0);return}ie(!0),C(null);try{await u(e,m,t),X(new Date().toLocaleString()),re({markEntryApprovalUntil:Ne,markManagerApprovalUntil:ke}),g(ct=>({...ct,markManagerLocked:!0})),ht(),wt({silent:!0}),kr(!1),setTimeout(()=>{try{if(me&&Or.current){const ct=Or.current;ct.scrollTop=ct.scrollHeight}}catch{}},50);try{console.debug("obe:published dispatch",{assessment:n,subjectId:e}),window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:n}}))}catch{}setTimeout(()=>{Gt(!0),He(!0),setTimeout(()=>He(!1),5e3)},2e3)}catch(ct){C((ct==null?void 0:ct.message)||`Failed to publish ${i}`)}finally{ie(!1)}}},Xt=async()=>{Rn(!0),Sn(null),C(null);try{await _h({assessment:n,subject_code:e,reason:en,teaching_assignment_id:t}),Sn("Request sent to IQAC for approval.")}catch(ct){C((ct==null?void 0:ct.message)||"Failed to request approval")}finally{Rn(!1),ht()}},Ue=()=>{confirm(`Reset ${i} marks for all students in this section?`)&&(sr||g(ct=>({...ct,rows:(ct.rows||[]).map($t=>({...$t,total:""}))})))};function Ct(ct){return JSON.stringify({maxTotal:w,coMax:k,selectedBtls:U.slice(),btlMax:j})}async function et(){if(e){pt(!0),ir(null);try{const ct=await il({assessment:n,subject_code:String(e),scope:"MARK_MANAGER",reason:`Edit request: Mark Manager changes for ${i} ${e}`,teaching_assignment_id:t});alert(al(ct));try{await(Fr?Fr({silent:!0}):Promise.resolve())}catch{}}catch(ct){const $t=sl(ct,"Request failed");ir($t),alert(`Edit request failed: ${$t}`)}finally{pt(!1)}}}async function ut(){if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}if(st){alert("Edit request is pending. Please wait for approval.");return}const $t=String(oe||"").trim();if(!$t){Z("Reason is required.");return}ae(!0),Z(null);try{const qe=await il({assessment:n,subject_code:String(e),scope:"MARK_ENTRY",reason:$t,teaching_assignment_id:t});alert(al(qe)),ne(!1),O(""),Wt(Date.now()+24*60*60*1e3);try{xt({silent:!0})}catch{}wt({silent:!0});try{await(hr?hr({silent:!0}):Promise.resolve())}catch{}}catch(qe){const Ye=sl(qe,"Request failed");Z(Ye),alert(`Edit request failed: ${Ye}`)}finally{ae(!1)}}async function Bt(){if(e){pt(!0),ir(null);try{const ct=Ct(m),$t=yt!=null&&yt.approval_until?String(yt.approval_until):m.markManagerApprovalUntil||null,qe={...m,markManagerLocked:!0,markManagerSnapshot:ct,markManagerApprovalUntil:$t},Ye={sheet:qe,selectedBtls:U};g(qe),je(null),await Ri(n,String(e),Ye),H(new Date().toLocaleString());try{await dh(n,String(e),t),wt({silent:!0})}catch(ot){console.warn("confirmMarkManagerLock failed",ot)}}catch(ct){ir((ct==null?void 0:ct.message)||"Save failed")}finally{pt(!1)}}}const Kt=(ct,$t)=>{g(qe=>{const Ye=qe.rows.slice(),ot=Ye[ct]||{studentId:0,section:"",registerNo:"",name:"",total:""};return Ye[ct]={...ot,...$t},{...qe,rows:Ye}})},Jt=()=>{const ct=m.rows.map(($t,qe)=>{const Ye=typeof $t.total=="number"?io(Number($t.total),0,w):null,ot=Ye==null?"":Hl(Ye),kt=Ye==null?null:Hl(Ye/2),It=kt==null?null:io(kt,0,k.co3),Zt=kt==null?null:io(kt,0,k.co4),sn=qt.map(fn=>fn-1),hn=[j.btl1,j.btl2,j.btl3,j.btl4,j.btl5,j.btl6].map((fn,ve)=>sn.includes(ve)?s?A:fn>0?fn:jp:fn),Tn=Ye==null?null:sn.length?Hl(Ye/sn.length):0,Ir=hn.map((fn,ve)=>Ye==null||!sn.includes(ve)?null:fn>0?io(Tn,0,fn):Hl(Tn)),gn={sno:qe+1,registerNo:Qb($t.registerNo),name:$t.name,co3_mark:It??"",co3_pct:yl(It,k.co3),co4_mark:Zt??"",co4_pct:yl(Zt,k.co4),btl1_mark:Ir[0]??"",btl1_pct:yl(Ir[0],hn[0]),btl2_mark:Ir[1]??"",btl2_pct:yl(Ir[1],hn[1]),btl3_mark:Ir[2]??"",btl3_pct:yl(Ir[2],hn[2]),btl4_mark:Ir[3]??"",btl4_pct:yl(Ir[3],hn[3]),btl5_mark:Ir[4]??"",btl5_pct:yl(Ir[4],hn[4]),btl6_mark:Ir[5]??"",btl6_pct:yl(Ir[5],hn[5])};return gn[i]=ot,gn});Kxe(`${e}_${LM(i)||"SSA2"}_sheet.csv`,ct)},ar=()=>{if(!m.rows.length)return;const ct=Number.isFinite(Number(k.co3))?Number(k.co3):0,$t=Number.isFinite(Number(k.co4))?Number(k.co4):0,qe=["Register No","Student Name",`Q1 (${ct.toFixed(2)})`,`Q2 (${$t.toFixed(2)})`,"Status"],Ye=m.rows.map(It=>[It.registerNo,It.name,"","","present"]),ot=vs.aoa_to_sheet([qe,...Ye]);ot["!freeze"]={xSplit:0,ySplit:1};const $e=vs.book_new();vs.book_append_sheet($e,ot,i||"SSA2");const kt=`${e}_${LM(i)||"SSA2"}_template.xlsx`;uy($e,kt)},nt=async()=>{const ct=m.rows.map(($t,qe)=>({sno:qe+1,regNo:String($t.registerNo||""),name:String($t.name||""),total:$t.total===""?"":Number($t.total)}));await fy({filenameBase:`${e}_${i}`,meta:{courseName:(h==null?void 0:h.courseName)||"",courseCode:(h==null?void 0:h.courseCode)||e,className:(h==null?void 0:h.className)||""},rows:ct})};function Ht(ct){return String(ct??"").trim().toLowerCase().replace(/\s+/g," ")}const Pe=()=>{var ct;sr||(ct=L.current)==null||ct.click()},Ot=async ct=>{var $t;if(ct){F(!0);try{const qe=await ct.arrayBuffer(),Ye=C0(qe,{type:"array"}),ot=($t=Ye.SheetNames)==null?void 0:$t[0];if(!ot)throw new Error("No sheet found in the Excel file.");const $e=Ye.Sheets[ot],kt=vs.sheet_to_json($e,{header:1});if(!kt.length)throw new Error("Excel sheet is empty.");const It=(kt[0]||[]).map(Ht),Zt=at=>It.findIndex(Re=>at(Re)),sn=Zt(at=>at==="register no"||at==="reg no"||at.includes("register")),mn=Zt(at=>at.startsWith("q1")),hn=Zt(at=>at.startsWith("q2")),Tn=Zt(at=>at==="total"||at.includes("total")),Ir=Zt(at=>at==="status"||at.includes("status"));if(sn<0)throw new Error("Could not find Register No column.");const gn=Number.isFinite(Number(k.co3))?Number(k.co3):0,fn=Number.isFinite(Number(k.co4))?Number(k.co4):0,ve=new Map;m.rows.forEach((at,Re)=>{const dt=String(at.registerNo||"").trim();dt&&ve.set(dt,Re);const Rr=Qb(dt);Rr&&ve.set(Rr,Re)}),g(at=>{const Re=at.rows.slice();for(let dt=1;dt<kt.length;dt++){const Rr=kt[dt]||[],nn=String(Rr[sn]??"").trim();if(!nn)continue;const tn=ve.get(nn);if(tn==null)continue;const zn=(Ir>=0?String(Rr[Ir]??""):"").trim().toLowerCase(),Hn=zn==="absent"||zn==="ab"||zn==="a",ri=mn>=0?Yv(Rr[mn]):null,M=hn>=0?Yv(Rr[hn]):null,ce=Tn>=0?Yv(Rr[Tn]):null,Le=ri==null?0:io(ri,0,gn),it=M==null?0:io(M,0,fn),At=ce??Le+it,lr=Hn?0:io(At,0,w);Re[tn]={...Re[tn],total:Hl(lr)}}return{...at,rows:Re}})}finally{F(!1)}}},mt=async ct=>{var qe;const $t=(qe=ct.target.files)==null?void 0:qe[0];if(ct.target.value="",!!$t)try{await Ot($t)}catch(Ye){alert((Ye==null?void 0:Ye.message)||"Failed to import Excel")}},Nt={padding:"10px 12px",background:"linear-gradient(180deg, rgba(11,74,111,0.06), rgba(240,249,255,0.06))",color:"#0b4a6f",textAlign:"center",fontWeight:800,fontSize:12,borderBottom:"1px solid rgba(148,163,184,0.5)",borderRight:"1px solid rgba(226,232,240,0.8)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},er={padding:"10px 12px",fontSize:12,borderBottom:"1px solid rgba(226,232,240,0.9)",borderRight:"1px solid rgba(226,232,240,0.8)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},pr={width:"100%",padding:"8px 10px",borderRadius:10,border:"1px solid rgba(226,232,240,0.9)",outline:"none",background:"rgba(255,255,255,0.9)",fontSize:12,textAlign:"center"},we={display:"inline-flex",alignItems:"center",gap:6,padding:"4px 8px",border:"1px solid #d1d5db",borderRadius:999,background:"#fff",cursor:"pointer",userSelect:"none",fontSize:11},Ie={border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"};return a.jsx(a.Fragment,{children:a.jsxs(ag,{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{onClick:or,className:"obe-btn obe-btn-secondary",disabled:E,children:E?"Loading roster":"Load/Refresh Roster"}),a.jsx("button",{onClick:Ue,className:"obe-btn obe-btn-danger",disabled:!m.rows.length,children:"Reset Marks"}),a.jsx("button",{onClick:Jt,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Export CSV"}),a.jsx("button",{onClick:ar,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Export Excel"}),a.jsx("button",{onClick:Pe,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length||sr||P,children:P?"Importing":"Import Excel"}),a.jsx("input",{ref:L,type:"file",accept:".xlsx,.xls",style:{display:"none"},onChange:mt})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:nt,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Download"}),a.jsx("button",{onClick:ur,className:"obe-btn obe-btn-success",disabled:de||sr,title:sr?"Table locked  confirm Mark Manager to enable actions":void 0,children:de?"Saving":"Save Draft"}),a.jsx("button",{onClick:_t,className:"obe-btn obe-btn-primary",disabled:Dt?st:G||!ye||sr,title:sr?"Table locked  confirm Mark Manager to enable actions":void 0,children:Dt?st?"Request Pending":"Request Edit":G?"Publishing":"Publish"})]})]}),ft?a.jsx("div",{style:{marginTop:8,padding:8,background:"#ecfdf5",border:"1px solid #bbf7d0",borderRadius:8,color:"#065f46",fontWeight:700},children:"Name list locked"}):null,a.jsx("div",{style:{marginTop:10,fontSize:12,color:ye?"#065f46":"#b91c1c"},children:_e?"Checking publish due time":Se||(tt!=null&&tt.due_at?a.jsxs(a.Fragment,{children:["Due: ",new Date(tt.due_at).toLocaleString(),"  Remaining: ",ng(he),tt.allowed_by_approval&&tt.approval_until?a.jsxs(a.Fragment,{children:["  Approved until ",new Date(tt.approval_until).toLocaleString()]}):null]}):"Due time not set by IQAC.")}),rn?a.jsxs("div",{style:{marginTop:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),a.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:a.jsx("button",{className:"obe-btn",onClick:()=>ht(),disabled:_e,children:"Refresh"})})]}):ye?null:a.jsxs("div",{style:{marginTop:10,border:"1px solid #fecaca",background:"#fff7ed",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publish time is over"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:"Send a request to IQAC to approve publishing."}),a.jsx("textarea",{value:en,onChange:ct=>$r(ct.target.value),placeholder:"Reason (optional)",rows:3,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:[a.jsx("button",{className:"obe-btn",onClick:()=>ht(),disabled:Kr||_e,children:"Refresh"}),a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:Xt,disabled:Kr,children:Kr?"Requesting":"Request Approval"})]}),Pr?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:Pr}):null]}),(B||Y)&&a.jsx("div",{style:{marginTop:10,color:"#b91c1c",fontSize:13},children:B||Y}),a.jsxs("div",{style:{marginTop:10,display:"flex",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{style:Ie,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Term"}),a.jsx("div",{style:{fontWeight:700},children:m.termLabel||""})]}),a.jsxs("div",{style:Ie,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Batch"}),a.jsx("div",{style:{fontWeight:700},children:m.batchLabel||""})]}),a.jsxs("div",{style:Ie,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Saved"}),a.jsx("div",{style:{fontWeight:700},children:K||""}),R?a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["by ",a.jsx("span",{style:{color:"#0369a1",fontWeight:700},children:R})]}):null]}),a.jsxs("div",{style:Ie,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Published"}),a.jsx("div",{style:{fontWeight:700},children:V||""})]})]}),a.jsxs("div",{style:{marginTop:12,...Ie},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("div",{style:{fontWeight:800},children:"Mark Manager"}),a.jsx("div",{children:a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>{const ct=m.markManagerSnapshot!=null;je({mode:ct?"request":"confirm"})},disabled:!e||Mt,children:m.markManagerSnapshot?"Edit":"Save"})})]}),a.jsxs("div",{style:{marginTop:8,fontSize:13,color:"#6b7280"},children:[a.jsxs("div",{children:["Max ",i,": ",a.jsx("strong",{style:{color:"#111"},children:w})]}),a.jsxs("div",{children:["CO-3 max: ",a.jsx("strong",{style:{color:"#111"},children:k.co3}),"  CO-4 max: ",a.jsx("strong",{style:{color:"#111"},children:k.co4})]}),a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Selected BTLs:"}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[1,2,3,4,5,6].map(ct=>{const $t=U.includes(ct),qe=!!(ue&&m.markManagerSnapshot!=null);return a.jsxs("div",{onClick:()=>{if(rn||Mt)return;const Ye=m.markManagerSnapshot!=null;ue&&Ye||se(ot=>ot.includes(ct)?ot.filter($e=>$e!==ct):ot.concat(ct).sort(($e,kt)=>$e-kt))},style:{...we,borderColor:$t?"#16a34a":"#cbd5e1",background:$t?"#ecfdf5":"#fff",cursor:qe||Mt?"not-allowed":"pointer",opacity:qe?.6:1,padding:"6px 8px"},"aria-disabled":qe||Mt,children:[a.jsx("input",{type:"checkbox",checked:$t,readOnly:!0,style:{marginRight:6}}),a.jsxs("span",{style:{fontWeight:800},children:["BTL",ct]})]},`card_btl_${ct}`)})})]})]}),Ut?a.jsx("div",{style:{marginTop:8,color:"#991b1b"},children:Ut}):null]}),a.jsx("div",{style:{marginTop:14},children:Lr?a.jsxs("div",{style:{position:"relative"},children:[a.jsx("div",{className:"obe-table-wrapper",style:{overflowX:"auto"},children:a.jsx(ig,{locked:!!(rn||We||le&&gr),title:rn?"Locked by IQAC":te?"Published  Locked":"Table Locked",subtitle:rn?"Publishing is turned OFF globally for this assessment.":te?"Marks are published. Request IQAC approval to edit.":"Confirm the Mark Manager",children:a.jsxs("table",{className:"ssa-modern-table",style:{borderCollapse:"separate",borderSpacing:0,width:"100%",minWidth:920},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:Nt,colSpan:zr,children:[m.termLabel," | ",m.batchLabel," | ",i]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...Nt,width:42,minWidth:42},rowSpan:4,children:"S.No"}),a.jsx("th",{style:Nt,rowSpan:4,children:"Register No."}),a.jsx("th",{style:Nt,rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:Nt,children:i}),null,a.jsx("th",{style:Nt,colSpan:4,children:"CO ATTAINMENT"}),qt.length?a.jsx("th",{style:Nt,colSpan:qt.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[a.jsxs("th",{style:Nt,children:[a.jsx("div",{style:{fontWeight:800},children:"COs"}),a.jsx("div",{style:{fontSize:12},children:"3,4"})]}),null,a.jsx("th",{style:Nt,colSpan:2,children:"CO-3"}),a.jsx("th",{style:Nt,colSpan:2,children:"CO-4"}),qt.map(ct=>a.jsxs("th",{style:Nt,colSpan:2,children:["BTL-",ct]},`btl-head-${ct}`))]}),a.jsxs("tr",{children:[a.jsxs("th",{style:Nt,children:[a.jsx("div",{style:{fontWeight:800},children:"BTL"}),a.jsx("div",{style:{fontSize:12},children:qt.length?qt.join(","):"-"})]}),null,Array.from({length:2+qt.length}).flatMap((ct,$t)=>a.jsxs(on.Fragment,{children:[a.jsx("th",{style:Nt,children:"Mark"}),a.jsx("th",{style:Nt,children:"%"})]},$t))]}),a.jsxs("tr",{children:[a.jsx("th",{style:Nt,children:"Name / Max Marks"}),a.jsx("th",{style:Nt,children:w}),null,a.jsx("th",{style:Nt,children:k.co3}),a.jsx("th",{style:Nt,children:"%"}),a.jsx("th",{style:Nt,children:k.co4}),a.jsx("th",{style:Nt,children:"%"}),qt.flatMap(ct=>[a.jsx("th",{style:Nt,children:String(s?A:Math.max(Number(j[`btl${ct}`]??0)||0,jp))},`btl-max-${ct}`),a.jsx("th",{style:Nt,children:"%"},`btl-pct-${ct}`)])]})]}),a.jsx("tbody",{children:m.rows.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:zr,style:{padding:14,color:"#6b7280",fontSize:13},children:"No students loaded yet. Choose a Teaching Assignment above, then click Load/Refresh Roster."})}):sr&&!We?a.jsx("tr",{children:a.jsx("td",{colSpan:zr,style:{padding:20,textAlign:"center",color:"#065f46",fontWeight:900},children:"Table locked  confirm the Mark Manager to enable student marks"})}):m.rows.map((ct,$t)=>{const qe=typeof ct.total=="number"?io(Number(ct.total),0,w):null,Ye=qe==null?null:Hl(qe/2),ot=Ye==null?null:io(Ye,0,k.co3),$e=Ye==null?null:io(Ye,0,k.co4),kt=qt.map(hn=>hn-1),Zt=[j.btl1,j.btl2,j.btl3,j.btl4,j.btl5,j.btl6].map((hn,Tn)=>kt.includes(Tn)?s?A:hn>0?hn:jp:hn),sn=qe==null?null:kt.length?Hl(qe/kt.length):0,mn=Zt.map((hn,Tn)=>qe==null||!kt.includes(Tn)?null:hn>0?io(sn,0,hn):Hl(sn));return a.jsxs("tr",{style:{background:$t%2===1?"#f8fafc":"#fff"},children:[a.jsx("td",{style:{...er,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:$t+1}),a.jsx("td",{style:er,children:Qb(ct.registerNo)}),a.jsx("td",{style:er,children:ct.name}),a.jsx("td",{style:{...er,width:90,background:"#fff7ed"},children:Zr?a.jsx("div",{style:pr,children:typeof ct.total=="number"?Hl(ct.total):""}):a.jsx("input",{style:pr,type:"number",value:ct.total,min:0,max:w,onChange:hn=>{if(Zr)return;const Tn=hn.target.value;if(Tn==="")return Kt($t,{total:""});const Ir=Number(Tn);if(!Number.isFinite(Ir))return Kt($t,{total:""});if(Ir>w){hn.currentTarget.setCustomValidity(`Max mark is ${w}`),hn.currentTarget.reportValidity(),window.setTimeout(()=>hn.currentTarget.setCustomValidity(""),0);return}hn.currentTarget.setCustomValidity("");const gn=io(Ir,0,w);Kt($t,{total:gn})}})}),null,a.jsx("td",{style:{...er,textAlign:"center"},children:ot??""}),a.jsx("td",{style:{...er,textAlign:"center"},children:yl(ot,k.co3)}),a.jsx("td",{style:{...er,textAlign:"center"},children:$e??""}),a.jsx("td",{style:{...er,textAlign:"center"},children:yl($e,k.co4)}),qt.map(hn=>{const Tn=hn-1,Ir=mn[Tn],gn=Zt[Tn];return a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...er,textAlign:"center"},children:Ir??""}),a.jsx("td",{style:{...er,textAlign:"center"},children:yl(Ir,gn)})]},hn)})]},String(ct.studentId||$t))})})]})})}),Er&&Lr?a.jsxs("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:40,width:360,background:"#fff",border:"1px solid #e5e7eb",padding:10,borderRadius:12,display:"flex",flexDirection:"column",gap:8,alignItems:"center",boxShadow:"0 6px 18px rgba(17,24,39,0.06)"},children:[a.jsx("div",{style:{textAlign:"center"},children:te?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontWeight:900,color:"#065f46"},children:"Published"}),a.jsx("div",{style:{fontSize:13,color:"#065f46"},children:"Marks are locked. Request IQAC approval to edit."})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontWeight:900,color:"#065f46"},children:"Table Locked"}),a.jsx("div",{style:{fontSize:13,color:"#065f46"},children:"Confirm the Mark Manager"})]})}),a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center"},children:[a.jsx("button",{className:"obe-btn",onClick:()=>Te(!0),children:"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:st,onClick:Vt,children:st?"Request Pending":"Request Edit"})]})]}):null]}):a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:20,background:"#fff"},children:a.jsxs("div",{style:{display:"grid",placeItems:"center",padding:40},children:[a.jsx("div",{style:{fontWeight:800,fontSize:16,marginTop:8},children:te&&Lr?"Published  Locked":"Table Locked"}),a.jsx("div",{style:{color:"#6b7280",marginTop:6},children:te&&Lr?"Marks published. Use View to inspect or Request Edit to ask IQAC for edit access.":"Confirm the Mark Manager to unlock the student list."}),a.jsx("div",{style:{display:"flex",gap:8,marginTop:12},children:te&&Lr?a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn",onClick:()=>Te(!0),children:"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:st,onClick:Vt,children:st?"Request Pending":"Request Edit"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>je({mode:"confirm"}),disabled:!e||Mt,children:"Save Mark Manager"}),a.jsx("button",{className:"obe-btn",onClick:()=>et(),disabled:Mt,children:"Request Access"})]})})]})})}),me?a.jsx(xs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:70},onClick:()=>Te(!1),children:a.jsxs("div",{style:{width:"min(1100px, 96vw)",maxHeight:"min(80vh, 900px)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:0,display:"flex",flexDirection:"column"},onClick:ct=>ct.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"12px 14px",borderBottom:"1px solid #eef2f7"},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Only"}),a.jsx("button",{onClick:ct=>{ct.stopPropagation(),Te(!1)},"aria-label":"Close",style:{marginLeft:"auto",border:"none",background:"transparent",fontSize:20,lineHeight:1,cursor:"pointer"},children:""})]}),a.jsxs("div",{style:{padding:14},children:[Ee?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading published marks"}):null,Xe?a.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:Xe}):null]}),a.jsx("div",{ref:Or,style:{overflow:"auto",borderTop:"1px solid #e5e7eb",borderBottom:"1px solid #e5e7eb",borderLeft:"1px solid #e5e7eb",borderRight:"1px solid #e5e7eb",borderRadius:0,maxHeight:"60vh",background:"#fff"},children:a.jsxs("table",{className:"ssa-modern-table",style:{borderCollapse:"separate",borderSpacing:0,width:"100%",minWidth:920},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:Nt,colSpan:zr,children:[m.termLabel," | ",m.batchLabel," | ",i]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...Nt,width:42,minWidth:42},rowSpan:4,children:"S.No"}),a.jsx("th",{style:Nt,rowSpan:4,children:"Register No."}),a.jsx("th",{style:Nt,rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:Nt,children:i}),null,a.jsx("th",{style:Nt,colSpan:4,children:"CO ATTAINMENT"}),qt.length?a.jsx("th",{style:Nt,colSpan:qt.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[a.jsxs("th",{style:Nt,children:[a.jsx("div",{style:{fontWeight:800},children:"COs"}),a.jsx("div",{style:{fontSize:12},children:"3,4"})]}),null,a.jsx("th",{style:Nt,colSpan:2,children:"CO-3"}),a.jsx("th",{style:Nt,colSpan:2,children:"CO-4"}),qt.map(ct=>a.jsxs("th",{style:Nt,colSpan:2,children:["BTL-",ct]},`btl-head-${ct}`))]}),a.jsxs("tr",{children:[a.jsxs("th",{style:Nt,children:[a.jsx("div",{style:{fontWeight:800},children:"BTL"}),a.jsx("div",{style:{fontSize:12},children:qt.length?qt.join(","):"-"})]}),null,Array.from({length:2+qt.length}).flatMap((ct,$t)=>a.jsxs(on.Fragment,{children:[a.jsx("th",{style:Nt,children:"Mark"}),a.jsx("th",{style:Nt,children:"%"})]},$t))]}),a.jsxs("tr",{children:[a.jsx("th",{style:Nt,children:"Name / Max Marks"}),a.jsx("th",{style:Nt,children:w}),null,a.jsx("th",{style:Nt,children:k.co3}),a.jsx("th",{style:Nt,children:"%"}),a.jsx("th",{style:Nt,children:k.co4}),a.jsx("th",{style:Nt,children:"%"}),qt.flatMap(ct=>[a.jsx("th",{style:Nt,children:String(s?A:Math.max(Number(j[`btl${ct}`]??0)||0,jp))},`btl-max-${ct}`),a.jsx("th",{style:Nt,children:"%"},`btl-pct-${ct}`)])]})]}),a.jsx("tbody",{children:m.rows.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:zr,style:{padding:14,color:"#6b7280",fontSize:13},children:"No students loaded yet. Choose a Teaching Assignment above, then click Load/Refresh Roster."})}):m.rows.map((ct,$t)=>{var Ir;const qe=((Ir=Ae==null?void 0:Ae.marks)==null?void 0:Ir[String(ct.studentId)])??null,Ye=qe==null||qe===""?null:io(Number(qe),0,w),$e=Ye==null?null:Hl(Ye/2),kt=$e==null?null:io($e,0,k.co3),It=$e==null?null:io($e,0,k.co4),Zt=qt.map(gn=>gn-1),mn=[j.btl1,j.btl2,j.btl3,j.btl4,j.btl5,j.btl6].map((gn,fn)=>Zt.includes(fn)?s?A:gn>0?gn:jp:gn),hn=Ye==null?null:Zt.length?Hl(Ye/Zt.length):0,Tn=mn.map((gn,fn)=>Ye==null||!Zt.includes(fn)?null:gn>0?io(hn,0,gn):Hl(hn));return a.jsxs("tr",{style:{background:$t%2===1?"#f8fafc":"#fff"},children:[a.jsx("td",{style:{...er,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:$t+1}),a.jsx("td",{style:er,children:Qb(ct.registerNo)}),a.jsx("td",{style:er,children:ct.name}),a.jsx("td",{style:{...er,width:90,background:"#fff7ed",textAlign:"center"},children:Ye==null?"":Hl(Ye)}),null,a.jsx("td",{style:{...er,textAlign:"center"},children:kt??""}),a.jsx("td",{style:{...er,textAlign:"center"},children:yl(kt,k.co3)}),a.jsx("td",{style:{...er,textAlign:"center"},children:It??""}),a.jsx("td",{style:{...er,textAlign:"center"},children:yl(It,k.co4)}),qt.map(gn=>{const fn=gn-1,ve=Tn[fn],at=mn[fn];return a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...er,textAlign:"center"},children:ve??""}),a.jsx("td",{style:{...er,textAlign:"center"},children:yl(ve,at)})]},gn)})]},String(ct.studentId||$t))})})]})}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{className:"obe-btn",onClick:()=>Te(!1),children:"Close"})})]})})}):null,Me?a.jsx(xs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:9999},onClick:()=>{Mt||je(null)},children:a.jsxs("div",{style:{width:"min(640px,96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:ct=>ct.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:Me.mode==="confirm"?`Confirmation - ${i}`:`Request Edit - ${i}`}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:i})]}),Me.mode==="confirm"?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"Confirm the selected settings. After confirming, Mark Manager will be applied and table will be editable."}),a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Item"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Value"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:["Max ",i]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:w})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"CO-3 max"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:k.co3})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"CO-4 max"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:k.co4})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"Selected BTLs"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",flexWrap:"wrap"},children:[1,2,3,4,5,6].map(ct=>{const $t=U.includes(ct);return a.jsxs("div",{onClick:()=>{Mt||se(qe=>qe.includes(ct)?qe.filter(Ye=>Ye!==ct):[...qe,ct].sort((Ye,ot)=>Ye-ot))},style:{...we,borderColor:$t?"#16a34a":"#cbd5e1",background:$t?"#ecfdf5":"#fff",cursor:Mt?"not-allowed":"pointer",padding:"6px 8px"},children:[a.jsx("input",{type:"checkbox",checked:$t,readOnly:!0,style:{marginRight:6}}),a.jsxs("span",{style:{fontWeight:800},children:["BTL",ct]})]},`modal_btl_${ct}`)})})})]})]})]})})]}):a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. Mark Manager will remain locked until IQAC approves."}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[a.jsx("button",{className:"obe-btn",disabled:Mt,onClick:()=>je(null),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:Mt||!e,onClick:async()=>{if(e){if(Me.mode==="request"){je(null),await et();return}await Bt()}},children:Me.mode==="confirm"?"Confirm":"Send Request"})]})]})})}):null,Q?a.jsx(xs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>{W||ne(!1)},children:a.jsxs("div",{style:{width:"min(560px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:ct=>ct.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:i})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",zt?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{fontSize:13,color:"#374151",marginBottom:10,lineHeight:1.35},children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Subject:"})," ",String(e||"")]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Published:"})," ",V||""]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Saved:"})," ",K||""]})]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:oe,onChange:ct=>O(ct.target.value),placeholder:"Explain why you need to edit (required)",rows:4,className:"obe-input",style:{resize:"vertical"}})]}),I?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#b91c1c"},children:I}):null,a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[a.jsx("button",{type:"button",className:"obe-btn",disabled:W,onClick:()=>ne(!1),children:"Cancel"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-primary",disabled:W||st||!e||!String(oe||"").trim(),onClick:async()=>{await ut()},children:W?"Requesting":st?"Request Pending":"Send Request"})]})]})})}):null,a.jsx("style",{children:`
        /* SSA table modern look (UI-only) */
        .ssa-modern-table th:last-child,
        .ssa-modern-table td:last-child {
          border-right: none;
        }
        .ssa-modern-table tbody tr:nth-child(even) td {
          background: #fbfdff;
        }
        .ssa-modern-table tbody tr:hover td {
          background: rgba(2, 132, 199, 0.03);
        }
      `}),a.jsx("div",{style:{marginTop:14},children:Lr?a.jsx("div",{className:"obe-table-wrapper",style:{overflowX:"auto"}}):null})]})})}function Qxe({subjectId:e,teachingAssignmentId:t,label:r}){return a.jsx(Xxe,{subjectId:e,teachingAssignmentId:t,assessmentKey:"ssa2",label:r||"SSA2"})}const Jb=[{key:"q1",max:2},{key:"q2",max:2},{key:"q3",max:2},{key:"q4",max:2},{key:"q5",max:2},{key:"q6",max:2},{key:"q7",max:2},{key:"q8",max:2},{key:"q9",max:2},{key:"q10",max:2},{key:"q11",max:14},{key:"q12",max:14},{key:"q13",max:14},{key:"q14",max:14},{key:"q15",max:14},{key:"q16",max:10}],RM=[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5,5];function kd(e,t,r){return Math.max(t,Math.min(r,e))}function Jxe(e){const t=Array.isArray(e)?e:[];return new Set(t.map(r=>String(r||"").trim().toLowerCase()).filter(Boolean))}function FM(e,t){if(Array.isArray(e)){const r=e.slice(0,t).map(n=>typeof n=="number"&&Number.isFinite(n)?n:"");for(;r.length<t;)r.push("");return r}return new Array(t).fill("")}function BM(e){const t=(e||[]).filter(r=>typeof r=="number"&&Number.isFinite(r));return t.length?t.reduce((r,n)=>r+n,0)/t.length:null}function Cs(e){return Math.round(e*100)/100}function Zxe(e,t){const r=String(t||"").toLowerCase();return r==="ssa"?"SSA":r==="cia"?"CIA":r==="fa"?"FA":r==="review"?"REVIEW":r==="me"?"ME":r==="lab1"?"LAB1":r==="lab2"?"LAB2":String(t||"").toUpperCase()}function au(e){if(e===""||e==null)return null;const t=Number(e);return Number.isFinite(t)?t:null}function e1e(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const o=r.localeCompare(n);if(o)return o}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim();return i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}function IM(e){if(e==="1&2"||e==="both")return"1&2";if(typeof e=="string"){const n=e.trim().toUpperCase().replace(/\s+/g,""),i=n.includes("1"),s=n.includes("2");if(i&&s||n==="1&2"||n==="1,2"||n==="1/2"||n==="2/1"||n==="CO1&CO2"||n==="CO1,CO2"||n==="CO1/CO2"||n==="CO2/CO1")return"1&2";if(n==="CO2"||n==="2")return 2;if(n==="CO1"||n==="1")return 1}if(Array.isArray(e)){const r=e.map(n=>{if(typeof n=="string"){const i=n.match(/\d+/);return Number(i?i[0]:n)}return Number(n)}).filter(n=>Number.isFinite(n));if(r.includes(1)&&r.includes(2))return"1&2";if(r.includes(2))return 2;if(r.includes(1))return 1}const t=Number(typeof e=="string"?(e.match(/\d+/)||[])[0]:e);return t===2?2:t===12?"1&2":1}function DM(e){if(e==="3&4"||e==="both")return"3&4";if(typeof e=="string"){const n=e.trim().toUpperCase().replace(/\s+/g,""),i=n.includes("3"),s=n.includes("4");if(i&&s)return"3&4";if(s)return 4;if(i)return 3;if(n==="3&4"||n==="3,4"||n==="3/4"||n==="4/3"||n==="CO3&CO4"||n==="CO3,CO4"||n==="CO3/CO4"||n==="CO4/CO3")return"3&4";if(n==="CO4"||n==="4")return 4;if(n==="CO3"||n==="3")return 3}if(Array.isArray(e)){const r=e.map(n=>{if(typeof n=="string"){const i=n.match(/\d+/);return Number(i?i[0]:n)}return Number(n)}).filter(n=>Number.isFinite(n));if(r.includes(3)&&r.includes(4))return"3&4";if(r.includes(4))return 4;if(r.includes(3))return 3}const t=Number(typeof e=="string"?(e.match(/\d+/)||[])[0]:e);return t===4?4:t===3?3:t===34?"3&4":3}function t1e(e,t){const r=e[t];if(!r)return{co1:0,co2:0};const n=IM(r.co);if(n==="1&2")return{co1:.5,co2:.5};const i=e.some(u=>IM(u==null?void 0:u.co)==="1&2"),s=t===e.length-1,o=String((r==null?void 0:r.key)||"").toLowerCase(),l=String((r==null?void 0:r.label)||"").toLowerCase(),c=o==="q9"||l.includes("q9");return!i&&s&&c?{co1:.5,co2:.5}:n===2?{co1:0,co2:1}:{co1:1,co2:0}}function r1e(e,t){const r=e[t];if(!r)return{co3:0,co4:0};const n=DM(r.co);if(n==="3&4")return{co3:.5,co4:.5};const i=e.some(u=>DM(u==null?void 0:u.co)==="3&4"),s=t===e.length-1,o=String((r==null?void 0:r.key)||"").toLowerCase(),l=String((r==null?void 0:r.label)||"").toLowerCase(),c=o==="q9"||l.includes("q9");return!i&&s&&c?{co3:.5,co4:.5}:n===4?{co3:0,co4:1}:{co3:1,co4:0}}function n1e({subjectId:e,teachingAssignmentId:t,classType:r,enabledAssessments:n,assessmentType:i,cos:s,cqiDivider:o,cqiMultiplier:l}){var R,J;const[c,u]=x.useState([]),[d,f]=x.useState(!1),[h,p]=x.useState(null),[m,g]=x.useState({}),[y,b]=x.useState({}),[v,w]=x.useState({}),[S,k]=x.useState(null),[j,A]=x.useState(null),L=58,P=x.useMemo(()=>{const V=Number(o);if(Number.isFinite(V)&&V>0)return V;const X=Number(j==null?void 0:j.divider);return Number.isFinite(X)&&X>0?X:2},[o,j]),F=x.useMemo(()=>{const V=Number(l);if(Number.isFinite(V)&&V>=0)return V;const X=Number(j==null?void 0:j.multiplier);return Number.isFinite(X)&&X>=0?X:.15},[l,j]),[E,T]=x.useState(!0),[B,q]=x.useState(!0),[U,se]=x.useState(null),[de,z]=x.useState(!0),[G,ie]=x.useState(!1);x.useEffect(()=>{let V=!0;return(async()=>{try{const X=await vS();if(!V)return;const Q=Number(X==null?void 0:X.divider),ne=Number(X==null?void 0:X.multiplier);A({options:Array.isArray(X==null?void 0:X.options)?X.options:[],divider:Number.isFinite(Q)?Q:2,multiplier:Number.isFinite(ne)?ne:.15})}catch{V&&A(null)}})(),()=>{V=!1}},[]);const Y=x.useMemo(()=>!s||!Array.isArray(s)?[]:s.map(V=>{const X=V.match(/\d+/);return X?parseInt(X[0]):null}).filter(V=>V!==null).sort((V,X)=>V-X),[s]),C=x.useMemo(()=>{const V={};return Y.forEach(X=>{const Q=`co${X}`;let ne=null;Object.values(m).forEach(oe=>{const O=oe&&oe[Q];if(O&&typeof O.max=="number"){const W=O.max;(ne==null||W>ne)&&(ne=W)}}),V[X]=ne}),V},[m,Y]);x.useEffect(()=>{let V=!0;return(async()=>{try{const X=await ku();if(!V)return;k(X||null)}catch{}})(),()=>{V=!1}},[e]),x.useEffect(()=>{if(!t)return;let V=!0;return f(!0),p(null),(async()=>{try{const X=await Vc(t);if(!V)return;const Q=(X.students||[]).map(ne=>({id:Number(ne.id),reg_no:String(ne.reg_no??""),name:String(ne.name??""),section:ne.section??null})).filter(ne=>Number.isFinite(ne.id)).sort(e1e);u(Q)}catch(X){if(!V)return;p((X==null?void 0:X.message)||"Failed to load roster")}finally{V&&f(!1)}})(),()=>{V=!1}},[t]),x.useEffect(()=>{if(!e||!t)return;const V=`cqi_entries_${e}_${t}`,X=Jn(V);X&&typeof X=="object"&&(b(X),ie(!1)),(async()=>{try{const Q=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",ne=await xr(`/api/obe/cqi-draft/${encodeURIComponent(String(e))}${Q}`,{method:"GET"}).catch(()=>null);if(ne&&ne.ok){const oe=await ne.json().catch(()=>null);oe!=null&&oe.draft&&(b(oe.draft.entries||oe.draft||{}),se({updated_at:oe.updated_at||null,updated_by:oe.updated_by||null}),ie(!1))}}catch{}})()},[e,t]),x.useEffect(()=>{if(!e||!t||c.length===0||Y.length===0)return;let V=!0;return(async()=>{var X,Q,ne,oe,O,W,ae,I,Z,me,Te,Ae,Be,Ee,ze,Xe,Pt,ft,He,tt,_e,Se,he,ye,ht,Ge;try{f(!0);const lt=ti(r),jt=Jxe(n),wt=lt==="SPECIAL"&&jt.size,yt=or=>wt?jt.has(String(or).toLowerCase()):!0,Fr=lt==="TCPR",Tt=lt==="TCPL",hr=lt==="LAB"||lt==="PRACTICAL",en=!hr&&lt!=="SPECIAL"&&Y.some(or=>or>=1&&or<=5),$r=(()=>{if(!en)return null;const or=String(t??"none"),kr=[];lt==="THEORY"?(kr.push(`model_theory_sheet_${e}_${or}`),kr.push(`model_theory_sheet_${e}_none`)):lt==="TCPL"?(kr.push(`model_tcpl_sheet_${e}_${or}`),kr.push(`model_tcpl_sheet_${e}_none`)):lt==="TCPR"&&(kr.push(`model_tcpr_sheet_${e}_${or}`),kr.push(`model_tcpr_sheet_${e}_none`)),kr.push(`model_sheet_${e}`);for(const Tr of kr){const Or=Jn(Tr);if(Or&&typeof Or=="object")return Or}return null})(),Kr=(()=>{const or={co1:0,co2:0,co3:0,co4:0,co5:0};for(let kr=0;kr<Jb.length;kr++){const Tr=Jb[kr],Or=RM[kr];Or===1?or.co1+=Tr.max:Or===2?or.co2+=Tr.max:Or===3?or.co3+=Tr.max:Or===4?or.co4+=Tr.max:Or===5&&(or.co5+=Tr.max)}return or})(),Rn=or=>{if(!$r)return null;const kr=`id:${String(or.id)}`,Tr=or.reg_no?`reg:${String(or.reg_no).trim()}`:"",Or=$r[kr]||(Tr?$r[Tr]:null)||null;if(!Or||typeof Or!="object")return null;const Gt=!!Or.absent,ur=String(Or.absentKind||"AL").toUpperCase();if(Gt&&ur==="AL")return null;const Ve=Or.q&&typeof Or.q=="object"?Or.q:Or;let Rt=!1;const _t={co1:0,co2:0,co3:0,co4:0,co5:0};for(let Ue=0;Ue<Jb.length;Ue++){const Ct=Jb[Ue],et=au(Ve[Ct.key]);if(et==null)continue;Rt=!0;const ut=RM[Ue];ut===1?_t.co1+=et:ut===2?_t.co2+=et:ut===3?_t.co3+=et:ut===4?_t.co4+=et:ut===5&&(_t.co5+=et)}if(!Rt)return null;const Xt=(Ue,Ct,et)=>!Ct||!Number.isFinite(Ct)||Ct<=0?0:kd(kd(Ue,0,Ct)/Ct*et,0,et);return{co1:Xt(_t.co1,Kr.co1,2),co2:Xt(_t.co2,Kr.co2,2),co3:Xt(_t.co3,Kr.co3,2),co4:Xt(_t.co4,Kr.co4,2),co5:Xt(_t.co5,Kr.co5,4)}},Pr=Y.some(or=>or===1||or===2),Sn=Y.some(or=>or===3||or===4),Me=Y.some(or=>or===5),[je,Mt,pt,Ut,ir,fr,vr,re,le,te,ue,Ne,ke]=await Promise.all([Pr&&yt("ssa1")&&!hr?rg(e,t).catch(()=>({marks:{}})):{marks:{}},Sn&&yt("ssa2")&&!hr?ey(e,t).catch(()=>({marks:{}})):{marks:{}},Pr&&yt("formative1")&&!hr&&!Fr&&!Tt?kS(e,t).catch(()=>({marks:{}})):{marks:{}},Sn&&yt("formative2")&&!hr&&!Fr&&!Tt?v0("formative2",e,t).catch(()=>({marks:{}})):{marks:{}},Pr&&yt("cia1")&&!hr?ty(e,t).catch(()=>({data:null})):{data:null},Sn&&yt("cia2")&&!hr?w0("cia2",e,t).catch(()=>({data:null})):{data:null},Pr&&yt("review1")&&Fr?SS(e).catch(()=>({marks:{}})):{marks:{}},Sn&&yt("review2")&&Fr?_S(e).catch(()=>({marks:{}})):{marks:{}},Pr&&yt("formative1")&&Tt?(async()=>{try{const or=await ei("formative1",e,t);if(or!=null&&or.draft)return{data:or.draft.data??or.draft}}catch{}return po("formative1",e,t).catch(()=>({data:null}))})():{data:null},Sn&&yt("formative2")&&Tt?(async()=>{try{const or=await ei("formative2",e,t);if(or!=null&&or.draft)return{data:or.draft.data??or.draft}}catch{}return po("formative2",e,t).catch(()=>({data:null}))})():{data:null},Pr&&yt("cia1")&&hr?(async()=>{try{const or=await ei("cia1",e,t);if(or!=null&&or.draft)return{data:or.draft.data??or.draft}}catch{}return po("cia1",e,t).catch(()=>({data:null}))})():{data:null},Sn&&yt("cia2")&&hr?(async()=>{try{const or=await ei("cia2",e,t);if(or!=null&&or.draft)return{data:or.draft.data??or.draft}}catch{}return po("cia2",e,t).catch(()=>({data:null}))})():{data:null},Me&&yt("model")&&hr?(async()=>{try{const or=await ei("model",e,t);if(or!=null&&or.draft)return{data:or.draft.data??or.draft}}catch{}return Rm(e,t).catch(()=>({data:null}))})():{data:null}]);if(!V)return;const vt={ssa:1.5,cia:3,fa:2.5},rt={ssa:vt.ssa,cia:vt.cia,fa:vt.fa},De=((X=S==null?void 0:S.assessments)==null?void 0:X.ssa1)||{},We=((Q=S==null?void 0:S.assessments)==null?void 0:Q.ssa2)||{},st=((ne=S==null?void 0:S.assessments)==null?void 0:ne.formative1)||{},zt=((oe=S==null?void 0:S.assessments)==null?void 0:oe.formative2)||{},Wt=((O=S==null?void 0:S.assessments)==null?void 0:O.cia1)||{},xt=((W=S==null?void 0:S.assessments)==null?void 0:W.cia2)||{},Dt=((ae=S==null?void 0:S.assessments)==null?void 0:ae.review1)||{},Vt=((I=S==null?void 0:S.assessments)==null?void 0:I.review2)||{},gr={ssa1:{co1:Number((Z=De==null?void 0:De.coMax)==null?void 0:Z.co1)||10,co2:Number((me=De==null?void 0:De.coMax)==null?void 0:me.co2)||10},ssa2:{co3:Number(((Te=We==null?void 0:We.coMax)==null?void 0:Te.co3)??((Ae=We==null?void 0:We.coMax)==null?void 0:Ae.co1))||10,co4:Number(((Be=We==null?void 0:We.coMax)==null?void 0:Be.co4)??((Ee=We==null?void 0:We.coMax)==null?void 0:Ee.co2))||10},cia1:{co1:Number((ze=Wt==null?void 0:Wt.coMax)==null?void 0:ze.co1)||30,co2:Number((Xe=Wt==null?void 0:Wt.coMax)==null?void 0:Xe.co2)||30},cia2:{co3:Number(((Pt=xt==null?void 0:xt.coMax)==null?void 0:Pt.co3)??((ft=xt==null?void 0:xt.coMax)==null?void 0:ft.co1))||30,co4:Number(((He=xt==null?void 0:xt.coMax)==null?void 0:He.co4)??((tt=xt==null?void 0:xt.coMax)==null?void 0:tt.co2))||30},f1:{co1:Number(st==null?void 0:st.maxCo)||10,co2:Number(st==null?void 0:st.maxCo)||10},f2:{co3:Number(zt==null?void 0:zt.maxCo)||10,co4:Number(zt==null?void 0:zt.maxCo)||10},review1:{co1:Number((_e=Dt==null?void 0:Dt.coMax)==null?void 0:_e.co1)||15,co2:Number((Se=Dt==null?void 0:Dt.coMax)==null?void 0:Se.co2)||15},review2:{co3:Number(((he=Vt==null?void 0:Vt.coMax)==null?void 0:he.co3)??((ye=Vt==null?void 0:Vt.coMax)==null?void 0:ye.co1))||15,co4:Number(((ht=Vt==null?void 0:Vt.coMax)==null?void 0:ht.co4)??((Ge=Vt==null?void 0:Vt.coMax)==null?void 0:Ge.co2))||15}},sr=or=>{const kr=or!=null&&or.sheet&&typeof or.sheet=="object"?or.sheet:{},Tr=kr!=null&&kr.rowsByStudentId&&typeof kr.rowsByStudentId=="object"?kr.rowsByStudentId:{},Or=kd(Number((kr==null?void 0:kr.expCountA)??0),0,12),Gt=kd(Number((kr==null?void 0:kr.expCountB)??0),0,12),ur=Number.isFinite(Number(kr==null?void 0:kr.expMaxA))?Number(kr.expMaxA):25,Ve=Number.isFinite(Number(kr==null?void 0:kr.expMaxB))?Number(kr.expMaxB):25,Rt=(kr==null?void 0:kr.ciaExamEnabled)!==!1,_t=30/2,Xt=ur+(Rt?_t:0),Ue=Ve+(Rt?_t:0);return{get:et=>{const ut=Tr[String(et)]||{},Bt=FM(ut==null?void 0:ut.marksA,Or),Kt=FM(ut==null?void 0:ut.marksB,Gt),Jt=BM(Bt),ar=BM(Kt),nt=ut==null?void 0:ut.ciaExam,Ht=typeof nt=="number"&&Number.isFinite(nt)?nt:null,Pe=Jt!=null||ar!=null||Ht!=null,Ot=Pe?(Jt??0)+(Rt?(Ht??0)/2:0):null,mt=Pe?(ar??0)+(Rt?(Ht??0)/2:0):null;return{a:Ot==null?null:kd(Ot,0,Xt),b:mt==null?null:kd(mt,0,Ue)}},CO_MAX_A:Xt,CO_MAX_B:Ue}},Lr=Tt?sr((le==null?void 0:le.data)??null):null,Zr=Tt?sr((te==null?void 0:te.data)??null):null,Er=hr?sr((ue==null?void 0:ue.data)??null):null,qt=hr?sr((Ne==null?void 0:Ne.data)??null):null,zr=hr?sr((ke==null?void 0:ke.data)??null):null,bn={};c.forEach(or=>{bn[or.id]={};const kr=en?Rn(or):null;Y.forEach(Tr=>{let Or=null,Gt=0,ur=null,Ve=0,Rt=null,_t=0,Xt=null,Ue=0,Ct=null,et=0;if(kr){const Bt=`co${Tr}`;Bt in kr&&(Ct=Number(kr[Bt]),et=Tr===5?4:2)}if(Tr===1||Tr===2)if(hr){if(Er){const Bt=Er.get(or.id),Kt=Tr===1?Bt.a:Bt.b;Kt!=null&&(ur=Kt,Ve=Tr===1?Er.CO_MAX_A:Er.CO_MAX_B)}}else{const Bt=au(je.marks[String(or.id)]);Or=Bt==null?null:Number(Bt)/2,Gt=Tr===1?gr.ssa1.co1:gr.ssa1.co2;const Jt=ir.data;if(Jt){const nt=(Jt.rowsByStudentId||{})[String(or.id)]||{},Ht=Jt.questions||[],Pe=nt!=null&&nt.q&&typeof nt.q=="object"?nt.q:nt;let Ot=!1,mt=0,Nt=0;Ht.forEach((er,pr)=>{const we=Number((er==null?void 0:er.max)||0),Ie=t1e(Ht,pr),Ze=Tr===2?Ie.co2:Ie.co1;Ze>0&&we>0&&(Nt+=we*Ze);const bt=au(Pe==null?void 0:Pe[er.key]);if(bt==null||Ze<=0)return;Ot=!0;const St=we>0?kd(bt,0,we):bt;mt+=St*Ze}),Ot&&(ur=mt,Ve=Nt>0?Nt:Tr===1?gr.cia1.co1:gr.cia1.co2)}if(Fr){const ar=au(vr.marks[String(or.id)]),nt=ar==null?null:Number(ar)/2;nt!=null&&(Rt=nt,_t=Tr===1?gr.review1.co1:gr.review1.co2)}if(Tt&&Lr){const ar=Lr.get(or.id),nt=Tr===1?ar.a:ar.b;nt!=null&&(Xt=nt,Ue=Tr===1?Lr.CO_MAX_A:Lr.CO_MAX_B)}if(!Fr&&!Tt){const ar=(pt.marks||{})[String(or.id)]||{},nt=Tr===1?"skill1":"skill2",Ht=Tr===1?"att1":"att2",Pe=au(ar[nt]),Ot=au(ar[Ht]);Pe!==null&&Ot!==null&&(Xt=Pe+Ot,Ue=Tr===1?gr.f1.co1:gr.f1.co2)}}else if(Tr===3||Tr===4)if(hr){if(qt){const Bt=qt.get(or.id),Kt=Tr===3?Bt.a:Bt.b;Kt!=null&&(ur=Kt,Ve=Tr===3?qt.CO_MAX_A:qt.CO_MAX_B)}}else{const Bt=au(Mt.marks[String(or.id)]);Or=Bt==null?null:Number(Bt)/2,Gt=Tr===3?gr.ssa2.co3:gr.ssa2.co4;const Jt=fr.data;if(Jt){const nt=(Jt.rowsByStudentId||{})[String(or.id)]||{},Ht=Jt.questions||[],Pe=nt!=null&&nt.q&&typeof nt.q=="object"?nt.q:nt;let Ot=!1,mt=0,Nt=0;Ht.forEach((er,pr)=>{const we=Number((er==null?void 0:er.max)||0),Ie=r1e(Ht,pr),Ze=Tr===4?Ie.co4:Ie.co3;Ze>0&&we>0&&(Nt+=we*Ze);const bt=au(Pe==null?void 0:Pe[er.key]);if(bt==null||Ze<=0)return;Ot=!0;const St=we>0?kd(bt,0,we):bt;mt+=St*Ze}),Ot&&(ur=mt,Ve=Nt>0?Nt:Tr===3?gr.cia2.co3:gr.cia2.co4)}if(Fr){const ar=au(re.marks[String(or.id)]),nt=ar==null?null:Number(ar)/2;nt!=null&&(Rt=nt,_t=Tr===3?gr.review2.co3:gr.review2.co4)}if(Tt&&Zr){const ar=Zr.get(or.id),nt=Tr===3?ar.a:ar.b;nt!=null&&(Xt=nt,Ue=Tr===3?Zr.CO_MAX_A:Zr.CO_MAX_B)}if(!Fr&&!Tt){const ar=(Ut.marks||{})[String(or.id)]||{},nt=Tr===3?"skill1":"skill2",Ht=Tr===3?"att1":"att2",Pe=au(ar[nt]),Ot=au(ar[Ht]);Pe!==null&&Ot!==null&&(Xt=Pe+Ot,Ue=Tr===3?gr.f2.co3:gr.f2.co4)}}if(hr&&Tr===5&&zr){const Bt=zr.get(or.id);Bt.a!=null&&(Ct=Bt.a,et=zr.CO_MAX_A)}const ut=[];if(Or!==null&&Gt>0&&ut.push({key:"ssa",mark:Or,max:Gt,w:rt.ssa}),ur!==null&&Ve>0&&ut.push({key:"cia",mark:ur,max:Ve,w:rt.cia}),Rt!==null&&_t>0&&ut.push({key:"review",mark:Rt,max:_t,w:rt.fa}),Xt!==null&&Ue>0){const Bt=Tt?Tr===1||Tr===2?"lab1":Tr===3||Tr===4?"lab2":"fa":"fa";ut.push({key:Bt,mark:Xt,max:Ue,w:rt.fa})}if(Ct!==null&&et>0&&ut.push({key:"me",mark:Ct,max:et,w:et}),ut.length>0){const Kt=ut.reduce((nt,Ht)=>nt+Ht.w,0),Jt=ut.reduce((nt,Ht)=>{const Pe=Ht.mark/Ht.max;return nt+Pe*Ht.w},0),ar=ut.map(nt=>({...nt,contrib:Cs(nt.mark/nt.max*nt.w)}));bn[or.id][`co${Tr}`]={value:Cs(Jt),max:Cs(Kt),breakdown:ar}}else bn[or.id][`co${Tr}`]=null})}),g(bn)}catch(lt){if(!V)return;p((lt==null?void 0:lt.message)||"Failed to calculate CO totals")}finally{V&&f(!1)}})(),()=>{V=!1}},[e,t,r,n,c,Y,S]);const K=(V,X,Q)=>{if(Q===""){w(W=>{const ae={...W};return delete ae[`${V}_${X}`],ae}),b(W=>({...W,[V]:{...W[V],[X]:null}}));return}const ne=Number(Q);if(!(Number.isFinite(ne)&&Math.floor(ne)===ne)){w(W=>({...W,[`${V}_${X}`]:"Enter an integer between 0 and 10"})),b(W=>({...W,[V]:{...W[V],[X]:null}}));return}const O=ne;if(O<0||O>10){w(W=>({...W,[`${V}_${X}`]:"Value must be between 0 and 10"})),b(W=>({...W,[V]:{...W[V],[X]:O}}));return}w(W=>{const ae={...W};return delete ae[`${V}_${X}`],ae}),b(W=>{const ae={...W,[V]:{...W[V],[X]:O}};if(e&&t){const I=`cqi_entries_${e}_${t}`;try{Kn(I,ae)}catch{}}return ie(!0),ae})},H=()=>{if(!(!e||!t)){if(Object.keys(v).length){alert("Fix CQI input errors before saving");return}(async()=>{const V=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"";try{const Q=await xr(`/api/obe/cqi-save/${encodeURIComponent(String(e))}${V}`,{method:"PUT",body:JSON.stringify({entries:y})}).catch(()=>null);if(Q&&Q.ok){alert("CQI entries saved to server"),ie(!1);try{const ne=await Q.json().catch(()=>null);ne&&se(ne)}catch{}return}}catch{}const X=`cqi_entries_${e}_${t}`;try{Kn(X,y),ie(!1),alert("CQI entries saved locally")}catch(Q){alert("Failed to save CQI entries: "+String((Q==null?void 0:Q.message)||Q))}})()}};return!e||!t?a.jsx("div",{style:{padding:24,color:"#b91c1c"},children:"Missing subject ID or teaching assignment ID"}):d?a.jsx("div",{style:{padding:24,textAlign:"center",color:"#6b7280"},children:"Loading CQI data..."}):h?a.jsxs("div",{style:{padding:24,color:"#b91c1c"},children:["Error: ",h]}):Y.length===0?a.jsx("div",{style:{padding:24,color:"#b91c1c"},children:"No course outcomes selected for CQI entry"}):a.jsxs("div",{style:{padding:12},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16,padding:16,background:"linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)",borderRadius:12,border:"1px solid #bae6fd"},children:[a.jsxs("div",{children:[a.jsxs("h2",{style:{margin:0,fontSize:20,fontWeight:700,color:"#0f172a"},children:["CQI Entry - ",s==null?void 0:s.join(", ")]}),a.jsxs("div",{style:{marginTop:4,fontSize:14,color:"#64748b"},children:["Students below ",L,"% threshold require CQI intervention"]})]}),a.jsx("button",{onClick:H,className:"obe-btn obe-btn-primary",style:{minWidth:100},children:"Save CQI"}),a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[a.jsx("button",{type:"button",onClick:()=>T(V=>!V),className:"obe-btn",style:{minWidth:90,background:E?"#fef3c7":void 0},children:E?"DEBUG ON":"DEBUG"}),a.jsx("button",{type:"button",onClick:()=>q(V=>!V),className:"obe-btn",style:{minWidth:120},children:B?"Hide Header Max":"Show Header Max"}),a.jsx("button",{type:"button",onClick:async()=>{if(!e||!t)return alert("Missing subject/teaching assignment");try{const V={entries:y},X=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",Q=await xr(`/api/obe/cqi-draft/${encodeURIComponent(String(e))}${X}`,{method:"PUT",body:JSON.stringify(V)}).catch(()=>null);if(Q&&Q.ok){const ne=await Q.json().catch(()=>null);se(ne||{updated_at:new Date().toISOString(),updated_by:null}),ie(!1),alert("Draft saved to server")}else{const ne=`cqi_entries_${e}_${t}`;try{Kn(ne,y),ie(!1),alert("Draft saved locally")}catch{alert("Failed to save draft")}}}catch(V){alert("Failed to save draft: "+String((V==null?void 0:V.message)||V))}},className:"obe-btn",style:{minWidth:110},children:"Save Draft"}),a.jsx("button",{type:"button",onClick:async()=>{if(!e)return alert("Missing subject");if(confirm("Publish CQI to DB? This action cannot be undone."))try{const V=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",X=await xr(`/api/obe/cqi-publish/${encodeURIComponent(String(e))}${V}`,{method:"POST"}).catch(()=>null);X&&X.ok?alert("CQI published"):alert("Publish failed (server may not support CQI publish)")}catch(V){alert("Publish failed: "+String((V==null?void 0:V.message)||V))}},className:"obe-btn obe-btn-primary",style:{minWidth:110},children:"Publish"})]})]}),a.jsxs("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:10},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 12px",background:"#f8fafc",borderBottom:"1px solid #e6eef8"},children:[a.jsxs("div",{style:{fontSize:13,color:"#475569"},children:["Draft: ",U!=null&&U.updated_at?new Date(String(U.updated_at)).toLocaleString():"never"," ",U!=null&&U.updated_by?`by ${((R=U.updated_by)==null?void 0:R.name)||((J=U.updated_by)==null?void 0:J.username)||U.updated_by}`:"",G?"  unsaved changes":""]}),a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[a.jsxs("label",{style:{fontSize:13,color:"#475569"},children:[a.jsx("input",{type:"checkbox",checked:de,onChange:()=>z(V=>!V)})," Auto-save"]}),a.jsx("button",{className:"obe-btn",onClick:()=>{(async()=>{if(!e||!t)return alert("Missing subject/TA");try{const V=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",X=await xr(`/api/obe/cqi-draft/${encodeURIComponent(String(e))}${V}`,{method:"PUT",body:JSON.stringify({entries:y})}).catch(()=>null);if(X&&X.ok){const Q=await X.json().catch(()=>null);se(Q||null),ie(!1),alert("Draft synced to server")}else alert("Server save failed")}catch(V){alert("Server save failed: "+String((V==null?void 0:V.message)||V))}})()},children:"Sync Draft"})]})]}),a.jsxs("table",{className:"cqi-table",style:{width:"100%",borderCollapse:"collapse",fontSize:14},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{backgroundColor:"#f8fafc",borderBottom:"2px solid #e2e8f0"},children:[a.jsx("th",{style:{padding:"12px 8px",textAlign:"left",fontWeight:700,color:"#475569",minWidth:60},children:"S.No"}),a.jsx("th",{style:{padding:"12px 8px",textAlign:"left",fontWeight:700,color:"#475569",minWidth:120},children:"Reg No"}),a.jsx("th",{style:{padding:"12px 8px",textAlign:"left",fontWeight:700,color:"#475569",minWidth:200},children:"Name"}),a.jsxs("th",{style:{padding:"12px 8px",textAlign:"center",fontWeight:700,color:"#475569",minWidth:100},children:["BEFORE CQI",a.jsx("div",{style:{fontSize:11,fontWeight:400,color:"#94a3b8",marginTop:2},children:"Total / Max"})]}),a.jsxs("th",{style:{padding:"12px 8px",textAlign:"center",fontWeight:700,color:"#475569",minWidth:100},children:["AFTER CQI",a.jsx("div",{style:{fontSize:11,fontWeight:400,color:"#94a3b8",marginTop:2},children:"Total / Max"})]}),a.jsxs("th",{style:{padding:"12px 8px",textAlign:"center",fontWeight:700,color:"#475569",minWidth:120},children:["TOTAL",a.jsx("div",{style:{fontSize:11,fontWeight:400,color:"#94a3b8",marginTop:2},children:"Sum of selected COs"})]}),Y.map(V=>a.jsxs("th",{style:{padding:"12px 8px",textAlign:"center",fontWeight:700,color:"#475569",minWidth:150},children:["CO",V,a.jsx("div",{style:{fontSize:11,fontWeight:400,color:"#94a3b8",marginTop:2},children:B?a.jsxs(a.Fragment,{children:["Max: ",C[V]!=null?Cs(C[V]):""]}):a.jsx(a.Fragment,{children:""})})]},V))]})}),a.jsx("tbody",{children:c.map((V,X)=>{const Q=m[V.id]||{};let ne=0,oe=0;Y.forEach(Ee=>{const ze=Q[`co${Ee}`];ze&&(ne+=ze.value,oe+=ze.max)});const O=ne,W=oe,ae=W?O/W*100:0,I=oe?ne/oe*100:0,Z=W?ae:I,me=oe;let Te=ne,Ae=0;Y.forEach(Ee=>{var Se;const ze=`co${Ee}`,Xe=Q[ze],Pt=(Se=y[V.id])==null?void 0:Se[ze];if(!Xe||Pt==null||!((Xe.max?Number(Xe.value)/Number(Xe.max)*100:0)<L))return;const tt=Number(Pt)/10*Number(Xe.max),_e=Z<L?tt/P:tt*F;Number.isFinite(_e)&&_e>0&&(Ae+=_e,Te+=_e)}),Te=Number.isFinite(Te)?kd(Te,0,me||Te):ne;const Be=me?Te/me*100:0;return a.jsxs("tr",{style:{borderBottom:"1px solid #e5e7eb",backgroundColor:X%2===0?"white":"#f9fafb"},children:[a.jsx("td",{style:{padding:"10px 8px",color:"#64748b"},children:X+1}),a.jsx("td",{style:{padding:"10px 8px",fontFamily:"monospace",color:"#0f172a"},children:V.reg_no}),a.jsx("td",{style:{padding:"10px 8px",color:"#0f172a"},children:V.name}),a.jsx("td",{style:{padding:"10px 8px",textAlign:"center",fontWeight:600},children:oe>0?a.jsxs("div",{children:[a.jsxs("div",{style:{color:"#0f172a",fontSize:14},children:[Cs(ne),!E&&oe>0?a.jsxs(a.Fragment,{children:[" / ",Cs(oe)]}):null]}),a.jsxs("div",{style:{fontSize:12,color:"#64748b",marginTop:2},children:["(",Cs(I),"%)"]})]}):a.jsx("span",{style:{color:"#94a3b8"},children:""})}),a.jsx("td",{style:{padding:"10px 8px",textAlign:"center",fontWeight:600,backgroundColor:Te>ne?"#f0fdf4":"transparent"},children:me>0?a.jsxs("div",{children:[a.jsxs("div",{style:{color:"#0f172a",fontSize:14},children:[Cs(Te),!E&&me>0?a.jsxs(a.Fragment,{children:[" / ",Cs(me)]}):null]}),a.jsxs("div",{style:{fontSize:12,color:"#64748b",marginTop:2},children:["(",Cs(Be),"%)"]}),Ae>0&&a.jsxs("div",{style:{fontSize:11,color:"#16a34a",marginTop:2},children:["+",Cs(Ae)]})]}):a.jsx("span",{style:{color:"#94a3b8"},children:""})}),a.jsx("td",{style:{padding:"10px 8px",textAlign:"center",fontWeight:700},children:W>0?a.jsxs("div",{style:{backgroundColor:ae<L?"#fff1f2":"transparent",padding:6,borderRadius:6},children:[a.jsxs("div",{style:{color:ae<L?"#ef4444":"#0f172a",fontSize:14,fontWeight:800},children:[Cs(ae),"%"]}),a.jsxs("div",{style:{fontSize:12,color:"#64748b",marginTop:6},children:[Cs(O),!E&&W>0?a.jsxs(a.Fragment,{children:[" / ",Cs(W)]}):null]})]}):a.jsx("span",{style:{color:"#94a3b8"},children:""})}),Y.map(Ee=>{var tt;const ze=`co${Ee}`,Xe=Q[ze];if(!Xe)return a.jsx("td",{style:{padding:"10px 8px",textAlign:"center",color:"#94a3b8"},children:""},Ee);const Pt=Xe.max?Xe.value/Xe.max*100:0,ft=Pt<L,He=(tt=y[V.id])==null?void 0:tt[ze];return a.jsxs("td",{style:{padding:"10px 8px",textAlign:"center",backgroundColor:ft?"#fef2f2":"#f0fdf4"},children:[a.jsxs("div",{style:{fontSize:13,color:"#64748b",marginBottom:6},children:[a.jsxs("div",{children:[Cs(Xe.value)," (",Cs(Pt),"%)"]}),E?null:Array.isArray(Xe.breakdown)&&a.jsx("div",{style:{marginTop:6,fontSize:11,color:"#94a3b8"},children:Xe.breakdown.map(_e=>a.jsxs("div",{style:{display:"inline-block",marginRight:8},children:[Zxe(ti(r),String(_e.key||"")),": ",Cs(_e.mark)," / ",Cs(_e.max)," =",Cs(_e.contrib)]},_e.key))})]}),ft?a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:11,color:"#dc2626",fontWeight:600,marginBottom:4},children:"CQI ATTAINED"}),a.jsx("input",{type:"number",value:He??"",onChange:_e=>K(V.id,ze,_e.target.value),placeholder:"Enter CQI",className:"obe-input",style:{width:90,padding:"4px 8px",fontSize:13,textAlign:"center"}}),v[`${V.id}_${ze}`]&&a.jsx("div",{style:{color:"#dc2626",fontSize:11,marginTop:6},children:v[`${V.id}_${ze}`]})]}):a.jsx("div",{style:{fontSize:12,color:"#16a34a",fontWeight:600},children:" NO CQI"})]},Ee)})]},V.id)})})]})]}),c.length===0&&a.jsx("div",{style:{textAlign:"center",padding:32,color:"#94a3b8"},children:"No students found in this section"})]})}function qz(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(r=qz(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Si(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=qz(e))&&(n&&(n+=" "),n+=t);return n}var i1e=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function vC(e){if(typeof e!="string")return!1;var t=i1e;return t.includes(e)}var a1e=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],s1e=new Set(a1e);function Hz(e){return typeof e!="string"?!1:s1e.has(e)}function Vz(e){return typeof e=="string"&&e.startsWith("data-")}function ol(e){if(typeof e!="object"||e===null)return{};var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(Hz(r)||Vz(r))&&(t[r]=e[r]);return t}function xh(e){if(e==null)return null;if(x.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return ol(t)}return typeof e=="object"&&!Array.isArray(e)?ol(e):null}function Wo(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(Hz(r)||Vz(r)||vC(r))&&(t[r]=e[r]);return t}function o1e(e){return e==null?null:x.isValidElement(e)?Wo(e.props):typeof e=="object"&&!Array.isArray(e)?Wo(e):null}var l1e=["children","width","height","viewBox","className","style","title","desc"];function oA(){return oA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},oA.apply(null,arguments)}function c1e(e,t){if(e==null)return{};var r,n,i=u1e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function u1e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var wC=x.forwardRef((e,t)=>{var{children:r,width:n,height:i,viewBox:s,className:o,style:l,title:c,desc:u}=e,d=c1e(e,l1e),f=s||{width:n,height:i,x:0,y:0},h=Si("recharts-surface",o);return x.createElement("svg",oA({},Wo(d),{className:h,width:n,height:i,style:l,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:t}),x.createElement("title",null,c),x.createElement("desc",null,u),r)}),d1e=["children","className"];function lA(){return lA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lA.apply(null,arguments)}function f1e(e,t){if(e==null)return{};var r,n,i=h1e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function h1e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ja=x.forwardRef((e,t)=>{var{children:r,className:n}=e,i=f1e(e,d1e),s=Si("recharts-layer",n);return x.createElement("g",lA({className:s},Wo(i),{ref:t}),r)}),Gz=x.createContext(null),p1e=()=>x.useContext(Gz);function la(e){return function(){return e}}const Kz=Math.cos,Z2=Math.sin,Nu=Math.sqrt,ew=Math.PI,FS=2*ew,cA=Math.PI,uA=2*cA,$h=1e-6,m1e=uA-$h;function Yz(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function g1e(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Yz;const r=10**t;return function(n){this._+=n[0];for(let i=1,s=n.length;i<s;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}class x1e{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Yz:g1e(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,i){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(t,r,n,i,s,o){this._append`C${+t},${+r},${+n},${+i},${this._x1=+s},${this._y1=+o}`}arcTo(t,r,n,i,s){if(t=+t,r=+r,n=+n,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,l=this._y1,c=n-t,u=i-r,d=o-t,f=l-r,h=d*d+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(h>$h)if(!(Math.abs(f*c-u*d)>$h)||!s)this._append`L${this._x1=t},${this._y1=r}`;else{let p=n-o,m=i-l,g=c*c+u*u,y=p*p+m*m,b=Math.sqrt(g),v=Math.sqrt(h),w=s*Math.tan((cA-Math.acos((g+h-y)/(2*b*v)))/2),S=w/v,k=w/b;Math.abs(S-1)>$h&&this._append`L${t+S*d},${r+S*f}`,this._append`A${s},${s},0,0,${+(f*p>d*m)},${this._x1=t+k*c},${this._y1=r+k*u}`}}arc(t,r,n,i,s,o){if(t=+t,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(i),c=n*Math.sin(i),u=t+l,d=r+c,f=1^o,h=o?i-s:s-i;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>$h||Math.abs(this._y1-d)>$h)&&this._append`L${u},${d}`,n&&(h<0&&(h=h%uA+uA),h>m1e?this._append`A${n},${n},0,1,${f},${t-l},${r-c}A${n},${n},0,1,${f},${this._x1=u},${this._y1=d}`:h>$h&&this._append`A${n},${n},0,${+(h>=cA)},${f},${this._x1=t+n*Math.cos(s)},${this._y1=r+n*Math.sin(s)}`)}rect(t,r,n,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function SC(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new x1e(t)}function _C(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Xz(e){this._context=e}Xz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function BS(e){return new Xz(e)}function Qz(e){return e[0]}function Jz(e){return e[1]}function Zz(e,t){var r=la(!0),n=null,i=BS,s=null,o=SC(l);e=typeof e=="function"?e:e===void 0?Qz:la(e),t=typeof t=="function"?t:t===void 0?Jz:la(t);function l(c){var u,d=(c=_C(c)).length,f,h=!1,p;for(n==null&&(s=i(p=o())),u=0;u<=d;++u)!(u<d&&r(f=c[u],u,c))===h&&((h=!h)?s.lineStart():s.lineEnd()),h&&s.point(+e(f,u,c),+t(f,u,c));if(p)return s=null,p+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:la(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:la(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:la(!!c),l):r},l.curve=function(c){return arguments.length?(i=c,n!=null&&(s=i(n)),l):i},l.context=function(c){return arguments.length?(c==null?n=s=null:s=i(n=c),l):n},l}function Zb(e,t,r){var n=null,i=la(!0),s=null,o=BS,l=null,c=SC(u);e=typeof e=="function"?e:e===void 0?Qz:la(+e),t=typeof t=="function"?t:la(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?Jz:la(+r);function u(f){var h,p,m,g=(f=_C(f)).length,y,b=!1,v,w=new Array(g),S=new Array(g);for(s==null&&(l=o(v=c())),h=0;h<=g;++h){if(!(h<g&&i(y=f[h],h,f))===b)if(b=!b)p=h,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),m=h-1;m>=p;--m)l.point(w[m],S[m]);l.lineEnd(),l.areaEnd()}b&&(w[h]=+e(y,h,f),S[h]=+t(y,h,f),l.point(n?+n(y,h,f):w[h],r?+r(y,h,f):S[h]))}if(v)return l=null,v+""||null}function d(){return Zz().defined(i).curve(o).context(s)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:la(+f),n=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:la(+f),u):e},u.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:la(+f),u):n},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:la(+f),r=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:la(+f),u):t},u.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:la(+f),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(n).y(t)},u.defined=function(f){return arguments.length?(i=typeof f=="function"?f:la(!!f),u):i},u.curve=function(f){return arguments.length?(o=f,s!=null&&(l=o(s)),u):o},u.context=function(f){return arguments.length?(f==null?s=l=null:l=o(s=f),u):s},u}class eW{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function y1e(e){return new eW(e,!0)}function b1e(e){return new eW(e,!1)}const kC={draw(e,t){const r=Nu(t/ew);e.moveTo(r,0),e.arc(0,0,r,0,FS)}},v1e={draw(e,t){const r=Nu(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},tW=Nu(1/3),w1e=tW*2,S1e={draw(e,t){const r=Nu(t/w1e),n=r*tW;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},_1e={draw(e,t){const r=Nu(t),n=-r/2;e.rect(n,n,r,r)}},k1e=.8908130915292852,rW=Z2(ew/10)/Z2(7*ew/10),j1e=Z2(FS/10)*rW,A1e=-Kz(FS/10)*rW,N1e={draw(e,t){const r=Nu(t*k1e),n=j1e*r,i=A1e*r;e.moveTo(0,-r),e.lineTo(n,i);for(let s=1;s<5;++s){const o=FS*s/5,l=Kz(o),c=Z2(o);e.lineTo(c*r,-l*r),e.lineTo(l*n-c*i,c*n+l*i)}e.closePath()}},Uk=Nu(3),C1e={draw(e,t){const r=-Nu(t/(Uk*3));e.moveTo(0,r*2),e.lineTo(-Uk*r,-r),e.lineTo(Uk*r,-r),e.closePath()}},Sc=-.5,_c=Nu(3)/2,dA=1/Nu(12),E1e=(dA/2+1)*3,T1e={draw(e,t){const r=Nu(t/E1e),n=r/2,i=r*dA,s=n,o=r*dA+r,l=-s,c=o;e.moveTo(n,i),e.lineTo(s,o),e.lineTo(l,c),e.lineTo(Sc*n-_c*i,_c*n+Sc*i),e.lineTo(Sc*s-_c*o,_c*s+Sc*o),e.lineTo(Sc*l-_c*c,_c*l+Sc*c),e.lineTo(Sc*n+_c*i,Sc*i-_c*n),e.lineTo(Sc*s+_c*o,Sc*o-_c*s),e.lineTo(Sc*l+_c*c,Sc*c-_c*l),e.closePath()}};function P1e(e,t){let r=null,n=SC(i);e=typeof e=="function"?e:la(e||kC),t=typeof t=="function"?t:la(t===void 0?64:+t);function i(){let s;if(r||(r=s=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),s)return r=null,s+""||null}return i.type=function(s){return arguments.length?(e=typeof s=="function"?s:la(s),i):e},i.size=function(s){return arguments.length?(t=typeof s=="function"?s:la(+s),i):t},i.context=function(s){return arguments.length?(r=s??null,i):r},i}function tw(){}function rw(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function nW(e){this._context=e}nW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:rw(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:rw(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function O1e(e){return new nW(e)}function iW(e){this._context=e}iW.prototype={areaStart:tw,areaEnd:tw,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:rw(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function M1e(e){return new iW(e)}function aW(e){this._context=e}aW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:rw(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function L1e(e){return new aW(e)}function sW(e){this._context=e}sW.prototype={areaStart:tw,areaEnd:tw,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function R1e(e){return new sW(e)}function $M(e){return e<0?-1:1}function UM(e,t,r){var n=e._x1-e._x0,i=t-e._x1,s=(e._y1-e._y0)/(n||i<0&&-0),o=(r-e._y1)/(i||n<0&&-0),l=(s*i+o*n)/(n+i);return($M(s)+$M(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(l))||0}function zM(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function zk(e,t,r){var n=e._x0,i=e._y0,s=e._x1,o=e._y1,l=(s-n)/3;e._context.bezierCurveTo(n+l,i+l*t,s-l,o-l*r,s,o)}function nw(e){this._context=e}nw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:zk(this,this._t0,zM(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,zk(this,zM(this,r=UM(this,e,t)),r);break;default:zk(this,this._t0,r=UM(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function oW(e){this._context=new lW(e)}(oW.prototype=Object.create(nw.prototype)).point=function(e,t){nw.prototype.point.call(this,t,e)};function lW(e){this._context=e}lW.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,i,s){this._context.bezierCurveTo(t,e,n,r,s,i)}};function F1e(e){return new nw(e)}function B1e(e){return new oW(e)}function cW(e){this._context=e}cW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=WM(e),i=WM(t),s=0,o=1;o<r;++s,++o)this._context.bezierCurveTo(n[0][s],i[0][s],n[1][s],i[1][s],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function WM(e){var t,r=e.length-1,n,i=new Array(r),s=new Array(r),o=new Array(r);for(i[0]=0,s[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,s[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,s[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/s[t-1],s[t]-=n,o[t]-=n*o[t-1];for(i[r-1]=o[r-1]/s[r-1],t=r-2;t>=0;--t)i[t]=(o[t]-i[t+1])/s[t];for(s[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)s[t]=2*e[t+1]-i[t+1];return[i,s]}function I1e(e){return new cW(e)}function IS(e,t){this._context=e,this._t=t}IS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function D1e(e){return new IS(e,.5)}function $1e(e){return new IS(e,0)}function U1e(e){return new IS(e,1)}function P0(e,t){if((o=e.length)>1)for(var r=1,n,i,s=e[t[0]],o,l=s.length;r<o;++r)for(i=s,s=e[t[r]],n=0;n<l;++n)s[n][1]+=s[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function fA(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function z1e(e,t){return e[t]}function W1e(e){const t=[];return t.key=e,t}function q1e(){var e=la([]),t=fA,r=P0,n=z1e;function i(s){var o=Array.from(e.apply(this,arguments),W1e),l,c=o.length,u=-1,d;for(const f of s)for(l=0,++u;l<c;++l)(o[l][u]=[0,+n(f,o[l].key,u,s)]).data=f;for(l=0,d=_C(t(o));l<c;++l)o[d[l]].index=l;return r(o,d),o}return i.keys=function(s){return arguments.length?(e=typeof s=="function"?s:la(Array.from(s)),i):e},i.value=function(s){return arguments.length?(n=typeof s=="function"?s:la(+s),i):n},i.order=function(s){return arguments.length?(t=s==null?fA:typeof s=="function"?s:la(Array.from(s)),i):t},i.offset=function(s){return arguments.length?(r=s??P0,i):r},i}function H1e(e,t){if((n=e.length)>0){for(var r,n,i=0,s=e[0].length,o;i<s;++i){for(o=r=0;r<n;++r)o+=e[r][i][1]||0;if(o)for(r=0;r<n;++r)e[r][i][1]/=o}P0(e,t)}}function V1e(e,t){if((i=e.length)>0){for(var r=0,n=e[t[0]],i,s=n.length;r<s;++r){for(var o=0,l=0;o<i;++o)l+=e[o][r][1]||0;n[r][1]+=n[r][0]=-l/2}P0(e,t)}}function G1e(e,t){if(!(!((o=e.length)>0)||!((s=(i=e[t[0]]).length)>0))){for(var r=0,n=1,i,s,o;n<s;++n){for(var l=0,c=0,u=0;l<o;++l){for(var d=e[t[l]],f=d[n][1]||0,h=d[n-1][1]||0,p=(f-h)/2,m=0;m<l;++m){var g=e[t[m]],y=g[n][1]||0,b=g[n-1][1]||0;p+=y-b}c+=f,u+=p*f}i[n-1][1]+=i[n-1][0]=r,c&&(r-=u/c)}i[n-1][1]+=i[n-1][0]=r,P0(e,t)}}var DS={},uW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(uW);var jC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(jC);var $S={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var n;return typeof r=="string"||typeof r=="symbol"?r:Object.is((n=r==null?void 0:r.valueOf)==null?void 0:n.call(r),-0)?"-0":String(r)}e.toKey=t})($S);var US={},dW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}e.toString=t})(dW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=dW,r=$S;function n(i){if(Array.isArray(i))return i.map(r.toKey);if(typeof i=="symbol")return[i];i=t.toString(i);const s=[],o=i.length;if(o===0)return s;let l=0,c="",u="",d=!1;for(i.charCodeAt(0)===46&&(s.push(""),l++);l<o;){const f=i[l];u?f==="\\"&&l+1<o?(l++,c+=i[l]):f===u?u="":c+=f:d?f==='"'||f==="'"?u=f:f==="]"?(d=!1,s.push(c),c=""):c+=f:f==="["?(d=!0,c&&(s.push(c),c="")):f==="."?c&&(s.push(c),c=""):c+=f,l++}return c&&s.push(c),s}e.toPath=n})(US);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=uW,r=jC,n=$S,i=US;function s(l,c,u){if(l==null)return u;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?r.isDeepKey(c)?s(l,i.toPath(c),u):u:d}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const d=l[c];return d===void 0?u:d}default:{if(Array.isArray(c))return o(l,c,u);if(Object.is(c==null?void 0:c.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?u:d}}}function o(l,c,u){if(c.length===0)return u;let d=l;for(let f=0;f<c.length;f++){if(d==null||t.isUnsafeProperty(c[f]))return u;d=d[c[f]]}return d===void 0?u:d}e.get=s})(DS);var K1e=DS.get;const O0=af(K1e);var Y1e=4;function Yf(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Y1e,r=10**t,n=Math.round(e*r)/r;return Object.is(n,-0)?0:n}function za(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.reduce((i,s,o)=>{var l=r[o-1];return typeof l=="string"?i+l+s:l!==void 0?i+Yf(l)+s:i+s},"")}var Ks=e=>e===0?0:e>0?1:-1,ad=e=>typeof e=="number"&&e!=+e,M0=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,An=e=>(typeof e=="number"||e instanceof Number)&&!ad(e),Wc=e=>An(e)||typeof e=="string",X1e=0,k1=e=>{var t=++X1e;return"".concat(e||"").concat(t)},$o=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!An(t)&&typeof t!="string")return n;var s;if(M0(t)){if(r==null)return n;var o=t.indexOf("%");s=r*parseFloat(t.slice(0,o))/100}else s=+t;return ad(s)&&(s=n),i&&r!=null&&s>r&&(s=r),s},fW=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[String(e[n])])r[String(e[n])]=!0;else return!0;return!1};function Yi(e,t,r){return An(e)&&An(t)?Yf(e+r*(t-e)):t}function hW(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):O0(n,t))===r)}var Q1e=e=>{for(var t=e.length,r=0,n=0,i=0,s=0,o=1/0,l=-1/0,c=0,u=0,d=0;d<t;d++){var f,h;c=((f=e[d])===null||f===void 0?void 0:f.cx)||0,u=((h=e[d])===null||h===void 0?void 0:h.cy)||0,r+=c,n+=u,i+=c*u,s+=c*c,o=Math.min(o,c),l=Math.max(l,c)}var p=t*s!==r*r?(t*i-r*n)/(t*s-r*r):0;return{xmin:o,xmax:l,a:p,b:(n-p*r)/t}},Xi=e=>e===null||typeof e>"u",hy=e=>Xi(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function _l(e){return e!=null}function ip(){}var J1e=["type","size","sizeType"];function hA(){return hA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hA.apply(null,arguments)}function qM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function HM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qM(Object(r),!0).forEach(function(n){Z1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Z1e(e,t,r){return(t=eye(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eye(e){var t=tye(e,"string");return typeof t=="symbol"?t:t+""}function tye(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rye(e,t){if(e==null)return{};var r,n,i=nye(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function nye(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var pW={symbolCircle:kC,symbolCross:v1e,symbolDiamond:S1e,symbolSquare:_1e,symbolStar:N1e,symbolTriangle:C1e,symbolWye:T1e},iye=Math.PI/180,aye=e=>{var t="symbol".concat(hy(e));return pW[t]||kC},sye=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*iye;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},oye=(e,t)=>{pW["symbol".concat(hy(e))]=t},zS=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,i=rye(e,J1e),s=HM(HM({},i),{},{type:t,size:r,sizeType:n}),o="circle";typeof t=="string"&&(o=t);var l=()=>{var h=aye(o),p=P1e().type(h).size(sye(r,n,o)),m=p();if(m!==null)return m},{className:c,cx:u,cy:d}=s,f=Wo(s);return An(u)&&An(d)&&An(r)?x.createElement("path",hA({},f,{className:Si("recharts-symbols",c),transform:"translate(".concat(u,", ").concat(d,")"),d:l()})):null};zS.registerSymbol=oye;var mW=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,AC=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(x.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(i=>{vC(i)&&(n[i]=s=>r[i](r,s))}),n},lye=(e,t,r)=>n=>(e(t,r,n),null),dg=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(i=>{var s=e[i];vC(i)&&typeof s=="function"&&(n||(n={}),n[i]=lye(s,t,r))}),n},cye=e=>Array.isArray(e)&&e.length>0;function VM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function uye(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VM(Object(r),!0).forEach(function(n){dye(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dye(e,t,r){return(t=fye(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fye(e){var t=hye(e,"string");return typeof t=="symbol"?t:t+""}function hye(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Aa(e,t){var r=uye({},e),n=t,i=Object.keys(t),s=i.reduce((o,l)=>(o[l]===void 0&&n[l]!==void 0&&(o[l]=n[l]),o),r);return s}function iw(){return iw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},iw.apply(null,arguments)}function GM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function pye(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GM(Object(r),!0).forEach(function(n){mye(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mye(e,t,r){return(t=gye(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gye(e){var t=xye(e,"string");return typeof t=="symbol"?t:t+""}function xye(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cc=32,yye={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function bye(e){var{data:t,iconType:r,inactiveColor:n}=e,i=Cc/2,s=Cc/6,o=Cc/3,l=t.inactive?n:t.color,c=r??t.type;if(c==="none")return null;if(c==="plainline"){var u;return x.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:(u=t.payload)===null||u===void 0?void 0:u.strokeDasharray,x1:0,y1:i,x2:Cc,y2:i,className:"recharts-legend-icon"})}if(c==="line")return x.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(i,"h").concat(o,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*o,",").concat(i,`
            H`).concat(Cc,"M").concat(2*o,",").concat(i,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(o,",").concat(i),className:"recharts-legend-icon"});if(c==="rect")return x.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(Cc/8,"h").concat(Cc,"v").concat(Cc*3/4,"h").concat(-Cc,"z"),className:"recharts-legend-icon"});if(x.isValidElement(t.legendIcon)){var d=pye({},t);return delete d.legendIcon,x.cloneElement(t.legendIcon,d)}return x.createElement(zS,{fill:l,cx:i,cy:i,size:Cc,sizeType:"diameter",type:c})}function vye(e){var{payload:t,iconSize:r,layout:n,formatter:i,inactiveColor:s,iconType:o}=e,l={x:0,y:0,width:Cc,height:Cc},c={display:n==="horizontal"?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((d,f)=>{var h=d.formatter||i,p=Si({"recharts-legend-item":!0,["legend-item-".concat(f)]:!0,inactive:d.inactive});if(d.type==="none")return null;var m=d.inactive?s:d.color,g=h?h(d.value,d,f):d.value;return x.createElement("li",iw({className:p,style:c,key:"legend-item-".concat(f)},dg(e,d,f)),x.createElement(wC,{width:r,height:r,viewBox:l,style:u,"aria-label":"".concat(g," legend icon")},x.createElement(bye,{data:d,iconType:o,inactiveColor:s})),x.createElement("span",{className:"recharts-legend-item-text",style:{color:m}},g))})}var wye=e=>{var t=Aa(e,yye),{payload:r,layout:n,align:i}=t;if(!r||!r.length)return null;var s={padding:0,margin:0,textAlign:n==="horizontal"?i:"left"};return x.createElement("ul",{className:"recharts-default-legend",style:s},x.createElement(vye,iw({},t,{payload:r})))},gW={},xW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const i=new Map;for(let s=0;s<r.length;s++){const o=r[s],l=n(o,s,r);i.has(l)||i.set(l,o)}return Array.from(i.values())}e.uniqBy=t})(xW);var yW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return function(...i){return r.apply(this,i.slice(0,n))}}e.ary=t})(yW);var NC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(NC);var bW={},WS={},vW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(vW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=vW;function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(WS);var wW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(wW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=WS,r=wW;function n(i){return r.isObjectLike(i)&&t.isArrayLike(i)}e.isArrayLikeObject=n})(bW);var SW={},_W={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=DS;function r(n){return function(i){return t.get(i,n)}}e.property=r})(_W);var kW={},CC={},jW={},EC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(EC);var TC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(TC);var PC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.isEqualsSameValueZero=t})(PC);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=EC,r=TC,n=PC;function i(d,f,h){return typeof h!="function"?i(d,f,()=>{}):s(d,f,function p(m,g,y,b,v,w){const S=h(m,g,y,b,v,w);return S!==void 0?!!S:s(m,g,p,w)},new Map)}function s(d,f,h,p){if(f===d)return!0;switch(typeof f){case"object":return o(d,f,h,p);case"function":return Object.keys(f).length>0?s(d,{...f},h,p):n.isEqualsSameValueZero(d,f);default:return t.isObject(d)?typeof f=="string"?f==="":!0:n.isEqualsSameValueZero(d,f)}}function o(d,f,h,p){if(f==null)return!0;if(Array.isArray(f))return c(d,f,h,p);if(f instanceof Map)return l(d,f,h,p);if(f instanceof Set)return u(d,f,h,p);const m=Object.keys(f);if(d==null||r.isPrimitive(d))return m.length===0;if(m.length===0)return!0;if(p!=null&&p.has(f))return p.get(f)===d;p==null||p.set(f,d);try{for(let g=0;g<m.length;g++){const y=m[g];if(!r.isPrimitive(d)&&!(y in d)||f[y]===void 0&&d[y]!==void 0||f[y]===null&&d[y]!==null||!h(d[y],f[y],y,d,f,p))return!1}return!0}finally{p==null||p.delete(f)}}function l(d,f,h,p){if(f.size===0)return!0;if(!(d instanceof Map))return!1;for(const[m,g]of f.entries()){const y=d.get(m);if(h(y,g,m,d,f,p)===!1)return!1}return!0}function c(d,f,h,p){if(f.length===0)return!0;if(!Array.isArray(d))return!1;const m=new Set;for(let g=0;g<f.length;g++){const y=f[g];let b=!1;for(let v=0;v<d.length;v++){if(m.has(v))continue;const w=d[v];let S=!1;if(h(w,y,g,d,f,p)&&(S=!0),S){m.add(v),b=!0;break}}if(!b)return!1}return!0}function u(d,f,h,p){return f.size===0?!0:d instanceof Set?c([...d],[...f],h,p):!1}e.isMatchWith=i,e.isSetMatch=u})(jW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=jW;function r(n,i){return t.isMatchWith(n,i,()=>{})}e.isMatch=r})(CC);var AW={},OC={},NW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(NW);var qS={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(qS);var MC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",i="[object Boolean]",s="[object Arguments]",o="[object Symbol]",l="[object Date]",c="[object Map]",u="[object Set]",d="[object Array]",f="[object Function]",h="[object ArrayBuffer]",p="[object Object]",m="[object Error]",g="[object DataView]",y="[object Uint8Array]",b="[object Uint8ClampedArray]",v="[object Uint16Array]",w="[object Uint32Array]",S="[object BigUint64Array]",k="[object Int8Array]",j="[object Int16Array]",A="[object Int32Array]",L="[object BigInt64Array]",P="[object Float32Array]",F="[object Float64Array]";e.argumentsTag=s,e.arrayBufferTag=h,e.arrayTag=d,e.bigInt64ArrayTag=L,e.bigUint64ArrayTag=S,e.booleanTag=i,e.dataViewTag=g,e.dateTag=l,e.errorTag=m,e.float32ArrayTag=P,e.float64ArrayTag=F,e.functionTag=f,e.int16ArrayTag=j,e.int32ArrayTag=A,e.int8ArrayTag=k,e.mapTag=c,e.numberTag=n,e.objectTag=p,e.regexpTag=t,e.setTag=u,e.stringTag=r,e.symbolTag=o,e.uint16ArrayTag=v,e.uint32ArrayTag=w,e.uint8ArrayTag=y,e.uint8ClampedArrayTag=b})(MC);var CW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(CW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=NW,r=qS,n=MC,i=TC,s=CW;function o(d,f){return l(d,void 0,d,new Map,f)}function l(d,f,h,p=new Map,m=void 0){const g=m==null?void 0:m(d,f,h,p);if(g!==void 0)return g;if(i.isPrimitive(d))return d;if(p.has(d))return p.get(d);if(Array.isArray(d)){const y=new Array(d.length);p.set(d,y);for(let b=0;b<d.length;b++)y[b]=l(d[b],b,h,p,m);return Object.hasOwn(d,"index")&&(y.index=d.index),Object.hasOwn(d,"input")&&(y.input=d.input),y}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const y=new RegExp(d.source,d.flags);return y.lastIndex=d.lastIndex,y}if(d instanceof Map){const y=new Map;p.set(d,y);for(const[b,v]of d)y.set(b,l(v,b,h,p,m));return y}if(d instanceof Set){const y=new Set;p.set(d,y);for(const b of d)y.add(l(b,void 0,h,p,m));return y}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(s.isTypedArray(d)){const y=new(Object.getPrototypeOf(d)).constructor(d.length);p.set(d,y);for(let b=0;b<d.length;b++)y[b]=l(d[b],b,h,p,m);return y}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const y=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return p.set(d,y),c(y,d,h,p,m),y}if(typeof File<"u"&&d instanceof File){const y=new File([d],d.name,{type:d.type});return p.set(d,y),c(y,d,h,p,m),y}if(typeof Blob<"u"&&d instanceof Blob){const y=new Blob([d],{type:d.type});return p.set(d,y),c(y,d,h,p,m),y}if(d instanceof Error){const y=new d.constructor;return p.set(d,y),y.message=d.message,y.name=d.name,y.stack=d.stack,y.cause=d.cause,c(y,d,h,p,m),y}if(d instanceof Boolean){const y=new Boolean(d.valueOf());return p.set(d,y),c(y,d,h,p,m),y}if(d instanceof Number){const y=new Number(d.valueOf());return p.set(d,y),c(y,d,h,p,m),y}if(d instanceof String){const y=new String(d.valueOf());return p.set(d,y),c(y,d,h,p,m),y}if(typeof d=="object"&&u(d)){const y=Object.create(Object.getPrototypeOf(d));return p.set(d,y),c(y,d,h,p,m),y}return d}function c(d,f,h=d,p,m){const g=[...Object.keys(f),...t.getSymbols(f)];for(let y=0;y<g.length;y++){const b=g[y],v=Object.getOwnPropertyDescriptor(d,b);(v==null||v.writable)&&(d[b]=l(f[b],b,h,p,m))}}function u(d){switch(r.getTag(d)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=o,e.cloneDeepWithImpl=l,e.copyProperties=c})(OC);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=OC;function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(AW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=CC,r=AW;function n(i){return i=r.cloneDeep(i),s=>t.isMatch(s,i)}e.matches=n})(kW);var EW={},TW={},PW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=OC,r=qS,n=MC;function i(s,o){return t.cloneDeepWith(s,(l,c,u,d)=>{const f=o==null?void 0:o(l,c,u,d);if(f!==void 0)return f;if(typeof s=="object"){if(r.getTag(s)===n.objectTag&&typeof s.constructor!="function"){const h={};return d.set(s,h),t.copyProperties(h,s,u,d),h}switch(Object.prototype.toString.call(s)){case n.numberTag:case n.stringTag:case n.booleanTag:{const h=new s.constructor(s==null?void 0:s.valueOf());return t.copyProperties(h,s),h}case n.argumentsTag:{const h={};return t.copyProperties(h,s),h.length=s.length,h[Symbol.iterator]=s[Symbol.iterator],h}default:return}}})}e.cloneDeepWith=i})(PW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=PW;function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(TW);var OW={},LC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,i=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<i;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(LC);var MW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=qS;function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(MW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=jC,r=LC,n=MW,i=US;function s(o,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&t.isDeepKey(l)&&(o==null?void 0:o[l])==null?c=i.toPath(l):c=[l],c.length===0)return!1;let u=o;for(let d=0;d<c.length;d++){const f=c[d];if((u==null||!Object.hasOwn(u,f))&&!((Array.isArray(u)||n.isArguments(u))&&r.isIndex(f)&&f<u.length))return!1;u=u[f]}return!0}e.has=s})(OW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=CC,r=$S,n=TW,i=DS,s=OW;function o(l,c){switch(typeof l){case"object":{Object.is(l==null?void 0:l.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return c=n.cloneDeep(c),function(u){const d=i.get(u,l);return d===void 0?s.has(u,l):c===void 0?d===void 0:t.isMatch(d,c)}}e.matchesProperty=o})(EW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=NC,r=_W,n=kW,i=EW;function s(o){if(o==null)return t.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?i.matchesProperty(o[0],o[1]):n.matches(o);case"string":case"symbol":case"number":return r.property(o)}}e.iteratee=s})(SW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=xW,r=yW,n=NC,i=bW,s=SW;function o(l,c=n.identity){return i.isArrayLikeObject(l)?t.uniqBy(Array.from(l),r.ary(s.iteratee(c),1)):[]}e.uniqBy=o})(gW);var Sye=gW.uniqBy;const KM=af(Sye);function LW(e,t,r){return t===!0?KM(e,r):typeof t=="function"?KM(e,t):e}var RW={exports:{}},FW={},BW={exports:{}},IW={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $m=x;function _ye(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var kye=typeof Object.is=="function"?Object.is:_ye,jye=$m.useState,Aye=$m.useEffect,Nye=$m.useLayoutEffect,Cye=$m.useDebugValue;function Eye(e,t){var r=t(),n=jye({inst:{value:r,getSnapshot:t}}),i=n[0].inst,s=n[1];return Nye(function(){i.value=r,i.getSnapshot=t,Wk(i)&&s({inst:i})},[e,r,t]),Aye(function(){return Wk(i)&&s({inst:i}),e(function(){Wk(i)&&s({inst:i})})},[e]),Cye(r),r}function Wk(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!kye(e,r)}catch{return!0}}function Tye(e,t){return t()}var Pye=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Tye:Eye;IW.useSyncExternalStore=$m.useSyncExternalStore!==void 0?$m.useSyncExternalStore:Pye;BW.exports=IW;var Oye=BW.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HS=x,Mye=Oye;function Lye(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Rye=typeof Object.is=="function"?Object.is:Lye,Fye=Mye.useSyncExternalStore,Bye=HS.useRef,Iye=HS.useEffect,Dye=HS.useMemo,$ye=HS.useDebugValue;FW.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var s=Bye(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=Dye(function(){function c(p){if(!u){if(u=!0,d=p,p=n(p),i!==void 0&&o.hasValue){var m=o.value;if(i(m,p))return f=m}return f=p}if(m=f,Rye(d,p))return m;var g=n(p);return i!==void 0&&i(m,g)?(d=p,m):(d=p,f=g)}var u=!1,d,f,h=r===void 0?null:r;return[function(){return c(t())},h===null?void 0:function(){return c(h())}]},[t,r,n,i]);var l=Fye(e,s[0],s[1]);return Iye(function(){o.hasValue=!0,o.value=l},[l]),$ye(l),l};RW.exports=FW;var Uye=RW.exports,RC=x.createContext(null),zye=e=>e,Ji=()=>{var e=x.useContext(RC);return e?e.store.dispatch:zye},Xv=()=>{},Wye=()=>Xv,qye=(e,t)=>e===t;function yn(e){var t=x.useContext(RC),r=x.useMemo(()=>t?n=>{if(n!=null)return e(n)}:Xv,[t,e]);return Uye.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:Wye,t?t.store.getState:Xv,t?t.store.getState:Xv,r,qye)}function Hye(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function Vye(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function Gye(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var YM=e=>Array.isArray(e)?e:[e];function Kye(e){const t=Array.isArray(e[0])?e[0]:e;return Gye(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function Yye(e,t){const r=[],{length:n}=e;for(let i=0;i<n;i++)r.push(e[i].apply(null,t));return r}var Xye=class{constructor(e){this.value=e}deref(){return this.value}},Qye=typeof WeakRef<"u"?WeakRef:Xye,Jye=0,XM=1;function ev(){return{s:Jye,v:void 0,o:null,p:null}}function DW(e,t={}){let r=ev();const{resultEqualityCheck:n}=t;let i,s=0;function o(){var f;let l=r;const{length:c}=arguments;for(let h=0,p=c;h<p;h++){const m=arguments[h];if(typeof m=="function"||typeof m=="object"&&m!==null){let g=l.o;g===null&&(l.o=g=new WeakMap);const y=g.get(m);y===void 0?(l=ev(),g.set(m,l)):l=y}else{let g=l.p;g===null&&(l.p=g=new Map);const y=g.get(m);y===void 0?(l=ev(),g.set(m,l)):l=y}}const u=l;let d;if(l.s===XM)d=l.v;else if(d=e.apply(null,arguments),s++,n){const h=((f=i==null?void 0:i.deref)==null?void 0:f.call(i))??i;h!=null&&n(h,d)&&(d=h,s!==0&&s--),i=typeof d=="object"&&d!==null||typeof d=="function"?new Qye(d):d}return u.s=XM,u.v=d,d}return o.clearCache=()=>{r=ev(),o.resetResultsCount()},o.resultsCount=()=>s,o.resetResultsCount=()=>{s=0},o}function Zye(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...i)=>{let s=0,o=0,l,c={},u=i.pop();typeof u=="object"&&(c=u,u=i.pop()),Hye(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...c},{memoize:f,memoizeOptions:h=[],argsMemoize:p=DW,argsMemoizeOptions:m=[]}=d,g=YM(h),y=YM(m),b=Kye(i),v=f(function(){return s++,u.apply(null,arguments)},...g),w=p(function(){o++;const k=Yye(b,arguments);return l=v.apply(null,k),l},...y);return Object.assign(w,{resultFunc:u,memoizedResultFunc:v,dependencies:b,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>s,resetRecomputations:()=>{s=0},memoize:f,argsMemoize:p})};return Object.assign(n,{withTypes:()=>n}),n}var Qt=Zye(DW),ebe=Object.assign((e,t=Qt)=>{Vye(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(s=>e[s]);return t(n,(...s)=>s.reduce((o,l,c)=>(o[r[c]]=l,o),{}))},{withTypes:()=>ebe}),$W={},UW={},zW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,i,s)=>{if(n!==i){const o=t(n),l=t(i);if(o===l&&o===0){if(n<i)return s==="desc"?1:-1;if(n>i)return s==="desc"?-1:1}return s==="desc"?l-o:o-l}return 0};e.compareValues=r})(zW);var WW={},FC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(FC);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=FC,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(s,o){return Array.isArray(s)?!1:typeof s=="number"||typeof s=="boolean"||s==null||t.isSymbol(s)?!0:typeof s=="string"&&(n.test(s)||!r.test(s))||o!=null&&Object.hasOwn(o,s)}e.isKey=i})(WW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=zW,r=WW,n=US;function i(s,o,l,c){if(s==null)return[];l=c?void 0:l,Array.isArray(s)||(s=Object.values(s)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(p=>String(p));const u=(p,m)=>{let g=p;for(let y=0;y<m.length&&g!=null;++y)g=g[m[y]];return g},d=(p,m)=>m==null||p==null?m:typeof p=="object"&&"key"in p?Object.hasOwn(m,p.key)?m[p.key]:u(m,p.path):typeof p=="function"?p(m):Array.isArray(p)?u(m,p):typeof m=="object"?m[p]:m,f=o.map(p=>(Array.isArray(p)&&p.length===1&&(p=p[0]),p==null||typeof p=="function"||Array.isArray(p)||r.isKey(p)?p:{key:p,path:n.toPath(p)}));return s.map(p=>({original:p,criteria:f.map(m=>d(m,p))})).slice().sort((p,m)=>{for(let g=0;g<f.length;g++){const y=t.compareValues(p.criteria[g],m.criteria[g],l[g]);if(y!==0)return y}return 0}).map(p=>p.original)}e.orderBy=i})(UW);var qW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const i=[],s=Math.floor(n),o=(l,c)=>{for(let u=0;u<l.length;u++){const d=l[u];Array.isArray(d)&&c<s?o(d,c+1):i.push(d)}};return o(r,0),i}e.flatten=t})(qW);var BC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=LC,r=WS,n=EC,i=PC;function s(o,l,c){return n.isObject(c)&&(typeof l=="number"&&r.isArrayLike(c)&&t.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?i.isEqualsSameValueZero(c[l],o):!1}e.isIterateeCall=s})(BC);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=UW,r=qW,n=BC;function i(s,...o){const l=o.length;return l>1&&n.isIterateeCall(s,o[0],o[1])?o=[]:l>2&&n.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),t.orderBy(s,r.flatten(o),["asc"])}e.sortBy=i})($W);var tbe=$W.sortBy;const VS=af(tbe);var HW=e=>e.legend.settings,rbe=e=>e.legend.size,nbe=e=>e.legend.payload,ibe=Qt([nbe,HW],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?VS(n,r):n});function abe(){return yn(ibe)}var tv=1;function VW(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=x.useState({height:0,left:0,top:0,width:0}),n=x.useCallback(i=>{if(i!=null){var s=i.getBoundingClientRect(),o={height:s.height,left:s.left,top:s.top,width:s.width};(Math.abs(o.height-t.height)>tv||Math.abs(o.left-t.left)>tv||Math.abs(o.top-t.top)>tv||Math.abs(o.width-t.width)>tv)&&r({height:o.height,left:o.left,top:o.top,width:o.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function lo(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var sbe=typeof Symbol=="function"&&Symbol.observable||"@@observable",QM=sbe,qk=()=>Math.random().toString(36).substring(7).split("").join("."),obe={INIT:`@@redux/INIT${qk()}`,REPLACE:`@@redux/REPLACE${qk()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${qk()}`},aw=obe;function IC(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function GW(e,t,r){if(typeof e!="function")throw new Error(lo(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(lo(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(lo(1));return r(GW)(e,t)}let n=e,i=t,s=new Map,o=s,l=0,c=!1;function u(){o===s&&(o=new Map,s.forEach((y,b)=>{o.set(b,y)}))}function d(){if(c)throw new Error(lo(3));return i}function f(y){if(typeof y!="function")throw new Error(lo(4));if(c)throw new Error(lo(5));let b=!0;u();const v=l++;return o.set(v,y),function(){if(b){if(c)throw new Error(lo(6));b=!1,u(),o.delete(v),s=null}}}function h(y){if(!IC(y))throw new Error(lo(7));if(typeof y.type>"u")throw new Error(lo(8));if(typeof y.type!="string")throw new Error(lo(17));if(c)throw new Error(lo(9));try{c=!0,i=n(i,y)}finally{c=!1}return(s=o).forEach(v=>{v()}),y}function p(y){if(typeof y!="function")throw new Error(lo(10));n=y,h({type:aw.REPLACE})}function m(){const y=f;return{subscribe(b){if(typeof b!="object"||b===null)throw new Error(lo(11));function v(){const S=b;S.next&&S.next(d())}return v(),{unsubscribe:y(v)}},[QM](){return this}}}return h({type:aw.INIT}),{dispatch:h,subscribe:f,getState:d,replaceReducer:p,[QM]:m}}function lbe(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:aw.INIT})>"u")throw new Error(lo(12));if(typeof r(void 0,{type:aw.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(lo(13))})}function KW(e){const t=Object.keys(e),r={};for(let s=0;s<t.length;s++){const o=t[s];typeof e[o]=="function"&&(r[o]=e[o])}const n=Object.keys(r);let i;try{lbe(r)}catch(s){i=s}return function(o={},l){if(i)throw i;let c=!1;const u={};for(let d=0;d<n.length;d++){const f=n[d],h=r[f],p=o[f],m=h(p,l);if(typeof m>"u")throw l&&l.type,new Error(lo(14));u[f]=m,c=c||m!==p}return c=c||n.length!==Object.keys(o).length,c?u:o}}function sw(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function cbe(...e){return t=>(r,n)=>{const i=t(r,n);let s=()=>{throw new Error(lo(15))};const o={getState:i.getState,dispatch:(c,...u)=>s(c,...u)},l=e.map(c=>c(o));return s=sw(...l)(i.dispatch),{...i,dispatch:s}}}function YW(e){return IC(e)&&"type"in e&&typeof e.type=="string"}var XW=Symbol.for("immer-nothing"),JM=Symbol.for("immer-draftable"),ll=Symbol.for("immer-state");function cu(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var rc=Object,Um=rc.getPrototypeOf,ow="constructor",GS="prototype",pA="configurable",lw="enumerable",Qv="writable",j1="value",Xd=e=>!!e&&!!e[ll];function Su(e){var t;return e?QW(e)||YS(e)||!!e[JM]||!!((t=e[ow])!=null&&t[JM])||XS(e)||QS(e):!1}var ube=rc[GS][ow].toString(),ZM=new WeakMap;function QW(e){if(!e||!DC(e))return!1;const t=Um(e);if(t===null||t===rc[GS])return!0;const r=rc.hasOwnProperty.call(t,ow)&&t[ow];if(r===Object)return!0;if(!Dp(r))return!1;let n=ZM.get(r);return n===void 0&&(n=Function.toString.call(r),ZM.set(r,n)),n===ube}function KS(e,t,r=!0){py(e)===0?(r?Reflect.ownKeys(e):rc.keys(e)).forEach(i=>{t(i,e[i],e)}):e.forEach((n,i)=>t(i,n,e))}function py(e){const t=e[ll];return t?t.type_:YS(e)?1:XS(e)?2:QS(e)?3:0}var eL=(e,t,r=py(e))=>r===2?e.has(t):rc[GS].hasOwnProperty.call(e,t),mA=(e,t,r=py(e))=>r===2?e.get(t):e[t],cw=(e,t,r,n=py(e))=>{n===2?e.set(t,r):n===3?e.add(r):e[t]=r};function dbe(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}var YS=Array.isArray,XS=e=>e instanceof Map,QS=e=>e instanceof Set,DC=e=>typeof e=="object",Dp=e=>typeof e=="function",Hk=e=>typeof e=="boolean";function fbe(e){const t=+e;return Number.isInteger(t)&&String(t)===e}var Td=e=>e.copy_||e.base_,$C=e=>e.modified_?e.copy_:e.base_;function gA(e,t){if(XS(e))return new Map(e);if(QS(e))return new Set(e);if(YS(e))return Array[GS].slice.call(e);const r=QW(e);if(t===!0||t==="class_only"&&!r){const n=rc.getOwnPropertyDescriptors(e);delete n[ll];let i=Reflect.ownKeys(n);for(let s=0;s<i.length;s++){const o=i[s],l=n[o];l[Qv]===!1&&(l[Qv]=!0,l[pA]=!0),(l.get||l.set)&&(n[o]={[pA]:!0,[Qv]:!0,[lw]:l[lw],[j1]:e[o]})}return rc.create(Um(e),n)}else{const n=Um(e);if(n!==null&&r)return{...e};const i=rc.create(n);return rc.assign(i,e)}}function UC(e,t=!1){return JS(e)||Xd(e)||!Su(e)||(py(e)>1&&rc.defineProperties(e,{set:rv,add:rv,clear:rv,delete:rv}),rc.freeze(e),t&&KS(e,(r,n)=>{UC(n,!0)},!1)),e}function hbe(){cu(2)}var rv={[j1]:hbe};function JS(e){return e===null||!DC(e)?!0:rc.isFrozen(e)}var uw="MapSet",xA="Patches",tL="ArrayMethods",JW={};function L0(e){const t=JW[e];return t||cu(0,e),t}var rL=e=>!!JW[e],A1,ZW=()=>A1,pbe=(e,t)=>({drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:rL(uw)?L0(uw):void 0,arrayMethodsPlugin_:rL(tL)?L0(tL):void 0});function nL(e,t){t&&(e.patchPlugin_=L0(xA),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function yA(e){bA(e),e.drafts_.forEach(mbe),e.drafts_=null}function bA(e){e===A1&&(A1=e.parent_)}var iL=e=>A1=pbe(A1,e);function mbe(e){const t=e[ll];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function aL(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];if(e!==void 0&&e!==r){r[ll].modified_&&(yA(t),cu(4)),Su(e)&&(e=sL(t,e));const{patchPlugin_:i}=t;i&&i.generateReplacementPatches_(r[ll].base_,e,t)}else e=sL(t,r);return gbe(t,e,!0),yA(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==XW?e:void 0}function sL(e,t){if(JS(t))return t;const r=t[ll];if(!r)return dw(t,e.handledSet_,e);if(!ZS(r,e))return t;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:n}=r;if(n)for(;n.length>0;)n.pop()(e);rq(r,e)}return r.copy_}function gbe(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&UC(t,r)}function eq(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var ZS=(e,t)=>e.scope_===t,xbe=[];function tq(e,t,r,n){const i=Td(e),s=e.type_;if(n!==void 0&&mA(i,n,s)===t){cw(i,n,r,s);return}if(!e.draftLocations_){const l=e.draftLocations_=new Map;KS(i,(c,u)=>{if(Xd(u)){const d=l.get(u)||[];d.push(c),l.set(u,d)}})}const o=e.draftLocations_.get(t)??xbe;for(const l of o)cw(i,l,r,s)}function ybe(e,t,r){e.callbacks_.push(function(i){var l;const s=t;if(!s||!ZS(s,i))return;(l=i.mapSetPlugin_)==null||l.fixSetContents(s);const o=$C(s);tq(e,s.draft_??s,o,r),rq(s,i)})}function rq(e,t){var n;if(e.modified_&&!e.finalized_&&(e.type_===3||e.type_===1&&e.allIndicesReassigned_||(((n=e.assigned_)==null?void 0:n.size)??0)>0)){const{patchPlugin_:i}=t;if(i){const s=i.getPath(e);s&&i.generatePatches_(e,s,t)}eq(e)}}function bbe(e,t,r){const{scope_:n}=e;if(Xd(r)){const i=r[ll];ZS(i,n)&&i.callbacks_.push(function(){Jv(e);const o=$C(i);tq(e,r,o,t)})}else Su(r)&&e.callbacks_.push(function(){const s=Td(e);e.type_===3?s.has(r)&&dw(r,n.handledSet_,n):mA(s,t,e.type_)===r&&n.drafts_.length>1&&(e.assigned_.get(t)??!1)===!0&&e.copy_&&dw(mA(e.copy_,t,e.type_),n.handledSet_,n)})}function dw(e,t,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||Xd(e)||t.has(e)||!Su(e)||JS(e)||(t.add(e),KS(e,(n,i)=>{if(Xd(i)){const s=i[ll];if(ZS(s,r)){const o=$C(s);cw(e,n,o,e.type_),eq(s)}}else Su(i)&&dw(i,t,r)})),e}function vbe(e,t){const r=YS(e),n={type_:r?1:0,scope_:t?t.scope_:ZW(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let i=n,s=fw;r&&(i=[n],s=N1);const{revoke:o,proxy:l}=Proxy.revocable(i,s);return n.draft_=l,n.revoke_=o,[l,n]}var fw={get(e,t){if(t===ll)return e;let r=e.scope_.arrayMethodsPlugin_;const n=e.type_===1&&typeof t=="string";if(n&&r!=null&&r.isArrayOperationMethod(t))return r.createMethodInterceptor(e,t);const i=Td(e);if(!eL(i,t,e.type_))return wbe(e,i,t);const s=i[t];if(e.finalized_||!Su(s)||n&&e.operationMethod&&(r!=null&&r.isMutatingArrayMethod(e.operationMethod))&&fbe(t))return s;if(s===Vk(e.base_,t)){Jv(e);const o=e.type_===1?+t:t,l=wA(e.scope_,s,e,o);return e.copy_[o]=l}return s},has(e,t){return t in Td(e)},ownKeys(e){return Reflect.ownKeys(Td(e))},set(e,t,r){const n=nq(Td(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const i=Vk(Td(e),t),s=i==null?void 0:i[ll];if(s&&s.base_===r)return e.copy_[t]=r,e.assigned_.set(t,!1),!0;if(dbe(r,i)&&(r!==void 0||eL(e.base_,t,e.type_)))return!0;Jv(e),vA(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_.set(t,!0),bbe(e,t,r)),!0},deleteProperty(e,t){return Jv(e),Vk(e.base_,t)!==void 0||t in e.base_?(e.assigned_.set(t,!1),vA(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Td(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{[Qv]:!0,[pA]:e.type_!==1||t!=="length",[lw]:n[lw],[j1]:r[t]}},defineProperty(){cu(11)},getPrototypeOf(e){return Um(e.base_)},setPrototypeOf(){cu(12)}},N1={};for(let e in fw){let t=fw[e];N1[e]=function(){const r=arguments;return r[0]=r[0][0],t.apply(this,r)}}N1.deleteProperty=function(e,t){return N1.set.call(this,e,t,void 0)};N1.set=function(e,t,r){return fw.set.call(this,e[0],t,r,e[0])};function Vk(e,t){const r=e[ll];return(r?Td(r):e)[t]}function wbe(e,t,r){var i;const n=nq(t,r);return n?j1 in n?n[j1]:(i=n.get)==null?void 0:i.call(e.draft_):void 0}function nq(e,t){if(!(t in e))return;let r=Um(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Um(r)}}function vA(e){e.modified_||(e.modified_=!0,e.parent_&&vA(e.parent_))}function Jv(e){e.copy_||(e.assigned_=new Map,e.copy_=gA(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Sbe=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(r,n,i)=>{if(Dp(r)&&!Dp(n)){const o=n;n=r;const l=this;return function(u=o,...d){return l.produce(u,f=>n.call(this,f,...d))}}Dp(n)||cu(6),i!==void 0&&!Dp(i)&&cu(7);let s;if(Su(r)){const o=iL(this),l=wA(o,r,void 0);let c=!0;try{s=n(l),c=!1}finally{c?yA(o):bA(o)}return nL(o,i),aL(s,o)}else if(!r||!DC(r)){if(s=n(r),s===void 0&&(s=r),s===XW&&(s=void 0),this.autoFreeze_&&UC(s,!0),i){const o=[],l=[];L0(xA).generateReplacementPatches_(r,s,{patches_:o,inversePatches_:l}),i(o,l)}return s}else cu(1,r)},this.produceWithPatches=(r,n)=>{if(Dp(r))return(l,...c)=>this.produceWithPatches(l,u=>r(u,...c));let i,s;return[this.produce(r,n,(l,c)=>{i=l,s=c}),i,s]},Hk(t==null?void 0:t.autoFreeze)&&this.setAutoFreeze(t.autoFreeze),Hk(t==null?void 0:t.useStrictShallowCopy)&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),Hk(t==null?void 0:t.useStrictIteration)&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){Su(t)||cu(8),Xd(t)&&(t=yu(t));const r=iL(this),n=wA(r,t,void 0);return n[ll].isManual_=!0,bA(r),n}finishDraft(t,r){const n=t&&t[ll];(!n||!n.isManual_)&&cu(9);const{scope_:i}=n;return nL(i,r),aL(void 0,i)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,r){let n;for(n=r.length-1;n>=0;n--){const s=r[n];if(s.path.length===0&&s.op==="replace"){t=s.value;break}}n>-1&&(r=r.slice(n+1));const i=L0(xA).applyPatches_;return Xd(t)?i(t,r):this.produce(t,s=>i(s,r))}};function wA(e,t,r,n){const[i,s]=XS(t)?L0(uw).proxyMap_(t,r):QS(t)?L0(uw).proxySet_(t,r):vbe(t,r);return((r==null?void 0:r.scope_)??ZW()).drafts_.push(i),s.callbacks_=(r==null?void 0:r.callbacks_)??[],s.key_=n,r&&n!==void 0?ybe(r,s,n):s.callbacks_.push(function(c){var d;(d=c.mapSetPlugin_)==null||d.fixSetContents(s);const{patchPlugin_:u}=c;s.modified_&&u&&u.generatePatches_(s,[],c)}),i}function yu(e){return Xd(e)||cu(10,e),iq(e)}function iq(e){if(!Su(e)||JS(e))return e;const t=e[ll];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=gA(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=gA(e,!0);return KS(r,(i,s)=>{cw(r,i,iq(s))},n),t&&(t.finalized_=!1),r}var _be=new Sbe,aq=_be.produce;function sq(e){return({dispatch:r,getState:n})=>i=>s=>typeof s=="function"?s(r,n,e):i(s)}var kbe=sq(),jbe=sq,Abe=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?sw:sw.apply(null,arguments)};function qc(e,t){function r(...n){if(t){let i=t(...n);if(!i)throw new Error(ic(0));return{type:e,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>YW(n)&&n.type===e,r}var oq=class px extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,px.prototype)}static get[Symbol.species](){return px}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new px(...t[0].concat(this)):new px(...t.concat(this))}};function oL(e){return Su(e)?aq(e,()=>{}):e}function nv(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function Nbe(e){return typeof e=="boolean"}var Cbe=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:s=!0}=t??{};let o=new oq;return r&&(Nbe(r)?o.push(kbe):o.push(jbe(r.extraArgument))),o},lq="RTK_autoBatch",Sa=()=>e=>({payload:e,meta:{[lq]:!0}}),lL=e=>t=>{setTimeout(t,e)},cq=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let i=!0,s=!1,o=!1;const l=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:lL(10):e.type==="callback"?e.queueNotification:lL(e.timeout),u=()=>{o=!1,s&&(s=!1,l.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const f=()=>i&&d(),h=n.subscribe(f);return l.add(d),()=>{h(),l.delete(d)}},dispatch(d){var f;try{return i=!((f=d==null?void 0:d.meta)!=null&&f[lq]),s=!i,s&&(o||(o=!0,c(u))),n.dispatch(d)}finally{i=!0}}})},Ebe=e=>function(r){const{autoBatch:n=!0}=r??{};let i=new oq(e);return n&&i.push(cq(typeof n=="object"?n:void 0)),i};function Tbe(e){const t=Cbe(),{reducer:r=void 0,middleware:n,devTools:i=!0,preloadedState:s=void 0,enhancers:o=void 0}=e||{};let l;if(typeof r=="function")l=r;else if(IC(r))l=KW(r);else throw new Error(ic(1));let c;typeof n=="function"?c=n(t):c=t();let u=sw;i&&(u=Abe({trace:!1,...typeof i=="object"&&i}));const d=cbe(...c),f=Ebe(d);let h=typeof o=="function"?o(f):f();const p=u(...h);return GW(l,s,p)}function uq(e){const t={},r=[];let n;const i={addCase(s,o){const l=typeof s=="string"?s:s.type;if(!l)throw new Error(ic(28));if(l in t)throw new Error(ic(29));return t[l]=o,i},addAsyncThunk(s,o){return o.pending&&(t[s.pending.type]=o.pending),o.rejected&&(t[s.rejected.type]=o.rejected),o.fulfilled&&(t[s.fulfilled.type]=o.fulfilled),o.settled&&r.push({matcher:s.settled,reducer:o.settled}),i},addMatcher(s,o){return r.push({matcher:s,reducer:o}),i},addDefaultCase(s){return n=s,i}};return e(i),[t,r,n]}function Pbe(e){return typeof e=="function"}function Obe(e,t){let[r,n,i]=uq(t),s;if(Pbe(e))s=()=>oL(e());else{const l=oL(e);s=()=>l}function o(l=s(),c){let u=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[i]),u.reduce((d,f)=>{if(f)if(Xd(d)){const p=f(d,c);return p===void 0?d:p}else{if(Su(d))return aq(d,h=>f(h,c));{const h=f(d,c);if(h===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return h}}return d},l)}return o.getInitialState=s,o}var Mbe="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",Lbe=(e=21)=>{let t="",r=e;for(;r--;)t+=Mbe[Math.random()*64|0];return t},Rbe=Symbol.for("rtk-slice-createasyncthunk");function Fbe(e,t){return`${e}/${t}`}function Bbe({creators:e}={}){var r;const t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[Rbe];return function(i){const{name:s,reducerPath:o=s}=i;if(!s)throw new Error(ic(11));const l=(typeof i.reducers=="function"?i.reducers(Dbe()):i.reducers)||{},c=Object.keys(l),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(S,k){const j=typeof S=="string"?S:S.type;if(!j)throw new Error(ic(12));if(j in u.sliceCaseReducersByType)throw new Error(ic(13));return u.sliceCaseReducersByType[j]=k,d},addMatcher(S,k){return u.sliceMatchers.push({matcher:S,reducer:k}),d},exposeAction(S,k){return u.actionCreators[S]=k,d},exposeCaseReducer(S,k){return u.sliceCaseReducersByName[S]=k,d}};c.forEach(S=>{const k=l[S],j={reducerName:S,type:Fbe(s,S),createNotation:typeof i.reducers=="function"};Ube(k)?Wbe(j,k,d,t):$be(j,k,d)});function f(){const[S={},k=[],j=void 0]=typeof i.extraReducers=="function"?uq(i.extraReducers):[i.extraReducers],A={...S,...u.sliceCaseReducersByType};return Obe(i.initialState,L=>{for(let P in A)L.addCase(P,A[P]);for(let P of u.sliceMatchers)L.addMatcher(P.matcher,P.reducer);for(let P of k)L.addMatcher(P.matcher,P.reducer);j&&L.addDefaultCase(j)})}const h=S=>S,p=new Map,m=new WeakMap;let g;function y(S,k){return g||(g=f()),g(S,k)}function b(){return g||(g=f()),g.getInitialState()}function v(S,k=!1){function j(L){let P=L[S];return typeof P>"u"&&k&&(P=nv(m,j,b)),P}function A(L=h){const P=nv(p,k,()=>new WeakMap);return nv(P,L,()=>{const F={};for(const[E,T]of Object.entries(i.selectors??{}))F[E]=Ibe(T,L,()=>nv(m,L,b),k);return F})}return{reducerPath:S,getSelectors:A,get selectors(){return A(j)},selectSlice:j}}const w={name:s,reducer:y,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:b,...v(o),injectInto(S,{reducerPath:k,...j}={}){const A=k??o;return S.inject({reducerPath:A,reducer:y},j),{...w,...v(A,!0)}}};return w}}function Ibe(e,t,r,n){function i(s,...o){let l=t(s);return typeof l>"u"&&n&&(l=r()),e(l,...o)}return i.unwrapped=e,i}var Ll=Bbe();function Dbe(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function $be({type:e,reducerName:t,createNotation:r},n,i){let s,o;if("reducer"in n){if(r&&!zbe(n))throw new Error(ic(17));s=n.reducer,o=n.prepare}else s=n;i.addCase(e,s).exposeCaseReducer(t,s).exposeAction(t,o?qc(e,o):qc(e))}function Ube(e){return e._reducerDefinitionType==="asyncThunk"}function zbe(e){return e._reducerDefinitionType==="reducerWithPrepare"}function Wbe({type:e,reducerName:t},r,n,i){if(!i)throw new Error(ic(18));const{payloadCreator:s,fulfilled:o,pending:l,rejected:c,settled:u,options:d}=r,f=i(e,s,d);n.exposeAction(t,f),o&&n.addCase(f.fulfilled,o),l&&n.addCase(f.pending,l),c&&n.addCase(f.rejected,c),u&&n.addMatcher(f.settled,u),n.exposeCaseReducer(t,{fulfilled:o||iv,pending:l||iv,rejected:c||iv,settled:u||iv})}function iv(){}var qbe="task",dq="listener",fq="completed",zC="cancelled",Hbe=`task-${zC}`,Vbe=`task-${fq}`,SA=`${dq}-${zC}`,Gbe=`${dq}-${fq}`,e_=class{constructor(e){Oi(this,"name","TaskAbortError");Oi(this,"message");this.code=e,this.message=`${qbe} ${zC} (reason: ${e})`}},WC=(e,t)=>{if(typeof e!="function")throw new TypeError(ic(32))},hw=()=>{},hq=(e,t=hw)=>(e.catch(t),e),pq=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),u0=e=>{if(e.aborted)throw new e_(e.reason)};function mq(e,t){let r=hw;return new Promise((n,i)=>{const s=()=>i(new e_(e.reason));if(e.aborted){s();return}r=pq(e,s),t.finally(()=>r()).then(n,i)}).finally(()=>{r=hw})}var Kbe=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof e_?"cancelled":"rejected",error:r}}finally{t==null||t()}},pw=e=>t=>hq(mq(e,t).then(r=>(u0(e),r))),gq=e=>{const t=pw(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:Sm}=Object,cL={},t_="listenerMiddleware",Ybe=(e,t)=>{const r=n=>pq(e,()=>n.abort(e.reason));return(n,i)=>{WC(n);const s=new AbortController;r(s);const o=Kbe(async()=>{u0(e),u0(s.signal);const l=await n({pause:pw(s.signal),delay:gq(s.signal),signal:s.signal});return u0(s.signal),l},()=>s.abort(Vbe));return i!=null&&i.autoJoin&&t.push(o.catch(hw)),{result:pw(e)(o),cancel(){s.abort(Hbe)}}}},Xbe=(e,t)=>{const r=async(n,i)=>{u0(t);let s=()=>{};const l=[new Promise((c,u)=>{let d=e({predicate:n,effect:(f,h)=>{h.unsubscribe(),c([f,h.getState(),h.getOriginalState()])}});s=()=>{d(),u()}})];i!=null&&l.push(new Promise(c=>setTimeout(c,i,null)));try{const c=await mq(t,Promise.race(l));return u0(t),c}finally{s()}};return(n,i)=>hq(r(n,i))},xq=e=>{let{type:t,actionCreator:r,matcher:n,predicate:i,effect:s}=e;if(t)i=qc(t).match;else if(r)t=r.type,i=r.match;else if(n)i=n;else if(!i)throw new Error(ic(21));return WC(s),{predicate:i,type:t,effect:s}},yq=Sm(e=>{const{type:t,predicate:r,effect:n}=xq(e);return{id:Lbe(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(ic(22))}}},{withTypes:()=>yq}),uL=(e,t)=>{const{type:r,effect:n,predicate:i}=xq(t);return Array.from(e.values()).find(s=>(typeof r=="string"?s.type===r:s.predicate===i)&&s.effect===n)},_A=e=>{e.pending.forEach(t=>{t.abort(SA)})},Qbe=(e,t)=>()=>{for(const r of t.keys())_A(r);e.clear()},dL=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},bq=Sm(qc(`${t_}/add`),{withTypes:()=>bq}),Jbe=qc(`${t_}/removeAll`),vq=Sm(qc(`${t_}/remove`),{withTypes:()=>vq}),Zbe=(...e)=>{console.error(`${t_}/error`,...e)},my=(e={})=>{const t=new Map,r=new Map,n=p=>{const m=r.get(p)??0;r.set(p,m+1)},i=p=>{const m=r.get(p)??1;m===1?r.delete(p):r.set(p,m-1)},{extra:s,onError:o=Zbe}=e;WC(o);const l=p=>(p.unsubscribe=()=>t.delete(p.id),t.set(p.id,p),m=>{p.unsubscribe(),m!=null&&m.cancelActive&&_A(p)}),c=p=>{const m=uL(t,p)??yq(p);return l(m)};Sm(c,{withTypes:()=>c});const u=p=>{const m=uL(t,p);return m&&(m.unsubscribe(),p.cancelActive&&_A(m)),!!m};Sm(u,{withTypes:()=>u});const d=async(p,m,g,y)=>{const b=new AbortController,v=Xbe(c,b.signal),w=[];try{p.pending.add(b),n(p),await Promise.resolve(p.effect(m,Sm({},g,{getOriginalState:y,condition:(S,k)=>v(S,k).then(Boolean),take:v,delay:gq(b.signal),pause:pw(b.signal),extra:s,signal:b.signal,fork:Ybe(b.signal,w),unsubscribe:p.unsubscribe,subscribe:()=>{t.set(p.id,p)},cancelActiveListeners:()=>{p.pending.forEach((S,k,j)=>{S!==b&&(S.abort(SA),j.delete(S))})},cancel:()=>{b.abort(SA),p.pending.delete(b)},throwIfCancelled:()=>{u0(b.signal)}})))}catch(S){S instanceof e_||dL(o,S,{raisedBy:"effect"})}finally{await Promise.all(w),b.abort(Gbe),i(p),p.pending.delete(b)}},f=Qbe(t,r);return{middleware:p=>m=>g=>{if(!YW(g))return m(g);if(bq.match(g))return c(g.payload);if(Jbe.match(g)){f();return}if(vq.match(g))return u(g.payload);let y=p.getState();const b=()=>{if(y===cL)throw new Error(ic(23));return y};let v;try{if(v=m(g),t.size>0){const w=p.getState(),S=Array.from(t.values());for(const k of S){let j=!1;try{j=k.predicate(g,w,y)}catch(A){j=!1,dL(o,A,{raisedBy:"predicate"})}j&&d(k,g,p,b)}}}finally{y=cL}return v},startListening:c,stopListening:u,clearListeners:f}};function ic(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var eve={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},wq=Ll({name:"chartLayout",initialState:eve,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,i,s;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(i=t.payload.bottom)!==null&&i!==void 0?i:0,e.margin.left=(s=t.payload.left)!==null&&s!==void 0?s:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:tve,setLayout:rve,setChartSize:nve,setScale:ive}=wq.actions,ave=wq.reducer;function Sq(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function pi(e){return Number.isFinite(e)}function sd(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function fL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function rm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fL(Object(r),!0).forEach(function(n){sve(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sve(e,t,r){return(t=ove(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ove(e){var t=lve(e,"string");return typeof t=="symbol"?t:t+""}function lve(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ei(e,t,r){return Xi(e)||Xi(t)?r:Wc(t)?O0(e,t,r):typeof t=="function"?t(e):r}var cve=(e,t,r)=>{if(t&&r){var{width:n,height:i}=r,{align:s,verticalAlign:o,layout:l}=t;if((l==="vertical"||l==="horizontal"&&o==="middle")&&s!=="center"&&An(e[s]))return rm(rm({},e),{},{[s]:e[s]+(n||0)});if((l==="horizontal"||l==="vertical"&&s==="center")&&o!=="middle"&&An(e[o]))return rm(rm({},e),{},{[o]:e[o]+(i||0)})}return e},ff=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",_q=(e,t,r,n)=>{if(n)return e.map(l=>l.coordinate);var i,s,o=e.map(l=>(l.coordinate===t&&(i=!0),l.coordinate===r&&(s=!0),l.coordinate));return i||o.push(t),s||o.push(r),o},kq=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:i,range:s,scale:o,realScaleType:l,isCategorical:c,categoricalDomain:u,tickCount:d,ticks:f,niceTicks:h,axisType:p}=e;if(!o)return null;var m=l==="scaleBand"&&o.bandwidth?o.bandwidth()/2:2,g=i==="category"&&o.bandwidth?o.bandwidth()/m:0;if(g=p==="angleAxis"&&s&&s.length>=2?Ks(s[0]-s[1])*2*g:g,f||h){var y=(f||h||[]).map((b,v)=>{var w=n?n.indexOf(b):b,S=o.map(w);return pi(S)?{coordinate:S+g,value:b,offset:g,index:v}:null}).filter(_l);return y}return c&&u?u.map((b,v)=>{var w=o.map(b);return pi(w)?{coordinate:w+g,value:b,index:v,offset:g}:null}).filter(_l):o.ticks&&d!=null?o.ticks(d).map((b,v)=>{var w=o.map(b);return pi(w)?{coordinate:w+g,value:b,index:v,offset:g}:null}).filter(_l):o.domain().map((b,v)=>{var w=o.map(b);return pi(w)?{coordinate:w+g,value:n?n[b]:b,index:v,offset:g}:null}).filter(_l)},uve=(e,t)=>{if(!t||t.length!==2||!An(t[0])||!An(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),i=[e[0],e[1]];return(!An(e[0])||e[0]<r)&&(i[0]=r),(!An(e[1])||e[1]>n)&&(i[1]=n),i[0]>n&&(i[0]=n),i[1]<r&&(i[1]=r),i},dve=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var i=0;i<n;++i)for(var s=0,o=0,l=0;l<r;++l){var c=e[l],u=c==null?void 0:c[i];if(u!=null){var d=u[1],f=u[0],h=ad(d)?f:d;h>=0?(u[0]=s,s+=h,u[1]=s):(u[0]=o,o+=h,u[1]=o)}}}},fve=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var i=0;i<n;++i)for(var s=0,o=0;o<r;++o){var l=e[o],c=l==null?void 0:l[i];if(c!=null){var u=ad(c[1])?c[0]:c[1];u>=0?(c[0]=s,s+=u,c[1]=s):(c[0]=0,c[1]=0)}}}},hve={sign:dve,expand:H1e,none:P0,silhouette:V1e,wiggle:G1e,positive:fve},pve=(e,t,r)=>{var n,i=(n=hve[r])!==null&&n!==void 0?n:P0,s=q1e().keys(t).value((l,c)=>Number(Ei(l,c,0))).order(fA).offset(i),o=s(e);return o.forEach((l,c)=>{l.forEach((u,d)=>{var f=Ei(e[d],t[c],0);Array.isArray(f)&&f.length===2&&An(f[0])&&An(f[1])&&(u[0]=f[0],u[1]=f[1])})}),o};function mve(e){return e==null?void 0:String(e)}function mw(e){var{axis:t,ticks:r,bandSize:n,entry:i,index:s,dataKey:o}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Xi(i[t.dataKey])){var l=hW(r,"value",i[t.dataKey]);if(l)return l.coordinate+n/2}return r!=null&&r[s]?r[s].coordinate+n/2:null}var c=Ei(i,Xi(o)?t.dataKey:o),u=t.scale.map(c);return An(u)?u:null}var hL=e=>{var{axis:t,ticks:r,offset:n,bandSize:i,entry:s,index:o}=e;if(t.type==="category")return r[o]?r[o].coordinate+n:null;var l=Ei(s,t.dataKey,t.scale.domain()[o]);if(Xi(l))return null;var c=t.scale.map(l);return An(c)?c-i/2+n:null},gve=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]);return n<=0&&i>=0?0:i<0?i:n}return r[0]},xve=e=>{var t=e.flat(2).filter(An);return[Math.min(...t),Math.max(...t)]},yve=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],bve=(e,t,r)=>{if(e!=null)return yve(Object.keys(e).reduce((n,i)=>{var s=e[i];if(!s)return n;var{stackedData:o}=s,l=o.reduce((c,u)=>{var d=Sq(u,t,r),f=xve(d);return!pi(f[0])||!pi(f[1])?c:[Math.min(c[0],f[0]),Math.max(c[1],f[1])]},[1/0,-1/0]);return[Math.min(l[0],n[0]),Math.max(l[1],n[1])]},[1/0,-1/0]))},pL=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,mL=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,zm=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var i=VS(t,d=>d.coordinate),s=1/0,o=1,l=i.length;o<l;o++){var c=i[o],u=i[o-1];s=Math.min(((c==null?void 0:c.coordinate)||0)-((u==null?void 0:u.coordinate)||0),s)}return s===1/0?0:s}return r?void 0:0};function gL(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:i,name:s}=e;return rm(rm({},t),{},{dataKey:r,payload:n,value:i,name:s})}function Nh(e,t){if(e)return String(e);if(typeof t=="string")return t}var vve=(e,t)=>{if(t==="horizontal")return e.chartX;if(t==="vertical")return e.chartY},wve=(e,t)=>t==="centric"?e.angle:e.radius,hf=e=>e.layout.width,pf=e=>e.layout.height,Sve=e=>e.layout.scale,jq=e=>e.layout.margin,r_=Qt(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),n_=Qt(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),Aq="data-recharts-item-index",qC="data-recharts-item-id",gy=60;function xL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function av(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xL(Object(r),!0).forEach(function(n){_ve(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _ve(e,t,r){return(t=kve(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kve(e){var t=jve(e,"string");return typeof t=="symbol"?t:t+""}function jve(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ave=e=>e.brush.height;function Nve(e){var t=n_(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var i=typeof n.width=="number"?n.width:gy;return r+i}return r},0)}function Cve(e){var t=n_(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var i=typeof n.width=="number"?n.width:gy;return r+i}return r},0)}function Eve(e){var t=r_(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function Tve(e){var t=r_(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var Ls=Qt([hf,pf,jq,Ave,Nve,Cve,Eve,Tve,HW,rbe],(e,t,r,n,i,s,o,l,c,u)=>{var d={left:(r.left||0)+i,right:(r.right||0)+s},f={top:(r.top||0)+o,bottom:(r.bottom||0)+l},h=av(av({},f),d),p=h.bottom;h.bottom+=n,h=cve(h,c,u);var m=e-h.left-h.right,g=t-h.top-h.bottom;return av(av({brushBottom:p},h),{},{width:Math.max(m,0),height:Math.max(g,0)})}),Pve=Qt(Ls,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),HC=Qt(hf,pf,(e,t)=>({x:0,y:0,width:e,height:t})),Ove=x.createContext(null),Rs=()=>x.useContext(Ove)!=null,i_=e=>e.brush,a_=Qt([i_,Ls,jq],(e,t,r)=>({height:e.height,x:An(e.x)?e.x:t.left,y:An(e.y)?e.y:t.top+t.height+t.brushBottom-((r==null?void 0:r.bottom)||0),width:An(e.width)?e.width:t.width})),Nq={},Cq={},Eq={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:i,edges:s}={}){let o,l=null;const c=s!=null&&s.includes("leading"),u=s==null||s.includes("trailing"),d=()=>{l!==null&&(r.apply(o,l),o=void 0,l=null)},f=()=>{u&&d(),g()};let h=null;const p=()=>{h!=null&&clearTimeout(h),h=setTimeout(()=>{h=null,f()},n)},m=()=>{h!==null&&(clearTimeout(h),h=null)},g=()=>{m(),o=void 0,l=null},y=()=>{d()},b=function(...v){if(i!=null&&i.aborted)return;o=this,l=v;const w=h==null;p(),c&&w&&d()};return b.schedule=p,b.cancel=g,b.flush=y,i==null||i.addEventListener("abort",g,{once:!0}),b}e.debounce=t})(Eq);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Eq;function r(n,i=0,s={}){typeof s!="object"&&(s={});const{leading:o=!1,trailing:l=!0,maxWait:c}=s,u=Array(2);o&&(u[0]="leading"),l&&(u[1]="trailing");let d,f=null;const h=t.debounce(function(...g){d=n.apply(this,g),f=null},i,{edges:u}),p=function(...g){return c!=null&&(f===null&&(f=Date.now()),Date.now()-f>=c)?(d=n.apply(this,g),f=Date.now(),h.cancel(),h.schedule(),d):(h.apply(this,g),d)},m=()=>(h.flush(),d);return p.cancel=h.cancel,p.flush=m,p}e.debounce=r})(Cq);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Cq;function r(n,i=0,s={}){const{leading:o=!0,trailing:l=!0}=s;return t.debounce(n,i,{leading:o,maxWait:i,trailing:l})}e.throttle=r})(Nq);var Mve=Nq.throttle;const Lve=af(Mve);var gw=function(t,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];if(typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var o=0;console.warn(r.replace(/%s/g,()=>i[o++]))}},Ju={width:"100%",height:"100%",debounce:0,minWidth:0,initialDimension:{width:-1,height:-1}},Tq=(e,t,r)=>{var{width:n=Ju.width,height:i=Ju.height,aspect:s,maxHeight:o}=r,l=M0(n)?e:Number(n),c=M0(i)?t:Number(i);return s&&s>0&&(l?c=l/s:c&&(l=c*s),o&&c!=null&&c>o&&(c=o)),{calculatedWidth:l,calculatedHeight:c}},Rve={width:0,height:0,overflow:"visible"},Fve={width:0,overflowX:"visible"},Bve={height:0,overflowY:"visible"},Ive={},Dve=e=>{var{width:t,height:r}=e,n=M0(t),i=M0(r);return n&&i?Rve:n?Fve:i?Bve:Ive};function $ve(e){var{width:t,height:r,aspect:n}=e,i=t,s=r;return i===void 0&&s===void 0?(i=Ju.width,s=Ju.height):i===void 0?i=n&&n>0?void 0:Ju.width:s===void 0&&(s=n&&n>0?void 0:Ju.height),{width:i,height:s}}function kA(){return kA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kA.apply(null,arguments)}function yL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function bL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yL(Object(r),!0).forEach(function(n){Uve(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Uve(e,t,r){return(t=zve(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zve(e){var t=Wve(e,"string");return typeof t=="symbol"?t:t+""}function Wve(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pq=x.createContext(Ju.initialDimension);function qve(e){return sd(e.width)&&sd(e.height)}function Oq(e){var{children:t,width:r,height:n}=e,i=x.useMemo(()=>({width:r,height:n}),[r,n]);return qve(i)?x.createElement(Pq.Provider,{value:i},t):null}var VC=()=>x.useContext(Pq),Hve=x.forwardRef((e,t)=>{var{aspect:r,initialDimension:n=Ju.initialDimension,width:i,height:s,minWidth:o=Ju.minWidth,minHeight:l,maxHeight:c,children:u,debounce:d=Ju.debounce,id:f,className:h,onResize:p,style:m={}}=e,g=x.useRef(null),y=x.useRef();y.current=p,x.useImperativeHandle(t,()=>g.current);var[b,v]=x.useState({containerWidth:n.width,containerHeight:n.height}),w=x.useCallback((L,P)=>{v(F=>{var E=Math.round(L),T=Math.round(P);return F.containerWidth===E&&F.containerHeight===T?F:{containerWidth:E,containerHeight:T}})},[]);x.useEffect(()=>{if(g.current==null||typeof ResizeObserver>"u")return ip;var L=T=>{var B,q=T[0];if(q!=null){var{width:U,height:se}=q.contentRect;w(U,se),(B=y.current)===null||B===void 0||B.call(y,U,se)}};d>0&&(L=Lve(L,d,{trailing:!0,leading:!1}));var P=new ResizeObserver(L),{width:F,height:E}=g.current.getBoundingClientRect();return w(F,E),P.observe(g.current),()=>{P.disconnect()}},[w,d]);var{containerWidth:S,containerHeight:k}=b;gw(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:j,calculatedHeight:A}=Tq(S,k,{width:i,height:s,aspect:r,maxHeight:c});return gw(j!=null&&j>0||A!=null&&A>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,j,A,i,s,o,l,r),x.createElement("div",{id:f?"".concat(f):void 0,className:Si("recharts-responsive-container",h),style:bL(bL({},m),{},{width:i,height:s,minWidth:o,minHeight:l,maxHeight:c}),ref:g},x.createElement("div",{style:Dve({width:i,height:s})},x.createElement(Oq,{width:j,height:A},u)))}),xy=x.forwardRef((e,t)=>{var r=VC();if(sd(r.width)&&sd(r.height))return e.children;var{width:n,height:i}=$ve({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:s,calculatedHeight:o}=Tq(void 0,void 0,{width:n,height:i,aspect:e.aspect,maxHeight:e.maxHeight});return An(s)&&An(o)?x.createElement(Oq,{width:s,height:o},e.children):x.createElement(Hve,kA({},e,{width:n,height:i,ref:t}))});function GC(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var fg=()=>{var e,t=Rs(),r=yn(Pve),n=yn(a_),i=(e=yn(i_))===null||e===void 0?void 0:e.padding;return!t||!n||!i?r:{width:n.width-i.left-i.right,height:n.height-i.top-i.bottom,x:i.left,y:i.top}},Vve={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},Mq=()=>{var e;return(e=yn(Ls))!==null&&e!==void 0?e:Vve},KC=()=>yn(hf),YC=()=>yn(pf),Gve=()=>yn(e=>e.layout.margin),Pi=e=>e.layout.layoutType,ap=()=>yn(Pi),Lq=()=>{var e=ap();if(e==="horizontal"||e==="vertical")return e},Rq=e=>{var t=e.layout.layoutType;if(t==="centric"||t==="radial")return t},Kve=()=>{var e=ap();return e!==void 0},yy=e=>{var t=Ji(),r=Rs(),{width:n,height:i}=e,s=VC(),o=n,l=i;return s&&(o=s.width>0?s.width:n,l=s.height>0?s.height:i),x.useEffect(()=>{!r&&sd(o)&&sd(l)&&t(nve({width:o,height:l}))},[t,r,o,l]),null},Fq=Symbol.for("immer-nothing"),vL=Symbol.for("immer-draftable"),cc=Symbol.for("immer-state");function uu(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var C1=Object.getPrototypeOf;function Wm(e){return!!e&&!!e[cc]}function R0(e){var t;return e?Bq(e)||Array.isArray(e)||!!e[vL]||!!((t=e.constructor)!=null&&t[vL])||by(e)||o_(e):!1}var Yve=Object.prototype.constructor.toString(),wL=new WeakMap;function Bq(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=wL.get(r);return n===void 0&&(n=Function.toString.call(r),wL.set(r,n)),n===Yve}function xw(e,t,r=!0){s_(e)===0?(r?Reflect.ownKeys(e):Object.keys(e)).forEach(i=>{t(i,e[i],e)}):e.forEach((n,i)=>t(i,n,e))}function s_(e){const t=e[cc];return t?t.type_:Array.isArray(e)?1:by(e)?2:o_(e)?3:0}function jA(e,t){return s_(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Iq(e,t,r){const n=s_(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function Xve(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function by(e){return e instanceof Map}function o_(e){return e instanceof Set}function Uh(e){return e.copy_||e.base_}function AA(e,t){if(by(e))return new Map(e);if(o_(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=Bq(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[cc];let i=Reflect.ownKeys(n);for(let s=0;s<i.length;s++){const o=i[s],l=n[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[o]})}return Object.create(C1(e),n)}else{const n=C1(e);if(n!==null&&r)return{...e};const i=Object.create(n);return Object.assign(i,e)}}function XC(e,t=!1){return l_(e)||Wm(e)||!R0(e)||(s_(e)>1&&Object.defineProperties(e,{set:sv,add:sv,clear:sv,delete:sv}),Object.freeze(e),t&&Object.values(e).forEach(r=>XC(r,!0))),e}function Qve(){uu(2)}var sv={value:Qve};function l_(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var Jve={};function F0(e){const t=Jve[e];return t||uu(0,e),t}var E1;function Dq(){return E1}function Zve(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function SL(e,t){t&&(F0("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function NA(e){CA(e),e.drafts_.forEach(e2e),e.drafts_=null}function CA(e){e===E1&&(E1=e.parent_)}function _L(e){return E1=Zve(E1,e)}function e2e(e){const t=e[cc];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function kL(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[cc].modified_&&(NA(t),uu(4)),R0(e)&&(e=yw(t,e),t.parent_||bw(t,e)),t.patches_&&F0("Patches").generateReplacementPatches_(r[cc].base_,e,t.patches_,t.inversePatches_)):e=yw(t,r,[]),NA(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Fq?e:void 0}function yw(e,t,r){if(l_(t))return t;const n=e.immer_.shouldUseStrictIteration(),i=t[cc];if(!i)return xw(t,(s,o)=>jL(e,i,t,s,o,r),n),t;if(i.scope_!==e)return t;if(!i.modified_)return bw(e,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const s=i.copy_;let o=s,l=!1;i.type_===3&&(o=new Set(s),s.clear(),l=!0),xw(o,(c,u)=>jL(e,i,s,c,u,r,l),n),bw(e,s,!1),r&&e.patches_&&F0("Patches").generatePatches_(i,r,e.patches_,e.inversePatches_)}return i.copy_}function jL(e,t,r,n,i,s,o){if(i==null||typeof i!="object"&&!o)return;const l=l_(i);if(!(l&&!o)){if(Wm(i)){const c=s&&t&&t.type_!==3&&!jA(t.assigned_,n)?s.concat(n):void 0,u=yw(e,i,c);if(Iq(r,n,u),Wm(u))e.canAutoFreeze_=!1;else return}else o&&r.add(i);if(R0(i)&&!l){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[n]===i&&l)return;yw(e,i),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(by(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&bw(e,i)}}}function bw(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&XC(t,r)}function t2e(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:Dq(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,s=QC;r&&(i=[n],s=T1);const{revoke:o,proxy:l}=Proxy.revocable(i,s);return n.draft_=l,n.revoke_=o,l}var QC={get(e,t){if(t===cc)return e;const r=Uh(e);if(!jA(r,t))return r2e(e,r,t);const n=r[t];return e.finalized_||!R0(n)?n:n===Gk(e.base_,t)?(Kk(e),e.copy_[t]=TA(n,e)):n},has(e,t){return t in Uh(e)},ownKeys(e){return Reflect.ownKeys(Uh(e))},set(e,t,r){const n=$q(Uh(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const i=Gk(Uh(e),t),s=i==null?void 0:i[cc];if(s&&s.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(Xve(r,i)&&(r!==void 0||jA(e.base_,t)))return!0;Kk(e),EA(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Gk(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Kk(e),EA(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Uh(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){uu(11)},getPrototypeOf(e){return C1(e.base_)},setPrototypeOf(){uu(12)}},T1={};xw(QC,(e,t)=>{T1[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});T1.deleteProperty=function(e,t){return T1.set.call(this,e,t,void 0)};T1.set=function(e,t,r){return QC.set.call(this,e[0],t,r,e[0])};function Gk(e,t){const r=e[cc];return(r?Uh(r):e)[t]}function r2e(e,t,r){var i;const n=$q(t,r);return n?"value"in n?n.value:(i=n.get)==null?void 0:i.call(e.draft_):void 0}function $q(e,t){if(!(t in e))return;let r=C1(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=C1(r)}}function EA(e){e.modified_||(e.modified_=!0,e.parent_&&EA(e.parent_))}function Kk(e){e.copy_||(e.copy_=AA(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var n2e=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const s=r;r=t;const o=this;return function(c=s,...u){return o.produce(c,d=>r.call(this,d,...u))}}typeof r!="function"&&uu(6),n!==void 0&&typeof n!="function"&&uu(7);let i;if(R0(t)){const s=_L(this),o=TA(t,void 0);let l=!0;try{i=r(o),l=!1}finally{l?NA(s):CA(s)}return SL(s,n),kL(i,s)}else if(!t||typeof t!="object"){if(i=r(t),i===void 0&&(i=t),i===Fq&&(i=void 0),this.autoFreeze_&&XC(i,!0),n){const s=[],o=[];F0("Patches").generateReplacementPatches_(t,i,s,o),n(s,o)}return i}else uu(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(o,...l)=>this.produceWithPatches(o,c=>t(c,...l));let n,i;return[this.produce(t,r,(o,l)=>{n=o,i=l}),n,i]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof(e==null?void 0:e.useStrictIteration)=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){R0(e)||uu(8),Wm(e)&&(e=i2e(e));const t=_L(this),r=TA(e,void 0);return r[cc].isManual_=!0,CA(t),r}finishDraft(e,t){const r=e&&e[cc];(!r||!r.isManual_)&&uu(9);const{scope_:n}=r;return SL(n,t),kL(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const i=t[r];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}r>-1&&(t=t.slice(r+1));const n=F0("Patches").applyPatches_;return Wm(e)?n(e,t):this.produce(e,i=>n(i,t))}};function TA(e,t){const r=by(e)?F0("MapSet").proxyMap_(e,t):o_(e)?F0("MapSet").proxySet_(e,t):t2e(e,t);return(t?t.scope_:Dq()).drafts_.push(r),r}function i2e(e){return Wm(e)||uu(10,e),Uq(e)}function Uq(e){if(!R0(e)||l_(e))return e;const t=e[cc];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=AA(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=AA(e,!0);return xw(r,(i,s)=>{Iq(r,i,Uq(s))},n),t&&(t.finalized_=!1),r}var a2e=new n2e;a2e.produce;var s2e={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},zq=Ll({name:"legend",initialState:s2e,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:Sa()},replaceLegendPayload:{reducer(e,t){var{prev:r,next:n}=t.payload,i=yu(e).payload.indexOf(r);i>-1&&(e.payload[i]=n)},prepare:Sa()},removeLegendPayload:{reducer(e,t){var r=yu(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)},prepare:Sa()}}}),{setLegendSize:AL,setLegendSettings:o2e,addLegendPayload:Wq,replaceLegendPayload:qq,removeLegendPayload:Hq}=zq.actions,l2e=zq.reducer,c2e=["contextPayload"];function PA(){return PA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},PA.apply(null,arguments)}function NL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function qm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NL(Object(r),!0).forEach(function(n){u2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function u2e(e,t,r){return(t=d2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d2e(e){var t=f2e(e,"string");return typeof t=="symbol"?t:t+""}function f2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function h2e(e,t){if(e==null)return{};var r,n,i=p2e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function p2e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function m2e(e){return e.value}function g2e(e){var{contextPayload:t}=e,r=h2e(e,c2e),n=LW(t,e.payloadUniqBy,m2e),i=qm(qm({},r),{},{payload:n});return x.isValidElement(e.content)?x.cloneElement(e.content,i):typeof e.content=="function"?x.createElement(e.content,i):x.createElement(wye,i)}function x2e(e,t,r,n,i,s){var{layout:o,align:l,verticalAlign:c}=t,u,d;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(l==="center"&&o==="vertical"?u={left:((n||0)-s.width)/2}:u=l==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(c==="middle"?d={top:((i||0)-s.height)/2}:d=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),qm(qm({},u),d)}function y2e(e){var t=Ji();return x.useEffect(()=>{t(o2e(e))},[t,e]),null}function b2e(e){var t=Ji();return x.useEffect(()=>(t(AL(e)),()=>{t(AL({width:0,height:0}))}),[t,e]),null}function v2e(e,t,r,n){return e==="vertical"&&t!=null?{height:t}:e==="horizontal"?{width:r||n}:null}var w2e={align:"center",iconSize:14,inactiveColor:"#ccc",itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function JC(e){var t=Aa(e,w2e),r=abe(),n=p1e(),i=Gve(),{width:s,height:o,wrapperStyle:l,portal:c}=t,[u,d]=VW([r]),f=KC(),h=YC();if(f==null||h==null)return null;var p=f-((i==null?void 0:i.left)||0)-((i==null?void 0:i.right)||0),m=v2e(t.layout,o,s,p),g=c?l:qm(qm({position:"absolute",width:(m==null?void 0:m.width)||s||"auto",height:(m==null?void 0:m.height)||o||"auto"},x2e(l,t,i,f,h,u)),l),y=c??n;if(y==null||r==null)return null;var b=x.createElement("div",{className:"recharts-legend-wrapper",style:g,ref:d},x.createElement(y2e,{layout:t.layout,align:t.align,verticalAlign:t.verticalAlign,itemSorter:t.itemSorter}),!c&&x.createElement(b2e,{width:u.width,height:u.height}),x.createElement(g2e,PA({},t,m,{margin:i,chartWidth:f,chartHeight:h,contextPayload:r})));return K1.createPortal(b,y)}JC.displayName="Legend";function OA(){return OA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},OA.apply(null,arguments)}function CL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Vg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CL(Object(r),!0).forEach(function(n){S2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function S2e(e,t,r){return(t=_2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _2e(e){var t=k2e(e,"string");return typeof t=="symbol"?t:t+""}function k2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function j2e(e){return Array.isArray(e)&&Wc(e[0])&&Wc(e[1])?e.join(" ~ "):e}var Np={separator:" : ",contentStyle:{margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},itemStyle:{display:"block",paddingTop:4,paddingBottom:4,color:"#000"},labelStyle:{},accessibilityLayer:!1},A2e=e=>{var{separator:t=Np.separator,contentStyle:r,itemStyle:n,labelStyle:i=Np.labelStyle,payload:s,formatter:o,itemSorter:l,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:f,accessibilityLayer:h=Np.accessibilityLayer}=e,p=()=>{if(s&&s.length){var k={padding:0,margin:0},j=(l?VS(s,l):s).map((A,L)=>{if(A.type==="none")return null;var P=A.formatter||o||j2e,{value:F,name:E}=A,T=F,B=E;if(P){var q=P(F,E,A,L,s);if(Array.isArray(q))[T,B]=q;else if(q!=null)T=q;else return null}var U=Vg(Vg({},Np.itemStyle),{},{color:A.color||Np.itemStyle.color},n);return x.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(L),style:U},Wc(B)?x.createElement("span",{className:"recharts-tooltip-item-name"},B):null,Wc(B)?x.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,x.createElement("span",{className:"recharts-tooltip-item-value"},T),x.createElement("span",{className:"recharts-tooltip-item-unit"},A.unit||""))});return x.createElement("ul",{className:"recharts-tooltip-item-list",style:k},j)}return null},m=Vg(Vg({},Np.contentStyle),r),g=Vg({margin:0},i),y=!Xi(d),b=y?d:"",v=Si("recharts-default-tooltip",c),w=Si("recharts-tooltip-label",u);y&&f&&s!==void 0&&s!==null&&(b=f(d,s));var S=h?{role:"status","aria-live":"assertive"}:{};return x.createElement("div",OA({className:v,style:m},S),x.createElement("p",{className:w,style:g},x.isValidElement(b)?b:"".concat(b)),p())},Gg="recharts-tooltip-wrapper",N2e={visibility:"hidden"};function C2e(e){var{coordinate:t,translateX:r,translateY:n}=e;return Si(Gg,{["".concat(Gg,"-right")]:An(r)&&t&&An(t.x)&&r>=t.x,["".concat(Gg,"-left")]:An(r)&&t&&An(t.x)&&r<t.x,["".concat(Gg,"-bottom")]:An(n)&&t&&An(t.y)&&n>=t.y,["".concat(Gg,"-top")]:An(n)&&t&&An(t.y)&&n<t.y})}function EL(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offset:i,position:s,reverseDirection:o,tooltipDimension:l,viewBox:c,viewBoxDimension:u}=e;if(s&&An(s[n]))return s[n];var d=r[n]-l-(i>0?i:0),f=r[n]+i;if(t[n])return o[n]?d:f;var h=c[n];if(h==null)return 0;if(o[n]){var p=d,m=h;return p<m?Math.max(f,h):Math.max(d,h)}if(u==null)return 0;var g=f+l,y=h+u;return g>y?Math.max(d,h):Math.max(f,h)}function E2e(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function T2e(e){var{allowEscapeViewBox:t,coordinate:r,offsetTop:n,offsetLeft:i,position:s,reverseDirection:o,tooltipBox:l,useTranslate3d:c,viewBox:u}=e,d,f,h;return l.height>0&&l.width>0&&r?(f=EL({allowEscapeViewBox:t,coordinate:r,key:"x",offset:i,position:s,reverseDirection:o,tooltipDimension:l.width,viewBox:u,viewBoxDimension:u.width}),h=EL({allowEscapeViewBox:t,coordinate:r,key:"y",offset:n,position:s,reverseDirection:o,tooltipDimension:l.height,viewBox:u,viewBoxDimension:u.height}),d=E2e({translateX:f,translateY:h,useTranslate3d:c})):d=N2e,{cssProperties:d,cssClasses:C2e({translateX:f,translateY:h,coordinate:r})}}function TL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ov(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TL(Object(r),!0).forEach(function(n){MA(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MA(e,t,r){return(t=P2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P2e(e){var t=O2e(e,"string");return typeof t=="symbol"?t:t+""}function O2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class M2e extends x.PureComponent{constructor(){super(...arguments),MA(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),MA(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,i,s;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(i=(s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==null&&i!==void 0?i:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:i,children:s,coordinate:o,hasPayload:l,isAnimationActive:c,offset:u,position:d,reverseDirection:f,useTranslate3d:h,viewBox:p,wrapperStyle:m,lastBoundingBox:g,innerRef:y,hasPortalFromProps:b}=this.props,v=typeof u=="number"?u:u.x,w=typeof u=="number"?u:u.y,{cssClasses:S,cssProperties:k}=T2e({allowEscapeViewBox:r,coordinate:o,offsetLeft:v,offsetTop:w,position:d,reverseDirection:f,tooltipBox:{height:g.height,width:g.width},useTranslate3d:h,viewBox:p}),j=b?{}:ov(ov({transition:c&&t?"transform ".concat(n,"ms ").concat(i):void 0},k),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&l?"visible":"hidden",position:"absolute",top:0,left:0}),A=ov(ov({},j),{},{visibility:!this.state.dismissed&&t&&l?"visible":"hidden"},m);return x.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:S,style:A,ref:y},s)}}var Vq=()=>{var e;return(e=yn(t=>t.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0};function LA(){return LA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},LA.apply(null,arguments)}function PL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function OL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PL(Object(r),!0).forEach(function(n){L2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function L2e(e,t,r){return(t=R2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R2e(e){var t=F2e(e,"string");return typeof t=="symbol"?t:t+""}function F2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ML={curveBasisClosed:M1e,curveBasisOpen:L1e,curveBasis:O1e,curveBumpX:y1e,curveBumpY:b1e,curveLinearClosed:R1e,curveLinear:BS,curveMonotoneX:F1e,curveMonotoneY:B1e,curveNatural:I1e,curveStep:D1e,curveStepAfter:U1e,curveStepBefore:$1e},vw=e=>pi(e.x)&&pi(e.y),LL=e=>e.base!=null&&vw(e.base)&&vw(e),Kg=e=>e.x,Yg=e=>e.y,B2e=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(hy(e));if((r==="curveMonotone"||r==="curveBump")&&t){var n=ML["".concat(r).concat(t==="vertical"?"Y":"X")];if(n)return n}return ML[r]||BS},RL={connectNulls:!1,type:"linear"},I2e=e=>{var{type:t=RL.type,points:r=[],baseLine:n,layout:i,connectNulls:s=RL.connectNulls}=e,o=B2e(t,i),l=s?r.filter(vw):r;if(Array.isArray(n)){var c,u=r.map((m,g)=>OL(OL({},m),{},{base:n[g]}));i==="vertical"?c=Zb().y(Yg).x1(Kg).x0(m=>m.base.x):c=Zb().x(Kg).y1(Yg).y0(m=>m.base.y);var d=c.defined(LL).curve(o),f=s?u.filter(LL):u;return d(f)}var h;i==="vertical"&&An(n)?h=Zb().y(Yg).x1(Kg).x0(n):An(n)?h=Zb().x(Kg).y1(Yg).y0(n):h=Zz().x(Kg).y(Yg);var p=h.defined(vw).curve(o);return p(l)},c_=e=>{var{className:t,points:r,path:n,pathRef:i}=e,s=ap();if((!r||!r.length)&&!n)return null;var o={type:e.type,points:e.points,baseLine:e.baseLine,layout:e.layout||s,connectNulls:e.connectNulls},l=r&&r.length?I2e(o):n;return x.createElement("path",LA({},ol(e),AC(e),{className:Si("recharts-curve",t),d:l===null?void 0:l,ref:i}))},D2e=["x","y","top","left","width","height","className"];function RA(){return RA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},RA.apply(null,arguments)}function FL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function $2e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FL(Object(r),!0).forEach(function(n){U2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function U2e(e,t,r){return(t=z2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function z2e(e){var t=W2e(e,"string");return typeof t=="symbol"?t:t+""}function W2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function q2e(e,t){if(e==null)return{};var r,n,i=H2e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function H2e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var V2e=(e,t,r,n,i,s)=>"M".concat(e,",").concat(i,"v").concat(n,"M").concat(s,",").concat(t,"h").concat(r),G2e=e=>{var{x:t=0,y:r=0,top:n=0,left:i=0,width:s=0,height:o=0,className:l}=e,c=q2e(e,D2e),u=$2e({x:t,y:r,top:n,left:i,width:s,height:o},c);return!An(t)||!An(r)||!An(s)||!An(o)||!An(n)||!An(i)?null:x.createElement("path",RA({},Wo(u),{className:Si("recharts-cross",l),d:V2e(t,r,s,o,n,i)}))};function K2e(e,t,r,n){var i=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-i:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-i,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function BL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function IL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BL(Object(r),!0).forEach(function(n){Y2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Y2e(e,t,r){return(t=X2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function X2e(e){var t=Q2e(e,"string");return typeof t=="symbol"?t:t+""}function Q2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var J2e=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),Gq=(e,t,r)=>e.map(n=>"".concat(J2e(n)," ").concat(t,"ms ").concat(r)).join(","),Z2e=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(i=>n.includes(i))),P1=(e,t)=>Object.keys(t).reduce((r,n)=>IL(IL({},r),{},{[n]:e(n,t[n])}),{});function DL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ts(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DL(Object(r),!0).forEach(function(n){ewe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ewe(e,t,r){return(t=twe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function twe(e){var t=rwe(e,"string");return typeof t=="symbol"?t:t+""}function rwe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ww=(e,t,r)=>e+(t-e)*r,FA=e=>{var{from:t,to:r}=e;return t!==r},Kq=(e,t,r)=>{var n=P1((i,s)=>{if(FA(s)){var[o,l]=e(s.from,s.to,s.velocity);return Ts(Ts({},s),{},{from:o,velocity:l})}return s},t);return r<1?P1((i,s)=>FA(s)&&n[i]!=null?Ts(Ts({},s),{},{velocity:ww(s.velocity,n[i].velocity,r),from:ww(s.from,n[i].from,r)}):s,t):Kq(e,n,r-1)};function nwe(e,t,r,n,i,s){var o,l=n.reduce((h,p)=>Ts(Ts({},h),{},{[p]:{from:e[p],velocity:0,to:t[p]}}),{}),c=()=>P1((h,p)=>p.from,l),u=()=>!Object.values(l).filter(FA).length,d=null,f=h=>{o||(o=h);var p=h-o,m=p/r.dt;l=Kq(r,l,m),i(Ts(Ts(Ts({},e),t),c())),o=h,u()||(d=s.setTimeout(f))};return()=>(d=s.setTimeout(f),()=>{var h;(h=d)===null||h===void 0||h()})}function iwe(e,t,r,n,i,s,o){var l=null,c=i.reduce((f,h)=>{var p=e[h],m=t[h];return p==null||m==null?f:Ts(Ts({},f),{},{[h]:[p,m]})},{}),u,d=f=>{u||(u=f);var h=(f-u)/n,p=P1((g,y)=>ww(...y,r(h)),c);if(s(Ts(Ts(Ts({},e),t),p)),h<1)l=o.setTimeout(d);else{var m=P1((g,y)=>ww(...y,r(1)),c);s(Ts(Ts(Ts({},e),t),m))}};return()=>(l=o.setTimeout(d),()=>{var f;(f=l)===null||f===void 0||f()})}const awe=(e,t,r,n,i,s)=>{var o=Z2e(e,t);return r==null?()=>(i(Ts(Ts({},e),t)),()=>{}):r.isStepper===!0?nwe(e,t,r,o,i,s):iwe(e,t,r,n,o,i,s)};var Sw=1e-4,Yq=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],Xq=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),$L=(e,t)=>r=>{var n=Yq(e,t);return Xq(n,r)},swe=(e,t)=>r=>{var n=Yq(e,t),i=[...n.map((s,o)=>s*o).slice(1),0];return Xq(i,r)},owe=e=>{var t,r=e.split("(");if(r.length!==2||r[0]!=="cubic-bezier")return null;var n=(t=r[1])===null||t===void 0||(t=t.split(")")[0])===null||t===void 0?void 0:t.split(",");if(n==null||n.length!==4)return null;var i=n.map(s=>parseFloat(s));return[i[0],i[1],i[2],i[3]]},lwe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var i=owe(r[0]);if(i)return i}}return r.length===4?r:[0,0,1,1]},cwe=(e,t,r,n)=>{var i=$L(e,r),s=$L(t,n),o=swe(e,r),l=u=>u>1?1:u<0?0:u,c=u=>{for(var d=u>1?1:u,f=d,h=0;h<8;++h){var p=i(f)-d,m=o(f);if(Math.abs(p-d)<Sw||m<Sw)return s(f);f=l(f-p/m)}return s(f)};return c.isStepper=!1,c},UL=function(){return cwe(...lwe(...arguments))},uwe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:i=17}=t,s=(o,l,c)=>{var u=-(o-l)*r,d=c*n,f=c+(u-d)*i/1e3,h=c*i/1e3+o;return Math.abs(h-l)<Sw&&Math.abs(f)<Sw?[l,0]:[h,f]};return s.isStepper=!0,s.dt=i,s},dwe=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return UL(e);case"spring":return uwe();default:if(e.split("(")[0]==="cubic-bezier")return UL(e)}return typeof e=="function"?e:null};function fwe(e){var t,r=()=>null,n=!1,i=null,s=o=>{if(!n){if(Array.isArray(o)){if(!o.length)return;var l=o,[c,...u]=l;if(typeof c=="number"){i=e.setTimeout(s.bind(null,u),c);return}s(c),i=e.setTimeout(s.bind(null,u));return}typeof o=="string"&&(t=o,r(t)),typeof o=="object"&&(t=o,r(t)),typeof o=="function"&&o()}};return{stop:()=>{n=!0},start:o=>{n=!1,i&&(i(),i=null),s(o)},subscribe:o=>(r=o,()=>{r=()=>null}),getTimeoutController:()=>e}}class hwe{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),i=null,s=o=>{o-n>=r?t(o):typeof requestAnimationFrame=="function"&&(i=requestAnimationFrame(s))};return i=requestAnimationFrame(s),()=>{i!=null&&cancelAnimationFrame(i)}}}function pwe(){return fwe(new hwe)}var mwe=x.createContext(pwe);function gwe(e,t){var r=x.useContext(mwe);return x.useMemo(()=>t??r(e),[e,t,r])}var xwe=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),u_={isSsr:xwe()},ywe={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},zL={t:0},Yk={t:1};function hg(e){var t=Aa(e,ywe),{isActive:r,canBegin:n,duration:i,easing:s,begin:o,onAnimationEnd:l,onAnimationStart:c,children:u}=t,d=r==="auto"?!u_.isSsr:r,f=gwe(t.animationId,t.animationManager),[h,p]=x.useState(d?zL:Yk),m=x.useRef(null);return x.useEffect(()=>{d||p(Yk)},[d]),x.useEffect(()=>{if(!d||!n)return ip;var g=awe(zL,Yk,dwe(s),i,p,f.getTimeoutController()),y=()=>{m.current=g()};return f.start([c,o,y,i,l]),()=>{f.stop(),m.current&&m.current(),l()}},[d,n,i,s,o,c,l,f]),u(h.t)}function pg(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=x.useRef(k1(t)),n=x.useRef(e);return n.current!==e&&(r.current=k1(t),n.current=e),r.current}var bwe=["radius"],vwe=["radius"],WL,qL,HL,VL,GL,KL,YL,XL,QL,JL;function ZL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function e7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZL(Object(r),!0).forEach(function(n){wwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wwe(e,t,r){return(t=Swe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Swe(e){var t=_we(e,"string");return typeof t=="symbol"?t:t+""}function _we(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _w(){return _w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_w.apply(null,arguments)}function t7(e,t){if(e==null)return{};var r,n,i=kwe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function kwe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Bu(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var r7=(e,t,r,n,i)=>{var s=Yf(r),o=Yf(n),l=Math.min(Math.abs(s)/2,Math.abs(o)/2),c=o>=0?1:-1,u=s>=0?1:-1,d=o>=0&&s>=0||o<0&&s<0?1:0,f;if(l>0&&Array.isArray(i)){for(var h=[0,0,0,0],p=0,m=4;p<m;p++){var g,y=(g=i[p])!==null&&g!==void 0?g:0;h[p]=y>l?l:y}f=za(WL||(WL=Bu(["M",",",""])),e,t+c*h[0]),h[0]>0&&(f+=za(qL||(qL=Bu(["A ",",",",0,0,",",",",",""])),h[0],h[0],d,e+u*h[0],t)),f+=za(HL||(HL=Bu(["L ",",",""])),e+r-u*h[1],t),h[1]>0&&(f+=za(VL||(VL=Bu(["A ",",",",0,0,",`,
        `,",",""])),h[1],h[1],d,e+r,t+c*h[1])),f+=za(GL||(GL=Bu(["L ",",",""])),e+r,t+n-c*h[2]),h[2]>0&&(f+=za(KL||(KL=Bu(["A ",",",",0,0,",`,
        `,",",""])),h[2],h[2],d,e+r-u*h[2],t+n)),f+=za(YL||(YL=Bu(["L ",",",""])),e+u*h[3],t+n),h[3]>0&&(f+=za(XL||(XL=Bu(["A ",",",",0,0,",`,
        `,",",""])),h[3],h[3],d,e,t+n-c*h[3])),f+="Z"}else if(l>0&&i===+i&&i>0){var b=Math.min(l,i);f=za(QL||(QL=Bu(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),e,t+c*b,b,b,d,e+u*b,t,e+r-u*b,t,b,b,d,e+r,t+c*b,e+r,t+n-c*b,b,b,d,e+r-u*b,t+n,e+u*b,t+n,b,b,d,e,t+n-c*b)}else f=za(JL||(JL=Bu(["M ",","," h "," v "," h "," Z"])),e,t,r,n,-r);return f},n7={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Qq=e=>{var t=Aa(e,n7),r=x.useRef(null),[n,i]=x.useState(-1);x.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var de=r.current.getTotalLength();de&&i(de)}catch{}},[]);var{x:s,y:o,width:l,height:c,radius:u,className:d}=t,{animationEasing:f,animationDuration:h,animationBegin:p,isAnimationActive:m,isUpdateAnimationActive:g}=t,y=x.useRef(l),b=x.useRef(c),v=x.useRef(s),w=x.useRef(o),S=x.useMemo(()=>({x:s,y:o,width:l,height:c,radius:u}),[s,o,l,c,u]),k=pg(S,"rectangle-");if(s!==+s||o!==+o||l!==+l||c!==+c||l===0||c===0)return null;var j=Si("recharts-rectangle",d);if(!g){var A=Wo(t),{radius:L}=A,P=t7(A,bwe);return x.createElement("path",_w({},P,{x:Yf(s),y:Yf(o),width:Yf(l),height:Yf(c),radius:typeof u=="number"?u:void 0,className:j,d:r7(s,o,l,c,u)}))}var F=y.current,E=b.current,T=v.current,B=w.current,q="0px ".concat(n===-1?1:n,"px"),U="".concat(n,"px 0px"),se=Gq(["strokeDasharray"],h,typeof f=="string"?f:n7.animationEasing);return x.createElement(hg,{animationId:k,key:k,canBegin:n>0,duration:h,easing:f,isActive:g,begin:p},de=>{var z=Yi(F,l,de),G=Yi(E,c,de),ie=Yi(T,s,de),Y=Yi(B,o,de);r.current&&(y.current=z,b.current=G,v.current=ie,w.current=Y);var C;m?de>0?C={transition:se,strokeDasharray:U}:C={strokeDasharray:q}:C={strokeDasharray:U};var K=Wo(t),{radius:H}=K,R=t7(K,vwe);return x.createElement("path",_w({},R,{radius:typeof u=="number"?u:void 0,className:j,d:r7(ie,Y,z,G,u),ref:r,style:e7(e7({},C),t.style)}))})};function i7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function a7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i7(Object(r),!0).forEach(function(n){jwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jwe(e,t,r){return(t=Awe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Awe(e){var t=Nwe(e,"string");return typeof t=="symbol"?t:t+""}function Nwe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kw=Math.PI/180,Cwe=e=>e*180/Math.PI,ws=(e,t,r,n)=>({x:e+Math.cos(-kw*n)*r,y:t+Math.sin(-kw*n)*r}),Jq=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},Ewe=(e,t)=>{var{x:r,y:n}=e,{x:i,y:s}=t;return Math.sqrt((r-i)**2+(n-s)**2)},Twe=(e,t)=>{var{x:r,y:n}=e,{cx:i,cy:s}=t,o=Ewe({x:r,y:n},{x:i,y:s});if(o<=0)return{radius:o,angle:0};var l=(r-i)/o,c=Math.acos(l);return n>s&&(c=2*Math.PI-c),{radius:o,angle:Cwe(c),angleInRadian:c}},Pwe=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),i=Math.floor(r/360),s=Math.min(n,i);return{startAngle:t-s*360,endAngle:r-s*360}},Owe=(e,t)=>{var{startAngle:r,endAngle:n}=t,i=Math.floor(r/360),s=Math.floor(n/360),o=Math.min(i,s);return e+o*360},Mwe=(e,t)=>{var{chartX:r,chartY:n}=e,{radius:i,angle:s}=Twe({x:r,y:n},t),{innerRadius:o,outerRadius:l}=t;if(i<o||i>l||i===0)return null;var{startAngle:c,endAngle:u}=Pwe(t),d=s,f;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;f=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;f=d>=u&&d<=c}return f?a7(a7({},t),{},{radius:i,angle:Owe(d,t)}):null};function Zq(e){var{cx:t,cy:r,radius:n,startAngle:i,endAngle:s}=e,o=ws(t,r,n,i),l=ws(t,r,n,s);return{points:[o,l],cx:t,cy:r,radius:n,startAngle:i,endAngle:s}}var s7,o7,l7,c7,u7,d7,f7;function BA(){return BA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},BA.apply(null,arguments)}function Xh(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Lwe=(e,t)=>{var r=Ks(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},lv=e=>{var{cx:t,cy:r,radius:n,angle:i,sign:s,isExternal:o,cornerRadius:l,cornerIsExternal:c}=e,u=l*(o?1:-1)+n,d=Math.asin(l/u)/kw,f=c?i:i+s*d,h=ws(t,r,u,f),p=ws(t,r,n,f),m=c?i-s*d:i,g=ws(t,r,u*Math.cos(d*kw),m);return{center:h,circleTangency:p,lineTangency:g,theta:d}},eH=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:i,startAngle:s,endAngle:o}=e,l=Lwe(s,o),c=s+l,u=ws(t,r,i,s),d=ws(t,r,i,c),f=za(s7||(s7=Xh(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),u.x,u.y,i,i,+(Math.abs(l)>180),+(s>c),d.x,d.y);if(n>0){var h=ws(t,r,n,s),p=ws(t,r,n,c);f+=za(o7||(o7=Xh(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),p.x,p.y,n,n,+(Math.abs(l)>180),+(s<=c),h.x,h.y)}else f+=za(l7||(l7=Xh(["L ",","," Z"])),t,r);return f},Rwe=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:i,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:u}=e,d=Ks(u-c),{circleTangency:f,lineTangency:h,theta:p}=lv({cx:t,cy:r,radius:i,angle:c,sign:d,cornerRadius:s,cornerIsExternal:l}),{circleTangency:m,lineTangency:g,theta:y}=lv({cx:t,cy:r,radius:i,angle:u,sign:-d,cornerRadius:s,cornerIsExternal:l}),b=l?Math.abs(c-u):Math.abs(c-u)-p-y;if(b<0)return o?za(c7||(c7=Xh(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),h.x,h.y,s,s,s*2,s,s,-s*2):eH({cx:t,cy:r,innerRadius:n,outerRadius:i,startAngle:c,endAngle:u});var v=za(u7||(u7=Xh(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),h.x,h.y,s,s,+(d<0),f.x,f.y,i,i,+(b>180),+(d<0),m.x,m.y,s,s,+(d<0),g.x,g.y);if(n>0){var{circleTangency:w,lineTangency:S,theta:k}=lv({cx:t,cy:r,radius:n,angle:c,sign:d,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),{circleTangency:j,lineTangency:A,theta:L}=lv({cx:t,cy:r,radius:n,angle:u,sign:-d,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),P=l?Math.abs(c-u):Math.abs(c-u)-k-L;if(P<0&&s===0)return"".concat(v,"L").concat(t,",").concat(r,"Z");v+=za(d7||(d7=Xh(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),A.x,A.y,s,s,+(d<0),j.x,j.y,n,n,+(P>180),+(d>0),w.x,w.y,s,s,+(d<0),S.x,S.y)}else v+=za(f7||(f7=Xh(["L",",","Z"])),t,r);return v},Fwe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},tH=e=>{var t=Aa(e,Fwe),{cx:r,cy:n,innerRadius:i,outerRadius:s,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d,className:f}=t;if(s<i||u===d)return null;var h=Si("recharts-sector",f),p=s-i,m=$o(o,p,0,!0),g;return m>0&&Math.abs(u-d)<360?g=Rwe({cx:r,cy:n,innerRadius:i,outerRadius:s,cornerRadius:Math.min(m,p/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d}):g=eH({cx:r,cy:n,innerRadius:i,outerRadius:s,startAngle:u,endAngle:d}),x.createElement("path",BA({},Wo(t),{className:h,d:g}))};function Bwe(e,t,r){if(e==="horizontal")return[{x:t.x,y:r.top},{x:t.x,y:r.top+r.height}];if(e==="vertical")return[{x:r.left,y:t.y},{x:r.left+r.width,y:t.y}];if(mW(t)){if(e==="centric"){var{cx:n,cy:i,innerRadius:s,outerRadius:o,angle:l}=t,c=ws(n,i,s,l),u=ws(n,i,o,l);return[{x:c.x,y:c.y},{x:u.x,y:u.y}]}return Zq(t)}}var rH={},nH={},iH={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=FC;function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(iH);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=iH;function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(nH);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=BC,r=nH;function n(i,s,o){o&&typeof o!="number"&&t.isIterateeCall(i,s,o)&&(s=o=void 0),i=r.toFinite(i),s===void 0?(s=i,i=0):s=r.toFinite(s),o=o===void 0?i<s?1:-1:r.toFinite(o);const l=Math.max(Math.ceil((s-i)/(o||1)),0),c=new Array(l);for(let u=0;u<l;u++)c[u]=i,i+=o;return c}e.range=n})(rH);var Iwe=rH.range;const aH=af(Iwe);function sh(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Dwe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function ZC(e){let t,r,n;e.length!==2?(t=sh,r=(l,c)=>sh(e(l),c),n=(l,c)=>e(l)-c):(t=e===sh||e===Dwe?e:$we,r=e,n=e);function i(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<0?u=f+1:d=f}while(u<d)}return u}function s(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<=0?u=f+1:d=f}while(u<d)}return u}function o(l,c,u=0,d=l.length){const f=i(l,c,u,d-1);return f>u&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:i,center:o,right:s}}function $we(){return 0}function sH(e){return e===null?NaN:+e}function*Uwe(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const zwe=ZC(sh),vy=zwe.right;ZC(sH).center;class h7 extends Map{constructor(t,r=Hwe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,i]of t)this.set(n,i)}get(t){return super.get(p7(this,t))}has(t){return super.has(p7(this,t))}set(t,r){return super.set(Wwe(this,t),r)}delete(t){return super.delete(qwe(this,t))}}function p7({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function Wwe({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function qwe({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function Hwe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Vwe(e=sh){if(e===sh)return oH;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function oH(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const Gwe=Math.sqrt(50),Kwe=Math.sqrt(10),Ywe=Math.sqrt(2);function jw(e,t,r){const n=(t-e)/Math.max(0,r),i=Math.floor(Math.log10(n)),s=n/Math.pow(10,i),o=s>=Gwe?10:s>=Kwe?5:s>=Ywe?2:1;let l,c,u;return i<0?(u=Math.pow(10,-i)/o,l=Math.round(e*u),c=Math.round(t*u),l/u<e&&++l,c/u>t&&--c,u=-u):(u=Math.pow(10,i)*o,l=Math.round(e/u),c=Math.round(t/u),l*u<e&&++l,c*u>t&&--c),c<l&&.5<=r&&r<2?jw(e,t,r*2):[l,c,u]}function IA(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[i,s,o]=n?jw(t,e,r):jw(e,t,r);if(!(s>=i))return[];const l=s-i+1,c=new Array(l);if(n)if(o<0)for(let u=0;u<l;++u)c[u]=(s-u)/-o;else for(let u=0;u<l;++u)c[u]=(s-u)*o;else if(o<0)for(let u=0;u<l;++u)c[u]=(i+u)/-o;else for(let u=0;u<l;++u)c[u]=(i+u)*o;return c}function DA(e,t,r){return t=+t,e=+e,r=+r,jw(e,t,r)[2]}function $A(e,t,r){t=+t,e=+e,r=+r;const n=t<e,i=n?DA(t,e,r):DA(e,t,r);return(n?-1:1)*(i<0?1/-i:i)}function m7(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function g7(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function lH(e,t,r=0,n=1/0,i){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(i=i===void 0?oH:Vwe(i);n>r;){if(n-r>600){const c=n-r+1,u=t-r+1,d=Math.log(c),f=.5*Math.exp(2*d/3),h=.5*Math.sqrt(d*f*(c-f)/c)*(u-c/2<0?-1:1),p=Math.max(r,Math.floor(t-u*f/c+h)),m=Math.min(n,Math.floor(t+(c-u)*f/c+h));lH(e,t,p,m,i)}const s=e[t];let o=r,l=n;for(Xg(e,r,t),i(e[n],s)>0&&Xg(e,r,n);o<l;){for(Xg(e,o,l),++o,--l;i(e[o],s)<0;)++o;for(;i(e[l],s)>0;)--l}i(e[r],s)===0?Xg(e,r,l):(++l,Xg(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function Xg(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function Xwe(e,t,r){if(e=Float64Array.from(Uwe(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return g7(e);if(t>=1)return m7(e);var n,i=(n-1)*t,s=Math.floor(i),o=m7(lH(e,s).subarray(0,s+1)),l=g7(e.subarray(s+1));return o+(l-o)*(i-s)}}function Qwe(e,t,r=sH){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,i=(n-1)*t,s=Math.floor(i),o=+r(e[s],s,e),l=+r(e[s+1],s+1,e);return o+(l-o)*(i-s)}}function Jwe(e,t,r){e=+e,t=+t,r=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((t-e)/r))|0,s=new Array(i);++n<i;)s[n]=e+n*r;return s}function Kc(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function mf(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const UA=Symbol("implicit");function eE(){var e=new h7,t=[],r=[],n=UA;function i(s){let o=e.get(s);if(o===void 0){if(n!==UA)return n;e.set(s,o=t.push(s)-1)}return r[o%r.length]}return i.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new h7;for(const o of s)e.has(o)||e.set(o,t.push(o)-1);return i},i.range=function(s){return arguments.length?(r=Array.from(s),i):r.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return eE(t,r).unknown(n)},Kc.apply(i,arguments),i}function tE(){var e=eE().unknown(void 0),t=e.domain,r=e.range,n=0,i=1,s,o,l=!1,c=0,u=0,d=.5;delete e.unknown;function f(){var h=t().length,p=i<n,m=p?i:n,g=p?n:i;s=(g-m)/Math.max(1,h-c+u*2),l&&(s=Math.floor(s)),m+=(g-m-s*(h-c))*d,o=s*(1-c),l&&(m=Math.round(m),o=Math.round(o));var y=Jwe(h).map(function(b){return m+s*b});return r(p?y.reverse():y)}return e.domain=function(h){return arguments.length?(t(h),f()):t()},e.range=function(h){return arguments.length?([n,i]=h,n=+n,i=+i,f()):[n,i]},e.rangeRound=function(h){return[n,i]=h,n=+n,i=+i,l=!0,f()},e.bandwidth=function(){return o},e.step=function(){return s},e.round=function(h){return arguments.length?(l=!!h,f()):l},e.padding=function(h){return arguments.length?(c=Math.min(1,u=+h),f()):c},e.paddingInner=function(h){return arguments.length?(c=Math.min(1,h),f()):c},e.paddingOuter=function(h){return arguments.length?(u=+h,f()):u},e.align=function(h){return arguments.length?(d=Math.max(0,Math.min(1,h)),f()):d},e.copy=function(){return tE(t(),[n,i]).round(l).paddingInner(c).paddingOuter(u).align(d)},Kc.apply(f(),arguments)}function cH(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return cH(t())},e}function Zwe(){return cH(tE.apply(null,arguments).paddingInner(1))}function rE(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function uH(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function wy(){}var O1=.7,Aw=1/O1,_m="\\s*([+-]?\\d+)\\s*",M1="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",nd="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",eSe=/^#([0-9a-f]{3,8})$/,tSe=new RegExp(`^rgb\\(${_m},${_m},${_m}\\)$`),rSe=new RegExp(`^rgb\\(${nd},${nd},${nd}\\)$`),nSe=new RegExp(`^rgba\\(${_m},${_m},${_m},${M1}\\)$`),iSe=new RegExp(`^rgba\\(${nd},${nd},${nd},${M1}\\)$`),aSe=new RegExp(`^hsl\\(${M1},${nd},${nd}\\)$`),sSe=new RegExp(`^hsla\\(${M1},${nd},${nd},${M1}\\)$`),x7={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};rE(wy,L1,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:y7,formatHex:y7,formatHex8:oSe,formatHsl:lSe,formatRgb:b7,toString:b7});function y7(){return this.rgb().formatHex()}function oSe(){return this.rgb().formatHex8()}function lSe(){return dH(this).formatHsl()}function b7(){return this.rgb().formatRgb()}function L1(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=eSe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?v7(t):r===3?new kl(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?cv(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?cv(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=tSe.exec(e))?new kl(t[1],t[2],t[3],1):(t=rSe.exec(e))?new kl(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=nSe.exec(e))?cv(t[1],t[2],t[3],t[4]):(t=iSe.exec(e))?cv(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=aSe.exec(e))?_7(t[1],t[2]/100,t[3]/100,1):(t=sSe.exec(e))?_7(t[1],t[2]/100,t[3]/100,t[4]):x7.hasOwnProperty(e)?v7(x7[e]):e==="transparent"?new kl(NaN,NaN,NaN,0):null}function v7(e){return new kl(e>>16&255,e>>8&255,e&255,1)}function cv(e,t,r,n){return n<=0&&(e=t=r=NaN),new kl(e,t,r,n)}function cSe(e){return e instanceof wy||(e=L1(e)),e?(e=e.rgb(),new kl(e.r,e.g,e.b,e.opacity)):new kl}function zA(e,t,r,n){return arguments.length===1?cSe(e):new kl(e,t,r,n??1)}function kl(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}rE(kl,zA,uH(wy,{brighter(e){return e=e==null?Aw:Math.pow(Aw,e),new kl(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?O1:Math.pow(O1,e),new kl(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new kl(d0(this.r),d0(this.g),d0(this.b),Nw(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:w7,formatHex:w7,formatHex8:uSe,formatRgb:S7,toString:S7}));function w7(){return`#${Qh(this.r)}${Qh(this.g)}${Qh(this.b)}`}function uSe(){return`#${Qh(this.r)}${Qh(this.g)}${Qh(this.b)}${Qh((isNaN(this.opacity)?1:this.opacity)*255)}`}function S7(){const e=Nw(this.opacity);return`${e===1?"rgb(":"rgba("}${d0(this.r)}, ${d0(this.g)}, ${d0(this.b)}${e===1?")":`, ${e})`}`}function Nw(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function d0(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Qh(e){return e=d0(e),(e<16?"0":"")+e.toString(16)}function _7(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new du(e,t,r,n)}function dH(e){if(e instanceof du)return new du(e.h,e.s,e.l,e.opacity);if(e instanceof wy||(e=L1(e)),!e)return new du;if(e instanceof du)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),s=Math.max(t,r,n),o=NaN,l=s-i,c=(s+i)/2;return l?(t===s?o=(r-n)/l+(r<n)*6:r===s?o=(n-t)/l+2:o=(t-r)/l+4,l/=c<.5?s+i:2-s-i,o*=60):l=c>0&&c<1?0:o,new du(o,l,c,e.opacity)}function dSe(e,t,r,n){return arguments.length===1?dH(e):new du(e,t,r,n??1)}function du(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}rE(du,dSe,uH(wy,{brighter(e){return e=e==null?Aw:Math.pow(Aw,e),new du(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?O1:Math.pow(O1,e),new du(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new kl(Xk(e>=240?e-240:e+120,i,n),Xk(e,i,n),Xk(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new du(k7(this.h),uv(this.s),uv(this.l),Nw(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Nw(this.opacity);return`${e===1?"hsl(":"hsla("}${k7(this.h)}, ${uv(this.s)*100}%, ${uv(this.l)*100}%${e===1?")":`, ${e})`}`}}));function k7(e){return e=(e||0)%360,e<0?e+360:e}function uv(e){return Math.max(0,Math.min(1,e||0))}function Xk(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const nE=e=>()=>e;function fSe(e,t){return function(r){return e+r*t}}function hSe(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function pSe(e){return(e=+e)==1?fH:function(t,r){return r-t?hSe(t,r,e):nE(isNaN(t)?r:t)}}function fH(e,t){var r=t-e;return r?fSe(e,r):nE(isNaN(e)?t:e)}const j7=function e(t){var r=pSe(t);function n(i,s){var o=r((i=zA(i)).r,(s=zA(s)).r),l=r(i.g,s.g),c=r(i.b,s.b),u=fH(i.opacity,s.opacity);return function(d){return i.r=o(d),i.g=l(d),i.b=c(d),i.opacity=u(d),i+""}}return n.gamma=e,n}(1);function mSe(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(s){for(i=0;i<r;++i)n[i]=e[i]*(1-s)+t[i]*s;return n}}function gSe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function xSe(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),s=new Array(r),o;for(o=0;o<n;++o)i[o]=mg(e[o],t[o]);for(;o<r;++o)s[o]=t[o];return function(l){for(o=0;o<n;++o)s[o]=i[o](l);return s}}function ySe(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Cw(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function bSe(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=mg(e[i],t[i]):n[i]=t[i];return function(s){for(i in r)n[i]=r[i](s);return n}}var WA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Qk=new RegExp(WA.source,"g");function vSe(e){return function(){return e}}function wSe(e){return function(t){return e(t)+""}}function SSe(e,t){var r=WA.lastIndex=Qk.lastIndex=0,n,i,s,o=-1,l=[],c=[];for(e=e+"",t=t+"";(n=WA.exec(e))&&(i=Qk.exec(t));)(s=i.index)>r&&(s=t.slice(r,s),l[o]?l[o]+=s:l[++o]=s),(n=n[0])===(i=i[0])?l[o]?l[o]+=i:l[++o]=i:(l[++o]=null,c.push({i:o,x:Cw(n,i)})),r=Qk.lastIndex;return r<t.length&&(s=t.slice(r),l[o]?l[o]+=s:l[++o]=s),l.length<2?c[0]?wSe(c[0].x):vSe(t):(t=c.length,function(u){for(var d=0,f;d<t;++d)l[(f=c[d]).i]=f.x(u);return l.join("")})}function mg(e,t){var r=typeof t,n;return t==null||r==="boolean"?nE(t):(r==="number"?Cw:r==="string"?(n=L1(t))?(t=n,j7):SSe:t instanceof L1?j7:t instanceof Date?ySe:gSe(t)?mSe:Array.isArray(t)?xSe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?bSe:Cw)(e,t)}function iE(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function _Se(e,t){t===void 0&&(t=e,e=mg);for(var r=0,n=t.length-1,i=t[0],s=new Array(n<0?0:n);r<n;)s[r]=e(i,i=t[++r]);return function(o){var l=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return s[l](o-l)}}function kSe(e){return function(){return e}}function Ew(e){return+e}var A7=[0,1];function el(e){return e}function qA(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:kSe(isNaN(t)?NaN:.5)}function jSe(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function ASe(e,t,r){var n=e[0],i=e[1],s=t[0],o=t[1];return i<n?(n=qA(i,n),s=r(o,s)):(n=qA(n,i),s=r(s,o)),function(l){return s(n(l))}}function NSe(e,t,r){var n=Math.min(e.length,t.length)-1,i=new Array(n),s=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)i[o]=qA(e[o],e[o+1]),s[o]=r(t[o],t[o+1]);return function(l){var c=vy(e,l,1,n)-1;return s[c](i[c](l))}}function Sy(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function d_(){var e=A7,t=A7,r=mg,n,i,s,o=el,l,c,u;function d(){var h=Math.min(e.length,t.length);return o!==el&&(o=jSe(e[0],e[h-1])),l=h>2?NSe:ASe,c=u=null,f}function f(h){return h==null||isNaN(h=+h)?s:(c||(c=l(e.map(n),t,r)))(n(o(h)))}return f.invert=function(h){return o(i((u||(u=l(t,e.map(n),Cw)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,Ew),d()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),d()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),r=iE,d()},f.clamp=function(h){return arguments.length?(o=h?!0:el,d()):o!==el},f.interpolate=function(h){return arguments.length?(r=h,d()):r},f.unknown=function(h){return arguments.length?(s=h,f):s},function(h,p){return n=h,i=p,d()}}function aE(){return d_()(el,el)}function CSe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Tw(e,t){if(!isFinite(e)||e===0)return null;var r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"),n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Hm(e){return e=Tw(Math.abs(e)),e?e[1]:NaN}function ESe(e,t){return function(r,n){for(var i=r.length,s=[],o=0,l=e[0],c=0;i>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),s.push(r.substring(i-=l,i+l)),!((c+=l+1)>n));)l=e[o=(o+1)%e.length];return s.reverse().join(t)}}function TSe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var PSe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function R1(e){if(!(t=PSe.exec(e)))throw new Error("invalid format: "+e);var t;return new sE({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}R1.prototype=sE.prototype;function sE(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}sE.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function OSe(e){e:for(var t=e.length,r=1,n=-1,i;r<t;++r)switch(e[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(i+1):e}var Pw;function MSe(e,t){var r=Tw(e,t);if(!r)return Pw=void 0,e.toPrecision(t);var n=r[0],i=r[1],s=i-(Pw=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=n.length;return s===o?n:s>o?n+new Array(s-o+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+Tw(e,Math.max(0,t+s-1))[0]}function N7(e,t){var r=Tw(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const C7={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:CSe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>N7(e*100,t),r:N7,s:MSe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function E7(e){return e}var T7=Array.prototype.map,P7=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function LSe(e){var t=e.grouping===void 0||e.thousands===void 0?E7:ESe(T7.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?E7:TSe(T7.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(f,h){f=R1(f);var p=f.fill,m=f.align,g=f.sign,y=f.symbol,b=f.zero,v=f.width,w=f.comma,S=f.precision,k=f.trim,j=f.type;j==="n"?(w=!0,j="g"):C7[j]||(S===void 0&&(S=12),k=!0,j="g"),(b||p==="0"&&m==="=")&&(b=!0,p="0",m="=");var A=(h&&h.prefix!==void 0?h.prefix:"")+(y==="$"?r:y==="#"&&/[boxX]/.test(j)?"0"+j.toLowerCase():""),L=(y==="$"?n:/[%p]/.test(j)?o:"")+(h&&h.suffix!==void 0?h.suffix:""),P=C7[j],F=/[defgprs%]/.test(j);S=S===void 0?6:/[gprs]/.test(j)?Math.max(1,Math.min(21,S)):Math.max(0,Math.min(20,S));function E(T){var B=A,q=L,U,se,de;if(j==="c")q=P(T)+q,T="";else{T=+T;var z=T<0||1/T<0;if(T=isNaN(T)?c:P(Math.abs(T),S),k&&(T=OSe(T)),z&&+T==0&&g!=="+"&&(z=!1),B=(z?g==="("?g:l:g==="-"||g==="("?"":g)+B,q=(j==="s"&&!isNaN(T)&&Pw!==void 0?P7[8+Pw/3]:"")+q+(z&&g==="("?")":""),F){for(U=-1,se=T.length;++U<se;)if(de=T.charCodeAt(U),48>de||de>57){q=(de===46?i+T.slice(U+1):T.slice(U))+q,T=T.slice(0,U);break}}}w&&!b&&(T=t(T,1/0));var G=B.length+T.length+q.length,ie=G<v?new Array(v-G+1).join(p):"";switch(w&&b&&(T=t(ie+T,ie.length?v-q.length:1/0),ie=""),m){case"<":T=B+T+q+ie;break;case"=":T=B+ie+T+q;break;case"^":T=ie.slice(0,G=ie.length>>1)+B+T+q+ie.slice(G);break;default:T=ie+B+T+q;break}return s(T)}return E.toString=function(){return f+""},E}function d(f,h){var p=Math.max(-8,Math.min(8,Math.floor(Hm(h)/3)))*3,m=Math.pow(10,-p),g=u((f=R1(f),f.type="f",f),{suffix:P7[8+p/3]});return function(y){return g(m*y)}}return{format:u,formatPrefix:d}}var dv,oE,hH;RSe({thousands:",",grouping:[3],currency:["$",""]});function RSe(e){return dv=LSe(e),oE=dv.format,hH=dv.formatPrefix,dv}function FSe(e){return Math.max(0,-Hm(Math.abs(e)))}function BSe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Hm(t)/3)))*3-Hm(Math.abs(e)))}function ISe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Hm(t)-Hm(e))+1}function pH(e,t,r,n){var i=$A(e,t,r),s;switch(n=R1(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(s=BSe(i,o))&&(n.precision=s),hH(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(s=ISe(i,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=s-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(s=FSe(i))&&(n.precision=s-(n.type==="%")*2);break}}return oE(n)}function Ch(e){var t=e.domain;return e.ticks=function(r){var n=t();return IA(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var i=t();return pH(i[0],i[i.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),i=0,s=n.length-1,o=n[i],l=n[s],c,u,d=10;for(l<o&&(u=o,o=l,l=u,u=i,i=s,s=u);d-- >0;){if(u=DA(o,l,r),u===c)return n[i]=o,n[s]=l,t(n);if(u>0)o=Math.floor(o/u)*u,l=Math.ceil(l/u)*u;else if(u<0)o=Math.ceil(o*u)/u,l=Math.floor(l*u)/u;else break;c=u}return e},e}function mH(){var e=aE();return e.copy=function(){return Sy(e,mH())},Kc.apply(e,arguments),Ch(e)}function gH(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Ew),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return gH(e).unknown(t)},e=arguments.length?Array.from(e,Ew):[0,1],Ch(r)}function xH(e,t){e=e.slice();var r=0,n=e.length-1,i=e[r],s=e[n],o;return s<i&&(o=r,r=n,n=o,o=i,i=s,s=o),e[r]=t.floor(i),e[n]=t.ceil(s),e}function O7(e){return Math.log(e)}function M7(e){return Math.exp(e)}function DSe(e){return-Math.log(-e)}function $Se(e){return-Math.exp(-e)}function USe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function zSe(e){return e===10?USe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function WSe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function L7(e){return(t,r)=>-e(-t,r)}function lE(e){const t=e(O7,M7),r=t.domain;let n=10,i,s;function o(){return i=WSe(n),s=zSe(n),r()[0]<0?(i=L7(i),s=L7(s),e(DSe,$Se)):e(O7,M7),t}return t.base=function(l){return arguments.length?(n=+l,o()):n},t.domain=function(l){return arguments.length?(r(l),o()):r()},t.ticks=l=>{const c=r();let u=c[0],d=c[c.length-1];const f=d<u;f&&([u,d]=[d,u]);let h=i(u),p=i(d),m,g;const y=l==null?10:+l;let b=[];if(!(n%1)&&p-h<y){if(h=Math.floor(h),p=Math.ceil(p),u>0){for(;h<=p;++h)for(m=1;m<n;++m)if(g=h<0?m/s(-h):m*s(h),!(g<u)){if(g>d)break;b.push(g)}}else for(;h<=p;++h)for(m=n-1;m>=1;--m)if(g=h>0?m/s(-h):m*s(h),!(g<u)){if(g>d)break;b.push(g)}b.length*2<y&&(b=IA(u,d,y))}else b=IA(h,p,Math.min(p-h,y)).map(s);return f?b.reverse():b},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=R1(c)).precision==null&&(c.trim=!0),c=oE(c)),l===1/0)return c;const u=Math.max(1,n*l/t.ticks().length);return d=>{let f=d/s(Math.round(i(d)));return f*n<n-.5&&(f*=n),f<=u?c(d):""}},t.nice=()=>r(xH(r(),{floor:l=>s(Math.floor(i(l))),ceil:l=>s(Math.ceil(i(l)))})),t}function yH(){const e=lE(d_()).domain([1,10]);return e.copy=()=>Sy(e,yH()).base(e.base()),Kc.apply(e,arguments),e}function R7(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function F7(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function cE(e){var t=1,r=e(R7(t),F7(t));return r.constant=function(n){return arguments.length?e(R7(t=+n),F7(t)):t},Ch(r)}function bH(){var e=cE(d_());return e.copy=function(){return Sy(e,bH()).constant(e.constant())},Kc.apply(e,arguments)}function B7(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function qSe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function HSe(e){return e<0?-e*e:e*e}function uE(e){var t=e(el,el),r=1;function n(){return r===1?e(el,el):r===.5?e(qSe,HSe):e(B7(r),B7(1/r))}return t.exponent=function(i){return arguments.length?(r=+i,n()):r},Ch(t)}function dE(){var e=uE(d_());return e.copy=function(){return Sy(e,dE()).exponent(e.exponent())},Kc.apply(e,arguments),e}function VSe(){return dE.apply(null,arguments).exponent(.5)}function I7(e){return Math.sign(e)*e*e}function GSe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function vH(){var e=aE(),t=[0,1],r=!1,n;function i(s){var o=GSe(e(s));return isNaN(o)?n:r?Math.round(o):o}return i.invert=function(s){return e.invert(I7(s))},i.domain=function(s){return arguments.length?(e.domain(s),i):e.domain()},i.range=function(s){return arguments.length?(e.range((t=Array.from(s,Ew)).map(I7)),i):t.slice()},i.rangeRound=function(s){return i.range(s).round(!0)},i.round=function(s){return arguments.length?(r=!!s,i):r},i.clamp=function(s){return arguments.length?(e.clamp(s),i):e.clamp()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return vH(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Kc.apply(i,arguments),Ch(i)}function wH(){var e=[],t=[],r=[],n;function i(){var o=0,l=Math.max(1,t.length);for(r=new Array(l-1);++o<l;)r[o-1]=Qwe(e,o/l);return s}function s(o){return o==null||isNaN(o=+o)?n:t[vy(r,o)]}return s.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(sh),i()},s.range=function(o){return arguments.length?(t=Array.from(o),i()):t.slice()},s.unknown=function(o){return arguments.length?(n=o,s):n},s.quantiles=function(){return r.slice()},s.copy=function(){return wH().domain(e).range(t).unknown(n)},Kc.apply(s,arguments)}function SH(){var e=0,t=1,r=1,n=[.5],i=[0,1],s;function o(c){return c!=null&&c<=c?i[vy(n,c,0,r)]:s}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return o}return o.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},o.range=function(c){return arguments.length?(r=(i=Array.from(c)).length-1,l()):i.slice()},o.invertExtent=function(c){var u=i.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},o.unknown=function(c){return arguments.length&&(s=c),o},o.thresholds=function(){return n.slice()},o.copy=function(){return SH().domain([e,t]).range(i).unknown(s)},Kc.apply(Ch(o),arguments)}function _H(){var e=[.5],t=[0,1],r,n=1;function i(s){return s!=null&&s<=s?t[vy(e,s,0,n)]:r}return i.domain=function(s){return arguments.length?(e=Array.from(s),n=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(s){return arguments.length?(t=Array.from(s),n=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return _H().domain(e).range(t).unknown(r)},Kc.apply(i,arguments)}const Jk=new Date,Zk=new Date;function Fs(e,t,r,n){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const o=i(s),l=i.ceil(s);return s-o<l-s?o:l},i.offset=(s,o)=>(t(s=new Date(+s),o==null?1:Math.floor(o)),s),i.range=(s,o,l)=>{const c=[];if(s=i.ceil(s),l=l==null?1:Math.floor(l),!(s<o)||!(l>0))return c;let u;do c.push(u=new Date(+s)),t(s,l),e(s);while(u<s&&s<o);return c},i.filter=s=>Fs(o=>{if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!s(o););else for(;--l>=0;)for(;t(o,1),!s(o););}),r&&(i.count=(s,o)=>(Jk.setTime(+s),Zk.setTime(+o),e(Jk),e(Zk),Math.floor(r(Jk,Zk))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(n?o=>n(o)%s===0:o=>i.count(0,o)%s===0):i)),i}const Ow=Fs(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Ow.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Fs(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Ow);Ow.range;const Rd=1e3,Fc=Rd*60,Fd=Fc*60,Qd=Fd*24,fE=Qd*7,D7=Qd*30,ej=Qd*365,Jh=Fs(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Rd)},(e,t)=>(t-e)/Rd,e=>e.getUTCSeconds());Jh.range;const hE=Fs(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Rd)},(e,t)=>{e.setTime(+e+t*Fc)},(e,t)=>(t-e)/Fc,e=>e.getMinutes());hE.range;const pE=Fs(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Fc)},(e,t)=>(t-e)/Fc,e=>e.getUTCMinutes());pE.range;const mE=Fs(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Rd-e.getMinutes()*Fc)},(e,t)=>{e.setTime(+e+t*Fd)},(e,t)=>(t-e)/Fd,e=>e.getHours());mE.range;const gE=Fs(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Fd)},(e,t)=>(t-e)/Fd,e=>e.getUTCHours());gE.range;const _y=Fs(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Fc)/Qd,e=>e.getDate()-1);_y.range;const f_=Fs(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Qd,e=>e.getUTCDate()-1);f_.range;const kH=Fs(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Qd,e=>Math.floor(e/Qd));kH.range;function sp(e){return Fs(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Fc)/fE)}const h_=sp(0),Mw=sp(1),KSe=sp(2),YSe=sp(3),Vm=sp(4),XSe=sp(5),QSe=sp(6);h_.range;Mw.range;KSe.range;YSe.range;Vm.range;XSe.range;QSe.range;function op(e){return Fs(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/fE)}const p_=op(0),Lw=op(1),JSe=op(2),ZSe=op(3),Gm=op(4),e_e=op(5),t_e=op(6);p_.range;Lw.range;JSe.range;ZSe.range;Gm.range;e_e.range;t_e.range;const xE=Fs(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());xE.range;const yE=Fs(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());yE.range;const Jd=Fs(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Jd.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Fs(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Jd.range;const Zd=Fs(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Zd.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Fs(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Zd.range;function jH(e,t,r,n,i,s){const o=[[Jh,1,Rd],[Jh,5,5*Rd],[Jh,15,15*Rd],[Jh,30,30*Rd],[s,1,Fc],[s,5,5*Fc],[s,15,15*Fc],[s,30,30*Fc],[i,1,Fd],[i,3,3*Fd],[i,6,6*Fd],[i,12,12*Fd],[n,1,Qd],[n,2,2*Qd],[r,1,fE],[t,1,D7],[t,3,3*D7],[e,1,ej]];function l(u,d,f){const h=d<u;h&&([u,d]=[d,u]);const p=f&&typeof f.range=="function"?f:c(u,d,f),m=p?p.range(u,+d+1):[];return h?m.reverse():m}function c(u,d,f){const h=Math.abs(d-u)/f,p=ZC(([,,y])=>y).right(o,h);if(p===o.length)return e.every($A(u/ej,d/ej,f));if(p===0)return Ow.every(Math.max($A(u,d,f),1));const[m,g]=o[h/o[p-1][2]<o[p][2]/h?p-1:p];return m.every(g)}return[l,c]}const[r_e,n_e]=jH(Zd,yE,p_,kH,gE,pE),[i_e,a_e]=jH(Jd,xE,h_,_y,mE,hE);function tj(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function rj(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Qg(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function s_e(e){var t=e.dateTime,r=e.date,n=e.time,i=e.periods,s=e.days,o=e.shortDays,l=e.months,c=e.shortMonths,u=Jg(i),d=Zg(i),f=Jg(s),h=Zg(s),p=Jg(o),m=Zg(o),g=Jg(l),y=Zg(l),b=Jg(c),v=Zg(c),w={a:de,A:z,b:G,B:ie,c:null,d:H7,e:H7,f:E_e,g:D_e,G:U_e,H:A_e,I:N_e,j:C_e,L:AH,m:T_e,M:P_e,p:Y,q:C,Q:K7,s:Y7,S:O_e,u:M_e,U:L_e,V:R_e,w:F_e,W:B_e,x:null,X:null,y:I_e,Y:$_e,Z:z_e,"%":G7},S={a:K,A:H,b:R,B:J,c:null,d:V7,e:V7,f:V_e,g:r5e,G:i5e,H:W_e,I:q_e,j:H_e,L:CH,m:G_e,M:K_e,p:V,q:X,Q:K7,s:Y7,S:Y_e,u:X_e,U:Q_e,V:J_e,w:Z_e,W:e5e,x:null,X:null,y:t5e,Y:n5e,Z:a5e,"%":G7},k={a:F,A:E,b:T,B,c:q,d:W7,e:W7,f:S_e,g:z7,G:U7,H:q7,I:q7,j:y_e,L:w_e,m:x_e,M:b_e,p:P,q:g_e,Q:k_e,s:j_e,S:v_e,u:d_e,U:f_e,V:h_e,w:u_e,W:p_e,x:U,X:se,y:z7,Y:U7,Z:m_e,"%":__e};w.x=j(r,w),w.X=j(n,w),w.c=j(t,w),S.x=j(r,S),S.X=j(n,S),S.c=j(t,S);function j(Q,ne){return function(oe){var O=[],W=-1,ae=0,I=Q.length,Z,me,Te;for(oe instanceof Date||(oe=new Date(+oe));++W<I;)Q.charCodeAt(W)===37&&(O.push(Q.slice(ae,W)),(me=$7[Z=Q.charAt(++W)])!=null?Z=Q.charAt(++W):me=Z==="e"?" ":"0",(Te=ne[Z])&&(Z=Te(oe,me)),O.push(Z),ae=W+1);return O.push(Q.slice(ae,W)),O.join("")}}function A(Q,ne){return function(oe){var O=Qg(1900,void 0,1),W=L(O,Q,oe+="",0),ae,I;if(W!=oe.length)return null;if("Q"in O)return new Date(O.Q);if("s"in O)return new Date(O.s*1e3+("L"in O?O.L:0));if(ne&&!("Z"in O)&&(O.Z=0),"p"in O&&(O.H=O.H%12+O.p*12),O.m===void 0&&(O.m="q"in O?O.q:0),"V"in O){if(O.V<1||O.V>53)return null;"w"in O||(O.w=1),"Z"in O?(ae=rj(Qg(O.y,0,1)),I=ae.getUTCDay(),ae=I>4||I===0?Lw.ceil(ae):Lw(ae),ae=f_.offset(ae,(O.V-1)*7),O.y=ae.getUTCFullYear(),O.m=ae.getUTCMonth(),O.d=ae.getUTCDate()+(O.w+6)%7):(ae=tj(Qg(O.y,0,1)),I=ae.getDay(),ae=I>4||I===0?Mw.ceil(ae):Mw(ae),ae=_y.offset(ae,(O.V-1)*7),O.y=ae.getFullYear(),O.m=ae.getMonth(),O.d=ae.getDate()+(O.w+6)%7)}else("W"in O||"U"in O)&&("w"in O||(O.w="u"in O?O.u%7:"W"in O?1:0),I="Z"in O?rj(Qg(O.y,0,1)).getUTCDay():tj(Qg(O.y,0,1)).getDay(),O.m=0,O.d="W"in O?(O.w+6)%7+O.W*7-(I+5)%7:O.w+O.U*7-(I+6)%7);return"Z"in O?(O.H+=O.Z/100|0,O.M+=O.Z%100,rj(O)):tj(O)}}function L(Q,ne,oe,O){for(var W=0,ae=ne.length,I=oe.length,Z,me;W<ae;){if(O>=I)return-1;if(Z=ne.charCodeAt(W++),Z===37){if(Z=ne.charAt(W++),me=k[Z in $7?ne.charAt(W++):Z],!me||(O=me(Q,oe,O))<0)return-1}else if(Z!=oe.charCodeAt(O++))return-1}return O}function P(Q,ne,oe){var O=u.exec(ne.slice(oe));return O?(Q.p=d.get(O[0].toLowerCase()),oe+O[0].length):-1}function F(Q,ne,oe){var O=p.exec(ne.slice(oe));return O?(Q.w=m.get(O[0].toLowerCase()),oe+O[0].length):-1}function E(Q,ne,oe){var O=f.exec(ne.slice(oe));return O?(Q.w=h.get(O[0].toLowerCase()),oe+O[0].length):-1}function T(Q,ne,oe){var O=b.exec(ne.slice(oe));return O?(Q.m=v.get(O[0].toLowerCase()),oe+O[0].length):-1}function B(Q,ne,oe){var O=g.exec(ne.slice(oe));return O?(Q.m=y.get(O[0].toLowerCase()),oe+O[0].length):-1}function q(Q,ne,oe){return L(Q,t,ne,oe)}function U(Q,ne,oe){return L(Q,r,ne,oe)}function se(Q,ne,oe){return L(Q,n,ne,oe)}function de(Q){return o[Q.getDay()]}function z(Q){return s[Q.getDay()]}function G(Q){return c[Q.getMonth()]}function ie(Q){return l[Q.getMonth()]}function Y(Q){return i[+(Q.getHours()>=12)]}function C(Q){return 1+~~(Q.getMonth()/3)}function K(Q){return o[Q.getUTCDay()]}function H(Q){return s[Q.getUTCDay()]}function R(Q){return c[Q.getUTCMonth()]}function J(Q){return l[Q.getUTCMonth()]}function V(Q){return i[+(Q.getUTCHours()>=12)]}function X(Q){return 1+~~(Q.getUTCMonth()/3)}return{format:function(Q){var ne=j(Q+="",w);return ne.toString=function(){return Q},ne},parse:function(Q){var ne=A(Q+="",!1);return ne.toString=function(){return Q},ne},utcFormat:function(Q){var ne=j(Q+="",S);return ne.toString=function(){return Q},ne},utcParse:function(Q){var ne=A(Q+="",!0);return ne.toString=function(){return Q},ne}}}var $7={"-":"",_:" ",0:"0"},Xs=/^\s*\d+/,o_e=/^%/,l_e=/[\\^$*+?|[\]().{}]/g;function Ti(e,t,r){var n=e<0?"-":"",i=(n?-e:e)+"",s=i.length;return n+(s<r?new Array(r-s+1).join(t)+i:i)}function c_e(e){return e.replace(l_e,"\\$&")}function Jg(e){return new RegExp("^(?:"+e.map(c_e).join("|")+")","i")}function Zg(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function u_e(e,t,r){var n=Xs.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function d_e(e,t,r){var n=Xs.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function f_e(e,t,r){var n=Xs.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function h_e(e,t,r){var n=Xs.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function p_e(e,t,r){var n=Xs.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function U7(e,t,r){var n=Xs.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function z7(e,t,r){var n=Xs.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function m_e(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function g_e(e,t,r){var n=Xs.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function x_e(e,t,r){var n=Xs.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function W7(e,t,r){var n=Xs.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function y_e(e,t,r){var n=Xs.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function q7(e,t,r){var n=Xs.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function b_e(e,t,r){var n=Xs.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function v_e(e,t,r){var n=Xs.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function w_e(e,t,r){var n=Xs.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function S_e(e,t,r){var n=Xs.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function __e(e,t,r){var n=o_e.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function k_e(e,t,r){var n=Xs.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function j_e(e,t,r){var n=Xs.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function H7(e,t){return Ti(e.getDate(),t,2)}function A_e(e,t){return Ti(e.getHours(),t,2)}function N_e(e,t){return Ti(e.getHours()%12||12,t,2)}function C_e(e,t){return Ti(1+_y.count(Jd(e),e),t,3)}function AH(e,t){return Ti(e.getMilliseconds(),t,3)}function E_e(e,t){return AH(e,t)+"000"}function T_e(e,t){return Ti(e.getMonth()+1,t,2)}function P_e(e,t){return Ti(e.getMinutes(),t,2)}function O_e(e,t){return Ti(e.getSeconds(),t,2)}function M_e(e){var t=e.getDay();return t===0?7:t}function L_e(e,t){return Ti(h_.count(Jd(e)-1,e),t,2)}function NH(e){var t=e.getDay();return t>=4||t===0?Vm(e):Vm.ceil(e)}function R_e(e,t){return e=NH(e),Ti(Vm.count(Jd(e),e)+(Jd(e).getDay()===4),t,2)}function F_e(e){return e.getDay()}function B_e(e,t){return Ti(Mw.count(Jd(e)-1,e),t,2)}function I_e(e,t){return Ti(e.getFullYear()%100,t,2)}function D_e(e,t){return e=NH(e),Ti(e.getFullYear()%100,t,2)}function $_e(e,t){return Ti(e.getFullYear()%1e4,t,4)}function U_e(e,t){var r=e.getDay();return e=r>=4||r===0?Vm(e):Vm.ceil(e),Ti(e.getFullYear()%1e4,t,4)}function z_e(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ti(t/60|0,"0",2)+Ti(t%60,"0",2)}function V7(e,t){return Ti(e.getUTCDate(),t,2)}function W_e(e,t){return Ti(e.getUTCHours(),t,2)}function q_e(e,t){return Ti(e.getUTCHours()%12||12,t,2)}function H_e(e,t){return Ti(1+f_.count(Zd(e),e),t,3)}function CH(e,t){return Ti(e.getUTCMilliseconds(),t,3)}function V_e(e,t){return CH(e,t)+"000"}function G_e(e,t){return Ti(e.getUTCMonth()+1,t,2)}function K_e(e,t){return Ti(e.getUTCMinutes(),t,2)}function Y_e(e,t){return Ti(e.getUTCSeconds(),t,2)}function X_e(e){var t=e.getUTCDay();return t===0?7:t}function Q_e(e,t){return Ti(p_.count(Zd(e)-1,e),t,2)}function EH(e){var t=e.getUTCDay();return t>=4||t===0?Gm(e):Gm.ceil(e)}function J_e(e,t){return e=EH(e),Ti(Gm.count(Zd(e),e)+(Zd(e).getUTCDay()===4),t,2)}function Z_e(e){return e.getUTCDay()}function e5e(e,t){return Ti(Lw.count(Zd(e)-1,e),t,2)}function t5e(e,t){return Ti(e.getUTCFullYear()%100,t,2)}function r5e(e,t){return e=EH(e),Ti(e.getUTCFullYear()%100,t,2)}function n5e(e,t){return Ti(e.getUTCFullYear()%1e4,t,4)}function i5e(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Gm(e):Gm.ceil(e),Ti(e.getUTCFullYear()%1e4,t,4)}function a5e(){return"+0000"}function G7(){return"%"}function K7(e){return+e}function Y7(e){return Math.floor(+e/1e3)}var Cp,TH,PH;s5e({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function s5e(e){return Cp=s_e(e),TH=Cp.format,Cp.parse,PH=Cp.utcFormat,Cp.utcParse,Cp}function o5e(e){return new Date(e)}function l5e(e){return e instanceof Date?+e:+new Date(+e)}function bE(e,t,r,n,i,s,o,l,c,u){var d=aE(),f=d.invert,h=d.domain,p=u(".%L"),m=u(":%S"),g=u("%I:%M"),y=u("%I %p"),b=u("%a %d"),v=u("%b %d"),w=u("%B"),S=u("%Y");function k(j){return(c(j)<j?p:l(j)<j?m:o(j)<j?g:s(j)<j?y:n(j)<j?i(j)<j?b:v:r(j)<j?w:S)(j)}return d.invert=function(j){return new Date(f(j))},d.domain=function(j){return arguments.length?h(Array.from(j,l5e)):h().map(o5e)},d.ticks=function(j){var A=h();return e(A[0],A[A.length-1],j??10)},d.tickFormat=function(j,A){return A==null?k:u(A)},d.nice=function(j){var A=h();return(!j||typeof j.range!="function")&&(j=t(A[0],A[A.length-1],j??10)),j?h(xH(A,j)):d},d.copy=function(){return Sy(d,bE(e,t,r,n,i,s,o,l,c,u))},d}function c5e(){return Kc.apply(bE(i_e,a_e,Jd,xE,h_,_y,mE,hE,Jh,TH).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function u5e(){return Kc.apply(bE(r_e,n_e,Zd,yE,p_,f_,gE,pE,Jh,PH).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function m_(){var e=0,t=1,r,n,i,s,o=el,l=!1,c;function u(f){return f==null||isNaN(f=+f)?c:o(i===0?.5:(f=(s(f)-r)*i,l?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,r=s(e=+e),n=s(t=+t),i=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(f){return arguments.length?(l=!!f,u):l},u.interpolator=function(f){return arguments.length?(o=f,u):o};function d(f){return function(h){var p,m;return arguments.length?([p,m]=h,o=f(p,m),u):[o(0),o(1)]}}return u.range=d(mg),u.rangeRound=d(iE),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return s=f,r=f(e),n=f(t),i=r===n?0:1/(n-r),u}}function Eh(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function OH(){var e=Ch(m_()(el));return e.copy=function(){return Eh(e,OH())},mf.apply(e,arguments)}function MH(){var e=lE(m_()).domain([1,10]);return e.copy=function(){return Eh(e,MH()).base(e.base())},mf.apply(e,arguments)}function LH(){var e=cE(m_());return e.copy=function(){return Eh(e,LH()).constant(e.constant())},mf.apply(e,arguments)}function vE(){var e=uE(m_());return e.copy=function(){return Eh(e,vE()).exponent(e.exponent())},mf.apply(e,arguments)}function d5e(){return vE.apply(null,arguments).exponent(.5)}function RH(){var e=[],t=el;function r(n){if(n!=null&&!isNaN(n=+n))return t((vy(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let i of n)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(sh),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,i)=>t(i/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,s)=>Xwe(e,s/n))},r.copy=function(){return RH(t).domain(e)},mf.apply(r,arguments)}function g_(){var e=0,t=.5,r=1,n=1,i,s,o,l,c,u=el,d,f=!1,h;function p(g){return isNaN(g=+g)?h:(g=.5+((g=+d(g))-s)*(n*g<n*s?l:c),u(f?Math.max(0,Math.min(1,g)):g))}p.domain=function(g){return arguments.length?([e,t,r]=g,i=d(e=+e),s=d(t=+t),o=d(r=+r),l=i===s?0:.5/(s-i),c=s===o?0:.5/(o-s),n=s<i?-1:1,p):[e,t,r]},p.clamp=function(g){return arguments.length?(f=!!g,p):f},p.interpolator=function(g){return arguments.length?(u=g,p):u};function m(g){return function(y){var b,v,w;return arguments.length?([b,v,w]=y,u=_Se(g,[b,v,w]),p):[u(0),u(.5),u(1)]}}return p.range=m(mg),p.rangeRound=m(iE),p.unknown=function(g){return arguments.length?(h=g,p):h},function(g){return d=g,i=g(e),s=g(t),o=g(r),l=i===s?0:.5/(s-i),c=s===o?0:.5/(o-s),n=s<i?-1:1,p}}function FH(){var e=Ch(g_()(el));return e.copy=function(){return Eh(e,FH())},mf.apply(e,arguments)}function BH(){var e=lE(g_()).domain([.1,1,10]);return e.copy=function(){return Eh(e,BH()).base(e.base())},mf.apply(e,arguments)}function IH(){var e=cE(g_());return e.copy=function(){return Eh(e,IH()).constant(e.constant())},mf.apply(e,arguments)}function wE(){var e=uE(g_());return e.copy=function(){return Eh(e,wE()).exponent(e.exponent())},mf.apply(e,arguments)}function f5e(){return wE.apply(null,arguments).exponent(.5)}const mx=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:tE,scaleDiverging:FH,scaleDivergingLog:BH,scaleDivergingPow:wE,scaleDivergingSqrt:f5e,scaleDivergingSymlog:IH,scaleIdentity:gH,scaleImplicit:UA,scaleLinear:mH,scaleLog:yH,scaleOrdinal:eE,scalePoint:Zwe,scalePow:dE,scaleQuantile:wH,scaleQuantize:SH,scaleRadial:vH,scaleSequential:OH,scaleSequentialLog:MH,scaleSequentialPow:vE,scaleSequentialQuantile:RH,scaleSequentialSqrt:d5e,scaleSequentialSymlog:LH,scaleSqrt:VSe,scaleSymlog:bH,scaleThreshold:_H,scaleTime:c5e,scaleUtc:u5e,tickFormat:pH},Symbol.toStringTag,{value:"Module"}));var gf=e=>e.chartData,x_=Qt([gf],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),y_=(e,t,r,n)=>n?x_(e):gf(e),h5e=(e,t,r)=>r?x_(e):gf(e);function ef(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(pi(t)&&pi(r))return!0}return!1}function X7(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function DH(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,i,s;if(pi(r))i=r;else if(typeof r=="function")return;if(pi(n))s=n;else if(typeof n=="function")return;var o=[i,s];if(ef(o))return o}}function p5e(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(ef(n))return X7(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[i,s]=e,o,l;if(i==="auto")t!=null&&(o=Math.min(...t));else if(An(i))o=i;else if(typeof i=="function")try{t!=null&&(o=i(t==null?void 0:t[0]))}catch{}else if(typeof i=="string"&&pL.test(i)){var c=pL.exec(i);if(c==null||c[1]==null||t==null)o=void 0;else{var u=+c[1];o=t[0]-u}}else o=t==null?void 0:t[0];if(s==="auto")t!=null&&(l=Math.max(...t));else if(An(s))l=s;else if(typeof s=="function")try{t!=null&&(l=s(t==null?void 0:t[1]))}catch{}else if(typeof s=="string"&&mL.test(s)){var d=mL.exec(s);if(d==null||d[1]==null||t==null)l=void 0;else{var f=+d[1];l=t[1]+f}}else l=t==null?void 0:t[1];var h=[o,l];if(ef(h))return t==null?h:X7(h,t,r)}}}var gg=1e9,m5e={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},_E,ka=!0,Hc="[DecimalError] ",f0=Hc+"Invalid argument: ",SE=Hc+"Exponent out of range: ",xg=Math.floor,zh=Math.pow,g5e=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Zl,Ws=1e7,ha=7,$H=9007199254740991,Rw=xg($H/ha),Nn={};Nn.absoluteValue=Nn.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Nn.comparedTo=Nn.cmp=function(e){var t,r,n,i,s=this;if(e=new s.constructor(e),s.s!==e.s)return s.s||-e.s;if(s.e!==e.e)return s.e>e.e^s.s<0?1:-1;for(n=s.d.length,i=e.d.length,t=0,r=n<i?n:i;t<r;++t)if(s.d[t]!==e.d[t])return s.d[t]>e.d[t]^s.s<0?1:-1;return n===i?0:n>i^s.s<0?1:-1};Nn.decimalPlaces=Nn.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*ha;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Nn.dividedBy=Nn.div=function(e){return zd(this,new this.constructor(e))};Nn.dividedToIntegerBy=Nn.idiv=function(e){var t=this,r=t.constructor;return aa(zd(t,new r(e),0,1),r.precision)};Nn.equals=Nn.eq=function(e){return!this.cmp(e)};Nn.exponent=function(){return Ss(this)};Nn.greaterThan=Nn.gt=function(e){return this.cmp(e)>0};Nn.greaterThanOrEqualTo=Nn.gte=function(e){return this.cmp(e)>=0};Nn.isInteger=Nn.isint=function(){return this.e>this.d.length-2};Nn.isNegative=Nn.isneg=function(){return this.s<0};Nn.isPositive=Nn.ispos=function(){return this.s>0};Nn.isZero=function(){return this.s===0};Nn.lessThan=Nn.lt=function(e){return this.cmp(e)<0};Nn.lessThanOrEqualTo=Nn.lte=function(e){return this.cmp(e)<1};Nn.logarithm=Nn.log=function(e){var t,r=this,n=r.constructor,i=n.precision,s=i+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Zl))throw Error(Hc+"NaN");if(r.s<1)throw Error(Hc+(r.s?"NaN":"-Infinity"));return r.eq(Zl)?new n(0):(ka=!1,t=zd(F1(r,s),F1(e,s),s),ka=!0,aa(t,i))};Nn.minus=Nn.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?WH(t,e):UH(t,(e.s=-e.s,e))};Nn.modulo=Nn.mod=function(e){var t,r=this,n=r.constructor,i=n.precision;if(e=new n(e),!e.s)throw Error(Hc+"NaN");return r.s?(ka=!1,t=zd(r,e,0,1).times(e),ka=!0,r.minus(t)):aa(new n(r),i)};Nn.naturalExponential=Nn.exp=function(){return zH(this)};Nn.naturalLogarithm=Nn.ln=function(){return F1(this)};Nn.negated=Nn.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Nn.plus=Nn.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?UH(t,e):WH(t,(e.s=-e.s,e))};Nn.precision=Nn.sd=function(e){var t,r,n,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(f0+e);if(t=Ss(i)+1,n=i.d.length-1,r=n*ha+1,n=i.d[n],n){for(;n%10==0;n/=10)r--;for(n=i.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};Nn.squareRoot=Nn.sqrt=function(){var e,t,r,n,i,s,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(Hc+"NaN")}for(e=Ss(l),ka=!1,i=Math.sqrt(+l),i==0||i==1/0?(t=Zu(l.d),(t.length+e)%2==0&&(t+="0"),i=Math.sqrt(t),e=xg((e+1)/2)-(e<0||e%2),i==1/0?t="5e"+e:(t=i.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(i.toString()),r=c.precision,i=o=r+3;;)if(s=n,n=s.plus(zd(l,s,o+2)).times(.5),Zu(s.d).slice(0,o)===(t=Zu(n.d)).slice(0,o)){if(t=t.slice(o-3,o+1),i==o&&t=="4999"){if(aa(s,r+1,0),s.times(s).eq(l)){n=s;break}}else if(t!="9999")break;o+=4}return ka=!0,aa(n,r)};Nn.times=Nn.mul=function(e){var t,r,n,i,s,o,l,c,u,d=this,f=d.constructor,h=d.d,p=(e=new f(e)).d;if(!d.s||!e.s)return new f(0);for(e.s*=d.s,r=d.e+e.e,c=h.length,u=p.length,c<u&&(s=h,h=p,p=s,o=c,c=u,u=o),s=[],o=c+u,n=o;n--;)s.push(0);for(n=u;--n>=0;){for(t=0,i=c+n;i>n;)l=s[i]+p[n]*h[i-n-1]+t,s[i--]=l%Ws|0,t=l/Ws|0;s[i]=(s[i]+t)%Ws|0}for(;!s[--o];)s.pop();return t?++r:s.shift(),e.d=s,e.e=r,ka?aa(e,f.precision):e};Nn.toDecimalPlaces=Nn.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(od(e,0,gg),t===void 0?t=n.rounding:od(t,0,8),aa(r,e+Ss(r)+1,t))};Nn.toExponential=function(e,t){var r,n=this,i=n.constructor;return e===void 0?r=B0(n,!0):(od(e,0,gg),t===void 0?t=i.rounding:od(t,0,8),n=aa(new i(n),e+1,t),r=B0(n,!0,e+1)),r};Nn.toFixed=function(e,t){var r,n,i=this,s=i.constructor;return e===void 0?B0(i):(od(e,0,gg),t===void 0?t=s.rounding:od(t,0,8),n=aa(new s(i),e+Ss(i)+1,t),r=B0(n.abs(),!1,e+Ss(n)+1),i.isneg()&&!i.isZero()?"-"+r:r)};Nn.toInteger=Nn.toint=function(){var e=this,t=e.constructor;return aa(new t(e),Ss(e)+1,t.rounding)};Nn.toNumber=function(){return+this};Nn.toPower=Nn.pow=function(e){var t,r,n,i,s,o,l=this,c=l.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c(Zl);if(l=new c(l),!l.s){if(e.s<1)throw Error(Hc+"Infinity");return l}if(l.eq(Zl))return l;if(n=c.precision,e.eq(Zl))return aa(l,n);if(t=e.e,r=e.d.length-1,o=t>=r,s=l.s,o){if((r=d<0?-d:d)<=$H){for(i=new c(Zl),t=Math.ceil(n/ha+4),ka=!1;r%2&&(i=i.times(l),J7(i.d,t)),r=xg(r/2),r!==0;)l=l.times(l),J7(l.d,t);return ka=!0,e.s<0?new c(Zl).div(i):aa(i,n)}}else if(s<0)throw Error(Hc+"NaN");return s=s<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,ka=!1,i=e.times(F1(l,n+u)),ka=!0,i=zH(i),i.s=s,i};Nn.toPrecision=function(e,t){var r,n,i=this,s=i.constructor;return e===void 0?(r=Ss(i),n=B0(i,r<=s.toExpNeg||r>=s.toExpPos)):(od(e,1,gg),t===void 0?t=s.rounding:od(t,0,8),i=aa(new s(i),e,t),r=Ss(i),n=B0(i,e<=r||r<=s.toExpNeg,e)),n};Nn.toSignificantDigits=Nn.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(od(e,1,gg),t===void 0?t=n.rounding:od(t,0,8)),aa(new n(r),e,t)};Nn.toString=Nn.valueOf=Nn.val=Nn.toJSON=Nn[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Ss(e),r=e.constructor;return B0(e,t<=r.toExpNeg||t>=r.toExpPos)};function UH(e,t){var r,n,i,s,o,l,c,u,d=e.constructor,f=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),ka?aa(t,f):t;if(c=e.d,u=t.d,o=e.e,i=t.e,c=c.slice(),s=o-i,s){for(s<0?(n=c,s=-s,l=u.length):(n=u,i=o,l=c.length),o=Math.ceil(f/ha),l=o>l?o+1:l+1,s>l&&(s=l,n.length=1),n.reverse();s--;)n.push(0);n.reverse()}for(l=c.length,s=u.length,l-s<0&&(s=l,n=u,u=c,c=n),r=0;s;)r=(c[--s]=c[s]+u[s]+r)/Ws|0,c[s]%=Ws;for(r&&(c.unshift(r),++i),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=i,ka?aa(t,f):t}function od(e,t,r){if(e!==~~e||e<t||e>r)throw Error(f0+e)}function Zu(e){var t,r,n,i=e.length-1,s="",o=e[0];if(i>0){for(s+=o,t=1;t<i;t++)n=e[t]+"",r=ha-n.length,r&&(s+=Rf(r)),s+=n;o=e[t],n=o+"",r=ha-n.length,r&&(s+=Rf(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var zd=function(){function e(n,i){var s,o=0,l=n.length;for(n=n.slice();l--;)s=n[l]*i+o,n[l]=s%Ws|0,o=s/Ws|0;return o&&n.unshift(o),n}function t(n,i,s,o){var l,c;if(s!=o)c=s>o?1:-1;else for(l=c=0;l<s;l++)if(n[l]!=i[l]){c=n[l]>i[l]?1:-1;break}return c}function r(n,i,s){for(var o=0;s--;)n[s]-=o,o=n[s]<i[s]?1:0,n[s]=o*Ws+n[s]-i[s];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,s,o){var l,c,u,d,f,h,p,m,g,y,b,v,w,S,k,j,A,L,P=n.constructor,F=n.s==i.s?1:-1,E=n.d,T=i.d;if(!n.s)return new P(n);if(!i.s)throw Error(Hc+"Division by zero");for(c=n.e-i.e,A=T.length,k=E.length,p=new P(F),m=p.d=[],u=0;T[u]==(E[u]||0);)++u;if(T[u]>(E[u]||0)&&--c,s==null?v=s=P.precision:o?v=s+(Ss(n)-Ss(i))+1:v=s,v<0)return new P(0);if(v=v/ha+2|0,u=0,A==1)for(d=0,T=T[0],v++;(u<k||d)&&v--;u++)w=d*Ws+(E[u]||0),m[u]=w/T|0,d=w%T|0;else{for(d=Ws/(T[0]+1)|0,d>1&&(T=e(T,d),E=e(E,d),A=T.length,k=E.length),S=A,g=E.slice(0,A),y=g.length;y<A;)g[y++]=0;L=T.slice(),L.unshift(0),j=T[0],T[1]>=Ws/2&&++j;do d=0,l=t(T,g,A,y),l<0?(b=g[0],A!=y&&(b=b*Ws+(g[1]||0)),d=b/j|0,d>1?(d>=Ws&&(d=Ws-1),f=e(T,d),h=f.length,y=g.length,l=t(f,g,h,y),l==1&&(d--,r(f,A<h?L:T,h))):(d==0&&(l=d=1),f=T.slice()),h=f.length,h<y&&f.unshift(0),r(g,f,y),l==-1&&(y=g.length,l=t(T,g,A,y),l<1&&(d++,r(g,A<y?L:T,y))),y=g.length):l===0&&(d++,g=[0]),m[u++]=d,l&&g[0]?g[y++]=E[S]||0:(g=[E[S]],y=1);while((S++<k||g[0]!==void 0)&&v--)}return m[0]||m.shift(),p.e=c,aa(p,o?s+Ss(p)+1:s)}}();function zH(e,t){var r,n,i,s,o,l,c=0,u=0,d=e.constructor,f=d.precision;if(Ss(e)>16)throw Error(SE+Ss(e));if(!e.s)return new d(Zl);for(ka=!1,l=f,o=new d(.03125);e.abs().gte(.1);)e=e.times(o),u+=5;for(n=Math.log(zh(2,u))/Math.LN10*2+5|0,l+=n,r=i=s=new d(Zl),d.precision=l;;){if(i=aa(i.times(e),l),r=r.times(++c),o=s.plus(zd(i,r,l)),Zu(o.d).slice(0,l)===Zu(s.d).slice(0,l)){for(;u--;)s=aa(s.times(s),l);return d.precision=f,t==null?(ka=!0,aa(s,f)):s}s=o}}function Ss(e){for(var t=e.e*ha,r=e.d[0];r>=10;r/=10)t++;return t}function nj(e,t,r){if(t>e.LN10.sd())throw ka=!0,r&&(e.precision=r),Error(Hc+"LN10 precision limit exceeded");return aa(new e(e.LN10),t)}function Rf(e){for(var t="";e--;)t+="0";return t}function F1(e,t){var r,n,i,s,o,l,c,u,d,f=1,h=10,p=e,m=p.d,g=p.constructor,y=g.precision;if(p.s<1)throw Error(Hc+(p.s?"NaN":"-Infinity"));if(p.eq(Zl))return new g(0);if(t==null?(ka=!1,u=y):u=t,p.eq(10))return t==null&&(ka=!0),nj(g,u);if(u+=h,g.precision=u,r=Zu(m),n=r.charAt(0),s=Ss(p),Math.abs(s)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)p=p.times(e),r=Zu(p.d),n=r.charAt(0),f++;s=Ss(p),n>1?(p=new g("0."+r),s++):p=new g(n+"."+r.slice(1))}else return c=nj(g,u+2,y).times(s+""),p=F1(new g(n+"."+r.slice(1)),u-h).plus(c),g.precision=y,t==null?(ka=!0,aa(p,y)):p;for(l=o=p=zd(p.minus(Zl),p.plus(Zl),u),d=aa(p.times(p),u),i=3;;){if(o=aa(o.times(d),u),c=l.plus(zd(o,new g(i),u)),Zu(c.d).slice(0,u)===Zu(l.d).slice(0,u))return l=l.times(2),s!==0&&(l=l.plus(nj(g,u+2,y).times(s+""))),l=zd(l,new g(f),u),g.precision=y,t==null?(ka=!0,aa(l,y)):l;l=c,i+=2}}function Q7(e,t){var r,n,i;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(i=t.length;t.charCodeAt(i-1)===48;)--i;if(t=t.slice(n,i),t){if(i-=n,r=r-n-1,e.e=xg(r/ha),e.d=[],n=(r+1)%ha,r<0&&(n+=ha),n<i){for(n&&e.d.push(+t.slice(0,n)),i-=ha;n<i;)e.d.push(+t.slice(n,n+=ha));t=t.slice(n),n=ha-t.length}else n-=i;for(;n--;)t+="0";if(e.d.push(+t),ka&&(e.e>Rw||e.e<-Rw))throw Error(SE+r)}else e.s=0,e.e=0,e.d=[0];return e}function aa(e,t,r){var n,i,s,o,l,c,u,d,f=e.d;for(o=1,s=f[0];s>=10;s/=10)o++;if(n=t-o,n<0)n+=ha,i=t,u=f[d=0];else{if(d=Math.ceil((n+1)/ha),s=f.length,d>=s)return e;for(u=s=f[d],o=1;s>=10;s/=10)o++;n%=ha,i=n-ha+o}if(r!==void 0&&(s=zh(10,o-i-1),l=u/s%10|0,c=t<0||f[d+1]!==void 0||u%s,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?i>0?u/zh(10,o-i):0:f[d-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(s=Ss(e),f.length=1,t=t-s-1,f[0]=zh(10,(ha-t%ha)%ha),e.e=xg(-t/ha)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=d,s=1,d--):(f.length=d+1,s=zh(10,ha-n),f[d]=i>0?(u/zh(10,o-i)%zh(10,i)|0)*s:0),c)for(;;)if(d==0){(f[0]+=s)==Ws&&(f[0]=1,++e.e);break}else{if(f[d]+=s,f[d]!=Ws)break;f[d--]=0,s=1}for(n=f.length;f[--n]===0;)f.pop();if(ka&&(e.e>Rw||e.e<-Rw))throw Error(SE+Ss(e));return e}function WH(e,t){var r,n,i,s,o,l,c,u,d,f,h=e.constructor,p=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),ka?aa(t,p):t;if(c=e.d,f=t.d,n=t.e,u=e.e,c=c.slice(),o=u-n,o){for(d=o<0,d?(r=c,o=-o,l=f.length):(r=f,n=u,l=c.length),i=Math.max(Math.ceil(p/ha),l)+2,o>i&&(o=i,r.length=1),r.reverse(),i=o;i--;)r.push(0);r.reverse()}else{for(i=c.length,l=f.length,d=i<l,d&&(l=i),i=0;i<l;i++)if(c[i]!=f[i]){d=c[i]<f[i];break}o=0}for(d&&(r=c,c=f,f=r,t.s=-t.s),l=c.length,i=f.length-l;i>0;--i)c[l++]=0;for(i=f.length;i>o;){if(c[--i]<f[i]){for(s=i;s&&c[--s]===0;)c[s]=Ws-1;--c[s],c[i]+=Ws}c[i]-=f[i]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,ka?aa(t,p):t):new h(0)}function B0(e,t,r){var n,i=Ss(e),s=Zu(e.d),o=s.length;return t?(r&&(n=r-o)>0?s=s.charAt(0)+"."+s.slice(1)+Rf(n):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(i<0?"e":"e+")+i):i<0?(s="0."+Rf(-i-1)+s,r&&(n=r-o)>0&&(s+=Rf(n))):i>=o?(s+=Rf(i+1-o),r&&(n=r-i-1)>0&&(s=s+"."+Rf(n))):((n=i+1)<o&&(s=s.slice(0,n)+"."+s.slice(n)),r&&(n=r-o)>0&&(i+1===o&&(s+="."),s+=Rf(n))),e.s<0?"-"+s:s}function J7(e,t){if(e.length>t)return e.length=t,!0}function qH(e){var t,r,n;function i(s){var o=this;if(!(o instanceof i))return new i(s);if(o.constructor=i,s instanceof i){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(f0+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return Q7(o,s.toString())}else if(typeof s!="string")throw Error(f0+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,g5e.test(s))Q7(o,s);else throw Error(f0+s)}if(i.prototype=Nn,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=qH,i.config=i.set=x5e,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return i.config(e),i}function x5e(e){if(!e||typeof e!="object")throw Error(Hc+"Object expected");var t,r,n,i=["precision",1,gg,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<i.length;t+=3)if((n=e[r=i[t]])!==void 0)if(xg(n)===n&&n>=i[t+1]&&n<=i[t+2])this[r]=n;else throw Error(f0+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(f0+r+": "+n);return this}var _E=qH(m5e);Zl=new _E(1);const qi=_E;function HH(e){var t;return e===0?t=1:t=Math.floor(new qi(e).abs().log(10).toNumber())+1,t}function VH(e,t,r){for(var n=new qi(e),i=0,s=[];n.lt(t)&&i<1e5;)s.push(n.toNumber()),n=n.add(r),i++;return s}var GH=e=>{var[t,r]=e,[n,i]=[t,r];return t>r&&([n,i]=[r,t]),[n,i]},KH=(e,t,r)=>{if(e.lte(0))return new qi(0);var n=HH(e.toNumber()),i=new qi(10).pow(n),s=e.div(i),o=n!==1?.05:.1,l=new qi(Math.ceil(s.div(o).toNumber())).add(r).mul(o),c=l.mul(i);return t?new qi(c.toNumber()):new qi(Math.ceil(c.toNumber()))},y5e=(e,t,r)=>{var n=new qi(1),i=new qi(e);if(!i.isint()&&r){var s=Math.abs(e);s<1?(n=new qi(10).pow(HH(e)-1),i=new qi(Math.floor(i.div(n).toNumber())).mul(n)):s>1&&(i=new qi(Math.floor(e)))}else e===0?i=new qi(Math.floor((t-1)/2)):r||(i=new qi(Math.floor(e)));for(var o=Math.floor((t-1)/2),l=[],c=0;c<t;c++)l.push(i.add(new qi(c-o).mul(n)).toNumber());return l},YH=function(t,r,n,i){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new qi(0),tickMin:new qi(0),tickMax:new qi(0)};var o=KH(new qi(r).sub(t).div(n-1),i,s),l;t<=0&&r>=0?l=new qi(0):(l=new qi(t).add(r).div(2),l=l.sub(new qi(l).mod(o)));var c=Math.ceil(l.sub(t).div(o).toNumber()),u=Math.ceil(new qi(r).sub(l).div(o).toNumber()),d=c+u+1;return d>n?YH(t,r,n,i,s+1):(d<n&&(u=r>0?u+(n-d):u,c=r>0?c:c+(n-d)),{step:o,tickMin:l.sub(new qi(c).mul(o)),tickMax:l.add(new qi(u).mul(o))})},b5e=function(t){var[r,n]=t,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(i,2),[l,c]=GH([r,n]);if(l===-1/0||c===1/0){var u=c===1/0?[l,...Array(i-1).fill(1/0)]:[...Array(i-1).fill(-1/0),c];return r>n?u.reverse():u}if(l===c)return y5e(l,i,s);var{step:d,tickMin:f,tickMax:h}=YH(l,c,o,s,0),p=VH(f,h.add(new qi(.1).mul(d)),d);return r>n?p.reverse():p},v5e=function(t,r){var[n,i]=t,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[o,l]=GH([n,i]);if(o===-1/0||l===1/0)return[n,i];if(o===l)return[o];var c=Math.max(r,2),u=KH(new qi(l).sub(o).div(c-1),s,0),d=[...VH(new qi(o),new qi(l),u),l];return s===!1&&(d=d.map(f=>Math.round(f))),n>i?d.reverse():d},XH=e=>e.rootProps.maxBarSize,w5e=e=>e.rootProps.barGap,QH=e=>e.rootProps.barCategoryGap,S5e=e=>e.rootProps.barSize,ky=e=>e.rootProps.stackOffset,JH=e=>e.rootProps.reverseStackOrder,kE=e=>e.options.chartName,jE=e=>e.rootProps.syncId,ZH=e=>e.rootProps.syncMethod,AE=e=>e.options.eventEmitter,Oa={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},Rh={allowDecimals:!1,allowDataOverflow:!1,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"auto"},Iu={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!0,includeHidden:!1,radiusAxisId:0,reversed:!1,scale:"auto",tick:!0,tickCount:5,type:"auto"},b_=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t};function v_(e,t,r){if(r!=="auto")return r;if(e!=null)return ff(e,t)?"category":"number"}function Z7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Fw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z7(Object(r),!0).forEach(function(n){_5e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _5e(e,t,r){return(t=k5e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k5e(e){var t=j5e(e,"string");return typeof t=="symbol"?t:t+""}function j5e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eR={allowDataOverflow:Rh.allowDataOverflow,allowDecimals:Rh.allowDecimals,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Rh.angleAxisId,includeHidden:!1,name:void 0,reversed:Rh.reversed,scale:Rh.scale,tick:Rh.tick,tickCount:void 0,ticks:void 0,type:Rh.type,unit:void 0},tR={allowDataOverflow:Iu.allowDataOverflow,allowDecimals:Iu.allowDecimals,allowDuplicatedCategory:Iu.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Iu.radiusAxisId,includeHidden:Iu.includeHidden,name:void 0,reversed:Iu.reversed,scale:Iu.scale,tick:Iu.tick,tickCount:Iu.tickCount,ticks:void 0,type:Iu.type,unit:void 0},A5e=(e,t)=>{if(t!=null)return e.polarAxis.angleAxis[t]},NE=Qt([A5e,Rq],(e,t)=>{var r;if(e!=null)return e;var n=(r=v_(t,"angleAxis",eR.type))!==null&&r!==void 0?r:"category";return Fw(Fw({},eR),{},{type:n})}),N5e=(e,t)=>e.polarAxis.radiusAxis[t],CE=Qt([N5e,Rq],(e,t)=>{var r;if(e!=null)return e;var n=(r=v_(t,"radiusAxis",tR.type))!==null&&r!==void 0?r:"category";return Fw(Fw({},tR),{},{type:n})}),w_=e=>e.polarOptions,EE=Qt([hf,pf,Ls],Jq),eV=Qt([w_,EE],(e,t)=>{if(e!=null)return $o(e.innerRadius,t,0)}),tV=Qt([w_,EE],(e,t)=>{if(e!=null)return $o(e.outerRadius,t,t*.8)}),C5e=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},rV=Qt([w_],C5e);Qt([NE,rV],b_);var nV=Qt([EE,eV,tV],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});Qt([CE,nV],b_);var iV=Qt([Pi,w_,eV,tV,hf,pf],(e,t,r,n,i,s)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:o,cy:l,startAngle:c,endAngle:u}=t;return{cx:$o(o,i,i/2),cy:$o(l,s,s/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:u,clockWise:!1}}}),Fa=(e,t)=>t,jy=(e,t,r)=>r;function TE(e){return e==null?void 0:e.id}function aV(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:i,dataKey:s}=r,o=new Map;return e.forEach(l=>{var c,u=(c=l.data)!==null&&c!==void 0?c:n;if(!(u==null||u.length===0)){var d=TE(l);u.forEach((f,h)=>{var p=s==null||i?h:String(Ei(f,s,null)),m=Ei(f,l.dataKey,0),g;o.has(p)?g=o.get(p):g={},Object.assign(g,{[d]:m}),o.set(p,g)})}}),Array.from(o.values())}function S_(e){return"stackId"in e&&e.stackId!=null&&e.dataKey!=null}var __=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function k_(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function E5e(e,t){if(e.length===t.length){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return!1}var Qs=e=>{var t=Pi(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},yg=e=>e.tooltip.settings.axisId;function T5e(e){if(e in mx)return mx[e]();var t="scale".concat(hy(e));if(t in mx)return mx[t]()}function rR(e){var t=e.ticks,r=e.bandwidth,n=e.range(),i=[Math.min(...n),Math.max(...n)];return{domain:()=>e.domain(),range:function(s){function o(){return s.apply(this,arguments)}return o.toString=function(){return s.toString()},o}(()=>i),rangeMin:()=>i[0],rangeMax:()=>i[1],isInRange(s){var o=i[0],l=i[1];return o<=l?s>=o&&s<=l:s>=l&&s<=o},bandwidth:r?()=>r.call(e):void 0,ticks:t?s=>t.call(e,s):void 0,map:(s,o)=>{var l=e(s);if(l!=null){if(e.bandwidth&&o!==null&&o!==void 0&&o.position){var c=e.bandwidth();switch(o.position){case"middle":l+=c/2;break;case"end":l+=c;break}}return l}}}}function nR(e,t,r){if(typeof e=="function")return rR(e.copy().domain(t).range(r));if(e!=null){var n=T5e(e);if(n!=null)return n.domain(t).range(r),rR(n)}}var sV=(e,t)=>{if(t!=null)switch(e){case"linear":{if(!ef(t)){for(var r,n,i=0;i<t.length;i++){var s=t[i];pi(s)&&((r===void 0||s<r)&&(r=s),(n===void 0||s>n)&&(n=s))}return r!==void 0&&n!==void 0?[r,n]:void 0}return t}default:return t}};function iR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Bw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iR(Object(r),!0).forEach(function(n){P5e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function P5e(e,t,r){return(t=O5e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O5e(e){var t=M5e(e,"string");return typeof t=="symbol"?t:t+""}function M5e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var HA=[0,"auto"],Ds={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},oV=(e,t)=>e.cartesianAxis.xAxis[t],hd=(e,t)=>{var r=oV(e,t);return r??Ds},$s={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:HA,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:gy},lV=(e,t)=>e.cartesianAxis.yAxis[t],pd=(e,t)=>{var r=lV(e,t);return r??$s},Bd={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},PE=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??Bd},Ka=(e,t,r)=>{switch(t){case"xAxis":return hd(e,r);case"yAxis":return pd(e,r);case"zAxis":return PE(e,r);case"angleAxis":return NE(e,r);case"radiusAxis":return CE(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},L5e=(e,t,r)=>{switch(t){case"xAxis":return hd(e,r);case"yAxis":return pd(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},bg=(e,t,r)=>{switch(t){case"xAxis":return hd(e,r);case"yAxis":return pd(e,r);case"angleAxis":return NE(e,r);case"radiusAxis":return CE(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},cV=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function OE(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var Ay=e=>e.graphicalItems.cartesianItems,R5e=Qt([Fa,jy],OE),ME=(e,t,r)=>e.filter(r).filter(n=>(t==null?void 0:t.includeHidden)===!0?!0:!n.hide),Ny=Qt([Ay,Ka,R5e],ME,{memoizeOptions:{resultEqualityCheck:k_}}),uV=Qt([Ny],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(S_)),dV=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),F5e=Qt([Ny],dV),LE=e=>e.map(t=>t.data).filter(Boolean).flat(1),B5e=Qt([Ny],LE,{memoizeOptions:{resultEqualityCheck:k_}}),RE=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:i}=t;return e.length>0?e:r.slice(n,i+1)},FE=Qt([B5e,y_],RE),BE=(e,t,r)=>(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:Ei(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(i=>({value:Ei(i,n)}))):e.map(n=>({value:n})),j_=Qt([FE,Ka,Ny],BE);function fV(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function Zv(e){if(Wc(e)||e instanceof Date){var t=Number(e);if(pi(t))return t}}function aR(e){if(Array.isArray(e)){var t=[Zv(e[0]),Zv(e[1])];return ef(t)?t:void 0}var r=Zv(e);if(r!=null)return[r,r]}function tf(e){return e.map(Zv).filter(_l)}function I5e(e,t,r){return!r||typeof t!="number"||ad(t)?[]:r.length?tf(r.flatMap(n=>{var i=Ei(e,n.dataKey),s,o;if(Array.isArray(i)?[s,o]=i:s=o=i,!(!pi(s)||!pi(o)))return[t-s,t+o]})):[]}var Bs=e=>{var t=Qs(e),r=yg(e);return bg(e,t,r)},Cy=Qt([Bs],e=>e==null?void 0:e.dataKey),D5e=Qt([uV,y_,Bs],aV),hV=(e,t,r,n)=>{var i={},s=t.reduce((o,l)=>{if(l.stackId==null)return o;var c=o[l.stackId];return c==null&&(c=[]),c.push(l),o[l.stackId]=c,o},i);return Object.fromEntries(Object.entries(s).map(o=>{var[l,c]=o,u=n?[...c].reverse():c,d=u.map(TE);return[l,{stackedData:pve(e,d,r),graphicalItems:u}]}))},VA=Qt([D5e,uV,ky,JH],hV),pV=(e,t,r,n)=>{var{dataStartIndex:i,dataEndIndex:s}=t;if(n==null&&r!=="zAxis"){var o=bve(e,i,s);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},$5e=Qt([Ka],e=>e.allowDataOverflow),IE=e=>{var t;if(e==null||!("domain"in e))return HA;if(e.domain!=null)return e.domain;if("ticks"in e&&e.ticks!=null){if(e.type==="number"){var r=tf(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:HA},DE=Qt([Ka],IE),$E=Qt([DE,$5e],DH),U5e=Qt([VA,gf,Fa,$E],pV,{memoizeOptions:{resultEqualityCheck:__}}),A_=e=>e.errorBars,z5e=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>fV(r,n)),Iw=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r.filter(Boolean);if(i.length!==0){var s=i.flat(),o=Math.min(...s),l=Math.max(...s);return[o,l]}},UE=(e,t,r,n,i)=>{var s,o;if(r.length>0&&e.forEach(l=>{r.forEach(c=>{var u,d,f=(u=n[c.id])===null||u===void 0?void 0:u.filter(b=>fV(i,b)),h=Ei(l,(d=t.dataKey)!==null&&d!==void 0?d:c.dataKey),p=I5e(l,h,f);if(p.length>=2){var m=Math.min(...p),g=Math.max(...p);(s==null||m<s)&&(s=m),(o==null||g>o)&&(o=g)}var y=aR(h);y!=null&&(s=s==null?y[0]:Math.min(s,y[0]),o=o==null?y[1]:Math.max(o,y[1]))})}),(t==null?void 0:t.dataKey)!=null&&e.forEach(l=>{var c=aR(Ei(l,t.dataKey));c!=null&&(s=s==null?c[0]:Math.min(s,c[0]),o=o==null?c[1]:Math.max(o,c[1]))}),pi(s)&&pi(o))return[s,o]},W5e=Qt([FE,Ka,F5e,A_,Fa],UE,{memoizeOptions:{resultEqualityCheck:__}});function q5e(e){var{value:t}=e;if(Wc(t)||t instanceof Date)return t}var H5e=(e,t,r)=>{var n=e.map(q5e).filter(i=>i!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&fW(n))?aH(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},mV=e=>e.referenceElements.dots,vg=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),V5e=Qt([mV,Fa,jy],vg),gV=e=>e.referenceElements.areas,G5e=Qt([gV,Fa,jy],vg),xV=e=>e.referenceElements.lines,K5e=Qt([xV,Fa,jy],vg),yV=(e,t)=>{if(e!=null){var r=tf(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},Y5e=Qt(V5e,Fa,yV),bV=(e,t)=>{if(e!=null){var r=tf(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},X5e=Qt([G5e,Fa],bV);function Q5e(e){var t;if(e.x!=null)return tf([e.x]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.x);return r==null||r.length===0?[]:tf(r)}function J5e(e){var t;if(e.y!=null)return tf([e.y]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.y);return r==null||r.length===0?[]:tf(r)}var vV=(e,t)=>{if(e!=null){var r=e.flatMap(n=>t==="xAxis"?Q5e(n):J5e(n));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},Z5e=Qt([K5e,Fa],vV),eke=Qt(Y5e,Z5e,X5e,(e,t,r)=>Iw(e,r,t)),zE=(e,t,r,n,i,s,o,l)=>{if(r!=null)return r;var c=o==="vertical"&&l==="xAxis"||o==="horizontal"&&l==="yAxis",u=c?Iw(n,s,i):Iw(s,i);return p5e(t,u,e.allowDataOverflow)},tke=Qt([Ka,DE,$E,U5e,W5e,eke,Pi,Fa],zE,{memoizeOptions:{resultEqualityCheck:__}}),rke=[0,1],WE=(e,t,r,n,i,s,o)=>{if(!((e==null||r==null||r.length===0)&&o===void 0)){var{dataKey:l,type:c}=e,u=ff(t,s);if(u&&l==null){var d;return aH(0,(d=r==null?void 0:r.length)!==null&&d!==void 0?d:0)}return c==="category"?H5e(n,e,u):i==="expand"?rke:o}},qE=Qt([Ka,Pi,FE,j_,ky,Fa,tke],WE);function nke(e){return e in mx}var wV=(e,t,r)=>{if(e!=null){var{scale:n,type:i}=e;if(n==="auto")return i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!t)?"point":i==="category"?"band":"linear";if(typeof n=="string"){var s="scale".concat(hy(n));return nke(s)?s:"point"}}},Th=Qt([Ka,cV,kE],wV);function HE(e,t,r,n){if(!(r==null||n==null))return typeof e.scale=="function"?nR(e.scale,r,n):nR(t,r,n)}var VE=(e,t,r)=>{var n=IE(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&ef(e))return b5e(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&ef(e))return v5e(e,t.tickCount,t.allowDecimals)}},GE=Qt([qE,bg,Th],VE),KE=(e,t,r,n)=>{if(n!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&ef(t)&&Array.isArray(r)&&r.length>0){var i,s,o=t[0],l=(i=r[0])!==null&&i!==void 0?i:0,c=t[1],u=(s=r[r.length-1])!==null&&s!==void 0?s:0;return[Math.min(o,l),Math.max(c,u)]}return t},ike=Qt([Ka,qE,GE,Fa],KE),ake=Qt(j_,Ka,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(tf(e.map(f=>f.value))).sort((f,h)=>f-h),i=n[0],s=n[n.length-1];if(i==null||s==null)return 1/0;var o=s-i;if(o===0)return 1/0;for(var l=0;l<n.length-1;l++){var c=n[l],u=n[l+1];if(!(c==null||u==null)){var d=u-c;r=Math.min(r,d)}}return r/o}}),SV=Qt(ake,Pi,QH,Ls,(e,t,r,n,i)=>i,(e,t,r,n,i)=>{if(!pi(e))return 0;var s=t==="vertical"?n.height:n.width;if(i==="gap")return e*s/2;if(i==="no-gap"){var o=$o(r,e*s),l=e*s/2;return l-o-(l-o)/s*o}return 0}),ske=(e,t,r)=>{var n=hd(e,t);return n==null||typeof n.padding!="string"?0:SV(e,"xAxis",t,r,n.padding)},oke=(e,t,r)=>{var n=pd(e,t);return n==null||typeof n.padding!="string"?0:SV(e,"yAxis",t,r,n.padding)},lke=Qt(hd,ske,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:i}=e;return typeof i=="string"?{left:t,right:t}:{left:((r=i.left)!==null&&r!==void 0?r:0)+t,right:((n=i.right)!==null&&n!==void 0?n:0)+t}}),cke=Qt(pd,oke,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:i}=e;return typeof i=="string"?{top:t,bottom:t}:{top:((r=i.top)!==null&&r!==void 0?r:0)+t,bottom:((n=i.bottom)!==null&&n!==void 0?n:0)+t}}),uke=Qt([Ls,lke,a_,i_,(e,t,r)=>r],(e,t,r,n,i)=>{var{padding:s}=n;return i?[s.left,r.width-s.right]:[e.left+t.left,e.left+e.width-t.right]}),dke=Qt([Ls,Pi,cke,a_,i_,(e,t,r)=>r],(e,t,r,n,i,s)=>{var{padding:o}=i;return s?[n.height-o.bottom,o.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),Ey=(e,t,r,n)=>{var i;switch(t){case"xAxis":return uke(e,r,n);case"yAxis":return dke(e,r,n);case"zAxis":return(i=PE(e,r))===null||i===void 0?void 0:i.range;case"angleAxis":return rV(e);case"radiusAxis":return nV(e,r);default:return}},_V=Qt([Ka,Ey],b_),fke=Qt([Th,ike],sV),Km=Qt([Ka,Th,fke,_V],HE);Qt([Ny,A_,Fa],z5e);function kV(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var N_=(e,t)=>t,C_=(e,t,r)=>r,hke=Qt(r_,N_,C_,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(kV)),pke=Qt(n_,N_,C_,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(kV)),jV=(e,t)=>({width:e.width,height:t.height}),mke=(e,t)=>{var r=typeof t.width=="number"?t.width:gy;return{width:r,height:e.height}},AV=Qt(Ls,hd,jV),gke=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},xke=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},yke=Qt(pf,Ls,hke,N_,C_,(e,t,r,n,i)=>{var s={},o;return r.forEach(l=>{var c=jV(t,l);o==null&&(o=gke(t,n,e));var u=n==="top"&&!i||n==="bottom"&&i;s[l.id]=o-Number(u)*c.height,o+=(u?-1:1)*c.height}),s}),bke=Qt(hf,Ls,pke,N_,C_,(e,t,r,n,i)=>{var s={},o;return r.forEach(l=>{var c=mke(t,l);o==null&&(o=xke(t,n,e));var u=n==="left"&&!i||n==="right"&&i;s[l.id]=o-Number(u)*c.width,o+=(u?-1:1)*c.width}),s}),vke=(e,t)=>{var r=hd(e,t);if(r!=null)return yke(e,r.orientation,r.mirror)},wke=Qt([Ls,hd,vke,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var i=r==null?void 0:r[n];return i==null?{x:e.left,y:0}:{x:e.left,y:i}}}),Ske=(e,t)=>{var r=pd(e,t);if(r!=null)return bke(e,r.orientation,r.mirror)},_ke=Qt([Ls,pd,Ske,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var i=r==null?void 0:r[n];return i==null?{x:0,y:e.top}:{x:i,y:e.top}}}),NV=Qt(Ls,pd,(e,t)=>{var r=typeof t.width=="number"?t.width:gy;return{width:r,height:e.height}}),sR=(e,t,r)=>{switch(t){case"xAxis":return AV(e,r).width;case"yAxis":return NV(e,r).height;default:return}},CV=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:i,type:s,dataKey:o}=r,l=ff(e,n),c=t.map(u=>u.value);if(o&&l&&s==="category"&&i&&fW(c))return c}},YE=Qt([Pi,j_,Ka,Fa],CV),EV=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:i,scale:s}=r,o=ff(e,n);if(o&&(i==="number"||s!=="auto"))return t.map(l=>l.value)}},XE=Qt([Pi,j_,bg,Fa],EV),oR=Qt([Pi,L5e,Th,Km,YE,XE,Ey,GE,Fa],(e,t,r,n,i,s,o,l,c)=>{if(t!=null){var u=ff(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:s,duplicateDomain:i,isCategorical:u,niceTicks:l,range:o,realScaleType:r,scale:n}}}),kke=(e,t,r,n,i,s,o,l,c)=>{if(!(t==null||n==null)){var u=ff(e,c),{type:d,ticks:f,tickCount:h}=t,p=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,m=d==="category"&&n.bandwidth?n.bandwidth()/p:0;m=c==="angleAxis"&&s!=null&&s.length>=2?Ks(s[0]-s[1])*2*m:m;var g=f||i;return g?g.map((y,b)=>{var v=o?o.indexOf(y):y,w=n.map(v);return pi(w)?{index:b,coordinate:w+m,value:y,offset:m}:null}).filter(_l):u&&l?l.map((y,b)=>{var v=n.map(y);return pi(v)?{coordinate:v+m,value:y,index:b,offset:m}:null}).filter(_l):n.ticks?n.ticks(h).map((y,b)=>{var v=n.map(y);return pi(v)?{coordinate:v+m,value:y,index:b,offset:m}:null}).filter(_l):n.domain().map((y,b)=>{var v=n.map(y);return pi(v)?{coordinate:v+m,value:o?o[y]:y,index:b,offset:m}:null}).filter(_l)}},TV=Qt([Pi,bg,Th,Km,GE,Ey,YE,XE,Fa],kke),jke=(e,t,r,n,i,s,o)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var l=ff(e,o),{tickCount:c}=t,u=0;return u=o==="angleAxis"&&(n==null?void 0:n.length)>=2?Ks(n[0]-n[1])*2*u:u,l&&s?s.map((d,f)=>{var h=r.map(d);return pi(h)?{coordinate:h+u,value:d,index:f,offset:u}:null}).filter(_l):r.ticks?r.ticks(c).map((d,f)=>{var h=r.map(d);return pi(h)?{coordinate:h+u,value:d,index:f,offset:u}:null}).filter(_l):r.domain().map((d,f)=>{var h=r.map(d);return pi(h)?{coordinate:h+u,value:i?i[d]:d,index:f,offset:u}:null}).filter(_l)}},ld=Qt([Pi,bg,Km,Ey,YE,XE,Fa],jke),cd=Qt(Ka,Km,(e,t)=>{if(!(e==null||t==null))return Bw(Bw({},e),{},{scale:t})}),Ake=Qt([Ka,Th,qE,_V],HE),Nke=Qt((e,t,r)=>PE(e,r),Ake,(e,t)=>{if(!(e==null||t==null))return Bw(Bw({},e),{},{scale:t})}),Cke=Qt([Pi,r_,n_],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),PV=e=>e.options.defaultTooltipEventType,OV=e=>e.options.validateTooltipEventTypes;function MV(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function QE(e,t){var r=PV(e),n=OV(e);return MV(t,r,n)}function Eke(e){return yn(t=>QE(t,e))}var LV=(e,t)=>{var r,n=Number(t);if(!(ad(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},Tke=e=>e.tooltip.settings,$f={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},Pke={itemInteraction:{click:$f,hover:$f},axisInteraction:{click:$f,hover:$f},keyboardInteraction:$f,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},RV=Ll({name:"tooltip",initialState:Pke,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:Sa()},replaceTooltipEntrySettings:{reducer(e,t){var{prev:r,next:n}=t.payload,i=yu(e).tooltipItemPayloads.indexOf(r);i>-1&&(e.tooltipItemPayloads[i]=n)},prepare:Sa()},removeTooltipEntrySettings:{reducer(e,t){var r=yu(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},prepare:Sa()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate}}}),{addTooltipEntrySettings:Oke,replaceTooltipEntrySettings:Mke,removeTooltipEntrySettings:Lke,setTooltipSettingsState:Rke,setActiveMouseOverItemIndex:FV,mouseLeaveItem:Fke,mouseLeaveChart:BV,setActiveClickItemIndex:Bke,setMouseOverAxisIndex:IV,setMouseClickAxisIndex:Ike,setSyncInteraction:GA,setKeyboardInteraction:KA}=RV.actions,Dke=RV.reducer;function lR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function fv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lR(Object(r),!0).forEach(function(n){$ke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $ke(e,t,r){return(t=Uke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Uke(e){var t=zke(e,"string");return typeof t=="symbol"?t:t+""}function zke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wke(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function qke(e){return e.index!=null}var DV=(e,t,r,n)=>{if(t==null)return $f;var i=Wke(e,t,r);if(i==null)return $f;if(i.active)return i;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var s=e.settings.active===!0;if(qke(i)){if(s)return fv(fv({},i),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n,graphicalItemId:void 0};return fv(fv({},$f),{},{coordinate:i.coordinate})};function Hke(e){if(typeof e=="number")return Number.isFinite(e)?e:void 0;if(e instanceof Date){var t=e.valueOf();return Number.isFinite(t)?t:void 0}var r=Number(e);return Number.isFinite(r)?r:void 0}function Vke(e,t){var r=Hke(e),n=t[0],i=t[1];if(r===void 0)return!1;var s=Math.min(n,i),o=Math.max(n,i);return r>=s&&r<=o}function Gke(e,t,r){if(r==null||t==null)return!0;var n=Ei(e,t);return n==null||!ef(r)?!0:Vke(n,r)}var JE=(e,t,r,n)=>{var i=e==null?void 0:e.index;if(i==null)return null;var s=Number(i);if(!pi(s))return i;var o=0,l=1/0;t.length>0&&(l=t.length-1);var c=Math.max(o,Math.min(s,l)),u=t[c];return u==null||Gke(u,r,n)?String(c):null},$V=(e,t,r,n,i,s,o)=>{if(s!=null){var l=o[0],c=l==null?void 0:l.getPosition(s);if(c!=null)return c;var u=i==null?void 0:i[Number(s)];if(u)switch(r){case"horizontal":return{x:u.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:u.coordinate}}}},UV=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var i;if(r==="hover"?i=e.itemInteraction.hover.graphicalItemId:i=e.itemInteraction.click.graphicalItemId,i==null&&n!=null){var s=e.tooltipItemPayloads[0];return s!=null?[s]:[]}return e.tooltipItemPayloads.filter(o=>{var l;return((l=o.settings)===null||l===void 0?void 0:l.graphicalItemId)===i})},zV=e=>e.options.tooltipPayloadSearcher,wg=e=>e.tooltip;function cR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function uR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cR(Object(r),!0).forEach(function(n){Kke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Kke(e,t,r){return(t=Yke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yke(e){var t=Xke(e,"string");return typeof t=="symbol"?t:t+""}function Xke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qke(e,t){return e??t}var WV=(e,t,r,n,i,s,o)=>{if(!(t==null||s==null)){var{chartData:l,computedData:c,dataStartIndex:u,dataEndIndex:d}=r,f=[];return e.reduce((h,p)=>{var m,{dataDefinedOnItem:g,settings:y}=p,b=Qke(g,l),v=Array.isArray(b)?Sq(b,u,d):b,w=(m=y==null?void 0:y.dataKey)!==null&&m!==void 0?m:n,S=y==null?void 0:y.nameKey,k;if(n&&Array.isArray(v)&&!Array.isArray(v[0])&&o==="axis"?k=hW(v,n,i):k=s(v,t,c,S),Array.isArray(k))k.forEach(A=>{var L=uR(uR({},y),{},{name:A.name,unit:A.unit,color:void 0,fill:void 0});h.push(gL({tooltipEntrySettings:L,dataKey:A.dataKey,payload:A.payload,value:Ei(A.payload,A.dataKey),name:A.name}))});else{var j;h.push(gL({tooltipEntrySettings:y,dataKey:w,payload:k,value:Ei(k,w),name:(j=Ei(k,S))!==null&&j!==void 0?j:y==null?void 0:y.name}))}return h},f)}},ZE=Qt([Bs,cV,kE],wV),Jke=Qt([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),Zke=Qt([Qs,yg],OE),Sg=Qt([Jke,Bs,Zke],ME,{memoizeOptions:{resultEqualityCheck:k_}}),eje=Qt([Sg],e=>e.filter(S_)),tje=Qt([Sg],LE,{memoizeOptions:{resultEqualityCheck:k_}}),_g=Qt([tje,gf],RE),rje=Qt([eje,gf,Bs],aV),e6=Qt([_g,Bs,Sg],BE),qV=Qt([Bs],IE),nje=Qt([Bs],e=>e.allowDataOverflow),HV=Qt([qV,nje],DH),ije=Qt([Sg],e=>e.filter(S_)),aje=Qt([rje,ije,ky,JH],hV),sje=Qt([aje,gf,Qs,HV],pV),oje=Qt([Sg],dV),lje=Qt([_g,Bs,oje,A_,Qs],UE,{memoizeOptions:{resultEqualityCheck:__}}),cje=Qt([mV,Qs,yg],vg),uje=Qt([cje,Qs],yV),dje=Qt([gV,Qs,yg],vg),fje=Qt([dje,Qs],bV),hje=Qt([xV,Qs,yg],vg),pje=Qt([hje,Qs],vV),mje=Qt([uje,pje,fje],Iw),gje=Qt([Bs,qV,HV,sje,lje,mje,Pi,Qs],zE),Ty=Qt([Bs,Pi,_g,e6,ky,Qs,gje],WE),xje=Qt([Ty,Bs,ZE],VE),yje=Qt([Bs,Ty,xje,Qs],KE),VV=e=>{var t=Qs(e),r=yg(e),n=!1;return Ey(e,t,r,n)},GV=Qt([Bs,VV],b_),KV=Qt([Bs,ZE,yje,GV],HE),bje=Qt([Pi,e6,Bs,Qs],CV),vje=Qt([Pi,e6,Bs,Qs],EV),wje=(e,t,r,n,i,s,o,l)=>{if(t){var{type:c}=t,u=ff(e,l);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,f=c==="category"&&n.bandwidth?n.bandwidth()/d:0;return f=l==="angleAxis"&&i!=null&&(i==null?void 0:i.length)>=2?Ks(i[0]-i[1])*2*f:f,u&&o?o.map((h,p)=>{var m=n.map(h);return pi(m)?{coordinate:m+f,value:h,index:p,offset:f}:null}).filter(_l):n.domain().map((h,p)=>{var m=n.map(h);return pi(m)?{coordinate:m+f,value:s?s[h]:h,index:p,offset:f}:null}).filter(_l)}}},xf=Qt([Pi,Bs,ZE,KV,VV,bje,vje,Qs],wje),t6=Qt([PV,OV,Tke],(e,t,r)=>MV(r.shared,e,t)),YV=e=>e.tooltip.settings.trigger,r6=e=>e.tooltip.settings.defaultIndex,Py=Qt([wg,t6,YV,r6],DV),rf=Qt([Py,_g,Cy,Ty],JE),XV=Qt([xf,rf],LV),n6=Qt([Py],e=>{if(e)return e.dataKey}),Sje=Qt([Py],e=>{if(e)return e.graphicalItemId}),QV=Qt([wg,t6,YV,r6],UV),_je=Qt([hf,pf,Pi,Ls,xf,r6,QV],$V),kje=Qt([Py,_je],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),jje=Qt([Py],e=>{var t;return(t=e==null?void 0:e.active)!==null&&t!==void 0?t:!1}),Aje=Qt([QV,rf,gf,Cy,XV,zV,t6],WV),Nje=Qt([Aje],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function dR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function fR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dR(Object(r),!0).forEach(function(n){Cje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Cje(e,t,r){return(t=Eje(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Eje(e){var t=Tje(e,"string");return typeof t=="symbol"?t:t+""}function Tje(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pje=()=>yn(Bs),Oje=()=>{var e=Pje(),t=yn(xf),r=yn(KV);return zm(!e||!r?void 0:fR(fR({},e),{},{scale:r}),t)};function hR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ep(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hR(Object(r),!0).forEach(function(n){Mje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Mje(e,t,r){return(t=Lje(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lje(e){var t=Rje(e,"string");return typeof t=="symbol"?t:t+""}function Rje(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fje=(e,t,r,n)=>{var i=t.find(s=>s&&s.index===r);if(i){if(e==="horizontal")return{x:i.coordinate,y:n.chartY};if(e==="vertical")return{x:n.chartX,y:i.coordinate}}return{x:0,y:0}},Bje=(e,t,r,n)=>{var i=t.find(u=>u&&u.index===r);if(i){if(e==="centric"){var s=i.coordinate,{radius:o}=n;return Ep(Ep(Ep({},n),ws(n.cx,n.cy,o,s)),{},{angle:s,radius:o})}var l=i.coordinate,{angle:c}=n;return Ep(Ep(Ep({},n),ws(n.cx,n.cy,l,c)),{},{angle:c,radius:l})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function Ije(e,t){var{chartX:r,chartY:n}=e;return r>=t.left&&r<=t.left+t.width&&n>=t.top&&n<=t.top+t.height}var JV=(e,t,r,n,i)=>{var s,o=(s=t==null?void 0:t.length)!==null&&s!==void 0?s:0;if(o<=1||e==null)return 0;if(n==="angleAxis"&&i!=null&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var l=0;l<o;l++){var c,u,d,f,h,p=l>0?(c=r[l-1])===null||c===void 0?void 0:c.coordinate:(u=r[o-1])===null||u===void 0?void 0:u.coordinate,m=(d=r[l])===null||d===void 0?void 0:d.coordinate,g=l>=o-1?(f=r[0])===null||f===void 0?void 0:f.coordinate:(h=r[l+1])===null||h===void 0?void 0:h.coordinate,y=void 0;if(!(p==null||m==null||g==null))if(Ks(m-p)!==Ks(g-m)){var b=[];if(Ks(g-m)===Ks(i[1]-i[0])){y=g;var v=m+i[1]-i[0];b[0]=Math.min(v,(v+p)/2),b[1]=Math.max(v,(v+p)/2)}else{y=p;var w=g+i[1]-i[0];b[0]=Math.min(m,(w+m)/2),b[1]=Math.max(m,(w+m)/2)}var S=[Math.min(m,(y+m)/2),Math.max(m,(y+m)/2)];if(e>S[0]&&e<=S[1]||e>=b[0]&&e<=b[1]){var k;return(k=r[l])===null||k===void 0?void 0:k.index}}else{var j=Math.min(p,g),A=Math.max(p,g);if(e>(j+m)/2&&e<=(A+m)/2){var L;return(L=r[l])===null||L===void 0?void 0:L.index}}}else if(t)for(var P=0;P<o;P++){var F=t[P];if(F!=null){var E=t[P+1],T=t[P-1];if(P===0&&E!=null&&e<=(F.coordinate+E.coordinate)/2||P===o-1&&T!=null&&e>(F.coordinate+T.coordinate)/2||P>0&&P<o-1&&T!=null&&E!=null&&e>(F.coordinate+T.coordinate)/2&&e<=(F.coordinate+E.coordinate)/2)return F.index}}return-1},Dje=()=>yn(kE),i6=(e,t)=>t,ZV=(e,t,r)=>r,a6=(e,t,r,n)=>n,$je=Qt(xf,e=>VS(e,t=>t.coordinate)),s6=Qt([wg,i6,ZV,a6],DV),o6=Qt([s6,_g,Cy,Ty],JE),Uje=(e,t,r)=>{if(t!=null){var n=wg(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},eG=Qt([wg,i6,ZV,a6],UV),Dw=Qt([hf,pf,Pi,Ls,xf,a6,eG],$V),zje=Qt([s6,Dw],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),tG=Qt([xf,o6],LV),Wje=Qt([eG,o6,gf,Cy,tG,zV,i6],WV),qje=Qt([s6,o6],(e,t)=>({isActive:e.active&&t!=null,activeIndex:t})),Hje=(e,t,r,n,i,s,o)=>{if(!(!e||!r||!n||!i)&&Ije(e,o)){var l=vve(e,t),c=JV(l,s,i,r,n),u=Fje(t,i,c,e);return{activeIndex:String(c),activeCoordinate:u}}},Vje=(e,t,r,n,i,s,o)=>{if(!(!e||!n||!i||!s||!r)){var l=Mwe(e,r);if(l){var c=wve(l,t),u=JV(c,o,s,n,i),d=Bje(t,s,u,l);return{activeIndex:String(u),activeCoordinate:d}}}},Gje=(e,t,r,n,i,s,o,l)=>{if(!(!e||!t||!n||!i||!s))return t==="horizontal"||t==="vertical"?Hje(e,t,n,i,s,o,l):Vje(e,t,r,n,i,s,o)},Kje=Qt(e=>e.zIndex.zIndexMap,(e,t)=>t,(e,t,r)=>r,(e,t,r)=>{if(t!=null){var n=e[t];if(n!=null)return r?n.panoramaElement:n.element}}),Yje=Qt(e=>e.zIndex.zIndexMap,e=>{var t=Object.keys(e).map(n=>parseInt(n,10)).concat(Object.values(Oa)),r=Array.from(new Set(t));return r.sort((n,i)=>n-i)},{memoizeOptions:{resultEqualityCheck:E5e}});function pR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function mR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pR(Object(r),!0).forEach(function(n){Xje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Xje(e,t,r){return(t=Qje(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qje(e){var t=Jje(e,"string");return typeof t=="symbol"?t:t+""}function Jje(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zje={},e4e={zIndexMap:Object.values(Oa).reduce((e,t)=>mR(mR({},e),{},{[t]:{element:void 0,panoramaElement:void 0,consumers:0}}),Zje)},t4e=new Set(Object.values(Oa));function r4e(e){return t4e.has(e)}var rG=Ll({name:"zIndex",initialState:e4e,reducers:{registerZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]?e.zIndexMap[r].consumers+=1:e.zIndexMap[r]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:Sa()},unregisterZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(e.zIndexMap[r].consumers-=1,e.zIndexMap[r].consumers<=0&&!r4e(r)&&delete e.zIndexMap[r])},prepare:Sa()},registerZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r,element:n,isPanorama:i}=t.payload;e.zIndexMap[r]?i?e.zIndexMap[r].panoramaElement=n:e.zIndexMap[r].element=n:e.zIndexMap[r]={consumers:0,element:i?void 0:n,panoramaElement:i?n:void 0}},prepare:Sa()},unregisterZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(t.payload.isPanorama?e.zIndexMap[r].panoramaElement=void 0:e.zIndexMap[r].element=void 0)},prepare:Sa()}}}),{registerZIndexPortal:n4e,unregisterZIndexPortal:i4e,registerZIndexPortalElement:a4e,unregisterZIndexPortalElement:s4e}=rG.actions,o4e=rG.reducer;function yo(e){var{zIndex:t,children:r}=e,n=Kve(),i=n&&t!==void 0&&t!==0,s=Rs(),o=Ji();x.useLayoutEffect(()=>i?(o(n4e({zIndex:t})),()=>{o(i4e({zIndex:t}))}):ip,[o,t,i]);var l=yn(c=>Kje(c,t,s));return i?l?K1.createPortal(r,l):null:r}function YA(){return YA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},YA.apply(null,arguments)}function gR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function hv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gR(Object(r),!0).forEach(function(n){l4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function l4e(e,t,r){return(t=c4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c4e(e){var t=u4e(e,"string");return typeof t=="symbol"?t:t+""}function u4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function d4e(e){var{cursor:t,cursorComp:r,cursorProps:n}=e;return x.isValidElement(t)?x.cloneElement(t,n):x.createElement(r,n)}function f4e(e){var t,{coordinate:r,payload:n,index:i,offset:s,tooltipAxisBandSize:o,layout:l,cursor:c,tooltipEventType:u,chartName:d}=e,f=r,h=n,p=i;if(!c||!f||d!=="ScatterChart"&&u!=="axis")return null;var m,g,y;if(d==="ScatterChart")m=f,g=G2e,y=Oa.cursorLine;else if(d==="BarChart")m=K2e(l,f,s,o),g=Qq,y=Oa.cursorRectangle;else if(l==="radial"&&mW(f)){var{cx:b,cy:v,radius:w,startAngle:S,endAngle:k}=Zq(f);m={cx:b,cy:v,startAngle:S,endAngle:k,innerRadius:w,outerRadius:w},g=tH,y=Oa.cursorLine}else m={points:Bwe(l,f,s)},g=c_,y=Oa.cursorLine;var j=typeof c=="object"&&"className"in c?c.className:void 0,A=hv(hv(hv(hv({stroke:"#ccc",pointerEvents:"none"},s),m),xh(c)),{},{payload:h,payloadIndex:p,className:Si("recharts-tooltip-cursor",j)});return x.createElement(yo,{zIndex:(t=e.zIndex)!==null&&t!==void 0?t:y},x.createElement(d4e,{cursor:c,cursorComp:g,cursorProps:A}))}function h4e(e){var t=Oje(),r=Mq(),n=ap(),i=Dje();return t==null||r==null||n==null||i==null?null:x.createElement(f4e,YA({},e,{offset:r,layout:n,tooltipAxisBandSize:t,chartName:i}))}var nG=x.createContext(null),p4e=()=>x.useContext(nG),iG={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function s(c,u,d,f,h){if(typeof d!="function")throw new TypeError("The listener must be a function");var p=new i(d,f||c,h),m=r?r+u:u;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],p]:c._events[m].push(p):(c._events[m]=p,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)t.call(d,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=r?r+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,p=f.length,m=new Array(p);h<p;h++)m[h]=f[h].fn;return m},l.prototype.listenerCount=function(u){var d=r?r+u:u,f=this._events[d];return f?f.fn?1:f.length:0},l.prototype.emit=function(u,d,f,h,p,m){var g=r?r+u:u;if(!this._events[g])return!1;var y=this._events[g],b=arguments.length,v,w;if(y.fn){switch(y.once&&this.removeListener(u,y.fn,void 0,!0),b){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,d),!0;case 3:return y.fn.call(y.context,d,f),!0;case 4:return y.fn.call(y.context,d,f,h),!0;case 5:return y.fn.call(y.context,d,f,h,p),!0;case 6:return y.fn.call(y.context,d,f,h,p,m),!0}for(w=1,v=new Array(b-1);w<b;w++)v[w-1]=arguments[w];y.fn.apply(y.context,v)}else{var S=y.length,k;for(w=0;w<S;w++)switch(y[w].once&&this.removeListener(u,y[w].fn,void 0,!0),b){case 1:y[w].fn.call(y[w].context);break;case 2:y[w].fn.call(y[w].context,d);break;case 3:y[w].fn.call(y[w].context,d,f);break;case 4:y[w].fn.call(y[w].context,d,f,h);break;default:if(!v)for(k=1,v=new Array(b-1);k<b;k++)v[k-1]=arguments[k];y[w].fn.apply(y[w].context,v)}}return!0},l.prototype.on=function(u,d,f){return s(this,u,d,f,!1)},l.prototype.once=function(u,d,f){return s(this,u,d,f,!0)},l.prototype.removeListener=function(u,d,f,h){var p=r?r+u:u;if(!this._events[p])return this;if(!d)return o(this,p),this;var m=this._events[p];if(m.fn)m.fn===d&&(!h||m.once)&&(!f||m.context===f)&&o(this,p);else{for(var g=0,y=[],b=m.length;g<b;g++)(m[g].fn!==d||h&&!m[g].once||f&&m[g].context!==f)&&y.push(m[g]);y.length?this._events[p]=y.length===1?y[0]:y:o(this,p)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&o(this,d)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(iG);var m4e=iG.exports;const g4e=af(m4e);var B1=new g4e,XA="recharts.syncEvent.tooltip",xR="recharts.syncEvent.brush",E_=(e,t)=>{if(t&&Array.isArray(e)){var r=Number.parseInt(t,10);if(!ad(r))return e[r]}},x4e={chartName:"",tooltipPayloadSearcher:()=>{},eventEmitter:void 0,defaultTooltipEventType:"axis"},aG=Ll({name:"options",initialState:x4e,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),y4e=aG.reducer,{createEventEmitter:b4e}=aG.actions;function v4e(e){return e.tooltip.syncInteraction}var w4e={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},sG=Ll({name:"chartData",initialState:w4e,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:yR,setDataStartEndIndexes:S4e,setComputedData:CMe}=sG.actions,_4e=sG.reducer,k4e=["x","y"];function bR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Tp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bR(Object(r),!0).forEach(function(n){j4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function j4e(e,t,r){return(t=A4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A4e(e){var t=N4e(e,"string");return typeof t=="symbol"?t:t+""}function N4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function C4e(e,t){if(e==null)return{};var r,n,i=E4e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function E4e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function T4e(){var e=yn(jE),t=yn(AE),r=Ji(),n=yn(ZH),i=yn(xf),s=ap(),o=fg(),l=yn(c=>c.rootProps.className);x.useEffect(()=>{if(e==null)return ip;var c=(u,d,f)=>{if(t!==f&&e===u){if(n==="index"){var h;if(o&&d!==null&&d!==void 0&&(h=d.payload)!==null&&h!==void 0&&h.coordinate&&d.payload.sourceViewBox){var p=d.payload.coordinate,{x:m,y:g}=p,y=C4e(p,k4e),{x:b,y:v,width:w,height:S}=d.payload.sourceViewBox,k=Tp(Tp({},y),{},{x:o.x+(w?(m-b)/w:0)*o.width,y:o.y+(S?(g-v)/S:0)*o.height});r(Tp(Tp({},d),{},{payload:Tp(Tp({},d.payload),{},{coordinate:k})}))}else r(d);return}if(i!=null){var j;if(typeof n=="function"){var A={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},L=n(i,A);j=i[L]}else n==="value"&&(j=i.find(se=>String(se.value)===d.payload.label));var{coordinate:P}=d.payload;if(j==null||d.payload.active===!1||P==null||o==null){r(GA({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:F,y:E}=P,T=Math.min(F,o.x+o.width),B=Math.min(E,o.y+o.height),q={x:s==="horizontal"?j.coordinate:T,y:s==="horizontal"?B:j.coordinate},U=GA({active:d.payload.active,coordinate:q,dataKey:d.payload.dataKey,index:String(j.index),label:d.payload.label,sourceViewBox:d.payload.sourceViewBox,graphicalItemId:d.payload.graphicalItemId});r(U)}}};return B1.on(XA,c),()=>{B1.off(XA,c)}},[l,r,t,e,n,i,s,o])}function P4e(){var e=yn(jE),t=yn(AE),r=Ji();x.useEffect(()=>{if(e==null)return ip;var n=(i,s,o)=>{t!==o&&e===i&&r(S4e(s))};return B1.on(xR,n),()=>{B1.off(xR,n)}},[r,t,e])}function O4e(){var e=Ji();x.useEffect(()=>{e(b4e())},[e]),T4e(),P4e()}function M4e(e,t,r,n,i,s){var o=yn(p=>Uje(p,e,t)),l=yn(AE),c=yn(jE),u=yn(ZH),d=yn(v4e),f=d==null?void 0:d.active,h=fg();x.useEffect(()=>{if(!f&&c!=null&&l!=null){var p=GA({active:s,coordinate:r,dataKey:o,index:i,label:typeof n=="number"?String(n):n,sourceViewBox:h,graphicalItemId:void 0});B1.emit(XA,c,p,l)}},[f,r,o,i,n,l,c,u,s,h])}function vR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function wR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vR(Object(r),!0).forEach(function(n){L4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function L4e(e,t,r){return(t=R4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R4e(e){var t=F4e(e,"string");return typeof t=="symbol"?t:t+""}function F4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function B4e(e){return e.dataKey}function I4e(e,t){return x.isValidElement(e)?x.cloneElement(e,t):typeof e=="function"?x.createElement(e,t):x.createElement(A2e,t)}var SR=[],D4e={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Oy(e){var t,r,n=Aa(e,D4e),{active:i,allowEscapeViewBox:s,animationDuration:o,animationEasing:l,content:c,filterNull:u,isAnimationActive:d,offset:f,payloadUniqBy:h,position:p,reverseDirection:m,useTranslate3d:g,wrapperStyle:y,cursor:b,shared:v,trigger:w,defaultIndex:S,portal:k,axisId:j}=n,A=Ji(),L=typeof S=="number"?String(S):S;x.useEffect(()=>{A(Rke({shared:v,trigger:w,axisId:j,active:i,defaultIndex:L}))},[A,v,w,j,i,L]);var P=fg(),F=Vq(),E=Eke(v),{activeIndex:T,isActive:B}=(t=yn(V=>qje(V,E,w,L)))!==null&&t!==void 0?t:{},q=yn(V=>Wje(V,E,w,L)),U=yn(V=>tG(V,E,w,L)),se=yn(V=>zje(V,E,w,L)),de=q,z=p4e(),G=(r=i??B)!==null&&r!==void 0?r:!1,[ie,Y]=VW([de,G]),C=E==="axis"?U:void 0;M4e(E,w,se,C,T,G);var K=k??z;if(K==null||P==null||E==null)return null;var H=de??SR;G||(H=SR),u&&H.length&&(H=LW(H.filter(V=>V.value!=null&&(V.hide!==!0||n.includeHidden)),h,B4e));var R=H.length>0,J=x.createElement(M2e,{allowEscapeViewBox:s,animationDuration:o,animationEasing:l,isAnimationActive:d,active:G,coordinate:se,hasPayload:R,offset:f,position:p,reverseDirection:m,useTranslate3d:g,viewBox:P,wrapperStyle:y,lastBoundingBox:ie,innerRef:Y,hasPortalFromProps:!!k},I4e(c,wR(wR({},n),{},{payload:H,label:C,active:G,activeIndex:T,coordinate:se,accessibilityLayer:F})));return x.createElement(x.Fragment,null,K1.createPortal(J,K),G&&x.createElement(h4e,{cursor:b,tooltipEventType:E,coordinate:se,payload:H,index:T}))}var lp=e=>null;lp.displayName="Cell";function $4e(e,t,r){return(t=U4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U4e(e){var t=z4e(e,"string");return typeof t=="symbol"?t:t+""}function z4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class W4e{constructor(t){$4e(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;n!=null&&this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function _R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function q4e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_R(Object(r),!0).forEach(function(n){H4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_R(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function H4e(e,t,r){return(t=V4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function V4e(e){var t=G4e(e,"string");return typeof t=="symbol"?t:t+""}function G4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var K4e={cacheSize:2e3,enableCache:!0},oG=q4e({},K4e),kR=new W4e(oG.cacheSize),Y4e={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},jR="recharts_measurement_span";function X4e(e,t){var r=t.fontSize||"",n=t.fontFamily||"",i=t.fontWeight||"",s=t.fontStyle||"",o=t.letterSpacing||"",l=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(i,"|").concat(s,"|").concat(o,"|").concat(l)}var AR=(e,t)=>{try{var r=document.getElementById(jR);r||(r=document.createElement("span"),r.setAttribute("id",jR),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,Y4e,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Ix=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||u_.isSsr)return{width:0,height:0};if(!oG.enableCache)return AR(t,r);var n=X4e(t,r),i=kR.get(n);if(i)return i;var s=AR(t,r);return kR.set(n,s),s},lG;function Q4e(e,t,r){return(t=J4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J4e(e){var t=Z4e(e,"string");return typeof t=="symbol"?t:t+""}function Z4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NR=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,CR=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,eAe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,tAe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,rAe={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},nAe=["cm","mm","pt","pc","in","Q","px"];function iAe(e){return nAe.includes(e)}var nm="NaN";function aAe(e,t){return e*rAe[t]}class uo{static parse(t){var r,[,n,i]=(r=tAe.exec(t))!==null&&r!==void 0?r:[];return n==null?uo.NaN:new uo(parseFloat(n),i??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,ad(t)&&(this.unit=""),r!==""&&!eAe.test(r)&&(this.num=NaN,this.unit=""),iAe(r)&&(this.num=aAe(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new uo(NaN,""):new uo(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new uo(NaN,""):new uo(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new uo(NaN,""):new uo(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new uo(NaN,""):new uo(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return ad(this.num)}}lG=uo;Q4e(uo,"NaN",new lG(NaN,""));function cG(e){if(e==null||e.includes(nm))return nm;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,i,s]=(r=NR.exec(t))!==null&&r!==void 0?r:[],o=uo.parse(n??""),l=uo.parse(s??""),c=i==="*"?o.multiply(l):o.divide(l);if(c.isNaN())return nm;t=t.replace(NR,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var u,[,d,f,h]=(u=CR.exec(t))!==null&&u!==void 0?u:[],p=uo.parse(d??""),m=uo.parse(h??""),g=f==="+"?p.add(m):p.subtract(m);if(g.isNaN())return nm;t=t.replace(CR,g.toString())}return t}var ER=/\(([^()]*)\)/;function sAe(e){for(var t=e,r;(r=ER.exec(t))!=null;){var[,n]=r;t=t.replace(ER,cG(n))}return t}function oAe(e){var t=e.replace(/\s+/g,"");return t=sAe(t),t=cG(t),t}function lAe(e){try{return oAe(e)}catch{return nm}}function ij(e){var t=lAe(e.slice(5,-1));return t===nm?"":t}var cAe=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],uAe=["dx","dy","angle","className","breakAll"];function QA(){return QA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},QA.apply(null,arguments)}function TR(e,t){if(e==null)return{};var r,n,i=dAe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function dAe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var uG=/[ \f\n\r\t\v\u2028\u2029]+/,dG=e=>{var{children:t,breakAll:r,style:n}=e;try{var i=[];Xi(t)||(r?i=t.toString().split(""):i=t.toString().split(uG));var s=i.map(l=>({word:l,width:Ix(l,n).width})),o=r?0:Ix("",n).width;return{wordsWithComputedWidth:s,spaceWidth:o}}catch{return null}};function fAe(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var fG=(e,t,r,n)=>e.reduce((i,s)=>{var{word:o,width:l}=s,c=i[i.length-1];if(c&&l!=null&&(t==null||n||c.width+l+r<Number(t)))c.words.push(o),c.width+=l+r;else{var u={words:[o],width:l};i.push(u)}return i},[]),hG=e=>e.reduce((t,r)=>t.width>r.width?t:r),hAe="",PR=(e,t,r,n,i,s,o,l)=>{var c=e.slice(0,t),u=dG({breakAll:r,style:n,children:c+hAe});if(!u)return[!1,[]];var d=fG(u.wordsWithComputedWidth,s,o,l),f=d.length>i||hG(d).width>Number(s);return[f,d]},pAe=(e,t,r,n,i)=>{var{maxLines:s,children:o,style:l,breakAll:c}=e,u=An(s),d=String(o),f=fG(t,n,r,i);if(!u||i)return f;var h=f.length>s||hG(f).width>Number(n);if(!h)return f;for(var p=0,m=d.length-1,g=0,y;p<=m&&g<=d.length-1;){var b=Math.floor((p+m)/2),v=b-1,[w,S]=PR(d,v,c,l,s,n,r,i),[k]=PR(d,b,c,l,s,n,r,i);if(!w&&!k&&(p=b+1),w&&k&&(m=b-1),!w&&k){y=S;break}g++}return y||f},OR=e=>{var t=Xi(e)?[]:e.toString().split(uG);return[{words:t,width:void 0}]},mAe=e=>{var{width:t,scaleToFit:r,children:n,style:i,breakAll:s,maxLines:o}=e;if((t||r)&&!u_.isSsr){var l,c,u=dG({breakAll:s,children:n,style:i});if(u){var{wordsWithComputedWidth:d,spaceWidth:f}=u;l=d,c=f}else return OR(n);return pAe({breakAll:s,children:n,maxLines:o,style:i},l,c,t,!!r)}return OR(n)},pG="#808080",gAe={angle:0,breakAll:!1,capHeight:"0.71em",fill:pG,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},T_=x.forwardRef((e,t)=>{var r=Aa(e,gAe),{x:n,y:i,lineHeight:s,capHeight:o,fill:l,scaleToFit:c,textAnchor:u,verticalAnchor:d}=r,f=TR(r,cAe),h=x.useMemo(()=>mAe({breakAll:f.breakAll,children:f.children,maxLines:f.maxLines,scaleToFit:c,style:f.style,width:f.width}),[f.breakAll,f.children,f.maxLines,c,f.style,f.width]),{dx:p,dy:m,angle:g,className:y,breakAll:b}=f,v=TR(f,uAe);if(!Wc(n)||!Wc(i)||h.length===0)return null;var w=Number(n)+(An(p)?p:0),S=Number(i)+(An(m)?m:0);if(!pi(w)||!pi(S))return null;var k;switch(d){case"start":k=ij("calc(".concat(o,")"));break;case"middle":k=ij("calc(".concat((h.length-1)/2," * -").concat(s," + (").concat(o," / 2))"));break;default:k=ij("calc(".concat(h.length-1," * -").concat(s,")"));break}var j=[],A=h[0];if(c&&A!=null){var L=A.width,{width:P}=f;j.push("scale(".concat(An(P)&&An(L)?P/L:1,")"))}return g&&j.push("rotate(".concat(g,", ").concat(w,", ").concat(S,")")),j.length&&(v.transform=j.join(" ")),x.createElement("text",QA({},Wo(v),{ref:t,x:w,y:S,className:Si("recharts-text",y),textAnchor:u,fill:l.includes("url")?pG:l}),h.map((F,E)=>{var T=F.words.join(b?"":" ");return x.createElement("tspan",{x:w,dy:E===0?k:s,key:"".concat(T,"-").concat(E)},T)}))});T_.displayName="Text";function MR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Du(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?MR(Object(r),!0).forEach(function(n){xAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):MR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xAe(e,t,r){return(t=yAe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yAe(e){var t=bAe(e,"string");return typeof t=="symbol"?t:t+""}function bAe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vAe=e=>{var{viewBox:t,position:r,offset:n=0,parentViewBox:i}=e,{x:s,y:o,height:l,upperWidth:c,lowerWidth:u}=GC(t),d=s,f=s+(c-u)/2,h=(d+f)/2,p=(c+u)/2,m=d+c/2,g=l>=0?1:-1,y=g*n,b=g>0?"end":"start",v=g>0?"start":"end",w=c>=0?1:-1,S=w*n,k=w>0?"end":"start",j=w>0?"start":"end",A=i;if(r==="top"){var L={x:d+c/2,y:o-y,horizontalAnchor:"middle",verticalAnchor:b};return A&&(L.height=Math.max(o-A.y,0),L.width=c),L}if(r==="bottom"){var P={x:f+u/2,y:o+l+y,horizontalAnchor:"middle",verticalAnchor:v};return A&&(P.height=Math.max(A.y+A.height-(o+l),0),P.width=u),P}if(r==="left"){var F={x:h-S,y:o+l/2,horizontalAnchor:k,verticalAnchor:"middle"};return A&&(F.width=Math.max(F.x-A.x,0),F.height=l),F}if(r==="right"){var E={x:h+p+S,y:o+l/2,horizontalAnchor:j,verticalAnchor:"middle"};return A&&(E.width=Math.max(A.x+A.width-E.x,0),E.height=l),E}var T=A?{width:p,height:l}:{};return r==="insideLeft"?Du({x:h+S,y:o+l/2,horizontalAnchor:j,verticalAnchor:"middle"},T):r==="insideRight"?Du({x:h+p-S,y:o+l/2,horizontalAnchor:k,verticalAnchor:"middle"},T):r==="insideTop"?Du({x:d+c/2,y:o+y,horizontalAnchor:"middle",verticalAnchor:v},T):r==="insideBottom"?Du({x:f+u/2,y:o+l-y,horizontalAnchor:"middle",verticalAnchor:b},T):r==="insideTopLeft"?Du({x:d+S,y:o+y,horizontalAnchor:j,verticalAnchor:v},T):r==="insideTopRight"?Du({x:d+c-S,y:o+y,horizontalAnchor:k,verticalAnchor:v},T):r==="insideBottomLeft"?Du({x:f+S,y:o+l-y,horizontalAnchor:j,verticalAnchor:b},T):r==="insideBottomRight"?Du({x:f+u-S,y:o+l-y,horizontalAnchor:k,verticalAnchor:b},T):r&&typeof r=="object"&&(An(r.x)||M0(r.x))&&(An(r.y)||M0(r.y))?Du({x:s+$o(r.x,p),y:o+$o(r.y,l),horizontalAnchor:"end",verticalAnchor:"end"},T):Du({x:m,y:o+l/2,horizontalAnchor:"middle",verticalAnchor:"middle"},T)},wAe=["labelRef"],SAe=["content"];function LR(e,t){if(e==null)return{};var r,n,i=_Ae(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function _Ae(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function RR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function gx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?RR(Object(r),!0).forEach(function(n){kAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kAe(e,t,r){return(t=jAe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jAe(e){var t=AAe(e,"string");return typeof t=="symbol"?t:t+""}function AAe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pd(){return Pd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pd.apply(null,arguments)}var mG=x.createContext(null),gG=e=>{var{x:t,y:r,upperWidth:n,lowerWidth:i,width:s,height:o,children:l}=e,c=x.useMemo(()=>({x:t,y:r,upperWidth:n,lowerWidth:i,width:s,height:o}),[t,r,n,i,s,o]);return x.createElement(mG.Provider,{value:c},l)},xG=()=>{var e=x.useContext(mG),t=fg();return e||(t?GC(t):void 0)},NAe=x.createContext(null),CAe=()=>{var e=x.useContext(NAe),t=yn(iV);return e||t},EAe=e=>{var{value:t,formatter:r}=e,n=Xi(e.children)?t:e.children;return typeof r=="function"?r(n):n},l6=e=>e!=null&&typeof e=="function",TAe=(e,t)=>{var r=Ks(t-e),n=Math.min(Math.abs(t-e),360);return r*n},PAe=(e,t,r,n,i)=>{var{offset:s,className:o}=e,{cx:l,cy:c,innerRadius:u,outerRadius:d,startAngle:f,endAngle:h,clockWise:p}=i,m=(u+d)/2,g=TAe(f,h),y=g>=0?1:-1,b,v;switch(t){case"insideStart":b=f+y*s,v=p;break;case"insideEnd":b=h-y*s,v=!p;break;case"end":b=h+y*s,v=p;break;default:throw new Error("Unsupported position ".concat(t))}v=g<=0?v:!v;var w=ws(l,c,m,b),S=ws(l,c,m,b+(v?1:-1)*359),k="M".concat(w.x,",").concat(w.y,`
    A`).concat(m,",").concat(m,",0,1,").concat(v?0:1,`,
    `).concat(S.x,",").concat(S.y),j=Xi(e.id)?k1("recharts-radial-line-"):e.id;return x.createElement("text",Pd({},n,{dominantBaseline:"central",className:Si("recharts-radial-bar-label",o)}),x.createElement("defs",null,x.createElement("path",{id:j,d:k})),x.createElement("textPath",{xlinkHref:"#".concat(j)},r))},OAe=(e,t,r)=>{var{cx:n,cy:i,innerRadius:s,outerRadius:o,startAngle:l,endAngle:c}=e,u=(l+c)/2;if(r==="outside"){var{x:d,y:f}=ws(n,i,o+t,u);return{x:d,y:f,textAnchor:d>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"end"};var h=(s+o)/2,{x:p,y:m}=ws(n,i,h,u);return{x:p,y:m,textAnchor:"middle",verticalAnchor:"middle"}},e2=e=>e!=null&&"cx"in e&&An(e.cx),MAe={angle:0,offset:5,zIndex:Oa.label,position:"middle",textBreakAll:!1};function LAe(e){if(!e2(e))return e;var{cx:t,cy:r,outerRadius:n}=e,i=n*2;return{x:t-n,y:r-n,width:i,upperWidth:i,lowerWidth:i,height:i}}function Ff(e){var t=Aa(e,MAe),{viewBox:r,parentViewBox:n,position:i,value:s,children:o,content:l,className:c="",textBreakAll:u,labelRef:d}=t,f=CAe(),h=xG(),p=i==="center"?h:f??h,m,g,y;r==null?m=p:e2(r)?m=r:m=GC(r);var b=LAe(m);if(!m||Xi(s)&&Xi(o)&&!x.isValidElement(l)&&typeof l!="function")return null;var v=gx(gx({},t),{},{viewBox:m});if(x.isValidElement(l)){var{labelRef:w}=v,S=LR(v,wAe);return x.cloneElement(l,S)}if(typeof l=="function"){var{content:k}=v,j=LR(v,SAe);if(g=x.createElement(l,j),x.isValidElement(g))return g}else g=EAe(t);var A=Wo(t);if(e2(m)){if(i==="insideStart"||i==="insideEnd"||i==="end")return PAe(t,i,g,A,m);y=OAe(m,t.offset,t.position)}else{if(!b)return null;var L=vAe({viewBox:b,position:i,offset:t.offset,parentViewBox:e2(n)?void 0:n});y=gx(gx({x:L.x,y:L.y,textAnchor:L.horizontalAnchor,verticalAnchor:L.verticalAnchor},L.width!==void 0?{width:L.width}:{}),L.height!==void 0?{height:L.height}:{})}return x.createElement(yo,{zIndex:t.zIndex},x.createElement(T_,Pd({ref:d,className:Si("recharts-label",c)},A,y,{textAnchor:fAe(A.textAnchor)?A.textAnchor:y.textAnchor,breakAll:u}),g))}Ff.displayName="Label";var RAe=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?x.createElement(Ff,Pd({key:"label-implicit"},n)):Wc(e)?x.createElement(Ff,Pd({key:"label-implicit",value:e},n)):x.isValidElement(e)?e.type===Ff?x.cloneElement(e,gx({key:"label-implicit"},n)):x.createElement(Ff,Pd({key:"label-implicit",content:e},n)):l6(e)?x.createElement(Ff,Pd({key:"label-implicit",content:e},n)):e&&typeof e=="object"?x.createElement(Ff,Pd({},e,{key:"label-implicit"},n)):null};function yG(e){var{label:t,labelRef:r}=e,n=xG();return RAe(t,n,r)||null}var bG={},vG={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(vG);var wG={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(wG);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=vG,r=wG,n=WS;function i(s){if(n.isArrayLike(s))return t.last(r.toArray(s))}e.last=i})(bG);var FAe=bG.last;const BAe=af(FAe);var IAe=["valueAccessor"],DAe=["dataKey","clockWise","id","textBreakAll","zIndex"];function $w(){return $w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$w.apply(null,arguments)}function FR(e,t){if(e==null)return{};var r,n,i=$Ae(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function $Ae(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var UAe=e=>Array.isArray(e.value)?BAe(e.value):e.value,SG=x.createContext(void 0),c6=SG.Provider,_G=x.createContext(void 0),zAe=_G.Provider;function WAe(){return x.useContext(SG)}function qAe(){return x.useContext(_G)}function t2(e){var{valueAccessor:t=UAe}=e,r=FR(e,IAe),{dataKey:n,clockWise:i,id:s,textBreakAll:o,zIndex:l}=r,c=FR(r,DAe),u=WAe(),d=qAe(),f=u||d;return!f||!f.length?null:x.createElement(yo,{zIndex:l??Oa.label},x.createElement(ja,{className:"recharts-label-list"},f.map((h,p)=>{var m,g=Xi(n)?t(h,p):Ei(h.payload,n),y=Xi(s)?{}:{id:"".concat(s,"-").concat(p)};return x.createElement(Ff,$w({key:"label-".concat(p)},Wo(h),c,y,{fill:(m=r.fill)!==null&&m!==void 0?m:h.fill,parentViewBox:h.parentViewBox,value:g,textBreakAll:o,viewBox:h.viewBox,index:p,zIndex:0}))})))}t2.displayName="LabelList";function P_(e){var{label:t}=e;return t?t===!0?x.createElement(t2,{key:"labelList-implicit"}):x.isValidElement(t)||l6(t)?x.createElement(t2,{key:"labelList-implicit",content:t}):typeof t=="object"?x.createElement(t2,$w({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function JA(){return JA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},JA.apply(null,arguments)}var kG=e=>{var{cx:t,cy:r,r:n,className:i}=e,s=Si("recharts-dot",i);return An(t)&&An(r)&&An(n)?x.createElement("circle",JA({},ol(e),AC(e),{className:s,cx:t,cy:r,r:n})):null},jG=e=>e.graphicalItems.polarItems,HAe=Qt([Fa,jy],OE),O_=Qt([jG,Ka,HAe],ME),VAe=Qt([O_],LE),M_=Qt([VAe,x_],RE),GAe=Qt([M_,Ka,O_],BE);Qt([M_,Ka,O_],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(i=>{var s,o=Ei(n,(s=t.dataKey)!==null&&s!==void 0?s:i.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:Ei(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]})));var BR=()=>{},KAe=Qt([M_,Ka,O_,A_,Fa],UE),YAe=Qt([Ka,DE,$E,BR,KAe,BR,Pi,Fa],zE),AG=Qt([Ka,Pi,M_,GAe,ky,Fa,YAe],WE),XAe=Qt([AG,bg,Th],VE),QAe=Qt([Ka,AG,XAe,Fa],KE);Qt([Th,QAe],sV);var JAe={radiusAxis:{},angleAxis:{}},NG=Ll({name:"polarAxis",initialState:JAe,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:EMe,removeRadiusAxis:TMe,addAngleAxis:PMe,removeAngleAxis:OMe}=NG.actions,ZAe=NG.reducer;function CG(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}function IR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function DR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IR(Object(r),!0).forEach(function(n){eNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eNe(e,t,r){return(t=tNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tNe(e){var t=rNe(e,"string");return typeof t=="symbol"?t:t+""}function rNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nNe=(e,t)=>t,u6=Qt([jG,nNe],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),iNe=[],d6=(e,t,r)=>(r==null?void 0:r.length)===0?iNe:r,EG=Qt([x_,u6,d6],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var i;if((t==null?void 0:t.data)!=null&&t.data.length>0?i=t.data:i=n,(!i||!i.length)&&r!=null&&(i=r.map(s=>DR(DR({},t.presentationProps),s.props))),i!=null)return i}}),aNe=Qt([EG,u6,d6],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,i)=>{var s,o=Ei(n,t.nameKey,t.name),l;return r!=null&&(s=r[i])!==null&&s!==void 0&&(s=s.props)!==null&&s!==void 0&&s.fill?l=r[i].props.fill:typeof n=="object"&&n!=null&&"fill"in n?l=n.fill:l=t.fill,{value:Nh(o,t.dataKey),color:l,payload:n,type:t.legendType}})}),sNe=Qt([EG,u6,d6,Ls],(e,t,r,n)=>{if(!(t==null||e==null))return l3e({offset:n,pieSettings:t,displayedData:e,cells:r})}),TG={exports:{}},Ki={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Js=typeof Symbol=="function"&&Symbol.for,f6=Js?Symbol.for("react.element"):60103,h6=Js?Symbol.for("react.portal"):60106,L_=Js?Symbol.for("react.fragment"):60107,R_=Js?Symbol.for("react.strict_mode"):60108,F_=Js?Symbol.for("react.profiler"):60114,B_=Js?Symbol.for("react.provider"):60109,I_=Js?Symbol.for("react.context"):60110,p6=Js?Symbol.for("react.async_mode"):60111,D_=Js?Symbol.for("react.concurrent_mode"):60111,$_=Js?Symbol.for("react.forward_ref"):60112,U_=Js?Symbol.for("react.suspense"):60113,oNe=Js?Symbol.for("react.suspense_list"):60120,z_=Js?Symbol.for("react.memo"):60115,W_=Js?Symbol.for("react.lazy"):60116,lNe=Js?Symbol.for("react.block"):60121,cNe=Js?Symbol.for("react.fundamental"):60117,uNe=Js?Symbol.for("react.responder"):60118,dNe=Js?Symbol.for("react.scope"):60119;function hc(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case f6:switch(e=e.type,e){case p6:case D_:case L_:case F_:case R_:case U_:return e;default:switch(e=e&&e.$$typeof,e){case I_:case $_:case W_:case z_:case B_:return e;default:return t}}case h6:return t}}}function PG(e){return hc(e)===D_}Ki.AsyncMode=p6;Ki.ConcurrentMode=D_;Ki.ContextConsumer=I_;Ki.ContextProvider=B_;Ki.Element=f6;Ki.ForwardRef=$_;Ki.Fragment=L_;Ki.Lazy=W_;Ki.Memo=z_;Ki.Portal=h6;Ki.Profiler=F_;Ki.StrictMode=R_;Ki.Suspense=U_;Ki.isAsyncMode=function(e){return PG(e)||hc(e)===p6};Ki.isConcurrentMode=PG;Ki.isContextConsumer=function(e){return hc(e)===I_};Ki.isContextProvider=function(e){return hc(e)===B_};Ki.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===f6};Ki.isForwardRef=function(e){return hc(e)===$_};Ki.isFragment=function(e){return hc(e)===L_};Ki.isLazy=function(e){return hc(e)===W_};Ki.isMemo=function(e){return hc(e)===z_};Ki.isPortal=function(e){return hc(e)===h6};Ki.isProfiler=function(e){return hc(e)===F_};Ki.isStrictMode=function(e){return hc(e)===R_};Ki.isSuspense=function(e){return hc(e)===U_};Ki.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===L_||e===D_||e===F_||e===R_||e===U_||e===oNe||typeof e=="object"&&e!==null&&(e.$$typeof===W_||e.$$typeof===z_||e.$$typeof===B_||e.$$typeof===I_||e.$$typeof===$_||e.$$typeof===cNe||e.$$typeof===uNe||e.$$typeof===dNe||e.$$typeof===lNe)};Ki.typeOf=hc;TG.exports=Ki;var fNe=TG.exports,$R=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",UR=null,aj=null,OG=e=>{if(e===UR&&Array.isArray(aj))return aj;var t=[];return x.Children.forEach(e,r=>{Xi(r)||(fNe.isFragment(r)?t=t.concat(OG(r.props.children)):t.push(r))}),aj=t,UR=e,t};function q_(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(i=>$R(i)):n=[$R(t)],OG(e).forEach(i=>{var s=O0(i,"type.displayName")||O0(i,"type.name");s&&n.indexOf(s)!==-1&&r.push(i)}),r}var MG=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,LG={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var i;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const s=r[Symbol.toStringTag];return s==null||!((i=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&i.writable)?!1:r.toString()===`[object ${s}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})(LG);var hNe=LG.isPlainObject;const pNe=af(hNe);var zR,WR,qR,HR,VR;function GR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function KR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GR(Object(r),!0).forEach(function(n){mNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mNe(e,t,r){return(t=gNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gNe(e){var t=xNe(e,"string");return typeof t=="symbol"?t:t+""}function xNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Uw(){return Uw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Uw.apply(null,arguments)}function ex(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var YR=(e,t,r,n,i)=>{var s=r-n,o;return o=za(zR||(zR=ex(["M ",",",""])),e,t),o+=za(WR||(WR=ex(["L ",",",""])),e+r,t),o+=za(qR||(qR=ex(["L ",",",""])),e+r-s/2,t+i),o+=za(HR||(HR=ex(["L ",",",""])),e+r-s/2-n,t+i),o+=za(VR||(VR=ex(["L ",","," Z"])),e,t),o},yNe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},bNe=e=>{var t=Aa(e,yNe),{x:r,y:n,upperWidth:i,lowerWidth:s,height:o,className:l}=t,{animationEasing:c,animationDuration:u,animationBegin:d,isUpdateAnimationActive:f}=t,h=x.useRef(null),[p,m]=x.useState(-1),g=x.useRef(i),y=x.useRef(s),b=x.useRef(o),v=x.useRef(r),w=x.useRef(n),S=pg(e,"trapezoid-");if(x.useEffect(()=>{if(h.current&&h.current.getTotalLength)try{var q=h.current.getTotalLength();q&&m(q)}catch{}},[]),r!==+r||n!==+n||i!==+i||s!==+s||o!==+o||i===0&&s===0||o===0)return null;var k=Si("recharts-trapezoid",l);if(!f)return x.createElement("g",null,x.createElement("path",Uw({},Wo(t),{className:k,d:YR(r,n,i,s,o)})));var j=g.current,A=y.current,L=b.current,P=v.current,F=w.current,E="0px ".concat(p===-1?1:p,"px"),T="".concat(p,"px 0px"),B=Gq(["strokeDasharray"],u,c);return x.createElement(hg,{animationId:S,key:S,canBegin:p>0,duration:u,easing:c,isActive:f,begin:d},q=>{var U=Yi(j,i,q),se=Yi(A,s,q),de=Yi(L,o,q),z=Yi(P,r,q),G=Yi(F,n,q);h.current&&(g.current=U,y.current=se,b.current=de,v.current=z,w.current=G);var ie=q>0?{transition:B,strokeDasharray:T}:{strokeDasharray:E};return x.createElement("path",Uw({},Wo(t),{className:k,d:YR(z,G,U,se,de),ref:h,style:KR(KR({},ie),t.style)}))})},vNe=["option","shapeType","activeClassName"];function wNe(e,t){if(e==null)return{};var r,n,i=SNe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function SNe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function XR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function zw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XR(Object(r),!0).forEach(function(n){_Ne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _Ne(e,t,r){return(t=kNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kNe(e){var t=jNe(e,"string");return typeof t=="symbol"?t:t+""}function jNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ANe(e,t){return zw(zw({},t),e)}function NNe(e,t){return e==="symbols"}function QR(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return x.createElement(Qq,r);case"trapezoid":return x.createElement(bNe,r);case"sector":return x.createElement(tH,r);case"symbols":if(NNe(t))return x.createElement(zS,r);break;case"curve":return x.createElement(c_,r);default:return null}}function CNe(e){return x.isValidElement(e)?e.props:e}function I1(e){var{option:t,shapeType:r,activeClassName:n="recharts-active-shape"}=e,i=wNe(e,vNe),s;if(x.isValidElement(t))s=x.cloneElement(t,zw(zw({},i),CNe(t)));else if(typeof t=="function")s=t(i,i.index);else if(pNe(t)&&typeof t!="boolean"){var o=ANe(t,i);s=x.createElement(QR,{shapeType:r,elementProps:o})}else{var l=i;s=x.createElement(QR,{shapeType:r,elementProps:l})}return i.isActive?x.createElement(ja,{className:n},s):s}var H_=(e,t,r)=>{var n=Ji();return(i,s)=>o=>{e==null||e(i,s,o),n(FV({activeIndex:String(s),activeDataKey:t,activeCoordinate:i.tooltipPosition,activeGraphicalItemId:r}))}},V_=e=>{var t=Ji();return(r,n)=>i=>{e==null||e(r,n,i),t(Fke())}},G_=(e,t,r)=>{var n=Ji();return(i,s)=>o=>{e==null||e(i,s,o),n(Bke({activeIndex:String(s),activeDataKey:t,activeCoordinate:i.tooltipPosition,activeGraphicalItemId:r}))}};function K_(e){var{tooltipEntrySettings:t}=e,r=Ji(),n=Rs(),i=x.useRef(null);return x.useLayoutEffect(()=>{n||(i.current===null?r(Oke(t)):i.current!==t&&r(Mke({prev:i.current,next:t})),i.current=t)},[t,r,n]),x.useLayoutEffect(()=>()=>{i.current&&(r(Lke(i.current)),i.current=null)},[r]),null}function m6(e){var{legendPayload:t}=e,r=Ji(),n=Rs(),i=x.useRef(null);return x.useLayoutEffect(()=>{n||(i.current===null?r(Wq(t)):i.current!==t&&r(qq({prev:i.current,next:t})),i.current=t)},[r,n,t]),x.useLayoutEffect(()=>()=>{i.current&&(r(Hq(i.current)),i.current=null)},[r]),null}function ENe(e){var{legendPayload:t}=e,r=Ji(),n=yn(Pi),i=x.useRef(null);return x.useLayoutEffect(()=>{n!=="centric"&&n!=="radial"||(i.current===null?r(Wq(t)):i.current!==t&&r(qq({prev:i.current,next:t})),i.current=t)},[r,n,t]),x.useLayoutEffect(()=>()=>{i.current&&(r(Hq(i.current)),i.current=null)},[r]),null}var sj,TNe=()=>{var[e]=x.useState(()=>k1("uid-"));return e},PNe=(sj=fB.useId)!==null&&sj!==void 0?sj:TNe;function ONe(e,t){var r=PNe();return t||(e?"".concat(e,"-").concat(r):r)}var MNe=x.createContext(void 0),Y_=e=>{var{id:t,type:r,children:n}=e,i=ONe("recharts-".concat(r),t);return x.createElement(MNe.Provider,{value:i},n(i))},LNe={cartesianItems:[],polarItems:[]},RG=Ll({name:"graphicalItems",initialState:LNe,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:Sa()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:r,next:n}=t.payload,i=yu(e).cartesianItems.indexOf(r);i>-1&&(e.cartesianItems[i]=n)},prepare:Sa()},removeCartesianGraphicalItem:{reducer(e,t){var r=yu(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},prepare:Sa()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:Sa()},removePolarGraphicalItem:{reducer(e,t){var r=yu(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)},prepare:Sa()}}}),{addCartesianGraphicalItem:RNe,replaceCartesianGraphicalItem:FNe,removeCartesianGraphicalItem:BNe,addPolarGraphicalItem:INe,removePolarGraphicalItem:DNe}=RG.actions,$Ne=RG.reducer,UNe=e=>{var t=Ji(),r=x.useRef(null);return x.useLayoutEffect(()=>{r.current===null?t(RNe(e)):r.current!==e&&t(FNe({prev:r.current,next:e})),r.current=e},[t,e]),x.useLayoutEffect(()=>()=>{r.current&&(t(BNe(r.current)),r.current=null)},[t]),null},g6=x.memo(UNe);function zNe(e){var t=Ji();return x.useLayoutEffect(()=>(t(INe(e)),()=>{t(DNe(e))}),[t,e]),null}var WNe=["key"],qNe=["onMouseEnter","onClick","onMouseLeave"],HNe=["id"],VNe=["id"];function JR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ha(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JR(Object(r),!0).forEach(function(n){GNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GNe(e,t,r){return(t=KNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KNe(e){var t=YNe(e,"string");return typeof t=="symbol"?t:t+""}function YNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yh(){return yh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yh.apply(null,arguments)}function X_(e,t){if(e==null)return{};var r,n,i=XNe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function XNe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function QNe(e){var t=x.useMemo(()=>q_(e.children,lp),[e.children]),r=yn(n=>aNe(n,e.id,t));return r==null?null:x.createElement(ENe,{legendPayload:r})}var JNe=x.memo(e=>{var{dataKey:t,nameKey:r,sectors:n,stroke:i,strokeWidth:s,fill:o,name:l,hide:c,tooltipType:u,id:d}=e,f={dataDefinedOnItem:n.map(h=>h.tooltipPayload),getPosition:h=>{var p;return(p=n[Number(h)])===null||p===void 0?void 0:p.tooltipPosition},settings:{stroke:i,strokeWidth:s,fill:o,dataKey:t,nameKey:r,name:Nh(l,t),hide:c,type:u,color:o,unit:"",graphicalItemId:d}};return x.createElement(K_,{tooltipEntrySettings:f})}),ZNe=(e,t)=>e>t?"start":e<t?"end":"middle",e3e=(e,t,r)=>$o(typeof t=="function"?t(e):t,r,r*.8),t3e=(e,t,r)=>{var{top:n,left:i,width:s,height:o}=t,l=Jq(s,o),c=i+$o(e.cx,s,s/2),u=n+$o(e.cy,o,o/2),d=$o(e.innerRadius,l,0),f=e3e(r,e.outerRadius,l),h=e.maxRadius||Math.sqrt(s*s+o*o)/2;return{cx:c,cy:u,innerRadius:d,outerRadius:f,maxRadius:h}},r3e=(e,t)=>{var r=Ks(t-e),n=Math.min(Math.abs(t-e),360);return r*n},n3e=(e,t)=>{if(x.isValidElement(e))return x.cloneElement(e,t);if(typeof e=="function")return e(t);var r=Si("recharts-pie-label-line",typeof e!="boolean"?e.className:""),{key:n}=t,i=X_(t,WNe);return x.createElement(c_,yh({},i,{type:"linear",className:r}))},i3e=(e,t,r)=>{if(x.isValidElement(e))return x.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),x.isValidElement(n)))return n;var i=Si("recharts-pie-label-text",CG(e));return x.createElement(T_,yh({},t,{alignmentBaseline:"middle",className:i}),n)};function a3e(e){var{sectors:t,props:r,showLabels:n}=e,{label:i,labelLine:s,dataKey:o}=r;if(!n||!i||!t)return null;var l=ol(r),c=xh(i),u=xh(s),d=typeof i=="object"&&"offsetRadius"in i&&typeof i.offsetRadius=="number"&&i.offsetRadius||20,f=t.map((h,p)=>{var m=(h.startAngle+h.endAngle)/2,g=ws(h.cx,h.cy,h.outerRadius+d,m),y=Ha(Ha(Ha(Ha({},l),h),{},{stroke:"none"},c),{},{index:p,textAnchor:ZNe(g.x,h.cx)},g),b=Ha(Ha(Ha(Ha({},l),h),{},{fill:"none",stroke:h.fill},u),{},{index:p,points:[ws(h.cx,h.cy,h.outerRadius,m),g],key:"line"});return x.createElement(yo,{zIndex:Oa.label,key:"label-".concat(h.startAngle,"-").concat(h.endAngle,"-").concat(h.midAngle,"-").concat(p)},x.createElement(ja,null,s&&n3e(s,b),i3e(i,y,Ei(h,o))))});return x.createElement(ja,{className:"recharts-pie-labels"},f)}function s3e(e){var{sectors:t,props:r,showLabels:n}=e,{label:i}=r;return typeof i=="object"&&i!=null&&"position"in i?x.createElement(P_,{label:i}):x.createElement(a3e,{sectors:t,props:r,showLabels:n})}function o3e(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:i,shape:s,id:o}=e,l=yn(rf),c=yn(n6),u=yn(Sje),{onMouseEnter:d,onClick:f,onMouseLeave:h}=i,p=X_(i,qNe),m=H_(d,i.dataKey,o),g=V_(h),y=G_(f,i.dataKey,o);return t==null||t.length===0?null:x.createElement(x.Fragment,null,t.map((b,v)=>{if((b==null?void 0:b.startAngle)===0&&(b==null?void 0:b.endAngle)===0&&t.length!==1)return null;var w=u==null||u===o,S=String(v)===l&&(c==null||i.dataKey===c)&&w,k=l?n:null,j=r&&S?r:k,A=Ha(Ha({},b),{},{stroke:b.stroke,tabIndex:-1,[Aq]:v,[qC]:o});return x.createElement(ja,yh({key:"sector-".concat(b==null?void 0:b.startAngle,"-").concat(b==null?void 0:b.endAngle,"-").concat(b.midAngle,"-").concat(v),tabIndex:-1,className:"recharts-pie-sector"},dg(p,b,v),{onMouseEnter:m(b,v),onMouseLeave:g(b,v),onClick:y(b,v)}),x.createElement(I1,yh({option:s??j,index:v,shapeType:"sector",isActive:S},A)))}))}function l3e(e){var t,{pieSettings:r,displayedData:n,cells:i,offset:s}=e,{cornerRadius:o,startAngle:l,endAngle:c,dataKey:u,nameKey:d,tooltipType:f}=r,h=Math.abs(r.minAngle),p=r3e(l,c),m=Math.abs(p),g=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,y=n.filter(j=>Ei(j,u,0)!==0).length,b=(m>=360?y:y-1)*g,v=m-y*h-b,w=n.reduce((j,A)=>{var L=Ei(A,u,0);return j+(An(L)?L:0)},0),S;if(w>0){var k;S=n.map((j,A)=>{var L=Ei(j,u,0),P=Ei(j,d,A),F=t3e(r,s,j),E=(An(L)?L:0)/w,T,B=Ha(Ha({},j),i&&i[A]&&i[A].props);A?T=k.endAngle+Ks(p)*g*(L!==0?1:0):T=l;var q=T+Ks(p)*((L!==0?h:0)+E*v),U=(T+q)/2,se=(F.innerRadius+F.outerRadius)/2,de=[{name:P,value:L,payload:B,dataKey:u,type:f,graphicalItemId:r.id}],z=ws(F.cx,F.cy,se,U);return k=Ha(Ha(Ha(Ha({},r.presentationProps),{},{percent:E,cornerRadius:typeof o=="string"?parseFloat(o):o,name:P,tooltipPayload:de,midAngle:U,middleRadius:se,tooltipPosition:z},B),F),{},{value:L,dataKey:u,startAngle:T,endAngle:q,payload:B,paddingAngle:Ks(p)*g}),k})}return S}function c3e(e){var{showLabels:t,sectors:r,children:n}=e,i=x.useMemo(()=>!t||!r?[]:r.map(s=>({value:s.value,payload:s.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:s.cx,cy:s.cy,innerRadius:s.innerRadius,outerRadius:s.outerRadius,startAngle:s.startAngle,endAngle:s.endAngle,clockWise:!1},fill:s.fill})),[r,t]);return x.createElement(zAe,{value:t?i:void 0},n)}function u3e(e){var{props:t,previousSectorsRef:r,id:n}=e,{sectors:i,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:c,activeShape:u,inactiveShape:d,onAnimationStart:f,onAnimationEnd:h}=t,p=pg(t,"recharts-pie-"),m=r.current,[g,y]=x.useState(!1),b=x.useCallback(()=>{typeof h=="function"&&h(),y(!1)},[h]),v=x.useCallback(()=>{typeof f=="function"&&f(),y(!0)},[f]);return x.createElement(c3e,{showLabels:!g,sectors:i},x.createElement(hg,{animationId:p,begin:o,duration:l,isActive:s,easing:c,onAnimationStart:v,onAnimationEnd:b,key:p},w=>{var S,k=[],j=i&&i[0],A=(S=j==null?void 0:j.startAngle)!==null&&S!==void 0?S:0;return i==null||i.forEach((L,P)=>{var F=m&&m[P],E=P>0?O0(L,"paddingAngle",0):0;if(F){var T=Yi(F.endAngle-F.startAngle,L.endAngle-L.startAngle,w),B=Ha(Ha({},L),{},{startAngle:A+E,endAngle:A+T+E});k.push(B),A=B.endAngle}else{var{endAngle:q,startAngle:U}=L,se=Yi(0,q-U,w),de=Ha(Ha({},L),{},{startAngle:A+E,endAngle:A+se+E});k.push(de),A=de.endAngle}}),r.current=k,x.createElement(ja,null,x.createElement(o3e,{sectors:k,activeShape:u,inactiveShape:d,allOtherPieProps:t,shape:t.shape,id:n}))}),x.createElement(s3e,{showLabels:!g,sectors:i,props:t}),t.children)}var d3e={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:Oa.area};function f3e(e){var{id:t}=e,r=X_(e,HNe),{hide:n,className:i,rootTabIndex:s}=e,o=x.useMemo(()=>q_(e.children,lp),[e.children]),l=yn(d=>sNe(d,t,o)),c=x.useRef(null),u=Si("recharts-pie",i);return n||l==null?(c.current=null,x.createElement(ja,{tabIndex:s,className:u})):x.createElement(yo,{zIndex:e.zIndex},x.createElement(JNe,{dataKey:e.dataKey,nameKey:e.nameKey,sectors:l,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType,id:t}),x.createElement(ja,{tabIndex:s,className:u},x.createElement(u3e,{props:Ha(Ha({},r),{},{sectors:l}),previousSectorsRef:c,id:t})))}function FG(e){var t=Aa(e,d3e),{id:r}=t,n=X_(t,VNe),i=ol(n);return x.createElement(Y_,{id:r,type:"pie"},s=>x.createElement(x.Fragment,null,x.createElement(zNe,{type:"pie",id:s,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:i,maxRadius:t.maxRadius}),x.createElement(QNe,yh({},n,{id:s})),x.createElement(f3e,yh({},n,{id:s}))))}FG.displayName="Pie";var h3e=["points"];function ZR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function oj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZR(Object(r),!0).forEach(function(n){p3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function p3e(e,t,r){return(t=m3e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m3e(e){var t=g3e(e,"string");return typeof t=="symbol"?t:t+""}function g3e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ww(){return Ww=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ww.apply(null,arguments)}function x3e(e,t){if(e==null)return{};var r,n,i=y3e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function y3e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function b3e(e){var{option:t,dotProps:r,className:n}=e;if(x.isValidElement(t))return x.cloneElement(t,r);if(typeof t=="function")return t(r);var i=Si(n,typeof t!="boolean"?t.className:""),s=r??{},{points:o}=s,l=x3e(s,h3e);return x.createElement(kG,Ww({},l,{className:i}))}function v3e(e,t){return e==null?!1:t?!0:e.length===1}function w3e(e){var{points:t,dot:r,className:n,dotClassName:i,dataKey:s,baseProps:o,needClip:l,clipPathId:c,zIndex:u=Oa.scatter}=e;if(!v3e(t,r))return null;var d=MG(r),f=o1e(r),h=t.map((m,g)=>{var y,b,v=oj(oj(oj({r:3},o),f),{},{index:g,cx:(y=m.x)!==null&&y!==void 0?y:void 0,cy:(b=m.y)!==null&&b!==void 0?b:void 0,dataKey:s,value:m.value,payload:m.payload,points:t});return x.createElement(b3e,{key:"dot-".concat(g),option:r,dotProps:v,className:i})}),p={};return l&&c!=null&&(p.clipPath="url(#clipPath-".concat(d?"":"dots-").concat(c,")")),x.createElement(yo,{zIndex:u},x.createElement(ja,Ww({className:n},p),h))}function eF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function tF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eF(Object(r),!0).forEach(function(n){S3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function S3e(e,t,r){return(t=_3e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _3e(e){var t=k3e(e,"string");return typeof t=="symbol"?t:t+""}function k3e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BG=0,j3e={xAxis:{},yAxis:{},zAxis:{}},IG=Ll({name:"cartesianAxis",initialState:j3e,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:Sa()},replaceXAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.xAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.xAxis[r.id],e.xAxis[n.id]=n)},prepare:Sa()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:Sa()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:Sa()},replaceYAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.yAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.yAxis[r.id],e.yAxis[n.id]=n)},prepare:Sa()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:Sa()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:Sa()},replaceZAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.zAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.zAxis[r.id],e.zAxis[n.id]=n)},prepare:Sa()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:Sa()},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload,i=e.yAxis[r];if(i){var s,o=i.widthHistory||[];if(o.length===3&&o[0]===o[2]&&n===o[1]&&n!==i.width&&Math.abs(n-((s=o[0])!==null&&s!==void 0?s:0))<=1)return;var l=[...o,n].slice(-3);e.yAxis[r]=tF(tF({},i),{},{width:n,widthHistory:l})}}}}),{addXAxis:A3e,replaceXAxis:N3e,removeXAxis:C3e,addYAxis:E3e,replaceYAxis:T3e,removeYAxis:P3e,addZAxis:O3e,replaceZAxis:M3e,removeZAxis:L3e,updateYAxisWidth:R3e}=IG.actions,F3e=IG.reducer,B3e=Qt([Ls],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),I3e=Qt([B3e,hf,pf],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),x6=()=>yn(I3e),D3e=()=>yn(Nje);function rF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function lj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rF(Object(r),!0).forEach(function(n){$3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $3e(e,t,r){return(t=U3e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U3e(e){var t=z3e(e,"string");return typeof t=="symbol"?t:t+""}function z3e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var W3e=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:i,dataKey:s,clipPath:o}=e;if(i===!1||t.x==null||t.y==null)return null;var l={index:r,dataKey:s,cx:t.x,cy:t.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},c=lj(lj(lj({},l),xh(i)),AC(i)),u;return x.isValidElement(i)?u=x.cloneElement(i,c):typeof i=="function"?u=i(c):u=x.createElement(kG,c),x.createElement(ja,{className:"recharts-active-dot",clipPath:o},u)};function q3e(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:i,clipPath:s,zIndex:o=Oa.activeDot}=e,l=yn(rf),c=D3e();if(t==null||c==null)return null;var u=t.find(d=>c.includes(d.payload));return Xi(u)?null:x.createElement(yo,{zIndex:o},x.createElement(W3e,{point:u,childIndex:Number(l),mainColor:r,dataKey:i,activeDot:n,clipPath:s}))}var nF=(e,t,r)=>{var n=r??e;if(!Xi(n))return $o(n,t,0)},H3e=(e,t,r)=>{var n={},i=e.filter(S_),s=e.filter(u=>u.stackId==null),o=i.reduce((u,d)=>{var f=u[d.stackId];return f==null&&(f=[]),f.push(d),u[d.stackId]=f,u},n),l=Object.entries(o).map(u=>{var d,[f,h]=u,p=h.map(g=>g.dataKey),m=nF(t,r,(d=h[0])===null||d===void 0?void 0:d.barSize);return{stackId:f,dataKeys:p,barSize:m}}),c=s.map(u=>{var d=[u.dataKey].filter(h=>h!=null),f=nF(t,r,u.barSize);return{stackId:void 0,dataKeys:d,barSize:f}});return[...l,...c]};function iF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function pv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iF(Object(r),!0).forEach(function(n){V3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function V3e(e,t,r){return(t=G3e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function G3e(e){var t=K3e(e,"string");return typeof t=="symbol"?t:t+""}function K3e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Y3e(e,t,r,n,i){var s,o=n.length;if(!(o<1)){var l=$o(e,r,0,!0),c,u=[];if(pi((s=n[0])===null||s===void 0?void 0:s.barSize)){var d=!1,f=r/o,h=n.reduce((v,w)=>v+(w.barSize||0),0);h+=(o-1)*l,h>=r&&(h-=(o-1)*l,l=0),h>=r&&f>0&&(d=!0,f*=.9,h=o*f);var p=(r-h)/2>>0,m={offset:p-l,size:0};c=n.reduce((v,w)=>{var S,k={stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:m.offset+m.size+l,size:d?f:(S=w.barSize)!==null&&S!==void 0?S:0}},j=[...v,k];return m=k.position,j},u)}else{var g=$o(t,r,0,!0);r-2*g-(o-1)*l<=0&&(l=0);var y=(r-2*g-(o-1)*l)/o;y>1&&(y>>=0);var b=pi(i)?Math.min(y,i):y;c=n.reduce((v,w,S)=>[...v,{stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:g+(y+l)*S+(y-b)/2,size:b}}],u)}return c}}var X3e=(e,t,r,n,i,s,o)=>{var l=Xi(o)?t:o,c=Y3e(r,n,i!==s?i:s,e,l);return i!==s&&c!=null&&(c=c.map(u=>pv(pv({},u),{},{position:pv(pv({},u.position),{},{offset:u.position.offset-i/2})}))),c},Q3e=(e,t)=>{var r=TE(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var i=e[n];if(i){var{stackedData:s}=i;if(s)return s.find(o=>o.key===r)}}}},J3e=(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}};function Z3e(e,t){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&pi(e.zIndex)?e.zIndex:t}var DG=e=>{var{chartData:t}=e,r=Ji(),n=Rs();return x.useEffect(()=>n?()=>{}:(r(yR(t)),()=>{r(yR(void 0))}),[t,r,n]),null},aF={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},$G=Ll({name:"brush",initialState:aF,reducers:{setBrushSettings(e,t){return t.payload==null?aF:t.payload}}}),{setBrushSettings:MMe}=$G.actions,eCe=$G.reducer,tCe=(e,t)=>{var{x:r,y:n}=e,{x:i,y:s}=t;return{x:Math.min(r,i),y:Math.min(n,s),width:Math.abs(i-r),height:Math.abs(s-n)}},rCe=e=>{var{x1:t,y1:r,x2:n,y2:i}=e;return tCe({x:t,y:r},{x:n,y:i})};function nCe(e){return(e%180+180)%180}var iCe=function(t){var{width:r,height:n}=t,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=nCe(i),o=s*Math.PI/180,l=Math.atan(n/r),c=o>l&&o<Math.PI-l?n/Math.sin(o):r/Math.cos(o);return Math.abs(c)},aCe={dots:[],areas:[],lines:[]},UG=Ll({name:"referenceElements",initialState:aCe,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=yu(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=yu(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=yu(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:LMe,removeDot:RMe,addArea:FMe,removeArea:BMe,addLine:sCe,removeLine:oCe}=UG.actions,lCe=UG.reducer,zG=x.createContext(void 0),cCe=e=>{var{children:t}=e,[r]=x.useState("".concat(k1("recharts"),"-clip")),n=x6();if(n==null)return null;var{x:i,y:s,width:o,height:l}=n;return x.createElement(zG.Provider,{value:r},x.createElement("defs",null,x.createElement("clipPath",{id:r},x.createElement("rect",{x:i,y:s,height:l,width:o}))),t)},uCe=()=>x.useContext(zG);class dCe{constructor(t){var{x:r,y:n}=t;this.xAxisScale=r,this.yAxisScale=n}map(t,r){var n,i,{position:s}=r;return{x:(n=this.xAxisScale.map(t.x,{position:s}))!==null&&n!==void 0?n:0,y:(i=this.yAxisScale.map(t.y,{position:s}))!==null&&i!==void 0?i:0}}mapWithFallback(t,r){var n,i,{position:s,fallback:o}=r,l,c;return o==="rangeMin"?l=this.yAxisScale.rangeMin():o==="rangeMax"?l=this.yAxisScale.rangeMax():l=0,o==="rangeMin"?c=this.xAxisScale.rangeMin():o==="rangeMax"?c=this.xAxisScale.rangeMax():c=0,{x:(n=this.xAxisScale.map(t.x,{position:s}))!==null&&n!==void 0?n:c,y:(i=this.yAxisScale.map(t.y,{position:s}))!==null&&i!==void 0?i:l}}isInRange(t){var{x:r,y:n}=t,i=r==null||this.xAxisScale.isInRange(r),s=n==null||this.yAxisScale.isInRange(n);return i&&s}}function sF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function oF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sF(Object(r),!0).forEach(function(n){fCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fCe(e,t,r){return(t=hCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hCe(e){var t=pCe(e,"string");return typeof t=="symbol"?t:t+""}function pCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qw(){return qw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qw.apply(null,arguments)}var mCe=(e,t)=>{var r;if(x.isValidElement(e))r=x.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{if(!pi(t.x1)||!pi(t.y1)||!pi(t.x2)||!pi(t.y2))return null;r=x.createElement("line",qw({},t,{className:"recharts-reference-line-line"}))}return r},gCe=(e,t,r,n,i,s)=>{var{x:o,width:l}=s,c=i.map(e,{position:r});if(!pi(c)||t==="discard"&&!i.isInRange(c))return null;var u=[{x:o+l,y:c},{x:o,y:c}];return n==="left"?u.reverse():u},xCe=(e,t,r,n,i,s)=>{var{y:o,height:l}=s,c=i.map(e,{position:r});if(!pi(c)||t==="discard"&&!i.isInRange(c))return null;var u=[{x:c,y:o+l},{x:c,y:o}];return n==="top"?u.reverse():u},yCe=(e,t,r,n)=>{var i=[n.mapWithFallback(e[0],{position:r,fallback:"rangeMin"}),n.mapWithFallback(e[1],{position:r,fallback:"rangeMax"})];return t==="discard"&&i.some(s=>!n.isInRange(s))?null:i},bCe=(e,t,r,n,i,s,o)=>{var{x:l,y:c,segment:u,ifOverflow:d}=o,f=Wc(l),h=Wc(c);return h?gCe(c,d,n,s,t,r):f?xCe(l,d,n,i,e,r):u!=null&&u.length===2?yCe(u,d,n,new dCe({x:e,y:t})):null};function vCe(e){var t=Ji();return x.useEffect(()=>(t(sCe(e)),()=>{t(oCe(e))})),null}function wCe(e){var{xAxisId:t,yAxisId:r,shape:n,className:i,ifOverflow:s}=e,o=Rs(),l=uCe(),c=yn(A=>hd(A,t)),u=yn(A=>pd(A,r)),d=yn(A=>Km(A,"xAxis",t,o)),f=yn(A=>Km(A,"yAxis",r,o)),h=fg();if(!l||!h||c==null||u==null||d==null||f==null)return null;var p=bCe(d,f,h,e.position,c.orientation,u.orientation,e);if(!p)return null;var m=p[0],g=p[1];if(m==null||g==null)return null;var{x:y,y:b}=m,{x:v,y:w}=g,S=s==="hidden"?"url(#".concat(l,")"):void 0,k=oF(oF({clipPath:S},Wo(e)),{},{x1:y,y1:b,x2:v,y2:w}),j=rCe({x1:y,y1:b,x2:v,y2:w});return x.createElement(yo,{zIndex:e.zIndex},x.createElement(ja,{className:Si("recharts-reference-line",i)},mCe(n,k),x.createElement(gG,qw({},j,{lowerWidth:j.width,upperWidth:j.width}),x.createElement(yG,{label:e.label}),e.children)))}var SCe={ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",label:!1,stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle",zIndex:Oa.line};function ZA(e){var t=Aa(e,SCe);return x.createElement(x.Fragment,null,x.createElement(vCe,{yAxisId:t.yAxisId,xAxisId:t.xAxisId,ifOverflow:t.ifOverflow,x:t.x,y:t.y,segment:t.segment}),x.createElement(wCe,t))}ZA.displayName="ReferenceLine";function WG(e,t){if(t<1)return[];if(t===1)return e;for(var r=[],n=0;n<e.length;n+=t){var i=e[n];i!==void 0&&r.push(i)}return r}function _Ce(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return iCe(n,r)}function kCe(e,t,r){var n=r==="width",{x:i,y:s,width:o,height:l}=e;return t===1?{start:n?i:s,end:n?i+o:s+l}:{start:n?i+o:s+l,end:n?i:s}}function D1(e,t,r,n,i){if(e*t<e*n||e*t>e*i)return!1;var s=r();return e*(t-e*s/2-n)>=0&&e*(t+e*s/2-i)<=0}function jCe(e,t){return WG(e,t+1)}function ACe(e,t,r,n,i){for(var s=(n||[]).slice(),{start:o,end:l}=t,c=0,u=1,d=o,f=function(){var m=n==null?void 0:n[c];if(m===void 0)return{v:WG(n,u)};var g=c,y,b=()=>(y===void 0&&(y=r(m,g)),y),v=m.coordinate,w=c===0||D1(e,v,b,d,l);w||(c=0,d=o,u+=1),w&&(d=v+e*(b()/2+i),c+=u)},h;u<=s.length;)if(h=f(),h)return h.v;return[]}function NCe(e,t,r,n,i){var s=(n||[]).slice(),o=s.length;if(o===0)return[];for(var{start:l,end:c}=t,u=1;u<=o;u++){for(var d=(o-1)%u,f=l,h=!0,p=function(){var S=n[g];if(S==null)return 0;var k=g,j,A=()=>(j===void 0&&(j=r(S,k)),j),L=S.coordinate,P=g===d||D1(e,L,A,f,c);if(!P)return h=!1,1;P&&(f=L+e*(A()/2+i))},m,g=d;g<o&&(m=p(),!(m!==0&&m===1));g+=u);if(h){for(var y=[],b=d;b<o;b+=u){var v=n[b];v!=null&&y.push(v)}return y}}return[]}function lF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Po(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lF(Object(r),!0).forEach(function(n){CCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CCe(e,t,r){return(t=ECe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ECe(e){var t=TCe(e,"string");return typeof t=="symbol"?t:t+""}function TCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function PCe(e,t,r,n,i){for(var s=(n||[]).slice(),o=s.length,{start:l}=t,{end:c}=t,u=function(h){var p=s[h];if(p==null)return 1;var m=p,g,y=()=>(g===void 0&&(g=r(p,h)),g);if(h===o-1){var b=e*(m.coordinate+e*y()/2-c);s[h]=m=Po(Po({},m),{},{tickCoord:b>0?m.coordinate-b*e:m.coordinate})}else s[h]=m=Po(Po({},m),{},{tickCoord:m.coordinate});if(m.tickCoord!=null){var v=D1(e,m.tickCoord,y,l,c);v&&(c=m.tickCoord-e*(y()/2+i),s[h]=Po(Po({},m),{},{isShow:!0}))}},d=o-1;d>=0;d--)u(d);return s}function OCe(e,t,r,n,i,s){var o=(n||[]).slice(),l=o.length,{start:c,end:u}=t;if(s){var d=n[l-1];if(d!=null){var f=r(d,l-1),h=e*(d.coordinate+e*f/2-u);if(o[l-1]=d=Po(Po({},d),{},{tickCoord:h>0?d.coordinate-h*e:d.coordinate}),d.tickCoord!=null){var p=D1(e,d.tickCoord,()=>f,c,u);p&&(u=d.tickCoord-e*(f/2+i),o[l-1]=Po(Po({},d),{},{isShow:!0}))}}}for(var m=s?l-1:l,g=function(v){var w=o[v];if(w==null)return 1;var S=w,k,j=()=>(k===void 0&&(k=r(w,v)),k);if(v===0){var A=e*(S.coordinate-e*j()/2-c);o[v]=S=Po(Po({},S),{},{tickCoord:A<0?S.coordinate-A*e:S.coordinate})}else o[v]=S=Po(Po({},S),{},{tickCoord:S.coordinate});if(S.tickCoord!=null){var L=D1(e,S.tickCoord,j,c,u);L&&(c=S.tickCoord+e*(j()/2+i),o[v]=Po(Po({},S),{},{isShow:!0}))}},y=0;y<m;y++)g(y);return o}function y6(e,t,r){var{tick:n,ticks:i,viewBox:s,minTickGap:o,orientation:l,interval:c,tickFormatter:u,unit:d,angle:f}=e;if(!i||!i.length||!n)return[];if(An(c)||u_.isSsr){var h;return(h=jCe(i,An(c)?c:0))!==null&&h!==void 0?h:[]}var p=[],m=l==="top"||l==="bottom"?"width":"height",g=d&&m==="width"?Ix(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},y=(k,j)=>{var A=typeof u=="function"?u(k.value,j):k.value;return m==="width"?_Ce(Ix(A,{fontSize:t,letterSpacing:r}),g,f):Ix(A,{fontSize:t,letterSpacing:r})[m]},b=i[0],v=i[1],w=i.length>=2&&b!=null&&v!=null?Ks(v.coordinate-b.coordinate):1,S=kCe(s,w,m);return c==="equidistantPreserveStart"?ACe(w,S,y,i,o):c==="equidistantPreserveEnd"?NCe(w,S,y,i,o):(c==="preserveStart"||c==="preserveStartEnd"?p=OCe(w,S,y,i,o,c==="preserveStartEnd"):p=PCe(w,S,y,i,o),p.filter(k=>k.isShow))}var MCe=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:i=0,tickMargin:s=0}=e,o=0;if(t){Array.from(t).forEach(d=>{if(d){var f=d.getBoundingClientRect();f.width>o&&(o=f.width)}});var l=r?r.getBoundingClientRect().width:0,c=i+s,u=o+c+l+(r?n:0);return Math.round(u)}return 0},LCe=["axisLine","width","height","className","hide","ticks","axisType"];function RCe(e,t){if(e==null)return{};var r,n,i=FCe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function FCe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function I0(){return I0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},I0.apply(null,arguments)}function cF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ua(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cF(Object(r),!0).forEach(function(n){BCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BCe(e,t,r){return(t=ICe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ICe(e){var t=DCe(e,"string");return typeof t=="symbol"?t:t+""}function DCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wd={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:Oa.axis};function $Ce(e){var{x:t,y:r,width:n,height:i,orientation:s,mirror:o,axisLine:l,otherSvgProps:c}=e;if(!l)return null;var u=Ua(Ua(Ua({},c),ol(l)),{},{fill:"none"});if(s==="top"||s==="bottom"){var d=+(s==="top"&&!o||s==="bottom"&&o);u=Ua(Ua({},u),{},{x1:t,y1:r+d*i,x2:t+n,y2:r+d*i})}else{var f=+(s==="left"&&!o||s==="right"&&o);u=Ua(Ua({},u),{},{x1:t+f*n,y1:r,x2:t+f*n,y2:r+i})}return x.createElement("line",I0({},u,{className:Si("recharts-cartesian-axis-line",O0(l,"className"))}))}function UCe(e,t,r,n,i,s,o,l,c){var u,d,f,h,p,m,g=l?-1:1,y=e.tickSize||o,b=An(e.tickCoord)?e.tickCoord:e.coordinate;switch(s){case"top":u=d=e.coordinate,h=r+ +!l*i,f=h-g*y,m=f-g*c,p=b;break;case"left":f=h=e.coordinate,d=t+ +!l*n,u=d-g*y,p=u-g*c,m=b;break;case"right":f=h=e.coordinate,d=t+ +l*n,u=d+g*y,p=u+g*c,m=b;break;default:u=d=e.coordinate,h=r+ +l*i,f=h+g*y,m=f+g*c,p=b;break}return{line:{x1:u,y1:f,x2:d,y2:h},tick:{x:p,y:m}}}function zCe(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function WCe(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function qCe(e){var{option:t,tickProps:r,value:n}=e,i,s=Si(r.className,"recharts-cartesian-axis-tick-value");if(x.isValidElement(t))i=x.cloneElement(t,Ua(Ua({},r),{},{className:s}));else if(typeof t=="function")i=t(Ua(Ua({},r),{},{className:s}));else{var o="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(o=Si(o,CG(t))),i=x.createElement(T_,I0({},r,{className:o}),n)}return i}var HCe=x.forwardRef((e,t)=>{var{ticks:r=[],tick:n,tickLine:i,stroke:s,tickFormatter:o,unit:l,padding:c,tickTextProps:u,orientation:d,mirror:f,x:h,y:p,width:m,height:g,tickSize:y,tickMargin:b,fontSize:v,letterSpacing:w,getTicksConfig:S,events:k,axisType:j}=e,A=y6(Ua(Ua({},S),{},{ticks:r}),v,w),L=zCe(d,f),P=WCe(d,f),F=ol(S),E=xh(n),T={};typeof i=="object"&&(T=i);var B=Ua(Ua({},F),{},{fill:"none"},T),q=A.map(de=>Ua({entry:de},UCe(de,h,p,m,g,d,y,f,b))),U=q.map(de=>{var{entry:z,line:G}=de;return x.createElement(ja,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(z.value,"-").concat(z.coordinate,"-").concat(z.tickCoord)},i&&x.createElement("line",I0({},B,G,{className:Si("recharts-cartesian-axis-tick-line",O0(i,"className"))})))}),se=q.map((de,z)=>{var G,ie,{entry:Y,tick:C}=de,K=Ua(Ua(Ua(Ua({verticalAnchor:P},F),{},{textAnchor:L,stroke:"none",fill:s},C),{},{index:z,payload:Y,visibleTicksCount:A.length,tickFormatter:o,padding:c},u),{},{angle:(G=(ie=u==null?void 0:u.angle)!==null&&ie!==void 0?ie:F.angle)!==null&&G!==void 0?G:0}),H=Ua(Ua({},K),E);return x.createElement(ja,I0({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(Y.value,"-").concat(Y.coordinate,"-").concat(Y.tickCoord)},dg(k,Y,z)),n&&x.createElement(qCe,{option:n,tickProps:H,value:"".concat(typeof o=="function"?o(Y.value,z):Y.value).concat(l||"")}))});return x.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(j,"-ticks")},se.length>0&&x.createElement(yo,{zIndex:Oa.label},x.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(j,"-tick-labels"),ref:t},se)),U.length>0&&x.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(j,"-tick-lines")},U))}),VCe=x.forwardRef((e,t)=>{var{axisLine:r,width:n,height:i,className:s,hide:o,ticks:l,axisType:c}=e,u=RCe(e,LCe),[d,f]=x.useState(""),[h,p]=x.useState(""),m=x.useRef(null);x.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var y;return MCe({ticks:m.current,label:(y=e.labelRef)===null||y===void 0?void 0:y.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var g=x.useCallback(y=>{if(y){var b=y.getElementsByClassName("recharts-cartesian-axis-tick-value");m.current=b;var v=b[0];if(v){var w=window.getComputedStyle(v),S=w.fontSize,k=w.letterSpacing;(S!==d||k!==h)&&(f(S),p(k))}}},[d,h]);return o||n!=null&&n<=0||i!=null&&i<=0?null:x.createElement(yo,{zIndex:e.zIndex},x.createElement(ja,{className:Si("recharts-cartesian-axis",s)},x.createElement($Ce,{x:e.x,y:e.y,width:n,height:i,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:ol(e)}),x.createElement(HCe,{ref:g,axisType:c,events:u,fontSize:d,getTicksConfig:e,height:e.height,letterSpacing:h,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:l,unit:e.unit,width:e.width,x:e.x,y:e.y}),x.createElement(gG,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},x.createElement(yG,{label:e.label,labelRef:e.labelRef}),e.children)))}),b6=x.forwardRef((e,t)=>{var r=Aa(e,Wd);return x.createElement(VCe,I0({},r,{ref:t}))});b6.displayName="CartesianAxis";var GCe=["x1","y1","x2","y2","key"],KCe=["offset"],YCe=["xAxisId","yAxisId"],XCe=["xAxisId","yAxisId"];function uF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Fo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uF(Object(r),!0).forEach(function(n){QCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QCe(e,t,r){return(t=JCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JCe(e){var t=ZCe(e,"string");return typeof t=="symbol"?t:t+""}function ZCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zh(){return Zh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zh.apply(null,arguments)}function Hw(e,t){if(e==null)return{};var r,n,i=eEe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function eEe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var tEe=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:i,width:s,height:o,ry:l}=e;return x.createElement("rect",{x:n,y:i,ry:l,width:s,height:o,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function qG(e){var{option:t,lineItemProps:r}=e,n;if(x.isValidElement(t))n=x.cloneElement(t,r);else if(typeof t=="function")n=t(r);else{var i,{x1:s,y1:o,x2:l,y2:c,key:u}=r,d=Hw(r,GCe),f=(i=ol(d))!==null&&i!==void 0?i:{},{offset:h}=f,p=Hw(f,KCe);n=x.createElement("line",Zh({},p,{x1:s,y1:o,x2:l,y2:c,fill:"none",key:u}))}return n}function rEe(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:i}=e;if(!n||!i||!i.length)return null;var{xAxisId:s,yAxisId:o}=e,l=Hw(e,YCe),c=i.map((u,d)=>{var f=Fo(Fo({},l),{},{x1:t,y1:u,x2:t+r,y2:u,key:"line-".concat(d),index:d});return x.createElement(qG,{key:"line-".concat(d),option:n,lineItemProps:f})});return x.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function nEe(e){var{y:t,height:r,vertical:n=!0,verticalPoints:i}=e;if(!n||!i||!i.length)return null;var{xAxisId:s,yAxisId:o}=e,l=Hw(e,XCe),c=i.map((u,d)=>{var f=Fo(Fo({},l),{},{x1:u,y1:t,x2:u,y2:t+r,key:"line-".concat(d),index:d});return x.createElement(qG,{option:n,lineItemProps:f,key:"line-".concat(d)})});return x.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function iEe(e){var{horizontalFill:t,fillOpacity:r,x:n,y:i,width:s,height:o,horizontalPoints:l,horizontal:c=!0}=e;if(!c||!t||!t.length||l==null)return null;var u=l.map(f=>Math.round(f+i-i)).sort((f,h)=>f-h);i!==u[0]&&u.unshift(0);var d=u.map((f,h)=>{var p=u[h+1],m=p==null,g=m?i+o-f:p-f;if(g<=0)return null;var y=h%t.length;return x.createElement("rect",{key:"react-".concat(h),y:f,x:n,height:g,width:s,stroke:"none",fill:t[y],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return x.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function aEe(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:i,y:s,width:o,height:l,verticalPoints:c}=e;if(!t||!r||!r.length)return null;var u=c.map(f=>Math.round(f+i-i)).sort((f,h)=>f-h);i!==u[0]&&u.unshift(0);var d=u.map((f,h)=>{var p=u[h+1],m=p==null,g=m?i+o-f:p-f;if(g<=0)return null;var y=h%r.length;return x.createElement("rect",{key:"react-".concat(h),x:f,y:s,width:g,height:l,stroke:"none",fill:r[y],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return x.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var sEe=(e,t)=>{var{xAxis:r,width:n,height:i,offset:s}=e;return _q(y6(Fo(Fo(Fo({},Wd),r),{},{ticks:kq(r),viewBox:{x:0,y:0,width:n,height:i}})),s.left,s.left+s.width,t)},oEe=(e,t)=>{var{yAxis:r,width:n,height:i,offset:s}=e;return _q(y6(Fo(Fo(Fo({},Wd),r),{},{ticks:kq(r),viewBox:{x:0,y:0,width:n,height:i}})),s.top,s.top+s.height,t)},lEe={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:Oa.grid};function My(e){var t=KC(),r=YC(),n=Mq(),i=Fo(Fo({},Aa(e,lEe)),{},{x:An(e.x)?e.x:n.left,y:An(e.y)?e.y:n.top,width:An(e.width)?e.width:n.width,height:An(e.height)?e.height:n.height}),{xAxisId:s,yAxisId:o,x:l,y:c,width:u,height:d,syncWithTicks:f,horizontalValues:h,verticalValues:p}=i,m=Rs(),g=yn(P=>oR(P,"xAxis",s,m)),y=yn(P=>oR(P,"yAxis",o,m));if(!sd(u)||!sd(d)||!An(l)||!An(c))return null;var b=i.verticalCoordinatesGenerator||sEe,v=i.horizontalCoordinatesGenerator||oEe,{horizontalPoints:w,verticalPoints:S}=i;if((!w||!w.length)&&typeof v=="function"){var k=h&&h.length,j=v({yAxis:y?Fo(Fo({},y),{},{ticks:k?h:y.ticks}):void 0,width:t??u,height:r??d,offset:n},k?!0:f);gw(Array.isArray(j),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof j,"]")),Array.isArray(j)&&(w=j)}if((!S||!S.length)&&typeof b=="function"){var A=p&&p.length,L=b({xAxis:g?Fo(Fo({},g),{},{ticks:A?p:g.ticks}):void 0,width:t??u,height:r??d,offset:n},A?!0:f);gw(Array.isArray(L),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof L,"]")),Array.isArray(L)&&(S=L)}return x.createElement(yo,{zIndex:i.zIndex},x.createElement("g",{className:"recharts-cartesian-grid"},x.createElement(tEe,{fill:i.fill,fillOpacity:i.fillOpacity,x:i.x,y:i.y,width:i.width,height:i.height,ry:i.ry}),x.createElement(iEe,Zh({},i,{horizontalPoints:w})),x.createElement(aEe,Zh({},i,{verticalPoints:S})),x.createElement(rEe,Zh({},i,{offset:n,horizontalPoints:w,xAxis:g,yAxis:y})),x.createElement(nEe,Zh({},i,{offset:n,verticalPoints:S,xAxis:g,yAxis:y}))))}My.displayName="CartesianGrid";var cEe={},HG=Ll({name:"errorBars",initialState:cEe,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:i}=t.payload;e[r]&&(e[r]=e[r].map(s=>s.dataKey===n.dataKey&&s.direction===n.direction?i:s))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(i=>i.dataKey!==n.dataKey||i.direction!==n.direction))}}}),{addErrorBar:IMe,replaceErrorBar:DMe,removeErrorBar:$Me}=HG.actions,uEe=HG.reducer,dEe=["children"];function fEe(e,t){if(e==null)return{};var r,n,i=hEe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function hEe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var pEe={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},mEe=x.createContext(pEe);function v6(e){var{children:t}=e,r=fEe(e,dEe);return x.createElement(mEe.Provider,{value:r},t)}function Q_(e,t){var r,n,i=yn(u=>hd(u,e)),s=yn(u=>pd(u,t)),o=(r=i==null?void 0:i.allowDataOverflow)!==null&&r!==void 0?r:Ds.allowDataOverflow,l=(n=s==null?void 0:s.allowDataOverflow)!==null&&n!==void 0?n:$s.allowDataOverflow,c=o||l;return{needClip:c,needClipX:o,needClipY:l}}function w6(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,i=x6(),{needClipX:s,needClipY:o,needClip:l}=Q_(t,r);if(!l||!i)return null;var{x:c,y:u,width:d,height:f}=i;return x.createElement("clipPath",{id:"clipPath-".concat(n)},x.createElement("rect",{x:s?c:c-d/2,y:o?u:u-f/2,width:s?d:d*2,height:o?f:f*2}))}var VG=(e,t,r,n)=>cd(e,"xAxis",t,n),GG=(e,t,r,n)=>ld(e,"xAxis",t,n),KG=(e,t,r,n)=>cd(e,"yAxis",r,n),YG=(e,t,r,n)=>ld(e,"yAxis",r,n),gEe=Qt([Pi,VG,KG,GG,YG],(e,t,r,n,i)=>ff(e,"xAxis")?zm(t,n,!1):zm(r,i,!1)),xEe=(e,t,r,n,i)=>i;function yEe(e){return e.type==="line"}var bEe=Qt([Ay,xEe],(e,t)=>e.filter(yEe).find(r=>r.id===t)),vEe=Qt([Pi,VG,KG,GG,YG,bEe,gEe,y_],(e,t,r,n,i,s,o,l)=>{var{chartData:c,dataStartIndex:u,dataEndIndex:d}=l;if(!(s==null||t==null||r==null||n==null||i==null||n.length===0||i.length===0||o==null||e!=="horizontal"&&e!=="vertical")){var{dataKey:f,data:h}=s,p;if(h!=null&&h.length>0?p=h:p=c==null?void 0:c.slice(u,d+1),p!=null)return d6e({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:i,dataKey:f,bandSize:o,displayedData:p})}});function wEe(e){var t=xh(e),r=3,n=2;if(t!=null){var{r:i,strokeWidth:s}=t,o=Number(i),l=Number(s);return(Number.isNaN(o)||o<0)&&(o=r),(Number.isNaN(l)||l<0)&&(l=n),{r:o,strokeWidth:l}}return{r,strokeWidth:n}}var SEe={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ly=x;function _Ee(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var kEe=typeof Object.is=="function"?Object.is:_Ee,jEe=Ly.useSyncExternalStore,AEe=Ly.useRef,NEe=Ly.useEffect,CEe=Ly.useMemo,EEe=Ly.useDebugValue;SEe.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var s=AEe(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=CEe(function(){function c(p){if(!u){if(u=!0,d=p,p=n(p),i!==void 0&&o.hasValue){var m=o.value;if(i(m,p))return f=m}return f=p}if(m=f,kEe(d,p))return m;var g=n(p);return i!==void 0&&i(m,g)?(d=p,m):(d=p,f=g)}var u=!1,d,f,h=r===void 0?null:r;return[function(){return c(t())},h===null?void 0:function(){return c(h())}]},[t,r,n,i]);var l=jEe(e,s[0],s[1]);return NEe(function(){o.hasValue=!0,o.value=l},[l]),EEe(l),l};function TEe(e){e()}function PEe(){let e=null,t=null;return{clear(){e=null,t=null},notify(){TEe(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const i=t={callback:r,next:null,prev:t};return i.prev?i.prev.next=i:e=i,function(){!n||e===null||(n=!1,i.next?i.next.prev=i.prev:t=i.prev,i.prev?i.prev.next=i.next:e=i.next)}}}}var dF={notify(){},get:()=>[]};function OEe(e,t){let r,n=dF,i=0,s=!1;function o(g){d();const y=n.subscribe(g);let b=!1;return()=>{b||(b=!0,y(),f())}}function l(){n.notify()}function c(){m.onStateChange&&m.onStateChange()}function u(){return s}function d(){i++,r||(r=e.subscribe(c),n=PEe())}function f(){i--,r&&i===0&&(r(),r=void 0,n.clear(),n=dF)}function h(){s||(s=!0,d())}function p(){s&&(s=!1,f())}const m={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:h,tryUnsubscribe:p,getListeners:()=>n};return m}var MEe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",LEe=MEe(),REe=()=>typeof navigator<"u"&&navigator.product==="ReactNative",FEe=REe(),BEe=()=>LEe||FEe?x.useLayoutEffect:x.useEffect,IEe=BEe();function fF(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function DEe(e,t){if(fF(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(!Object.prototype.hasOwnProperty.call(t,r[i])||!fF(e[r[i]],t[r[i]]))return!1;return!0}var cj=Symbol.for("react-redux-context"),uj=typeof globalThis<"u"?globalThis:{};function $Ee(){if(!x.createContext)return{};const e=uj[cj]??(uj[cj]=new Map);let t=e.get(x.createContext);return t||(t=x.createContext(null),e.set(x.createContext,t)),t}var UEe=$Ee();function zEe(e){const{children:t,context:r,serverState:n,store:i}=e,s=x.useMemo(()=>{const c=OEe(i);return{store:i,subscription:c,getServerState:n?()=>n:void 0}},[i,n]),o=x.useMemo(()=>i.getState(),[i]);IEe(()=>{const{subscription:c}=s;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==i.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[s,o]);const l=r||UEe;return x.createElement(l.Provider,{value:s},t)}var WEe=zEe,qEe=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function HEe(e,t){return e==null&&t==null?!0:typeof e=="number"&&typeof t=="number"?e===t||e!==e&&t!==t:e===t}function Ry(e,t){var r=new Set([...Object.keys(e),...Object.keys(t)]);for(var n of r)if(qEe.has(n)){if(e[n]==null&&t[n]==null)continue;if(!DEe(e[n],t[n]))return!1}else if(!HEe(e[n],t[n]))return!1;return!0}var VEe=["id"],GEe=["type","layout","connectNulls","needClip","shape"],KEe=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function $1(){return $1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$1.apply(null,arguments)}function hF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Gu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hF(Object(r),!0).forEach(function(n){YEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YEe(e,t,r){return(t=XEe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XEe(e){var t=QEe(e,"string");return typeof t=="symbol"?t:t+""}function QEe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function S6(e,t){if(e==null)return{};var r,n,i=JEe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function JEe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ZEe=e=>{var{dataKey:t,name:r,stroke:n,legendType:i,hide:s}=e;return[{inactive:s,dataKey:t,type:i,color:n,value:Nh(r,t),payload:e}]},e6e=x.memo(e=>{var{dataKey:t,data:r,stroke:n,strokeWidth:i,fill:s,name:o,hide:l,unit:c,tooltipType:u,id:d}=e,f={dataDefinedOnItem:r,getPosition:ip,settings:{stroke:n,strokeWidth:i,fill:s,dataKey:t,nameKey:void 0,name:Nh(o,t),hide:l,type:u,color:n,unit:c,graphicalItemId:d}};return x.createElement(K_,{tooltipEntrySettings:f})}),XG=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function t6e(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],i=0;i<t;++i)n=[...n,...r];return n}var r6e=(e,t,r)=>{var n=r.reduce((p,m)=>p+m);if(!n)return XG(t,e);for(var i=Math.floor(e/n),s=e%n,o=t-e,l=[],c=0,u=0;c<r.length;u+=(d=r[c])!==null&&d!==void 0?d:0,++c){var d,f=r[c];if(f!=null&&u+f>s){l=[...r.slice(0,c),s-u];break}}var h=l.length%2===0?[0,o]:[o];return[...t6e(r,i),...l,...h].map(p=>"".concat(p,"px")).join(", ")};function n6e(e){var{clipPathId:t,points:r,props:n}=e,{dot:i,dataKey:s,needClip:o}=n,{id:l}=n,c=S6(n,VEe),u=ol(c);return x.createElement(w3e,{points:r,dot:i,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:s,baseProps:u,needClip:o,clipPathId:t})}function i6e(e){var{showLabels:t,children:r,points:n}=e,i=x.useMemo(()=>n==null?void 0:n.map(s=>{var o,l,c={x:(o=s.x)!==null&&o!==void 0?o:0,y:(l=s.y)!==null&&l!==void 0?l:0,width:0,lowerWidth:0,upperWidth:0,height:0};return Gu(Gu({},c),{},{value:s.value,payload:s.payload,viewBox:c,parentViewBox:void 0,fill:void 0})}),[n]);return x.createElement(c6,{value:t?i:void 0},r)}function pF(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:i,props:s}=e,{type:o,layout:l,connectNulls:c,needClip:u,shape:d}=s,f=S6(s,GEe),h=Gu(Gu({},Wo(f)),{},{fill:"none",className:"recharts-line-curve",clipPath:u?"url(#clipPath-".concat(t,")"):void 0,points:n,type:o,layout:l,connectNulls:c,strokeDasharray:i??s.strokeDasharray});return x.createElement(x.Fragment,null,(n==null?void 0:n.length)>1&&x.createElement(I1,$1({shapeType:"curve",option:d},h,{pathRef:r})),x.createElement(n6e,{points:n,clipPathId:t,props:s}))}function a6e(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function s6e(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:i,longestAnimatedLengthRef:s}=e,{points:o,strokeDasharray:l,isAnimationActive:c,animationBegin:u,animationDuration:d,animationEasing:f,animateNewValues:h,width:p,height:m,onAnimationEnd:g,onAnimationStart:y}=r,b=i.current,v=pg(o,"recharts-line-"),w=x.useRef(v),[S,k]=x.useState(!1),j=!S,A=x.useCallback(()=>{typeof g=="function"&&g(),k(!1)},[g]),L=x.useCallback(()=>{typeof y=="function"&&y(),k(!0)},[y]),P=a6e(n.current),F=x.useRef(0);w.current!==v&&(F.current=s.current,w.current=v);var E=F.current;return x.createElement(i6e,{points:o,showLabels:j},r.children,x.createElement(hg,{animationId:v,begin:u,duration:d,isActive:c,easing:f,onAnimationEnd:A,onAnimationStart:L,key:v},T=>{var B=Yi(E,P+E,T),q=Math.min(B,P),U;if(c)if(l){var se="".concat(l).split(/[,\s]+/gim).map(G=>parseFloat(G));U=r6e(q,P,se)}else U=XG(P,q);else U=l==null?void 0:String(l);if(T>0&&P>0&&(i.current=o,s.current=Math.max(s.current,q)),b){var de=b.length/o.length,z=T===1?o:o.map((G,ie)=>{var Y=Math.floor(ie*de);if(b[Y]){var C=b[Y];return Gu(Gu({},G),{},{x:Yi(C.x,G.x,T),y:Yi(C.y,G.y,T)})}return h?Gu(Gu({},G),{},{x:Yi(p*2,G.x,T),y:Yi(m/2,G.y,T)}):Gu(Gu({},G),{},{x:G.x,y:G.y})});return i.current=z,x.createElement(pF,{props:r,points:z,clipPathId:t,pathRef:n,strokeDasharray:U})}return x.createElement(pF,{props:r,points:o,clipPathId:t,pathRef:n,strokeDasharray:U})}),x.createElement(P_,{label:r.label}))}function o6e(e){var{clipPathId:t,props:r}=e,n=x.useRef(null),i=x.useRef(0),s=x.useRef(null);return x.createElement(s6e,{props:r,clipPathId:t,previousPointsRef:n,longestAnimatedLengthRef:i,pathRef:s})}var l6e=(e,t)=>{var r,n;return{x:(r=e.x)!==null&&r!==void 0?r:void 0,y:(n=e.y)!==null&&n!==void 0?n:void 0,value:e.value,errorVal:Ei(e.payload,t)}};class c6e extends x.Component{render(){var{hide:t,dot:r,points:n,className:i,xAxisId:s,yAxisId:o,top:l,left:c,width:u,height:d,id:f,needClip:h,zIndex:p}=this.props;if(t)return null;var m=Si("recharts-line",i),g=f,{r:y,strokeWidth:b}=wEe(r),v=MG(r),w=y*2+b,S=h?"url(#clipPath-".concat(v?"":"dots-").concat(g,")"):void 0;return x.createElement(yo,{zIndex:p},x.createElement(ja,{className:m},h&&x.createElement("defs",null,x.createElement(w6,{clipPathId:g,xAxisId:s,yAxisId:o}),!v&&x.createElement("clipPath",{id:"clipPath-dots-".concat(g)},x.createElement("rect",{x:c-w/2,y:l-w/2,width:u+w,height:d+w}))),x.createElement(v6,{xAxisId:s,yAxisId:o,data:n,dataPointFormatter:l6e,errorBarOffset:0},x.createElement(o6e,{props:this.props,clipPathId:g}))),x.createElement(q3e,{activeDot:this.props.activeDot,points:n,mainColor:this.props.stroke,itemDataKey:this.props.dataKey,clipPath:S}))}}var QG={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:"auto",label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:Oa.line,type:"linear"};function u6e(e){var t=Aa(e,QG),{activeDot:r,animateNewValues:n,animationBegin:i,animationDuration:s,animationEasing:o,connectNulls:l,dot:c,hide:u,isAnimationActive:d,label:f,legendType:h,xAxisId:p,yAxisId:m,id:g}=t,y=S6(t,KEe),{needClip:b}=Q_(p,m),v=x6(),w=ap(),S=Rs(),k=yn(F=>vEe(F,p,m,S,g));if(w!=="horizontal"&&w!=="vertical"||k==null||v==null)return null;var{height:j,width:A,x:L,y:P}=v;return x.createElement(c6e,$1({},y,{id:g,connectNulls:l,dot:c,activeDot:r,animateNewValues:n,animationBegin:i,animationDuration:s,animationEasing:o,isAnimationActive:d,hide:u,label:f,legendType:h,xAxisId:p,yAxisId:m,points:k,layout:w,height:j,width:A,left:L,top:P,needClip:b}))}function d6e(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:i,yAxisTicks:s,dataKey:o,bandSize:l,displayedData:c}=e;return c.map((u,d)=>{var f=Ei(u,o);if(t==="horizontal"){var h=mw({axis:r,ticks:i,bandSize:l,entry:u,index:d}),p=Xi(f)?null:n.scale.map(f);return{x:h,y:p??null,value:f,payload:u}}var m=Xi(f)?null:r.scale.map(f),g=mw({axis:n,ticks:s,bandSize:l,entry:u,index:d});return m==null||g==null?null:{x:m,y:g,value:f,payload:u}}).filter(Boolean)}function f6e(e){var t=Aa(e,QG),r=Rs();return x.createElement(Y_,{id:t.id,type:"line"},n=>x.createElement(x.Fragment,null,x.createElement(m6,{legendPayload:ZEe(t)}),x.createElement(e6e,{dataKey:t.dataKey,data:t.data,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:n}),x.createElement(g6,{type:"line",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:r}),x.createElement(u6e,$1({},t,{id:n}))))}var JG=x.memo(f6e,Ry);JG.displayName="Line";function cp(e,t){var r,n;return(r=(n=e.graphicalItems.cartesianItems.find(i=>i.id===t))===null||n===void 0?void 0:n.xAxisId)!==null&&r!==void 0?r:BG}function up(e,t){var r,n;return(r=(n=e.graphicalItems.cartesianItems.find(i=>i.id===t))===null||n===void 0?void 0:n.yAxisId)!==null&&r!==void 0?r:BG}var h6e="Invariant failed";function p6e(e,t){throw new Error(h6e)}function eN(){return eN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},eN.apply(null,arguments)}function Vw(e){return x.createElement(I1,eN({shapeType:"rectangle",activeClassName:"recharts-active-bar"},e))}var m6e=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,i)=>{if(An(t))return t;var s=An(n)||Xi(n);return s?t(n,i):(s||p6e(),r)}},g6e=(e,t,r)=>r,x6e=(e,t)=>t,Fy=Qt([Ay,x6e],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),y6e=Qt([Fy],e=>e==null?void 0:e.maxBarSize),b6e=(e,t,r,n)=>n,v6e=Qt([Pi,Ay,cp,up,g6e],(e,t,r,n,i)=>t.filter(s=>e==="horizontal"?s.xAxisId===r:s.yAxisId===n).filter(s=>s.isPanorama===i).filter(s=>s.hide===!1).filter(s=>s.type==="bar")),w6e=(e,t,r)=>{var n=Pi(e),i=cp(e,t),s=up(e,t);if(!(i==null||s==null))return n==="horizontal"?VA(e,"yAxis",s,r):VA(e,"xAxis",i,r)},S6e=(e,t)=>{var r=Pi(e),n=cp(e,t),i=up(e,t);if(!(n==null||i==null))return r==="horizontal"?sR(e,"xAxis",n):sR(e,"yAxis",i)},_6e=Qt([v6e,S5e,S6e],H3e),k6e=(e,t,r)=>{var n,i,s=Fy(e,t);if(s==null)return 0;var o=cp(e,t),l=up(e,t);if(o==null||l==null)return 0;var c=Pi(e),u=XH(e),{maxBarSize:d}=s,f=Xi(d)?u:d,h,p;return c==="horizontal"?(h=cd(e,"xAxis",o,r),p=ld(e,"xAxis",o,r)):(h=cd(e,"yAxis",l,r),p=ld(e,"yAxis",l,r)),(n=(i=zm(h,p,!0))!==null&&i!==void 0?i:f)!==null&&n!==void 0?n:0},ZG=(e,t,r)=>{var n=Pi(e),i=cp(e,t),s=up(e,t);if(!(i==null||s==null)){var o,l;return n==="horizontal"?(o=cd(e,"xAxis",i,r),l=ld(e,"xAxis",i,r)):(o=cd(e,"yAxis",s,r),l=ld(e,"yAxis",s,r)),zm(o,l)}},j6e=Qt([_6e,XH,w5e,QH,k6e,ZG,y6e],X3e),A6e=(e,t,r)=>{var n=cp(e,t);if(n!=null)return cd(e,"xAxis",n,r)},N6e=(e,t,r)=>{var n=up(e,t);if(n!=null)return cd(e,"yAxis",n,r)},C6e=(e,t,r)=>{var n=cp(e,t);if(n!=null)return ld(e,"xAxis",n,r)},E6e=(e,t,r)=>{var n=up(e,t);if(n!=null)return ld(e,"yAxis",n,r)},T6e=Qt([j6e,Fy],J3e),P6e=Qt([w6e,Fy],Q3e),O6e=Qt([Ls,HC,A6e,N6e,C6e,E6e,T6e,Pi,h5e,ZG,P6e,Fy,b6e],(e,t,r,n,i,s,o,l,c,u,d,f,h)=>{var{chartData:p,dataStartIndex:m,dataEndIndex:g}=c;if(!(f==null||o==null||t==null||l!=="horizontal"&&l!=="vertical"||r==null||n==null||i==null||s==null||u==null)){var{data:y}=f,b;if(y!=null&&y.length>0?b=y:b=p==null?void 0:p.slice(m,g+1),b!=null)return sTe({layout:l,barSettings:f,pos:o,parentViewBox:t,bandSize:u,xAxis:r,yAxis:n,xAxisTicks:i,yAxisTicks:s,stackedData:d,displayedData:b,offset:e,cells:h,dataStartIndex:m})}}),M6e=["index"];function tN(){return tN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tN.apply(null,arguments)}function L6e(e,t){if(e==null)return{};var r,n,i=R6e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function R6e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var eK=x.createContext(void 0),F6e=e=>{var t=x.useContext(eK);if(t!=null)return t.stackId;if(e!=null)return mve(e)},B6e=(e,t)=>"recharts-bar-stack-clip-path-".concat(e,"-").concat(t),I6e=e=>{var t=x.useContext(eK);if(t!=null){var{stackId:r}=t;return"url(#".concat(B6e(r,e),")")}},tK=e=>{var{index:t}=e,r=L6e(e,M6e),n=I6e(t);return x.createElement(ja,tN({className:"recharts-bar-stack-layer",clipPath:n},r))},D6e=["onMouseEnter","onMouseLeave","onClick"],$6e=["value","background","tooltipPosition"],U6e=["id"],z6e=["onMouseEnter","onClick","onMouseLeave"];function nf(){return nf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nf.apply(null,arguments)}function mF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Zo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mF(Object(r),!0).forEach(function(n){W6e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function W6e(e,t,r){return(t=q6e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function q6e(e){var t=H6e(e,"string");return typeof t=="symbol"?t:t+""}function H6e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gw(e,t){if(e==null)return{};var r,n,i=V6e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function V6e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var G6e=e=>{var{dataKey:t,name:r,fill:n,legendType:i,hide:s}=e;return[{inactive:s,dataKey:t,type:i,color:n,value:Nh(r,t),payload:e}]},K6e=x.memo(e=>{var{dataKey:t,stroke:r,strokeWidth:n,fill:i,name:s,hide:o,unit:l,tooltipType:c,id:u}=e,d={dataDefinedOnItem:void 0,getPosition:ip,settings:{stroke:r,strokeWidth:n,fill:i,dataKey:t,nameKey:void 0,name:Nh(s,t),hide:o,type:c,color:i,unit:l,graphicalItemId:u}};return x.createElement(K_,{tooltipEntrySettings:d})});function Y6e(e){var t=yn(rf),{data:r,dataKey:n,background:i,allOtherBarProps:s}=e,{onMouseEnter:o,onMouseLeave:l,onClick:c}=s,u=Gw(s,D6e),d=H_(o,n,s.id),f=V_(l),h=G_(c,n,s.id);if(!i||r==null)return null;var p=xh(i);return x.createElement(yo,{zIndex:Z3e(i,Oa.barBackground)},r.map((m,g)=>{var{value:y,background:b,tooltipPosition:v}=m,w=Gw(m,$6e);if(!b)return null;var S=d(m,g),k=f(m,g),j=h(m,g),A=Zo(Zo(Zo(Zo(Zo({option:i,isActive:String(g)===t},w),{},{fill:"#eee"},b),p),dg(u,m,g)),{},{onMouseEnter:S,onMouseLeave:k,onClick:j,dataKey:n,index:g,className:"recharts-bar-background-rectangle"});return x.createElement(Vw,nf({key:"background-bar-".concat(g)},A))}))}function X6e(e){var{showLabels:t,children:r,rects:n}=e,i=n==null?void 0:n.map(s=>{var o={x:s.x,y:s.y,width:s.width,lowerWidth:s.width,upperWidth:s.width,height:s.height};return Zo(Zo({},o),{},{value:s.value,payload:s.payload,parentViewBox:s.parentViewBox,viewBox:o,fill:s.fill})});return x.createElement(c6,{value:t?i:void 0},r)}function Q6e(e){var{shape:t,activeBar:r,baseProps:n,entry:i,index:s,dataKey:o}=e,l=yn(rf),c=yn(n6),u=r&&String(s)===l&&(c==null||o===c),d=u?r:t;return u?x.createElement(yo,{zIndex:Oa.activeBar},x.createElement(tK,{index:s},x.createElement(Vw,nf({},n,{name:String(n.name)},i,{isActive:u,option:d,index:s,dataKey:o})))):x.createElement(Vw,nf({},n,{name:String(n.name)},i,{isActive:u,option:d,index:s,dataKey:o}))}function J6e(e){var{shape:t,baseProps:r,entry:n,index:i,dataKey:s}=e;return x.createElement(Vw,nf({},r,{name:String(r.name)},n,{isActive:!1,option:t,index:i,dataKey:s}))}function Z6e(e){var t,{data:r,props:n}=e,i=(t=ol(n))!==null&&t!==void 0?t:{},{id:s}=i,o=Gw(i,U6e),{shape:l,dataKey:c,activeBar:u}=n,{onMouseEnter:d,onClick:f,onMouseLeave:h}=n,p=Gw(n,z6e),m=H_(d,c,s),g=V_(h),y=G_(f,c,s);return r?x.createElement(x.Fragment,null,r.map((b,v)=>x.createElement(tK,nf({index:v,key:"rectangle-".concat(b==null?void 0:b.x,"-").concat(b==null?void 0:b.y,"-").concat(b==null?void 0:b.value,"-").concat(v),className:"recharts-bar-rectangle"},dg(p,b,v),{onMouseEnter:m(b,v),onMouseLeave:g(b,v),onClick:y(b,v)}),u?x.createElement(Q6e,{shape:l,activeBar:u,baseProps:o,entry:b,index:v,dataKey:c}):x.createElement(J6e,{shape:l,baseProps:o,entry:b,index:v,dataKey:c})))):null}function eTe(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:i,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:c,onAnimationEnd:u,onAnimationStart:d}=t,f=r.current,h=pg(t,"recharts-bar-"),[p,m]=x.useState(!1),g=!p,y=x.useCallback(()=>{typeof u=="function"&&u(),m(!1)},[u]),b=x.useCallback(()=>{typeof d=="function"&&d(),m(!0)},[d]);return x.createElement(X6e,{showLabels:g,rects:n},x.createElement(hg,{animationId:h,begin:o,duration:l,isActive:s,easing:c,onAnimationEnd:y,onAnimationStart:b,key:h},v=>{var w=v===1?n:n==null?void 0:n.map((S,k)=>{var j=f&&f[k];if(j)return Zo(Zo({},S),{},{x:Yi(j.x,S.x,v),y:Yi(j.y,S.y,v),width:Yi(j.width,S.width,v),height:Yi(j.height,S.height,v)});if(i==="horizontal"){var A=Yi(0,S.height,v),L=Yi(S.stackedBarStart,S.y,v);return Zo(Zo({},S),{},{y:L,height:A})}var P=Yi(0,S.width,v),F=Yi(S.stackedBarStart,S.x,v);return Zo(Zo({},S),{},{width:P,x:F})});return v>0&&(r.current=w??null),w==null?null:x.createElement(ja,null,x.createElement(Z6e,{props:t,data:w}))}),x.createElement(P_,{label:t.label}),t.children)}function tTe(e){var t=x.useRef(null);return x.createElement(eTe,{previousRectanglesRef:t,props:e})}var rK=0,rTe=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:Ei(e,t)}};class nTe extends x.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:i,xAxisId:s,yAxisId:o,needClip:l,background:c,id:u}=this.props;if(t||r==null)return null;var d=Si("recharts-bar",i),f=u;return x.createElement(ja,{className:d,id:u},l&&x.createElement("defs",null,x.createElement(w6,{clipPathId:f,xAxisId:s,yAxisId:o})),x.createElement(ja,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(f,")"):void 0},x.createElement(Y6e,{data:r,dataKey:n,background:c,allOtherBarProps:this.props}),x.createElement(tTe,this.props)))}}var iTe={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:rK,xAxisId:0,yAxisId:0,zIndex:Oa.bar};function aTe(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:i,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d}=e,{needClip:f}=Q_(t,r),h=ap(),p=Rs(),m=q_(e.children,lp),g=yn(v=>O6e(v,e.id,p,m));if(h!=="vertical"&&h!=="horizontal")return null;var y,b=g==null?void 0:g[0];return b==null||b.height==null||b.width==null?y=0:y=h==="vertical"?b.height/2:b.width/2,x.createElement(v6,{xAxisId:t,yAxisId:r,data:g,dataPointFormatter:rTe,errorBarOffset:y},x.createElement(nTe,nf({},e,{layout:h,needClip:f,data:g,xAxisId:t,yAxisId:r,hide:n,legendType:i,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d})))}function sTe(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:i,bandSize:s,xAxis:o,yAxis:l,xAxisTicks:c,yAxisTicks:u,stackedData:d,displayedData:f,offset:h,cells:p,parentViewBox:m,dataStartIndex:g}=e,y=t==="horizontal"?l:o,b=d?y.scale.domain():null,v=gve({numericAxis:y}),w=y.scale.map(v);return f.map((S,k)=>{var j,A,L,P,F,E;if(d){var T=d[k+g];if(T==null)return null;j=uve(T,b)}else j=Ei(S,r),Array.isArray(j)||(j=[v,j]);var B=m6e(n,rK)(j[1],k);if(t==="horizontal"){var q,U=l.scale.map(j[0]),se=l.scale.map(j[1]);if(U==null||se==null)return null;A=hL({axis:o,ticks:c,bandSize:s,offset:i.offset,entry:S,index:k}),L=(q=se??U)!==null&&q!==void 0?q:void 0,P=i.size;var de=U-se;if(F=ad(de)?0:de,E={x:A,y:h.top,width:P,height:h.height},Math.abs(B)>0&&Math.abs(F)<Math.abs(B)){var z=Ks(F||B)*(Math.abs(B)-Math.abs(F));L-=z,F+=z}}else{var G=o.scale.map(j[0]),ie=o.scale.map(j[1]);if(G==null||ie==null)return null;if(A=G,L=hL({axis:l,ticks:u,bandSize:s,offset:i.offset,entry:S,index:k}),P=ie-G,F=i.size,E={x:h.left,y:L,width:h.width,height:F},Math.abs(B)>0&&Math.abs(P)<Math.abs(B)){var Y=Ks(P||B)*(Math.abs(B)-Math.abs(P));P+=Y}}if(A==null||L==null||P==null||F==null)return null;var C=Zo(Zo({},S),{},{stackedBarStart:w,x:A,y:L,width:P,height:F,value:d?j:j[1],payload:S,background:E,tooltipPosition:{x:A+P/2,y:L+F/2},parentViewBox:m},p&&p[k]&&p[k].props);return C}).filter(Boolean)}function oTe(e){var t=Aa(e,iTe),r=F6e(t.stackId),n=Rs();return x.createElement(Y_,{id:t.id,type:"bar"},i=>x.createElement(x.Fragment,null,x.createElement(m6,{legendPayload:G6e(t)}),x.createElement(K6e,{dataKey:t.dataKey,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:i}),x.createElement(g6,{type:"bar",id:i,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:r,hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:n}),x.createElement(yo,{zIndex:t.zIndex},x.createElement(aTe,nf({},t,{id:i})))))}var Dx=x.memo(oTe,Ry);Dx.displayName="Bar";var lTe=["option","isActive"];function $x(){return $x=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$x.apply(null,arguments)}function cTe(e,t){if(e==null)return{};var r,n,i=uTe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function uTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function dTe(e){var{option:t,isActive:r}=e,n=cTe(e,lTe);return typeof t=="string"?x.createElement(I1,$x({option:x.createElement(zS,$x({type:t},n)),isActive:r,shapeType:"symbols"},n)):x.createElement(I1,$x({option:t,isActive:r,shapeType:"symbols"},n))}var fTe=(e,t,r,n,i,s,o)=>cd(e,"xAxis",t,o),hTe=(e,t,r,n,i,s,o)=>ld(e,"xAxis",t,o),pTe=(e,t,r,n,i,s,o)=>cd(e,"yAxis",r,o),mTe=(e,t,r,n,i,s,o)=>ld(e,"yAxis",r,o),gTe=(e,t,r,n)=>Nke(e,"zAxis",n,!1),xTe=(e,t,r,n,i)=>i,yTe=(e,t,r,n,i,s)=>s,bTe=(e,t,r,n,i,s,o)=>y_(e,void 0,void 0,o),vTe=Qt([Ay,xTe],(e,t)=>e.filter(r=>r.type==="scatter").find(r=>r.id===t)),wTe=Qt([bTe,fTe,hTe,pTe,mTe,gTe,vTe,yTe],(e,t,r,n,i,s,o,l)=>{var{chartData:c,dataStartIndex:u,dataEndIndex:d}=e;if(o!=null){var f;if((o==null?void 0:o.data)!=null&&o.data.length>0?f=o.data:f=c==null?void 0:c.slice(u,d+1),!(f==null||t==null||n==null||r==null||i==null||(r==null?void 0:r.length)===0||(i==null?void 0:i.length)===0))return RTe({displayedData:f,xAxis:t,yAxis:n,zAxis:s,scatterSettings:o,xAxisTicks:r,yAxisTicks:i,cells:l})}}),STe=["id"],_Te=["onMouseEnter","onClick","onMouseLeave"],kTe=["animationBegin","animationDuration","animationEasing","hide","isAnimationActive","legendType","lineJointType","lineType","shape","xAxisId","yAxisId","zAxisId"];function rN(e,t){if(e==null)return{};var r,n,i=jTe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function jTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function D0(){return D0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},D0.apply(null,arguments)}function gF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function jl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gF(Object(r),!0).forEach(function(n){ATe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ATe(e,t,r){return(t=NTe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NTe(e){var t=CTe(e,"string");return typeof t=="symbol"?t:t+""}function CTe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ETe=e=>{var{dataKey:t,name:r,fill:n,legendType:i,hide:s}=e;return[{inactive:s,dataKey:t,type:i,color:n,value:Nh(r,t),payload:e}]},TTe=x.memo(e=>{var{dataKey:t,points:r,stroke:n,strokeWidth:i,fill:s,name:o,hide:l,tooltipType:c,id:u}=e,d={dataDefinedOnItem:r==null?void 0:r.map(f=>f.tooltipPayload),getPosition:f=>{var h;return r==null||(h=r[Number(f)])===null||h===void 0?void 0:h.tooltipPosition},settings:{stroke:n,strokeWidth:i,fill:s,nameKey:void 0,dataKey:t,name:Nh(o,t),hide:l,type:c,color:s,unit:"",graphicalItemId:u}};return x.createElement(K_,{tooltipEntrySettings:d})});function PTe(e){var{points:t,props:r}=e,{line:n,lineType:i,lineJointType:s}=r;if(!n)return null;var o=ol(r),l=xh(n),c,u;if(i==="joint")c=t.map(y=>{var b,v;return{x:(b=y.cx)!==null&&b!==void 0?b:null,y:(v=y.cy)!==null&&v!==void 0?v:null}});else if(i==="fitting"){var{xmin:d,xmax:f,a:h,b:p}=Q1e(t),m=y=>h*y+p;c=[{x:d,y:m(d)},{x:f,y:m(f)}]}var g=jl(jl(jl({},o),{},{fill:"none",stroke:o&&o.fill},l),{},{points:c});return x.isValidElement(n)?u=x.cloneElement(n,g):typeof n=="function"?u=n(g):u=x.createElement(c_,D0({},g,{type:s})),x.createElement(ja,{className:"recharts-scatter-line",key:"recharts-scatter-line"},u)}function OTe(e){var{showLabels:t,points:r,children:n}=e,i=fg(),s=x.useMemo(()=>r==null?void 0:r.map(o=>{var l,c,u={x:(l=o.x)!==null&&l!==void 0?l:0,y:(c=o.y)!==null&&c!==void 0?c:0,width:o.width,height:o.height,lowerWidth:o.width,upperWidth:o.width};return jl(jl({},u),{},{value:void 0,payload:o.payload,viewBox:u,parentViewBox:i,fill:void 0})}),[i,r]);return x.createElement(c6,{value:t?s:void 0},n)}function MTe(e){var{points:t,allOtherScatterProps:r}=e,{shape:n,activeShape:i,dataKey:s}=r,{id:o}=r,l=rN(r,STe),c=yn(rf),{onMouseEnter:u,onClick:d,onMouseLeave:f}=r,h=rN(r,_Te),p=H_(u,s,o),m=V_(f),g=G_(d,s,o);if(!cye(t))return null;var y=ol(l);return x.createElement(x.Fragment,null,x.createElement(PTe,{points:t,props:l}),t.map((b,v)=>{var w=i!=null&&i!==!1,S=w&&c===String(v),k=w&&S?i:n,j=jl(jl(jl({},y),b),{},{index:v,[qC]:String(o)});return x.createElement(yo,{key:"symbol-".concat(b==null?void 0:b.cx,"-").concat(b==null?void 0:b.cy,"-").concat(b==null?void 0:b.size,"-").concat(v),zIndex:S?Oa.activeDot:void 0},x.createElement(ja,D0({className:"recharts-scatter-symbol"},dg(h,b,v),{onMouseEnter:p(b,v),onMouseLeave:m(b,v),onClick:g(b,v)}),x.createElement(dTe,D0({option:k,isActive:S},j))))}))}function LTe(e){var{previousPointsRef:t,props:r}=e,{points:n,isAnimationActive:i,animationBegin:s,animationDuration:o,animationEasing:l}=r,c=t.current,u=pg(r,"recharts-scatter-"),[d,f]=x.useState(!1),h=x.useCallback(()=>{f(!1)},[]),p=x.useCallback(()=>{f(!0)},[]),m=!d;return x.createElement(OTe,{showLabels:m,points:n},r.children,x.createElement(hg,{animationId:u,begin:s,duration:o,isActive:i,easing:l,onAnimationEnd:h,onAnimationStart:p,key:u},g=>{var y=g===1?n:n==null?void 0:n.map((b,v)=>{var w=c&&c[v];return w?jl(jl({},b),{},{cx:b.cx==null?void 0:Yi(w.cx,b.cx,g),cy:b.cy==null?void 0:Yi(w.cy,b.cy,g),size:Yi(w.size,b.size,g)}):jl(jl({},b),{},{size:Yi(0,b.size,g)})});return g>0&&(t.current=y),x.createElement(ja,null,x.createElement(MTe,{points:y,allOtherScatterProps:r,showLabels:m}))}),x.createElement(P_,{label:r.label}))}function RTe(e){var{displayedData:t,xAxis:r,yAxis:n,zAxis:i,scatterSettings:s,xAxisTicks:o,yAxisTicks:l,cells:c}=e,u=Xi(r.dataKey)?s.dataKey:r.dataKey,d=Xi(n.dataKey)?s.dataKey:n.dataKey,f=i&&i.dataKey,h=i?i.range:Bd.range,p=h&&h[0],m=r.scale.bandwidth?r.scale.bandwidth():0,g=n.scale.bandwidth?n.scale.bandwidth():0;return t.map((y,b)=>{var v=Ei(y,u),w=Ei(y,d),S=!Xi(f)&&Ei(y,f)||"-",k=[{name:Xi(r.dataKey)?s.name:r.name||String(r.dataKey),unit:r.unit||"",value:v,payload:y,dataKey:u,type:s.tooltipType},{name:Xi(n.dataKey)?s.name:n.name||String(n.dataKey),unit:n.unit||"",value:w,payload:y,dataKey:d,type:s.tooltipType}];S!=="-"&&i!=null&&k.push({name:i.name||i.dataKey,unit:i.unit||"",value:S,payload:y,dataKey:f,type:s.tooltipType});var j=mw({axis:r,ticks:o,bandSize:m,entry:y,index:b,dataKey:u}),A=mw({axis:n,ticks:l,bandSize:g,entry:y,index:b,dataKey:d}),L=S!=="-"&&i!=null?i.scale.map(S):p,P=L==null?0:Math.sqrt(Math.max(L,0)/Math.PI);return jl(jl({},y),{},{cx:j,cy:A,x:j==null?void 0:j-P,y:A==null?void 0:A-P,width:2*P,height:2*P,size:L,node:{x:v,y:w,z:S},tooltipPayload:k,tooltipPosition:{x:j,y:A},payload:y},c&&c[b]&&c[b].props)})}var FTe=(e,t,r)=>({x:e.cx,y:e.cy,value:Number(r==="x"?e.node.x:e.node.y),errorVal:Ei(e,t)});function BTe(e){var{hide:t,points:r,className:n,needClip:i,xAxisId:s,yAxisId:o,id:l}=e,c=x.useRef(null);if(t)return null;var u=Si("recharts-scatter",n),d=l;return x.createElement(yo,{zIndex:e.zIndex},x.createElement(ja,{className:u,clipPath:i?"url(#clipPath-".concat(d,")"):void 0,id:l},i&&x.createElement("defs",null,x.createElement(w6,{clipPathId:d,xAxisId:s,yAxisId:o})),x.createElement(v6,{xAxisId:s,yAxisId:o,data:r,dataPointFormatter:FTe,errorBarOffset:0},x.createElement(ja,{key:"recharts-scatter-symbols"},x.createElement(LTe,{props:e,previousPointsRef:c})))))}var nK={xAxisId:0,yAxisId:0,zAxisId:0,label:!1,line:!1,legendType:"circle",lineType:"joint",lineJointType:"linear",shape:"circle",hide:!1,isAnimationActive:"auto",animationBegin:0,animationDuration:400,animationEasing:"linear",zIndex:Oa.scatter};function ITe(e){var t=Aa(e,nK),{animationBegin:r,animationDuration:n,animationEasing:i,hide:s,isAnimationActive:o,legendType:l,lineJointType:c,lineType:u,shape:d,xAxisId:f,yAxisId:h,zAxisId:p}=t,m=rN(t,kTe),{needClip:g}=Q_(f,h),y=x.useMemo(()=>q_(e.children,lp),[e.children]),b=Rs(),v=yn(w=>wTe(w,f,h,p,e.id,y,b));return g==null||v==null?null:x.createElement(x.Fragment,null,x.createElement(TTe,{dataKey:e.dataKey,points:v,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType,id:e.id}),x.createElement(BTe,D0({},m,{xAxisId:f,yAxisId:h,zAxisId:p,lineType:u,lineJointType:c,legendType:l,shape:d,hide:s,isAnimationActive:o,animationBegin:r,animationDuration:n,animationEasing:i,points:v,needClip:g})))}function DTe(e){var t=Aa(e,nK),r=Rs();return x.createElement(Y_,{id:t.id,type:"scatter"},n=>x.createElement(x.Fragment,null,x.createElement(m6,{legendPayload:ETe(t)}),x.createElement(g6,{type:"scatter",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:t.zAxisId,dataKey:t.dataKey,hide:t.hide,name:t.name,tooltipType:t.tooltipType,isPanorama:r}),x.createElement(ITe,D0({},t,{id:n}))))}var iK=x.memo(DTe,Ry);iK.displayName="Scatter";var $Te=["domain","range"],UTe=["domain","range"];function xF(e,t){if(e==null)return{};var r,n,i=zTe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function zTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function yF(e,t){return e===t?!0:Array.isArray(e)&&e.length===2&&Array.isArray(t)&&t.length===2?e[0]===t[0]&&e[1]===t[1]:!1}function aK(e,t){if(e===t)return!0;var{domain:r,range:n}=e,i=xF(e,$Te),{domain:s,range:o}=t,l=xF(t,UTe);return!yF(r,s)||!yF(n,o)?!1:Ry(i,l)}var WTe=["type"],qTe=["dangerouslySetInnerHTML","ticks","scale"],HTe=["id","scale"];function nN(){return nN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nN.apply(null,arguments)}function bF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function vF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bF(Object(r),!0).forEach(function(n){VTe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VTe(e,t,r){return(t=GTe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GTe(e){var t=KTe(e,"string");return typeof t=="symbol"?t:t+""}function KTe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function iN(e,t){if(e==null)return{};var r,n,i=YTe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function YTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function XTe(e){var t=Ji(),r=x.useRef(null),n=Lq(),{type:i}=e,s=iN(e,WTe),o=v_(n,"xAxis",i),l=x.useMemo(()=>{if(o!=null)return vF(vF({},s),{},{type:o})},[s,o]);return x.useLayoutEffect(()=>{l!=null&&(r.current===null?t(A3e(l)):r.current!==l&&t(N3e({prev:r.current,next:l})),r.current=l)},[l,t]),x.useLayoutEffect(()=>()=>{r.current&&(t(C3e(r.current)),r.current=null)},[t]),null}var QTe=e=>{var{xAxisId:t,className:r}=e,n=yn(HC),i=Rs(),s="xAxis",o=yn(b=>TV(b,s,t,i)),l=yn(b=>AV(b,t)),c=yn(b=>wke(b,t)),u=yn(b=>oV(b,t));if(l==null||c==null||u==null)return null;var{dangerouslySetInnerHTML:d,ticks:f,scale:h}=e,p=iN(e,qTe),{id:m,scale:g}=u,y=iN(u,HTe);return x.createElement(b6,nN({},p,y,{x:c.x,y:c.y,width:l.width,height:l.height,className:Si("recharts-".concat(s," ").concat(s),r),viewBox:n,ticks:o,axisType:s}))},JTe={allowDataOverflow:Ds.allowDataOverflow,allowDecimals:Ds.allowDecimals,allowDuplicatedCategory:Ds.allowDuplicatedCategory,angle:Ds.angle,axisLine:Wd.axisLine,height:Ds.height,hide:!1,includeHidden:Ds.includeHidden,interval:Ds.interval,label:!1,minTickGap:Ds.minTickGap,mirror:Ds.mirror,orientation:Ds.orientation,padding:Ds.padding,reversed:Ds.reversed,scale:Ds.scale,tick:Ds.tick,tickCount:Ds.tickCount,tickLine:Wd.tickLine,tickSize:Wd.tickSize,type:Ds.type,xAxisId:0},ZTe=e=>{var t=Aa(e,JTe);return x.createElement(x.Fragment,null,x.createElement(XTe,{allowDataOverflow:t.allowDataOverflow,allowDecimals:t.allowDecimals,allowDuplicatedCategory:t.allowDuplicatedCategory,angle:t.angle,dataKey:t.dataKey,domain:t.domain,height:t.height,hide:t.hide,id:t.xAxisId,includeHidden:t.includeHidden,interval:t.interval,minTickGap:t.minTickGap,mirror:t.mirror,name:t.name,orientation:t.orientation,padding:t.padding,reversed:t.reversed,scale:t.scale,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit}),x.createElement(QTe,t))},By=x.memo(ZTe,aK);By.displayName="XAxis";var e8e=["type"],t8e=["dangerouslySetInnerHTML","ticks","scale"],r8e=["id","scale"];function aN(){return aN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},aN.apply(null,arguments)}function wF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function SF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wF(Object(r),!0).forEach(function(n){n8e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function n8e(e,t,r){return(t=i8e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i8e(e){var t=a8e(e,"string");return typeof t=="symbol"?t:t+""}function a8e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sN(e,t){if(e==null)return{};var r,n,i=s8e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function s8e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function o8e(e){var t=Ji(),r=x.useRef(null),n=Lq(),{type:i}=e,s=sN(e,e8e),o=v_(n,"yAxis",i),l=x.useMemo(()=>{if(o!=null)return SF(SF({},s),{},{type:o})},[o,s]);return x.useLayoutEffect(()=>{l!=null&&(r.current===null?t(E3e(l)):r.current!==l&&t(T3e({prev:r.current,next:l})),r.current=l)},[l,t]),x.useLayoutEffect(()=>()=>{r.current&&(t(P3e(r.current)),r.current=null)},[t]),null}function l8e(e){var{yAxisId:t,className:r,width:n,label:i}=e,s=x.useRef(null),o=x.useRef(null),l=yn(HC),c=Rs(),u=Ji(),d="yAxis",f=yn(j=>NV(j,t)),h=yn(j=>_ke(j,t)),p=yn(j=>TV(j,d,t,c)),m=yn(j=>lV(j,t));if(x.useLayoutEffect(()=>{if(!(n!=="auto"||!f||l6(i)||x.isValidElement(i)||m==null)){var j=s.current;if(j){var A=j.getCalculatedWidth();Math.round(f.width)!==Math.round(A)&&u(R3e({id:t,width:A}))}}},[p,f,u,i,t,n,m]),f==null||h==null||m==null)return null;var{dangerouslySetInnerHTML:g,ticks:y,scale:b}=e,v=sN(e,t8e),{id:w,scale:S}=m,k=sN(m,r8e);return x.createElement(b6,aN({},v,k,{ref:s,labelRef:o,x:h.x,y:h.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:f.width,height:f.height,className:Si("recharts-".concat(d," ").concat(d),r),viewBox:l,ticks:p,axisType:d}))}var c8e={allowDataOverflow:$s.allowDataOverflow,allowDecimals:$s.allowDecimals,allowDuplicatedCategory:$s.allowDuplicatedCategory,angle:$s.angle,axisLine:Wd.axisLine,hide:!1,includeHidden:$s.includeHidden,interval:$s.interval,label:!1,minTickGap:$s.minTickGap,mirror:$s.mirror,orientation:$s.orientation,padding:$s.padding,reversed:$s.reversed,scale:$s.scale,tick:$s.tick,tickCount:$s.tickCount,tickLine:Wd.tickLine,tickSize:Wd.tickSize,type:$s.type,width:$s.width,yAxisId:0},u8e=e=>{var t=Aa(e,c8e);return x.createElement(x.Fragment,null,x.createElement(o8e,{interval:t.interval,id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:t.includeHidden,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:t.angle,minTickGap:t.minTickGap,tick:t.tick,tickFormatter:t.tickFormatter}),x.createElement(l8e,t))},Iy=x.memo(u8e,aK);Iy.displayName="YAxis";function d8e(e){var t=Ji(),r=x.useRef(null);return x.useLayoutEffect(()=>{r.current===null?t(O3e(e)):r.current!==e&&t(M3e({prev:r.current,next:e})),r.current=e},[e,t]),x.useLayoutEffect(()=>()=>{r.current&&(t(L3e(r.current)),r.current=null)},[t]),null}var f8e={zAxisId:0,range:Bd.range,scale:Bd.scale,type:Bd.type};function sK(e){var t=Aa(e,f8e);return x.createElement(d8e,{domain:t.domain,id:t.zAxisId,dataKey:t.dataKey,name:t.name,unit:t.unit,range:t.range,scale:t.scale,type:t.type,allowDuplicatedCategory:Bd.allowDuplicatedCategory,allowDataOverflow:Bd.allowDataOverflow,reversed:Bd.reversed,includeHidden:Bd.includeHidden})}sK.displayName="ZAxis";var h8e=(e,t)=>t,_6=Qt([h8e,Pi,iV,Qs,GV,xf,$je,Ls],Gje),k6=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},oK=qc("mouseClick"),lK=my();lK.startListening({actionCreator:oK,effect:(e,t)=>{var r=e.payload,n=_6(t.getState(),k6(r));(n==null?void 0:n.activeIndex)!=null&&t.dispatch(Ike({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var oN=qc("mouseMove"),cK=my(),mv=null;cK.startListening({actionCreator:oN,effect:(e,t)=>{var r=e.payload;mv!==null&&cancelAnimationFrame(mv);var n=k6(r);mv=requestAnimationFrame(()=>{var i=t.getState(),s=QE(i,i.tooltip.settings.shared);if(s==="axis"){var o=_6(i,n);(o==null?void 0:o.activeIndex)!=null?t.dispatch(IV({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate})):t.dispatch(BV())}mv=null})}});function p8e(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":e==="children"&&typeof t=="object"&&t!==null?"<<CHILDREN>>":t}var _F={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},uK=Ll({name:"rootProps",initialState:_F,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:_F.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className,e.baseValue=t.payload.baseValue,e.reverseStackOrder=t.payload.reverseStackOrder}}}),m8e=uK.reducer,{updateOptions:g8e}=uK.actions,x8e=null,y8e={updatePolarOptions:(e,t)=>t.payload},dK=Ll({name:"polarOptions",initialState:x8e,reducers:y8e}),{updatePolarOptions:b8e}=dK.actions,v8e=dK.reducer,fK=qc("keyDown"),hK=qc("focus"),j6=my();j6.startListening({actionCreator:fK,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip,s=e.payload;if(!(s!=="ArrowRight"&&s!=="ArrowLeft"&&s!=="Enter")){var o=JE(i,_g(r),Cy(r),Ty(r)),l=o==null?-1:Number(o);if(!(!Number.isFinite(l)||l<0)){var c=xf(r);if(s==="Enter"){var u=Dw(r,"axis","hover",String(i.index));t.dispatch(KA({active:!i.active,activeIndex:i.index,activeCoordinate:u}));return}var d=Cke(r),f=d==="left-to-right"?1:-1,h=s==="ArrowRight"?1:-1,p=l+h*f;if(!(c==null||p>=c.length||p<0)){var m=Dw(r,"axis","hover",String(p));t.dispatch(KA({active:!0,activeIndex:p.toString(),activeCoordinate:m}))}}}}}});j6.startListening({actionCreator:hK,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip;if(!i.active&&i.index==null){var s="0",o=Dw(r,"axis","hover",String(s));t.dispatch(KA({active:!0,activeIndex:s,activeCoordinate:o}))}}}});var Nc=qc("externalEvent"),pK=my(),dj=new Map;pK.startListening({actionCreator:Nc,effect:(e,t)=>{var{handler:r,reactEvent:n}=e.payload;if(r!=null){n.persist();var i=n.type,s=dj.get(i);s!==void 0&&cancelAnimationFrame(s);var o=requestAnimationFrame(()=>{try{var l=t.getState(),c={activeCoordinate:kje(l),activeDataKey:n6(l),activeIndex:rf(l),activeLabel:XV(l),activeTooltipIndex:rf(l),isTooltipActive:jje(l)};r(c,n)}finally{dj.delete(i)}});dj.set(i,o)}}});var w8e=Qt([wg],e=>e.tooltipItemPayloads),S8e=Qt([w8e,(e,t)=>t,(e,t,r)=>r],(e,t,r)=>{if(t!=null){var n=e.find(s=>s.settings.graphicalItemId===r);if(n!=null){var{getPosition:i}=n;if(i!=null)return i(t)}}}),mK=qc("touchMove"),gK=my();gK.startListening({actionCreator:mK,effect:(e,t)=>{var r=e.payload;if(!(r.touches==null||r.touches.length===0)){var n=t.getState(),i=QE(n,n.tooltip.settings.shared);if(i==="axis"){var s=r.touches[0];if(s==null)return;var o=_6(n,k6({clientX:s.clientX,clientY:s.clientY,currentTarget:r.currentTarget}));(o==null?void 0:o.activeIndex)!=null&&t.dispatch(IV({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if(i==="item"){var l,c=r.touches[0];if(document.elementFromPoint==null||c==null)return;var u=document.elementFromPoint(c.clientX,c.clientY);if(!u||!u.getAttribute)return;var d=u.getAttribute(Aq),f=(l=u.getAttribute(qC))!==null&&l!==void 0?l:void 0,h=Sg(n).find(g=>g.id===f);if(d==null||h==null||f==null)return;var{dataKey:p}=h,m=S8e(n,d,f);t.dispatch(FV({activeDataKey:p,activeIndex:d,activeCoordinate:m,activeGraphicalItemId:f}))}}}});var _8e=KW({brush:eCe,cartesianAxis:F3e,chartData:_4e,errorBars:uEe,graphicalItems:$Ne,layout:ave,legend:l2e,options:y4e,polarAxis:ZAe,polarOptions:v8e,referenceElements:lCe,rootProps:m8e,tooltip:Dke,zIndex:o4e}),k8e=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return Tbe({reducer:_8e,preloadedState:t,middleware:n=>{var i;return n({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((i="es6")!==null&&i!==void 0?i:"")}).concat([lK.middleware,cK.middleware,j6.middleware,pK.middleware,gK.middleware])},enhancers:n=>{var i=n;return typeof n=="function"&&(i=n()),i.concat(cq({type:"raf"}))},devTools:{serialize:{replacer:p8e},name:"recharts-".concat(r)}})};function xK(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,i=Rs(),s=x.useRef(null);if(i)return r;s.current==null&&(s.current=k8e(t,n));var o=RC;return x.createElement(WEe,{context:o,store:s.current},r)}function j8e(e){var{layout:t,margin:r}=e,n=Ji(),i=Rs();return x.useEffect(()=>{i||(n(rve(t)),n(tve(r)))},[n,i,t,r]),null}var yK=x.memo(j8e,Ry);function bK(e){var t=Ji();return x.useEffect(()=>{t(g8e(e))},[t,e]),null}function kF(e){var{zIndex:t,isPanorama:r}=e,n=x.useRef(null),i=Ji();return x.useLayoutEffect(()=>(n.current&&i(a4e({zIndex:t,element:n.current,isPanorama:r})),()=>{i(s4e({zIndex:t,isPanorama:r}))}),[i,t,r]),x.createElement("g",{tabIndex:-1,ref:n})}function jF(e){var{children:t,isPanorama:r}=e,n=yn(Yje);if(!n||n.length===0)return t;var i=n.filter(o=>o<0),s=n.filter(o=>o>0);return x.createElement(x.Fragment,null,i.map(o=>x.createElement(kF,{key:o,zIndex:o,isPanorama:r})),t,s.map(o=>x.createElement(kF,{key:o,zIndex:o,isPanorama:r})))}var A8e=["children"];function N8e(e,t){if(e==null)return{};var r,n,i=C8e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function C8e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Kw(){return Kw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Kw.apply(null,arguments)}var E8e={width:"100%",height:"100%",display:"block"},T8e=x.forwardRef((e,t)=>{var r=KC(),n=YC(),i=Vq();if(!sd(r)||!sd(n))return null;var{children:s,otherAttributes:o,title:l,desc:c}=e,u,d;return o!=null&&(typeof o.tabIndex=="number"?u=o.tabIndex:u=i?0:void 0,typeof o.role=="string"?d=o.role:d=i?"application":void 0),x.createElement(wC,Kw({},o,{title:l,desc:c,role:d,tabIndex:u,width:r,height:n,style:E8e,ref:t}),s)}),P8e=e=>{var{children:t}=e,r=yn(a_);if(!r)return null;var{width:n,height:i,y:s,x:o}=r;return x.createElement(wC,{width:n,height:i,x:o,y:s},t)},AF=x.forwardRef((e,t)=>{var{children:r}=e,n=N8e(e,A8e),i=Rs();return i?x.createElement(P8e,null,x.createElement(jF,{isPanorama:!0},r)):x.createElement(T8e,Kw({ref:t},n),x.createElement(jF,{isPanorama:!1},r))});function O8e(){var e=Ji(),[t,r]=x.useState(null),n=yn(Sve);return x.useEffect(()=>{if(t!=null){var i=t.getBoundingClientRect(),s=i.width/t.offsetWidth;pi(s)&&s!==n&&e(ive(s))}},[t,e,n]),r}function NF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function M8e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NF(Object(r),!0).forEach(function(n){L8e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function L8e(e,t,r){return(t=R8e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R8e(e){var t=F8e(e,"string");return typeof t=="symbol"?t:t+""}function F8e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oh(){return oh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},oh.apply(null,arguments)}var B8e=()=>(O4e(),null);function Yw(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var I8e=x.forwardRef((e,t)=>{var r,n,i=x.useRef(null),[s,o]=x.useState({containerWidth:Yw((r=e.style)===null||r===void 0?void 0:r.width),containerHeight:Yw((n=e.style)===null||n===void 0?void 0:n.height)}),l=x.useCallback((u,d)=>{o(f=>{var h=Math.round(u),p=Math.round(d);return f.containerWidth===h&&f.containerHeight===p?f:{containerWidth:h,containerHeight:p}})},[]),c=x.useCallback(u=>{if(typeof t=="function"&&t(u),u!=null&&typeof ResizeObserver<"u"){var{width:d,height:f}=u.getBoundingClientRect();l(d,f);var h=m=>{var g=m[0];if(g!=null){var{width:y,height:b}=g.contentRect;l(y,b)}},p=new ResizeObserver(h);p.observe(u),i.current=p}},[t,l]);return x.useEffect(()=>()=>{var u=i.current;u!=null&&u.disconnect()},[l]),x.createElement(x.Fragment,null,x.createElement(yy,{width:s.containerWidth,height:s.containerHeight}),x.createElement("div",oh({ref:c},e)))}),D8e=x.forwardRef((e,t)=>{var{width:r,height:n}=e,[i,s]=x.useState({containerWidth:Yw(r),containerHeight:Yw(n)}),o=x.useCallback((c,u)=>{s(d=>{var f=Math.round(c),h=Math.round(u);return d.containerWidth===f&&d.containerHeight===h?d:{containerWidth:f,containerHeight:h}})},[]),l=x.useCallback(c=>{if(typeof t=="function"&&t(c),c!=null){var{width:u,height:d}=c.getBoundingClientRect();o(u,d)}},[t,o]);return x.createElement(x.Fragment,null,x.createElement(yy,{width:i.containerWidth,height:i.containerHeight}),x.createElement("div",oh({ref:l},e)))}),$8e=x.forwardRef((e,t)=>{var{width:r,height:n}=e;return x.createElement(x.Fragment,null,x.createElement(yy,{width:r,height:n}),x.createElement("div",oh({ref:t},e)))}),U8e=x.forwardRef((e,t)=>{var{width:r,height:n}=e;return typeof r=="string"||typeof n=="string"?x.createElement(D8e,oh({},e,{ref:t})):typeof r=="number"&&typeof n=="number"?x.createElement($8e,oh({},e,{width:r,height:n,ref:t})):x.createElement(x.Fragment,null,x.createElement(yy,{width:r,height:n}),x.createElement("div",oh({ref:t},e)))});function z8e(e){return e?I8e:U8e}var W8e=x.forwardRef((e,t)=>{var{children:r,className:n,height:i,onClick:s,onContextMenu:o,onDoubleClick:l,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:f,onMouseUp:h,onTouchEnd:p,onTouchMove:m,onTouchStart:g,style:y,width:b,responsive:v,dispatchTouchEvents:w=!0}=e,S=x.useRef(null),k=Ji(),[j,A]=x.useState(null),[L,P]=x.useState(null),F=O8e(),E=VC(),T=(E==null?void 0:E.width)>0?E.width:b,B=(E==null?void 0:E.height)>0?E.height:i,q=x.useCallback(Q=>{F(Q),typeof t=="function"&&t(Q),A(Q),P(Q),Q!=null&&(S.current=Q)},[F,t,A,P]),U=x.useCallback(Q=>{k(oK(Q)),k(Nc({handler:s,reactEvent:Q}))},[k,s]),se=x.useCallback(Q=>{k(oN(Q)),k(Nc({handler:u,reactEvent:Q}))},[k,u]),de=x.useCallback(Q=>{k(BV()),k(Nc({handler:d,reactEvent:Q}))},[k,d]),z=x.useCallback(Q=>{k(oN(Q)),k(Nc({handler:f,reactEvent:Q}))},[k,f]),G=x.useCallback(()=>{k(hK())},[k]),ie=x.useCallback(Q=>{k(fK(Q.key))},[k]),Y=x.useCallback(Q=>{k(Nc({handler:o,reactEvent:Q}))},[k,o]),C=x.useCallback(Q=>{k(Nc({handler:l,reactEvent:Q}))},[k,l]),K=x.useCallback(Q=>{k(Nc({handler:c,reactEvent:Q}))},[k,c]),H=x.useCallback(Q=>{k(Nc({handler:h,reactEvent:Q}))},[k,h]),R=x.useCallback(Q=>{k(Nc({handler:g,reactEvent:Q}))},[k,g]),J=x.useCallback(Q=>{w&&k(mK(Q)),k(Nc({handler:m,reactEvent:Q}))},[k,w,m]),V=x.useCallback(Q=>{k(Nc({handler:p,reactEvent:Q}))},[k,p]),X=z8e(v);return x.createElement(nG.Provider,{value:j},x.createElement(Gz.Provider,{value:L},x.createElement(X,{width:T??(y==null?void 0:y.width),height:B??(y==null?void 0:y.height),className:Si("recharts-wrapper",n),style:M8e({position:"relative",cursor:"default",width:T,height:B},y),onClick:U,onContextMenu:Y,onDoubleClick:C,onFocus:G,onKeyDown:ie,onMouseDown:K,onMouseEnter:se,onMouseLeave:de,onMouseMove:z,onMouseUp:H,onTouchEnd:V,onTouchMove:J,onTouchStart:R,ref:q},x.createElement(B8e,null),r)))}),q8e=["width","height","responsive","children","className","style","compact","title","desc"];function H8e(e,t){if(e==null)return{};var r,n,i=V8e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function V8e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var vK=x.forwardRef((e,t)=>{var{width:r,height:n,responsive:i,children:s,className:o,style:l,compact:c,title:u,desc:d}=e,f=H8e(e,q8e),h=ol(f);return c?x.createElement(x.Fragment,null,x.createElement(yy,{width:r,height:n}),x.createElement(AF,{otherAttributes:h,title:u,desc:d},s)):x.createElement(W8e,{className:o,style:l,width:r,height:n,responsive:i??!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},x.createElement(AF,{otherAttributes:h,title:u,desc:d,ref:t},x.createElement(cCe,null,s)))});function lN(){return lN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lN.apply(null,arguments)}var G8e={top:5,right:5,bottom:5,left:5},K8e={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:G8e,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},A6=x.forwardRef(function(t,r){var n,i=Aa(t.categoricalChartProps,K8e),{chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,categoricalChartProps:u}=t,d={chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,eventEmitter:void 0};return x.createElement(xK,{preloadedState:{options:d},reduxStoreName:(n=u.id)!==null&&n!==void 0?n:s},x.createElement(DG,{chartData:u.data}),x.createElement(yK,{layout:i.layout,margin:i.margin}),x.createElement(bK,{baseValue:i.baseValue,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className,reverseStackOrder:i.reverseStackOrder}),x.createElement(vK,lN({},i,{ref:r})))}),Y8e=["axis"],X8e=x.forwardRef((e,t)=>x.createElement(A6,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Y8e,tooltipPayloadSearcher:E_,categoricalChartProps:e,ref:t})),Q8e=["axis","item"],wK=x.forwardRef((e,t)=>x.createElement(A6,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Q8e,tooltipPayloadSearcher:E_,categoricalChartProps:e,ref:t}));function J8e(e){var t=Ji();return x.useEffect(()=>{t(b8e(e))},[t,e]),null}var Z8e=["layout"];function cN(){return cN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cN.apply(null,arguments)}function ePe(e,t){if(e==null)return{};var r,n,i=tPe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function tPe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var rPe={top:5,right:5,bottom:5,left:5},SK={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:rPe,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},nPe=x.forwardRef(function(t,r){var n,i=Aa(t.categoricalChartProps,SK),{layout:s}=i,o=ePe(i,Z8e),{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d}=t,f={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d,eventEmitter:void 0};return x.createElement(xK,{preloadedState:{options:f},reduxStoreName:(n=i.id)!==null&&n!==void 0?n:l},x.createElement(DG,{chartData:i.data}),x.createElement(yK,{layout:s,margin:i.margin}),x.createElement(bK,{baseValue:void 0,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className,reverseStackOrder:i.reverseStackOrder}),x.createElement(J8e,{cx:i.cx,cy:i.cy,startAngle:i.startAngle,endAngle:i.endAngle,innerRadius:i.innerRadius,outerRadius:i.outerRadius}),x.createElement(vK,cN({},o,{ref:r})))});function CF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function EF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CF(Object(r),!0).forEach(function(n){iPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iPe(e,t,r){return(t=aPe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aPe(e){var t=sPe(e,"string");return typeof t=="symbol"?t:t+""}function sPe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oPe=["item"],lPe=EF(EF({},SK),{},{layout:"centric",startAngle:0,endAngle:360}),cPe=x.forwardRef((e,t)=>{var r=Aa(e,lPe);return x.createElement(nPe,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:oPe,tooltipPayloadSearcher:E_,categoricalChartProps:r,ref:t})}),uPe=["item"],dPe=x.forwardRef((e,t)=>x.createElement(A6,{chartName:"ScatterChart",defaultTooltipEventType:"item",validateTooltipEventTypes:uPe,tooltipPayloadSearcher:E_,categoricalChartProps:e,ref:t}));function fj(e,t){try{const r=Jn(`${t}_${e}`);if(!r)return null;if(r.rowsByStudentId&&typeof r.rowsByStudentId=="object")return r.rowsByStudentId;if(Array.isArray(r.rows)){const n={};return r.rows.forEach(i=>{n[String(i.studentId||i.id||"")]=i}),n}if(Array.isArray(r)){const n={};return r.forEach(i=>{n[String(i.studentId||i.id||"")]=i}),n}return typeof r=="object"?r:null}catch{return null}}function hj(e){if(!e)return null;for(const t of["total","mark","score","marks"])if(typeof e[t]=="number")return e[t];return null}const uN=58;function tx({title:e,subtitle:t,children:r}){return a.jsxs("div",{className:"obe-card",style:{padding:"18px 18px 14px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline",marginBottom:14},children:[a.jsx("div",{style:{fontWeight:800,fontSize:15,color:"#0f172a"},children:e}),t&&a.jsx("div",{style:{fontSize:11,color:"#94a3b8",fontWeight:600},children:t})]}),r]})}function Dy(){return a.jsxs("div",{style:{textAlign:"center",padding:"32px 0",color:"#94a3b8",fontSize:13},children:[a.jsx("svg",{width:32,height:32,viewBox:"0 0 24 24",fill:"none",stroke:"#cbd5e1",strokeWidth:1.5,style:{margin:"0 auto 6px",display:"block"},children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 3v18h18M7 16l4-5 4 3 4-6"})}),"No marks saved yet"]})}function fPe(e){const t=fj(e,"cia1_sheet"),r=fj(e,"cia2_sheet"),n=fj(e,"model_sheet"),i=new Set;return[t,r,n].forEach(s=>s&&Object.keys(s).forEach(o=>i.add(o))),Array.from(i).map(s=>{const o=t!=null&&t[s]?hj(t[s]):null,l=r!=null&&r[s]?hj(r[s]):null,c=n!=null&&n[s]?hj(n[s]):null,u=[o,l,c].filter(f=>f!==null),d=u.length?u.reduce((f,h)=>f+h,0)/u.length:null;return{id:s,cia1:o??void 0,cia2:l??void 0,model:c??void 0,avg:d??void 0}})}function hPe({students:e}){const t=e.filter(c=>typeof c.avg=="number"),r=t.length,n=t.filter(c=>(c.avg??0)>=uN).length,i=r?t.reduce((c,u)=>c+(u.avg??0),0)/r:0,s=r?Math.max(...t.map(c=>c.avg??0)):0,o=r?Math.min(...t.map(c=>c.avg??0)):0,l=[{label:"Total Students",value:r,color:"#0b74b8"},{label:"Passed",value:n,color:"#10b981"},{label:"Class Avg",value:i.toFixed(1),color:"#f59e0b"},{label:"Highest",value:s.toFixed(1),color:"#8b5cf6"},{label:"Lowest",value:o.toFixed(1),color:"#ef4444"}];return a.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:12,marginBottom:14},children:l.map(c=>a.jsxs("div",{style:{flex:"1 1 120px",background:"#fff",borderRadius:12,padding:"14px 18px",boxShadow:"0 2px 8px rgba(0,0,0,0.07)",borderLeft:`4px solid ${c.color}`},children:[a.jsx("div",{style:{fontSize:22,fontWeight:900,color:c.color},children:c.value}),a.jsx("div",{style:{fontSize:12,color:"#64748b",marginTop:2,fontWeight:600},children:c.label})]},c.label))})}function pPe({students:e}){const t=n=>{const i=n.filter(s=>typeof s=="number");return i.length?Math.round(i.reduce((s,o)=>s+o,0)/i.length*10)/10:0},r=[{name:"CIA 1",average:t(e.map(n=>n.cia1))},{name:"CIA 2",average:t(e.map(n=>n.cia2))},{name:"Model",average:t(e.map(n=>n.model))}];return e.length===0?a.jsx(Dy,{}):a.jsx(xy,{width:"100%",height:220,children:a.jsxs(X8e,{data:r,margin:{top:10,right:20,left:0,bottom:5},children:[a.jsx(My,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),a.jsx(By,{dataKey:"name",tick:{fontSize:12,fill:"#475569"}}),a.jsx(Iy,{domain:[0,100],tick:{fontSize:11,fill:"#94a3b8"}}),a.jsx(Oy,{contentStyle:{borderRadius:10,fontSize:13}}),a.jsx(JG,{type:"monotone",dataKey:"average",stroke:"#0b74b8",strokeWidth:3,dot:{r:6,fill:"#ff8c42",stroke:"#fff",strokeWidth:2},activeDot:{r:8}})]})})}const TF=["#ef4444","#f59e0b","#06b6d4","#10b981"];function mPe({students:e}){const t={"Fail (<58)":0,"5864":0,"6574":0,"75+":0};e.forEach(s=>{const o=s.avg??0;o<58?t["Fail (<58)"]+=1:o<65?t["5864"]+=1:o<75?t["6574"]+=1:t["75+"]+=1});const r=Object.entries(t).map(([s,o])=>({name:s,value:o})).filter(s=>s.value>0),n=e.filter(s=>typeof s.avg=="number").length,i=n?Math.round((n-t["Fail (<58)"])/n*100):0;return r.length===0?a.jsx(Dy,{}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{style:{textAlign:"center",marginBottom:4},children:[a.jsxs("span",{style:{fontSize:28,fontWeight:900,color:i>=75?"#10b981":"#f59e0b"},children:[i,"%"]}),a.jsx("span",{style:{fontSize:12,color:"#64748b",marginLeft:6},children:"Pass Rate"})]}),a.jsx(xy,{width:"100%",height:200,children:a.jsxs(cPe,{children:[a.jsx(FG,{data:r,cx:"50%",cy:"50%",innerRadius:50,outerRadius:80,paddingAngle:3,dataKey:"value",label:({name:s,percent:o})=>`${s} ${(o*100).toFixed(0)}%`,labelLine:!1,children:r.map((s,o)=>a.jsx(lp,{fill:TF[o%TF.length]},o))}),a.jsx(Oy,{}),a.jsx(JC,{iconType:"circle",iconSize:10})]})})]})}function gPe({students:e}){const t=[...e].filter(n=>typeof n.avg=="number").sort((n,i)=>(i.avg??0)-(n.avg??0)),r=[...t.slice(0,5).map(n=>({id:n.id.slice(-6),avg:+(n.avg??0).toFixed(1),group:"Top"})),...t.slice(-5).reverse().map(n=>({id:n.id.slice(-6),avg:+(n.avg??0).toFixed(1),group:"Bottom"}))];return r.length===0?a.jsx(Dy,{}):a.jsx(xy,{width:"100%",height:260,children:a.jsxs(wK,{data:r,layout:"vertical",margin:{top:4,right:24,left:8,bottom:4},children:[a.jsx(My,{strokeDasharray:"3 3",horizontal:!1,stroke:"#e2e8f0"}),a.jsx(By,{type:"number",domain:[0,100],tick:{fontSize:11,fill:"#94a3b8"}}),a.jsx(Iy,{dataKey:"id",type:"category",tick:{fontSize:11,fill:"#475569"},width:56}),a.jsx(Oy,{contentStyle:{borderRadius:10,fontSize:13}}),a.jsx(Dx,{dataKey:"avg",radius:[0,6,6,0],children:r.map((n,i)=>a.jsx(lp,{fill:n.group==="Top"?"#0b74b8":"#ef4444"},i))})]})})}function xPe({students:e}){const t=e.filter(r=>r.cia1!=null||r.cia2!=null||r.model!=null).slice(0,25).map(r=>({id:r.id.slice(-5),CIA1:r.cia1!=null?+r.cia1.toFixed(1):null,CIA2:r.cia2!=null?+r.cia2.toFixed(1):null,Model:r.model!=null?+r.model.toFixed(1):null}));return t.length===0?a.jsx(Dy,{}):a.jsx(xy,{width:"100%",height:240,children:a.jsxs(wK,{data:t,margin:{top:10,right:10,left:0,bottom:20},children:[a.jsx(My,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),a.jsx(By,{dataKey:"id",tick:{fontSize:9,fill:"#475569"},angle:-45,textAnchor:"end",interval:0}),a.jsx(Iy,{domain:[0,100],tick:{fontSize:10,fill:"#94a3b8"}}),a.jsx(Oy,{contentStyle:{borderRadius:10,fontSize:12}}),a.jsx(JC,{iconType:"circle",iconSize:9}),a.jsx(Dx,{dataKey:"CIA1",fill:"#0b74b8",radius:[3,3,0,0]}),a.jsx(Dx,{dataKey:"CIA2",fill:"#06b6d4",radius:[3,3,0,0]}),a.jsx(Dx,{dataKey:"Model",fill:"#f59e0b",radius:[3,3,0,0]})]})})}function yPe({students:e}){const t=e.filter(r=>r.cia1!=null&&r.cia2!=null).map(r=>({x:+(r.cia1??0).toFixed(1),y:+(r.cia2??0).toFixed(1),id:r.id}));return t.length===0?a.jsx(Dy,{}):a.jsx(xy,{width:"100%",height:220,children:a.jsxs(dPe,{margin:{top:10,right:20,left:0,bottom:10},children:[a.jsx(My,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),a.jsx(By,{type:"number",dataKey:"x",name:"CIA1",domain:[0,100],tick:{fontSize:11,fill:"#94a3b8"},label:{value:"CIA 1",position:"insideBottom",offset:-6,fontSize:11,fill:"#475569"}}),a.jsx(Iy,{type:"number",dataKey:"y",name:"CIA2",domain:[0,100],tick:{fontSize:11,fill:"#94a3b8"},label:{value:"CIA 2",angle:-90,position:"insideLeft",fontSize:11,fill:"#475569"}}),a.jsx(sK,{range:[40,40]}),a.jsx(Oy,{cursor:{strokeDasharray:"3 3"},contentStyle:{borderRadius:10,fontSize:12},content:({payload:r})=>{var n,i,s,o,l,c;return r!=null&&r.length?a.jsxs("div",{style:{background:"#fff",padding:"6px 10px",borderRadius:8,fontSize:12,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[a.jsx("div",{children:a.jsx("b",{children:(i=(n=r[0])==null?void 0:n.payload)==null?void 0:i.id})}),a.jsxs("div",{children:["CIA1: ",(o=(s=r[0])==null?void 0:s.payload)==null?void 0:o.x,"  CIA2: ",(c=(l=r[0])==null?void 0:l.payload)==null?void 0:c.y]})]}):null}}),a.jsx(ZA,{x:uN,stroke:"#ef4444",strokeDasharray:"5 3",label:{value:"Fail",fill:"#ef4444",fontSize:10}}),a.jsx(ZA,{y:uN,stroke:"#ef4444",strokeDasharray:"5 3"}),a.jsx(iK,{data:t,fill:"#0b74b8",opacity:.75})]})})}function bPe({subjectId:e}){const t=String(e||""),r=x.useMemo(()=>fPe(t),[t]);return a.jsxs("div",{style:{padding:"4px 0"},children:[a.jsx(hPe,{students:r}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(320px, 1fr))",gap:16},children:[a.jsx(tx,{title:"Trend Over Time",subtitle:"Class avg per assessment",children:a.jsx(pPe,{students:r})}),a.jsx(tx,{title:"Grade Distribution",subtitle:"Pass rate (fail < 58)",children:a.jsx(mPe,{students:r})}),a.jsx(tx,{title:"Top vs Bottom Performers",subtitle:"Avg marks (last 5 digits of ID)",children:a.jsx(gPe,{students:r})}),a.jsx(tx,{title:"CIA1 vs CIA2 Scatter",subtitle:"Each dot = one student",children:a.jsx(yPe,{students:r})}),a.jsx(tx,{title:"Per-Student Assessment Comparison",subtitle:"First 25 students  CIA1 / CIA2 / Model",children:a.jsx(xPe,{students:r})})]})]})}const vPe=["ssa1","formative1","ssa2","formative2","cia1","cia2"];function wPe({teachingAssignmentId:e,onSaved:t,onClose:r}){var E;const[n,i]=x.useState(!1),[s,o]=x.useState(!1),[l,c]=x.useState(new Set),[u,d]=x.useState(null),[f,h]=x.useState(!1),[p,m]=x.useState(null),g=x.useRef(null);x.useEffect(()=>{let T=!0;if(e)return(async()=>{i(!0);try{const B=await fm(Number(e));if(!T)return;c(new Set((B==null?void 0:B.enabled_assessments)||[])),d((B==null?void 0:B.meta)||null),m(null)}catch(B){m((B==null?void 0:B.message)||"Failed to load")}finally{T&&i(!1)}})(),()=>{T=!1}},[e]),x.useEffect(()=>{var q;if(!e||(u==null?void 0:u.mode)!=="SPECIAL_GLOBAL"||((q=u==null?void 0:u.edit_request)==null?void 0:q.status)!=="PENDING")return;let T=!1;const B=window.setInterval(async()=>{try{const U=await fm(Number(e));if(T)return;c(new Set((U==null?void 0:U.enabled_assessments)||[])),d((U==null?void 0:U.meta)||null)}catch{}},4e3);return()=>{T=!0,window.clearInterval(B)}},[e,u==null?void 0:u.mode,(E=u==null?void 0:u.edit_request)==null?void 0:E.status]);const y=!!(u!=null&&u.locked),b=(u==null?void 0:u.can_edit)!==!1,v=y&&!b,w=(u==null?void 0:u.edit_request)||null,k=String((w==null?void 0:w.status)||"").toUpperCase()==="PENDING";x.useEffect(()=>{if((u==null?void 0:u.mode)!=="SPECIAL_GLOBAL")return;const T=g.current;g.current=b,T===!1&&b===!0&&alert("IQAC approval granted. You can now edit and re-save the enabled exams.")},[b,u==null?void 0:u.mode]);const j=T=>{v||c(B=>{const q=new Set(B);return q.has(T)?q.delete(T):q.add(T),q})},A=async()=>{if(e){o(!0);try{const T=Array.from(l.values()),B=await l9(Number(e),T),q=(B==null?void 0:B.enabled_assessments)||[];c(new Set(q)),d((B==null?void 0:B.meta)||u),m(null),t&&t(q),alert("Saved enabled assessments.")}catch(T){m((T==null?void 0:T.message)||"Save failed"),alert("Save failed: "+((T==null?void 0:T.message)||""))}finally{o(!1)}}},L=async T=>{if(e){h(!0);try{const B=await c9(Number(e));d(q=>({...q||{},locked:!0,can_edit:!1,edit_request:B||{status:"PENDING"}})),alert(T?"Request is already pending. Synced status with server.":"Edit request sent to IQAC for approval.")}catch(B){m((B==null?void 0:B.message)||"Failed to request edit"),alert("Edit request failed: "+((B==null?void 0:B.message)||""))}finally{h(!1)}}},P=async()=>{await L(k),await F()},F=async()=>{if(e)try{i(!0);const T=await fm(Number(e));c(new Set((T==null?void 0:T.enabled_assessments)||[])),d((T==null?void 0:T.meta)||null),m(null)}catch(T){m((T==null?void 0:T.message)||"Failed to refresh")}finally{i(!1)}};return a.jsxs("div",{style:{border:"1px solid #e5e7eb",padding:12,borderRadius:8,background:"#ffffff",maxWidth:520},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[a.jsx("div",{style:{fontWeight:700},children:"Select Exams for this Assignment"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:(u==null?void 0:u.mode)==="SPECIAL_GLOBAL"?"Special course (global lock)":"Faculty override"})]}),(u==null?void 0:u.mode)==="SPECIAL_GLOBAL"&&y&&a.jsxs("div",{style:{fontSize:12,color:v?"#92400e":"#065f46",marginBottom:8},children:[v?"Locked after first save. Edit requires IQAC approval.":"Editing permitted (approved by IQAC/admin).",w!=null&&w.status?a.jsxs("span",{style:{marginLeft:8,color:"#6b7280"},children:["Request: ",String(w.status)]}):null]}),n?a.jsx("div",{style:{color:"#6b7280"},children:"Loading"}):a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, minmax(0,1fr))",gap:8},children:vPe.map(T=>a.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[a.jsx("input",{type:"checkbox",checked:l.has(T),onChange:()=>j(T),disabled:v||s}),a.jsx("span",{style:{textTransform:"uppercase",fontSize:13},children:T.toUpperCase()})]},T))}),p&&a.jsx("div",{style:{color:"#b91c1c",marginTop:8},children:p}),a.jsxs("div",{style:{display:"flex",gap:8,marginTop:12},children:[!v&&a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:A,disabled:s||n||!e,children:s?"Saving":"Save"}),v&&(u==null?void 0:u.mode)==="SPECIAL_GLOBAL"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn",onClick:P,disabled:f||s||n||!e,title:k?"Request already pending. Wait for IQAC approval.":void 0,children:f?"Requesting":k?"Edit Request Pending":"Edit (Request IQAC Approval)"}),a.jsx("button",{className:"obe-btn",onClick:F,disabled:s||n||!e,children:"Refresh"})]}),a.jsx("button",{className:"obe-btn",onClick:()=>r&&r(),disabled:s,children:"Close"})]})]})}function SPe({teachingAssignmentId:e}){var u,d,f;const[t,r]=x.useState([]),[n,i]=x.useState(!1);x.useEffect(()=>{let h=!0;return(async()=>{try{const p=await s9(e);if(!h)return;const m=p.filter(g=>g.teaching_assignment_id===e);r(m),m.length===0&&i(!0)}catch(p){console.error("Failed to fetch reset notifications:",p),h&&i(!0)}})(),()=>{h=!1}},[e]);const s=async()=>{if(t.length!==0)try{const h=t.map(p=>p.id);await o9(h),i(!0)}catch(h){console.error("Failed to dismiss notifications:",h),i(!0)}};if(n||t.length===0)return null;const o={ssa1:"SSA1",review1:"Review 1",ssa2:"SSA2",review2:"Review 2",cia1:"CIA1",cia2:"CIA2",formative1:"Formative 1",formative2:"Formative 2",model:"Model Exam"},c=[...new Set(t.map(h=>h.assessment))].map(h=>o[h]||h).join(", ");return a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},onClick:s,children:a.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:24,maxWidth:500,boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},onClick:h=>h.stopPropagation(),children:[a.jsx("h3",{style:{margin:0,marginBottom:12,color:"#dc2626",fontSize:18,fontWeight:800},children:" Course Reset by IQAC"}),a.jsx("p",{style:{margin:0,marginBottom:16,color:"#374151",lineHeight:1.6},children:"The following assessment(s) have been reset by the IQAC administrator:"}),a.jsxs("div",{style:{background:"#fef2f2",border:"1px solid #fecaca",borderRadius:8,padding:12,marginBottom:16},children:[a.jsxs("div",{style:{fontWeight:700,color:"#991b1b",marginBottom:6},children:[(u=t[0])==null?void 0:u.subject_code,"  ",(d=t[0])==null?void 0:d.subject_name]}),a.jsxs("div",{style:{fontSize:14,color:"#7f1d1d"},children:["Section: ",((f=t[0])==null?void 0:f.section_name)||""]}),a.jsxs("div",{style:{fontSize:14,color:"#7f1d1d",marginTop:4},children:["Assessments: ",c]})]}),a.jsx("p",{style:{margin:0,marginBottom:16,color:"#6b7280",fontSize:14},children:"All previously entered data for these assessment(s) has been cleared. You will need to re-enter the marks."}),a.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:s,style:{minWidth:80},children:"OK"})})]})})}function _Pe(e){return String(e).startsWith("cqi_")?null:e==="ssa1"?"ssa1":e==="review1"?"review1":e==="ssa2"?"ssa2":e==="review2"?"review2":e==="formative1"?"formative1":e==="formative2"?"formative2":e==="cia1"?"cia1":e==="cia2"?"cia2":e==="model"?"model":null}const rx=[{key:"dashboard",label:"Dashboard"},{key:"ssa1",label:"SSA1"},{key:"formative1",label:"Formative 1"},{key:"cia1",label:"CIA 1"},{key:"ssa2",label:"SSA2"},{key:"formative2",label:"Formative 2"},{key:"cia2",label:"CIA 2"},{key:"model",label:"MODEL"}];function kPe(e){const t=String(e||"").trim().toLowerCase();return t==="cia1_co1_co2"?{showAfter:"cia1",assessmentType:"cia1",cos:["CO1","CO2"]}:t==="cia2_co3_co4"?{showAfter:"cia2",assessmentType:"cia2",cos:["CO3","CO4"]}:t==="model_co1_co2_co3_co4_co5"?{showAfter:"model",assessmentType:"model",cos:["CO1","CO2","CO3","CO4","CO5"]}:t==="model_co3_co4_co5"?{showAfter:"model",assessmentType:"model",cos:["CO3","CO4","CO5"]}:t==="model_co5"?{showAfter:"model",assessmentType:"model",cos:["CO5"]}:null}function jPe(e){const t=Array.isArray(e)?e:[];return new Set(t.map(r=>String(r||"").trim().toLowerCase()).filter(Boolean))}function APe(e,t){const r=ti(e),n=jPe(t);if(r==="SPECIAL"){const i=new Set(["dashboard"]);return["ssa1","ssa2","formative1","formative2","cia1","cia2"].forEach(s=>{n.has(s)&&i.add(s)}),rx.filter(s=>i.has(s.key))}return r==="PRACTICAL"?rx.filter(i=>["dashboard","cia1","cia2","model"].includes(i.key)).map(i=>i.key==="cia1"?{...i,label:"CIA 1 Review"}:i.key==="cia2"?{...i,label:"CIA 2 Review"}:i.key==="model"?{...i,label:"MODEL Review"}:i):r==="PROJECT"?[{key:"dashboard",label:"Dashboard"},{key:"review1",label:"Review 1"},{key:"review2",label:"Review 2"},{key:"model",label:"MODEL Review"}]:r==="TCPR"?[{key:"dashboard",label:"Dashboard"},{key:"ssa1",label:"SSA1"},{key:"review1",label:"Review 1"},{key:"cia1",label:"CIA 1"},{key:"ssa2",label:"SSA2"},{key:"review2",label:"Review 2"},{key:"cia2",label:"CIA 2"},{key:"model",label:"MODEL"}]:r==="TCPL"?rx.map(i=>i.key==="formative1"?{...i,label:"LAB 1"}:i.key==="formative2"?{...i,label:"LAB 2"}:i):r==="LAB"?rx.filter(i=>["dashboard","cia1","cia2","model"].includes(i.key)).map(i=>i.key==="cia1"?{...i,label:"CIA 1 LAB"}:i.key==="cia2"?{...i,label:"CIA 2 LAB"}:i.key==="model"?{...i,label:"MODEL LAB"}:i):rx}function _K(e,t){return`marks_${e}_${t}`}function NPe(e,t){const r=String(t||"").trim().toLowerCase();Mu(`marks_${e}_${r}`),r==="ssa1"&&Mu(`ssa1_sheet_${e}`),r==="review1"&&Mu(`review1_sheet_${e}`),r==="ssa2"&&Mu(`ssa2_sheet_${e}`),r==="review2"&&Mu(`review2_sheet_${e}`),r==="formative1"&&Mu(`formative1_sheet_${e}`),r==="formative2"&&Mu(`formative2_sheet_${e}`),r==="cia1"&&Mu(`cia1_sheet_${e}`),r==="cia2"&&Mu(`cia2_sheet_${e}`),r==="model"&&Mu(`model_sheet_${e}`)}function CPe(e,t){const r=`studentId,mark
`,n=t.map(l=>`${String(l.studentId||"").replace(/\n/g," ")},${Number(l.mark||0)}`).join(`
`),i=new Blob([r+n],{type:"text/csv"}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function EPe({active:e,label:t,onClick:r}){return a.jsx("button",{onClick:r,className:`obe-sidebar-btn ${e?"active":""}`,children:t})}function TPe({active:e,label:t,onClick:r,isCqi:n,uniqueId:i}){return a.jsx("button",{onClick:r,className:`obe-sidebar-btn ${e?"active":""} ${n?"cqi-floating-btn":""}`,...i?{"data-cqi-id":i}:{},children:t})}function PPe({subjectId:e,tab:t}){const r=x.useMemo(()=>_K(e,t),[e,t]),[n,i]=x.useState([]);x.useEffect(()=>{const d=Jn(r)||[];i(Array.isArray(d)?d:[])},[r]);const s=()=>i(d=>[...d,{studentId:"",mark:0}]),o=(d,f,h)=>{i(p=>{const m=[...p],g=m[d]||{studentId:"",mark:0};return m[d]={...g,[f]:h},m})},l=d=>{i(f=>f.filter((h,p)=>p!==d))},c=()=>{Kn(r,n),alert("Marks saved locally.")},u=()=>{CPe(`${e}_${t}_marks.csv`,n)};return a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",gap:8,marginBottom:10,flexWrap:"wrap"},children:[a.jsx("button",{onClick:s,className:"obe-btn obe-btn-primary",children:"Add Row"}),a.jsx("button",{onClick:c,className:"obe-btn obe-btn-success",children:"Save Local"}),a.jsx("button",{onClick:u,className:"obe-btn obe-btn-secondary",disabled:!n.length,title:n.length?"Export as CSV":"Add at least one row to export",children:"Export CSV"})]}),n.length===0?a.jsx("div",{style:{color:"#6b7280",fontSize:14,padding:"12px 0"},children:"No rows yet. Click Add Row to start."}):a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:n.map((d,f)=>a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 120px 90px",gap:8,alignItems:"center"},children:[a.jsx("input",{value:d.studentId,onChange:h=>o(f,"studentId",h.target.value),placeholder:"Student ID",className:"obe-input"}),a.jsx("input",{type:"number",value:d.mark,onChange:h=>o(f,"mark",Number(h.target.value)),className:"obe-input"}),a.jsx("button",{onClick:()=>l(f),className:"obe-btn obe-btn-danger",children:"Remove"})]},f))}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Saved key: ",a.jsx("span",{style:{fontFamily:"monospace"},children:r})]})]})}function N6({subjectId:e,classType:t,questionPaperType:r,enabledAssessments:n,teachingAssignmentsOverride:i,fixedTeachingAssignmentId:s,iqacResetEnabled:o,viewerMode:l}){var ne,oe;const[c,u]=x.useState("dashboard"),d=on.useCallback(O=>{if(O!==c){try{window.dispatchEvent(new CustomEvent("obe:before-tab-switch",{detail:{from:c,to:O}}))}catch{}u(O),e&&Kn(`markEntry_activeTab_${e}`,O)}},[c,e]),[f,h]=x.useState([]),[p,m]=x.useState(null),[g,y]=x.useState(null),[b,v]=x.useState(void 0),[w,S]=x.useState(!1),[k,j]=x.useState(!1),[A,L]=x.useState(0),[P,F]=x.useState(null),E=x.useMemo(()=>_Pe(c),[c]),[T,B]=x.useState({loading:!1,enabled:!0,open:!0,error:null});x.useEffect(()=>{let O=!0;return(async()=>{if(!E){if(!O)return;B({loading:!1,enabled:!0,open:!0,error:null});return}if(O){B({loading:!0,enabled:!0,open:!0,error:null});try{const W=await S3(E,String(e||""),g??void 0);if(!O)return;const ae=(W==null?void 0:W.assessment_enabled)??!0,I=(W==null?void 0:W.assessment_open)??!0;B({loading:!1,enabled:!!ae,open:!!I,error:null})}catch(W){if(!O)return;B({loading:!1,enabled:!0,open:!0,error:(W==null?void 0:W.message)||"Failed to check exam availability"})}}})(),()=>{O=!1}},[E,e,g]);const q=E?!!T.enabled:!0,U=!!l||(E?!T.open:!1),se=x.useMemo(()=>g==null?null:(f||[]).find(O=>O.id===g)||null,[f,g]),[de,z]=x.useState(null),[G,ie]=x.useState(null);x.useEffect(()=>{let O=!0;return(async()=>{if(z(null),ie(null),g==null)return;const W=se||null,ae=String((W==null?void 0:W.class_type)||"").trim(),I=!!String((W==null?void 0:W.academic_year)||"").trim(),Z=typeof(W==null?void 0:W.semester)<"u"&&(W==null?void 0:W.semester)!=null,me=!!(W!=null&&W.department||W!=null&&W.department_name),Te=!!String((W==null?void 0:W.section_name)||"").trim();if(ae&&I&&Z&&me&&Te){z(ae);return}const Ae=String(t||"").trim();try{const Be=await Vc(Number(g));if(!O)return;const Ee=(Be==null?void 0:Be.teaching_assignment)||{},ze=String((Ee==null?void 0:Ee.class_type)||"").trim();z(ze||ae||Ae||null),ie({academic_year:(Ee==null?void 0:Ee.academic_year)||(Ee==null?void 0:Ee.academic_year_name)||(Ee==null?void 0:Ee.year)||null,semester:typeof(Ee==null?void 0:Ee.semester)<"u"?Ee==null?void 0:Ee.semester:null,department:(Ee==null?void 0:Ee.department)||(Ee==null?void 0:Ee.department_name)||null,section_name:(Ee==null?void 0:Ee.section_name)||(Ee==null?void 0:Ee.section)||null})}catch{if(!O)return;z(ae||Ae||null),ie(null)}})(),()=>{O=!1}},[g,se,t]);const Y=x.useMemo(()=>{const O=String((se==null?void 0:se.class_type)||"").trim();if(O)return O;const W=String(de||"").trim();return W||String(t||"").trim()||null},[se,de,t]),C=x.useMemo(()=>{const O=ti(Y),W=O.replace(/[^A-Z0-9]/g,"");return W.includes("TCPR")?"TCPR":W.includes("TCPL")?"TCPL":String(r||"").trim().toUpperCase()==="QP2"&&!O?"TCPR":Y},[Y,r]),K=x.useMemo(()=>ti(C),[C]);x.useEffect(()=>{let O=!0;return(async()=>{try{const W=await vS();if(!O)return;const I=(Array.isArray(W==null?void 0:W.options)?W.options:[]).map(Z=>typeof Z=="string"?String(Z||""):Z&&typeof Z=="object"&&Z.id?String(Z.id||""):"").map(Z=>Z.trim()).filter(Boolean);F({options:I,divider:Number.isFinite(Number(W==null?void 0:W.divider))?Number(W.divider):2,multiplier:Number.isFinite(Number(W==null?void 0:W.multiplier))?Number(W.multiplier):.15})}catch{if(!O)return;F(null)}})(),()=>{O=!1}},[]);const H=x.useMemo(()=>K==="SPECIAL",[K]),R=b===void 0?n:b,J=x.useMemo(()=>APe(C,R),[C,n,b]),V=x.useMemo(()=>(Array.isArray(P==null?void 0:P.options)?P.options:[]).map(W=>kPe(W)).filter(W=>!!W),[P]),X=x.useMemo(()=>{const O=[...J];return V.length&&V.forEach((W,ae)=>{var Te,Ae,Be;const I=`CQI (${W.assessmentType.toUpperCase()} ${W.cos.join(", ")})`,Z={key:`cqi_${ae}`,label:I,cqi:W},me=O.findIndex(Ee=>Ee.key===W.showAfter);if(me>=0){let Ee=me+1;for(;Ee<O.length&&String(((Te=O[Ee])==null?void 0:Te.key)||"").startsWith("cqi_")&&((Be=(Ae=O[Ee])==null?void 0:Ae.cqi)==null?void 0:Be.showAfter)===W.showAfter;)Ee+=1;O.splice(Ee,0,Z)}else O.push(Z)}),O},[J,V]);x.useEffect(()=>{if(!e)return;const O=Jn(`markEntry_activeTab_${e}`);O&&X.some(W=>W.key===O)&&u(O)},[e]),x.useEffect(()=>{X.some(O=>O.key===c)||u("dashboard")},[X,c]),x.useEffect(()=>{var ae;if(!e||!i)return;const O=(i||[]).filter(I=>String(I.subject_code)===String(e));h(O),m(null);const W=typeof s=="number"&&O.some(I=>I.id===s)&&s||(((ae=O[0])==null?void 0:ae.id)??null);y(W)},[e,i,s]),x.useEffect(()=>{let O=!0;if(!(i&&Array.isArray(i)))return(async()=>{var W;try{const ae=await fc();if(!O)return;let I=(ae||[]).filter(Te=>Te.subject_code===e);if(I.length===0)try{const Te=await xr(`/api/academics/teaching-assignments/?subject_code=${encodeURIComponent(String(e||""))}`);if(Te.ok){const Ae=await Te.json();I=(Array.isArray(Ae.results)?Ae.results:Array.isArray(Ae)?Ae:Ae.items||[])||[]}}catch(Te){console.warn("Server TA list fetch failed:",Te)}h(I),m(null);const Z=Jn(`markEntry_selectedTa_${e}`),me=typeof s=="number"&&I.some(Te=>Te.id===s)&&s||typeof Z=="number"&&I.some(Te=>Te.id===Z)&&Z||(((W=I[0])==null?void 0:W.id)??null);y(me)}catch(ae){if(!O)return;h([]),y(null),m((ae==null?void 0:ae.message)||"Failed to load teaching assignments")}})(),()=>{O=!1}},[e,i,s]),x.useEffect(()=>{e&&g!=null&&typeof s!="number"&&Kn(`markEntry_selectedTa_${e}`,g)},[e,g,s]),x.useEffect(()=>{let O=!0;if(e){if(g==null){v(void 0);return}if(!H){v(void 0);return}return(async()=>{try{const W=await fm(Number(g)),ae=W==null?void 0:W.enabled_assessments;if(!O)return;v(Array.isArray(ae)&&ae.length?ae:null)}catch(W){if(!O)return;v(void 0),m((W==null?void 0:W.message)||"Failed to load faculty enabled assessments")}})(),()=>{O=!1}}},[e,g,H]),x.useEffect(()=>{e&&Kn(`markEntry_activeTab_${e}`,c)},[e,c]);const Q=x.useMemo(()=>{if(!e)return{};const O={};for(const W of X){if(W.key==="dashboard"||String(W.key).startsWith("cqi_"))continue;if(W.key==="ssa1"){const I=Jn(`ssa1_sheet_${e}`),Z=I==null?void 0:I.rows;O[W.key]=Array.isArray(Z)?Z.length:0;continue}if(W.key==="review1"){const I=Jn(`review1_sheet_${e}`),Z=I==null?void 0:I.rows;O[W.key]=Array.isArray(Z)?Z.length:0;continue}if(W.key==="ssa2"){const I=Jn(`ssa2_sheet_${e}`),Z=I==null?void 0:I.rows;O[W.key]=Array.isArray(Z)?Z.length:0;continue}if(W.key==="review2"){const I=Jn(`review2_sheet_${e}`),Z=I==null?void 0:I.rows;O[W.key]=Array.isArray(Z)?Z.length:0;continue}if(W.key==="formative1"){const I=Jn(`formative1_sheet_${e}`),Z=I==null?void 0:I.rowsByStudentId;O[W.key]=Z&&typeof Z=="object"?Object.keys(Z).length:0;continue}if(W.key==="formative2"){const I=Jn(`formative2_sheet_${e}`),Z=I==null?void 0:I.rowsByStudentId;O[W.key]=Z&&typeof Z=="object"?Object.keys(Z).length:0;continue}if(W.key==="cia1"){const I=Jn(`cia1_sheet_${e}`),Z=I==null?void 0:I.rowsByStudentId;O[W.key]=Z&&typeof Z=="object"?Object.keys(Z).length:0;continue}if(W.key==="cia2"){const I=Jn(`cia2_sheet_${e}`),Z=I==null?void 0:I.rowsByStudentId;O[W.key]=Z&&typeof Z=="object"?Object.keys(Z).length:0;continue}if(W.key==="model"){const I=Jn(`model_sheet_${e}`),Z=I==null?void 0:I.rowsByStudentId;O[W.key]=Z&&typeof Z=="object"?Object.keys(Z).length:0;continue}const ae=Jn(_K(e,W.key))||[];O[W.key]=Array.isArray(ae)?ae.length:0}return O},[e,c,X,A]);return a.jsxs("div",{children:[g!=null&&a.jsx(SPe,{teachingAssignmentId:g}),a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-end",flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{style:{minWidth:260},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Teaching Assignment (Section)"}),f.length===0?a.jsx("div",{className:"obe-input",children:"No teaching assignments"}):a.jsxs("div",{style:{padding:"8px 10px",borderRadius:6,background:"#fff",border:"1px solid #e5e7eb"},children:[a.jsx("div",{style:{fontSize:14,fontWeight:600},children:((ne=se||f[0])==null?void 0:ne.section_name)||(G==null?void 0:G.section_name)||""}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:(()=>{var Te,Ae,Be,Ee,ze,Xe,Pt,ft;const O=se||f[0]||{},W=O.academic_year||(G==null?void 0:G.academic_year)||O.academic_year_name||O.year||"",ae=typeof O.semester<"u"&&O.semester!=null?O.semester:typeof(G==null?void 0:G.semester)<"u"?G==null?void 0:G.semester:(Te=f[0])==null?void 0:Te.semester,I=O.department||((Ae=O.section_details)==null?void 0:Ae.department)||((ze=(Ee=(Be=O.section_details)==null?void 0:Be.batch)==null?void 0:Ee.course)==null?void 0:ze.department)||(G==null?void 0:G.department)||(O.department_name?{name:O.department_name}:null)||((Xe=f[0])==null?void 0:Xe.department)||((ft=(Pt=f[0])==null?void 0:Pt.section_details)==null?void 0:ft.department),Z=(I==null?void 0:I.short_name)||(I==null?void 0:I.code)||(I==null?void 0:I.name)||O.department_name||"",me=[];return me.push(W||""),typeof ae<"u"&&ae!=null&&me.push(`Sem ${ae}`),Z&&me.push(Z),me.filter(Boolean).join("  ")})()})]}),p&&a.jsx("div",{style:{marginTop:6,fontSize:12,color:"#b91c1c"},children:p})]}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:"Student rows load from the selected section roster."}),a.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:H&&g?a.jsx("button",{className:"obe-btn",onClick:()=>S(O=>!O),children:"Show exams"}):null})]}),H&&w&&g?a.jsx("div",{style:{marginBottom:12},children:a.jsx(wPe,{teachingAssignmentId:g??void 0,onSaved:O=>{v(Array.isArray(O)&&O.length?O:null),S(!1)},onClose:()=>S(!1)})}):null,o&&E&&g!=null?a.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:10},children:a.jsx("button",{className:"obe-btn obe-btn-danger",disabled:k,onClick:async()=>{const O=E;if(window.confirm(`Reset ${O.toUpperCase()} for this section? This clears draft + published data for that exam.`))try{j(!0),await w3(O,String(e),Number(g)),NPe(String(e),String(O)),L(ae=>ae+1),alert("Reset completed.")}catch(ae){alert((ae==null?void 0:ae.message)||"Reset failed")}finally{j(!1)}},children:k?"Resetting":"Reset This Exam"})}):null,a.jsxs("div",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #e0f2fe 100%)",borderRadius:12,padding:"16px",marginBottom:20,border:"1px solid #cbd5e1",boxShadow:"0 2px 8px rgba(2,6,23,0.04), inset 0 1px 0 rgba(255,255,255,0.5)"},children:[a.jsx("div",{style:{fontSize:12,fontWeight:700,color:"#64748b",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:12},children:"Assessment Exams"}),a.jsx("div",{className:"obe-sidebar-nav","aria-label":"Mark Entry sub-tabs",style:{display:"flex",flexWrap:"wrap",gap:8},children:X.map((O,W)=>a.jsx(on.Fragment,{children:O.cqi?a.jsx(TPe,{active:c===O.key,label:O.label,onClick:()=>d(O.key),isCqi:!0,uniqueId:String(O.key)}):a.jsx(EPe,{active:c===O.key,label:O.label,onClick:()=>d(O.key)})},O.key))})]}),c==="dashboard"&&a.jsxs("div",{children:[a.jsx("h3",{style:{margin:"0 0 6px 0"},children:"Dashboard"}),a.jsxs("div",{style:{color:"#6b7280",marginBottom:12,fontSize:14},children:["Quick overview for ",a.jsx("b",{children:e}),". Use the tabs to enter marks."]}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:12},children:X.filter(O=>O.key!=="dashboard").map(O=>a.jsxs("div",{className:"obe-card",children:[a.jsx("div",{style:{fontWeight:700,color:"#0f172a"},children:O.label}),a.jsxs("div",{style:{marginTop:6,fontSize:13,color:"#6b7280"},children:["Rows saved: ",String(O.key).startsWith("cqi_")?"":Q[O.key]??0]})]},O.key))}),a.jsx("div",{style:{marginTop:14},children:a.jsx(bPe,{subjectId:e})})]}),c!=="dashboard"&&a.jsxs("div",{children:[a.jsx("h3",{style:{margin:"0 0 6px 0"},children:(oe=X.find(O=>O.key===c))==null?void 0:oe.label}),(()=>{const O=X.find(ae=>ae.key===c)||null,W=(O==null?void 0:O.cqi)||null;return a.jsx("div",{style:{color:"#6b7280",marginBottom:12,fontSize:14},children:c==="formative1"?K==="TCPL"?"Enter and manage LAB-1 marks (experiments + totals).":"Enter and manage Formative-1 assessment marks with BTL mapping.":c==="formative2"?K==="TCPL"?"Enter and manage LAB-2 marks (experiments + totals).":"Enter and manage Formative-2 assessment marks with BTL mapping.":c==="ssa1"?"SSA1 sheet-style entry (CO + BTL attainment) matching the Excel layout.":c==="review1"?"Review 1 sheet-style entry (CO + BTL attainment) matching the Excel layout.":c==="ssa2"?"SSA2 sheet-style entry (CO + BTL attainment) matching the Excel layout.":c==="review2"?"Review 2 sheet-style entry (CO + BTL attainment) matching the Excel layout.":c==="cia1"?K==="LAB"?"CIA 1 LAB entry (CO-1/CO-2 experiments + CIA exam)":K==="PRACTICAL"?"CIA 1 Review (Practical) - enter review marks for practical content.":K==="TCPR"?"CIA 1 Review (TCPR) - enter review marks for TCPR content.":"CIA 1 sheet-style entry (Q-wise + CO + BTL) matching the Excel layout.":c==="cia2"?K==="LAB"?"CIA 2 LAB entry (CO-3/CO-4/CO-5 experiments + CIA exam).":K==="PRACTICAL"?"CIA 2 Review (Practical) - enter review marks for practical content.":K==="TCPR"?"CIA 2 Review (TCPR) - enter review marks for TCPR content.":"CIA 2 sheet-style entry (Q-wise + CO + BTL) matching the Excel layout.":c==="model"?K==="LAB"?"MODEL LAB entry (CO-5 experiments + CIA exam).":K==="PRACTICAL"?"MODEL Review (Practical) - enter review marks for practical content.":K==="TCPR"?"MODEL Review (TCPR) - enter review marks for TCPR content.":"MODEL blank table template (same layout style as CIA sheets).":String(c).startsWith("cqi_")?`CQI view for ${((W==null?void 0:W.assessmentType)||"assessment").toUpperCase()} (${((W==null?void 0:W.cos)||[]).join(", ")})`:"Enter and save marks locally for this assessment."})})(),T.loading&&E?a.jsx("div",{style:{padding:"10px 0",color:"#6b7280",fontSize:13},children:"Checking availability"}):!q&&E?a.jsx("div",{style:{background:"#fff7ed",border:"1px solid #fdba7433",color:"#9a3412",padding:12,borderRadius:12,fontWeight:800},children:"This exam is disabled by IQAC. Please contact IQAC to enable it."}):a.jsx("fieldset",{disabled:!!U,style:{border:0,padding:0,margin:0},children:(()=>{const O=X.find(ae=>ae.key===c)||null,W=(O==null?void 0:O.cqi)||null;return c==="formative1"?K==="TCPL"?a.jsx(J2,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"formative1",label:"LAB 1",coA:1,coB:2,allCos:[1,2,3,4,5]}):a.jsx(Wz,{subjectId:e,teachingAssignmentId:g??void 0}):c==="formative2"?K==="TCPL"?a.jsx(J2,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"formative2",label:"LAB 2",coA:2,coB:3,allCos:[1,2,3,4,5]}):a.jsx(wxe,{subjectId:e,teachingAssignmentId:g??void 0}):c==="ssa1"?a.jsx(Hxe,{subjectId:e,teachingAssignmentId:g??void 0}):c==="review1"?a.jsx(Bxe,{subjectId:e,teachingAssignmentId:g??void 0}):c==="ssa2"?a.jsx(Qxe,{subjectId:e,teachingAssignmentId:g??void 0}):c==="review2"?a.jsx(Ixe,{subjectId:e,teachingAssignmentId:g??void 0}):c==="cia1"?K==="LAB"?a.jsx(Bx,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"cia1",label:"CIA 1 LAB",coA:1,coB:2,initialEnabledCos:[1,2],viewerMode:!!U}):K==="PROJECT"?a.jsx(Dk,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"cia1",viewerMode:!!U,classType:Y??null}):K==="PRACTICAL"?a.jsx(Ik,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"cia1",viewerMode:!!U}):a.jsx(zz,{subjectId:e,teachingAssignmentId:g??void 0,classType:Y??null,questionPaperType:r??null}):c==="cia2"?K==="LAB"?a.jsx(Bx,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"cia2",label:"CIA 2 LAB",coA:3,coB:4,initialEnabledCos:[3,4,5],viewerMode:!!U}):K==="PROJECT"?a.jsx(Dk,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"cia2",viewerMode:!!U,classType:Y??null}):K==="PRACTICAL"?a.jsx(Ik,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"cia2",viewerMode:!!U}):a.jsx(pxe,{subjectId:e,teachingAssignmentId:g??void 0,classType:Y??null,questionPaperType:r??null}):c==="model"?K==="LAB"?a.jsx(Bx,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"model",label:"MODEL LAB",coA:5,coB:null,initialEnabledCos:[5],viewerMode:!!U}):K==="PROJECT"?a.jsx(Dk,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"model",viewerMode:!!U,classType:Y??null}):K==="PRACTICAL"?a.jsx(Ik,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"model",viewerMode:!!U}):a.jsx(Fxe,{subjectId:e,teachingAssignmentId:g??void 0,classType:Y??null,questionPaperType:r??null}):String(c).startsWith("cqi_")?a.jsx(n1e,{subjectId:e,teachingAssignmentId:g??void 0,classType:Y??null,enabledAssessments:R??null,assessmentType:(W==null?void 0:W.assessmentType)||"model",cos:(W==null?void 0:W.cos)||["CO1","CO2","CO3","CO4","CO5"],cqiDivider:Number(P==null?void 0:P.divider)||2,cqiMultiplier:Number(P==null?void 0:P.multiplier)||.15}):a.jsx(PPe,{subjectId:e,tab:c})})()})]},`${c}_${A}`)]})}function OPe(){var m,g,y,b;const{courseCode:e,taId:t}=z0(),r=x.useMemo(()=>decodeURIComponent(String(e||"")).trim(),[e]),n=x.useMemo(()=>t?Number(t):NaN,[t]),[i,s]=x.useState(null),[o,l]=x.useState(null),[c,u]=x.useState(null),[d,f]=x.useState(null);x.useEffect(()=>{let v=!0;return(async()=>{if(r)try{const[w,S]=await Promise.all([Sl(),Kd()]);if(!v)return;const j=(w||[]).filter(A=>String((A==null?void 0:A.course_code)||"").trim().toUpperCase()===r.toUpperCase())[0];if(j)if(l(j!=null&&j.class_type?String(j.class_type):null),u(j!=null&&j.question_paper_type?String(j.question_paper_type):null),String((j==null?void 0:j.class_type)||"").trim().toUpperCase()==="SPECIAL"){f([]);try{const L=await bS(r);f(Array.isArray(L)?L:[])}catch{const L=j==null?void 0:j.enabled_assessments;f(Array.isArray(L)?L.map(P=>String(P).trim().toLowerCase()).filter(Boolean):[])}}else f(null);else{const A=(S||[]).find(L=>String((L==null?void 0:L.course_code)||"").trim().toUpperCase()===r.toUpperCase());l(A!=null&&A.class_type?String(A.class_type):null),u(null),f(null)}}catch{}})(),()=>{v=!1}},[r]),x.useEffect(()=>{let v=!0;return(async()=>{if(!(!r||!Number.isFinite(n)))try{const w=await M2(r);if(!v)return;const S=(w||[]).find(k=>Number(k.teaching_assignment_id)===Number(n))||null;s(S)}catch{if(!v)return;s(null)}})(),()=>{v=!1}},[r,n]);const h=x.useMemo(()=>Number.isFinite(n)?[{id:n,subject_id:0,subject_code:r,subject_name:(i==null?void 0:i.course_name)||r,section_id:(i==null?void 0:i.section_id)||0,section_name:(i==null?void 0:i.section_name)||"Section",academic_year:(i==null?void 0:i.academic_year)||""}]:[],[n,r,i]),p=ti(o);return!r||!Number.isFinite(n)?a.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[a.jsx("div",{style:{color:"#b91c1c"},children:"Invalid teaching assignment."}),a.jsx("div",{style:{marginTop:10},children:a.jsx(es,{className:"obe-btn obe-btn-secondary",to:"/iqac/academic-controller?tab=courses",children:"Back"})})]}):a.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",gap:12,flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{children:[a.jsx("h2",{style:{margin:0,fontSize:20},children:"Mark Entry Viewer"}),a.jsx("div",{style:{color:"#374151",marginTop:6,fontWeight:800},children:r}),a.jsxs("div",{style:{color:"#6b7280",marginTop:4},children:[i?`${i.section_name}  ${i.academic_year}`:"",(m=i==null?void 0:i.staff)!=null&&m.name||(g=i==null?void 0:i.staff)!=null&&g.username?`    ${((y=i.staff)==null?void 0:y.name)||((b=i.staff)==null?void 0:b.username)}`:"",p?`    ${p}`:""]})]}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:a.jsx(es,{className:"obe-btn obe-btn-secondary",to:`/iqac/academic-controller/course/${encodeURIComponent(r)}`,children:"Back"})})]}),a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:a.jsx(N6,{subjectId:r,classType:o,questionPaperType:c,enabledAssessments:d,teachingAssignmentsOverride:h,fixedTeachingAssignmentId:n,iqacResetEnabled:!0,viewerMode:!1})})]})}function MPe(e){return e==="-"||e===null||e===void 0||e===""?" - ":String(e)}function Pp(e,t){const r=Math.pow(10,t);return Math.round((e+Number.EPSILON)*r)/r}function dN({headers:e,rows:t}){return a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:10},children:a.jsxs("table",{style:{borderCollapse:"collapse",width:"100%",minWidth:900},children:[a.jsx("thead",{children:a.jsx("tr",{children:e.map(r=>a.jsx("th",{style:{textAlign:"left",fontSize:12,color:"#111827",background:"#f9fafb",padding:"10px 10px",borderBottom:"1px solid #e5e7eb",whiteSpace:"nowrap"},children:r},r))})}),a.jsx("tbody",{children:t.map((r,n)=>a.jsx("tr",{children:r.map((i,s)=>a.jsx("td",{style:{padding:"8px 10px",borderBottom:"1px solid #f3f4f6",fontSize:12,color:"#111827",whiteSpace:s===3?"normal":"nowrap",maxWidth:s===3?360:void 0},children:MPe(i)},s))},n))})]})})}function PF({title:e,headers:t,rows:r,collapsedByDefault:n=!1,showToggle:i=!0}){const[s,o]=x.useState(!n);return a.jsxs("section",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[a.jsx("h3",{style:{margin:"6px 0 10px 0",flex:1},children:e}),i?a.jsx("button",{"aria-label":s?"Collapse table":"Expand table",onClick:()=>o(l=>!l),style:{background:"transparent",border:"none",cursor:"pointer",fontSize:18,padding:6,color:"#374151"},children:s?"":""}):null]}),s&&a.jsx(dN,{headers:t,rows:r})]})}function LPe({subjectId:e,matrix:t}){var s,o,l;if(!e)return a.jsx("div",{style:{color:"#6b7280",fontSize:13},children:"Select a course to view the Articulation Matrix."});if(!t)return a.jsxs("div",{style:{border:"1px dashed #bbb",padding:16,borderRadius:8,color:"#666"},children:["No articulation matrix loaded yet for ",a.jsx("b",{children:e}),". Upload the Excel to parse page-2."]});const r=Array.isArray(t.units)?t.units:[],n=(s=t.summaries)==null?void 0:s.co_po_summary,i=["S. No","CO Mapped","Topic No.","Topic Name",...Array.from({length:11},(c,u)=>`PO${u+1}`),...Array.from({length:3},(c,u)=>`PSO${u+1}`),"Hours"];return Array.from({length:i.length},()=>""),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[((o=t.meta)==null?void 0:o.sheet_used)&&a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["Sheet: ",a.jsx("b",{children:t.meta.sheet_used})]}),r.map(c=>{const u=(c.rows||[]).map(d=>[d.s_no,d.co_mapped,d.topic_no,d.topic_name,...d.po||[],...d.pso||[],d.hours]);return a.jsxs("section",{children:[a.jsx("h3",{style:{margin:"6px 0 10px 0"},children:c.unit}),a.jsx(dN,{headers:i,rows:u})]},c.unit)}),(()=>{const c=[],u=(f,h)=>{const p=r[f];if(!p||!Array.isArray(p.rows)||p.rows.length===0)return[h,...Array.from({length:11},()=>""),...Array.from({length:3},()=>""),""];const m=p.rows,g=m.reduce((v,w)=>{const S=Number(w.hours);return v+(Number.isFinite(S)?S:0)},0),y=[];for(let v=0;v<11;v++){const w=m.reduce((S,k)=>{const j=Number((k.po&&k.po[v])??0);return S+(Number.isFinite(j)?j:0)},0);if(g>0){const S=w/g,k=Pp(S,2);y.push(k.toFixed(2))}else y.push("")}const b=[];for(let v=0;v<3;v++){const w=m.reduce((S,k)=>{const j=Number((k.pso&&k.pso[v])??0);return S+(Number.isFinite(j)?j:0)},0);if(g>0){const S=w/g,k=Pp(S,2);b.push(k.toFixed(2))}else b.push("")}return[h,...y,...b,g||""]};for(let f=0;f<5;f++)c.push(u(f,`CO${f+1}`));const d=(()=>{const f=[];c.forEach(y=>{const b=y[0],w=y.slice(1,15).map(j=>{if(j===""||j===null||j===void 0)return"";const A=Number(String(j));if(!Number.isFinite(A))return"";const L=A*3,P=Pp(L,2);return P===0?"":P.toFixed(2)}),S=w.map(j=>j===""?null:Number(j)).filter(j=>j!==null),k=S.length?Pp(S.reduce((j,A)=>j+A,0)/S.length,2).toFixed(2):"";f.push([b,...w,k])});const p=[];for(let y=0;y<14;y++){const b=[];for(let v=0;v<f.length;v++){const w=f[v][1+y];if(w===""||w===null||w===void 0)continue;const S=Number(w);Number.isFinite(S)&&b.push(S)}b.length?p.push(Pp(b.reduce((v,w)=>v+w,0)/b.length,2).toFixed(2)):p.push("")}const m=f.map(y=>y[y.length-1]).filter(y=>y!=="").map(Number),g=m.length?Pp(m.reduce((y,b)=>y+b,0)/m.length,2).toFixed(2):"";return f.push(["Average",...p,g]),f})();return a.jsxs(a.Fragment,{children:[a.jsx(PF,{title:"CO  PO/PSO (Course Delivery)",headers:["COs",...Array.from({length:11},(f,h)=>`PO${h+1}`),...Array.from({length:3},(f,h)=>`PSO${h+1}`),"Course delivery"],rows:c,collapsedByDefault:!0}),a.jsx(PF,{title:"CO  PO/PSO Summary",headers:["COs",...Array.from({length:11},(f,h)=>`PO${h+1}`),...Array.from({length:3},(f,h)=>`PSO${h+1}`),"Average"],rows:d,collapsedByDefault:!1,showToggle:!1})]})})(),(l=n==null?void 0:n.rows)!=null&&l.length?a.jsxs("section",{children:[a.jsx("h3",{style:{margin:"6px 0 10px 0"},children:"CO  PO/PSO Summary"}),a.jsx(dN,{headers:["CO",...Array.from({length:11},(c,u)=>`PO${u+1}`),...Array.from({length:3},(c,u)=>`PSO${u+1}`),"Average"],rows:[...n.rows.map(c=>[c.label,...c.po,...c.pso,c.average]),...n.average?[[n.average.label,...n.average.po,...n.average.pso,n.average.average]]:[]]})]}):null]})}const Da={container:{minHeight:"100vh",background:"linear-gradient(135deg, #f5f7fa 0%, #e9ecef 100%)",padding:"2rem"},card:{maxWidth:"1400px",margin:"0 auto",background:"#ffffff",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.07), 0 1px 3px rgba(0, 0, 0, 0.06)",overflow:"hidden"},header:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"2rem 2.5rem",borderBottom:"1px solid #e5e7eb"},title:{fontSize:"1.875rem",fontWeight:"700",color:"#ffffff",margin:"0",letterSpacing:"-0.025em"},subtitle:{fontSize:"0.95rem",color:"rgba(255, 255, 255, 0.9)",marginTop:"0.5rem",fontWeight:"400"},content:{padding:"2rem 2.5rem"},inputSection:{marginBottom:"1.5rem",padding:"1.25rem",background:"#f9fafb",borderRadius:"8px",border:"1px solid #e5e7eb"},label:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem",textTransform:"uppercase",letterSpacing:"0.025em"},input:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"2px solid #e5e7eb",borderRadius:"6px",outline:"none",transition:"all 0.2s ease",fontFamily:"inherit"},inputFocus:{borderColor:"#667eea",boxShadow:"0 0 0 3px rgba(102, 126, 234, 0.1)"},actionBar:{display:"flex",gap:"1rem",alignItems:"center",flexWrap:"wrap",marginBottom:"1.5rem",padding:"1.25rem",background:"#f9fafb",borderRadius:"8px"},button:{padding:"0.75rem 1.5rem",fontSize:"0.95rem",fontWeight:"600",color:"#ffffff",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:"6px",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 2px 4px rgba(102, 126, 234, 0.3)",outline:"none"},buttonHover:{transform:"translateY(-1px)",boxShadow:"0 4px 8px rgba(102, 126, 234, 0.4)"},buttonDisabled:{background:"#9ca3af",cursor:"not-allowed",boxShadow:"none",opacity:.6},infoText:{fontSize:"0.875rem",color:"#6b7280",display:"flex",alignItems:"center",gap:"0.5rem"},infoIcon:{width:"16px",height:"16px",borderRadius:"50%",background:"#667eea",color:"#ffffff",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:"700"},alert:{padding:"1rem 1.25rem",borderRadius:"8px",fontSize:"0.925rem",marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.75rem",fontWeight:"500"},alertSuccess:{background:"#d1fae5",color:"#065f46",border:"1px solid #6ee7b7"},alertError:{background:"#fee2e2",color:"#991b1b",border:"1px solid #fca5a5"},matrixContainer:{background:"#ffffff",borderRadius:"8px",border:"1px solid #e5e7eb",padding:"1.5rem",minHeight:"200px"},loadingSpinner:{display:"inline-block",width:"14px",height:"14px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTop:"2px solid #ffffff",borderRadius:"50%",animation:"spin 0.6s linear infinite",marginRight:"0.5rem"}};function RPe({courseId:e,embedded:t=!1}){const[r,n]=x.useState(e||""),[i,s]=x.useState(null),[o,l]=x.useState("idle"),[c,u]=x.useState(null),[d,f]=x.useState(!1),[h,p]=x.useState(!1);async function m(v){if(v){try{const w=new URLSearchParams(window.location.search),S=w.get("teaching_assignment_id")||w.get("teachingAssignmentId");if(S){const k=Number(S);if(Number.isFinite(k))return k}}catch{}try{const S=(await fc()||[]).find(j=>String(j==null?void 0:j.subject_code)===String(v)),k=(S==null?void 0:S.id)!=null?Number(S.id):NaN;if(Number.isFinite(k))return k}catch{}}}x.useEffect(()=>{r&&(async()=>{l("loading"),u(null);try{const v=await m(r),w=await B4(r,v);s(w),l("success")}catch(v){s(null),l("error"),u((v==null?void 0:v.message)||"Articulation Matrix fetch failed.")}})()},[r]);async function g(){if(r){l("loading"),u(null);try{const v=await m(r),w=await B4(r,v);s(w),l("success");const S=Array.isArray(w==null?void 0:w.units)?w.units.length:0;u(`Loaded articulation matrix from saved CDAP. Units: ${S}.`)}catch(v){l("error"),u((v==null?void 0:v.message)||"Articulation Matrix fetch failed.")}}}const y=t?{padding:0}:Da.container,b=t?{...Da.card,maxWidth:"100%",margin:0,borderRadius:12,boxShadow:"none"}:Da.card;return a.jsxs("div",{style:y,children:[a.jsx("style",{children:`
        @keyframes spin {
          to { transform: rotate(360deg); }
        }
      `}),a.jsxs("div",{style:b,children:[!t&&a.jsxs("div",{style:Da.header,children:[a.jsx("h1",{style:Da.title,children:"Articulation Matrix"}),a.jsx("p",{style:Da.subtitle,children:r?`Course: ${r}`:"Select a course to view the articulation matrix"})]}),a.jsxs("div",{style:t?{padding:0}:Da.content,children:[!e&&a.jsxs("div",{style:Da.inputSection,children:[a.jsx("label",{style:Da.label,children:"Course ID"}),a.jsx("input",{value:r,onChange:v=>n(v.target.value),placeholder:"Enter course identifier (e.g., CS101)",style:{...Da.input,...d?Da.inputFocus:{}},onFocus:()=>f(!0),onBlur:()=>f(!1)})]}),a.jsxs("div",{style:Da.actionBar,children:[a.jsxs("button",{onClick:g,disabled:o==="loading"||!r,style:{...Da.button,...o==="loading"||!r?Da.buttonDisabled:{},...h&&o!=="loading"&&r?Da.buttonHover:{}},onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),children:[o==="loading"&&a.jsx("span",{style:Da.loadingSpinner}),o==="loading"?"Loading...":"Refresh Matrix"]}),a.jsxs("span",{style:Da.infoText,children:[a.jsx("span",{style:Da.infoIcon,children:"i"}),"Uses saved CDAP ticks + hours (no upload required)"]})]}),c&&a.jsxs("div",{style:{...Da.alert,...o==="error"?Da.alertError:Da.alertSuccess},children:[a.jsx("span",{style:{fontSize:"1.25rem"},children:o==="error"?"":""}),c]}),a.jsx("div",{style:Da.matrixContainer,children:a.jsx(LPe,{subjectId:r,matrix:i})})]})]})]})}const FPe="https://db.krgi.co.in",BPe=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":FPe;function IPe(){const e=window.localStorage.getItem("access");return e?{Authorization:`Bearer ${e}`}:{}}function DPe(e,t){if(e===401)return"Authentication required. Please login and try again.";if(e===403)return"Permission required to upload CDAP Excel files.";if(e===400)return"Invalid file. Please upload a valid CDAP Excel template.";if(e===404)return"Upload endpoint not found. Please contact admin.";const r=(t||"").trim();return r&&!r.startsWith("<")?r:`Upload failed with status ${e}. Please try again.`}function $Pe({subjectId:e,onUpload:t}){const[r,n]=x.useState(null),[i,s]=x.useState("idle"),[o,l]=x.useState(null),[c,u]=x.useState(null);async function d(){var y,b,v;if(!r){s("error"),l("Please choose an Excel file first.");return}s("uploading"),l(null);const p=new FormData;p.append("file",r),e&&p.append("subject_id",e);const m=new AbortController,g=setTimeout(()=>m.abort(),6e4);try{const w={...IPe()},S=await fetch(`${BPe}/api/obe/upload-cdap`,{method:"POST",headers:w,body:p,signal:m.signal});if(!S.ok){const L=await S.text();s("error"),l(DPe(S.status,L));return}const k=await S.json(),j={rows:Array.isArray(k==null?void 0:k.rows)?k.rows:[],textbook:((y=k==null?void 0:k.books)==null?void 0:y.textbook)??(k==null?void 0:k.textbook)??"",reference:((b=k==null?void 0:k.books)==null?void 0:b.reference)??(k==null?void 0:k.reference)??"",activeLearningOptionsByRow:((v=k==null?void 0:k.active_learning)==null?void 0:v.optionsByRow)??(k==null?void 0:k.activeLearningOptions)??[],articulationExtras:(k==null?void 0:k.articulation_extras)??{}};u(j);const A=Array.isArray(k==null?void 0:k.rows)?k.rows.length:0;A?(s("success"),l(`Upload complete. Parsed ${A} rows from the Excel file.`)):(s("success"),l("Upload completed, but no rows were parsed. Please check the Excel template format.")),t&&t({revision:j,uploadedAt:new Date().toISOString()})}catch(w){s("error"),(w==null?void 0:w.name)==="AbortError"?l("Upload timed out. The server took too long to respond. Please try again."):l((w==null?void 0:w.message)||"Upload failed. Please try again.")}finally{clearTimeout(g),s(w=>w==="uploading"?"error":w)}}function f(p,m){for(const g of m){if(p==null)continue;if(p[g]!=null)return p[g];const y=String(g).toLowerCase();for(const b of Object.keys(p||{}))if(String(b).toLowerCase()===y)return p[b]}return""}function h(p){if(!p||!Array.isArray(p.rows)||!p.rows.length)return;const m=p.rows,g=["#","Content type","PART NO.","TOPICS TO BE COVERED (SYLLBUS TOPICS)","SUB TOPICS (WHAT TO BE TAUGHT)","BT LEVEL"],y=m.map((w,S)=>{const k=f(w,["content_type","contentType","Content type","content"]),j=f(w,["part_no","partNo","PART NO","part"]),A=f(w,["topics","topics_to_be_covered","Topics","TOPICS TO BE COVERED"]),L=f(w,["sub_topics","subTopics","Sub Topics","SUB TOPICS","sub_topics_to_be_taught"]),P=f(w,["bt_level","bt","BT LEVEL","btLevel"]);return`<tr>
        <td style="padding:6px;border:1px solid #ccc;text-align:center;">${S+1}</td>
        <td style="padding:6px;border:1px solid #ccc">${String(k??"")}</td>
        <td style="padding:6px;border:1px solid #ccc">${String(j??"")}</td>
        <td style="padding:6px;border:1px solid #ccc">${String(A??"")}</td>
        <td style="padding:6px;border:1px solid #ccc">${String(L??"")}</td>
        <td style="padding:6px;border:1px solid #ccc;text-align:center;">${String(P??"")}</td>
      </tr>`}).join(`
`),b=`<!doctype html><html><head><meta charset="utf-8"><title>CDAP Export</title>
      <style>body{font-family:Arial,Helvetica,sans-serif;font-size:12px;padding:20px}table{border-collapse:collapse;width:100%}th{background:#f3f4f6;padding:8px;border:1px solid #ddd;text-align:left}td{vertical-align:top}</style>
      </head><body>
      <h2>CDAP Export</h2>
      <p>Exported rows: ${m.length}</p>
      <table>
        <thead><tr>${g.map(w=>`<th>${w}</th>`).join("")}</tr></thead>
        <tbody>
          ${y}
        </tbody>
      </table>
      </body></html>`,v=window.open("","_blank");if(!v){alert("Popup blocked  allow popups for this site to export PDF.");return}v.document.write(b),v.document.close(),v.focus(),setTimeout(()=>{v.print()},300)}return a.jsxs("div",{children:[a.jsx("div",{style:{marginBottom:8},children:a.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:p=>{var m;return n(((m=p.target.files)==null?void 0:m[0])||null)}})}),a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[a.jsx("button",{id:"cdap-upload-button",onClick:d,disabled:i==="uploading","aria-label":"Upload CDAP Excel file",title:"Upload parsed CDAP Excel",style:{background:"#1d4ed8",color:"#fff",padding:"8px 14px",borderRadius:8,border:"none",boxShadow:"0 8px 20px rgba(29,78,216,0.24)",fontWeight:600,cursor:i==="uploading"?"default":"pointer",transition:"transform 120ms ease, box-shadow 120ms ease, opacity 120ms ease",opacity:i==="uploading"?.65:1},onMouseDown:p=>{p.currentTarget.style.transform="translateY(1px)"},onMouseUp:p=>{p.currentTarget.style.transform="translateY(0)"},children:i==="uploading"?"Uploading...":"Upload Excel"}),r&&a.jsx("span",{style:{fontSize:12,color:"#555"},children:r.name})]}),i==="success"&&c&&Array.isArray(c.rows)&&c.rows.length>0&&a.jsx("div",{style:{marginTop:10},children:a.jsx("button",{onClick:()=>h(c),style:{background:"#047857",color:"#fff",padding:"8px 14px",borderRadius:8,border:"none",fontWeight:600,cursor:"pointer"},"aria-label":"Export PDF",title:"Export CDAP to PDF (will open print dialog)",children:"Export PDF"})}),o&&a.jsx("div",{style:{marginTop:8,fontSize:12,color:i==="error"?"#b91c1c":"#166534"},children:o})]})}const OF=[{key:"unit",label:"UNIT",type:"text"},{key:"unit_name",label:"SYLLABUS (UNIT NAME)",type:"text"},{key:"co",label:"OUTCOME (WRITE THE CO)",type:"text"},{key:"content_type",label:"Content type",type:"text"},{key:"part_no",label:"PART NO.",type:"text"},{key:"topics",label:"TOPICS TO BE COVERED (SYLLBUS TOPICS)",type:"text"},{key:"sub_topics",label:"SUB TOPICS (WHAT TO BE TAUGHT)",type:"text"},{key:"bt_level",label:"BT LEVEL",type:"text"}],MF=Array.from({length:11},(e,t)=>({key:`po${t+1}`,label:`PO${t+1}`,type:"checkbox",group:"po_pso"})),LF=Array.from({length:3},(e,t)=>({key:`pso${t+1}`,label:`PSO${t+1}`,type:"checkbox",group:"po_pso"})),ao=["SSA1","SSA2","ACTIVE LEARNING 1 (SKILL)","ACTIVE LEARNING 2 (SKILL)","ACTIVE LEARNING 1 (ATTITUDE)","ACTIVE LEARNING 2 (ATTITUDE)","SPECIAL ACTIVITY"],Tf=Array.from({length:11},(e,t)=>`PO${t+1}`),gv={SSA1:["Technical magazine","Journal paper reading","Real time problems","Case study"],SSA2:["Technical magazine","Journal paper reading","Real time problems","Case study"],"ACTIVE LEARNING 1 (SKILL)":["Dipstick (Writing explanation content of CO)","Dipstick (Sketch Representation)","Real time Photography or Video Explanation","Course competition"],"ACTIVE LEARNING 2 (SKILL)":["Dipstick (Writing explanation content of CO)","Dipstick (Sketch Representation)","Real time Photography or Video Explanation","Course competition"],"ACTIVE LEARNING 1 (ATTITUDE)":["Active Learing Exercies (Group Discussion)","Active Learing Exercies (Technical Question and answering Session)","Technical Role play","Interview Assessment"],"ACTIVE LEARNING 2 (ATTITUDE)":["Active Learing Exercies (Group Discussion)","Active Learing Exercies (Technical Question and answering Session)","Technical Role play","Interview Assessment"],"SPECIAL ACTIVITY":["Active Projects","Journal Preparation"]};function UPe({subjectId:e,imported:t,onLockChange:r}){const n=x.useMemo(()=>{if(e)try{const _e=localStorage.getItem(`markEntry_selectedTa_${e}`),Se=_e==null?NaN:Number(_e);return Number.isFinite(Se)?Se:void 0}catch{return}},[e]),i=(_e,Se)=>{const he=[...Se];for(let ye=0;ye<_e.length;ye++){const ht=_e[ye]??[];(!he[ye]||String(he[ye]).trim()==="")&&Array.isArray(ht)&&ht.length===1&&(he[ye]=String(ht[0]??"").trim())}return he},s=x.useRef(null),[o,l]=x.useState(!0),[c,u]=x.useState(1),[d,f]=x.useState(()=>{if(!e)return 100;try{const _e=localStorage.getItem(`cdap_zoom_${e}`);return _e?parseInt(_e,10):100}catch{return 100}}),[h,p]=x.useState(""),[m,g]=x.useState(""),[y,b]=x.useState(()=>ao.map(()=>Tf.map(()=>!1))),[v,w]=x.useState(()=>ao.map(()=>"")),[S,k]=x.useState(()=>Yre()),[j,A]=x.useState(()=>ao.map(_e=>gv[_e]??[])),[L,P]=x.useState({}),[F,E]=x.useState(!1),[T,B]=x.useState(null),[q,U]=x.useState(!1),{data:se,loading:de,error:z,refresh:G}=oc({assessment:"cdap",subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:n,options:{poll:!0}}),ie=!!q,Y=!!(se!=null&&se.allowed_by_approval),C=!!(ie&&!Y),[K,H]=x.useState(!1),[R,J]=x.useState(""),[V,X]=x.useState(!1),[Q,ne]=x.useState(null);x.useEffect(()=>{if(e)try{localStorage.setItem(`cdap_active_learning_draft_${e}`,JSON.stringify({dropdowns:v,grid:y,ts:Date.now()})),window.dispatchEvent(new CustomEvent("cdap-active-learning-changed",{detail:{subjectId:e}}))}catch{}},[e,v,y]),x.useEffect(()=>{if(e)try{localStorage.setItem(`cdap_zoom_${e}`,d.toString())}catch{}},[e,d]);const oe=_e=>String(_e??"").replace(/\s+/g," ").trim().toUpperCase().includes("#N/A"),O=_e=>_e.filter(Se=>!oe(Se==null?void 0:Se.content_type)),W=x.useMemo(()=>[...OF,...MF,...LF],[]),ae=x.useMemo(()=>{const _e={};for(const Se of W)_e[Se.key]=Se.type==="checkbox"?!1:"";return _e},[W]),[I,Z]=x.useState(()=>[structuredClone(ae)]),me=_e=>{const Se=Lc(_e);if(Se===Lc("SPECIAL ACTIVITY")){const he=Lc("Active Projects");if(Array.isArray(S==null?void 0:S[he])&&S[he].length===11)return S[he]}if(Array.isArray(S==null?void 0:S[Se])&&S[Se].length===11)return S[Se];for(const he of Fm){const ye=Lc(he);if(ye===Se&&Array.isArray(S==null?void 0:S[ye])&&S[ye].length===11)return S[ye]}for(const he of Fm){const ye=Lc(he);if((ye.includes(Se)||Se.includes(ye))&&Array.isArray(S==null?void 0:S[ye])&&S[ye].length===11)return S[ye]}return null},Te=(_e,Se)=>{const he=_e.map(ye=>[...ye]);for(let ye=0;ye<ao.length;ye++){const ht=(Se==null?void 0:Se[ye])??"";if(!ht)continue;const Ge=me(ht);if(!(!Array.isArray(Ge)||Ge.length!==11))for(let lt=0;lt<Tf.length;lt++)he[ye][lt]=!!Ge[lt]}return he};x.useEffect(()=>{if(!e)return;let _e=!0;return(async()=>{try{B(null),E(!0);const he=await B9(e,n);if(!_e)return;const ye=String((he==null?void 0:he.status)||"").toLowerCase()==="published";if(U(ye),ye&&(H(!1),ne(null)),!he){Z([structuredClone(ae)]),p(""),g(""),b(ao.map(()=>Tf.map(()=>!1))),w(ao.map(()=>"")),A(ao.map(en=>gv[en]??[])),U(!1);return}const ht=Array.isArray(he.rows)?he.rows:[];Z(ht.length?O(ht):[structuredClone(ae)]);const Ge=he.books&&typeof he.books=="object"?he.books:{};p(typeof Ge.textbook=="string"?Ge.textbook:""),g(typeof Ge.reference=="string"?Ge.reference:"");const lt=he.active_learning&&typeof he.active_learning=="object"?he.active_learning:{},jt=Array.isArray(lt.dropdowns)?lt.dropdowns.map(en=>en==null?"":String(en)):[],wt=Array.isArray(lt.grid)?lt.grid:[],yt=Array.isArray(lt.optionsByRow)?lt.optionsByRow:null,Fr=lt.articulation_extras&&typeof lt.articulation_extras=="object"?lt.articulation_extras:{};P(Fr);const Tt=ao.map((en,$r)=>Tf.map((Kr,Rn)=>{var Sn;const Pr=(Sn=wt==null?void 0:wt[$r])==null?void 0:Sn[Rn];return Pr===!0||Pr==="true"||Pr===1||Pr==="1"||String(Pr).trim().toLowerCase()==="x"?!0:!!Pr})),hr=jt.length===ao.length?jt.slice(0,ao.length):ao.map(()=>""),rn=yt&&Array.isArray(yt)?i(yt,hr):hr;if(w(rn),b(Te(Tt,rn)),yt&&Array.isArray(yt)){const en=ao.map(($r,Kr)=>{const Rn=yt==null?void 0:yt[Kr];return Array.isArray(Rn)?Rn.map(Pr=>String(Pr??"")).map(Pr=>Pr.trim()).filter(Boolean):[]});A(en)}else A(ao.map(en=>gv[en]??[]))}catch(he){if(!_e)return;B((he==null?void 0:he.message)||"Failed to load CDAP from cloud"),Z([structuredClone(ae)])}finally{_e&&E(!1)}})(),()=>{_e=!1}},[e,ae]),x.useEffect(()=>{r&&r(!!C)},[C,r]),x.useEffect(()=>{let _e=!0;const Se=async()=>{try{const ye=await N3();_e&&k(ye)}catch{}};Se();const he=Jre(()=>Se());return()=>{_e=!1,he()}},[]),x.useEffect(()=>{if(t&&!C){if(Array.isArray(t.rows)&&t.rows.length&&Z(O(t.rows)),typeof t.textbook=="string"&&p(t.textbook),typeof t.reference=="string"&&g(t.reference),Array.isArray(t.activeLearningOptionsByRow)&&t.activeLearningOptionsByRow.length){const _e=ao.map((ye,ht)=>{var lt;const Ge=(lt=t.activeLearningOptionsByRow)==null?void 0:lt[ht];return Array.isArray(Ge)?Ge.map(jt=>String(jt??"")).map(jt=>jt.trim()).filter(Boolean):[]}),he=i(_e,v);A(_e),w(he),b(ye=>Te(ye,he))}t.articulationExtras&&typeof t.articulationExtras=="object"&&P(t.articulationExtras)}},[t,C]);const Ae=async()=>{if(!e)return;const _e=String(R||"").trim();if(!_e){ne("Reason is required.");return}X(!0),ne(null);try{const Se=await il({assessment:"cdap",subject_code:e,scope:"MARK_ENTRY",reason:_e,teaching_assignment_id:n});alert(al(Se)),H(!1)}catch(Se){const he=sl(Se,"Failed to request edit");ne(he),alert(`Edit request failed: ${he}`)}finally{X(!1),G()}};x.useEffect(()=>{b(_e=>Te(_e,v))},[S]);const Be=x.useMemo(()=>{const _e=new Map;let Se=null;return I.forEach((he,ye)=>{const ht=he.unit??"",Ge=ht!==""?String(ht):"";Ge&&(Se=Ge);const lt=Ge||Se||String(Math.floor(ye/9)+1),jt=_e.get(lt)??{key:lt,items:[]};jt.items.push({row:he,index:ye}),_e.set(lt,jt)}),Array.from(_e.values()).sort((he,ye)=>{const ht=Number(he.key),Ge=Number(ye.key);return!Number.isNaN(ht)&&!Number.isNaN(Ge)?ht-Ge:he.key.localeCompare(ye.key)})},[I]),Ee=(_e,Se,he)=>{if(Se==="content_type"&&oe(he)){Z(ye=>ye.filter((ht,Ge)=>Ge!==_e));return}Z(ye=>{const ht=[...ye];return ht[_e]={...ht[_e],[Se]:he},ht})},ze=()=>Z(_e=>[..._e,structuredClone(ae)]),Xe=_e=>Z(Se=>Se.filter((he,ye)=>ye!==_e)),Pt=_e=>{Z(Se=>{const he=structuredClone(ae);he.unit=_e;let ye=null,ht=-1,Ge=-1;for(let jt=0;jt<Se.length;jt++){const wt=Se[jt].unit??"",yt=wt!==""?String(wt):"";yt&&(ye=yt),(yt||ye||String(Math.floor(jt/9)+1))===String(_e)&&(Ge===-1&&(Ge=jt),ht=jt)}return Ge!==-1&&(he.unit_name=Se[Ge].unit_name??"",he.co=Se[Ge].co??""),ht===-1?[...Se,he]:[...Se.slice(0,ht+1),he,...Se.slice(ht+1)]})},ft=async()=>{if(!e){alert("No subject selected.");return}try{B(null),E(!0),await I9({subjectId:e,status:"published",teaching_assignment_id:n,rows:I,books:{textbook:h,reference:m},active_learning:{grid:y,dropdowns:v,optionsByRow:j,articulation_extras:L}}),U(!0),alert("Published to cloud.")}catch(_e){alert((_e==null?void 0:_e.message)||"Failed to save to cloud")}finally{E(!1),G()}};x.useEffect(()=>{if(!o){u(1);return}const _e=()=>{const ye=s.current;if(!ye)return;const ht=ye.querySelector('table[data-cdap-table="1"]');if(!ht)return;const Ge=ye.clientWidth,lt=ht.scrollWidth;if(!Ge||!lt)return;const wt=(Ge-24)/lt,yt=Math.min(1,Math.max(.35,wt));u(yt)};_e();const Se=s.current;if(!Se)return;const he=new ResizeObserver(()=>_e());return he.observe(Se),()=>he.disconnect()},[o,I]);const He=OF.slice(3,8),tt=[...MF,...LF];return a.jsxs("div",{style:{border:"1px solid #dbe4f0",borderRadius:14,padding:"16px 18px",background:"#fff",boxShadow:"0 2px 12px rgba(15, 23, 42, 0.08)",width:"100%",boxSizing:"border-box",overflow:"hidden"},children:[a.jsx("style",{children:`
        .cdap-slider::-webkit-slider-thumb {
          appearance: none;
          height: 14px;
          width: 14px;
          border-radius: 50%;
          background: #2563eb;
          cursor: pointer;
          box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        .cdap-slider::-moz-range-thumb {
          height: 14px;
          width: 14px;
          border-radius: 50%;
          background: #2563eb;
          cursor: pointer;
          border: none;
        }
        .cdap-slider::-webkit-slider-track {
          background: #e5e7eb;
          height: 6px;
          border-radius: 999px;
        }
        .cdap-slider::-moz-range-track {
          background: #e5e7eb;
          height: 6px;
          border-radius: 999px;
          border: none;
        }
        .cdap-table-wrap { overflow-x: auto; border: 1px solid #e2e8f0; border-radius: 10px; }
        .cdap-table { border-collapse: collapse; width: 100%; font-size: 11px; table-layout: fixed; }
        .cdap-table thead th {
          position: sticky;
          top: 0;
          z-index: 2;
          border: 1px solid #e2e8f0;
          padding: 5px 4px;
          font-size: 10px;
          font-weight: 700;
          text-transform: uppercase;
          letter-spacing: 0.03em;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }
        .cdap-table tbody tr:hover td { background: #eff6ff !important; }
        .cdap-table tbody td { border: 1px solid #e2e8f0; padding: 3px 4px; vertical-align: top; }
        .cdap-cell-textarea {
          width: 100%;
          border: 1px solid #cbd5e1;
          border-radius: 4px;
          padding: 3px 5px;
          font-size: 11px;
          resize: none;
          font-family: inherit;
          line-height: 1.4;
        }
        .cdap-cell-textarea:focus { outline: none; border-color: #2563eb; box-shadow: 0 0 0 2px rgba(37,99,235,0.15); }
        .cdap-cell-textarea:disabled { background: #f3f4f6; cursor: not-allowed; color: #6b7280; }
        .cdap-unit-card {
          border: 1px solid #dbe4f0;
          border-radius: 12px;
          background: #fff;
          margin-bottom: 14px;
          overflow: hidden;
          box-shadow: 0 1px 4px rgba(15,23,42,0.05);
        }
        .cdap-unit-header {
          display: grid;
          grid-template-columns: 80px 1fr 1fr;
          gap: 0;
          border-bottom: 1px solid #dbe4f0;
          background: #f1f5f9;
        }
        .cdap-unit-header-cell {
          padding: 8px 10px;
          border-right: 1px solid #dbe4f0;
        }
        .cdap-unit-header-cell:last-child { border-right: none; }
        .cdap-unit-header-cell label {
          display: block;
          font-size: 10px;
          font-weight: 700;
          text-transform: uppercase;
          letter-spacing: 0.04em;
          color: #64748b;
          margin-bottom: 4px;
        }
        .cdap-unit-header-cell textarea {
          width: 100%;
          border: 1px solid #cbd5e1;
          border-radius: 6px;
          padding: 4px 6px;
          font-size: 12px;
          font-family: inherit;
          resize: none;
          background: #fff;
          line-height: 1.4;
        }
        .cdap-unit-header-cell textarea:focus { outline: none; border-color: #2563eb; }
        .cdap-unit-header-cell textarea:disabled { background: #f3f4f6; cursor: not-allowed; color: #6b7280; }
        .cdap-table-scale-wrap {
          transform-origin: left top;
        }
      `}),F?a.jsx("div",{style:{marginBottom:8,fontSize:12,color:"#64748b"},children:"Loading from cloud"}):T?a.jsx("div",{style:{marginBottom:8,fontSize:12,color:"#b91c1c"},children:T}):null,C?a.jsx("div",{style:{marginBottom:12,padding:"12px 16px",background:"linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)",border:"1px solid #fbbf24",borderRadius:10,color:"#92400e",fontSize:14,fontWeight:600,display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:a.jsx("span",{children:" Published  Document is read-only. Use Request Edit to make changes."})}):null,de||z?a.jsx("div",{style:{marginBottom:10,fontSize:12,color:z?"#b91c1c":"#64748b"},children:z||"Checking edit approval"}):ie&&Y&&(se!=null&&se.approval_until)?a.jsxs("div",{style:{marginBottom:10,fontSize:12,color:"#065f46"},children:["Edit approved until ",new Date(se.approval_until).toLocaleString(),"."]}):null,a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",gap:10,padding:"10px 14px",background:"linear-gradient(to right, #f8fafc, #f1f5f9)",border:"1px solid #e2e8f0",borderRadius:12,marginBottom:14},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[a.jsx("div",{style:{width:36,height:36,borderRadius:9,background:"linear-gradient(135deg, #1e40af 0%, #2563eb 100%)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),a.jsx("line",{x1:"3",y1:"15",x2:"21",y2:"15"}),a.jsx("line",{x1:"9",y1:"3",x2:"9",y2:"21"})]})}),a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:700,color:"#0f172a",fontSize:13},children:"Revised CDP Editor"}),a.jsx("div",{style:{fontSize:11,color:"#64748b"},children:"Interactive spreadsheet interface"})]})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,background:"#fff",border:"1px solid #e2e8f0",borderRadius:8,padding:"5px 8px",boxShadow:"0 1px 2px rgba(0,0,0,0.04)"},children:[a.jsx("button",{type:"button",onClick:()=>f(_e=>Math.max(50,_e-10)),style:{background:"none",border:"none",cursor:"pointer",padding:"0 2px",display:"flex",alignItems:"center"},children:a.jsx(Kte,{size:14,color:"#64748b"})}),a.jsx("input",{type:"range",min:"50",max:"200",step:"10",value:d,onChange:_e=>f(parseInt(_e.target.value,10)),className:"cdap-slider",style:{width:80}}),a.jsx("button",{type:"button",onClick:()=>f(_e=>Math.min(200,_e+10)),style:{background:"none",border:"none",cursor:"pointer",padding:"0 2px",display:"flex",alignItems:"center"},children:a.jsx(Vte,{size:14,color:"#64748b"})}),a.jsxs("span",{style:{fontSize:11,color:"#334155",minWidth:32,textAlign:"right",fontVariantNumeric:"tabular-nums"},children:[d,"%"]})]}),a.jsxs("button",{onClick:()=>l(_e=>!_e),title:"Toggle fit-to-screen scaling",style:{padding:"6px 10px",borderRadius:8,border:o?"none":"1px solid #e2e8f0",background:o?"#111827":"#fff",color:o?"#fff":"#374151",cursor:"pointer",fontWeight:600,fontSize:11,display:"flex",alignItems:"center",gap:5,boxShadow:o?"0 2px 6px rgba(17,24,39,0.25)":"0 1px 2px rgba(0,0,0,0.04)",transition:"all 150ms ease"},children:[a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3"}),a.jsx("path",{d:"M21 8V5a2 2 0 0 0-2-2h-3"}),a.jsx("path",{d:"M3 16v3a2 2 0 0 0 2 2h3"}),a.jsx("path",{d:"M16 21h3a2 2 0 0 0 2-2v-3"})]}),"Fit Screen: ",o?"ON":"OFF"]}),a.jsxs("button",{onClick:ze,disabled:C,style:{padding:"6px 12px",borderRadius:8,border:"none",background:C?"#d1d5db":"#059669",color:"#fff",cursor:C?"not-allowed":"pointer",fontWeight:600,fontSize:11,opacity:C?.5:1,display:"flex",alignItems:"center",gap:5,boxShadow:C?"none":"0 2px 6px rgba(5,150,105,0.28)"},children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Row"]}),a.jsx("button",{onClick:()=>{if(!C)return ft();H(_e=>!_e),ne(null)},disabled:V,style:{padding:"6px 14px",borderRadius:8,border:"none",background:C?"#16a34a":"#2563eb",color:"#fff",cursor:V?"not-allowed":"pointer",fontWeight:700,fontSize:11,opacity:V?.6:1,boxShadow:C?"0 2px 6px rgba(22,163,74,0.28)":"0 2px 6px rgba(37,99,235,0.28)"},children:C?" Request Edit":" Publish"})]})]}),C&&K?a.jsxs("div",{style:{marginBottom:16,border:"1px solid #e2e8f0",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:800,color:"#0f172a",marginBottom:8},children:"Reason (required)"}),a.jsx("textarea",{value:R,onChange:_e=>J(_e.target.value),rows:3,style:{width:"100%",padding:10,border:"1px solid #cbd5e1",borderRadius:10,fontSize:13,background:"#fff"},placeholder:"Why do you need to edit this published CDAP?"}),Q?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#b91c1c",fontWeight:700},children:Q}):null,a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:10},children:[a.jsx("button",{type:"button",className:"obe-btn",onClick:()=>H(!1),disabled:V,children:"Cancel"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-success",onClick:Ae,disabled:V||!String(R||"").trim(),children:V?"Requesting":"Confirm Request"})]})]}):null,a.jsx("div",{ref:s,children:Be.map(_e=>{var he;const Se=(he=_e.items[0])==null?void 0:he.row;return Se?a.jsxs("div",{className:"cdap-unit-card",children:[a.jsxs("div",{className:"cdap-unit-header",children:[a.jsxs("div",{className:"cdap-unit-header-cell",style:{background:"linear-gradient(135deg, #1e40af 0%, #2563eb 100%)"},children:[a.jsx("label",{style:{color:"rgba(255,255,255,0.75)"},children:"Unit #"}),a.jsx("textarea",{value:Se.unit??"",onChange:ye=>_e.items.forEach(ht=>Ee(ht.index,"unit",ye.target.value)),disabled:C,rows:2,style:{background:"rgba(255,255,255,0.15)",border:"1px solid rgba(255,255,255,0.3)",borderRadius:6,color:"#fff",padding:"4px 6px",fontSize:13,fontWeight:700,width:"100%",resize:"none",fontFamily:"inherit",cursor:C?"not-allowed":"text"}})]}),a.jsxs("div",{className:"cdap-unit-header-cell",children:[a.jsx("label",{children:"Syllabus (Unit Name)"}),a.jsx("textarea",{value:Se.unit_name??"",onChange:ye=>_e.items.forEach(ht=>Ee(ht.index,"unit_name",ye.target.value)),disabled:C,rows:2})]}),a.jsxs("div",{className:"cdap-unit-header-cell",children:[a.jsx("label",{children:"Course Outcome (CO)"}),a.jsx("textarea",{value:Se.co??"",onChange:ye=>_e.items.forEach(ht=>Ee(ht.index,"co",ye.target.value)),disabled:C,rows:2})]})]}),a.jsx("div",{className:"cdap-table-wrap",style:{margin:"0 0"},children:(()=>{const ye=o?c*(d/100):d/100,ht=Math.max(1,100/ye);return a.jsx("div",{className:"cdap-table-scale-wrap",style:{transform:`scale(${ye})`,width:`${ht}%`},children:a.jsxs("table",{"data-cdap-table":"1",className:"cdap-table",style:{minWidth:1200},children:[a.jsxs("colgroup",{children:[a.jsx("col",{style:{width:34}}),a.jsx("col",{style:{width:90}}),a.jsx("col",{style:{width:70}}),a.jsx("col",{style:{width:190}}),a.jsx("col",{style:{width:190}}),a.jsx("col",{style:{width:62}}),tt.map(Ge=>a.jsx("col",{style:{width:34}},Ge.key)),a.jsx("col",{style:{width:82}}),a.jsx("col",{style:{width:66}})]}),a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{background:"#f1f5f9",textAlign:"center"},children:"#"}),He.map(Ge=>a.jsx("th",{style:{background:"#f1f5f9",textAlign:"left"},children:Ge.label},Ge.key)),tt.map(Ge=>a.jsx("th",{style:{background:Ge.key.startsWith("pso")?"#fdf4ff":"#fff7ed",textAlign:"center"},children:Ge.label},Ge.key)),a.jsx("th",{style:{background:"#f0fdf4",textAlign:"center"},children:"HRS"}),a.jsx("th",{style:{background:"#f1f5f9",textAlign:"center"},children:"Act."})]})}),a.jsx("tbody",{children:_e.items.map((Ge,lt)=>a.jsx(x.Fragment,{children:a.jsxs("tr",{style:{background:lt%2===0?"#fff":"#f8fafc"},children:[a.jsx("td",{style:{textAlign:"center",color:"#94a3b8",fontWeight:600,fontSize:10},children:lt+1}),He.map(jt=>a.jsx("td",{children:a.jsx("textarea",{value:Ge.row[jt.key]??"",onChange:wt=>Ee(Ge.index,jt.key,wt.target.value),disabled:C,className:"cdap-cell-textarea",rows:2})},jt.key)),tt.map(jt=>a.jsx("td",{style:{textAlign:"center",background:jt.key.startsWith("pso")?"#fdf4ff":void 0},children:a.jsx("input",{type:"checkbox",checked:!!Ge.row[jt.key],onChange:wt=>Ee(Ge.index,jt.key,wt.target.checked),disabled:C,style:{cursor:C?"not-allowed":"pointer",width:14,height:14,accentColor:"#2563eb"}})},jt.key)),a.jsx("td",{style:{textAlign:"center"},children:a.jsx("input",{type:"text",value:Ge.row.total_hours_required??"",onChange:jt=>Ee(Ge.index,"total_hours_required",jt.target.value),disabled:C,style:{width:"100%",border:"1px solid #cbd5e1",borderRadius:4,padding:"3px 4px",fontSize:11,background:C?"#f3f4f6":"#fff",cursor:C?"not-allowed":"text",textAlign:"center"}})}),a.jsx("td",{style:{textAlign:"center"},children:a.jsx("button",{type:"button",onClick:()=>Xe(Ge.index),disabled:C,title:"Delete row",style:{padding:"3px 7px",background:C?"#d1d5db":"#fee2e2",color:C?"#9ca3af":"#dc2626",border:`1px solid ${C?"#d1d5db":"#fca5a5"}`,borderRadius:5,cursor:C?"not-allowed":"pointer",fontSize:11,fontWeight:600,opacity:C?.5:1},children:""})})]})},Ge.index))})]})})})()}),a.jsx("div",{style:{padding:"10px 14px",borderTop:"1px solid #f1f5f9"},children:a.jsxs("button",{type:"button",onClick:()=>Pt(_e.key),disabled:C,style:{padding:"6px 12px",background:C?"#e5e7eb":"#eff6ff",color:C?"#9ca3af":"#2563eb",border:`1px solid ${C?"#d1d5db":"#bfdbfe"}`,borderRadius:7,cursor:C?"not-allowed":"pointer",fontWeight:600,fontSize:12,opacity:C?.5:1,display:"flex",alignItems:"center",gap:5},children:[a.jsx("span",{style:{fontSize:14,lineHeight:1},children:"+"})," Add Row to Unit ",_e.key]})})]},_e.key):null})}),a.jsxs("section",{style:{marginTop:16,padding:16,border:"1px solid #e2e8f0",borderRadius:12,background:"#f8fafc"},children:[a.jsx("h4",{style:{marginBottom:10},children:"Reference Materials"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(260px, 1fr))",gap:16},children:[a.jsxs("div",{children:[a.jsx("label",{style:{fontSize:12,fontWeight:600},children:"Textbook Details"}),a.jsx("textarea",{value:h,onChange:_e=>p(_e.target.value),disabled:C,rows:4,style:{width:"100%",padding:8,border:"1px solid #cbd5e1",borderRadius:8,marginTop:6,background:C?"#f3f4f6":"#fff",cursor:C?"not-allowed":"text"},placeholder:"Textbook details (Excel: Column B, Row 64)"})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontSize:12,fontWeight:600},children:"Reference Book Details"}),a.jsx("textarea",{value:m,onChange:_e=>g(_e.target.value),disabled:C,rows:4,style:{width:"100%",padding:8,border:"1px solid #cbd5e1",borderRadius:8,marginTop:6,background:C?"#f3f4f6":"#fff",cursor:C?"not-allowed":"text"},placeholder:"Reference book details (Excel: Column B, Row 68)"})]})]})]}),a.jsxs("section",{style:{marginTop:16,padding:16,border:"1px solid #e2e8f0",borderRadius:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:[a.jsxs("div",{children:[a.jsx("h4",{style:{margin:0},children:"Active Learning Mapping"}),a.jsx("div",{style:{fontSize:12,color:"#64748b"},children:"7  11 PO mapping matrix"})]}),a.jsx("button",{type:"button",onClick:()=>{b(ao.map(()=>Tf.map(()=>!1))),w(ao.map(()=>""))},disabled:C,style:{padding:"6px 10px",borderRadius:8,border:"1px solid #e2e8f0",background:C?"#e5e7eb":"#f8fafc",cursor:C?"not-allowed":"pointer",opacity:C?.5:1},children:"Clear All"})]}),a.jsx("div",{style:{overflowX:"auto"},children:a.jsxs("table",{style:{borderCollapse:"collapse",minWidth:900,width:"100%"},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{border:"1px solid #e2e8f0",padding:8,background:"#f8fafc",textAlign:"left"},children:"Activity Type"}),a.jsx("th",{style:{border:"1px solid #e2e8f0",padding:8,background:"#f8fafc",textAlign:"left"},children:"Specific Activity"}),Tf.map(_e=>a.jsx("th",{style:{border:"1px solid #e2e8f0",padding:8,background:"#fff7ed",textAlign:"center"},children:_e},_e))]})}),a.jsx("tbody",{children:ao.map((_e,Se)=>a.jsxs("tr",{style:{background:Se%2===0?"#fff":"#f9fafb"},children:[a.jsx("td",{style:{border:"1px solid #e2e8f0",padding:8,fontWeight:600},children:_e}),a.jsx("td",{style:{border:"1px solid #e2e8f0",padding:8},children:a.jsxs("select",{value:v[Se]??"",onChange:he=>{const ye=he.target.value;w(ht=>{const Ge=[...ht];return Ge[Se]=ye,Ge}),b(ht=>{const Ge=ht.map(jt=>[...jt]),lt=me(ye);if(Array.isArray(lt)&&lt.length===11)for(let jt=0;jt<Tf.length;jt++)Ge[Se][jt]=!!lt[jt];return Ge})},disabled:C,style:{width:"100%",padding:6,border:"1px solid #cbd5e1",borderRadius:6,background:C?"#f3f4f6":"#fff",cursor:C?"not-allowed":"pointer"},children:[a.jsx("option",{value:"",children:"-- Select Activity --"}),(Array.isArray(j==null?void 0:j[Se])&&(j!=null&&j[Se].length)?j==null?void 0:j[Se]:gv[_e]??[]).map(ht=>String(ht??"").trim()).filter(Boolean).filter((ht,Ge,lt)=>lt.indexOf(ht)===Ge).map(ht=>a.jsx("option",{value:ht,children:ht},ht))]})}),Tf.map((he,ye)=>a.jsx("td",{style:{border:"1px solid #e2e8f0",padding:8,textAlign:"center"},children:a.jsx("input",{type:"checkbox",checked:!!y[Se][ye],disabled:C||(()=>{const ht=(v==null?void 0:v[Se])??"";if(!ht)return!1;const Ge=me(ht);return Array.isArray(Ge)&&Ge.length===11})(),onChange:ht=>{const Ge=ht.target.checked;b(lt=>{const jt=lt.map(wt=>[...wt]);return jt[Se][ye]=Ge,jt})},style:{cursor:C?"not-allowed":"pointer"}})},he))]},_e))})]})})]})]})}function zPe({courseId:e,showHeader:t=!0,showCourseInput:r=!0}){const[n,i]=x.useState(e||""),[s,o]=x.useState(null),[l,c]=x.useState("idle"),[u,d]=x.useState(null),[f,h]=x.useState(!1),p=on.useMemo(()=>{if(n)try{const m=localStorage.getItem(`markEntry_selectedTa_${n}`),g=m==null?NaN:Number(m);return Number.isFinite(g)?g:void 0}catch{return}},[n]);return x.useEffect(()=>{e&&i(e)},[e]),a.jsxs("div",{children:[t&&a.jsxs("h2",{children:["CDAP - ",n||"No course selected"]}),r&&!e&&a.jsxs("div",{style:{marginBottom:12},children:[a.jsx("label",{style:{marginRight:8},children:"Course ID:"}),a.jsx("input",{value:n,onChange:m=>i(m.target.value),placeholder:"Enter course id",style:{padding:6,border:"1px solid #ccc",borderRadius:4}})]}),f?null:a.jsx("div",{style:{marginBottom:12},children:a.jsx($Pe,{subjectId:n,onUpload:async m=>{o(m);const g=(m==null?void 0:m.revision)||m;if(!(!n||!g)&&!(!Array.isArray(g==null?void 0:g.rows)||g.rows.length===0))try{c("saving"),d(null);const y=I9({subjectId:n,status:"draft",rows:g.rows,books:{textbook:g.textbook||"",reference:g.reference||""},teaching_assignment_id:p,active_learning:{grid:[],dropdowns:[],optionsByRow:g.activeLearningOptionsByRow||[],articulation_extras:g.articulationExtras||{}}}),b=new Promise((v,w)=>setTimeout(()=>w(new Error("Auto-save timed out. Server did not respond in time.")),6e4));await Promise.race([y,b]),c("saved"),d("Saved parsed CDAP to cloud (draft).")}catch(y){c("error"),d((y==null?void 0:y.message)||"Auto-save failed. You can still publish from the editor.")}}})}),u&&a.jsx("div",{style:{marginBottom:12,fontSize:12,color:l==="error"?"#b91c1c":"#166534"},children:u}),a.jsx("div",{style:{marginBottom:12},children:a.jsx(UPe,{subjectId:n,imported:(s==null?void 0:s.revision)||s,onLockChange:m=>h(!!m)})})]})}function Op({value:e,onChange:t,min:r,max:n}){return a.jsx("input",{type:"number",value:e,onChange:i=>{const s=i.target.value;t(s===""?"":Number(s))},min:r,max:n,style:{width:76,padding:"6px 8px",borderRadius:8,border:"1px solid #e6eef8",outline:"none",fontSize:13}})}function RF(e){const t=typeof e.band1=="number"?e.band1:0,r=typeof e.band2=="number"?e.band2:0,n=typeof e.band3=="number"?e.band3:0;if(!(t+r+n))return"-";const s=Math.max(t,r,n);return s===t?1:s===r?2:3}function WPe(e){return e===1?{label:"LOW LEVEL",code:"LL"}:e===2?{label:"MEDIUM LEVEL",code:"ML"}:e===3?{label:"HIGH LEVEL",code:"HL"}:{label:"",code:"-"}}const cr={page:{padding:20,width:"100%",boxSizing:"border-box",minHeight:"100vh",display:"flex",justifyContent:"center",alignItems:"flex-start",margin:0,fontFamily:"Inter, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial",color:"#1f3947",background:"transparent"},card:{background:"#fff",borderRadius:12,padding:18,border:"1px solid #e6eef8",boxShadow:"0 6px 20px rgba(13,60,100,0.04)",width:"100%",maxWidth:1200,margin:"18px",flex:"1 1 auto"},title:{margin:0,color:"#0b4a6f",fontSize:22,fontWeight:700},subtitle:{marginTop:6,color:"#3d5566",fontSize:13},sectionTitle:{margin:"0 0 10px 0",color:"#0b3b57",fontSize:16},table:{width:"100%",borderCollapse:"collapse",marginTop:8,tableLayout:"auto",display:"block",overflowX:"auto",WebkitOverflowScrolling:"touch"},th:{background:"#f3f8ff",color:"#0b4a6f",fontWeight:700,padding:"8px 10px",border:"1px solid #e6eef8",textAlign:"center",fontSize:13,whiteSpace:"nowrap"},thLeft:{background:"#f3f8ff",color:"#0b4a6f",fontWeight:700,padding:"8px 10px",border:"1px solid #e6eef8",textAlign:"left",fontSize:13,whiteSpace:"nowrap",minWidth:220},td:{padding:"8px 10px",border:"1px solid #eef6fb",color:"#234451",fontSize:13,textAlign:"center"},tdLeft:{padding:"8px 10px",border:"1px solid #eef6fb",color:"#234451",fontSize:13,textAlign:"left",minWidth:220},cellYellow:{background:"#fef9c3"},cellGreen:{background:"#ecfdf3"},link:{color:"#0b4a6f",textDecoration:"underline",fontWeight:700},btn:{border:"1px solid #e6eef8",background:"#fbfdff",padding:"8px 10px",borderRadius:10,cursor:"pointer",fontWeight:700,color:"#0b4a6f"},pill:{display:"inline-flex",alignItems:"center",gap:8,padding:"8px 10px",borderRadius:10,background:"#fbfdff",border:"1px solid #e6eef8",fontSize:13,color:"#234451"}};function pj(e){return String(e||"").trim().toLowerCase().replace(/\s+/g,"").replace(/[^a-z0-9]/g,"")}function qPe(e){if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=parseFloat(e.replace(/[^0-9.\-]/g,""));return Number.isFinite(t)?t:null}return null}function HPe(e){return e<=6?"HC":e<=8?"MC":"EC"}function VPe(e){return e==="EC"?"L1":e==="MC"?"L2":e==="HC"?"L3":"-"}async function GPe(e){var m;let t;try{t=await import("xlsx")}catch{throw new Error('Missing dependency "xlsx". Install it with: npm install xlsx  (or yarn add xlsx / pnpm add xlsx)')}const r=await e.arrayBuffer(),n=t.read(r,{type:"array"}),i=(m=n.SheetNames)==null?void 0:m[0];if(!i)throw new Error("No sheet found in the Excel file.");const s=n.Sheets[i],o=t.utils.sheet_to_json(s,{defval:""})||[];if(!o.length)throw new Error("Excel sheet is empty.");const l=Object.keys(o[0]||{}),c=new Map;l.forEach(g=>c.set(pj(g),g));const u=c.get("grade")||l.find(g=>pj(g).includes("grade"))||null,d=c.get("gpaconversion")||c.get("gpaconvert")||l.find(g=>{const y=pj(g);return y.includes("gpaconversion")||y.includes("gpaconvert")||y==="gpa"})||null;if(!u||!d)throw new Error('Excel must contain columns for "Grade" and "GPA conversion".');const f=[];for(const g of o){if(!String(g[u]??"").trim())continue;const b=qPe(g[d]);b!==null&&f.push(b)}if(!f.length)throw new Error('No numeric "GPA conversion" values found.');const h=f.reduce((g,y)=>g+y,0)/f.length,p=Number(h.toFixed(2));return{fileName:e.name,studentsCount:f.length,meanGpa:p,courseLevel:HPe(p)}}function KPe({courseId:e,courseCode:t,courseName:r,embedded:n}){const i=dl(),s=xo(),o=(i.pathname||"").toLowerCase().includes("/lca/pbr"),[l,c]=x.useState({courseCode:t??e??"",courseName:r??"",credit:"",courseModule:""});x.useEffect(()=>{c(ie=>({...ie,courseCode:t??e??ie.courseCode,courseName:r??ie.courseName}))},[e,t,r]);const[u,d]=x.useState({band1:"",band2:"",band3:""}),f=x.useMemo(()=>RF(u),[u]),[h,p]=x.useState([{name:"Prerequisite 1",band1:"",band2:"",band3:""}]),m=x.useMemo(()=>h.map(ie=>RF({band1:ie.band1,band2:ie.band2,band3:ie.band3})),[h]),g=x.useMemo(()=>{const ie=m.filter(C=>C!=="-");if(!ie.length)return"";const Y=ie.reduce((C,K)=>C+K,0);return Number((Y/ie.length).toFixed(2))},[m]),y=x.useMemo(()=>g===""?"":Math.floor(g),[g]),b=x.useMemo(()=>y===""||y===0?"-":y===1||y===2||y===3?y:"-",[y]),v=x.useMemo(()=>WPe(b),[b]),w=x.useMemo(()=>b==="-"?"-":`L${b}`,[b]),[S,k]=x.useState(null),[j,A]=x.useState(null),[L,P]=x.useState(null),[F,E]=x.useState(null),[T,B]=x.useState("-"),q=x.useMemo(()=>j?j.courseLevel:S?S.courseLevel:T&&T!=="-"?T:"-",[S,j,T]),U=x.useMemo(()=>VPe(q),[q]),se=x.useMemo(()=>U!=="-"?U:w,[w,U]),de=e?`/obe/course/${encodeURIComponent(e)}`:"/obe/course",z=async(ie,Y)=>{if(P(null),!Y){ie==="cay1"?k(null):A(null);return}try{E(ie);const C=await GPe(Y);ie==="cay1"?k(C):A(C)}catch(C){P(String((C==null?void 0:C.message)||C||"Failed to parse Excel")),ie==="cay1"?k(null):A(null)}finally{E(null)}},G=ie=>n?a.jsx(a.Fragment,{children:ie}):a.jsx("div",{style:cr.page,children:a.jsx("div",{style:cr.card,children:ie})});return G(o?a.jsxs(a.Fragment,{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:12},children:[a.jsxs("div",{children:[a.jsx("h2",{style:cr.title,children:"Previous Batch Result (PBR)"}),a.jsx("div",{style:cr.subtitle,children:"Upload up to 2 Excel files (max 2)."})]}),a.jsx("button",{type:"button",onClick:()=>s(`${de}/lca`),style:cr.btn,children:"Back"})]}),a.jsx("div",{style:{height:14}}),a.jsxs("div",{style:{marginBottom:8,display:"flex",gap:12,alignItems:"center"},children:[a.jsx("div",{style:{color:"#0b4a6f",fontWeight:700},children:"Fallback course level (if no Excel):"}),a.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[a.jsx("input",{type:"radio",name:"pbrManual",value:"HC",checked:T==="HC",onChange:()=>B("HC")}),"HARD COURSE (HC)"]}),a.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[a.jsx("input",{type:"radio",name:"pbrManual",value:"MC",checked:T==="MC",onChange:()=>B("MC")}),"MEDIUM COURSE (MC)"]}),a.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[a.jsx("input",{type:"radio",name:"pbrManual",value:"EC",checked:T==="EC",onChange:()=>B("EC")}),"EASY COURSE (EC)"]}),a.jsx("button",{type:"button",onClick:()=>B("-"),style:{marginLeft:8,...cr.btn,padding:"6px 8px"},children:"Clear"})]}),a.jsx("table",{style:cr.table,children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...cr.tdLeft,fontWeight:800,width:220},children:"CAY-1 Excel"}),a.jsx("td",{style:{...cr.tdLeft,...cr.cellGreen},children:a.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:ie=>{var Y;return z("cay1",((Y=ie.target.files)==null?void 0:Y[0])||null)}})})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...cr.tdLeft,fontWeight:800},children:"CAY-2 Excel"}),a.jsx("td",{style:{...cr.tdLeft,...cr.cellGreen},children:a.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:ie=>{var Y;return z("cay2",((Y=ie.target.files)==null?void 0:Y[0])||null)}})})]})]})}),F&&a.jsxs("div",{style:{marginTop:10,fontSize:13,color:"#3d5566"},children:["Parsing ",F.toUpperCase()," Excel"]}),L&&a.jsx("div",{style:{marginTop:10,fontSize:13,color:"#b42318",fontWeight:700},children:L}),a.jsx("div",{style:{height:14}}),a.jsxs("table",{style:cr.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:cr.thLeft,children:"DATASET"}),a.jsx("th",{style:cr.th,children:"FILE"}),a.jsx("th",{style:cr.th,children:"STUDENTS"}),a.jsx("th",{style:cr.th,children:"MEAN GPA"}),a.jsx("th",{style:cr.th,children:"COURSE LEVEL"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...cr.tdLeft,fontWeight:900},children:"CAY-1"}),a.jsx("td",{style:cr.tdLeft,children:(S==null?void 0:S.fileName)||""}),a.jsx("td",{style:cr.td,children:(S==null?void 0:S.studentsCount)??""}),a.jsx("td",{style:cr.td,children:S?S.meanGpa:""}),a.jsx("td",{style:{...cr.td,...cr.cellGreen,fontWeight:900},children:(S==null?void 0:S.courseLevel)||""})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...cr.tdLeft,fontWeight:900},children:"CAY-2"}),a.jsx("td",{style:cr.tdLeft,children:(j==null?void 0:j.fileName)||""}),a.jsx("td",{style:cr.td,children:(j==null?void 0:j.studentsCount)??""}),a.jsx("td",{style:cr.td,children:j?j.meanGpa:""}),a.jsx("td",{style:{...cr.td,...cr.cellGreen,fontWeight:900},children:(j==null?void 0:j.courseLevel)||""})]})]})]}),a.jsx("div",{style:{height:14}}),a.jsx("table",{style:cr.table,children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...cr.tdLeft,fontWeight:900,width:220},children:"PREVIOUS BATCH RESULT (PBR)"}),a.jsx("td",{style:{...cr.td,...cr.cellGreen,fontWeight:900},children:q==="-"?"":q}),a.jsx("td",{style:{...cr.tdLeft,fontWeight:900},children:"Learner Centric Level"}),a.jsx("td",{style:{...cr.td,...cr.cellGreen,fontWeight:900},children:U==="-"?"":U})]}),a.jsx("tr",{children:a.jsx("td",{style:{...cr.tdLeft,color:"#557085"},colSpan:4,children:"Course level rule: mean GPA 06 = HC, 68 = MC, >8 = EC. PBR uses CAY-2 when provided; otherwise CAY-1."})})]})})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:12,marginBottom:18},children:[a.jsxs("div",{children:[a.jsx("h2",{style:cr.title,children:"Learner Centric Approach"}),a.jsx("div",{style:cr.subtitle,children:"Enter values in the highlighted cells; levels are computed automatically."})]}),a.jsx("div",{style:{...cr.pill,fontWeight:800},children:"INDEX"})]}),a.jsx("table",{style:cr.table,children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...cr.tdLeft,width:220,fontWeight:700},children:"COURSE CODE"}),a.jsx("td",{style:{...cr.tdLeft,...cr.cellGreen},children:a.jsx("input",{value:l.courseCode,readOnly:!0,disabled:!0,"aria-disabled":"true",title:"Course code is locked",style:{width:"100%",border:"none",background:"transparent",fontSize:13,outline:"none",cursor:"not-allowed",color:"#234451"}})})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...cr.tdLeft,fontWeight:700},children:"COURSE NAME"}),a.jsx("td",{style:{...cr.tdLeft,...cr.cellGreen},children:a.jsx("input",{value:l.courseName,readOnly:!0,disabled:!0,"aria-disabled":"true",title:"Course name is locked",style:{width:"100%",border:"none",background:"transparent",fontSize:13,outline:"none",cursor:"not-allowed",color:"#234451"}})})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...cr.tdLeft,fontWeight:700},children:"CREDIT OF THE COURSE"}),a.jsx("td",{style:{...cr.tdLeft,...cr.cellGreen},children:a.jsx("input",{value:l.credit,onChange:ie=>c(Y=>({...Y,credit:ie.target.value})),style:{width:"100%",border:"none",background:"transparent",fontSize:13,outline:"none"}})})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...cr.tdLeft,fontWeight:700},children:"COURSE MODULE"}),a.jsx("td",{style:{...cr.tdLeft,...cr.cellGreen},children:a.jsx("input",{value:l.courseModule,onChange:ie=>c(Y=>({...Y,courseModule:ie.target.value})),style:{width:"100%",border:"none",background:"transparent",fontSize:13,outline:"none"}})})]})]})}),a.jsx("div",{style:{height:16}}),a.jsx("div",{style:cr.sectionTitle,children:"STEP 1: Identifying Learner profile"}),a.jsxs("table",{style:cr.table,children:[a.jsxs("colgroup",{children:[a.jsx("col",{style:{width:220}}),a.jsx("col",{style:{width:200}}),a.jsx("col",{style:{width:200}}),a.jsx("col",{style:{width:200}}),a.jsx("col",{style:{width:100}}),a.jsx("col",{style:{width:60}})]}),a.jsxs("thead",{children:[a.jsxs("tr",{children:[a.jsx("th",{style:cr.thLeft,colSpan:4,children:"1.1 CURRENT GPA PROFILE (CGP)"}),a.jsx("th",{style:cr.th,rowSpan:3,colSpan:2,children:"LEVEL"})]}),a.jsxs("tr",{children:[a.jsx("th",{style:cr.thLeft,children:"Current batch mean GPA"}),a.jsx("th",{style:cr.th,children:"1"}),a.jsx("th",{style:cr.th,children:"2"}),a.jsx("th",{style:cr.th,children:"3"})]}),a.jsxs("tr",{children:[a.jsx("th",{style:cr.thLeft,children:"GPA"}),a.jsx("th",{style:cr.th,children:"0 - 5"}),a.jsx("th",{style:cr.th,children:"5 - 7.5"}),a.jsx("th",{style:cr.th,children:"> 7.5"})]})]}),a.jsx("tbody",{children:a.jsxs("tr",{children:[a.jsx("td",{style:{...cr.tdLeft,fontWeight:700},children:"NUMBER OF STUDENTS (CAY-1)"}),a.jsx("td",{style:{...cr.td,...cr.cellYellow},children:a.jsx(Op,{value:u.band1,onChange:ie=>d(Y=>({...Y,band1:ie}))})}),a.jsx("td",{style:{...cr.td,...cr.cellYellow},children:a.jsx(Op,{value:u.band2,onChange:ie=>d(Y=>({...Y,band2:ie}))})}),a.jsx("td",{style:{...cr.td,...cr.cellYellow},children:a.jsx(Op,{value:u.band3,onChange:ie=>d(Y=>({...Y,band3:ie}))})}),a.jsx("td",{style:{...cr.td,fontWeight:800,color:"#0b4a6f"},colSpan:2,children:f})]})})]}),a.jsx("div",{style:{height:14}}),a.jsxs("table",{style:cr.table,children:[a.jsxs("colgroup",{children:[a.jsx("col",{style:{width:220}}),a.jsx("col",{style:{width:200}}),a.jsx("col",{style:{width:200}}),a.jsx("col",{style:{width:200}}),a.jsx("col",{style:{width:100}}),a.jsx("col",{style:{width:60}})]}),a.jsxs("thead",{children:[a.jsxs("tr",{children:[a.jsx("th",{style:cr.thLeft,colSpan:4,children:"1.2 PRE REQUISITE PROFILE (PRP)"}),a.jsx("th",{style:cr.th,children:"LEVEL"}),a.jsx("th",{style:cr.th,children:" "})]}),a.jsxs("tr",{children:[a.jsx("th",{style:cr.thLeft,children:" "}),a.jsx("th",{style:cr.th,children:"1"}),a.jsx("th",{style:cr.th,children:"2"}),a.jsx("th",{style:cr.th,children:"3"}),a.jsx("th",{style:cr.th,children:" "}),a.jsx("th",{style:cr.th,children:" "})]}),a.jsxs("tr",{children:[a.jsx("th",{style:cr.thLeft,children:" "}),a.jsx("th",{style:cr.th,children:"0 - 5"}),a.jsx("th",{style:cr.th,children:"5 - 7.5"}),a.jsx("th",{style:cr.th,children:"> 7.5"}),a.jsx("th",{style:cr.th,children:" "}),a.jsx("th",{style:cr.th,children:" "})]})]}),a.jsxs("tbody",{children:[h.map((ie,Y)=>a.jsxs("tr",{children:[a.jsx("td",{style:{...cr.tdLeft,fontWeight:700},children:ie.name}),a.jsx("td",{style:{...cr.td,...cr.cellYellow},children:a.jsx(Op,{value:ie.band1,onChange:C=>p(K=>{const H=[...K];return H[Y]={...H[Y],band1:C},H})})}),a.jsx("td",{style:{...cr.td,...cr.cellYellow},children:a.jsx(Op,{value:ie.band2,onChange:C=>p(K=>{const H=[...K];return H[Y]={...H[Y],band2:C},H})})}),a.jsx("td",{style:{...cr.td,...cr.cellYellow},children:a.jsx(Op,{value:ie.band3,onChange:C=>p(K=>{const H=[...K];return H[Y]={...H[Y],band3:C},H})})}),a.jsx("td",{style:{...cr.td,fontWeight:800,color:"#0b4a6f"},children:m[Y]}),a.jsx("td",{style:{...cr.td},children:a.jsx("button",{type:"button",title:"Delete prerequisite","aria-label":`Delete ${ie.name}`,onClick:()=>p(C=>C.filter((K,H)=>H!==Y)),style:{background:"transparent",border:"none",cursor:"pointer",fontSize:16},children:""})})]},ie.name)),a.jsx("tr",{children:a.jsxs("td",{style:{...cr.tdLeft},colSpan:6,children:[a.jsx("button",{type:"button",style:{...cr.btn,padding:"6px 10px"},onClick:()=>p(ie=>[...ie,{name:`Prerequisite ${ie.length+1}`,band1:"",band2:"",band3:""}]),"aria-label":"Add prerequisite",children:"+"}),a.jsx("span",{style:{marginLeft:10,fontSize:13,color:"#557085"},children:"Add next prerequisite"})]})}),a.jsxs("tr",{children:[a.jsx("td",{style:{...cr.tdLeft,fontWeight:700},colSpan:5,children:"AVERAGE"}),a.jsx("td",{style:{...cr.td,fontWeight:800},children:g===""?"-":g})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...cr.tdLeft,fontWeight:700},colSpan:5,children:"Standardized level of Learner profile as per the above norms"}),a.jsx("td",{style:{...cr.td,...cr.cellGreen,fontWeight:900,color:"#0b4a6f"},children:b==="-"?"-":b})]})]})]}),a.jsx("div",{style:{height:14}}),a.jsx("table",{style:cr.table,children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...cr.tdLeft,...cr.cellGreen,fontWeight:900},children:"LOW LEVEL"}),a.jsx("td",{style:{...cr.td,...cr.cellGreen,fontWeight:900},children:"LL"}),a.jsx("td",{style:{...cr.td,...cr.cellGreen,fontWeight:900},children:"1"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...cr.tdLeft,...cr.cellGreen,fontWeight:900},children:"MEDIUM LEVEL"}),a.jsx("td",{style:{...cr.td,...cr.cellGreen,fontWeight:900},children:"ML"}),a.jsx("td",{style:{...cr.td,...cr.cellGreen,fontWeight:900},children:"2"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...cr.tdLeft,...cr.cellGreen,fontWeight:900},children:"HIGH LEVEL"}),a.jsx("td",{style:{...cr.td,...cr.cellGreen,fontWeight:900},children:"HL"}),a.jsx("td",{style:{...cr.td,...cr.cellGreen,fontWeight:900},children:"3"})]})]})}),a.jsx("div",{style:{height:14}}),a.jsx("table",{style:cr.table,children:a.jsx("tbody",{children:a.jsxs("tr",{children:[a.jsx("td",{style:{...cr.tdLeft,fontWeight:800,width:220},children:"The Learners are at"}),a.jsx("td",{style:{...cr.td,...cr.cellGreen,fontWeight:900},children:v.label}),a.jsx("td",{style:{...cr.td,...cr.cellGreen,fontWeight:900},children:v.code})]})})}),a.jsx("div",{style:{height:14}}),a.jsx("table",{style:cr.table,children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...cr.tdLeft,fontWeight:900,width:260},children:a.jsx(es,{style:cr.link,to:`${de}/lca/pbr`,children:"PREVIOUS BATCH RESULT (PBR)"})}),a.jsx("td",{style:{...cr.td,...cr.cellGreen,fontWeight:900},children:q==="-"?"":q}),a.jsx("td",{style:{...cr.td,...cr.cellGreen,fontWeight:900},children:j?"COURSE LEVEL (CAY-2)":"COURSE LEVEL (CAY-1)"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...cr.tdLeft,fontWeight:700},children:" "}),a.jsx("td",{style:{...cr.td,...cr.cellGreen,fontWeight:900},children:S?`Mean GPA: ${S.meanGpa}`:""}),a.jsx("td",{style:{...cr.td,...cr.cellGreen,fontWeight:900},children:j?`Mean GPA: ${j.meanGpa}`:""})]})]})}),a.jsx("div",{style:{height:12}}),a.jsx("table",{style:cr.table,children:a.jsx("tbody",{children:a.jsxs("tr",{children:[a.jsx("td",{style:{...cr.tdLeft,fontWeight:900,width:260},children:"Learner Centric Level"}),a.jsx("td",{style:{...cr.td,...cr.cellGreen,fontWeight:900},children:se})]})})})]}))}const Bn={page:{padding:28,maxWidth:1100,margin:"18px auto",fontFamily:"Inter, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial",color:"#1f3947"},card:{background:"#fff",borderRadius:12,padding:18,border:"1px solid #e6eef8",boxShadow:"0 6px 20px rgba(13,60,100,0.04)"},headerRow:{display:"flex",gap:12,alignItems:"center",flexWrap:"wrap",marginBottom:12},label:{color:"#557085",fontSize:12,fontWeight:700},codeBox:{background:"#fbfdff",border:"1px solid #e6eef8",padding:"10px 14px",borderRadius:8,fontWeight:800,color:"#0b4a6f",fontSize:18},nameBox:{background:"#fff",padding:"6px 10px",color:"#234451"},sectionTitle:{marginTop:8,marginBottom:12,color:"#0b3b57",fontSize:16,fontWeight:700},table:{width:"100%",borderCollapse:"collapse",marginTop:12},th:{background:"#f3f8ff",color:"#0b4a6f",fontWeight:700,padding:"12px",border:"1px solid #e6eef8",textAlign:"center",fontSize:13},td:{padding:"12px",border:"1px solid #eef6fb",color:"#234451",fontSize:13,textAlign:"center"},tdLeft:{padding:"10px",border:"1px solid #eef6fb",color:"#234451",fontSize:13,textAlign:"left"},checkbox:{transform:"scale(1.2)",cursor:"pointer",margin:"0"},inputNumber:{width:80,padding:"6px 8px",borderRadius:6,border:"1px solid #d1e3f0",textAlign:"center"}};function kK({courseCode:e=" ",courseName:t=" ",embedded:r=!1,onClose:n}){const i=dl(),s=xo(),o=r?{padding:12,maxWidth:980,width:"100%",margin:"0 auto"}:Bn.page,[l,c]=x.useState(""),[u,d]=x.useState(()=>{var de;const q=t&&t.trim()?t.trim():"",U=((de=i.state)==null?void 0:de.courseName)||"",se=new URLSearchParams(i.search).get("name")||"";return q||U||se||""}),f=u||l||"",[h,p]=x.useState(()=>{try{const q=new URLSearchParams(i.search),U=q.get("teaching_assignment_id")||q.get("teachingAssignmentId");if(!U)return null;const se=Number(U);return Number.isFinite(se)?se:null}catch{return null}}),[m,g]=x.useState(null),[y,b]=x.useState(null),[v,w]=x.useState(()=>Array(5).fill(null)),[S,k]=x.useState({ico:.4,bco:.3,aco:.1,api:.1,iic:.1}),[j,A]=x.useState(Array.from({length:5},()=>({aco:null,api:null,iic:null})));function L(q,U){const se=Math.pow(10,U);return Math.round((q+Number.EPSILON)*se)/se}function P(q,U=2,se=!0){if(q==null||q==="")return se?null:0;const de=Number(q);if(!Number.isFinite(de))return se?null:0;const z=L(de,U);return z<0?0:z}x.useEffect(()=>{let q=!0;return(async()=>{try{if(!e)return;const U=await B4(e,typeof h=="number"?h:void 0);if(!q||!U)return;g(U);const se=Array.isArray(U.units)?U.units:[],de=[],z=G=>{if(!Number.isFinite(G))return null;const ie=L(G,2),Y=L(ie*3,2);return Y===0?null:Y};for(let G=0;G<5;G++){const ie=se[G];if(!ie||!Array.isArray(ie.rows)||ie.rows.length===0){de.push([]);continue}const Y=ie.rows,C=Y.reduce((J,V)=>{const X=Number(V.hours);return J+(Number.isFinite(X)?X:0)},0),K=11,H=3,R=[];for(let J=0;J<K;J++){const V=Y.reduce((X,Q)=>{const ne=Number((Q.po&&Q.po[J])??0);return X+(Number.isFinite(ne)?ne:0)},0);if(C>0){const X=V/C,Q=z(X);Q!=null&&R.push(Q)}}for(let J=0;J<H;J++){const V=Y.reduce((X,Q)=>{const ne=Number((Q.pso&&Q.pso[J])??0);return X+(Number.isFinite(ne)?ne:0)},0);if(C>0){const X=V/C,Q=z(X);Q!=null&&R.push(Q)}}de.push(R)}b(de)}catch{}})(),()=>{q=!1}},[e,h]);const F=on.useMemo(()=>y?y.map(q=>{if(!Array.isArray(q)||q.length===0)return{high:0,med:0,low:0,total:0,ico:0};let U=0,se=0,de=0;q.forEach(Y=>{const C=Number(Y);Number.isFinite(C)&&(C>=1.98?U++:C>=.99?se++:de++)});const z=U*3+se*2+de*1,G=U+se+de,ie=G?L(z/(G*3)*100,2):0;return{high:U,med:se,low:de,total:z,ico:ie}}):null,[y]),E=on.useMemo(()=>v.map(q=>q?q*10:null),[v]),T=on.useMemo(()=>{var U,se,de;const q=[];for(let z=0;z<5;z++){const G=F&&F[z]?F[z].ico:0,ie=E[z]??0,Y=((U=j[z])==null?void 0:U.aco)??0,C=((se=j[z])==null?void 0:se.api)??0,K=((de=j[z])==null?void 0:de.iic)??0,H=G*S.ico+ie*S.bco+Y*S.aco+C*S.api+K*S.iic,R=Math.round(H),J=L(R*.03,2);q.push({weightedRounded:R,final:J})}return q},[F,E,j,S]);x.useEffect(()=>{let q=!0;return(async()=>{try{if(!l&&e&&typeof h=="number"){const U=await B9(e,h);if(!q||!U)return;const se=U.course_name||U.subject_name||U.courseName||U.revision&&(U.revision.course_name||U.revision.courseName||U.revision.subject_name)||"";se&&c(String(se))}}catch{}})(),()=>{q=!1}},[e,l,h]),x.useEffect(()=>{l&&!u&&d(l)},[l,u]),x.useEffect(()=>{let q=!0;return(async()=>{try{if(u||!e)return;try{const U=await fc();if(!q)return;const de=(U||[]).filter(z=>String(z.subject_code)===String(e))[0]||null;if(h==null&&de&&de.id!=null){const z=Number(de.id);Number.isFinite(z)&&p(z)}if(de&&de.subject_name){d(String(de.subject_name));return}}catch{}try{const U=await Sl();if(!q)return;const se=String(e),de=se.toUpperCase(),z=(U||[]).find(G=>String((G==null?void 0:G.course_code)||"").trim()===se||String((G==null?void 0:G.course_code)||"").trim().toUpperCase()===de);if(z&&z.course_name){d(String(z.course_name));return}}catch{}}catch{}})(),()=>{q=!1}},[e,f,u,h]);const B=[{co:"CO1",ico:.4,bco:.3,aco:.1,api:.1,iic:.1,target:68,scale:2.03},{co:"CO2",ico:.4,bco:.3,aco:.1,api:.1,iic:.1,target:66,scale:1.99},{co:"CO3",ico:.4,bco:.3,aco:.1,api:.1,iic:.1,target:67,scale:2.01},{co:"CO4",ico:.4,bco:.3,aco:.1,api:.1,iic:.1,target:67,scale:2.02},{co:"CO5",ico:0,bco:.5,aco:0,api:0,iic:0,target:74,scale:2.22}];return a.jsx("div",{style:o,children:a.jsxs("div",{style:Bn.card,children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:12,marginBottom:12},children:[a.jsxs("div",{style:Bn.headerRow,children:[a.jsxs("div",{children:[a.jsx("div",{style:Bn.label,children:"COURSE CODE"}),a.jsx("div",{style:Bn.codeBox,children:e})]}),a.jsxs("div",{style:{marginLeft:12},children:[a.jsx("div",{style:Bn.label,children:"COURSE NAME"}),a.jsx("div",{style:Bn.nameBox,children:f})]})]}),a.jsx("div",{children:r?n?a.jsx("button",{onClick:n,style:{padding:"8px 12px",borderRadius:8,border:"1px solid #e6eef8",background:"#fff",cursor:"pointer",fontWeight:700},children:"Close"}):null:a.jsx("button",{onClick:()=>s(-1),style:{padding:"8px 12px",borderRadius:8,border:"1px solid #e6eef8",background:"#fff",cursor:"pointer",fontWeight:700},children:" Back"})})]}),a.jsxs("div",{style:{...Bn.card,padding:14,marginTop:0},children:[a.jsx("div",{style:Bn.sectionTitle,children:"Course Outcome Attainment  Targets"}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16,marginTop:12},children:[a.jsxs("div",{style:{...Bn.card,padding:16,minHeight:140},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"1. Rubrics for Impact (ICO)"}),a.jsxs("table",{style:Bn.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:Bn.th,children:"CO"}),a.jsx("th",{style:Bn.th,children:"High (3)"}),a.jsx("th",{style:Bn.th,children:"Medium (2)"}),a.jsx("th",{style:Bn.th,children:"Low (1)"}),a.jsx("th",{style:Bn.th,children:"Total"}),a.jsx("th",{style:Bn.th,children:"ICO"})]})}),a.jsx("tbody",{children:["CO1","CO2","CO3","CO4","CO5"].map((q,U)=>{const se=F&&F[U]?F[U]:{high:0,med:0,low:0,total:0,ico:0};return a.jsxs("tr",{children:[a.jsx("td",{style:Bn.tdLeft,children:q}),a.jsx("td",{style:Bn.td,children:se.high}),a.jsx("td",{style:Bn.td,children:se.med}),a.jsx("td",{style:Bn.td,children:se.low}),a.jsx("td",{style:Bn.td,children:se.total}),a.jsxs("td",{style:Bn.td,children:[se.ico.toFixed(2),"%"]})]},q)})})]})]}),a.jsxs("div",{style:{...Bn.card,padding:16,minHeight:140},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"2. BTL Level (BCO)"}),a.jsxs("table",{style:Bn.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:Bn.th,children:"CO"}),a.jsx("th",{style:Bn.th,children:"BTL-1"}),a.jsx("th",{style:Bn.th,children:"BTL-2"}),a.jsx("th",{style:Bn.th,children:"BTL-3"}),a.jsx("th",{style:Bn.th,children:"BTL-4"}),a.jsx("th",{style:Bn.th,children:"BTL-5"}),a.jsx("th",{style:Bn.th,children:"BTL-6"}),a.jsx("th",{style:Bn.th,children:"BCO"})]})}),a.jsx("tbody",{children:["CO1","CO2","CO3","CO4","CO5"].map((q,U)=>a.jsxs("tr",{children:[a.jsx("td",{style:Bn.tdLeft,children:q}),Array.from({length:6},(se,de)=>{const z=de+1,G=v[U]===z;return a.jsx("td",{style:Bn.td,children:a.jsx("input",{type:"checkbox","aria-label":`BTL-${z} for ${q}`,style:Bn.checkbox,checked:!!G,onChange:()=>{w(ie=>{const Y=[...ie];return Y[U]===z?Y[U]=null:Y[U]=z,Y})},disabled:v[U]!=null&&v[U]!==z,title:v[U]!=null&&v[U]!==z?"Disabled while another BTL is selected":`Select BTL-${z}`})},z)}),a.jsx("td",{style:Bn.td,children:E[U]??""})]},q))})]})]}),a.jsxs("div",{style:{...Bn.card,padding:16,minHeight:120},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"3. Last year's Average CO attainment (ACO)"}),a.jsxs("table",{style:Bn.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:Bn.th,children:"COs"}),a.jsx("th",{style:Bn.th,children:"SUB"})]})}),a.jsx("tbody",{children:B.map((q,U)=>{var se;return a.jsxs("tr",{children:[a.jsx("td",{style:Bn.tdLeft,children:q.co}),a.jsx("td",{style:Bn.td,children:a.jsx("input",{min:0,step:"any",style:Bn.inputNumber,type:"number",value:((se=j[U])==null?void 0:se.aco)??"",onChange:de=>{const z=de.target.value===""?null:de.target.value;A(G=>{const ie=[...G];return ie[U]={...ie[U],aco:z===null?null:Number(z)},ie})},onBlur:de=>{const z=P(de.target.value,2,!0);A(G=>{const ie=[...G];return ie[U]={...ie[U],aco:z},ie})}})})]},q.co)})})]})]}),a.jsxs("div",{style:{...Bn.card,padding:16,minHeight:120},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"4. Average Performance Index (API)"}),a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[a.jsx("div",{style:{border:"1px solid #94a3b8",borderRadius:4,overflow:"hidden",flex:1},children:a.jsx("table",{style:{borderCollapse:"collapse",width:"100%"},children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{padding:8,minWidth:220,background:"#fff",fontWeight:700,borderRight:"1px solid #94a3b8"},children:"BATCH (CAY)"}),a.jsx("td",{style:{padding:8,background:"#fde68a",fontWeight:800,textAlign:"center"}})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:8,background:"#fff",borderTop:"1px solid #94a3b8",borderRight:"1px solid #94a3b8"},children:"NO OF SUCCESSFUL"}),a.jsx("td",{style:{padding:8,background:"#fde68a",fontWeight:800,textAlign:"center"}})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:8,background:"#fff",borderTop:"1px solid #94a3b8",borderRight:"1px solid #94a3b8"},children:"MEAN CGPA"}),a.jsx("td",{style:{padding:8,background:"#fde68a",fontWeight:800,textAlign:"center"}})]})]})})}),a.jsxs("div",{style:{flex:1},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"Per-CO API (manual)"}),a.jsxs("table",{style:Bn.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:Bn.th,children:"CO"}),a.jsx("th",{style:Bn.th,children:"API"})]})}),a.jsx("tbody",{children:["CO1","CO2","CO3","CO4","CO5"].map((q,U)=>{var se;return a.jsxs("tr",{children:[a.jsx("td",{style:Bn.tdLeft,children:q}),a.jsx("td",{style:Bn.td,children:a.jsx("input",{min:0,step:"any",style:Bn.inputNumber,type:"number",value:((se=j[U])==null?void 0:se.api)??"",onChange:de=>{const z=de.target.value===""?null:de.target.value;A(G=>{const ie=[...G];return ie[U]={...ie[U],api:z===null?null:Number(z)},ie})},onBlur:de=>{const z=P(de.target.value,2,!0);A(G=>{const ie=[...G];return ie[U]={...ie[U],api:z},ie})}})})]},q)})})]})]})]}),a.jsxs("div",{style:{marginTop:12,display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[a.jsx("div",{style:{color:"#234451",fontWeight:700},children:"Average Performance Index of the student's batch (API) - GPA ="}),a.jsx("div",{style:{border:"2px solid #0b4a6f",padding:"6px 10px",fontWeight:900}}),a.jsx("div",{children:"/100"})]})]}),a.jsxs("div",{style:{...Bn.card,padding:18,minHeight:180},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"5. The Improvement Index on CO attainment (IIC)"}),a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[a.jsx("div",{style:{border:"2px solid #0b3b57",borderRadius:4,overflow:"hidden",width:360,background:"#fff"},children:a.jsx("table",{style:{borderCollapse:"collapse",width:"100%"},children:a.jsxs("tbody",{children:[a.jsx("tr",{children:a.jsx("td",{colSpan:2,style:{padding:12,background:"#f8fafc",fontWeight:800,color:"#0b3b57"},children:"Learner Centric Approach (LCA)"})}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"right",paddingRight:20,fontWeight:700},children:"L3"}),a.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"center",fontWeight:800}})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"right",paddingRight:20,fontWeight:700},children:"L2"}),a.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"center",fontWeight:800}})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"right",paddingRight:20,fontWeight:700},children:"L1"}),a.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"center",fontWeight:800}})]})]})})}),a.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:12,alignItems:"stretch"},children:[a.jsxs("div",{style:{width:"100%"},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:8,textAlign:"center",color:"#0b3b57"},children:"The Course Outcome Attainment Targets"}),a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",border:"2px solid #0b3b57"},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#e6f2ff",color:"#0b3b57"},children:"COs"}),a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#e6f8ff",color:"#0b4a6f"},children:"ICO"}),a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#e6f8ff",color:"#0b4a6f"},children:"BCO"}),a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#fde8f0",color:"#6b213f"},children:"ACO"}),a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#fde8f0",color:"#6b213f"},children:"API"}),a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#fde8f0",color:"#6b213f"},children:"IIC"}),a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#fff7d6",color:"#6b4a00"},children:"COs Targets"}),a.jsx("th",{style:{padding:10,background:"#fff7d6",color:"#6b4a00"},children:"CO TARGET IN 3 POINT SCALE"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderTop:"1px solid #e6eef8",background:"#f3f8ff",fontWeight:700},children:"Weight Values"}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:Bn.inputNumber,type:"number",value:S.ico,onChange:q=>k(U=>({...U,ico:Number(q.target.value||0)})),onBlur:q=>k(U=>({...U,ico:P(q.target.value,2,!1)}))})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:Bn.inputNumber,type:"number",value:S.bco,onChange:q=>k(U=>({...U,bco:Number(q.target.value||0)})),onBlur:q=>k(U=>({...U,bco:P(q.target.value,2,!1)}))})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:Bn.inputNumber,type:"number",value:S.aco,onChange:q=>k(U=>({...U,aco:Number(q.target.value||0)})),onBlur:q=>k(U=>({...U,aco:P(q.target.value,2,!1)}))})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:Bn.inputNumber,type:"number",value:S.api,onChange:q=>k(U=>({...U,api:Number(q.target.value||0)})),onBlur:q=>k(U=>({...U,api:P(q.target.value,2,!1)}))})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:Bn.inputNumber,type:"number",value:S.iic,onChange:q=>k(U=>({...U,iic:Number(q.target.value||0)})),onBlur:q=>k(U=>({...U,iic:P(q.target.value,2,!1)}))})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"}}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"}})]}),["CO-1","CO-2","CO-3","CO-4","CO-5"].map((q,U)=>{var se,de,z,G,ie;return a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb",textAlign:"left",fontWeight:700},children:q}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:F&&F[U]?F[U].ico.toFixed(2)+"%":""}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:E[U]??""}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:Bn.inputNumber,type:"number",value:((se=j[U])==null?void 0:se.aco)??"",onChange:Y=>{const C=Y.target.value===""?null:Y.target.value;A(K=>{const H=[...K];return H[U]={...H[U],aco:C===null?null:Number(C)},H})},onBlur:Y=>{const C=P(Y.target.value,2,!0);A(K=>{const H=[...K];return H[U]={...H[U],aco:C},H})}})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:Bn.inputNumber,type:"number",value:((de=j[U])==null?void 0:de.api)??"",onChange:Y=>{const C=Y.target.value===""?null:Y.target.value;A(K=>{const H=[...K];return H[U]={...H[U],api:C===null?null:Number(C)},H})},onBlur:Y=>{const C=P(Y.target.value,2,!0);A(K=>{const H=[...K];return H[U]={...H[U],api:C},H})}})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:Bn.inputNumber,type:"number",value:((z=j[U])==null?void 0:z.iic)??"",onChange:Y=>{const C=Y.target.value===""?null:Y.target.value;A(K=>{const H=[...K];return H[U]={...H[U],iic:C===null?null:Number(C)},H})},onBlur:Y=>{const C=P(Y.target.value,2,!0);A(K=>{const H=[...K];return H[U]={...H[U],iic:C},H})}})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:((G=T[U])==null?void 0:G.weightedRounded)??""}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:((ie=T[U])==null?void 0:ie.final)??""})]},q)})]})]})]}),a.jsx("div",{style:{width:"100%",background:"#86efac",padding:12,borderRadius:6,border:"2px solid #16a34a",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",fontWeight:700},children:"TARGET TABLE WILL BE GENERATED AUTOMATICALLY"})]})]})]})]})]})]})})}const an={page:{padding:28,maxWidth:1100,margin:"18px auto",fontFamily:"Inter, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial",color:"#1f3947"},card:{background:"#fff",borderRadius:12,padding:18,border:"1px solid #e6eef8",boxShadow:"0 6px 20px rgba(13,60,100,0.04)"},header:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:12,marginBottom:18},titleBlock:{display:"flex",flexDirection:"column"},title:{margin:0,color:"#0b4a6f",fontSize:22,fontWeight:700},subtitle:{marginTop:6,color:"#3d5566",fontSize:13},grid:{display:"grid",gap:16},sectionTitle:{margin:"0 0 10px 0",color:"#0b3b57",fontSize:16},paragraph:{color:"#334e68",lineHeight:1.45,margin:0},table:{width:"100%",borderCollapse:"collapse",marginTop:8},th:{background:"#f3f8ff",color:"#0b4a6f",fontWeight:700,padding:"8px 10px",border:"1px solid #e6eef8",textAlign:"center",fontSize:13},td:{padding:"8px 10px",border:"1px solid #eef6fb",color:"#234451",fontSize:13,textAlign:"center"},note:{color:"#6b8190",fontSize:13},kv:{background:"#fbfdff",padding:10,borderRadius:8,border:"1px solid #e9f3fb",minWidth:160},kvLabel:{fontSize:12,color:"#557085",marginBottom:6},kvValue:{fontWeight:700,color:"#0b4a6f"}};function YPe({title:e,columns:t,rows:r}){return a.jsxs("div",{children:[e&&a.jsx("div",{style:an.sectionTitle,children:e}),a.jsxs("table",{style:an.table,children:[a.jsx("thead",{children:a.jsx("tr",{children:t.map(n=>a.jsx("th",{style:an.th,children:n},n))})}),a.jsx("tbody",{children:r.map((n,i)=>a.jsx("tr",{children:n.map((s,o)=>a.jsx("td",{style:an.td,children:s},o))},i))})]})]})}function jK({courseCode:e,courseName:t,initialTab:r,viewerMode:n}){const i=x.useMemo(()=>e?String(e):"",[e]);xo();const[s,o]=x.useState(r||"instructions");x.useEffect(()=>{r&&o(r)},[r]);const l=[{key:"instructions",label:"LCA Instructions"},{key:"lca",label:"LCA"},{key:"cdap",label:"CDAP"},{key:"articulation",label:"Articulation Matrix"},{key:"cotarget",label:"CO Target"}],c={display:"flex",gap:8,flexWrap:"wrap",marginBottom:12},u=(d,f)=>{const h=s===d,p=()=>{if(d==="cotarget"){o(d);return}o(d)};return a.jsx("button",{onClick:p,style:{padding:"8px 12px",borderRadius:8,border:h?"2px solid #0b4a6f":"1px solid #e6eef8",background:h?"#0b4a6f":"#fbfdff",color:h?"#fff":"#0b4a6f",fontWeight:700,cursor:"pointer"},children:f},f)};return a.jsx("div",{style:an.page,children:a.jsxs("div",{style:{...an.card},children:[a.jsx("div",{style:an.header,children:a.jsxs("div",{style:an.titleBlock,children:[a.jsx("h2",{style:an.title,children:"Learner Centric Approach  Instructions"}),a.jsx("div",{style:an.subtitle,children:"Default LCA planning matrix and instruction-level guidance for course design and assessment."})]})}),a.jsxs("div",{style:{padding:12},children:[a.jsx("div",{style:c,children:l.map(d=>u(d.key,d.label))}),a.jsx("div",{style:{display:"flex",justifyContent:"flex-start",gap:12,flexWrap:"wrap",marginBottom:12},children:a.jsxs("div",{style:an.kv,children:[a.jsx("div",{style:an.kvLabel,children:"Course"}),a.jsx("div",{style:an.kvValue,children:(e||"")+(t?`  ${t}`:"")})]})}),s==="instructions"&&a.jsxs("div",{style:an.grid,children:[a.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:16,alignItems:"start"},children:a.jsxs("div",{style:{...an.card,padding:14,gridColumn:"1 / -1"},children:[a.jsx("div",{style:an.sectionTitle,children:"Overview"}),a.jsx("p",{style:an.paragraph,children:"Use this page to map learner profiles (L1L3) to instruction levels (IL-1..IL-3) and to define assessment distribution. The tables below provide recommended mappings and a sample distribution for course planning."}),a.jsx("div",{style:{marginTop:12},children:a.jsx(YPe,{title:"Learner Profile  Quick Guide",columns:["Profile","Description"],rows:[["L1","Lower CGPA / limited prerequisites"],["L2","Average preparedness"],["L3","High CGPA / strong prerequisites"]]})})]})}),a.jsxs("div",{style:{...an.card,padding:14},children:[a.jsx("div",{style:an.sectionTitle,children:"Instruction Steps (recommended)"}),a.jsxs("ol",{style:{margin:0,paddingLeft:18,color:"#334e68"},children:[a.jsx("li",{style:{marginBottom:8},children:"Identify learner profile (L1 / L2 / L3) for the target offering."}),a.jsx("li",{style:{marginBottom:8},children:"Use IL mapping to determine instruction emphasis across IL-1..IL-3."}),a.jsx("li",{style:{marginBottom:8},children:"Apply distribution when preparing teaching plan and question banks (map PT / CO / BTL)."})]})]}),a.jsxs("div",{style:{display:"grid",gap:12},children:[a.jsxs("div",{style:{...an.card,padding:12},children:[a.jsx("div",{style:an.sectionTitle,children:"Sample Assessment Distribution by Learner Profile"}),a.jsxs("table",{style:an.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:an.th,children:"Learner Profile"}),a.jsx("th",{style:an.th,children:"IL-1 %"}),a.jsx("th",{style:an.th,children:"IL-2 %"}),a.jsx("th",{style:an.th,children:"IL-3 %"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:an.td,children:"L1"}),a.jsx("td",{style:an.td,children:"60"}),a.jsx("td",{style:an.td,children:"30"}),a.jsx("td",{style:an.td,children:"10"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:an.td,children:"L2"}),a.jsx("td",{style:an.td,children:"30"}),a.jsx("td",{style:an.td,children:"50"}),a.jsx("td",{style:an.td,children:"20"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:an.td,children:"L3"}),a.jsx("td",{style:an.td,children:"10"}),a.jsx("td",{style:an.td,children:"40"}),a.jsx("td",{style:an.td,children:"50"})]})]})]})]}),a.jsxs("div",{style:{...an.card,padding:12},children:[a.jsx("div",{style:an.sectionTitle,children:"Current Course  Example Breakdown"}),a.jsxs("table",{style:an.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:an.th,children:"Component"}),a.jsx("th",{style:an.th,children:"IL-1"}),a.jsx("th",{style:an.th,children:"IL-2"}),a.jsx("th",{style:an.th,children:"IL-3"}),a.jsx("th",{style:an.th,children:"Notes"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:an.td,children:"Teaching Hours"}),a.jsx("td",{style:an.td,children:"40%"}),a.jsx("td",{style:an.td,children:"40%"}),a.jsx("td",{style:an.td,children:"20%"}),a.jsx("td",{style:an.td,children:"Blend of lectures and labs"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:an.td,children:"Question Bank"}),a.jsx("td",{style:an.td,children:"50%"}),a.jsx("td",{style:an.td,children:"30%"}),a.jsx("td",{style:an.td,children:"20%"}),a.jsx("td",{style:an.td,children:"Adjust difficulty by profile"})]})]})]}),a.jsx("div",{style:{marginTop:10},children:a.jsx("div",{style:an.note,children:"Tip: Use these templates as starting points and adapt percentages to the specific cohort."})})]}),a.jsxs("div",{style:{...an.card,padding:12},children:[a.jsx("div",{style:an.sectionTitle,children:"IL Mapping"}),a.jsxs("table",{style:an.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:an.th,children:"IL"}),a.jsx("th",{style:an.th,children:"Instruction Focus"}),a.jsx("th",{style:an.th,children:"Typical Assessment Emphasis"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:an.td,children:"IL-1"}),a.jsx("td",{style:an.td,children:"Foundation, concepts, scaffolding"}),a.jsx("td",{style:an.td,children:"More formative; MCQ / guided tasks"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:an.td,children:"IL-2"}),a.jsx("td",{style:an.td,children:"Application and practice"}),a.jsx("td",{style:an.td,children:"Mixture of practical and theory"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:an.td,children:"IL-3"}),a.jsx("td",{style:an.td,children:"Advanced, synthesis, independent work"}),a.jsx("td",{style:an.td,children:"Problem-solving, projects, high-level questions"})]})]})]})]})]})]}),s==="lca"&&a.jsx("fieldset",{disabled:!!n,style:{border:0,padding:0,margin:0},children:i?a.jsx(KPe,{embedded:!0,courseId:i,courseCode:i,courseName:t??void 0}):a.jsxs("div",{style:{...an.card,padding:16},children:[a.jsx("div",{style:an.sectionTitle,children:"LCA"}),a.jsx("div",{style:an.paragraph,children:"Select a course to view the LCA worksheet."})]})}),s==="cdap"&&a.jsx("fieldset",{disabled:!!n,style:{border:0,padding:0,margin:0},children:i?a.jsx("div",{style:{...an.card,padding:12},children:a.jsx(zPe,{courseId:i,showHeader:!1,showCourseInput:!1})}):a.jsxs("div",{style:{...an.card,padding:16},children:[a.jsx("div",{style:an.sectionTitle,children:"CDAP"}),a.jsx("div",{style:an.paragraph,children:"Select a course to open CDAP."})]})}),s==="articulation"&&a.jsx("fieldset",{disabled:!!n,style:{border:0,padding:0,margin:0},children:i?a.jsx(RPe,{embedded:!0,courseId:i}):a.jsxs("div",{style:{...an.card,padding:16},children:[a.jsx("div",{style:an.sectionTitle,children:"Articulation Matrix"}),a.jsx("div",{style:an.paragraph,children:"Select a course to view the articulation matrix."})]})}),s==="cotarget"&&a.jsx("fieldset",{disabled:!!n,style:{border:0,padding:0,margin:0},children:i?a.jsx("div",{style:{...an.card,padding:12},children:a.jsx(kK,{embedded:!0,courseCode:i,courseName:t??void 0,onClose:()=>o("instructions")})}):a.jsxs("div",{style:{...an.card,padding:16},children:[a.jsx("div",{style:an.sectionTitle,children:"CO Target"}),a.jsx("div",{style:an.paragraph,children:"Select a course to view CO Targets."})]})})]})]})})}const XPe=[{key:"q1",label:"Q1",max:2,co:1,btl:1},{key:"q2",label:"Q2",max:2,co:1,btl:3},{key:"q3",label:"Q3",max:2,co:1,btl:4},{key:"q4",label:"Q4",max:2,co:2,btl:1},{key:"q5",label:"Q5",max:2,co:2,btl:1},{key:"q6",label:"Q6",max:2,co:2,btl:2},{key:"q7",label:"Q7",max:16,co:1,btl:2},{key:"q8",label:"Q8",max:16,co:2,btl:3},{key:"q9",label:"Q9",max:16,co:"1&2",btl:5}],QPe=[{key:"q1",label:"Q1",max:2,co:3,btl:1},{key:"q2",label:"Q2",max:2,co:3,btl:3},{key:"q3",label:"Q3",max:2,co:3,btl:4},{key:"q4",label:"Q4",max:2,co:4,btl:1},{key:"q5",label:"Q5",max:2,co:4,btl:1},{key:"q6",label:"Q6",max:2,co:4,btl:2},{key:"q7",label:"Q7",max:16,co:3,btl:2},{key:"q8",label:"Q8",max:16,co:4,btl:3},{key:"q9",label:"Q9",max:16,co:"3&4",btl:5}],mj=30,nx={co1:42,co2:42,co3:58,co4:42,co5:42},fN=[{key:"q1",max:2},{key:"q2",max:2},{key:"q3",max:2},{key:"q4",max:2},{key:"q5",max:2},{key:"q6",max:2},{key:"q7",max:2},{key:"q8",max:2},{key:"q9",max:2},{key:"q10",max:2},{key:"q11",max:14},{key:"q12",max:14},{key:"q13",max:14},{key:"q14",max:14},{key:"q15",max:14},{key:"q16",max:10}],AK=[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5,5],gj=fN.reduce((e,t,r)=>e+(AK[r]===5?t.max:0),0),FF=10;function JPe(e,t,r){if(t)return 5;const n=ti(e);return r.includes("model")&&(n==="THEORY"||n==="TCPL"||n==="TCPR")?5:4}function ZPe(e){return Array.from({length:e},(t,r)=>r+1)}const im={ssa1:1.5,cia1:3,formative1:2.5},eOe={THEORY:{ssa1:1.5,cia1:3,formative1:2.5},TCPR:{ssa1:2,cia1:2.5,formative1:2},TCPL:{ssa1:1,cia1:2,formative1:3},LAB:{ssa1:1,cia1:1,formative1:1},PRACTICAL:{ssa1:1,cia1:1,formative1:1},SPECIAL:{ssa1:1.5,cia1:3,formative1:2.5},AUDIT:{ssa1:1.5,cia1:3,formative1:2.5}};function xv(e){if(!e)return im;const t=ti(e);return eOe[t]||im}function bi(e,t,r){return Math.max(t,Math.min(r,e))}function fs(e){return Math.round(e*10)/10}function Pf(e){return Math.round(e*100)/100}function Vl(e){if(e===""||e==null)return null;const t=Number(e);return Number.isFinite(t)?t:null}function ix(e,t){const r=Array.isArray(e)?e:[],n=[];for(let i=0;i<t;i++){const s=r[i];if(s===""||s==null){n.push("");continue}const o=typeof s=="number"?s:Number(s);n.push(Number.isFinite(o)?o:"")}return n}function yv(e){const t=e.filter(r=>typeof r=="number"&&Number.isFinite(r));return t.length?t.reduce((r,n)=>r+n,0)/t.length:null}function xj(e){const t=typeof e=="number"?e:Number(e);if(!Number.isFinite(t))return null;const r=Math.trunc(t);return r>=1&&r<=6?r:null}function BF(e){if(e==="1&2"||e==="both")return"1&2";if(typeof e=="string"){const r=e.trim();if(r==="1&2"||r==="1,2"||r==="1/2"||r==="2/1")return"1&2";if(r==="2")return 2;if(r==="1")return 1}if(Array.isArray(e)){const r=e.map(n=>Number(n)).filter(n=>Number.isFinite(n));if(r.includes(1)&&r.includes(2))return"1&2";if(r.includes(2))return 2;if(r.includes(1))return 1}const t=Number(e);return t===2?2:t===12?"1&2":1}function IF(e){if(e==="3&4"||e==="both")return"3&4";if(typeof e=="string"){const r=e.trim();if(r==="3&4"||r==="3,4"||r==="3/4"||r==="4/3")return"3&4";if(r==="4")return 4;if(r==="3")return 3}if(Array.isArray(e)){const r=e.map(n=>Number(n)).filter(n=>Number.isFinite(n));if(r.includes(3)&&r.includes(4))return"3&4";if(r.includes(4))return 4;if(r.includes(3))return 3}const t=Number(e);return t===4?4:t===3?3:t===34?"3&4":3}function tOe(e){return e==="1&2"?{co1:.5,co2:.5}:e===2?{co1:0,co2:1}:{co1:1,co2:0}}function DF(e,t){const r=e[t];if(!r)return{co1:0,co2:0};if(r.co==="1&2")return{co1:.5,co2:.5};const n=e.some(o=>o.co==="1&2"),i=t===e.length-1,s=String(r.key||"").toLowerCase()==="q9"||String(r.label||"").toLowerCase().includes("q9");return!n&&i&&s?{co1:.5,co2:.5}:tOe(r.co)}function rOe(e){return e==="3&4"?{co3:.5,co4:.5}:e===4?{co3:0,co4:1}:{co3:1,co4:0}}function $F(e,t){const r=e[t];if(!r)return{co3:0,co4:0};if(r.co==="3&4")return{co3:.5,co4:.5};const n=e.some(o=>o.co==="3&4"),i=t===e.length-1,s=String(r.key||"").toLowerCase()==="q9"||String(r.label||"").toLowerCase().includes("q9");return!n&&i&&s?{co3:.5,co4:.5}:rOe(r.co)}function UF(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const o=r.localeCompare(n);if(o)return o}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim();return i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}function bv(e){const{ssaMark:t,ciaMark:r,f1Mark:n,ssaMax:i,ciaMax:s,f1Max:o,ssaW:l,ciaW:c,f1W:u,outOf:d}=e,f=[{mark:t,max:i,w:l},{mark:r,max:s,w:c},{mark:n,max:o,w:u}].filter(g=>Number(g.w||0)>0);if(!f.length||!d||!Number.isFinite(Number(d))||f.some(g=>g.mark==null)||f.some(g=>!g.max||!Number.isFinite(Number(g.max))))return null;const h=f.reduce((g,y)=>g+y.w,0);if(!h)return null;const m=f.reduce((g,y)=>g+y.mark/y.max*y.w,0)/h*d;return Number.isFinite(m)?bi(m,0,d):null}function NK({courseId:e,enabledAssessments:t,classType:r}){const[n,i]=x.useState(null),[s,o]=x.useState(r??null),l=x.useMemo(()=>Array.isArray(t),[t]),c=x.useMemo(()=>{const Me=Array.isArray(t)?t:[];return new Set(Me.map(je=>String(je||"").trim().toLowerCase()).filter(Boolean))},[t]),u=x.useMemo(()=>c.has("model"),[c]),[d,f]=x.useState(null),[h,p]=x.useState(null),m=x.useMemo(()=>l||Ure(s),[l,s]),g=x.useMemo(()=>({ssa1:!m||c.has("ssa1"),ssa2:!m||c.has("ssa2"),formative1:!m||c.has("formative1"),formative2:!m||c.has("formative2"),cia1:!m||c.has("cia1"),cia2:!m||c.has("cia2"),model:!m||c.has("model")}),[m,c]),y=x.useMemo(()=>A3(s)&&!l,[s,l]),b=x.useMemo(()=>ti(s)==="TCPL",[s]),v=x.useMemo(()=>{const Me=ti(s);return(Me==="THEORY"||Me==="TCPL"||Me==="TCPR")&&!!g.model},[s,g.model]),w=x.useMemo(()=>{const Me=Object.entries(g).filter(([je,Mt])=>Mt).map(([je])=>je);return JPe(s,y,Me)},[s,y,g]),S=x.useMemo(()=>ZPe(w),[w]),[k,j]=x.useState([]),[A,L]=x.useState(null),[P,F]=x.useState(null);x.useEffect(()=>{if(!e||P==null||!u){f(null),p(null);return}let Me=!0;return(async()=>{try{const je=await yS("model",String(e),Number(P));if(!Me)return;f(je),p(null)}catch(je){if(!Me)return;f(null),p((je==null?void 0:je.message)||"Failed to fetch MODEL publish status")}})(),()=>{Me=!1}},[e,P,u]);const[E,T]=x.useState(!1),[B,q]=x.useState(null),[U,se]=x.useState([]),[de,z]=x.useState(!1),[G,ie]=x.useState(null),[Y,C]=x.useState({ssa1:{},ssa2:{},f1:{},f2:{},cia1:null,cia2:null}),[K,H]=x.useState({}),[R,J]=x.useState({cia1:null,cia2:null,model:null}),[V,X]=x.useState({lab1:null,lab2:null}),Q=x.useMemo(()=>`co_attainment_cfg_${e}`,[e]),[ne,oe]=x.useState(!1),[O,W]=x.useState(()=>({ssa1:im.ssa1,cia1:im.cia1,formative1:im.formative1})),[ae,I]=x.useState(FF),Z=!!(u&&d&&d.is_published);x.useEffect(()=>{v&&I(Z?30:FF)},[v,Z]);const[me,Te]=x.useState("default"),Ae=on.useRef(null),Be=on.useRef(null),[Ee,ze]=x.useState(null),[Xe,Pt]=x.useState(null),[ft,He]=x.useState(null),[tt,_e]=x.useState(!1),[Se,he]=x.useState(!1),[ye,ht]=x.useState({});x.useEffect(()=>{try{const Me=localStorage.getItem("roles"),je=localStorage.getItem("permissions"),Mt=Me?JSON.parse(Me):[],pt=je?JSON.parse(je):[],Ut=Array.isArray(Mt)?Mt.map(re=>String(re||"").toUpperCase()):[],ir=Array.isArray(pt)?pt.map(re=>String(re||"").toLowerCase()):[],fr=Ut.includes("IQAC"),vr=ir.includes("obe.master.manage");oe(fr||vr)}catch{oe(!1)}},[]),x.useEffect(()=>{let Me=!0;const je=async Mt=>{Me&&ze("Loading IQAC weights");try{const Ut=await wS();if(!Me)return;if(Ut&&typeof Ut=="object"){const ir={...Ut};try{Object.defineProperty(ir,"__source",{value:"server",enumerable:!1})}catch{}Ae.current=ir,He(Object.keys(ir||{}).length||0),Pt(null),ze(`Server weights loaded (${Object.keys(ir||{}).length} class-types)`);const fr=Mt??s;if(fr){const vr=ti(fr),re=ir[vr];if(re&&typeof re=="object"){const le=xv(fr);W({ssa1:Number.isFinite(Number(re.ssa1))?Number(re.ssa1):le.ssa1,cia1:Number.isFinite(Number(re.cia1))?Number(re.cia1):le.cia1,formative1:Number.isFinite(Number(re.formative1))?Number(re.formative1):le.formative1}),Te("server"),ze(`Applied server weights for ${vr}`);return}else ze(`Server weights loaded (${Object.keys(ir||{}).length} keys) but no entry for ${vr}`)}}}catch(Ut){const ir=String((Ut==null?void 0:Ut.message)||Ut||"Unknown error");Pt(ir),ze(`Server fetch failed: ${ir}`)}try{const Ut=Jn("iqac_class_type_weights");if(Ut&&typeof Ut=="object"){const ir={...Ut};try{Object.defineProperty(ir,"__source",{value:"local",enumerable:!1})}catch{}Ae.current=ir,He(Object.keys(ir||{}).length||0);const fr=Mt??s;if(fr){const vr=ti(fr),re=ir[vr];if(re&&typeof re=="object"){const le=xv(fr);W({ssa1:Number.isFinite(Number(re.ssa1))?Number(re.ssa1):le.ssa1,cia1:Number.isFinite(Number(re.cia1))?Number(re.cia1):le.cia1,formative1:Number.isFinite(Number(re.formative1))?Number(re.formative1):le.formative1}),Te("local"),ze(`Applied local weights for ${vr}`);return}else ze(`Local weights loaded (${Object.keys(ir||{}).length} keys) but no entry for ${vr}`)}}}catch(Ut){const ir=String((Ut==null?void 0:Ut.message)||Ut||"Unknown error");Pt(ir),ze(`Local weights read failed: ${ir}`)}const pt=Mt??s;if(pt){const Ut=xv(pt);W(Ut),Te("default"),ze(`Applied class-type defaults for ${ti(pt)}`)}else W(im),Te("default"),ze("Applied general defaults (no class type detected)")};return je(),Be.current=je,()=>{Me=!1}},[s]),x.useEffect(()=>{try{const Me=Be.current;typeof Me=="function"&&Me()}catch{}},[P]),x.useEffect(()=>{try{const Me=Ae.current;if(s&&Me&&typeof Me=="object"){const je=ti(s),Mt=Me[je];if(Mt&&typeof Mt=="object"){const pt=xv(s);W({ssa1:Number.isFinite(Number(Mt.ssa1))?Number(Mt.ssa1):pt.ssa1,cia1:Number.isFinite(Number(Mt.cia1))?Number(Mt.cia1):pt.cia1,formative1:Number.isFinite(Number(Mt.formative1))?Number(Mt.formative1):pt.formative1}),Te(Me.__source==="server"?"server":"local"),ze(`Applied cached mapping for ${je}`),Pt(null)}}}catch{}},[s]),x.useEffect(()=>{let Me=!0;return(async()=>{try{const je=await ku();if(!Me)return;i(je||null)}catch{}})(),()=>{Me=!1}},[e]),x.useEffect(()=>{let Me=!0;return(async()=>{var je;try{const Mt=await fc();if(!Me)return;let pt=(Mt||[]).filter(fr=>fr.subject_code===e);if(pt.length===0)try{const fr=await xr(`/api/academics/teaching-assignments/?subject_code=${encodeURIComponent(String(e||""))}`);if(fr.ok){const vr=await fr.json();pt=(Array.isArray(vr.results)?vr.results:Array.isArray(vr)?vr:vr.items||[])||[]}}catch(fr){console.warn("Server TA list fetch failed:",fr)}j(pt),L(null);const Ut=Jn(`coAttainment_selectedTa_${e}`),ir=typeof Ut=="number"&&pt.some(fr=>fr.id===Ut)&&Ut||(((je=pt[0])==null?void 0:je.id)??null);F(ir)}catch(Mt){if(!Me)return;j([]),F(null),L((Mt==null?void 0:Mt.message)||"Failed to load teaching assignments")}})(),()=>{Me=!1}},[e]),x.useEffect(()=>{!e||P==null||Kn(`coAttainment_selectedTa_${e}`,P)},[e,P]),x.useEffect(()=>{if(r){o(r);return}let Me=!0;return(async()=>{try{const je=(k||[]).find(vr=>vr.id===P)||null,Mt=(je==null?void 0:je.class_type)??null;if(Mt){if(!Me)return;o(Mt);return}const pt=je==null?void 0:je.elective_subject_id;if(pt&&!(je!=null&&je.section_id)){console.log("[COAttainment] Detected elective TA, fetching elective subject details for:",pt);try{const vr=await xr(`/api/curriculum/elective-subjects/${pt}/`);if(vr.ok){const re=await vr.json(),le=re==null?void 0:re.class_type;if(console.log("[COAttainment] Elective subject class_type:",le),le){if(!Me)return;o(le);return}}else console.warn("[COAttainment] Elective subject API returned error:",vr.status)}catch(vr){console.warn("[COAttainment] Failed to fetch elective subject:",vr)}}const Ut=je==null?void 0:je.curriculum_row_id;if(!Ut)try{const vr=String(e).trim().toUpperCase(),re=await Sl();if(!Me)return;const le=(re||[]).find(ke=>String(ke.course_code||"").trim().toUpperCase()===vr),te=(le==null?void 0:le.class_type)??null;if(te){o(te);return}const ue=await Kd();if(!Me)return;const Ne=(ue||[]).find(ke=>String(ke.course_code||"").trim().toUpperCase()===vr);o((Ne==null?void 0:Ne.class_type)??null);return}catch{Me&&o(null);return}const ir=await j3(Number(Ut));if(!Me)return;const fr=(ir==null?void 0:ir.class_type)??null;if(fr){o(fr);return}try{const vr=String(e).trim().toUpperCase(),re=await Kd();if(!Me)return;const le=(re||[]).find(te=>String(te.course_code||"").trim().toUpperCase()===vr);o((le==null?void 0:le.class_type)??null)}catch{o(null)}}catch{Me&&o(null)}})(),()=>{Me=!1}},[k,P,r]),x.useEffect(()=>{Kn(Q,{weights:O})},[Q,O]),x.useEffect(()=>{let Me=!0;return(async()=>{if(P){T(!0),q(null);try{const Mt=(k||[]).find(Ut=>Ut.id===P)||null,pt=[];if(Mt&&Mt.elective_subject_id&&!Mt.section_id){const Ut=Mt.elective_subject_id,ir=await xr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(Ut))}`);if(!ir.ok)throw new Error(`Elective-choices fetch failed: ${ir.status}`);const fr=await ir.json();if(!Me)return;const re=((Array.isArray(fr.results)?fr.results:Array.isArray(fr)?fr:fr.items||[])||[]).map(le=>({id:Number(le.student_id??le.id),reg_no:String(le.reg_no??le.registration_no??le.regno??""),name:String(le.name??le.full_name??le.username??le.student_name??""),section:le.section_name??le.section??null,section_id:le.section_id??null}));if(!Me)return;se(re.filter(le=>Number.isFinite(le.id)).sort(UF))}else{const Ut=await Vc(P);if(!Me)return;const ir=(Ut.students||[]).map(fr=>({id:Number(fr.id),reg_no:String(fr.reg_no??""),name:String(fr.name??""),section:fr.section??null})).filter(fr=>Number.isFinite(fr.id)).sort(UF);se(ir)}}catch(Mt){if(!Me)return;se([]),q((Mt==null?void 0:Mt.message)||"Failed to load roster")}finally{Me&&T(!1)}}})(),()=>{Me=!1}},[P,k]);const Ge=x.useMemo(()=>{var je,Mt;const Me=(Mt=(je=n==null?void 0:n.assessments)==null?void 0:je.cia1)==null?void 0:Mt.questions;return Array.isArray(Me)&&Me.length?Me.map(pt=>({key:String((pt==null?void 0:pt.key)||""),label:String((pt==null?void 0:pt.label)||(pt==null?void 0:pt.key)||""),max:Number((pt==null?void 0:pt.max)||0),co:BF(pt==null?void 0:pt.co),btl:Math.min(6,Math.max(1,Number((pt==null?void 0:pt.btl)||1)))})).filter(pt=>pt.key):XPe},[n]),lt=x.useMemo(()=>{var je,Mt;const Me=(Mt=(je=n==null?void 0:n.assessments)==null?void 0:je.cia2)==null?void 0:Mt.questions;return Array.isArray(Me)&&Me.length?Me.map(pt=>({key:String((pt==null?void 0:pt.key)||""),label:String((pt==null?void 0:pt.label)||(pt==null?void 0:pt.key)||""),max:Number((pt==null?void 0:pt.max)||0),co:IF(pt==null?void 0:pt.co),btl:Math.min(6,Math.max(1,Number((pt==null?void 0:pt.btl)||1)))})).filter(pt=>pt.key):QPe},[n]),jt=x.useMemo(()=>{let Me=0,je=0;const Mt=Ge||[];return Mt.forEach((pt,Ut)=>{const ir=DF(Mt,Ut);Me+=(Number(pt.max)||0)*ir.co1,je+=(Number(pt.max)||0)*ir.co2}),{co1:Me,co2:je}},[Ge]),wt=x.useMemo(()=>{let Me=0,je=0;const Mt=lt||[];return Mt.forEach((pt,Ut)=>{const ir=$F(Mt,Ut);Me+=(Number(pt.max)||0)*ir.co3,je+=(Number(pt.max)||0)*ir.co4}),{co3:Me,co4:je}},[lt]),yt=x.useMemo(()=>{var De,We,st,zt,Wt,xt,Dt,Vt,gr,sr,Lr,Zr,Er,qt,zr,bn,or,kr;const Me=((De=n==null?void 0:n.assessments)==null?void 0:De.ssa1)||{},je=((We=n==null?void 0:n.assessments)==null?void 0:We.ssa2)||{},Mt=((st=n==null?void 0:n.assessments)==null?void 0:st.formative1)||{},pt=((zt=n==null?void 0:n.assessments)==null?void 0:zt.formative2)||{},Ut=((Wt=n==null?void 0:n.assessments)==null?void 0:Wt.cia1)||{},ir=((xt=n==null?void 0:n.assessments)==null?void 0:xt.cia2)||{},fr=Number((Dt=Me==null?void 0:Me.coMax)==null?void 0:Dt.co1),vr=Number((Vt=Me==null?void 0:Me.coMax)==null?void 0:Vt.co2),re=Number(((gr=je==null?void 0:je.coMax)==null?void 0:gr.co3)??((sr=je==null?void 0:je.coMax)==null?void 0:sr.co1)),le=Number(((Lr=je==null?void 0:je.coMax)==null?void 0:Lr.co4)??((Zr=je==null?void 0:je.coMax)==null?void 0:Zr.co2)),te=Number((Er=Ut==null?void 0:Ut.coMax)==null?void 0:Er.co1),ue=Number((qt=Ut==null?void 0:Ut.coMax)==null?void 0:qt.co2),Ne=Number(((zr=ir==null?void 0:ir.coMax)==null?void 0:zr.co3)??((bn=ir==null?void 0:ir.coMax)==null?void 0:bn.co1)),ke=Number(((or=ir==null?void 0:ir.coMax)==null?void 0:or.co4)??((kr=ir==null?void 0:ir.coMax)==null?void 0:kr.co2)),vt=Number(Mt==null?void 0:Mt.maxCo),rt=Number(pt==null?void 0:pt.maxCo);return{ssa1:{co1:Number.isFinite(fr)?Math.max(0,fr):10,co2:Number.isFinite(vr)?Math.max(0,vr):10},ssa2:{co3:Number.isFinite(re)?Math.max(0,re):10,co4:Number.isFinite(le)?Math.max(0,le):10},cia1:{co1:Number.isFinite(te)?Math.max(0,te):jt.co1,co2:Number.isFinite(ue)?Math.max(0,ue):jt.co2},cia2:{co3:Number.isFinite(Ne)?Math.max(0,Ne):wt.co3,co4:Number.isFinite(ke)?Math.max(0,ke):wt.co4},f1:{co1:Number.isFinite(vt)?Math.max(0,vt):10,co2:Number.isFinite(vt)?Math.max(0,vt):10},f2:{co3:Number.isFinite(rt)?Math.max(0,rt):10,co4:Number.isFinite(rt)?Math.max(0,rt):10}}},[n,jt,wt]),Fr=x.useMemo(()=>{if(!y)return null;const Me=nx.co1,je=nx.co2,Mt=nx.co3,pt=nx.co4,Ut=nx.co5;return{co1:Me,co2:je,co3:Mt,co4:pt,co5:Ut,total:fs(Me+je+Mt+pt+Ut)}},[y]),Tt=async()=>{z(!0),ie(null);const Me=typeof P=="number"?P:void 0;try{if(H({}),X({lab1:null,lab2:null}),y){let je=null,Mt=null,pt=null;try{je=await po("cia1",e,Me)}catch(Ut){H(ir=>({...ir,lab_cia1:String((Ut==null?void 0:Ut.message)||Ut)}))}try{Mt=await po("cia2",e,Me)}catch(Ut){H(ir=>({...ir,lab_cia2:String((Ut==null?void 0:Ut.message)||Ut)}))}try{pt=await Rm(e,Me)}catch(Ut){H(ir=>({...ir,lab_model:String((Ut==null?void 0:Ut.message)||Ut)}))}J({cia1:(je==null?void 0:je.data)??null,cia2:(Mt==null?void 0:Mt.data)??null,model:(pt==null?void 0:pt.data)??null});try{if(!(je!=null&&je.data))try{const Ut=await ei("cia1",e,Me);Ut&&Ut.draft&&J(ir=>({...ir,cia1:Ut.draft.data??Ut.draft}))}catch(Ut){H(ir=>({...ir,lab_cia1_draft:String((Ut==null?void 0:Ut.message)||Ut)}))}if(!(Mt!=null&&Mt.data))try{const Ut=await ei("cia2",e,Me);Ut&&Ut.draft&&J(ir=>({...ir,cia2:Ut.draft.data??Ut.draft}))}catch(Ut){H(ir=>({...ir,lab_cia2_draft:String((Ut==null?void 0:Ut.message)||Ut)}))}if(!(pt!=null&&pt.data))try{const Ut=await ei("model",e,Me);Ut&&Ut.draft&&J(ir=>({...ir,model:Ut.draft.data??Ut.draft}))}catch(Ut){H(ir=>({...ir,lab_model_draft:String((Ut==null?void 0:Ut.message)||Ut)}))}}catch{}}if(y)C({ssa1:{},ssa2:{},f1:{},f2:{},cia1:null,cia2:null});else{const je=ti(s)==="TCPL";let Mt=null,pt=null,Ut=null,ir=null,fr=null,vr=null,re=null,le=null;if(g.ssa1)try{Mt=await rg(e,Me)}catch(te){H(ue=>({...ue,ssa1:String((te==null?void 0:te.message)||te)}))}if(g.ssa2)try{pt=await ey(e,Me)}catch(te){H(ue=>({...ue,ssa2:String((te==null?void 0:te.message)||te)}))}if(g.formative1)if(je)try{fr=await po("formative1",e,Me)}catch(te){H(ue=>({...ue,tcpl_lab1:String((te==null?void 0:te.message)||te)}))}else try{Ut=await kS(e,Me)}catch(te){H(ue=>({...ue,formative1:String((te==null?void 0:te.message)||te)}))}if(g.formative2)if(je)try{vr=await po("formative2",e,Me)}catch(te){H(ue=>({...ue,tcpl_lab2:String((te==null?void 0:te.message)||te)}))}else try{ir=await v0("formative2",e,Me)}catch(te){H(ue=>({...ue,formative2:String((te==null?void 0:te.message)||te)}))}if(g.cia1)try{re=await ty(e,Me)}catch(te){H(ue=>({...ue,cia1:String((te==null?void 0:te.message)||te)}))}if(g.cia2)try{le=await w0("cia2",e,Me)}catch(te){H(ue=>({...ue,cia2:String((te==null?void 0:te.message)||te)}))}try{if(g.ssa1&&(!Mt||!(Mt.marks&&Object.keys(Mt.marks||{}).length)))try{const te=await ei("ssa1",e,Me);te&&te.draft&&te.draft.marks&&(Mt={marks:te.draft.marks})}catch(te){H(ue=>({...ue,ssa1_draft:String((te==null?void 0:te.message)||te)}))}if(g.ssa2&&(!pt||!(pt.marks&&Object.keys(pt.marks||{}).length)))try{const te=await ei("ssa2",e,Me);te&&te.draft&&te.draft.marks&&(pt={marks:te.draft.marks})}catch(te){H(ue=>({...ue,ssa2_draft:String((te==null?void 0:te.message)||te)}))}if(g.formative1){if(je){if(!(fr!=null&&fr.data))try{const te=await ei("formative1",e,Me);te&&te.draft&&(fr={data:te.draft.data??te.draft})}catch(te){H(ue=>({...ue,tcpl_lab1_draft:String((te==null?void 0:te.message)||te)}))}}else if(!Ut||!(Ut.marks&&Object.keys(Ut.marks||{}).length))try{const te=await ei("formative1",e,Me);te&&te.draft&&te.draft.marks&&(Ut={marks:te.draft.marks})}catch(te){H(ue=>({...ue,formative1_draft:String((te==null?void 0:te.message)||te)}))}}if(g.formative2){if(je){if(!(vr!=null&&vr.data))try{const te=await ei("formative2",e,Me);te&&te.draft&&(vr={data:te.draft.data??te.draft})}catch(te){H(ue=>({...ue,tcpl_lab2_draft:String((te==null?void 0:te.message)||te)}))}}else if(!ir||!(ir.marks&&Object.keys(ir.marks||{}).length))try{const te=await ei("formative2",e,Me);te&&te.draft&&te.draft.marks&&(ir={marks:te.draft.marks})}catch(te){H(ue=>({...ue,formative2_draft:String((te==null?void 0:te.message)||te)}))}}if(g.cia1&&(!re||!re.data))try{const te=await ei("cia1",e,Me);te&&te.draft&&(re={data:te.draft.data??te.draft})}catch(te){H(ue=>({...ue,cia1_draft:String((te==null?void 0:te.message)||te)}))}if(g.cia2&&(!le||!le.data))try{const te=await ei("cia2",e,Me);te&&te.draft&&(le={data:te.draft.data??te.draft})}catch(te){H(ue=>({...ue,cia2_draft:String((te==null?void 0:te.message)||te)}))}}catch{}je&&X({lab1:(fr==null?void 0:fr.data)??null,lab2:(vr==null?void 0:vr.data)??null}),C({ssa1:Mt!=null&&Mt.marks&&typeof Mt.marks=="object"?Mt.marks:{},ssa2:pt!=null&&pt.marks&&typeof pt.marks=="object"?pt.marks:{},f1:!je&&(Ut!=null&&Ut.marks)&&typeof Ut.marks=="object"?Ut.marks:{},f2:!je&&(ir!=null&&ir.marks)&&typeof ir.marks=="object"?ir.marks:{},cia1:(re==null?void 0:re.data)??null,cia2:(le==null?void 0:le.data)??null})}}catch(je){C({ssa1:{},ssa2:{},f1:{},f2:{},cia1:null,cia2:null}),J({cia1:null,cia2:null,model:null}),X({lab1:null,lab2:null}),ie((je==null?void 0:je.message)||"Failed to load published marks")}finally{z(!1)}};x.useEffect(()=>{e&&Tt()},[e,P,y,g,s]),x.useEffect(()=>{const Me=je=>{try{const Mt=(je==null?void 0:je.detail)||{},pt=Mt.subjectId,Ut=Mt.assessment;if(!pt||String(pt)!==String(e)||Ut&&!["ssa1","formative1","cia1"].includes(String(Ut)))return;Tt()}catch{}};return window.addEventListener("obe:published",Me),()=>window.removeEventListener("obe:published",Me)},[e]);const hr=x.useMemo(()=>{const Me=new Map;if(y){const rt=mj/2,De=(Wt,xt,Dt)=>{const Vt=Wt!=null&&Wt.sheet&&typeof Wt.sheet=="object"?Wt.sheet:{},gr=Vt!=null&&Vt.rowsByStudentId&&typeof Vt.rowsByStudentId=="object"?Vt.rowsByStudentId:{},sr=bi(Number((Vt==null?void 0:Vt.expCountA)??0),0,12),Lr=bi(Number((Vt==null?void 0:Vt.expCountB)??0),0,12),Zr=!!(Vt!=null&&Vt.coAEnabled),Er=!!(Vt!=null&&Vt.coBEnabled),qt=!!(Vt!=null&&Vt.ciaExamEnabled),zr=Vt!=null&&Vt.coConfigs&&typeof Vt.coConfigs=="object"?Vt.coConfigs:null,bn=zr?zr[String(xt)]:null,or=Dt!=null&&zr?zr[String(Dt)]:null,kr=bn?!!bn.enabled:Zr,Tr=Dt!=null?or?!!or.enabled:Er:!1,Or=bn?bi(Number(bn.expCount??0),0,12):sr,Gt=Dt!=null?or?bi(Number(or.expCount??0),0,12):Lr:0,ur=bn&&Number.isFinite(Number(bn.expMax))?Number(bn.expMax):Number.isFinite(Number(Vt==null?void 0:Vt.expMaxA))?Number(Vt.expMaxA):25,Ve=Dt!=null?or&&Number.isFinite(Number(or.expMax))?Number(or.expMax):Number.isFinite(Number(Vt==null?void 0:Vt.expMaxB))?Number(Vt.expMaxB):25:0,Rt=ur+(qt?rt:0),_t=Dt!=null?Ve+(qt?rt:0):0;return{get:Ue=>{const Ct=gr[String(Ue)]||{},et=Ct!=null&&Ct.marksByCo&&typeof Ct.marksByCo=="object"?Ct.marksByCo:{},ut=(et==null?void 0:et[String(xt)])??Ct.marksA,Bt=Dt!=null?(et==null?void 0:et[String(Dt)])??Ct.marksB:[],Kt=ix(ut,Or).slice(0,kr?Or:0),Jt=ix(Bt,Gt).slice(0,Tr?Gt:0),ar=yv(Kt),nt=yv(Jt),Ht=Ct==null?void 0:Ct.ciaExam,Pe=typeof Ht=="number"&&Number.isFinite(Ht)?Ht:null,Ot=ar!=null||nt!=null||Pe!=null,mt=Ot?(ar??0)+(qt?(Pe??0)/2:0):null,Nt=Ot?(nt??0)+(qt?(Pe??0)/2:0):null;return{a:mt==null?null:bi(mt,0,Rt),b:Nt==null?null:bi(Nt,0,_t)}},coA:xt,coB:Dt,CO_MAX_A:Rt,CO_MAX_B:_t,expMaxA:ur,expMaxB:Ve,expCountA:Or,expCountB:Gt}},We=De(R.cia1,1,2),st=De(R.cia2,3,4),zt=De(R.model,5,null);for(const Wt of U){const xt=We.get(Wt.id),Dt=st.get(Wt.id),Vt=zt.get(Wt.id);Me.set(Wt.id,{co1:xt.a,co2:xt.b,co3:Dt.a,co4:Dt.b,co5:Vt.a,coMax1:We.CO_MAX_A,coMax2:We.CO_MAX_B,coMax3:st.CO_MAX_A,coMax4:st.CO_MAX_B,coMax5:zt.CO_MAX_A})}return Me}const je=ti(s)==="TCPL",Mt=rt=>{const De=rt!=null&&rt.sheet&&typeof rt.sheet=="object"?rt.sheet:{},We=De!=null&&De.rowsByStudentId&&typeof De.rowsByStudentId=="object"?De.rowsByStudentId:{},st=bi(Number((De==null?void 0:De.expCountA)??0),0,12),zt=bi(Number((De==null?void 0:De.expCountB)??0),0,12),Wt=Number.isFinite(Number(De==null?void 0:De.expMaxA))?Number(De.expMaxA):25,xt=Number.isFinite(Number(De==null?void 0:De.expMaxB))?Number(De.expMaxB):25,Dt=(De==null?void 0:De.ciaExamEnabled)!==!1,Vt=mj/2,gr=Wt+(Dt?Vt:0),sr=xt+(Dt?Vt:0);return{get:Zr=>{const Er=We[String(Zr)]||{},qt=ix(Er==null?void 0:Er.marksA,st),zr=ix(Er==null?void 0:Er.marksB,zt),bn=yv(qt),or=yv(zr),kr=Er==null?void 0:Er.ciaExam,Tr=typeof kr=="number"&&Number.isFinite(kr)?kr:null,Or=bn!=null||or!=null||Tr!=null,Gt=Or?(bn??0)+(Dt?(Tr??0)/2:0):null,ur=Or?(or??0)+(Dt?(Tr??0)/2:0):null;return{a:Gt==null?null:bi(Gt,0,gr),b:ur==null?null:bi(ur,0,sr)}},CO_MAX_A:gr,CO_MAX_B:sr}},pt=je?Mt(V.lab1):null,Ut=je?Mt(V.lab2):null,ir=(()=>{if(!v)return null;const rt=String(P??"none"),De=ti(s),We=[];De==="THEORY"?(We.push(`model_theory_sheet_${e}_${rt}`),We.push(`model_theory_sheet_${e}_none`)):De==="TCPL"?(We.push(`model_tcpl_sheet_${e}_${rt}`),We.push(`model_tcpl_sheet_${e}_none`)):De==="TCPR"&&(We.push(`model_tcpr_sheet_${e}_${rt}`),We.push(`model_tcpr_sheet_${e}_none`)),We.push(`model_sheet_${e}`);for(const st of We){const zt=Jn(st);if(zt&&typeof zt=="object")return zt}return null})(),fr=rt=>{const De=ti(s),We=ir&&typeof ir=="object"?ir:null,Wt=De==="THEORY"?gj:0;if(!v)return{mark:null,max:Wt};if(!We)return{mark:null,max:Wt};let xt=Wt;const Dt=`id:${String(rt.id)}`,Vt=rt.reg_no?`reg:${String(rt.reg_no).trim()}`:"",gr=We[Dt]||(Vt?We[Vt]:null)||null;if(!gr||typeof gr!="object")return{mark:null,max:xt};const sr=!!gr.absent,Lr=String(gr.absentKind||"AL").toUpperCase(),Zr=gr.q&&typeof gr.q=="object"?gr.q:{};let Er=!1,qt=0;if(xt=0,De==="THEORY"){xt=gj;for(let zr=0;zr<fN.length;zr++){const bn=fN[zr],or=Zr[bn.key],kr=Vl(or);if(kr==null)continue;Er=!0;const Tr=bi(kr,0,bn.max);AK[zr]===5&&(qt+=Tr)}}else if(De==="TCPL"||De==="TCPR"){const zr=De==="TCPR",bn=zr?12:15,or=zr?8:10,kr=zr?[1,1,2,2,3,3,4,4,1,2,3,4]:[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5];for(let Gt=0;Gt<bn;Gt++){const ur=Gt+1,Ve=`q${ur}`,Rt=ur<=or?2:16,_t=kr[Gt]??1;_t===5&&(xt+=Rt);const Xt=Zr[Ve],Ue=Vl(Xt);if(Ue==null)continue;Er=!0;const Ct=bi(Ue,0,Rt);_t===5&&(qt+=Ct)}const Tr=Vl(gr.lab);Tr!=null&&(Er=!0);const Or=Tr==null?null:bi(Tr,0,30);zr?(xt+=30,Or!=null&&(qt+=Or)):(xt+=30/5,Or!=null&&(qt+=Or/5))}return Er?sr&&Lr==="AL"?{mark:0,max:xt}:{mark:bi(qt,0,xt),max:xt}:sr&&Lr==="AL"?{mark:0,max:xt}:{mark:null,max:xt}},vr=Y.f1&&typeof Y.f1=="object"?Y.f1:{},re=Y.f2&&typeof Y.f2=="object"?Y.f2:{},le=Y.cia1&&typeof Y.cia1=="object"?Y.cia1:null,te=Array.isArray(le==null?void 0:le.questions)?le.questions.map(rt=>({key:String((rt==null?void 0:rt.key)||""),label:String((rt==null?void 0:rt.label)||(rt==null?void 0:rt.key)||""),max:Number((rt==null?void 0:rt.max)||0),co:BF(rt==null?void 0:rt.co),btl:Math.min(6,Math.max(1,Number((rt==null?void 0:rt.btl)||1)))})).filter(rt=>rt.key):Ge,ue=le!=null&&le.rowsByStudentId&&typeof le.rowsByStudentId=="object"?le.rowsByStudentId:{},Ne=Y.cia2&&typeof Y.cia2=="object"?Y.cia2:null,ke=Array.isArray(Ne==null?void 0:Ne.questions)?Ne.questions.map(rt=>({key:String((rt==null?void 0:rt.key)||""),label:String((rt==null?void 0:rt.label)||(rt==null?void 0:rt.key)||""),max:Number((rt==null?void 0:rt.max)||0),co:IF(rt==null?void 0:rt.co),btl:Math.min(6,Math.max(1,Number((rt==null?void 0:rt.btl)||1)))})).filter(rt=>rt.key):lt,vt=Ne!=null&&Ne.rowsByStudentId&&typeof Ne.rowsByStudentId=="object"?Ne.rowsByStudentId:{};for(const rt of U){const De=(Y.ssa1&&typeof Y.ssa1=="object"?Y.ssa1[String(rt.id)]:null)??null,We=De==null?null:Number(De)/2,st=We==null?null:bi(We,0,yt.ssa1.co1),zt=We==null?null:bi(We,0,yt.ssa1.co2),Wt=(Y.ssa2&&typeof Y.ssa2=="object"?Y.ssa2[String(rt.id)]:null)??null,xt=Wt==null?null:Number(Wt)/2,Dt=xt==null?null:bi(xt,0,yt.ssa2.co3),Vt=xt==null?null:bi(xt,0,yt.ssa2.co4),gr=je&&pt?pt.get(rt.id):null,sr=je&&Ut?Ut.get(rt.id):null,Lr=vr[String(rt.id)]||{},Zr=Vl(Lr==null?void 0:Lr.skill1),Er=Vl(Lr==null?void 0:Lr.skill2),qt=Vl(Lr==null?void 0:Lr.att1),zr=Vl(Lr==null?void 0:Lr.att2),bn=je?(gr==null?void 0:gr.a)??null:Zr!=null&&qt!=null?bi(Zr+qt,0,yt.f1.co1):null,or=je?(gr==null?void 0:gr.b)??null:Er!=null&&zr!=null?bi(Er+zr,0,yt.f1.co2):null,kr=re[String(rt.id)]||{},Tr=Vl(kr==null?void 0:kr.skill1),Or=Vl(kr==null?void 0:kr.skill2),Gt=Vl(kr==null?void 0:kr.att1),ur=Vl(kr==null?void 0:kr.att2),Ve=je?(sr==null?void 0:sr.a)??null:Tr!=null&&Gt!=null?bi(Tr+Gt,0,yt.f2.co3):null,Rt=je?(sr==null?void 0:sr.b)??null:Or!=null&&ur!=null?bi(Or+ur,0,yt.f2.co4):null,_t=ue[String(rt.id)]||{},Xt=!!(_t!=null&&_t.absent),Ue=_t!=null&&_t.q&&typeof _t.q=="object"?_t.q:{};let Ct=null,et=null;if(!Xt){let Ht=0,Pe=0,Ot=!1;te.forEach((mt,Nt)=>{const er=Ue==null?void 0:Ue[mt.key],pr=Vl(er);if(pr==null)return;Ot=!0;const we=bi(pr,0,Number(mt.max)||pr),Ie=DF(te,Nt);Ht+=we*Ie.co1,Pe+=we*Ie.co2}),Ot&&(Ct=bi(Ht,0,yt.cia1.co1),et=bi(Pe,0,yt.cia1.co2))}const ut=vt[String(rt.id)]||{},Bt=!!(ut!=null&&ut.absent),Kt=ut!=null&&ut.q&&typeof ut.q=="object"?ut.q:{};let Jt=null,ar=null;if(!Bt){let Ht=0,Pe=0,Ot=!1;ke.forEach((mt,Nt)=>{const er=Kt==null?void 0:Kt[mt.key],pr=Vl(er);if(pr==null)return;Ot=!0;const we=bi(pr,0,Number(mt.max)||pr),Ie=$F(ke,Nt);Ht+=we*Ie.co3,Pe+=we*Ie.co4}),Ot&&(Jt=bi(Ht,0,yt.cia2.co3),ar=bi(Pe,0,yt.cia2.co4))}const nt=v?fr(rt):{mark:null,max:0};Me.set(rt.id,{ssaCo1:st,ssaCo2:zt,ssaCo3:Dt,ssaCo4:Vt,ciaCo1:Ct,ciaCo2:et,ciaCo3:Jt,ciaCo4:ar,f1Co1:bn,f1Co2:or,f2Co3:Ve,f2Co4:Rt,modelCo5:nt.mark,modelCo5Max:nt.max})}return Me},[Y,R,V,U,yt,Ge,y,s,e,P,v]),rn=x.useMemo(()=>{if(!b)return null;const Me=je=>{const Mt=je!=null&&je.sheet&&typeof je.sheet=="object"?je.sheet:{},pt=Number.isFinite(Number(Mt==null?void 0:Mt.expMaxA))?Number(Mt.expMaxA):25,Ut=Number.isFinite(Number(Mt==null?void 0:Mt.expMaxB))?Number(Mt.expMaxB):25,ir=(Mt==null?void 0:Mt.ciaExamEnabled)!==!1,fr=mj/2;return{a:pt+(ir?fr:0),b:Ut+(ir?fr:0)}};return{lab1:Me(V.lab1),lab2:Me(V.lab2)}},[b,V]),en=x.useMemo(()=>{var te,ue,Ne,ke;const Me=b?((te=rn==null?void 0:rn.lab1)==null?void 0:te.a)??yt.f1.co1:yt.f1.co1,je=b?((ue=rn==null?void 0:rn.lab1)==null?void 0:ue.b)??yt.f1.co2:yt.f1.co2,Mt=b?((Ne=rn==null?void 0:rn.lab2)==null?void 0:Ne.a)??yt.f2.co3:yt.f2.co3,pt=b?((ke=rn==null?void 0:rn.lab2)==null?void 0:ke.b)??yt.f2.co4:yt.f2.co4,Ut=(g.ssa1?yt.ssa1.co1:0)+(g.cia1?yt.cia1.co1:0)+(g.formative1?Me:0),ir=(g.ssa1?yt.ssa1.co2:0)+(g.cia1?yt.cia1.co2:0)+(g.formative1?je:0),fr=(g.ssa2?yt.ssa2.co3:0)+(g.cia2?yt.cia2.co3:0)+(g.formative2?Mt:0),vr=(g.ssa2?yt.ssa2.co4:0)+(g.cia2?yt.cia2.co4:0)+(g.formative2?pt:0),re=v?ae:0,le=Ut+ir+fr+vr+re;return{f1MaxCo1:Me,f1MaxCo2:je,f2MaxCo3:Mt,f2MaxCo4:pt,co1:Ut,co2:ir,co3:fr,co4:vr,co5:re,total:le}},[b,rn,yt,g,v,ae]),$r=x.useMemo(()=>{if(y){const rt=Fr||{co1:55,co2:55,co3:55,co4:55,co5:55},De=(Wt,xt)=>Wt==null||!xt?null:fs(Wt/xt*100),We=(Wt,xt)=>Wt==null||!xt?null:Pf(Wt/xt*3),st=[R.cia1,R.cia2,R.model].filter(Boolean),zt=Wt=>{const xt=[0,0,0,0,0,0,0],Dt=[0,0,0,0,0,0,0];for(const gr of st){const sr=gr!=null&&gr.sheet&&typeof gr.sheet=="object"?gr.sheet:{},Zr=(sr!=null&&sr.rowsByStudentId&&typeof sr.rowsByStudentId=="object"?sr.rowsByStudentId:{})[String(Wt)]||{},Er=sr!=null&&sr.coConfigs&&typeof sr.coConfigs=="object"?sr.coConfigs:null,qt=Zr!=null&&Zr.marksByCo&&typeof Zr.marksByCo=="object"?Zr.marksByCo:{},zr=!!(sr!=null&&sr.coAEnabled),bn=!!(sr!=null&&sr.coBEnabled),or=bi(Number((sr==null?void 0:sr.expCountA)??0),0,12),kr=bi(Number((sr==null?void 0:sr.expCountB)??0),0,12),Tr=Number.isFinite(Number(sr==null?void 0:sr.expMaxA))?Number(sr.expMaxA):25,Or=Number.isFinite(Number(sr==null?void 0:sr.expMaxB))?Number(sr.expMaxB):25,Gt=Array.isArray(sr==null?void 0:sr.btlA)?sr.btlA:[],ur=Array.isArray(sr==null?void 0:sr.btlB)?sr.btlB:[],Ve=(Rt,_t,Xt,Ue,Ct,et)=>{if(!_t||Xt<=0||!Ue)return;const ut=ix(et,Xt);for(let Bt=0;Bt<Xt;Bt++){const Kt=xj(Ct[Bt]),Jt=typeof ut[Bt]=="number"&&Number.isFinite(ut[Bt])?ut[Bt]:null;if(!Kt||Jt==null)continue;const ar=bi(Jt,0,Ue)*(10/Ue);xt[Kt]+=ar,Dt[Kt]+=1}};if(Er)for(const[Rt,_t]of Object.entries(Er)){const Xt=Number(Rt);if(!Number.isFinite(Xt)||!_t||typeof _t!="object")continue;const Ue=!!_t.enabled,Ct=bi(Number(_t.expCount??0),0,12),et=Number.isFinite(Number(_t.expMax))?Number(_t.expMax):25,ut=Array.isArray(_t.btl)?_t.btl:[],Bt=(qt==null?void 0:qt[String(Xt)])??[];Ve(Xt,Ue,Ct,et,ut,Bt)}else Ve(0,zr,or,Tr,Gt,Zr.marksA),Ve(0,bn,kr,Or,ur,Zr.marksB)}const Vt={};for(let gr=1;gr<=6;gr++)Vt[`btl${gr}`]=Dt[gr]?fs(xt[gr]/Dt[gr]):null,Vt[`btl${gr}Pct`]=Dt[gr]?fs(xt[gr]/Dt[gr]/10*100):null;return Vt};return U.map((Wt,xt)=>{const Dt=hr.get(Wt.id)||{},Vt=typeof Dt.co1=="number"?Dt.co1:null,gr=typeof Dt.co2=="number"?Dt.co2:null,sr=typeof Dt.co3=="number"?Dt.co3:null,Lr=typeof Dt.co4=="number"?Dt.co4:null,Zr=typeof Dt.co5=="number"?Dt.co5:null,Er=zt(Wt.id),qt=[Vt,gr,sr,Lr,Zr].every(zr=>typeof zr=="number")?fs(Vt+gr+sr+Lr+Zr):null;return{sno:xt+1,...Wt,co1:Vt,co1Pct:De(Vt,rt.co1),co1_3pt:We(Vt,rt.co1),co2:gr,co2Pct:De(gr,rt.co2),co2_3pt:We(gr,rt.co2),co3:sr,co3Pct:De(sr,rt.co3),co3_3pt:We(sr,rt.co3),co4:Lr,co4Pct:De(Lr,rt.co4),co4_3pt:We(Lr,rt.co4),co5:Zr,co5Pct:De(Zr,rt.co5),co5_3pt:We(Zr,rt.co5),...Er,total:qt}})}const Me=g.ssa1?O.ssa1:0,je=g.cia1?O.cia1:0,Mt=g.formative1?O.formative1:0,pt=g.ssa2?O.ssa1:0,Ut=g.cia2?O.cia1:0,ir=g.formative2?O.formative1:0,{f1MaxCo1:fr,f1MaxCo2:vr,f2MaxCo3:re,f2MaxCo4:le}=en,te=en.co1,ue=en.co2,Ne=en.co3,ke=en.co4,vt=en.co5;return U.map((rt,De)=>{const We=hr.get(rt.id),st=bv({ssaMark:(We==null?void 0:We.ssaCo1)??null,ciaMark:(We==null?void 0:We.ciaCo1)??null,f1Mark:(We==null?void 0:We.f1Co1)??null,ssaMax:yt.ssa1.co1,ciaMax:yt.cia1.co1,f1Max:fr,ssaW:Me,ciaW:je,f1W:Mt,outOf:te}),zt=bv({ssaMark:(We==null?void 0:We.ssaCo2)??null,ciaMark:(We==null?void 0:We.ciaCo2)??null,f1Mark:(We==null?void 0:We.f1Co2)??null,ssaMax:yt.ssa1.co2,ciaMax:yt.cia1.co2,f1Max:vr,ssaW:Me,ciaW:je,f1W:Mt,outOf:ue}),Wt=bv({ssaMark:(We==null?void 0:We.ssaCo3)??null,ciaMark:(We==null?void 0:We.ciaCo3)??null,f1Mark:(We==null?void 0:We.f2Co3)??null,ssaMax:yt.ssa2.co3,ciaMax:yt.cia2.co3,f1Max:re,ssaW:pt,ciaW:Ut,f1W:ir,outOf:Ne}),xt=bv({ssaMark:(We==null?void 0:We.ssaCo4)??null,ciaMark:(We==null?void 0:We.ciaCo4)??null,f1Mark:(We==null?void 0:We.f2Co4)??null,ssaMax:yt.ssa2.co4,ciaMax:yt.cia2.co4,f1Max:le,ssaW:pt,ciaW:Ut,f1W:ir,outOf:ke}),Dt=st==null||!te?null:fs(st/te*100),Vt=zt==null||!ue?null:fs(zt/ue*100),gr=Wt==null||!Ne?null:fs(Wt/Ne*100),sr=xt==null||!ke?null:fs(xt/ke*100),Lr=typeof(We==null?void 0:We.modelCo5)=="number"&&Number.isFinite(We.modelCo5)?We.modelCo5:null,Zr=typeof(We==null?void 0:We.modelCo5Max)=="number"&&Number.isFinite(We.modelCo5Max)?Math.max(0,We.modelCo5Max):gj,Er=!v||Lr==null||!Zr||!vt?null:bi(Lr/Zr*vt,0,vt),qt=Er==null||!vt?null:fs(Er/vt*100),zr=st==null||!te?null:Pf(st/te*3),bn=zt==null||!ue?null:Pf(zt/ue*3),or=Wt==null||!Ne?null:Pf(Wt/Ne*3),kr=xt==null||!ke?null:Pf(xt/ke*3),Tr=Er==null||!vt?null:Pf(Er/vt*3),Or=[{enabled:te>0,v:st},{enabled:ue>0,v:zt},{enabled:Ne>0,v:Wt},{enabled:ke>0,v:xt},...v?[{enabled:vt>0,v:Er}]:[]];let Gt=!1,ur=!1,Ve=0;for(const _t of Or)if(_t.enabled){if(Gt=!0,typeof _t.v!="number"||!Number.isFinite(_t.v)){ur=!0;break}Ve+=_t.v}const Rt=!Gt||ur?null:fs(Ve);return{sno:De+1,...rt,co1:st,co1Pct:Dt,co1_3pt:zr,co2:zt,co2Pct:Vt,co2_3pt:bn,co3:Wt,co3Pct:gr,co3_3pt:or,co4:xt,co4Pct:sr,co4_3pt:kr,co5:Er,co5Pct:qt,co5_3pt:Tr,total:Rt}})},[U,hr,yt,O,g,v,ae,en,y,Fr,R]),Kr=x.useMemo(()=>{if(y){const fr=vr=>{const re=$r.map(le=>le==null?void 0:le[vr]).filter(le=>typeof le=="number");return re.length?Pf(re.reduce((le,te)=>le+te,0)/re.length):null};return{strength:U.length,co1Avg3pt:fr("co1_3pt"),co2Avg3pt:fr("co2_3pt"),co3Avg3pt:fr("co3_3pt"),co4Avg3pt:fr("co4_3pt"),co5Avg3pt:fr("co5_3pt")}}const Me=$r.map(fr=>fr.co1_3pt).filter(fr=>typeof fr=="number"),je=$r.map(fr=>fr.co2_3pt).filter(fr=>typeof fr=="number"),Mt=$r.map(fr=>fr.co3_3pt).filter(fr=>typeof fr=="number"),pt=$r.map(fr=>fr.co4_3pt).filter(fr=>typeof fr=="number"),Ut=$r.map(fr=>fr.co5_3pt).filter(fr=>typeof fr=="number"),ir=fr=>fr.length?Pf(fr.reduce((vr,re)=>vr+re,0)/fr.length):null;return{strength:U.length,co1Avg3pt:ir(Me),co2Avg3pt:ir(je),co3Avg3pt:ir(Mt),co4Avg3pt:ir(pt),...v?{co5Avg3pt:ir(Ut)}:{}}},[$r,U.length,y,v]),Rn=x.useMemo(()=>{const Me=Number(Fr==null?void 0:Fr.co1);return Number.isFinite(Me)&&Me>0?Me:55},[Fr]),Pr=x.useMemo(()=>{if(!y)return{1:0,2:0,3:0,4:0,5:0,6:0};const Me={1:!1,2:!1,3:!1,4:!1,5:!1,6:!1},je=[R.cia1,R.cia2,R.model].filter(Boolean);for(const Mt of je){const pt=Mt!=null&&Mt.sheet&&typeof Mt.sheet=="object"?Mt.sheet:{},Ut=bi(Number((pt==null?void 0:pt.expCountA)??0),0,12),ir=bi(Number((pt==null?void 0:pt.expCountB)??0),0,12),fr=!!(pt!=null&&pt.coAEnabled),vr=!!(pt!=null&&pt.coBEnabled),re=Array.isArray(pt==null?void 0:pt.btlA)?pt.btlA:[],le=Array.isArray(pt==null?void 0:pt.btlB)?pt.btlB:[];if(fr)for(let te=0;te<Ut;te++){const ue=xj(re[te]);ue&&(Me[ue]=!0)}if(vr)for(let te=0;te<ir;te++){const ue=xj(le[te]);ue&&(Me[ue]=!0)}}return{1:Me[1]?10:0,2:Me[2]?10:0,3:Me[3]?10:0,4:Me[4]?10:0,5:Me[5]?10:0,6:Me[6]?10:0}},[y,R]),Sn={padding:"8px 10px",borderRadius:10,border:"1px solid #e5e7eb",width:90};return a.jsxs("div",{style:{display:"grid",gap:14},children:[(de||G)&&a.jsx("div",{style:{fontSize:12,color:G?"#b91c1c":"#6b7280"},children:de?"Loading published marks":G}),K&&Object.keys(K).length>0&&a.jsx("div",{style:{marginTop:6,fontSize:12},children:Object.entries(K).map(([Me,je])=>je?a.jsxs("div",{style:{color:"#b91c1c"},children:[Me,": ",String(je)]},Me):null)}),a.jsxs("div",{style:{padding:16,borderRadius:12,background:"linear-gradient(180deg,#ffffff, #f6fbff)",border:"1px solid #e6eef8",boxShadow:"0 6px 20px rgba(13, 60, 100, 0.06)"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:18,fontWeight:800,color:"#0b4a6f"},children:y?"CO Attainment (LAB)":"CO Attainment (Summative + Formative)"}),a.jsx("div",{style:{marginTop:6,color:"#264653",fontSize:13},children:y?"Uses published LAB sheets: CIA1 LAB (CO1/CO2) + CIA2 LAB (CO3/CO4) + MODEL LAB (CO5).":"Uses weighted blending per CO: SSA1 + CIA1 + Formative1 (based on your Excel formula)."})]}),a.jsx("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"flex-end"},children:a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"Teaching Assignment / Section"}),a.jsxs("select",{value:P??"",onChange:Me=>F(Me.target.value?Number(Me.target.value):null),style:{padding:"10px 12px",borderRadius:10,border:"1px solid #e5e7eb",minWidth:320},children:[a.jsx("option",{value:"",children:"Select"}),k.map(Me=>{const je=Me.department,Mt=(je==null?void 0:je.short_name)||(je==null?void 0:je.code)||(je==null?void 0:je.name)||Me.department_name||"",pt=Me.semester;return a.jsxs("option",{value:Me.id,children:[Me.section_name," ",pt?` Sem ${pt}`:""," ",Me.academic_year?` ${Me.academic_year}`:""," ",Mt?` ${Mt}`:""]},Me.id)})]})]})})]}),A&&a.jsx("div",{style:{marginTop:10,background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10},children:A}),y?a.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:12,marginTop:12},children:a.jsxs("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #e9f0f7",padding:12},children:[a.jsx("div",{style:{fontWeight:800,color:"#0b3b57",marginBottom:8},children:"LAB CO max"}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["CO max values are pulled from published LAB sheets only.",Fr?a.jsx(a.Fragment,{children:S.map((Me,je)=>{const Mt=`co${Me}`;return a.jsxs(on.Fragment,{children:[je>0&&" | ","CO",Me,": ",a.jsx("b",{children:Fr[Mt]})]},Me)})}):a.jsxs(a.Fragment,{children:[" Each CO max is ",a.jsx("b",{children:Rn}),"."]})]}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Batch strength: ",a.jsx("b",{children:Kr.strength}),S.map(Me=>{const je=`co${Me}Avg3pt`;return a.jsxs(on.Fragment,{children:["| CO",Me," avg (3pt): ",a.jsx("b",{children:Kr[je]??"-"})]},Me)})]})]})}):a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1.2fr 1fr",gap:12,marginTop:12},children:[a.jsxs("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #e9f0f7",padding:12},children:[a.jsx("div",{style:{fontWeight:800,color:"#0b3b57",marginBottom:8},children:"Max marks per CO (P4:P6)"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 120px 120px 120px",gap:8,alignItems:"center"},children:[a.jsx("div",{}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",fontWeight:700},children:"SSA1"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",fontWeight:700},children:"CIA1"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",fontWeight:700},children:"Formative1"}),a.jsx("div",{style:{fontSize:12,fontWeight:700},children:"CO1"}),a.jsx("div",{children:yt.ssa1.co1}),a.jsx("div",{children:yt.cia1.co1}),a.jsx("div",{children:yt.f1.co1}),a.jsx("div",{style:{fontSize:12,fontWeight:700},children:"CO2"}),a.jsx("div",{children:yt.ssa1.co2}),a.jsx("div",{children:yt.cia1.co2}),a.jsx("div",{children:yt.f1.co2})]}),a.jsx("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:S.filter(Me=>Me<=4||v).map((Me,je)=>{const Mt=`co${Me}`,pt=Me===5?ae:en[Mt];return a.jsxs(on.Fragment,{children:[je>0&&a.jsx(a.Fragment,{children:"|"}),"CO",Me," total max: ",a.jsx("b",{children:pt})]},Me)})})]}),a.jsxs("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #e9f0f7",padding:12},children:[a.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[a.jsx("div",{style:{fontWeight:800,color:"#0b3b57",marginBottom:8},children:"Weights (R4:R6)"}),a.jsxs("div",{style:{fontSize:12,color:"#475569"},children:["Source: ",a.jsx("b",{children:me==="server"?"IQAC (server)":me==="local"?"IQAC (local)":"Defaults"})]})]}),Ee&&a.jsx("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:Ee}),Xe&&a.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#b91c1c"},children:["Weights load error: ",Xe]}),ft!=null&&a.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#475569"},children:["Known class-types on server/local: ",ft]}),a.jsx("div",{style:{marginTop:6},children:a.jsxs("button",{onClick:()=>_e(Me=>!Me),style:{background:"transparent",border:"none",color:"#0b66a3",cursor:"pointer",padding:0,fontSize:12},children:[tt?"Hide":"Show"," raw IQAC mapping"]})}),tt&&a.jsx("pre",{style:{marginTop:8,maxHeight:220,overflow:"auto",background:"#0f1724",color:"#e6eef8",padding:10,borderRadius:8},children:JSON.stringify(Ae.current||{},null,2).slice(0,3200)}),a.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["SSA1",a.jsx("input",{type:"number",step:"0.1",value:O.ssa1,onChange:Me=>W(je=>({...je,ssa1:Number(Me.target.value)})),disabled:!ne,style:Sn})]}),a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["CIA1",a.jsx("input",{type:"number",step:"0.1",value:O.cia1,onChange:Me=>W(je=>({...je,cia1:Number(Me.target.value)})),disabled:!ne,style:Sn})]}),a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["Formative1",a.jsx("input",{type:"number",step:"0.1",value:O.formative1,onChange:Me=>W(je=>({...je,formative1:Number(Me.target.value)})),disabled:!ne,style:Sn})]})]}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Batch strength: ",a.jsx("b",{children:Kr.strength})," | CO1 avg (3pt): ",a.jsx("b",{children:Kr.co1Avg3pt??"-"})," | CO2 avg (3pt): ",a.jsx("b",{children:Kr.co2Avg3pt??"-"})]}),a.jsx("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:"Note: CIA1 CO marks are computed from the locally saved CIA1 question-wise sheet."})]})]}),a.jsx("div",{style:{marginTop:12},children:a.jsxs("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #e9f0f7",padding:12},children:[a.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[a.jsx("div",{style:{fontWeight:800,color:"#0b3b57",marginBottom:8},children:"Assessment Weights"}),a.jsxs("div",{style:{fontSize:12,color:"#475569"},children:["Class Type: ",a.jsx("b",{children:s||"Unknown"})," | Source: ",a.jsx("b",{children:me==="server"?"IQAC (server)":me==="local"?"IQAC (local)":"Defaults"})]})]}),Ee&&a.jsx("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:Ee}),Xe&&a.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#b91c1c"},children:["Weights load error: ",Xe]}),a.jsx("div",{style:{marginTop:6},children:a.jsxs("button",{onClick:()=>_e(Me=>!Me),style:{background:"transparent",border:"none",color:"#0b66a3",cursor:"pointer",padding:0,fontSize:12},children:[tt?"Hide":"Show"," raw IQAC mapping"]})}),tt&&a.jsx("pre",{style:{marginTop:8,maxHeight:220,overflow:"auto",background:"#0f1724",color:"#e6eef8",padding:10,borderRadius:8},children:JSON.stringify(Ae.current||{},null,2).slice(0,3200)}),a.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap",marginTop:12},children:[a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["SSA1 Weight",a.jsx("input",{type:"number",step:"0.1",value:O.ssa1,onChange:Me=>W(je=>({...je,ssa1:Number(Me.target.value)})),disabled:!ne,style:Sn})]}),a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["CIA1 Weight",a.jsx("input",{type:"number",step:"0.1",value:O.cia1,onChange:Me=>W(je=>({...je,cia1:Number(Me.target.value)})),disabled:!ne,style:Sn})]}),a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["Formative1 Weight",a.jsx("input",{type:"number",step:"0.1",value:O.formative1,onChange:Me=>W(je=>({...je,formative1:Number(Me.target.value)})),disabled:!ne,style:Sn})]}),v&&a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["CO5 Weightage (MODEL)",a.jsx("input",{type:"number",step:"1",value:ae,onChange:Me=>I(Number(Me.target.value)),disabled:!ne,style:Sn})]})]}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["These weights determine how SSA1, CIA1, and Formative1 assessments contribute to CO attainment calculations.",!ne&&a.jsxs("span",{style:{color:"#059669",fontWeight:600},children:[" Values shown are appropriate defaults for ",s||"this"," class type."]})]})]})})]}),B&&a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10},children:B}),a.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:10},children:a.jsx("button",{onClick:()=>he(!Se),style:{padding:"8px 16px",backgroundColor:Se?"#059669":"#0ea5e9",color:"#fff",border:"none",borderRadius:8,cursor:"pointer",fontWeight:600,fontSize:13},children:Se?"Show CO Columns":"Hide CO Columns"})}),E?a.jsx("div",{style:{color:"#6b7280"},children:"Loading roster"}):a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,overflow:"auto",background:"#fff"},children:y?a.jsxs("table",{style:{borderCollapse:"collapse",width:"100%",minWidth:2100},children:[a.jsxs("thead",{children:[a.jsxs("tr",{children:[a.jsx("th",{rowSpan:2,style:Li,children:"S.No"}),a.jsx("th",{rowSpan:2,style:Li,children:"Section"}),a.jsx("th",{rowSpan:2,style:Li,children:"Register No"}),a.jsx("th",{rowSpan:2,style:Li,children:"Name"}),!Se&&a.jsx(a.Fragment,{children:S.map(Me=>a.jsxs("th",{colSpan:3,style:Of,children:["CO",Me]},`co${Me}`))}),a.jsx("th",{rowSpan:2,style:Li,children:"CQI Entry"}),a.jsx("th",{colSpan:2,style:Of,children:"BTL-1"}),a.jsx("th",{colSpan:2,style:Of,children:"BTL-2"}),a.jsx("th",{colSpan:2,style:Of,children:"BTL-3"}),a.jsx("th",{colSpan:2,style:Of,children:"BTL-4"}),a.jsx("th",{colSpan:2,style:Of,children:"BTL-5"}),a.jsx("th",{colSpan:2,style:Of,children:"BTL-6"}),a.jsxs("th",{rowSpan:2,style:Li,children:["Total / ",fs((Fr==null?void 0:Fr.total)??Rn*5)]})]}),a.jsxs("tr",{children:[!Se&&a.jsx(a.Fragment,{children:S.map(Me=>{const je=`co${Me}`,Mt=(Fr==null?void 0:Fr[je])??Rn;return a.jsxs(on.Fragment,{children:[a.jsx("th",{style:Li,children:Mt}),a.jsx("th",{style:Li,children:"%"}),a.jsx("th",{style:Li,children:"3pt"})]},`co${Me}-cells`)})}),a.jsx("th",{style:Li,children:Pr[1]}),a.jsx("th",{style:Li,children:"%"}),a.jsx("th",{style:Li,children:Pr[2]}),a.jsx("th",{style:Li,children:"%"}),a.jsx("th",{style:Li,children:Pr[3]}),a.jsx("th",{style:Li,children:"%"}),a.jsx("th",{style:Li,children:Pr[4]}),a.jsx("th",{style:Li,children:"%"}),a.jsx("th",{style:Li,children:Pr[5]}),a.jsx("th",{style:Li,children:"%"}),a.jsx("th",{style:Li,children:Pr[6]}),a.jsx("th",{style:Li,children:"%"})]})]}),a.jsx("tbody",{children:$r.map(Me=>a.jsxs("tr",{children:[a.jsx("td",{style:Ii,children:Me.sno}),a.jsx("td",{style:Ii,children:Me.section??""}),a.jsx("td",{style:Ii,children:Me.reg_no}),a.jsx("td",{style:Ii,children:Me.name}),!Se&&a.jsx(a.Fragment,{children:S.map(je=>{const Mt=`co${je}`,pt=`co${je}Pct`,Ut=`co${je}_3pt`;return a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...Ii,textAlign:"center"},children:Me[Mt]==null?"":fs(Me[Mt])}),a.jsx("td",{style:{...Ii,textAlign:"center"},children:Me[pt]==null?"":Me[pt]}),a.jsx("td",{style:{...Ii,textAlign:"center"},children:Me[Ut]==null?"":Me[Ut]})]},`co${je}-row`)})}),a.jsx("td",{style:{...Ii,textAlign:"center"},children:a.jsx("input",{type:"text",value:ye[Me.id]||"",onChange:je=>ht({...ye,[Me.id]:je.target.value}),style:{width:"100%",minWidth:100,padding:"4px 6px",border:"1px solid #d1d5db",borderRadius:4,fontSize:12},placeholder:"Enter CQI"})}),a.jsx("td",{style:{...Ii,textAlign:"center"},children:Me.btl1==null?"":fs(Me.btl1)}),a.jsx("td",{style:{...Ii,textAlign:"center"},children:Me.btl1Pct==null?"":Me.btl1Pct}),a.jsx("td",{style:{...Ii,textAlign:"center"},children:Me.btl2==null?"":fs(Me.btl2)}),a.jsx("td",{style:{...Ii,textAlign:"center"},children:Me.btl2Pct==null?"":Me.btl2Pct}),a.jsx("td",{style:{...Ii,textAlign:"center"},children:Me.btl3==null?"":fs(Me.btl3)}),a.jsx("td",{style:{...Ii,textAlign:"center"},children:Me.btl3Pct==null?"":Me.btl3Pct}),a.jsx("td",{style:{...Ii,textAlign:"center"},children:Me.btl4==null?"":fs(Me.btl4)}),a.jsx("td",{style:{...Ii,textAlign:"center"},children:Me.btl4Pct==null?"":Me.btl4Pct}),a.jsx("td",{style:{...Ii,textAlign:"center"},children:Me.btl5==null?"":fs(Me.btl5)}),a.jsx("td",{style:{...Ii,textAlign:"center"},children:Me.btl5Pct==null?"":Me.btl5Pct}),a.jsx("td",{style:{...Ii,textAlign:"center"},children:Me.btl6==null?"":fs(Me.btl6)}),a.jsx("td",{style:{...Ii,textAlign:"center"},children:Me.btl6Pct==null?"":Me.btl6Pct}),a.jsx("td",{style:{...Ii,textAlign:"center",fontWeight:700},children:Me.total==null?"":Me.total})]},Me.id))})]}):a.jsxs("table",{style:{borderCollapse:"collapse",width:"100%",minWidth:980},children:[a.jsxs("thead",{children:[a.jsxs("tr",{children:[a.jsx("th",{rowSpan:2,style:Li,children:"S.No"}),a.jsx("th",{rowSpan:2,style:Li,children:"Section"}),a.jsx("th",{rowSpan:2,style:Li,children:"Register No"}),a.jsx("th",{rowSpan:2,style:Li,children:"Name"}),!Se&&a.jsx(a.Fragment,{children:S.map(Me=>Me===5&&!v?null:a.jsxs("th",{colSpan:3,style:Of,children:["CO",Me]},`co${Me}`))}),a.jsx("th",{rowSpan:2,style:Li,children:"CQI Entry"}),a.jsxs("th",{rowSpan:2,style:Li,children:["Total / ",en.total]})]}),a.jsx("tr",{children:!Se&&a.jsx(a.Fragment,{children:S.map(Me=>{if(Me===5&&!v)return null;const je=`co${Me}`,Mt=Me===5?ae:en[je];return a.jsxs(on.Fragment,{children:[a.jsx("th",{style:Li,children:Mt}),a.jsx("th",{style:Li,children:"%"}),a.jsx("th",{style:Li,children:"3pt"})]},`co${Me}-cells`)})})})]}),a.jsx("tbody",{children:$r.map(Me=>a.jsxs("tr",{children:[a.jsx("td",{style:Ii,children:Me.sno}),a.jsx("td",{style:Ii,children:Me.section??""}),a.jsx("td",{style:Ii,children:Me.reg_no}),a.jsx("td",{style:Ii,children:Me.name}),!Se&&a.jsx(a.Fragment,{children:S.map(je=>{if(je===5&&!v)return null;const Mt=`co${je}`,pt=`co${je}Pct`,Ut=`co${je}_3pt`;return a.jsxs(on.Fragment,{children:[a.jsx("td",{style:{...Ii,textAlign:"center"},children:Me[Mt]==null?"":fs(Me[Mt])}),a.jsx("td",{style:{...Ii,textAlign:"center"},children:Me[pt]==null?"":Me[pt]}),a.jsx("td",{style:{...Ii,textAlign:"center"},children:Me[Ut]==null?"":Me[Ut]})]},`co${je}-row`)})}),a.jsx("td",{style:{...Ii,textAlign:"center"},children:a.jsx("input",{type:"text",value:ye[Me.id]||"",onChange:je=>ht({...ye,[Me.id]:je.target.value}),style:{width:"100%",minWidth:100,padding:"4px 6px",border:"1px solid #d1d5db",borderRadius:4,fontSize:12},placeholder:"Enter CQI"})}),a.jsx("td",{style:{...Ii,textAlign:"center",fontWeight:700},children:Me.total==null?"":Me.total})]},Me.id))})]})})]})}const Li={border:"1px solid #111827",padding:"8px 8px",background:"#f3f4f6",textAlign:"center",fontWeight:800,fontSize:12,whiteSpace:"nowrap"},Of={...Li,background:"#eaf2ff",color:"#0b4a6f"},Ii={border:"1px solid #111827",padding:"7px 8px",fontSize:12,whiteSpace:"nowrap"},Ca=[1,2,3,4,5];function Is(e){return`co${e}`}function oo(e){return{co1:e,co2:e,co3:e,co4:e,co5:e}}const nOe=[{key:"q1",label:"Q1",max:2,co:1,btl:1},{key:"q2",label:"Q2",max:2,co:1,btl:3},{key:"q3",label:"Q3",max:2,co:1,btl:4},{key:"q4",label:"Q4",max:2,co:2,btl:1},{key:"q5",label:"Q5",max:2,co:2,btl:1},{key:"q6",label:"Q6",max:2,co:2,btl:2},{key:"q7",label:"Q7",max:16,co:1,btl:2},{key:"q8",label:"Q8",max:16,co:2,btl:3},{key:"q9",label:"Q9",max:16,co:"1&2",btl:5}],jd={ssa1:1.5,cia1:3,formative1:2.5},yj=1.74;function Wu(e,t,r){return Math.max(t,Math.min(r,e))}function zF(e){return Math.round(e*100)/100}function vv(e){if(e===""||e==null)return null;const t=Number(e);return Number.isFinite(t)?t:null}function WF(e){const t=s=>!Number.isFinite(s)||s<1||s>5?null:s;if(e==null||e==="")return[1];if(Array.isArray(e)){const s=[];for(const o of e){const l=t(Number(o));l&&!s.includes(l)&&s.push(l)}return s.length?s:[1]}if(typeof e=="number")return[t(e)||1];const r=String(e).trim().toLowerCase();if(!r)return[1];if(r==="both")return[1,2];const n=r.replace(/[^0-9,\/\+&]+/g,"").split(/[,\/\+&]+/g).map(s=>s.trim()).filter(Boolean);if(n.length>1){const s=[];for(const o of n){const l=t(Number(o));l&&!s.includes(l)&&s.push(l)}return s.length?s:[1]}return r==="12"?[1,2]:[t(Number(r))||1]}function iOe(e){const t=oo(0),n=Array.from(new Set((e||[]).filter(Boolean))).filter(s=>Ca.includes(s)),i=n.length||1;for(const s of n.length?n:[1])t[Is(s)]=1/i;return t}function qF(e,t){const r=e[t];if(!r)return oo(0);const n=WF(r.co),i=e.some(c=>WF(c.co).length>1),s=t===e.length-1,o=String(r.key||"").toLowerCase()==="q9"||String(r.label||"").toLowerCase().includes("q9");return iOe(!i&&s&&o?[1,2]:n)}function HF(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const o=r.localeCompare(n);if(o)return o}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim();return i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}function aOe(e){const{ssaMark:t,ciaMark:r,f1Mark:n,ssaMax:i,ciaMax:s,f1Max:o,ssaW:l,ciaW:c,f1W:u}=e;if(t==null||r==null||n==null||!i||!s||!o)return null;const d=l+c+u,f=i+s+o;if(!d||!f)return null;const p=(t/i*l+r/s*c+n/o*u)/d*f;return Number.isFinite(p)?Wu(p,0,f):null}function sOe({courseId:e}){const[t,r]=x.useState(null),n=x.useMemo(()=>`cqi_visible_cos_${e}`,[e]),[i,s]=x.useState(()=>{try{const W=Jn(`cqi_visible_cos_${e}`);if(Array.isArray(W)){const ae=W.map(Z=>Number(Z)).filter(Z=>Ca.includes(Z)),I=Array.from(new Set(ae));return I.length?I:[...Ca]}}catch{}return[...Ca]});x.useEffect(()=>{try{Kn(n,i)}catch{}},[n,i]);const[o,l]=x.useState(null);x.useMemo(()=>ti(o),[o]);const c=x.useMemo(()=>A3(o),[o]),[u,d]=x.useState([]),[f,h]=x.useState(null),[p,m]=x.useState(null),[g,y]=x.useState(!1),[b,v]=x.useState(null),[w,S]=x.useState([]),[k,j]=x.useState(!1),[A,L]=x.useState(null),[P,F]=x.useState({ssa:{},f1:{},cia:null}),[E,T]=x.useState({cia1:null}),[B,q]=x.useState(""),U=x.useMemo(()=>`co_attainment_cfg_${e}`,[e]),[se,de]=x.useState(()=>{const W=Jn(`co_attainment_cfg_${e}`),ae=W==null?void 0:W.weights;return{ssa1:Number.isFinite(Number(ae==null?void 0:ae.ssa1))?Number(ae.ssa1):jd.ssa1,cia1:Number.isFinite(Number(ae==null?void 0:ae.cia1))?Number(ae.cia1):jd.cia1,formative1:Number.isFinite(Number(ae==null?void 0:ae.formative1))?Number(ae.formative1):jd.formative1}}),[z,G]=x.useState("default"),[ie,Y]=x.useState(null);x.useEffect(()=>{let W=!0;return(async()=>{try{const ae=await ku();if(!W)return;r(ae||null)}catch{}})(),()=>{W=!1}},[e]),x.useEffect(()=>{let W=!0;return(async()=>{var ae;try{const I=await fc();if(!W)return;const Z=(I||[]).filter(Ae=>Ae.subject_code===e);d(Z),h(null);const me=Jn(`coAttainment_selectedTa_${e}`),Te=typeof me=="number"&&Z.some(Ae=>Ae.id===me)&&me||(((ae=Z[0])==null?void 0:ae.id)??null);m(Te)}catch(I){if(!W)return;d([]),m(null),h((I==null?void 0:I.message)||"Failed to load teaching assignments")}})(),()=>{W=!1}},[e]),x.useEffect(()=>{!e||p==null||Kn(`coAttainment_selectedTa_${e}`,p)},[e,p]),x.useEffect(()=>{let W=!0;return(async()=>{try{const ae=(u||[]).find(Ae=>Ae.id===p)||null,I=String((ae==null?void 0:ae.class_type)||"").trim();if(I){W&&l(I);return}const Z=ae==null?void 0:ae.curriculum_row_id;if(!Z){W&&l(null);return}const me=await j3(Number(Z));if(!W)return;const Te=String((me==null?void 0:me.class_type)||"").trim();l(Te||null)}catch{W&&l(null)}})(),()=>{W=!1}},[p,u]),x.useEffect(()=>{let W=!0;return(async()=>{if(o){Y("Loading IQAC weights");try{const ae=await wS();if(!W)return;if(ae&&typeof ae=="object"){const I=ti(o),Z=ae[I];if(Z&&typeof Z=="object"){const me={ssa1:Number.isFinite(Number(Z.ssa1))?Number(Z.ssa1):jd.ssa1,cia1:Number.isFinite(Number(Z.cia1))?Number(Z.cia1):jd.cia1,formative1:Number.isFinite(Number(Z.formative1))?Number(Z.formative1):jd.formative1};de(me),G("server"),Y(`Applied server weights for ${I}`);try{Kn(U,{weights:me})}catch{}return}Y(`Server weights loaded but no entry for ${ti(o)}`)}}catch(ae){Y(`Server fetch failed: ${String((ae==null?void 0:ae.message)||ae)}`)}try{const ae=Jn("iqac_class_type_weights");if(ae&&typeof ae=="object"){const I=ti(o),Z=ae[I];if(Z&&typeof Z=="object"){const me={ssa1:Number.isFinite(Number(Z.ssa1))?Number(Z.ssa1):jd.ssa1,cia1:Number.isFinite(Number(Z.cia1))?Number(Z.cia1):jd.cia1,formative1:Number.isFinite(Number(Z.formative1))?Number(Z.formative1):jd.formative1};de(me),G("local"),Y(`Applied local weights for ${I}`);try{Kn(U,{weights:me})}catch{}return}}}catch(ae){Y(`Local read failed: ${String((ae==null?void 0:ae.message)||ae)}`)}}})(),()=>{W=!1}},[o,U]);const C=x.useMemo(()=>{var ae,I;const W=(I=(ae=t==null?void 0:t.assessments)==null?void 0:ae.cia1)==null?void 0:I.questions;return Array.isArray(W)&&W.length?W.map(Z=>({key:String((Z==null?void 0:Z.key)||""),label:String((Z==null?void 0:Z.label)||(Z==null?void 0:Z.key)||""),max:Number((Z==null?void 0:Z.max)||0),co:Z==null?void 0:Z.co,btl:Math.min(6,Math.max(1,Number((Z==null?void 0:Z.btl)||1)))})).filter(Z=>Z.key):nOe},[t]),K=x.useMemo(()=>{const W=oo(0);return C.forEach((ae,I)=>{const Z=qF(C,I);for(const me of Ca)W[Is(me)]+=(Number(ae.max)||0)*(Z[Is(me)]||0)}),W},[C]),H=x.useMemo(()=>{var Ee,ze,Xe;const W=((Ee=t==null?void 0:t.assessments)==null?void 0:Ee.ssa1)||{},ae=((ze=t==null?void 0:t.assessments)==null?void 0:ze.formative1)||{},I=((Xe=t==null?void 0:t.assessments)==null?void 0:Xe.cia1)||{},Z=(Pt,ft)=>{var tt;const He=oo(0);for(const _e of Ca){const Se=Is(_e),he=Number((tt=Pt==null?void 0:Pt.coMax)==null?void 0:tt[Se]);He[Se]=Number.isFinite(he)?Math.max(0,he):ft[Se]}return He},me={...oo(0),co1:10,co2:10},Te=Number(ae==null?void 0:ae.maxCo),Ae={...oo(0),co1:Number.isFinite(Te)?Math.max(0,Te):10,co2:Number.isFinite(Te)?Math.max(0,Te):10},Be=K;return{ssa:Z(W,me),cia:Z(I,Be),f1:Z(ae,Ae)}},[t,K]),R=async()=>{j(!0),L(null);try{if(c){const W=await po("cia1",e);F({ssa:{},f1:{},cia:null}),T({cia1:(W==null?void 0:W.data)??null})}else{const[W,ae,I]=await Promise.all([rg(e),kS(e),ty(e)]);F({ssa:W!=null&&W.marks&&typeof W.marks=="object"?W.marks:{},f1:ae!=null&&ae.marks&&typeof ae.marks=="object"?ae.marks:{},cia:(I==null?void 0:I.data)??null}),T({cia1:null})}}catch(W){F({ssa:{},f1:{},cia:null}),T({cia1:null}),L((W==null?void 0:W.message)||"Failed to load published marks")}finally{j(!1)}};x.useEffect(()=>{e&&R()},[e,c]),x.useEffect(()=>{const W=ae=>{try{const I=(ae==null?void 0:ae.detail)||{},Z=I.subjectId,me=I.assessment;if(!Z||String(Z)!==String(e)||me&&!["ssa1","formative1","cia1"].includes(String(me)))return;R()}catch{}};return window.addEventListener("obe:published",W),()=>window.removeEventListener("obe:published",W)},[e]),x.useEffect(()=>{let W=!0;return(async()=>{if(p){y(!0),v(null);try{const I=(u||[]).find(Z=>Z.id===p)||null;if(I&&I.elective_subject_id&&!I.section_id){const Z=I.elective_subject_id,me=await xr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(Z))}`);if(!me.ok)throw new Error(`Elective-choices fetch failed: ${me.status}`);const Te=await me.json();if(!W)return;const Be=((Array.isArray(Te.results)?Te.results:Array.isArray(Te)?Te:Te.items||[])||[]).map(Ee=>({id:Number(Ee.student_id??Ee.id),reg_no:String(Ee.reg_no??Ee.registration_no??Ee.regno??""),name:String(Ee.name??Ee.full_name??Ee.username??""),section:Ee.section_name??Ee.section??null}));if(!W)return;S(Be.filter(Ee=>Number.isFinite(Ee.id)).sort(HF))}else{const Z=await Vc(p);if(!W)return;const me=(Z.students||[]).map(Te=>({id:Number(Te.id),reg_no:String(Te.reg_no??""),name:String(Te.name??""),section:Te.section??null})).filter(Te=>Number.isFinite(Te.id)).sort(HF);S(me)}}catch(I){if(!W)return;S([]),v((I==null?void 0:I.message)||"Failed to load roster")}finally{W&&y(!1)}}})(),()=>{W=!1}},[p,u]);const J=x.useMemo(()=>{const W=new Map;if(c){const Be=E.cia1,Ee=Be!=null&&Be.sheet&&typeof Be.sheet=="object"?Be.sheet:{},ze=Ee!=null&&Ee.rowsByStudentId&&typeof Ee.rowsByStudentId=="object"?Ee.rowsByStudentId:{},Xe=Wu(Number((Ee==null?void 0:Ee.expCountA)??0),0,12),Pt=Wu(Number((Ee==null?void 0:Ee.expCountB)??0),0,12),ft=!!(Ee!=null&&Ee.coAEnabled),He=!!(Ee!=null&&Ee.coBEnabled),tt=(Se,he)=>{const ye=Array.isArray(Se)?Se:[],ht=[];for(let Ge=0;Ge<he;Ge++){const lt=ye[Ge];if(lt===""||lt==null){ht.push("");continue}const jt=typeof lt=="number"?lt:Number(lt);ht.push(Number.isFinite(jt)?jt:"")}return ht},_e=Se=>{const he=Se.filter(ye=>typeof ye=="number"&&Number.isFinite(ye));return he.length?he.reduce((ye,ht)=>ye+ht,0)/he.length:null};for(const Se of w){const he=ze[String(Se.id)]||{},ye=tt(he.marksA,Xe).slice(0,ft?Xe:0),ht=tt(he.marksB,Pt).slice(0,He?Pt:0),Ge=_e(ye),lt=_e(ht),jt=he==null?void 0:he.ciaExam,wt=typeof jt=="number"&&Number.isFinite(jt)?jt:null,yt=Ge!=null||lt!=null||wt!=null,Fr=yt?(Ge??0)+(wt??0)/2:null,Tt=yt?(lt??0)+(wt??0)/2:null;W.set(Se.id,{ssaCo1:null,ssaCo2:null,ciaCo1:Fr==null?null:Wu(Fr,0,40),ciaCo2:Tt==null?null:Wu(Tt,0,40),f1Co1:null,f1Co2:null,__labCoMax:40})}return W}const ae=new Map;for(const[Ae,Be]of Object.entries(P.ssa||{})){const Ee=Number(Ae);Number.isFinite(Ee)&&ae.set(Ee,vv(Be))}const I=P.f1&&typeof P.f1=="object"?P.f1:{},Z=P.cia&&typeof P.cia=="object"?P.cia:null,me=Array.isArray(Z==null?void 0:Z.questions)?Z.questions.map(Ae=>({key:String((Ae==null?void 0:Ae.key)||""),label:String((Ae==null?void 0:Ae.label)||(Ae==null?void 0:Ae.key)||""),max:Number((Ae==null?void 0:Ae.max)||0),co:Ae==null?void 0:Ae.co,btl:Math.min(6,Math.max(1,Number((Ae==null?void 0:Ae.btl)||1)))})).filter(Ae=>Ae.key):C,Te=Z!=null&&Z.rowsByStudentId&&typeof Z.rowsByStudentId=="object"?Z.rowsByStudentId:{};for(const Ae of w){const Be=ae.get(Ae.id)??null,Ee=Ca.reduce((he,ye)=>he+(H.ssa[Is(ye)]||0),0),ze=oo(null);for(const he of Ca){const ye=Is(he),ht=H.ssa[ye]||0;if(Be==null||!Ee||!ht){ze[ye]=null;continue}const Ge=Be/Ee*ht;ze[ye]=Wu(Ge,0,ht)}const Xe=I[String(Ae.id)]||{},Pt=oo(null);for(const he of Ca){const ye=Is(he),ht=H.f1[ye]||0,Ge=vv(Xe==null?void 0:Xe[`skill${he}`]),lt=vv(Xe==null?void 0:Xe[`att${he}`]);ht&&Ge!=null&&lt!=null?Pt[ye]=Wu(Ge+lt,0,ht):Pt[ye]=null}const ft=Te[String(Ae.id)]||{},He=!!(ft!=null&&ft.absent),tt=ft!=null&&ft.q&&typeof ft.q=="object"?ft.q:{},_e=oo(null);if(!He){const he=oo(0);let ye=!1;if(me.forEach((ht,Ge)=>{const lt=tt==null?void 0:tt[ht.key],jt=vv(lt);if(jt==null)return;ye=!0;const wt=Wu(jt,0,Number(ht.max)||jt),yt=qF(me,Ge);for(const Fr of Ca){const Tt=Is(Fr);he[Tt]+=wt*(yt[Tt]||0)}}),ye)for(const ht of Ca){const Ge=Is(ht),lt=H.cia[Ge]||0;_e[Ge]=lt?Wu(he[Ge],0,lt):null}}const Se={};for(const he of Ca){const ye=Is(he);Se[`ssaCo${he}`]=ze[ye],Se[`f1Co${he}`]=Pt[ye],Se[`ciaCo${he}`]=_e[ye]}W.set(Ae.id,Se)}return W},[P,E,w,H,C,c]),V=x.useMemo(()=>{var me;if(c){const Te=((me=w[0])==null?void 0:me.id)!=null?J.get(w[0].id):null,Ae=Number(Te==null?void 0:Te.__labCoMax),Be=Number.isFinite(Ae)&&Ae>0?Ae:40,Ee=Xe=>Xe==null||!Be?null:zF(Xe/Be*3),ze=(Xe,Pt)=>{if(Xe==null||Pt==null||!Be)return null;const ft=(Xe+Pt)/(2*Be)*100;return Number.isFinite(ft)?Math.round(Wu(ft,0,100)):null};return w.map((Xe,Pt)=>{const ft=J.get(Xe.id)||{},He=oo(null);He.co1=typeof ft.ciaCo1=="number"?ft.ciaCo1:null,He.co2=typeof ft.ciaCo2=="number"?ft.ciaCo2:null;const tt=oo(null),_e=oo(!1);for(const ht of Ca){const Ge=Is(ht);tt[Ge]=Ee(He[Ge]),_e[Ge]=typeof tt[Ge]=="number"&&tt[Ge]<yj}const Se=ze(He.co1,He.co2),he=Ca.map(ht=>_e[Is(ht)]?`CO${ht}`:null).filter(Boolean).join("+"),ye={sno:Pt+1,...Xe,total:Se,cos:he};for(const ht of Ca){const Ge=Is(ht);ye[`${Ge}_3pt`]=tt[Ge],ye[`flagCO${ht}`]=_e[Ge]}return ye})}const W=se.ssa1,ae=se.cia1,I=se.formative1,Z=oo(0);for(const Te of Ca){const Ae=Is(Te);Z[Ae]=(H.ssa[Ae]||0)+(H.cia[Ae]||0)+(H.f1[Ae]||0)}return w.map((Te,Ae)=>{const Be=J.get(Te.id),Ee=oo(null),ze=oo(null),Xe=oo(!1);for(const tt of Ca){const _e=Is(tt),Se=aOe({ssaMark:(Be==null?void 0:Be[`ssaCo${tt}`])??null,ciaMark:(Be==null?void 0:Be[`ciaCo${tt}`])??null,f1Mark:(Be==null?void 0:Be[`f1Co${tt}`])??null,ssaMax:H.ssa[_e]||0,ciaMax:H.cia[_e]||0,f1Max:H.f1[_e]||0,ssaW:W,ciaW:ae,f1W:I});Ee[_e]=Se;const he=Z[_e]||0;ze[_e]=Se==null||!he?null:zF(Se/he*3),Xe[_e]=typeof ze[_e]=="number"&&ze[_e]<yj}const Pt=(()=>{const tt=Ca.map(_e=>Ee[Is(_e)]).filter(_e=>typeof _e=="number"&&Number.isFinite(_e));return tt.length?Math.round(tt.reduce((_e,Se)=>_e+Se,0)):null})(),ft=Ca.map(tt=>Xe[Is(tt)]?`CO${tt}`:null).filter(Boolean).join("+"),He={sno:Ae+1,...Te,total:Pt,cos:ft};for(const tt of Ca){const _e=Is(tt);He[`${_e}_3pt`]=ze[_e],He[`flagCO${tt}`]=Xe[_e]}return He})},[w,J,H,se,c]),X=x.useMemo(()=>{const W=B.trim().toLowerCase();return W?V.filter(ae=>{const I=String(ae.reg_no||"").toLowerCase(),Z=String(ae.name||"").toLowerCase(),me=String(ae.section||"").toLowerCase();return I.includes(W)||Z.includes(W)||me.includes(W)}):V},[V,B]),Q=x.useMemo(()=>{const W=Z=>i.some(me=>!!(Z!=null&&Z[`flagCO${me}`])),ae=V.filter(Z=>W(Z)).length,I={strength:V.length,flagged:ae};for(const Z of Ca)I[`co${Z}`]=V.filter(me=>!!me[`flagCO${Z}`]).length;return I},[V,i]),ne={position:"sticky",top:0,zIndex:2,textAlign:"left",padding:"10px 12px",fontSize:12,letterSpacing:.2,textTransform:"uppercase",color:"#0f172a",background:"linear-gradient(180deg,#eaf6ff,#ffffff)",borderBottom:"1px solid rgba(148, 163, 184, 0.5)",whiteSpace:"nowrap"},oe={padding:"10px 12px",borderBottom:"1px solid rgba(226, 232, 240, 0.9)",fontSize:13,color:"#0f172a",verticalAlign:"middle",whiteSpace:"nowrap"},O=(W,ae)=>{const I=ae==="danger"?{background:"rgba(239, 68, 68, 0.12)",border:"1px solid rgba(239, 68, 68, 0.35)",color:"#991b1b"}:{background:"rgba(2, 132, 199, 0.08)",border:"1px solid rgba(2, 132, 199, 0.25)",color:"#0b4a6f"};return a.jsx("span",{style:{display:"inline-flex",alignItems:"center",height:24,padding:"0 10px",borderRadius:999,fontSize:12,fontWeight:800,...I},children:W})};return a.jsxs("div",{style:{display:"grid",gap:14},children:[a.jsxs("div",{style:{padding:16,borderRadius:14,background:"linear-gradient(135deg,#ffffff,#f0f9ff)",border:"1px solid rgba(226, 232, 240, 0.9)",boxShadow:"0 10px 28px rgba(2, 6, 23, 0.06)"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",alignItems:"flex-end"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:18,fontWeight:950,color:"#0b4a6f"},children:"C1-CQI"}),a.jsxs("div",{style:{marginTop:6,fontSize:13,color:"#334155"},children:["Flags CO1CO5 when 3pt attainment is below ",a.jsx("b",{children:yj}),"."]})]}),a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"flex-end"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"Teaching Assignment / Section"}),a.jsxs("select",{value:p??"",onChange:W=>m(W.target.value?Number(W.target.value):null),style:{padding:"10px 12px",borderRadius:12,border:"1px solid #e2e8f0",minWidth:320,background:"#fff"},children:[a.jsx("option",{value:"",children:"Select"}),u.map(W=>{const ae=W.department,I=(ae==null?void 0:ae.short_name)||(ae==null?void 0:ae.code)||(ae==null?void 0:ae.name)||W.department_name||"",Z=W.semester;return a.jsxs("option",{value:W.id,children:[W.section_name," ",Z?` Sem ${Z}`:""," ",W.academic_year?` ${W.academic_year}`:""," ",I?` ${I}`:""]},W.id)})]})]}),a.jsxs("div",{style:{minWidth:320},children:[a.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"Show CO columns"}),a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center",padding:"10px 12px",borderRadius:12,border:"1px solid #e2e8f0",background:"#fff"},children:[Ca.map(W=>{const ae=i.includes(W);return a.jsxs("label",{style:{display:"inline-flex",gap:8,alignItems:"center",cursor:"pointer",userSelect:"none"},children:[a.jsx("input",{type:"checkbox",checked:ae,onChange:I=>{const Z=I.target.checked?Array.from(new Set([...i,W])):i.filter(me=>me!==W);s(Z)}}),a.jsx("span",{style:{fontSize:12,fontWeight:800,color:"#0f172a"},children:`CO${W}`})]},W)}),a.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:[a.jsx("button",{type:"button",onClick:()=>s([...Ca]),style:{padding:"6px 10px",borderRadius:10,border:"1px solid #e2e8f0",background:"#f8fafc",fontSize:12,fontWeight:800,color:"#0f172a"},children:"All"}),a.jsx("button",{type:"button",onClick:()=>s([]),style:{padding:"6px 10px",borderRadius:10,border:"1px solid #e2e8f0",background:"#fff",fontSize:12,fontWeight:800,color:"#0f172a"},children:"None"})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"Search"}),a.jsx("input",{value:B,onChange:W=>q(W.target.value),placeholder:"Reg no / name / section",style:{padding:"10px 12px",borderRadius:12,border:"1px solid #e2e8f0",width:260}})]})]})]}),(k||A||g||b||f)&&a.jsxs("div",{style:{marginTop:12,display:"grid",gap:8},children:[(k||A)&&a.jsx("div",{style:{fontSize:12,color:A?"#b91c1c":"#64748b"},children:k?"Loading published marks":A}),(g||b)&&a.jsx("div",{style:{fontSize:12,color:b?"#b91c1c":"#64748b"},children:g?"Loading roster":b}),f&&a.jsx("div",{style:{marginTop:4,background:"#fef2f2",border:"1px solid rgba(239, 68, 68, 0.25)",color:"#991b1b",padding:10,borderRadius:12},children:f})]}),a.jsxs("div",{style:{display:"flex",gap:10,marginTop:12,flexWrap:"wrap"},children:[O(`Strength: ${Q.strength}`,"neutral"),O(`Flagged: ${Q.flagged}`,Q.flagged?"danger":"neutral"),i.map(W=>a.jsx(on.Fragment,{children:O(`CO${W} below: ${Q[`co${W}`]??0}`,Q[`co${W}`]?"danger":"neutral")},W))]})]}),a.jsx("div",{style:{borderRadius:14,border:"1px solid rgba(226, 232, 240, 0.9)",overflow:"hidden",background:"#fff",boxShadow:"0 10px 28px rgba(2, 6, 23, 0.06)"},children:a.jsx("div",{style:{maxHeight:"70vh",overflow:"auto"},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"separate",borderSpacing:0},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{...ne,width:70},children:"slno"}),a.jsx("th",{style:{...ne,width:70},children:"SEC"}),a.jsx("th",{style:{...ne,width:160},children:"Reg number"}),a.jsx("th",{style:{...ne,minWidth:260},children:"NAME"}),a.jsx("th",{style:{...ne,width:140},children:"CO's"}),a.jsx("th",{style:{...ne,width:90,textAlign:"center"},children:"100"}),i.map(W=>a.jsx("th",{style:{...ne,width:90,textAlign:"center"},children:`CO${W} (3pt)`},W))]})}),a.jsxs("tbody",{children:[X.map((W,ae)=>{const I=i.some(Be=>!!W[`flagCO${Be}`]),Z=ae%2===0,me=I?"rgba(239, 68, 68, 0.10)":Z?"#ffffff":"#f8fafc",Te=Be=>({...oe,textAlign:"center",fontWeight:900,color:Be?"#991b1b":"#065f46",background:Be?"rgba(239, 68, 68, 0.10)":"rgba(34, 197, 94, 0.10)",borderBottom:"1px solid rgba(226, 232, 240, 0.9)"}),Ae=W.total!=null&&W.total<=58;return a.jsxs("tr",{style:{background:me},children:[a.jsx("td",{style:{...oe,width:70,borderLeft:I?"4px solid rgba(239, 68, 68, 0.55)":"4px solid transparent"},children:W.sno}),a.jsx("td",{style:{...oe,width:70},children:W.section??""}),a.jsx("td",{style:{...oe,width:160,fontFamily:'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace'},children:W.reg_no}),a.jsx("td",{style:{...oe,minWidth:260,fontWeight:800},children:W.name}),a.jsx("td",{style:{...oe,width:140},children:i.some(Be=>!!W[`flagCO${Be}`])?a.jsx("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:i.filter(Be=>!!W[`flagCO${Be}`]).map(Be=>a.jsx(on.Fragment,{children:O(`CO${Be}`,"danger")},Be))}):""}),a.jsx("td",{style:{...oe,width:90,textAlign:"center",fontWeight:900,color:Ae?"#991b1b":"#0f172a",background:Ae?"rgba(239, 68, 68, 0.12)":"transparent"},children:W.total==null?"":Number.isFinite(Number(W.total))?String(Math.round(Number(W.total))):W.total}),i.map(Be=>a.jsx("td",{style:Te(!!W[`flagCO${Be}`]),children:W[`co${Be}_3pt`]==null?"":W[`co${Be}_3pt`]},Be))]},W.id)}),!X.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:6+i.length,style:{padding:18,textAlign:"center",color:"#64748b"},children:"No rows."})})]})]})})})]})}function CK({courseId:e}){return a.jsx(sOe,{courseId:e})}function Fh(e){return String(e||"").trim()}function oOe(){var k,j;const{courseCode:e,taId:t}=z0(),r=xo(),n=dl(),i=x.useMemo(()=>decodeURIComponent(String(e||"")).trim(),[e]),s=x.useMemo(()=>t?Number(t):NaN,[t]),[o,l]=x.useState("marks"),[c,u]=x.useState(null),[d,f]=x.useState(null),[h,p]=x.useState(null),[m,g]=x.useState(null);x.useEffect(()=>{if(!(n!=null&&n.pathname))return;const A=n.pathname.toLowerCase();A.includes("/lca/instructions")||A.includes("/lca_instructions")||A.includes("/lca")||A.includes("/cdap")||A.includes("/articulation")?l("lca_instructions"):A.includes("/marks")?l("marks"):A.includes("/co_attainment")?l("co_attainment"):A.includes("/cqi")?l("cqi"):l("marks")},[n]);const y=x.useMemo(()=>{const A=String((n==null?void 0:n.pathname)||"").toLowerCase();return A.includes("/cdap")?"cdap":A.includes("/articulation")?"articulation":A.includes("/lca")&&!(A.includes("/lca/instructions")||A.includes("/lca_instructions"))?"lca":"instructions"},[n==null?void 0:n.pathname]);x.useEffect(()=>{let A=!0;return(async()=>{if(i)try{const L=await M2(i);if(!A)return;const P=(L||[]).find(F=>Number(F.teaching_assignment_id)===Number(s))||null;u(P)}catch{if(!A)return;u(null)}})(),()=>{A=!1}},[i,s]),x.useEffect(()=>{let A=!0;return(async()=>{if(i)try{const[L,P]=await Promise.all([Sl(),Kd()]);if(!A)return;const F=i.toUpperCase(),E=(L||[]).filter(U=>Fh(U==null?void 0:U.course_code).toUpperCase()===F),T=U=>Fh(U).toUpperCase(),B=E.find(U=>{const se=T(U==null?void 0:U.question_paper_type);return se&&se!=="QP1"})||E.find(U=>T(U==null?void 0:U.question_paper_type))||E.find(U=>Fh(U==null?void 0:U.class_type))||E[0];if(B){if(f(B!=null&&B.class_type?Fh(B.class_type):null),p(B!=null&&B.question_paper_type?Fh(B.question_paper_type):null),ti(B==null?void 0:B.class_type)==="SPECIAL"){g([]);try{const U=await bS(i);g(Array.isArray(U)?U:[])}catch{const U=B==null?void 0:B.enabled_assessments;g(Array.isArray(U)?U.map(se=>String(se).trim().toLowerCase()).filter(Boolean):[])}}else g(null);return}const q=(P||[]).find(U=>Fh(U==null?void 0:U.course_code).toUpperCase()===F);f(q!=null&&q.class_type?Fh(q.class_type):null),p(null),g(null)}catch{}})(),()=>{A=!1}},[i]);const b=x.useMemo(()=>Number.isFinite(s)?[{id:s,subject_id:0,subject_code:i,subject_name:(c==null?void 0:c.course_name)||i,section_id:(c==null?void 0:c.section_id)||0,section_name:(c==null?void 0:c.section_name)||"Section",academic_year:(c==null?void 0:c.academic_year)||""}]:[],[s,i,c]);if(!i||!Number.isFinite(s))return a.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[a.jsx("div",{style:{color:"#b91c1c"},children:"Invalid teaching assignment."}),a.jsx("div",{style:{marginTop:10},children:a.jsx(es,{className:"obe-btn obe-btn-secondary",to:"/iqac/academic-controller?tab=courses",children:"Back"})})]});const v=(c==null?void 0:c.course_name)||i,w=[c==null?void 0:c.section_name,c==null?void 0:c.academic_year].filter(Boolean).join("  "),S=((k=c==null?void 0:c.staff)==null?void 0:k.name)||((j=c==null?void 0:c.staff)==null?void 0:j.username)||"";return a.jsx("main",{className:"obe-course-page",style:{padding:0,fontFamily:"Arial, sans-serif",minHeight:"100vh",background:"#fff"},children:a.jsxs("div",{style:{padding:"0px",width:"100%",minWidth:0,boxSizing:"border-box"},children:[a.jsx("div",{style:{marginBottom:12,padding:18},children:a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{children:[a.jsxs("h2",{style:{margin:0},children:["OBE Viewer - ",i]}),a.jsx("div",{style:{color:"#666",marginTop:6},children:"View-only (IQAC)"}),a.jsx("div",{style:{color:"#222",marginTop:6,fontWeight:800},children:v}),a.jsxs("div",{style:{color:"#374151",marginTop:4},children:[w||"",S?`    ${S}`:"",d?`    ${String(d).toUpperCase()}`:""]}),h?a.jsxs("div",{style:{color:"#374151",marginTop:2},children:["QP Type: ",a.jsx("strong",{style:{color:"#111827"},children:String(h)})]}):null]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx(es,{className:"obe-btn obe-btn-secondary",to:`/iqac/academic-controller/course/${encodeURIComponent(i)}`,children:"Back"}),a.jsx("button",{onClick:()=>r(`/iqac/academic-controller/course/${encodeURIComponent(i)}/marks/${encodeURIComponent(String(s))}`),className:"obe-btn",children:"Mark Entry Only"})]})]})}),a.jsx("div",{className:"obe-tab-nav","aria-label":"OBE Tabs",style:{padding:"0 18px"},children:[{key:"lca_instructions",label:"LCA Instructions"},{key:"marks",label:"Mark Entry"},{key:"co_attainment",label:"CO ATTAINMENT"},{key:"cqi",label:"CQI"}].map(A=>{const L=o===A.key;return a.jsx("button",{onClick:()=>{l(A.key);const P=encodeURIComponent(i),F=encodeURIComponent(String(s)),E=A.key==="lca_instructions"?"lca/instructions":String(A.key);r(`/iqac/academic-controller/course/${P}/obe/${F}/${E}`)},className:`obe-tab-btn ${L?"active":""}`,children:A.label},A.key)})}),a.jsxs("div",{style:{border:"1px solid #eee",borderRadius:10,padding:12,margin:18},children:[o==="lca_instructions"&&a.jsx(jK,{courseCode:i,courseName:(c==null?void 0:c.course_name)||null,initialTab:y,viewerMode:!0}),o!=="lca_instructions"?a.jsxs("fieldset",{disabled:!0,style:{border:0,padding:0,margin:0},children:[o==="co_attainment"&&a.jsx(NK,{courseId:i,enabledAssessments:m}),o==="cqi"&&a.jsx(CK,{courseId:i})]}):null,o==="marks"?a.jsx("div",{children:a.jsx(N6,{subjectId:i,classType:d,questionPaperType:h,enabledAssessments:m,teachingAssignmentsOverride:b,fixedTeachingAssignmentId:s,iqacResetEnabled:!0,viewerMode:!1})}):null]})]})})}function lOe(){const{courseCode:e,taId:t}=z0(),r=String(e||""),n=xo(),[i,s]=x.useState(!0),[o,l]=x.useState(!1),[c,u]=x.useState(null),[d,f]=x.useState(null),h={header:["CO1","CO1","CO1","CO2","CO2","CO2","CO3","CO3","CO3","CO4","CO4","CO4","CO1","CO2","CO3","CO4","CO5"],weights:[1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,2,2,2,2,4],cycles:["ssa","cia","fa","ssa","cia","fa","ssa","cia","fa","ssa","cia","fa","ME","ME","ME","ME","ME"]},p=j=>{const A=Number(j);if(!Number.isFinite(A)||A<=0)return[0,0,0];const L=1.5,P=3,F=2.5,E=L+P+F,T=Math.round(A*L/E*100)/100,B=Math.round(A*P/E*100)/100,q=Math.round(A*F/E*100)/100;return[T,B,q]},m=j=>{const A=j&&typeof j=="object"?j:{};let L=Array.isArray(A.weights)?[...A.weights]:[];if(L=L.map(P=>{const F=Number(P);return Number.isFinite(F)?F:0}),L.length===13){const[P,F,E]=p(L[0]??0),[T,B,q]=p(L[1]??0);L=[P,F,E,T,B,q,...L.slice(2)]}for(;L.length<h.weights.length;)L.push(h.weights[L.length]??0);return L=L.slice(0,h.weights.length),{...A,header:h.header,cycles:h.cycles,weights:L}};x.useEffect(()=>{let j=!0;return(async()=>{s(!0);try{const A=await w9(r);if(!j)return;f(A!=null&&A.mapping?m(A.mapping):null)}catch(A){if(!j)return;u((A==null?void 0:A.message)||String(A))}finally{j&&s(!1)}})(),()=>{j=!1}},[r]);const g=()=>d?m(d):(f(h),h),y=(j,A)=>{const L=A===""?"":Number(A);f(P=>{const F={...P||g()},E=Array.isArray(F.weights)?[...F.weights]:[];return E[j]=L,F.weights=E,F})},b=async()=>{l(!0),u(null);try{const j=m(d??g());await S9(r,j);try{window.dispatchEvent(new CustomEvent("internal-mark:updated",{detail:{subjectId:r}}))}catch{}n(-1)}catch(j){u((j==null?void 0:j.message)||String(j))}finally{l(!1)}};if(i)return a.jsx("div",{style:{padding:18},children:"Loading"});const v=m(d??g()),w=v.header,S=v.weights,k=v.cycles;return a.jsxs("main",{style:{padding:18},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[a.jsxs("h2",{style:{margin:0},children:["Internal Mark Mapping - ",r]}),a.jsxs("div",{style:{display:"flex",gap:8},children:[a.jsx("button",{className:"obe-btn",onClick:()=>n(-1),children:"Back"}),a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:b,disabled:o,children:o?"Saving...":"Save"})]})]}),a.jsx("div",{style:{overflowX:"auto"},children:a.jsxs("table",{style:{borderCollapse:"collapse",width:"100%"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:w.map((j,A)=>a.jsx("th",{style:{border:"1px solid #d1d5db",padding:8,background:"#f3f4f6"},children:j},A))}),a.jsx("tr",{children:k.map((j,A)=>a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb",fontWeight:600},children:j},`cy-${A}`))})]}),a.jsx("tbody",{children:a.jsx("tr",{children:S.map((j,A)=>a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6,background:"#f3f4f6"},children:a.jsx("input",{type:"number",step:"0.1",value:j===""?"":String(j),onChange:L=>y(A,L.target.value),style:{width:70,padding:6}})},A))})})]})}),c?a.jsx("div",{style:{color:"red",marginTop:12},children:c}):null]})}function cOe(){return a.jsx(R9,{})}function wa({user:e,element:t,requiredRoles:r,requiredPermissions:n,requiredProfile:i}){if(!e)return a.jsx(Jp,{to:"/login",replace:!0});const s=(e.roles||[]).map(u=>(u||"").toString().toUpperCase()),o=(e.permissions||[]).map(u=>(u||"").toString().toLowerCase()),l=(e.profile_type||"").toString().toUpperCase();let c=!1;return i&&(i==="STUDENT"&&l==="STUDENT"&&(c=!0),i==="STAFF"&&l==="STAFF"&&(c=!0)),!c&&r&&r.length&&r.map(d=>d.toString().toUpperCase()).some(d=>s.includes(d))&&(c=!0),!c&&n&&n.length&&n.map(d=>d.toString().toLowerCase()).some(d=>o.includes(d))&&(c=!0),!i&&(!r||r.length===0)&&(!n||n.length===0)&&(c=!0),c?t:a.jsx(Jp,{to:"/dashboard",replace:!0})}function bj({user:e}){return a.jsx("div",{className:"fixed inset-0 overflow-hidden bg-gradient-to-br from-blue-50 to-slate-100",children:a.jsx("section",{className:"relative h-full flex items-center justify-center bg-gradient-to-b from-indigo-50 to-white py-0 px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[a.jsx("h1",{className:"text-4xl sm:text-5xl lg:text-6xl font-bold text-gray-900 mb-6",children:"Welcome to IDCS"}),a.jsx("p",{className:"text-lg sm:text-xl text-gray-600 mb-8 max-w-2xl mx-auto",children:"Streamline your academic management with our comprehensive Education Resource Planning system"}),e?a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 max-w-md mx-auto",children:[a.jsxs("p",{className:"text-lg text-gray-700 mb-2",children:["Hello, ",a.jsx("strong",{className:"text-blue-600",children:e.username}),"!"]}),e.roles&&e.roles.length>0&&a.jsxs("p",{className:"text-sm text-gray-500",children:["Role: ",a.jsx("span",{className:"font-semibold text-indigo-600",children:e.roles.join(", ")})]})]}):a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[a.jsx("a",{href:"/login",className:"px-8 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105",children:"Get Started"}),a.jsx("a",{href:"#features",className:"px-8 py-3 bg-white text-blue-600 border-2 border-blue-600 rounded-lg font-semibold hover:bg-blue-50 transition-all duration-200",children:"Learn More"})]})]})})})}function uOe(){return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 sm:p-8 shadow-md",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(W0,{className:"w-7 h-7 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Welcome back"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Welcome to the dashboard."})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md hover:shadow-lg transition-shadow",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center",children:a.jsx(gs,{className:"w-5 h-5 text-emerald-600"})}),a.jsx("h3",{className:"font-semibold text-gray-900",children:"Courses"})]}),a.jsx("p",{className:"text-sm text-gray-600",children:"View your enrolled courses"})]}),a.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md hover:shadow-lg transition-shadow",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:a.jsx(Z1,{className:"w-5 h-5 text-purple-600"})}),a.jsx("h3",{className:"font-semibold text-gray-900",children:"Academics"})]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Access academic resources"})]}),a.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md hover:shadow-lg transition-shadow sm:col-span-2 lg:col-span-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(ys,{className:"w-5 h-5 text-blue-600"})}),a.jsx("h3",{className:"font-semibold text-gray-900",children:"Schedule"})]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Check your timetable"})]})]})]})}function e0({children:e}){return a.jsx(a.Fragment,{children:e})}function dOe(){return a.jsx(e0,{children:a.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 pb-6",children:[a.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-6",children:"Dashboard"}),a.jsx(uOe,{})]})})}function fOe(e){return String(e??"").trim()}function hOe({user:e}){const[t,r]=x.useState(e===void 0?null:e),[n,i]=x.useState(!e),[s,o]=x.useState(null),l=x.useMemo(()=>{var se;return fOe((se=t==null?void 0:t.profile)==null?void 0:se.mobile_number)},[t]),c=x.useMemo(()=>{var se;return!!((se=t==null?void 0:t.profile)!=null&&se.mobile_verified)},[t]),[u,d]=x.useState(""),[f,h]=x.useState(!1),[p,m]=x.useState(!1),[g,y]=x.useState(""),[b,v]=x.useState(!1),[w,S]=x.useState(null),[k,j]=x.useState(null),[A,L]=x.useState(null),[P,F]=x.useState(0);if(x.useEffect(()=>{const se=l||"";d(se),h(!c||!se),m(!1),y(""),S(null),j(null),L(null),F(0)},[l,c]),x.useEffect(()=>{if(!p||!A)return;const se=()=>{const z=Math.max(0,Math.ceil((A-Date.now())/1e3));F(z)};se();const de=window.setInterval(se,1e3);return()=>window.clearInterval(de)},[p,A]),x.useEffect(()=>{if(e)return;let se=!0;return i(!0),b0().then(de=>{if(!se)return;const z={...de,roles:Array.isArray(de.roles)?de.roles.map(G=>typeof G=="string"?G:G.name):[]};r(z)}).catch(de=>o(String(de))).finally(()=>i(!1)),()=>{se=!1}},[e]),n)return a.jsx(e0,{children:a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading profile"})]})})});if(s)return a.jsx(e0,{children:a.jsx("div",{className:"px-4 sm:px-6 lg:px-8 pb-6",children:a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-800",children:["Error loading profile: ",s]})})});if(!t)return a.jsx(e0,{children:a.jsx("div",{className:"px-4 sm:px-6 lg:px-8 pb-6",children:a.jsx("div",{className:"text-center text-gray-500",children:"No profile available"})})});const E=(t.username||"U").slice(0,2).toUpperCase(),T=!!(c&&!f&&l);async function B(){var de,z,G;S(null),j(null);const se=String(u||"").trim();if(!se){S("Enter mobile number.");return}try{v(!0);const ie=await ZD(se);m(!0);const Y=Number((ie==null?void 0:ie.expires_in_seconds)??0);if(Number.isFinite(Y)&&Y>0){L(Date.now()+Y*1e3),F(Math.ceil(Y));const C=Math.ceil(Y/60);j(`OTP sent. Valid for ${C} minute${C===1?"":"s"}.`)}else L(null),F(0),j("OTP sent.")}catch(ie){const C=Number(((de=ie==null?void 0:ie.response)==null?void 0:de.status)||0)===401?"Session expired. Please login again and retry OTP request.":String(((G=(z=ie==null?void 0:ie.response)==null?void 0:z.data)==null?void 0:G.detail)||(ie==null?void 0:ie.message)||ie||"Failed to send OTP");S(C)}finally{v(!1)}}async function q(){var z,G,ie;S(null),j(null);const se=String(u||"").trim(),de=String(g||"").trim();if(!se){S("Enter mobile number.");return}if(!de){S("Enter OTP.");return}try{v(!0);const Y=await e9(se,de),C=Y&&Y.me||null;if(C){const K={...C,roles:Array.isArray(C.roles)?C.roles.map(H=>typeof H=="string"?H:H.name):[]};r(K)}else{const K=await b0(),H={...K,roles:Array.isArray(K.roles)?K.roles.map(R=>typeof R=="string"?R:R.name):[]};r(H)}m(!1),y(""),j(null),S(null),h(!1),L(null),F(0)}catch(Y){const K=Number(((z=Y==null?void 0:Y.response)==null?void 0:z.status)||0)===401?"Session expired. Please login again and retry OTP verification.":String(((ie=(G=Y==null?void 0:Y.response)==null?void 0:G.data)==null?void 0:ie.detail)||(Y==null?void 0:Y.message)||Y||"OTP verification failed");S(K)}finally{v(!1)}}const U=p&&A!=null&&P<=0;return a.jsx(e0,{children:a.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 pb-6 space-y-6",children:[a.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 sm:p-8 shadow-md",children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx("span",{className:"text-2xl sm:text-3xl font-bold text-white",children:E})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:t.username}),a.jsx("p",{className:"text-gray-600 mt-1",children:t.email||"No email provided"})]})]}),a.jsxs("div",{className:"bg-white rounded-lg px-4 py-2 shadow-sm",children:[a.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Profile Type"}),a.jsx("div",{className:"font-bold text-gray-900",children:t.profile_type||""})]})]})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Details"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(W0,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"Account"}),a.jsxs("div",{className:"text-gray-900 font-medium truncate",children:["ID: ",t.id]})]})]})}),a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(b3,{className:"w-5 h-5 text-emerald-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"Email"}),a.jsx("div",{className:"text-gray-900 font-medium truncate",children:t.email||""})]})]})}),a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Pte,{className:"w-5 h-5 text-purple-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"Roles"}),a.jsx("div",{className:"text-gray-900 font-medium truncate",children:(t.roles||[]).join(", ")||""})]})]})}),a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Ree,{className:"w-5 h-5 text-orange-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"Department"}),a.jsx("div",{className:"text-gray-900 font-medium truncate",children:t.profile&&t.profile.department&&(t.profile.department.short_name||t.profile.department.code)||""})]})]})}),a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Mee,{className:"w-5 h-5 text-indigo-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"Designation"}),a.jsx("div",{className:"text-gray-900 font-medium truncate",children:t.profile&&t.profile.designation||""})]})]})}),a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-pink-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Nte,{className:"w-5 h-5 text-pink-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"College"}),a.jsx("div",{className:"text-gray-900 font-medium truncate",children:t.college&&(t.college.short_name||t.college.name)||""})]})]})}),a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-teal-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Ste,{className:"w-5 h-5 text-teal-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-2",children:"Mobile Number"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx("input",{className:"w-full rounded-md border border-gray-200 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-teal-200",value:u,onChange:se=>{d(se.target.value),m(!1),y(""),S(null),j(null),L(null),F(0)},readOnly:T,placeholder:"Enter mobile number"}),T&&a.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2",children:a.jsx(Hf,{className:"w-5 h-5 text-emerald-600"})})]}),!T&&a.jsx("button",{type:"button",className:"px-3 py-2 rounded-md bg-teal-600 text-white text-sm font-semibold disabled:opacity-60",onClick:B,disabled:b||p&&A!=null&&!U,children:p?U?"Resend OTP":"OTP Sent":"Verify"})]}),k&&a.jsx("div",{className:"mt-2 text-xs text-gray-500",children:k}),w&&a.jsx("div",{className:"mt-2 text-xs text-red-600 font-semibold",children:w}),p&&A!=null&&!T&&a.jsx("div",{className:"mt-2 text-xs text-gray-600",children:P>0?a.jsxs("span",{children:["OTP expires in"," ",String(Math.floor(P/60)).padStart(2,"0"),":",String(P%60).padStart(2,"0")]}):a.jsx("span",{className:"text-amber-700 font-semibold",children:"OTP expired. You can resend now."})}),p&&!T&&a.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[a.jsx("input",{className:"flex-1 rounded-md border border-gray-200 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-teal-200",value:g,onChange:se=>y(se.target.value),placeholder:"Enter OTP"}),a.jsx("button",{type:"button",className:"px-3 py-2 rounded-md bg-emerald-600 text-white text-sm font-semibold disabled:opacity-60",onClick:q,disabled:b,children:"Submit"})]}),T&&a.jsx("button",{type:"button",className:"mt-2 text-xs text-blue-700 underline font-semibold",onClick:()=>{h(!0),m(!1),y(""),S(null),j(null)},children:"Change number"})]})]})})]})]})]})})}function U1({children:e}){return a.jsx(e0,{children:a.jsx("div",{className:"flex flex-col w-full max-w-full overflow-x-hidden",children:e})})}function pOe(){const[e,t]=x.useState([]),[r,n]=x.useState(!0),[i,s]=x.useState(null),o=dl(),l=xo(),c=e&&e.length?Array.from(new Set(e.map(b=>b.regulation))):[],u=e&&e.length?Array.from(new Set(e.map(b=>b.semester))).sort((b,v)=>b-v):[],[d,f]=x.useState(c.length===1?c[0]:c[0]??null),[h,p]=x.useState(u.length===1?u[0]:u[0]??null);x.useEffect(()=>{const b=e&&e.length?Array.from(new Set(e.map(w=>w.regulation))):[];b.length===1?f(b[0]):b.includes(d||"")||f(b[0]??null);const v=e&&e.length?Array.from(new Set(e.map(w=>w.semester))).sort((w,S)=>w-S):[];v.length===1?p(v[0]):v.includes(h||-1)||p(v[0]??null)},[e]),x.useEffect(()=>{Kd().then(b=>t(b)).catch(b=>console.error(b)).finally(()=>n(!1))},[]);function m(b){if(b==null)return"";const v=String(b);return v.includes(",")||v.includes('"')||v.includes(`
`)?'"'+v.replace(/"/g,'""')+'"':v}function g(){const b=e.filter(A=>(!d||A.regulation===d)&&(!h||A.semester===h)&&A.editable===!0);if(!b.length){alert("No editable subjects in current view");return}const w=[["regulation","semester","course_code","course_name","category","class_type","l","t","p","s","c","internal_mark","external_mark","for_all_departments","editable","departments"].join(",")];for(const A of b){const L=A.for_all_departments?"":(A.departments_display||[]).map(F=>F.short_name||F.shortname||F.code||F.name).join(","),P=[A.regulation,A.semester,A.course_code||"",A.course_name||"",A.category||"",A.class_type||"",A.l??0,A.t??0,A.p??0,A.s??0,A.c??0,A.internal_mark??"",A.external_mark??"",A.for_all_departments?"True":"False",A.editable?"True":"False",L];w.push(P.map(m).join(","))}const S=new Blob([w.join(`
`)],{type:"text/csv"}),k=URL.createObjectURL(S),j=document.createElement("a");j.href=k,j.download=`department_curriculum_editable_${d||"all"}_${h||"all"}.csv`,document.body.appendChild(j),j.click(),j.remove(),URL.revokeObjectURL(k)}async function y(b){const v=b.target.files&&b.target.files[0];if(v){if(!confirm(`Upload ${v.name} to import masters?`)){b.currentTarget.value="";return}try{const w=new FormData;w.append("csv_file",v,v.name);const S=await xr("/api/curriculum/master/import/",{method:"POST",body:w});if(S.status===401){alert("Your session has expired. Please refresh the page and try again.");return}if(S.ok)alert("Import request submitted; refresh to see changes."),n(!0),Kd().then(k=>t(k)).catch(()=>{}).finally(()=>n(!1));else{let k="";try{k=await S.text()}catch{k=S.statusText}alert("Import failed: "+(k||S.statusText))}}catch(w){console.error(w),alert("Import failed: "+(w.message||w))}try{const w=document.getElementById("master-import-file");w&&(w.value="")}catch{}}}return x.useEffect(()=>{const b=o.state;b&&b.savedMessage&&(s(b.savedMessage),l(location.pathname,{replace:!0,state:{}}),setTimeout(()=>s(null),2500))},[o,l]),r?a.jsx(U1,{children:a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading masters"})]})})}):a.jsx(U1,{children:a.jsxs("div",{className:"px-4 pb-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-indigo-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(gs,{className:"w-6 h-6 text-indigo-600"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Master Curriculum"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View and manage all master curriculum entries."})]})]}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[(()=>{try{const b=JSON.parse(localStorage.getItem("roles")||"[]");if(Array.isArray(b)&&b.some(w=>String(w).toLowerCase()==="iqac"))return a.jsx(es,{to:"/curriculum/master/new",className:"px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md",children:"New Master"})}catch{}return null})(),a.jsxs("button",{onClick:()=>g(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-all duration-200 shadow-sm hover:shadow-md",children:[a.jsx(T4,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Download"})]}),a.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition-all duration-200 shadow-sm hover:shadow-md cursor-pointer",children:[a.jsx(P2,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Import CSV"}),a.jsx("input",{id:"master-import-file",type:"file",accept:".csv",className:"hidden",onChange:b=>y(b)})]})]})]}),c.length>0&&a.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-6 bg-white rounded-lg shadow-sm p-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Regulation:"}),a.jsx("select",{value:d??"",onChange:b=>f(b.target.value||null),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500",children:c.map(b=>a.jsx("option",{value:b,children:b},b))})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Semester:"}),a.jsx("select",{value:h??"",onChange:b=>p(b.target.value?Number(b.target.value):null),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500",children:u.map(b=>a.jsx("option",{value:b,children:b},b))})]})]}),i&&a.jsx("div",{className:"mb-4 inline-block bg-green-100 text-green-800 px-4 py-2 rounded-lg font-semibold",children:i}),a.jsx("div",{className:"w-full overflow-x-auto bg-white rounded-lg shadow-md",children:a.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Code"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Course"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"CAT"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Class"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Elective"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"L"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"T"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"P"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"S"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"C"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"INT"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"EXT"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"TTL"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Depts"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Editable"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.filter(b=>(!d||b.regulation===d)&&(!h||b.semester===h)).length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:16,className:"px-4 py-8 text-center text-gray-500",children:"No curriculum entries found for the selected filters."})}):e.filter(b=>(!d||b.regulation===d)&&(!h||b.semester===h)).map(b=>a.jsxs("tr",{className:`hover:bg-gray-50 transition-colors ${b.editable?"bg-blue-50/30":""}`,children:[a.jsx("td",{className:"px-3 py-3 text-sm text-gray-900 whitespace-nowrap",children:b.course_code||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-gray-900 font-medium min-w-[200px]",children:b.course_name||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-gray-700 whitespace-nowrap",children:b.category||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-gray-700 whitespace-nowrap",children:b.class_type||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-center whitespace-nowrap",children:b.is_elective?a.jsx("span",{className:"text-green-700 font-semibold",children:"Yes"}):a.jsx("span",{className:"text-gray-400",children:"No"})}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.l??0}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.t??0}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.p??0}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.s??0}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.c??0}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.internal_mark??"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.external_mark??"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 font-semibold whitespace-nowrap",children:b.total_mark??"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-gray-700 whitespace-nowrap",children:b.for_all_departments?"ALL":b.departments_display&&b.departments_display.length>0?b.departments_display.map(v=>v.short_name||v.shortname||v.code||v.name).join(", "):"No Depts"}),a.jsx("td",{className:"px-3 py-3 text-sm text-center whitespace-nowrap",children:b.editable?a.jsx("span",{className:"text-green-700 font-semibold",children:"Yes"}):a.jsx("span",{className:"text-gray-400",children:"No"})}),a.jsx("td",{className:"px-3 py-3 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx(es,{to:`/curriculum/master/${b.id}`,className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:a.jsx(uh,{className:"w-4 h-4"})}),b.status==="PENDING"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",className:"px-3 py-1.5 text-green-600 hover:bg-green-50 text-xs font-medium rounded-lg transition-colors",children:"Approve"}),a.jsx("button",{type:"button",className:"px-3 py-1.5 text-red-600 hover:bg-red-50 text-xs font-medium rounded-lg transition-colors",children:"Reject"})]})]})})]},b.id))})]})})]})})}function VF(){const{id:e}=z0(),t=e??(window.location.pathname.endsWith("/new")?"new":void 0),r=xo(),[n,i]=x.useState({regulation:"",semester:1,for_all_departments:!0,editable:!1,is_elective:!1}),[s,o]=x.useState(!1),[l,c]=x.useState([]),[u,d]=x.useState(null);x.useEffect(()=>{t&&t!=="new"&&(o(!0),Kd().then(h=>{const p=h.find(m=>String(m.id)===String(t));p&&i(p)}).finally(()=>o(!1)))},[t]),x.useEffect(()=>{Sl().then(h=>{const p=new Map;h.forEach(m=>p.set(m.department.id,m.department)),c(Array.from(p.values()))}).catch(()=>c([]))},[]);async function f(){o(!0);try{if(!n.regulation)throw new Error("Regulation is required");if(!n.semester||n.semester<=0)throw new Error("Semester must be a positive number");if(!n.course_name)throw new Error("Course Name is required");if(n.internal_mark!==""&&n.internal_mark!=null&&n.internal_mark<0||n.external_mark!==""&&n.external_mark!=null&&n.external_mark<0)throw new Error("Marks cannot be negative");const h={...n};if(n.for_all_departments?h.departments=[]:h.departments=Array.isArray(n.departments)?n.departments:[],h.internal_mark=n.internal_mark===""||n.internal_mark==null?0:Number(n.internal_mark),h.external_mark=n.external_mark===""||n.external_mark==null?0:Number(n.external_mark),h.course_code=n.course_code===""||n.course_code==null?null:n.course_code,t==="new"){const p=await Lre(h);r("/curriculum/master",{state:{savedMessage:"Saved",newId:p.id}})}else{const p=Number(t);if(Number.isNaN(p))throw new Error("Invalid master id");const m=await Rre(p,h);i(m),d("Saved"),setTimeout(()=>d(null),2500)}}catch(h){alert(`Error: ${h.message}`)}finally{o(!1)}}return a.jsxs(U1,{children:[a.jsxs("div",{className:"px-2 sm:px-4 pb-4",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-indigo-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(gs,{className:"w-5 h-5 sm:w-6 sm:h-6 text-indigo-600"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:e==="new"?"New Master":"Edit Master"}),a.jsx("p",{className:"text-gray-600 text-xs sm:text-sm mt-1",children:e==="new"?"Create a new master curriculum entry.":"Edit the selected master curriculum entry."})]})]}),a.jsxs("form",{onSubmit:h=>{h.preventDefault(),f()},className:"bg-white rounded-lg shadow-md p-3 sm:p-4 lg:p-6 space-y-4",autoComplete:"off",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Regulation"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:n.regulation||"",onChange:h=>i({...n,regulation:h.target.value}),required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Semester"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",type:"number",min:1,value:n.semester||1,onChange:h=>i({...n,semester:Number(h.target.value)}),required:!0})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Course Code"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:n.course_code??"",onChange:h=>i({...n,course_code:h.target.value}),placeholder:"Optional"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Course Name"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:n.course_name||"",onChange:h=>i({...n,course_name:h.target.value}),required:!0})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"CAT"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:n.category||"",onChange:h=>i({...n,category:h.target.value}),placeholder:"e.g. CORE"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Class"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:n.class_type||"",onChange:h=>i({...n,class_type:h.target.value}),placeholder:"e.g. Theory"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"L"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-sm",type:"number",min:0,value:n.l||0,onChange:h=>i({...n,l:Number(h.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"T"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-sm",type:"number",min:0,value:n.t||0,onChange:h=>i({...n,t:Number(h.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"P"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-sm",type:"number",min:0,value:n.p||0,onChange:h=>i({...n,p:Number(h.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"S"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-sm",type:"number",min:0,value:n.s||0,onChange:h=>i({...n,s:Number(h.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"C"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-sm",type:"number",min:0,value:n.c||0,onChange:h=>i({...n,c:Number(h.target.value)})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Internal Mark"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",type:"number",min:0,value:n.internal_mark??"",onChange:h=>i({...n,internal_mark:h.target.value===""?"":Number(h.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"External Mark"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",type:"number",min:0,value:n.external_mark??"",onChange:h=>i({...n,external_mark:h.target.value===""?"":Number(h.target.value)})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[a.jsx("input",{type:"checkbox",checked:!!n.for_all_departments,onChange:h=>i({...n,for_all_departments:h.target.checked}),id:"forAllDepts",className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),a.jsx("label",{htmlFor:"forAllDepts",className:"text-xs sm:text-sm font-semibold text-indigo-900",children:"For All Departments"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Departments"}),n.for_all_departments?a.jsx("div",{className:"text-gray-600 text-xs sm:text-sm p-2 bg-gray-50 rounded-lg",children:"Applies to all departments"}):a.jsxs("div",{className:"max-h-32 overflow-y-auto p-2 border border-gray-300 rounded-lg bg-white",children:[l.length===0&&a.jsx("div",{className:"text-gray-400 text-xs",children:"No departments available"}),l.map(h=>a.jsxs("div",{className:"flex items-center gap-1.5 mb-1.5",children:[a.jsx("input",{type:"checkbox",checked:Array.isArray(n.departments)?n.departments.includes(h.id):!1,onChange:p=>{const m=Array.isArray(n.departments)?[...n.departments]:[];if(p.target.checked)m.includes(h.id)||m.push(h.id);else{const g=m.indexOf(h.id);g>=0&&m.splice(g,1)}i({...n,departments:m})},id:`dept-${h.id}`,className:"w-3.5 h-3.5 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),a.jsxs("label",{htmlFor:`dept-${h.id}`,className:"text-xs sm:text-sm text-gray-700",children:[h.code,"  ",h.name]})]},h.id))]})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[a.jsx("input",{type:"checkbox",checked:!!n.editable,onChange:h=>i({...n,editable:h.target.checked}),id:"editable",className:"w-3.5 h-3.5 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),a.jsx("label",{htmlFor:"editable",className:"text-xs sm:text-sm font-semibold text-indigo-900",children:"Editable"})]}),a.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[a.jsx("input",{type:"checkbox",checked:!!n.is_elective,onChange:h=>i({...n,is_elective:h.target.checked}),id:"is_elective",className:"w-3.5 h-3.5 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),a.jsx("label",{htmlFor:"is_elective",className:"text-xs sm:text-sm font-semibold text-indigo-900",children:"Is Elective"})]})]}),u&&a.jsx("div",{className:"bg-green-100 text-green-800 px-3 py-1.5 rounded-lg font-semibold text-sm inline-block",children:u}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[a.jsxs("button",{type:"submit",className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors shadow-sm disabled:opacity-50 disabled:cursor-not-allowed text-sm",disabled:s,children:[a.jsx(id,{className:"w-4 h-4"}),s?"Saving":"Save"]}),a.jsxs("button",{type:"button",className:"flex items-center justify-center gap-2 px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg font-semibold hover:bg-gray-50 transition-colors text-sm",onClick:()=>r("/curriculum/master"),children:[a.jsx(vu,{className:"w-4 h-4"}),"Cancel"]})]})]})]}),a.jsxs("form",{onSubmit:h=>{h.preventDefault(),f()},style:{background:"#fff",borderRadius:10,boxShadow:"0 2px 8px #e5e7eb",padding:32,maxWidth:700,margin:"0 auto",display:"grid",gap:22},autoComplete:"off",children:[a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:18},children:[a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Regulation"}),a.jsx("input",{className:"input",value:n.regulation||"",onChange:h=>i({...n,regulation:h.target.value}),required:!0,style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Semester"}),a.jsx("input",{className:"input",type:"number",min:1,value:n.semester||1,onChange:h=>i({...n,semester:Number(h.target.value)}),required:!0,style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:18},children:[a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Course Code"}),a.jsx("input",{className:"input",value:n.course_code??"",onChange:h=>i({...n,course_code:h.target.value}),placeholder:"Optional",style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Course Name"}),a.jsx("input",{className:"input",value:n.course_name||"",onChange:h=>i({...n,course_name:h.target.value}),required:!0,style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:18},children:[a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"CAT"}),a.jsx("input",{className:"input",value:n.category||"",onChange:h=>i({...n,category:h.target.value}),placeholder:"e.g. CORE",style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Class"}),a.jsxs("select",{className:"input",value:n.class_type||"",onChange:h=>i({...n,class_type:h.target.value}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4},children:[a.jsx("option",{value:"",children:"Select class type"}),Zp.map(h=>{const p=ti(String(h)),m=String(h).charAt(0).toUpperCase()+String(h).slice(1);return a.jsx("option",{value:p,children:m},p)})]})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:18},children:[a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"L"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.l||0,onChange:h=>i({...n,l:Number(h.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"T"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.t||0,onChange:h=>i({...n,t:Number(h.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"P"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.p||0,onChange:h=>i({...n,p:Number(h.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"S"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.s||0,onChange:h=>i({...n,s:Number(h.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"C"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.c||0,onChange:h=>i({...n,c:Number(h.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:18},children:[a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Internal Mark"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.internal_mark??"",onChange:h=>i({...n,internal_mark:h.target.value===""?"":Number(h.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"External Mark"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.external_mark??"",onChange:h=>i({...n,external_mark:h.target.value===""?"":Number(h.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:18},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginTop:8},children:[a.jsx("input",{type:"checkbox",checked:!!n.for_all_departments,onChange:h=>i({...n,for_all_departments:h.target.checked}),id:"forAllDepts"}),a.jsx("label",{htmlFor:"forAllDepts",style:{fontWeight:600,color:"#3730a3",marginBottom:0},children:"For All Departments"})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Departments"}),n.for_all_departments?a.jsx("div",{style:{marginTop:6,color:"#6b7280"},children:"Applies to all departments"}):a.jsxs("div",{style:{marginTop:6,maxHeight:220,overflowY:"auto",padding:6,border:"1px solid #e5e7eb",borderRadius:6},children:[l.length===0&&a.jsx("div",{style:{color:"#9ca3af"},children:"No departments available"}),l.map(h=>a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6},children:[a.jsx("input",{type:"checkbox",checked:Array.isArray(n.departments)?n.departments.includes(h.id):!1,onChange:p=>{const m=Array.isArray(n.departments)?[...n.departments]:[];if(p.target.checked)m.includes(h.id)||m.push(h.id);else{const g=m.indexOf(h.id);g>=0&&m.splice(g,1)}i({...n,departments:m})},id:`dept-${h.id}`}),a.jsxs("label",{htmlFor:`dept-${h.id}`,style:{marginBottom:0},children:[h.code,"  ",h.name]})]},h.id))]})]})]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginTop:8},children:[a.jsx("input",{type:"checkbox",checked:!!n.editable,onChange:h=>i({...n,editable:h.target.checked}),id:"editable"}),a.jsx("label",{htmlFor:"editable",style:{fontWeight:600,color:"#3730a3",marginBottom:0},children:"Editable"})]}),u&&a.jsx("div",{style:{background:"#ecfccb",color:"#365314",padding:"8px 12px",borderRadius:8,fontWeight:600,display:"inline-block"},children:u}),a.jsxs("div",{style:{display:"flex",gap:10,marginTop:8},children:[a.jsx("button",{type:"submit",className:"btn-primary",style:{padding:"6px 18px",borderRadius:8,fontWeight:600,fontSize:16,minWidth:100},disabled:s,children:s?"Saving":"Save"}),a.jsx("button",{type:"button",className:"btn-secondary",style:{padding:"6px 18px",borderRadius:8,fontWeight:600,fontSize:16,minWidth:100},onClick:()=>r("/curriculum/master"),children:"Cancel"})]})]})]})}function mOe(){const[e,t]=x.useState([]),[r,n]=x.useState(!0),i=e&&e.length?Array.from(new Set(e.map(z=>z.regulation))):[],s=e&&e.length?Array.from(new Set(e.map(z=>z.semester))).sort((z,G)=>z-G):[],[o,l]=x.useState(i.length===1?i[0]:i[0]??null),[c,u]=x.useState(s.length===1?s[0]:s[0]??null),d=e&&e.length?Array.from(new Set(e.map(z=>z.department.id))):[];x.useEffect(()=>{const z=e&&e.length?Array.from(new Set(e.map(ie=>ie.regulation))):[];z.length===1?l(z[0]):z.includes(o||"")||l(z[0]??null);const G=e&&e.length?Array.from(new Set(e.map(ie=>ie.semester))).sort((ie,Y)=>ie-Y):[];G.length===1?u(G[0]):G.includes(c||-1)||u(G[0]??null)},[e]),x.useEffect(()=>{Sl().then(z=>t(z)).catch(console.error).finally(()=>n(!1))},[]);async function f(z){try{const G=await Bre(z.id,z);t(ie=>ie.map(Y=>Y.id===G.id?G:Y)),p(null),alert("Row updated successfully")}catch(G){alert(String(G))}}const[h,p]=x.useState(null),m=(()=>{try{return JSON.parse(localStorage.getItem("permissions")||"[]")}catch{return[]}})(),g=Array.isArray(m)&&(m.includes("curriculum.department.approve")||m.includes("CURRICULUM_DEPARTMENT_APPROVE"));async function y(z,G){try{await Ire(z,G);const ie=await Sl();t(ie),alert("OK")}catch(ie){alert(String(ie))}}const[b,v]=x.useState(null);x.useEffect(()=>{d.length===1?v(d[0]):d.includes(b||-1)||v(d[0]??null)},[e]);const w=e.filter(z=>z.is_elective&&(!b||z.department.id===b)&&(!o||z.regulation===o)&&(!c||z.semester===c)),[S,k]=x.useState([]);x.useEffect(()=>{hm({department_id:b??void 0,regulation:o??void 0,semester:c??void 0}).then(k).catch(()=>k([]))},[b,o,c,e]);const[j,A]=x.useState(!1),[L,P]=x.useState({parent:null,department_id:b||null,regulation:o||null,semester_id:c||null,course_code:"",course_name:"",class_type:"THEORY",category:"",is_elective:!0,l:0,t:0,p:0,s:0,c:0,internal_mark:null,external_mark:null,total_mark:null,total_hours:null,question_paper_type:"",editable:!1});function F(z){P(G=>({...G,parent:z.id,department_id:b||G.department_id,regulation:o||G.regulation,semester_id:c||G.semester_id,course_name:"",course_code:""})),A(!0)}async function E(){try{const z={...L};if(!z.parent)throw new Error("Parent curriculum id missing");z.course_code||delete z.course_code,z.course_name||delete z.course_name,await Fre(z);const G=await Sl();t(G);const ie=await hm({department_id:b??void 0,regulation:o??void 0,semester:c??void 0});k(ie),A(!1),alert("Elective subject added")}catch(z){alert(String(z))}}const[T,B]=x.useState(!1),[q,U]=x.useState(null);function se(z){U({...z}),B(!0)}async function de(){if(!(!q||!q.id))try{const z=await xr(`/api/curriculum/elective/${q.id}/`,{method:"PATCH",body:JSON.stringify(q)});if(!z.ok)throw new Error(await z.text());const G=await Sl();t(G);const ie=await hm({department_id:b??void 0,regulation:o??void 0,semester:c??void 0});k(ie),B(!1),alert("Elective updated")}catch(z){alert(String(z))}}return r?a.jsx(U1,{children:a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading department curriculum"})]})})}):a.jsx(U1,{children:a.jsxs("div",{className:"px-4 pb-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("div",{className:"w-12 h-12 bg-indigo-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsxs("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 48 48",children:[a.jsx("rect",{width:"48",height:"48",rx:"12",fill:"#e0e7ff"}),a.jsx("path",{d:"M16 32V16h16v16H16zm2-2h12V18H18v12zm2-2v-8h8v8h-8z",fill:"#6366f1"})]})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Department Curriculum"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View and manage department-specific curriculum entries."})]})]}),i.length>0&&a.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-6 bg-white rounded-lg shadow-sm p-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Regulation:"}),a.jsx("select",{value:o??"",onChange:z=>l(z.target.value||null),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500",children:i.map(z=>a.jsx("option",{value:z,children:z},z))})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Semester:"}),a.jsx("select",{value:c??"",onChange:z=>u(z.target.value?Number(z.target.value):null),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500",children:s.map(z=>a.jsx("option",{value:z,children:z},z))})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Filter by Department"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:d.map(z=>{var C;const G=b===z,ie=(C=e.find(K=>K.department.id===z))==null?void 0:C.department,Y=(ie==null?void 0:ie.short_name)||(ie==null?void 0:ie.shortname)||(ie==null?void 0:ie.code)||(ie==null?void 0:ie.name)||`Dept ${z}`;return a.jsx("button",{onClick:()=>v(z),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${G?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:Y},z)})})]}),a.jsx("div",{className:"w-full overflow-x-auto bg-white rounded-lg shadow-md",children:a.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-indigo-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Code"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap min-w-[200px]",children:"Course"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"CAT"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Class"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Elective"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"L"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"T"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"P"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"S"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"C"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"INT"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"EXT"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"TTL"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Hours"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"QP Type"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Editable"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.filter(z=>(!b||z.department.id===b)&&(!o||z.regulation===o)&&(!c||z.semester===c)).map(z=>a.jsx("tr",{className:`hover:bg-gray-50 transition-colors ${z.editable?"bg-slate-50":""}`,children:h===z.id?a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{value:z.course_code||"",onChange:G=>t(ie=>ie.map(Y=>Y.id===z.id?{...Y,course_code:G.target.value}:Y)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("textarea",{value:z.course_name||"",onChange:G=>t(ie=>ie.map(Y=>Y.id===z.id?{...Y,course_name:G.target.value}:Y)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",style:{minHeight:"32px"},placeholder:"Course Name",rows:1,onInput:G=>{const ie=G.target;ie.style.height="32px",ie.style.height=ie.scrollHeight+"px"}})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{value:z.category||"",onChange:G=>t(ie=>ie.map(Y=>Y.id===z.id?{...Y,category:G.target.value}:Y)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 edit-cell-input"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("select",{value:z.class_type||"THEORY",onChange:G=>t(ie=>ie.map(Y=>Y.id===z.id?{...Y,class_type:G.target.value}:Y)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 edit-cell-input",style:{minWidth:90},children:Zp.map(G=>{const ie=ti(String(G)),Y=String(G).charAt(0).toUpperCase()+String(G).slice(1).toLowerCase();return a.jsx("option",{value:ie,children:Y},ie)})})}),a.jsx("td",{className:"px-3 py-2 text-center whitespace-nowrap",children:a.jsx("input",{type:"checkbox",checked:!!z.is_elective,onChange:G=>t(ie=>ie.map(Y=>Y.id===z.id?{...Y,is_elective:G.target.checked}:Y)),className:"w-4 h-4"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:z.l||0,onChange:G=>t(ie=>ie.map(Y=>Y.id===z.id?{...Y,l:Number(G.target.value)}:Y)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:z.t||0,onChange:G=>t(ie=>ie.map(Y=>Y.id===z.id?{...Y,t:Number(G.target.value)}:Y)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:z.p||0,onChange:G=>t(ie=>ie.map(Y=>Y.id===z.id?{...Y,p:Number(G.target.value)}:Y)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:z.s||0,onChange:G=>t(ie=>ie.map(Y=>Y.id===z.id?{...Y,s:Number(G.target.value)}:Y)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:z.c||0,onChange:G=>t(ie=>ie.map(Y=>Y.id===z.id?{...Y,c:Number(G.target.value)}:Y)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:z.internal_mark||"",onChange:G=>t(ie=>ie.map(Y=>Y.id===z.id?{...Y,internal_mark:Number(G.target.value)}:Y)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:z.external_mark||"",onChange:G=>t(ie=>ie.map(Y=>Y.id===z.id?{...Y,external_mark:Number(G.target.value)}:Y)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:z.total_mark||"",onChange:G=>t(ie=>ie.map(Y=>Y.id===z.id?{...Y,total_mark:Number(G.target.value)}:Y)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:z.total_hours||"",onChange:G=>t(ie=>ie.map(Y=>Y.id===z.id?{...Y,total_hours:Number(G.target.value)}:Y)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{value:z.question_paper_type||"",onChange:G=>t(ie=>ie.map(Y=>Y.id===z.id?{...Y,question_paper_type:G.target.value}:Y)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:z.editable?a.jsx("span",{className:"text-emerald-600 font-semibold",children:"Yes"}):a.jsx("span",{className:"text-gray-400",children:"No"})}),a.jsxs("td",{className:"px-3 py-2 whitespace-nowrap",children:[a.jsx("button",{className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors mr-2",onClick:()=>f(z),title:"Save",children:a.jsx(id,{className:"w-4 h-4"})}),a.jsx("button",{className:"p-2 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors",onClick:()=>p(null),title:"Cancel",children:a.jsx(vu,{className:"w-4 h-4"})})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:z.course_code||"-"}),a.jsx("td",{className:"px-3 py-2.5 text-sm text-gray-900 font-medium",children:z.course_name||"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:z.category||"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:z.class_type||"-"}),a.jsx("td",{className:"px-3 py-2.5 text-center whitespace-nowrap text-sm",children:z.is_elective?a.jsx("span",{className:"text-emerald-600 font-semibold",children:"Yes"}):a.jsx("span",{className:"text-gray-400",children:"No"})}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:z.l??0}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:z.t??0}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:z.p??0}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:z.s??0}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:z.c??0}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:z.internal_mark??"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:z.external_mark??"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:z.total_mark??"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:z.total_hours??"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:z.question_paper_type||"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:z.editable?a.jsx("span",{className:"text-emerald-600 font-semibold",children:"Yes"}):a.jsx("span",{className:"text-gray-400",children:"No"})}),a.jsxs("td",{className:"px-3 py-2.5 whitespace-nowrap",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[z.editable?a.jsx("button",{className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",onClick:()=>p(z.id),title:"Edit",children:a.jsx(uh,{className:"w-4 h-4"})}):a.jsx("div",{className:"w-8 h-8"}),g&&z.approval_status==="PENDING"?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>y(z.id,"approve"),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Approve",children:a.jsx(Dee,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>y(z.id,"reject"),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Reject",children:a.jsx(vu,{className:"w-4 h-4"})})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-8 h-8"}),a.jsx("div",{className:"w-8 h-8"})]})]}),a.jsxs("div",{className:"text-xs mt-1 text-gray-600",children:["Status: ",a.jsx("strong",{className:"text-gray-900",children:z.approval_status||"APPROVED"})]})]})]})},z.id))})]})}),a.jsxs("div",{className:"mt-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Elective Options"}),w.length===0?a.jsx("div",{className:"text-gray-400 py-4",children:"No elective options for selected department/semester."}):a.jsx("div",{className:"space-y-6",children:w.map(z=>{const G=S.filter(ie=>ie.parent===z.id);return a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("div",{className:"text-lg font-bold text-gray-900",children:z.course_name||z.course_code||"Elective"}),a.jsx("button",{onClick:()=>F(z),className:"px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors",children:"Add Subject"})]}),a.jsx("div",{className:"w-full overflow-x-auto",children:a.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"Code"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"Course"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"CAT"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"Class"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"L"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"T"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"P"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"S"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"C"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"INT"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"EXT"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"TTL"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"Hours"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"QP Type"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:G.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:15,className:"px-3 py-4 text-gray-400 text-center",children:"No subjects added yet."})}):G.map(ie=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ie.course_code||"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ie.course_name||"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ie.category||"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ie.class_type||"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ie.l??0}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ie.t??0}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ie.p??0}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ie.s??0}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ie.c??0}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ie.internal_mark??"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ie.external_mark??"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ie.total_mark??"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ie.total_hours??"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ie.question_paper_type||"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm",children:ie.editable?a.jsx("span",{className:"text-emerald-600 font-semibold",children:"Yes"}):a.jsx("span",{className:"text-gray-400",children:"No"})}),a.jsx("button",{onClick:()=>se(ie),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:a.jsx(uh,{className:"w-4 h-4"})})]})})]},ie.id))})]})})]},z.id)})})]}),j&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"w-full max-w-3xl mx-4 bg-white rounded-lg shadow-2xl p-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Add Elective Subject"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Course Name"}),a.jsx("input",{value:L.course_name||"",onChange:z=>P(G=>({...G,course_name:z.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Course Code"}),a.jsx("input",{value:L.course_code||"",onChange:z=>P(G=>({...G,course_code:z.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Class Type"}),a.jsxs("select",{value:L.class_type,onChange:z=>P(G=>({...G,class_type:z.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"THEORY",children:"THEORY"}),a.jsx("option",{value:"LAB",children:"LAB"}),a.jsx("option",{value:"TCPL",children:"TCPL"}),a.jsx("option",{value:"TCPR",children:"TCPR"}),a.jsx("option",{value:"PRACTICAL",children:"PRACTICAL"}),a.jsx("option",{value:"AUDIT",children:"AUDIT"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Category"}),a.jsx("input",{value:L.category||"",onChange:z=>P(G=>({...G,category:z.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"L"}),a.jsx("input",{type:"number",value:L.l??0,onChange:z=>P(G=>({...G,l:Number(z.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"T"}),a.jsx("input",{type:"number",value:L.t??0,onChange:z=>P(G=>({...G,t:Number(z.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"P"}),a.jsx("input",{type:"number",value:L.p??0,onChange:z=>P(G=>({...G,p:Number(z.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"S"}),a.jsx("input",{type:"number",value:L.s??0,onChange:z=>P(G=>({...G,s:Number(z.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"C"}),a.jsx("input",{type:"number",value:L.c??0,onChange:z=>P(G=>({...G,c:Number(z.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Internal Mark"}),a.jsx("input",{type:"number",value:L.internal_mark??"",onChange:z=>P(G=>({...G,internal_mark:z.target.value?Number(z.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"External Mark"}),a.jsx("input",{type:"number",value:L.external_mark??"",onChange:z=>P(G=>({...G,external_mark:z.target.value?Number(z.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Total Mark"}),a.jsx("input",{type:"number",value:L.total_mark??"",onChange:z=>P(G=>({...G,total_mark:z.target.value?Number(z.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Total Hours"}),a.jsx("input",{type:"number",value:L.total_hours??"",onChange:z=>P(G=>({...G,total_hours:z.target.value?Number(z.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Question Paper Type"}),a.jsx("input",{value:L.question_paper_type||"",onChange:z=>P(G=>({...G,question_paper_type:z.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{id:"add-editable",type:"checkbox",checked:!!L.editable,onChange:z=>P(G=>({...G,editable:z.target.checked})),className:"w-4 h-4"}),a.jsx("label",{htmlFor:"add-editable",className:"text-sm font-medium text-gray-700",children:"Editable"})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[a.jsx("button",{onClick:()=>A(!1),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-700 hover:bg-gray-50 font-medium transition-colors",children:"Cancel"}),a.jsx("button",{onClick:E,className:"px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors",children:"Save"})]})]})}),T&&q&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"w-full max-w-3xl mx-4 bg-white rounded-lg shadow-2xl p-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Edit Elective Subject"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Course Name"}),a.jsx("input",{value:q.course_name||"",onChange:z=>U(G=>({...G,course_name:z.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Course Code"}),a.jsx("input",{value:q.course_code||"",onChange:z=>U(G=>({...G,course_code:z.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Class Type"}),a.jsxs("select",{value:q.class_type||"THEORY",onChange:z=>U(G=>({...G,class_type:z.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"THEORY",children:"THEORY"}),a.jsx("option",{value:"LAB",children:"LAB"}),a.jsx("option",{value:"TCPL",children:"TCPL"}),a.jsx("option",{value:"TCPR",children:"TCPR"}),a.jsx("option",{value:"PRACTICAL",children:"PRACTICAL"}),a.jsx("option",{value:"AUDIT",children:"AUDIT"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Category"}),a.jsx("input",{value:q.category||"",onChange:z=>U(G=>({...G,category:z.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"L"}),a.jsx("input",{type:"number",value:q.l??0,onChange:z=>U(G=>({...G,l:Number(z.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"T"}),a.jsx("input",{type:"number",value:q.t??0,onChange:z=>U(G=>({...G,t:Number(z.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"P"}),a.jsx("input",{type:"number",value:q.p??0,onChange:z=>U(G=>({...G,p:Number(z.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"S"}),a.jsx("input",{type:"number",value:q.s??0,onChange:z=>U(G=>({...G,s:Number(z.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"C"}),a.jsx("input",{type:"number",value:q.c??0,onChange:z=>U(G=>({...G,c:Number(z.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Internal Mark"}),a.jsx("input",{type:"number",value:q.internal_mark??"",onChange:z=>U(G=>({...G,internal_mark:z.target.value?Number(z.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"External Mark"}),a.jsx("input",{type:"number",value:q.external_mark??"",onChange:z=>U(G=>({...G,external_mark:z.target.value?Number(z.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Total Mark"}),a.jsx("input",{type:"number",value:q.total_mark??"",onChange:z=>U(G=>({...G,total_mark:z.target.value?Number(z.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Total Hours"}),a.jsx("input",{type:"number",value:q.total_hours??"",onChange:z=>U(G=>({...G,total_hours:z.target.value?Number(z.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Question Paper Type"}),a.jsx("input",{value:q.question_paper_type||"",onChange:z=>U(G=>({...G,question_paper_type:z.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{id:"edit-editable",type:"checkbox",checked:!!q.editable,onChange:z=>U(G=>({...G,editable:z.target.checked})),className:"w-4 h-4"}),a.jsx("label",{htmlFor:"edit-editable",className:"text-sm font-medium text-gray-700",children:"Editable"})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[a.jsx("button",{onClick:()=>B(!1),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-700 hover:bg-gray-50 font-medium transition-colors",children:"Cancel"}),a.jsx("button",{onClick:de,className:"px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors",children:"Save"})]})]})})]})})}function gOe(){const[e,t]=x.useState(null),[r,n]=x.useState(!1),[i,s]=x.useState(null),[o,l]=x.useState([]),[c,u]=x.useState([]),[d,f]=x.useState([]),[h,p]=x.useState(""),[m,g]=x.useState(""),[y,b]=x.useState(""),[v,w]=x.useState([]),[S,k]=x.useState(!1);x.useEffect(()=>{j()},[h,m,y]),x.useEffect(()=>{A()},[]);const j=async()=>{k(!0);try{const B={};h&&(B.regulation=h),m&&(B.semester=m),y&&(B.department_id=y);const q=await hm(B);w(q||[])}catch(B){console.error("Failed to load electives:",B),w([])}finally{k(!1)}},A=async()=>{try{const B=await hm();if(!B||!Array.isArray(B))return;const q=[...new Set(B.map(de=>de.regulation))].filter(Boolean).sort(),U=[...new Set(B.map(de=>de.semester))].filter(Boolean).sort((de,z)=>de-z),se=Array.from(new Map(B.map(de=>de.department).filter(Boolean).map(de=>[de.id,de])).values()).sort((de,z)=>(de.code||"").localeCompare(z.code||""));l(q),u(U),f(se)}catch(B){console.error("Failed to load filter options:",B)}},L=async()=>{try{const B=await xr("/api/curriculum/elective-choices/template/");if(!B.ok){alert("Failed to download template");return}const q=await B.blob(),U=window.URL.createObjectURL(q),se=document.createElement("a");se.href=U,se.download="elective_choices_template.csv",document.body.appendChild(se),se.click(),window.URL.revokeObjectURL(U),document.body.removeChild(se)}catch(B){console.error("Download error:",B),alert("Failed to download template")}},P=async()=>{try{const B=await xr("/api/curriculum/elective-choices/template/?format=excel");if(!B.ok){alert("Failed to download Excel template");return}const q=await B.blob(),U=window.URL.createObjectURL(q),se=document.createElement("a");se.href=U,se.download="elective_choices_template.xlsx",document.body.appendChild(se),se.click(),window.URL.revokeObjectURL(U),document.body.removeChild(se)}catch(B){console.error("Download error:",B),alert("Failed to download Excel template")}},F=B=>{var U;const q=(U=B.target.files)==null?void 0:U[0];if(q){if(![".csv",".xlsx",".xls"].some(z=>q.name.toLowerCase().endsWith(z))){alert("Please select a CSV or Excel file (.csv, .xlsx, .xls)");return}t(q),s(null)}},E=async()=>{if(!e){alert("Please select a file first");return}n(!0),s(null);try{const B=new FormData;B.append("csv_file",e);const q=await xr("/api/curriculum/elective-choices/import/",{method:"POST",body:B});if(q.status===401){alert("Your session has expired. Please refresh the page and try again.");return}let U;try{U=await q.json()}catch(se){console.error("Failed to parse response:",se),alert("Import failed: Invalid response from server");return}if(q.ok){s(U),t(null);const se=document.getElementById("file-input");se&&(se.value=""),j()}else{const se=U.error||U.detail||U.message||"Import failed";alert(typeof se=="string"?se:"Import failed: "+JSON.stringify(se).substring(0,200))}}catch(B){console.error("Upload error:",B),alert("Failed to upload file. Please check your connection and try again.")}finally{n(!1)}},T=v.filter(B=>{var q;return!(h&&B.regulation!==h||m&&B.semester!==m||y&&((q=B.department)==null?void 0:q.id)!==y)});return a.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-indigo-50 rounded-lg",children:a.jsx(tte,{className:"h-6 w-6 text-indigo-600"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Elective Import"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Import student elective choices from CSV or Excel"})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:L,className:"inline-flex items-center gap-2 px-4 py-2 bg-green-600 text-white font-medium rounded-lg hover:bg-green-700 transition-colors",children:[a.jsx(T4,{className:"h-5 w-5"}),"CSV Template"]}),a.jsxs("button",{onClick:P,className:"inline-flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white font-medium rounded-lg hover:bg-emerald-700 transition-colors",children:[a.jsx(T4,{className:"h-5 w-5"}),"Excel Template"]})]})]}),a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Upload File"}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{children:a.jsxs("label",{htmlFor:"file-input",className:"flex flex-col items-center justify-center w-full h-24 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100 transition-colors",children:[a.jsxs("div",{className:"flex flex-col items-center justify-center",children:[a.jsx(P2,{className:"h-8 w-8 text-gray-400 mb-2"}),a.jsx("p",{className:"text-sm text-gray-600",children:e?a.jsx("span",{className:"font-medium text-indigo-600",children:e.name}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]})}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"CSV or Excel files (.csv, .xlsx, .xls)"})]}),a.jsx("input",{id:"file-input",type:"file",className:"hidden",accept:".csv,.xlsx,.xls",onChange:F})]})}),a.jsxs("button",{onClick:E,disabled:!e||r,className:`w-full inline-flex items-center justify-center gap-2 px-6 py-3 font-medium rounded-lg transition-colors ${!e||r?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-indigo-600 text-white hover:bg-indigo-700"}`,children:[a.jsx(P2,{className:"h-5 w-5"}),r?"Uploading...":"Upload and Import"]})]})]}),i&&a.jsx("div",{className:`rounded-lg shadow-sm p-6 mb-6 ${i.errors&&i.errors.length>0?"bg-yellow-50 border border-yellow-200":"bg-green-50 border border-green-200"}`,children:a.jsxs("div",{className:"flex items-start gap-3",children:[i.errors&&i.errors.length>0?a.jsx(rd,{className:"h-6 w-6 text-yellow-600 flex-shrink-0 mt-0.5"}):a.jsx(x3,{className:"h-6 w-6 text-green-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:`text-lg font-semibold mb-2 ${i.errors&&i.errors.length>0?"text-yellow-900":"text-green-900"}`,children:i.message}),a.jsxs("div",{className:`space-y-1 text-sm ${i.errors&&i.errors.length>0?"text-yellow-800":"text-green-800"}`,children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Created:"})," ",i.created," entries"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Updated:"})," ",i.updated," entries"]}),i.errors&&i.errors.length>0&&a.jsxs("div",{className:"mt-3",children:[a.jsxs("p",{className:"font-semibold text-red-700 mb-2",children:["Errors (",i.errors.length,"):"]}),a.jsx("ul",{className:"list-disc list-inside space-y-1 text-red-600 max-h-40 overflow-y-auto",children:i.errors.map((B,q)=>a.jsx("li",{className:"text-xs",children:B},q))})]})]})]})]})}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(ate,{className:"h-5 w-5 text-gray-600"}),a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Elective Subjects"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Regulation"}),a.jsxs("select",{value:h,onChange:B=>p(B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"All Regulations"}),o.map(B=>a.jsx("option",{value:B,children:B},B))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Semester"}),a.jsxs("select",{value:m,onChange:B=>g(B.target.value?Number(B.target.value):""),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"All Semesters"}),c.map(B=>a.jsxs("option",{value:B,children:["Semester ",B]},B))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),a.jsxs("select",{value:y,onChange:B=>b(B.target.value?Number(B.target.value):""),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"All Departments"}),d.map(B=>a.jsxs("option",{value:B.id,children:[B.code," - ",B.short_name||B.name]},B.id))]})]})]}),S?a.jsx("div",{className:"text-center py-8 text-gray-600",children:"Loading electives..."}):T.length===0?a.jsx("div",{className:"text-center py-8 text-gray-500",children:"No electives found"}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Course Code"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Course Name"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Regulation"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Semester"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[a.jsx(bs,{className:"h-4 w-4"}),"Students"]})})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:T.map(B=>{var q;return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:B.course_code||""}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:B.course_name||""}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600",children:B.regulation||""}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600",children:B.semester||""}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600",children:((q=B.department)==null?void 0:q.code)||""}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:a.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${B.student_count>0?"bg-indigo-100 text-indigo-800":"bg-gray-100 text-gray-600"}`,children:B.student_count})})]},B.id)})})]})})]})]})})}function xOe(){var e;if(typeof window<"u"&&((e=window.location)!=null&&e.origin)){const t=String(window.location.hostname||"").trim().toLowerCase();return t==="localhost"||t==="127.0.0.1"?"http://localhost:8000":String(window.location.origin).replace(/\/+$/,"")}return"https://db.krgi.co.in"}const Mp=xOe();function ax(){const e=window.localStorage.getItem("access");return e?{Authorization:`Bearer ${e}`}:{}}function EK(){var Se;const[e,t]=x.useState([]),[r,n]=x.useState("courses"),[i,s]=x.useState(null),[o,l]=x.useState([]),[c,u]=x.useState(!1),[d,f]=x.useState(!1),[h,p]=x.useState(1),[m,g]=x.useState("idle"),[y,b]=x.useState(null),[v,w]=x.useState([]),[S,k]=x.useState(null),[j,A]=x.useState(""),[L,P]=x.useState(""),[F,E]=x.useState(""),[T,B]=x.useState(""),[q,U]=x.useState(""),[se,de]=x.useState(!1),[z,G]=x.useState(null),[ie,Y]=x.useState(null),[C,K]=x.useState([]),[H,R]=x.useState(!1),[J,V]=x.useState(0),[X,Q]=x.useState([]),[ne,oe]=x.useState(null),[O,W]=x.useState(null),[ae,I]=x.useState(null);function Z(he){try{if(typeof he=="string"){let ye=he;return!ye.startsWith("data:")&&/^[A-Za-z0-9+/=\n\r]+$/.test(ye)&&ye.length>100&&(ye=`data:image/png;base64,${ye.replace(/\s+/g,"")}`),ye}if(he&&typeof he=="object"){if(typeof he.url=="string"&&he.url)return he.url;if(typeof he.base64=="string"&&he.base64)return he.base64.startsWith("data:")?he.base64:`data:image/png;base64,${he.base64}`;if(he.binary&&he.binary instanceof Uint8Array){const ye=new Blob([he.binary],{type:"image/png"});return URL.createObjectURL(ye)}}if(he instanceof Uint8Array){const ye=new Blob([he],{type:"image/png"});return URL.createObjectURL(ye)}return null}catch{return null}}x.useEffect(()=>{b0().then(he=>s(he)).catch(()=>s(null)),(async()=>{try{u(!0);const he=await fc();Array.isArray(he)&&l(he)}catch(he){console.warn("Failed to load teaching assignments",he),l([])}finally{u(!1)}})(),(async()=>{try{const he=await fetch(`${Mp}/api/obe/list-uploads`,{headers:{...ax()}});if(!he.ok)return;const ye=await he.json();Array.isArray(ye==null?void 0:ye.files)&&Q(ye.files||[])}catch{}})()},[]);const me=x.useMemo(()=>i?i.faculty_id??i.staff_id??i.employee_id??i.id??null:null,[i]),Te=he=>{const ye=parseFloat(he.replace(/[^0-9.\-]/g,""));return Number.isFinite(ye)?ye:0},Ae=he=>{const ye=`/obe/course/${encodeURIComponent(he)}`;window.location.href=ye},Be=x.useMemo(()=>(v||[]).filter(he=>{const ye=String((he==null?void 0:he.marks)??"").trim().toUpperCase(),ht=String((he==null?void 0:he.btl)??"").trim().toUpperCase(),Ge=String((he==null?void 0:he.course_outcomes)??"").trim().toUpperCase();return!(ye==="(OR)"&&ht==="(OR)"&&Ge==="(OR)")}),[v]),[Ee,ze]=x.useState("idle"),[Xe,Pt]=x.useState(null);async function ft(he){ze("uploading"),Pt(null),g("idle"),b(null),G(null),Y(null);const ye=new FormData;ye.append("file",he);try{const ht=await fetch(`${Mp}/api/obe/upload-docx`,{method:"POST",headers:{...ax()},body:ye});if(!ht.ok){const hr=await ht.text();ze("error"),Pt(hr||`Upload failed (${ht.status})`);return}const Ge=await ht.json();ze("success");const lt=(Ge==null?void 0:Ge.file_url)||(Ge==null?void 0:Ge.saved_path)||"";k(lt||null),Pt(`Uploaded: ${lt}`),f(!0),p(1),w([]),g("scanning"),b("Scanning DOCX");const jt=new FormData;jt.append("file",he);const wt=await fetch(`${Mp}/api/template/scan-docx`,{method:"POST",headers:{...ax()},body:jt});if(!wt.ok){const hr=await wt.text();g("error"),b(hr||`Scan failed (${wt.status})`),w([]);return}const yt=await wt.json(),Tt=(Array.isArray(yt==null?void 0:yt.questions)?yt.questions:[]).map(hr=>({...hr,source_file_path:lt||hr.source_file_path||null}));if(w(Tt),g("success"),b(`Scanned ${Tt.length} question(s).`),!j.trim()){const hr=he.name.replace(/\.docx$/i,"");A(hr)}}catch(ht){ze("error"),Pt((ht==null?void 0:ht.message)||"Upload failed"),g("error"),b((ht==null?void 0:ht.message)||"Scan failed")}}function He(){f(!1),p(1)}async function tt(){if(!j.trim()){Y("Exam name is required."),p(2);return}if(!F.trim()){Y("Exam type is required."),p(2);return}if(!T.trim()){Y("Exam date is required."),p(2);return}de(!0),Y(null),G(null);try{const he=q.split(/\r?\n/).map(jt=>jt.trim()).filter(Boolean),ye=Be.map(jt=>({...jt,excel_type:jt.excel_type||F,source_file_path:jt.source_file_path||S||null})),ht=await fetch(`${Mp}/api/import/questions`,{method:"POST",headers:{"Content-Type":"application/json",...ax()},body:JSON.stringify({title:j.trim(),status:"pending",exam_type:F.trim(),exam_date:T.trim(),sections:he,faculty_id:me,questions:ye})});if(!ht.ok){const jt=await ht.text();Y(jt||`Import failed (${ht.status})`);return}const Ge=await ht.json();G(Ge);const lt={title:j.trim(),inserted:Ge.inserted||0,failed:Array.isArray(Ge.failed)?Ge.failed.length:0,source_file_path:S||null,title_id:Ge.title_id||null,exam_date:T||null,exam_type:F||null,faculty_id:me||null,created_at:new Date().toISOString()};K(jt=>[lt,...jt]),R(!0),setTimeout(()=>R(!1),4e3),setTimeout(()=>He(),600)}catch(he){Y((he==null?void 0:he.message)||"Import failed")}finally{de(!1)}}const _e=e.length;return _e&&(e.reduce((he,ye)=>he+Te(ye.achieved),0)/_e).toFixed(1)+"",a.jsxs("main",{className:"obe-page",style:{padding:"32px 48px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',minHeight:"100vh",background:"linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)"},children:[a.jsx("header",{style:{marginBottom:32,background:"#fff",padding:"28px 32px",borderRadius:16,boxShadow:"0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04)"},children:a.jsx("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"flex-end",width:"100%"},children:a.jsxs("div",{style:{textAlign:"left"},children:[a.jsx("h1",{style:{margin:0,fontSize:32,fontWeight:700,color:"#0f172a",letterSpacing:"-0.02em"},children:"Outcome Based Education (OBE)"}),a.jsx("div",{style:{marginTop:8,color:"#64748b",fontSize:16,fontWeight:400},children:"Select a course, then work through CDAP, Articulation Matrix and Mark Entry."})]})})}),a.jsxs("div",{style:{display:"flex",gap:6,marginBottom:24,background:"#fff",padding:"8px",borderRadius:12,boxShadow:"0 1px 3px rgba(0,0,0,0.06)"},children:[a.jsx("button",{onClick:()=>n("courses"),style:{padding:"10px 24px",borderRadius:8,border:"none",background:r==="courses"?"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)":"transparent",color:r==="courses"?"#fff":"#64748b",cursor:"pointer",fontWeight:r==="courses"?600:500,fontSize:15,transition:"all 0.2s ease",boxShadow:r==="courses"?"0 2px 8px rgba(37,99,235,0.2)":"none"},children:" Courses"}),a.jsx("button",{onClick:()=>n("exam"),style:{padding:"10px 24px",borderRadius:8,border:"none",background:r==="exam"?"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)":"transparent",color:r==="exam"?"#fff":"#64748b",cursor:"pointer",fontWeight:r==="exam"?600:500,fontSize:15,transition:"all 0.2s ease",boxShadow:r==="exam"?"0 2px 8px rgba(37,99,235,0.2)":"none"},children:" Exam Management"})]}),r==="courses"&&a.jsxs("section",{"aria-label":"Course selector",style:{marginBottom:32},children:[a.jsx("div",{style:{fontSize:14,color:"#475569",marginBottom:20,fontWeight:500},children:"Select a course to work on:"}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(320px, 1fr))",gap:24,marginBottom:32},children:c?a.jsx("div",{style:{gridColumn:"1/-1",color:"#64748b",fontSize:16,textAlign:"center",padding:60,background:"#fff",borderRadius:12},children:" Loading courses"}):o.length===0?a.jsxs("div",{style:{gridColumn:"1/-1",color:"#94a3b8",fontSize:18,textAlign:"center",padding:60,background:"#fff",borderRadius:12,border:"2px dashed #e2e8f0"},children:[" No courses found. You have no teaching assignments.",a.jsx("br",{}),a.jsx("span",{style:{fontSize:14,marginTop:12,display:"block"},children:"(If you expect to see courses here, please check with your backend/API or contact admin.)"})]}):o.reduce((he,ye)=>(he.some(ht=>ht.subject_code===ye.subject_code)||he.push(ye),he),[]).map(he=>a.jsxs("div",{onClick:()=>Ae(he.subject_code),role:"button",tabIndex:0,onKeyDown:ye=>{ye.key==="Enter"&&Ae(he.subject_code)},onMouseEnter:ye=>{ye.currentTarget.style.transform="translateY(-4px)",ye.currentTarget.style.boxShadow="0 12px 24px rgba(0,0,0,0.1), 0 4px 8px rgba(0,0,0,0.06)",ye.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:ye=>{ye.currentTarget.style.transform="translateY(0)",ye.currentTarget.style.boxShadow="0 4px 6px rgba(0,0,0,0.07), 0 2px 4px rgba(0,0,0,0.05)",ye.currentTarget.style.borderColor="#e2e8f0"},style:{border:"1px solid #e2e8f0",borderRadius:12,padding:24,background:"#fff",boxShadow:"0 4px 6px rgba(0,0,0,0.07), 0 2px 4px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",alignItems:"flex-start",minHeight:140,position:"relative",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",cursor:"pointer"},children:[a.jsx("div",{style:{fontWeight:700,fontSize:19,marginBottom:6,color:"#0f172a",lineHeight:1.3},children:he.subject_name}),a.jsx("div",{style:{fontSize:14,color:"#3b82f6",marginBottom:16,fontWeight:600,background:"#eff6ff",padding:"4px 10px",borderRadius:6},children:he.subject_code}),a.jsxs("div",{style:{marginTop:"auto",display:"flex",gap:10,alignItems:"center",flexWrap:"wrap"},children:[a.jsx("button",{onClick:ye=>{ye.stopPropagation(),Ae(he.subject_code)},onMouseEnter:ye=>{ye.currentTarget.style.background="linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%)",ye.currentTarget.style.transform="scale(1.05)"},onMouseLeave:ye=>{ye.currentTarget.style.background="linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",ye.currentTarget.style.transform="scale(1)"},style:{padding:"8px 18px",borderRadius:8,border:"none",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"#fff",fontWeight:600,fontSize:14,cursor:"pointer",boxShadow:"0 2px 4px rgba(37,99,235,0.2)",transition:"all 0.2s ease"},children:"Open Course"}),a.jsx("button",{onClick:ye=>{ye.stopPropagation(),window.location.href=`/obe/course/${encodeURIComponent(he.subject_code)}/lca`},onMouseEnter:ye=>{ye.currentTarget.style.background="#f8fafc",ye.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:ye=>{ye.currentTarget.style.background="#fff",ye.currentTarget.style.borderColor="#e2e8f0"},style:{padding:"8px 14px",borderRadius:8,border:"1px solid #e2e8f0",background:"#fff",color:"#475569",fontWeight:600,fontSize:13,cursor:"pointer",transition:"all 0.2s ease"},children:"LCA"}),a.jsx("button",{onClick:ye=>{ye.stopPropagation(),window.location.href=`/obe/course/${encodeURIComponent(he.subject_code)}/co_attainment`},onMouseEnter:ye=>{ye.currentTarget.style.background="#f8fafc",ye.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:ye=>{ye.currentTarget.style.background="#fff",ye.currentTarget.style.borderColor="#e2e8f0"},style:{padding:"8px 14px",borderRadius:8,border:"1px solid #e2e8f0",background:"#fff",color:"#475569",fontWeight:600,fontSize:13,cursor:"pointer",transition:"all 0.2s ease"},children:"CO"})]})]},he.subject_code))})]}),r==="exam"&&a.jsx("section",{"aria-label":"Exam management",style:{background:"#fff",padding:28,borderRadius:16,boxShadow:"0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04)"},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20},children:[a.jsx("div",{style:{background:"#f8fafc",padding:20,borderRadius:12,border:"2px dashed #cbd5e1"},children:a.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center"},children:[a.jsx("input",{id:"exam-upload-input",type:"file",accept:".docx",style:{display:"none"},onChange:he=>{const ye=he.target.files&&he.target.files[0];ye&&ft(ye),he.currentTarget.value=""}}),a.jsx("label",{htmlFor:"exam-upload-input",style:{display:"inline-flex",alignItems:"center",gap:10,padding:"12px 20px",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"#fff",borderRadius:10,cursor:"pointer",fontWeight:600,fontSize:15,boxShadow:"0 2px 8px rgba(37,99,235,0.25)",transition:"all 0.2s ease"},children:Ee==="uploading"?" Uploading...":" Upload .docx"}),a.jsx("div",{style:{color:"#64748b",fontSize:14},children:"Upload exam spreadsheets or related files here."})]})}),a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[a.jsx("input",{type:"search",placeholder:" Search exams, courses, entries...",style:{flex:1,padding:"12px 16px",borderRadius:10,border:"1px solid #e2e8f0",fontSize:15,background:"#fff",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},onChange:()=>{}}),a.jsx("button",{style:{padding:"12px 20px",borderRadius:10,border:"1px solid #e2e8f0",background:"#fff",cursor:"pointer",fontWeight:600,fontSize:14,color:"#475569",transition:"all 0.2s ease",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:"Search"})]}),a.jsxs("div",{style:{marginTop:8},children:[a.jsx("h3",{style:{margin:"12px 0 16px 0",fontSize:18,fontWeight:700,color:"#0f172a"},children:" Recent"}),C.length===0?a.jsxs("div",{style:{color:"#666"},children:[a.jsx("div",{style:{marginBottom:8,fontSize:13},children:"Uploaded DOCX files"}),X.length===0?a.jsx("div",{style:{color:"#666"},children:"No uploaded DOCX files found."}):a.jsx("div",{style:{display:"grid",gap:8},children:X.map((he,ye)=>a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:8,padding:10,background:"#fff",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:700},children:he.name}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:he.path})]}),a.jsx("div",{children:a.jsx("button",{onClick:()=>oe(he),style:{background:"none",border:"none",color:"#2563eb",cursor:"pointer",padding:6},children:"Open"})})]},ye))})]}):a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"320px 1fr",gap:12},children:[a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:C.slice(0,12).map((he,ye)=>{const ht=ye===J;return a.jsxs("div",{onClick:()=>V(ye),role:"button",tabIndex:0,style:{border:ht?"2px solid #2563eb":"1px solid #e5e7eb",borderRadius:8,padding:10,background:"#fff",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer"},children:[a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,children:[a.jsx("path",{d:"M6 2h7l5 5v13a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1z",fill:"#e6f0ff",stroke:"#2563eb",strokeWidth:"0.5"}),a.jsx("path",{d:"M13 2v6h6",fill:"#fff"}),a.jsx("rect",{x:"7",y:"11",width:"10",height:"2.2",rx:"0.6",fill:"#2563eb"}),a.jsx("rect",{x:"7",y:"14",width:"6",height:"2.2",rx:"0.6",fill:"#2563eb"}),a.jsx("text",{x:"7",y:"18.8",fontSize:"2.8",fill:"#2563eb",fontFamily:"Arial, Helvetica, sans-serif",children:"DOCX"})]}),a.jsx("div",{style:{fontWeight:700},children:he.title})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[he.exam_type||"","  ",he.exam_date||""]})]}),a.jsxs("div",{style:{textAlign:"right"},children:[a.jsx("div",{style:{fontWeight:800,color:"#16a34a"},children:he.inserted}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"questions"})]})]},ye)})}),a.jsx("div",{children:C[J]&&a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"Preview"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"240px 1fr",gap:12},children:[a.jsxs("div",{children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,marginBottom:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[a.jsx("div",{style:{width:64,height:64,borderRadius:8,background:"#f3f4f6",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,color:"#6b7280"},children:i!=null&&i.username?String(i.username).slice(0,1).toUpperCase():"U"}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:16,fontWeight:800,color:"#111827"},children:(i==null?void 0:i.username)||""}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Faculty"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:""})]})]}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Faculty ID: ",a.jsx("strong",{style:{color:"#111827"},children:me??""})]})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:13,color:"#6b7280",marginBottom:8},children:"Course details"}),a.jsx("div",{style:{fontWeight:700},children:""}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:""}),a.jsxs("div",{style:{marginTop:8,fontSize:12,color:"#6b7280"},children:["Assignments: ",a.jsx("strong",{style:{color:"#111827"},children:""})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,marginBottom:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Questions imported"}),a.jsx("div",{style:{fontSize:20,fontWeight:900,color:"#111827"},children:C[J].inserted})]}),a.jsxs("div",{style:{textAlign:"right"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Title"}),a.jsx("div",{style:{fontWeight:700},children:C[J].title||""}),a.jsx("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:"Assessment"}),a.jsx("div",{style:{fontWeight:700},children:C[J].exam_type||""})]})]}),a.jsxs("div",{style:{marginTop:12,display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[a.jsxs("div",{children:[a.jsx("span",{style:{color:"#6b7280",fontSize:12},children:"Exam Type"}),a.jsx("div",{style:{fontWeight:700},children:C[J].exam_type||""})]}),a.jsxs("div",{children:[a.jsx("span",{style:{color:"#6b7280",fontSize:12},children:"Exam date"}),a.jsx("div",{style:{fontWeight:700},children:C[J].exam_date||""})]}),a.jsxs("div",{style:{gridColumn:"1 / -1"},children:[a.jsx("span",{style:{color:"#6b7280",fontSize:12},children:"Uploaded file"}),a.jsx("div",{style:{fontWeight:700,whiteSpace:"pre-wrap"},children:C[J].source_file_path||""})]})]})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Questions preview"}),a.jsx("div",{children:a.jsx("button",{onClick:async()=>{var he,ye;W(null);try{const ht=(he=C[J])==null?void 0:he.title_id;let Ge="";ht?Ge=`${Mp}/api/import/questions/list?title_id=${ht}`:Ge=`${Mp}/api/import/questions/list?title=${encodeURIComponent(((ye=C[J])==null?void 0:ye.title)||"")}`;const lt=await fetch(Ge,{headers:{...ax()}});if(!lt.ok){W([]);return}const jt=await lt.json();W(Array.isArray(jt==null?void 0:jt.questions)?jt.questions:[])}catch{W([])}},style:{padding:"6px 10px",borderRadius:8,border:"1px solid #e5e7eb",background:"#fff",cursor:"pointer"},children:"Load questions"})})]}),a.jsx("div",{style:{maxHeight:220,overflow:"auto"},children:O===null?a.jsx("div",{style:{color:"#6b7280"},children:'Click "Load questions" to fetch saved questions for this import.'}):O.length===0?a.jsx("div",{style:{color:"#6b7280"},children:"No saved questions found for this title."}):O.slice(0,20).map((he,ye)=>a.jsxs("div",{style:{padding:"8px 6px",borderBottom:"1px solid #f3f4f6"},children:[a.jsxs("div",{style:{fontWeight:700,color:"#111827"},children:[ye+1,"."]}),a.jsx("div",{style:{color:"#111827"},children:String(he.question_text).slice(0,300)})]},ye))})]})]})]})]})})]})]}),Xe&&a.jsx("div",{style:{marginTop:12,fontSize:14,color:Ee==="error"?"#dc2626":"#16a34a",background:Ee==="error"?"#fef2f2":"#f0fdf4",padding:"12px 16px",borderRadius:10,border:`1px solid ${Ee==="error"?"#fecaca":"#bbf7d0"}`},children:Xe})]})}),d&&a.jsx("div",{role:"dialog","aria-modal":"true",onClick:He,style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",backdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50,padding:20},children:a.jsxs("div",{onClick:he=>he.stopPropagation(),style:{width:"min(1000px, 100%)",background:"#fff",borderRadius:16,boxShadow:"0 20px 50px rgba(0,0,0,0.3)",overflow:"hidden",border:"1px solid #e2e8f0"},children:[a.jsxs("div",{style:{padding:"20px 24px",borderBottom:"1px solid #e2e8f0",display:"flex",alignItems:"center",justifyContent:"space-between",background:"linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:700,fontSize:20,color:"#0f172a"},children:" Question Import"}),a.jsxs("div",{style:{color:"#64748b",fontSize:14,marginTop:4},children:["Step ",h," of 3  ",m==="scanning"?"Scanning":m==="error"?"Scan failed":"Ready"]})]}),a.jsx("button",{onClick:He,onMouseEnter:he=>{he.currentTarget.style.background="#fee2e2"},onMouseLeave:he=>{he.currentTarget.style.background="#fff"},style:{padding:"8px 14px",borderRadius:8,border:"1px solid #e2e8f0",background:"#fff",cursor:"pointer",fontWeight:600,fontSize:14,color:"#64748b",transition:"all 0.2s ease"},children:" Close"})]}),a.jsx("div",{style:{overflow:"hidden",background:"#fafbfc"},children:a.jsxs("div",{style:{display:"flex",width:"300%",transform:`translateX(-${(h-1)*33.3333333}%)`,transition:"transform 360ms cubic-bezier(0.4, 0, 0.2, 1)"},children:[a.jsxs("div",{style:{width:"33.3333333%",padding:24},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,marginBottom:16},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:700,fontSize:18,color:"#0f172a"},children:" Preview"}),a.jsx("div",{style:{fontSize:13,color:"#64748b",marginTop:2},children:S?`Source: ${S}`:"Source: (not available)"})]}),a.jsxs("div",{style:{fontSize:14,color:"#0f172a",background:"#eff6ff",padding:"6px 12px",borderRadius:8,fontWeight:600},children:["Questions: ",a.jsx("b",{style:{color:"#3b82f6"},children:Be.length})]})]}),y&&a.jsx("div",{style:{marginBottom:12,fontSize:14,color:m==="error"?"#dc2626":"#16a34a",background:m==="error"?"#fef2f2":"#f0fdf4",padding:"12px 16px",borderRadius:10,border:`1px solid ${m==="error"?"#fecaca":"#bbf7d0"}`},children:y}),a.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:16,maxHeight:420,overflow:"auto",background:"#fff",boxShadow:"0 2px 8px rgba(0,0,0,0.05)"},children:[m==="scanning"&&a.jsx("div",{style:{color:"#64748b",textAlign:"center",padding:40},children:" Scanning your DOCX"}),m!=="scanning"&&Be.length===0&&a.jsx("div",{style:{color:"#94a3b8",textAlign:"center",padding:40},children:" No questions to preview yet."}),Be.map((he,ye)=>a.jsxs("div",{style:{padding:"14px 12px",borderBottom:ye<Be.length-1?"1px solid #f1f5f9":"none"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:10,marginBottom:8},children:[a.jsxs("div",{style:{fontWeight:700,color:"#3b82f6",fontSize:15,background:"#eff6ff",padding:"4px 10px",borderRadius:6},children:["Q",ye+1]}),a.jsxs("div",{style:{fontSize:12,color:"#64748b",background:"#f8fafc",padding:"4px 10px",borderRadius:6},children:["Marks: ",String((he==null?void 0:he.marks)??"-")," "," BTL: ",String((he==null?void 0:he.btl)??"-")," "," CO: ",String((he==null?void 0:he.course_outcomes)??"-")]})]}),a.jsxs("div",{style:{marginTop:8,color:"#1e293b",whiteSpace:"pre-wrap",fontSize:14,lineHeight:1.6},children:[String((he==null?void 0:he.question_text)??"").slice(0,500),String((he==null?void 0:he.question_text)??"").length>500?"":""]}),Array.isArray(he==null?void 0:he.images)&&he.images.length?a.jsx("div",{style:{marginTop:12,display:"flex",gap:12,flexWrap:"wrap"},children:he.images.slice(0,4).map((ht,Ge)=>{const lt=Z(ht);return lt?a.jsx("img",{src:lt,alt:`q${ye+1}-img${Ge+1}`,onClick:()=>I(lt),style:{maxHeight:140,borderRadius:10,border:"2px solid #e2e8f0",cursor:"pointer",objectFit:"contain",background:"#fff",transition:"all 0.2s ease",boxShadow:"0 2px 6px rgba(0,0,0,0.08)"}},Ge):null})}):null]},ye))]})]}),a.jsxs("div",{style:{width:"33.3333333%",padding:24},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:16,fontSize:18,color:"#0f172a"},children:" Save details"}),ie&&a.jsx("div",{style:{marginBottom:12,fontSize:14,color:"#dc2626",background:"#fef2f2",padding:"12px 16px",borderRadius:10,border:"1px solid #fecaca"},children:ie}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"Exam name"}),a.jsx("input",{value:j,onChange:he=>A(he.target.value),placeholder:"e.g., Unit 1 - Introduction",style:{width:"100%",padding:"12px 14px",borderRadius:10,border:"1px solid #e6eef8",boxShadow:"inset 0 1px 2px #00000008"}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"Exam (CIA / Model / ESE)"}),a.jsxs("select",{value:L,onChange:he=>P(he.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:10,border:"1px solid #e6eef8",background:"#fff"},children:[a.jsx("option",{value:"",children:"Select assessment"}),a.jsx("option",{value:"CIA1",children:"CIA1"}),a.jsx("option",{value:"CIA2",children:"CIA2"}),a.jsx("option",{value:"MODEL",children:"MODEL"}),a.jsx("option",{value:"ESE",children:"ESE"})]})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"Exam Type"}),a.jsxs("select",{value:F,onChange:he=>E(he.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:10,border:"1px solid #e6eef8",background:"#fff"},children:[a.jsx("option",{value:"",children:"Select paper"}),a.jsx("option",{value:"QP1",children:"QP1"}),a.jsx("option",{value:"QP2",children:"QP2"})]})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"Exam date"}),a.jsx("input",{type:"date",value:T,onChange:he=>B(he.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:10,border:"1px solid #e6eef8"}})]}),a.jsxs("div",{style:{gridColumn:"1 / -1"},children:[a.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"Sections"}),a.jsx("textarea",{value:q,onChange:he=>U(he.target.value),placeholder:"e.g., Part A\\nPart B\\nSection 1",rows:3,style:{width:"100%",padding:"12px 14px",borderRadius:10,border:"1px solid #e6eef8",resize:"vertical"}})]})]}),a.jsx("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:"This metadata is shown for confirmation. (Currently, only the exam name is used as the imported title.)"})]}),a.jsxs("div",{style:{width:"33.3333333%",padding:24},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:16,fontSize:18,color:"#0f172a"},children:" Confirmation"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr",gap:16},children:[a.jsxs("div",{children:[a.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:16,marginBottom:16,background:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[a.jsx("div",{style:{width:64,height:64,borderRadius:10,background:"linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%)",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,color:"#3b82f6",fontSize:24},children:i!=null&&i.username?String(i.username).slice(0,1).toUpperCase():""}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#0f172a"},children:(i==null?void 0:i.username)||""}),a.jsx("div",{style:{fontSize:13,color:"#64748b"},children:"Faculty"})]})]}),a.jsxs("div",{style:{marginTop:12,fontSize:13,color:"#475569",background:"#f8fafc",padding:"8px 12px",borderRadius:8},children:["Faculty ID: ",a.jsx("strong",{style:{color:"#0f172a"},children:me??""})]})]}),a.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:16,background:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[a.jsx("div",{style:{fontSize:13,color:"#64748b",marginBottom:10,fontWeight:600},children:" Course details"}),a.jsx("div",{style:{fontWeight:700,color:"#0f172a"},children:""}),a.jsx("div",{style:{fontSize:13,color:"#64748b",marginTop:2},children:""}),a.jsxs("div",{style:{marginTop:12,fontSize:13,color:"#475569"},children:["Assignments: ",a.jsx("strong",{style:{color:"#0f172a"},children:""})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:16,marginBottom:16,background:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:16,flexWrap:"wrap"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:13,color:"#64748b",fontWeight:600},children:"Questions to import"}),a.jsx("div",{style:{fontSize:28,fontWeight:900,color:"#3b82f6",marginTop:4},children:Be.length})]}),a.jsxs("div",{style:{textAlign:"right"},children:[a.jsx("div",{style:{fontSize:13,color:"#64748b",fontWeight:600},children:"Exam name"}),a.jsx("div",{style:{fontWeight:700,color:"#0f172a",fontSize:16,marginTop:2},children:j||""}),a.jsx("div",{style:{marginTop:8,fontSize:13,color:"#64748b",fontWeight:600},children:"Assessment"}),a.jsx("div",{style:{fontWeight:700,color:"#0f172a",marginTop:2},children:L||""})]})]}),a.jsxs("div",{style:{marginTop:16,display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,background:"#f8fafc",padding:12,borderRadius:8},children:[a.jsxs("div",{children:[a.jsx("span",{style:{color:"#64748b",fontSize:13,fontWeight:600},children:"Exam Type"}),a.jsx("div",{style:{fontWeight:700,color:"#0f172a",marginTop:4},children:F||""})]}),a.jsxs("div",{children:[a.jsx("span",{style:{color:"#64748b",fontSize:13,fontWeight:600},children:"Exam date"}),a.jsx("div",{style:{fontWeight:700,color:"#0f172a",marginTop:4},children:T||""})]}),a.jsxs("div",{style:{gridColumn:"1 / -1"},children:[a.jsx("span",{style:{color:"#64748b",fontSize:13,fontWeight:600},children:"Sections"}),a.jsx("div",{style:{fontWeight:700,color:"#0f172a",whiteSpace:"pre-wrap",marginTop:4},children:q||""})]})]})]}),a.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:16,background:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[a.jsx("div",{style:{fontSize:14,color:"#64748b",marginBottom:10,fontWeight:600},children:" Questions preview"}),a.jsx("div",{style:{maxHeight:240,overflow:"auto"},children:Be.slice(0,10).map((he,ye)=>a.jsxs("div",{style:{padding:"10px 8px",borderBottom:ye<Math.min(Be.length,10)-1?"1px solid #f1f5f9":"none",display:"flex",gap:12,alignItems:"flex-start"},children:[a.jsx("div",{style:{fontWeight:700,color:"#3b82f6",minWidth:40,background:"#eff6ff",padding:"4px 8px",borderRadius:6,textAlign:"center"},children:ye+1}),a.jsxs("div",{style:{flex:1},children:[a.jsx("div",{style:{color:"#1e293b",fontSize:14,lineHeight:1.5},children:String(he.question_text).slice(0,260)}),Array.isArray(he.images)&&he.images.length?a.jsx("div",{style:{display:"flex",gap:10,marginTop:8},children:he.images.slice(0,2).map((ht,Ge)=>{const lt=Z(ht);return lt?a.jsx("img",{src:lt,style:{width:90,height:70,objectFit:"cover",borderRadius:8,border:"2px solid #e2e8f0",cursor:"pointer",transition:"all 0.2s ease"},onClick:()=>I(lt)},Ge):null})}):null]})]},ye))})]})]})]}),ie&&a.jsxs("div",{style:{marginTop:16,fontSize:14,color:"#dc2626",background:"#fef2f2",padding:"12px 16px",borderRadius:10,border:"1px solid #fecaca"},children:[" ",ie]}),z&&a.jsxs("div",{style:{marginTop:16,fontSize:14,color:"#16a34a",background:"#f0fdf4",padding:"12px 16px",borderRadius:10,border:"1px solid #bbf7d0"},children:[" Imported ",z.inserted," question(s)",(Se=z.failed)!=null&&Se.length?`, failed ${z.failed.length}.`:"."]})]})]})}),a.jsxs("div",{style:{padding:"16px 24px",borderTop:"1px solid #e2e8f0",display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,background:"#fafbfc"},children:[a.jsx("button",{onClick:()=>p(he=>he===1?1:he-1),disabled:h===1,onMouseEnter:he=>{h!==1&&(he.currentTarget.style.background="#f8fafc")},onMouseLeave:he=>{h!==1&&(he.currentTarget.style.background="#fff")},style:{padding:"10px 18px",borderRadius:10,border:"1px solid #e2e8f0",background:h===1?"#f1f5f9":"#fff",cursor:h===1?"not-allowed":"pointer",fontWeight:600,fontSize:14,color:h===1?"#94a3b8":"#475569",transition:"all 0.2s ease"},children:" Back"}),a.jsx("div",{style:{display:"flex",gap:10,alignItems:"center"},children:h<3?a.jsx("button",{onClick:()=>{if(Y(null),h===2){if(!j.trim()){Y("Exam name is required.");return}if(!F.trim()){Y("Exam type is required.");return}if(!T.trim()){Y("Exam date is required.");return}}p(he=>he+1)},disabled:h===1&&m==="scanning",onMouseEnter:he=>{h===1&&m==="scanning"||(he.currentTarget.style.background="linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%)")},onMouseLeave:he=>{h===1&&m==="scanning"||(he.currentTarget.style.background="linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)")},style:{padding:"10px 24px",borderRadius:10,border:"none",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"#fff",fontWeight:700,cursor:"pointer",fontSize:15,boxShadow:"0 2px 8px rgba(37,99,235,0.25)",transition:"all 0.2s ease"},children:"Next "}):a.jsx("button",{onClick:tt,disabled:se||m==="scanning"||Be.length===0,onMouseEnter:he=>{!se&&m!=="scanning"&&Be.length>0&&(he.currentTarget.style.background="linear-gradient(135deg, #15803d 0%, #166534 100%)")},onMouseLeave:he=>{!se&&m!=="scanning"&&Be.length>0&&(he.currentTarget.style.background="linear-gradient(135deg, #16a34a 0%, #15803d 100%)")},style:{padding:"10px 24px",borderRadius:10,border:"none",background:se?"#cbd5e1":"linear-gradient(135deg, #16a34a 0%, #15803d 100%)",color:"#fff",fontWeight:800,fontSize:15,cursor:se?"not-allowed":"pointer",boxShadow:se?"none":"0 2px 8px rgba(22,163,74,0.25)",transition:"all 0.2s ease"},children:se?" Importing":" Confirm & Import"})})]})]})}),ae&&a.jsx("div",{role:"dialog",onClick:()=>{I(null)},style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.85)",backdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:80},children:a.jsx("div",{onClick:he=>he.stopPropagation(),style:{maxWidth:"95%",maxHeight:"95%",padding:16,background:"#fff",borderRadius:16,boxShadow:"0 20px 50px rgba(0,0,0,0.5)"},children:a.jsx("img",{src:ae,alt:"preview",style:{maxWidth:"100%",maxHeight:"100%",borderRadius:12}})})}),ne&&a.jsx("div",{role:"dialog",onClick:()=>{oe(null)},style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:80,padding:16},children:a.jsxs("div",{onClick:he=>he.stopPropagation(),style:{width:"min(900px, 100%)",background:"#fff",borderRadius:12,boxShadow:"0 12px 40px rgba(0,0,0,0.25)",overflow:"hidden",border:"1px solid #e5e7eb"},children:[a.jsxs("div",{style:{padding:"14px 16px",borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:800,fontSize:16},children:"Uploaded file preview"}),a.jsxs("div",{style:{color:"#6b7280",fontSize:12},children:["Preview of uploaded DOCX  ",ne.name]})]}),a.jsx("button",{onClick:()=>oe(null),style:{padding:"6px 10px",borderRadius:8,border:"1px solid #e5e7eb",background:"#fff",cursor:"pointer"},children:"Close"})]}),a.jsx("div",{style:{padding:16},children:a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr",gap:12},children:[a.jsxs("div",{children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,marginBottom:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[a.jsx("div",{style:{width:64,height:64,borderRadius:8,background:"#f3f4f6",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,color:"#6b7280"},children:i!=null&&i.username?String(i.username).slice(0,1).toUpperCase():"U"}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:16,fontWeight:800,color:"#111827"},children:(i==null?void 0:i.username)||""}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Faculty"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:""})]})]}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Faculty ID: ",a.jsx("strong",{style:{color:"#111827"},children:me??""})]})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:13,color:"#6b7280",marginBottom:8},children:"File details"}),a.jsx("div",{style:{fontWeight:700},children:ne.name}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:ne.path}),a.jsx("div",{style:{marginTop:8},children:a.jsx("a",{href:ne.url,target:"_blank",rel:"noreferrer",style:{color:"#2563eb"},children:"Download file"})})]})]}),a.jsxs("div",{children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,marginBottom:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Uploaded file"}),a.jsx("div",{style:{fontSize:20,fontWeight:900,color:"#111827"},children:ne.name})]}),a.jsxs("div",{style:{textAlign:"right"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Uploaded path"}),a.jsx("div",{style:{fontWeight:700},children:ne.path})]})]}),a.jsx("div",{style:{marginTop:12,display:"grid",gridTemplateColumns:"1fr",gap:10},children:a.jsxs("div",{children:[a.jsx("span",{style:{color:"#6b7280",fontSize:12},children:"Notes"}),a.jsx("div",{style:{fontWeight:700},children:"This preview shows file metadata. Open the file to view full content or import to parse questions."})]})})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:13,color:"#6b7280",marginBottom:8},children:"Importer preview"}),a.jsx("div",{style:{maxHeight:260,overflow:"auto"},children:a.jsx("div",{style:{color:"#6b7280"},children:"To see a full questions preview, upload and scan this DOCX using the importer  then the Step 3 confirmation contains the parsed question list."})})]})]})]})})]})}),H&&a.jsx("div",{style:{position:"fixed",left:24,bottom:24,zIndex:120,animation:"slideIn 0.3s ease"},children:a.jsxs("div",{style:{background:"linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%)",color:"#065f46",border:"1px solid #6ee7b7",padding:"16px 20px",borderRadius:12,boxShadow:"0 10px 30px rgba(0,0,0,0.15)"},children:[a.jsx("div",{style:{fontWeight:800,fontSize:16,marginBottom:4},children:" Imported"}),a.jsxs("div",{style:{fontSize:14,color:"#047857"},children:[(z==null?void 0:z.inserted)??0," question(s) imported successfully."]})]})})]})}const Vu=[{key:"q1",label:"Q1",max:2,co:1,btl:1},{key:"q2",label:"Q2",max:2,co:1,btl:3},{key:"q3",label:"Q3",max:2,co:1,btl:4},{key:"q4",label:"Q4",max:2,co:2,btl:1},{key:"q5",label:"Q5",max:2,co:2,btl:1},{key:"q6",label:"Q6",max:2,co:2,btl:2},{key:"q7",label:"Q7",max:16,co:1,btl:2},{key:"q8",label:"Q8",max:16,co:2,btl:3},{key:"q9",label:"Q9",max:16,co:"1&2",btl:5}];function km(e){let t=0,r=0;for(const n of e||[]){const i=Number(n.max||0);n.co==="1&2"?(t+=i/2,r+=i/2):n.co===2?r+=i:t+=i}return{co1:t,co2:r}}function z1(e){const t={1:0,2:0,3:0,4:0,5:0,6:0};for(const r of e||[]){const n=String(r.btl);n in t&&(t[n]+=Number(r.max||0))}return t}function wv(e){var d,f;const t=km(e.prevQuestions),r=km(e.nextQuestions),n=z1(e.prevQuestions),i=z1(e.nextQuestions),s=Number((d=e.existingCoMax)==null?void 0:d.co1),o=Number((f=e.existingCoMax)==null?void 0:f.co2),l=!Number.isFinite(s)||s===t.co1?r.co1:Math.max(0,s),c=!Number.isFinite(o)||o===t.co2?r.co2:Math.max(0,o),u={...i};return["1","2","3","4","5","6"].forEach(h=>{var m;const p=Number((m=e.existingBtlMax)==null?void 0:m[h]);Number.isFinite(p)&&p!==n[h]&&(u[h]=Math.max(0,p))}),{coMax:{co1:l,co2:c},btlMax:u}}const vj={termLabel:"KRCT AY25-26",assessments:{ssa1:{maxTotal:20,coMax:{co1:10,co2:10},btlMax:{1:0,2:0,3:10,4:10,5:0,6:0}},formative1:{maxPart:5,maxTotal:20,maxCo:10,btlMax:{1:0,2:0,3:10,4:10,5:0,6:0}},cia1:{questions:Vu,coMax:km(Vu),btlMax:z1(Vu)}}},yOe=Array.from({length:11},(e,t)=>`PO${t+1}`);function bOe(e,t){const r=Lc(t),n=e==null?void 0:e[r];return Array.isArray(n)&&n.length===11?n:Array.from({length:11},()=>!1)}function vOe(){var L,P,F,E,T,B,q,U,se,de,z,G,ie,Y,C,K,H,R,J,V;const[e,t]=x.useState({}),[r,n]=x.useState(vj),[i,s]=x.useState(!1),[o,l]=x.useState(null),[c,u]=x.useState("assessments"),[d,f]=x.useState({}),[h,p]=x.useState(""),[m,g]=x.useState(""),[y,b]=x.useState("");x.useEffect(()=>{let X=!0;return(async()=>{try{const Q=await N3();X&&t(Q||{})}catch(Q){X&&l((Q==null?void 0:Q.message)||"Failed to load global mapping")}})(),()=>{X=!1}},[]),x.useEffect(()=>{let X=!0;return(async()=>{var Q,ne,oe,O,W,ae,I;try{const Z=await ku();if(!X)return;const me={...vj,...Z||{},assessments:{...vj.assessments||{},...(Z==null?void 0:Z.assessments)||{}}},Te=((ne=(Q=me.assessments)==null?void 0:Q.cia1)==null?void 0:ne.questions)||[],Ae=Array.isArray(Te)&&Te.length?Te:Vu,Be=km(Ae),Ee=z1(Ae),ze=(O=(oe=me.assessments)==null?void 0:oe.cia1)==null?void 0:O.coMax,Xe=Number(ze==null?void 0:ze.co1),Pt=Number(ze==null?void 0:ze.co2),ft=(ae=(W=me.assessments)==null?void 0:W.cia1)==null?void 0:ae.btlMax,He=tt=>{const _e=Number(ft==null?void 0:ft[tt]);return Number.isFinite(_e)?Math.max(0,_e):Ee[tt]};me.assessments={...me.assessments||{},cia1:{...((I=me.assessments)==null?void 0:I.cia1)||{},questions:Ae,coMax:{co1:Number.isFinite(Xe)?Math.max(0,Xe):Be.co1,co2:Number.isFinite(Pt)?Math.max(0,Pt):Be.co2},btlMax:{1:He("1"),2:He("2"),3:He("3"),4:He("4"),5:He("5"),6:He("6")}}},n(me)}catch(Z){X&&l((Z==null?void 0:Z.message)||"Failed to load assessment master config")}})(),()=>{X=!1}},[]);const v=x.useMemo(()=>Fm.map(X=>({label:X,key:Lc(X),values:bOe(e,X)})),[e]),w=(X,Q,ne)=>{const oe=Lc(X);t(O=>{const W=Array.isArray(O==null?void 0:O[oe])?[...O[oe]]:Array.from({length:11},()=>!1);return W[Q]=ne,{...O,[oe]:W}})},S=async()=>{s(!0),l(null);try{c==="po"?(await D9(e),l("Saved global mapping.")):(await Qre(r),l("Saved assessment master config."))}catch(X){l((X==null?void 0:X.message)||"Failed to save global mapping")}finally{s(!1)}},k=x.useMemo(()=>{var Q,ne;const X=(ne=(Q=r==null?void 0:r.assessments)==null?void 0:Q.cia1)==null?void 0:ne.questions;return Array.isArray(X)&&X.length?X:Vu},[r]),j=x.useMemo(()=>k.filter(X=>d[X.key]),[k,d]),A=()=>{j.length&&n(X=>{var O,W,ae,I,Z,me,Te;const Q=(((W=(O=X.assessments)==null?void 0:O.cia1)==null?void 0:W.questions)||Vu).slice(),ne=Q.map(Ae=>{if(!d[Ae.key])return Ae;const Be={...Ae};return h!==""&&Number.isFinite(Number(h))&&(Be.max=Math.max(0,Number(h))),(m==="1"||m==="2")&&(Be.co=Number(m)),m==="1&2"&&(Be.co="1&2"),y&&["1","2","3","4","5","6"].includes(y)&&(Be.btl=Number(y)),Be}),oe=wv({prevQuestions:Q,nextQuestions:ne,existingCoMax:(I=(ae=X.assessments)==null?void 0:ae.cia1)==null?void 0:I.coMax,existingBtlMax:(me=(Z=X.assessments)==null?void 0:Z.cia1)==null?void 0:me.btlMax});return{...X,assessments:{...X.assessments||{},cia1:{...((Te=X.assessments)==null?void 0:Te.cia1)||{},questions:ne,coMax:oe.coMax,btlMax:oe.btlMax}}}})};return a.jsx("main",{className:"obe-master-page",style:{padding:0,fontFamily:"Arial, sans-serif",minHeight:"100vh",background:"#fff"},children:a.jsxs("div",{style:{padding:"0px",width:"100%",minWidth:0,boxSizing:"border-box"},children:[a.jsxs("div",{style:{marginBottom:16},children:[a.jsx("h2",{style:{margin:0},children:"OBE Master"}),a.jsx("div",{style:{color:"#666",marginTop:4},children:"Global settings for OBE pages"})]}),a.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12,flexWrap:"wrap"},children:[a.jsx("button",{onClick:()=>u("assessments"),style:{padding:"8px 10px",borderRadius:8,border:"1px solid #e5e7eb",background:c==="assessments"?"#111827":"#fff",color:c==="assessments"?"#fff":"#111827"},children:"Assessment Headers"}),a.jsx("button",{onClick:()=>u("po"),style:{padding:"8px 10px",borderRadius:8,border:"1px solid #e5e7eb",background:c==="po"?"#111827":"#fff",color:c==="po"?"#fff":"#111827"},children:"Active Learning PO Mapping"})]}),o&&a.jsx("div",{style:{marginBottom:12,fontSize:12,color:o.startsWith("Saved")?"#166534":"#b91c1c"},children:o}),c==="po"?a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12,background:"#fff"},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:900},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,textAlign:"left",background:"#f8fafc"},children:"Activity"}),yOe.map(X=>a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,textAlign:"center",background:"#fff7ed"},children:X},X))]})}),a.jsx("tbody",{children:v.map((X,Q)=>a.jsxs("tr",{style:{background:Q%2===0?"#fff":"#f9fafb"},children:[a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,fontWeight:600},children:X.label}),X.values.map((ne,oe)=>a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,textAlign:"center"},children:a.jsx("input",{type:"checkbox",checked:!!ne,onChange:O=>w(X.label,oe,O.target.checked)})},`${X.key}-${oe}`))]},X.key))})]})}):a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:12},children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"Global Term Label"}),a.jsx("input",{value:r.termLabel??"",onChange:X=>n(Q=>({...Q,termLabel:X.target.value})),style:{padding:8,borderRadius:8,border:"1px solid #d1d5db",width:260}})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"SSA1 Headers"}),a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center"},children:[a.jsxs("label",{style:{fontSize:12},children:["Total Max",a.jsx("input",{type:"number",value:String(((P=(L=r.assessments)==null?void 0:L.ssa1)==null?void 0:P.maxTotal)??20),onChange:X=>n(Q=>{var ne;return{...Q,assessments:{...Q.assessments||{},ssa1:{...((ne=Q.assessments)==null?void 0:ne.ssa1)||{},maxTotal:Number(X.target.value||0)}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]}),a.jsxs("label",{style:{fontSize:12},children:["CO1 Max",a.jsx("input",{type:"number",value:String(((T=(E=(F=r.assessments)==null?void 0:F.ssa1)==null?void 0:E.coMax)==null?void 0:T.co1)??10),onChange:X=>n(Q=>{var ne,oe,O;return{...Q,assessments:{...Q.assessments||{},ssa1:{...((ne=Q.assessments)==null?void 0:ne.ssa1)||{},coMax:{...((O=(oe=Q.assessments)==null?void 0:oe.ssa1)==null?void 0:O.coMax)||{},co1:Number(X.target.value||0)}}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]}),a.jsxs("label",{style:{fontSize:12},children:["CO2 Max",a.jsx("input",{type:"number",value:String(((U=(q=(B=r.assessments)==null?void 0:B.ssa1)==null?void 0:q.coMax)==null?void 0:U.co2)??10),onChange:X=>n(Q=>{var ne,oe,O;return{...Q,assessments:{...Q.assessments||{},ssa1:{...((ne=Q.assessments)==null?void 0:ne.ssa1)||{},coMax:{...((O=(oe=Q.assessments)==null?void 0:oe.ssa1)==null?void 0:O.coMax)||{},co2:Number(X.target.value||0)}}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]})]})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"Formative 1 Headers"}),a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center"},children:[a.jsxs("label",{style:{fontSize:12},children:["Part Max",a.jsx("input",{type:"number",value:String(((de=(se=r.assessments)==null?void 0:se.formative1)==null?void 0:de.maxPart)??5),onChange:X=>n(Q=>{var ne;return{...Q,assessments:{...Q.assessments||{},formative1:{...((ne=Q.assessments)==null?void 0:ne.formative1)||{},maxPart:Number(X.target.value||0)}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]}),a.jsxs("label",{style:{fontSize:12},children:["Total Max",a.jsx("input",{type:"number",value:String(((G=(z=r.assessments)==null?void 0:z.formative1)==null?void 0:G.maxTotal)??20),onChange:X=>n(Q=>{var ne;return{...Q,assessments:{...Q.assessments||{},formative1:{...((ne=Q.assessments)==null?void 0:ne.formative1)||{},maxTotal:Number(X.target.value||0)}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]}),a.jsxs("label",{style:{fontSize:12},children:["CO Max",a.jsx("input",{type:"number",value:String(((Y=(ie=r.assessments)==null?void 0:ie.formative1)==null?void 0:Y.maxCo)??10),onChange:X=>n(Q=>{var ne;return{...Q,assessments:{...Q.assessments||{},formative1:{...((ne=Q.assessments)==null?void 0:ne.formative1)||{},maxCo:Number(X.target.value||0)}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]})]})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:10},children:"CIA 1"}),a.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap",alignItems:"stretch",marginBottom:12},children:[a.jsxs("div",{style:{flex:"1 1 360px",border:"1px solid #eef2f7",borderRadius:12,padding:12,background:"#fbfdff"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"CIA1 Limits"}),a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center",marginBottom:10},children:[a.jsxs("label",{style:{fontSize:12},children:["CO-1 Max",a.jsx("input",{type:"number",value:String(((H=(K=(C=r.assessments)==null?void 0:C.cia1)==null?void 0:K.coMax)==null?void 0:H.co1)??km(k).co1),onChange:X=>n(Q=>{var ne,oe,O;return{...Q,assessments:{...Q.assessments||{},cia1:{...((ne=Q.assessments)==null?void 0:ne.cia1)||{},coMax:{...(O=(oe=Q.assessments)==null?void 0:oe.cia1)==null?void 0:O.coMax,co1:Math.max(0,Number(X.target.value||0))}}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90,textAlign:"center"}})]}),a.jsxs("label",{style:{fontSize:12},children:["CO-2 Max",a.jsx("input",{type:"number",value:String(((V=(J=(R=r.assessments)==null?void 0:R.cia1)==null?void 0:J.coMax)==null?void 0:V.co2)??km(k).co2),onChange:X=>n(Q=>{var ne,oe,O;return{...Q,assessments:{...Q.assessments||{},cia1:{...((ne=Q.assessments)==null?void 0:ne.cia1)||{},coMax:{...(O=(oe=Q.assessments)==null?void 0:oe.cia1)==null?void 0:O.coMax,co2:Math.max(0,Number(X.target.value||0))}}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90,textAlign:"center"}})]})]}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"BTL Max Marks (1 to 6)"}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(6, minmax(70px, 1fr))",gap:8},children:["1","2","3","4","5","6"].map(X=>{var Q,ne,oe;return a.jsxs("label",{style:{fontSize:12,display:"flex",flexDirection:"column",gap:4},children:[a.jsxs("span",{style:{color:"#111827"},children:["BTL-",X]}),a.jsx("input",{type:"number",value:String(((oe=(ne=(Q=r.assessments)==null?void 0:Q.cia1)==null?void 0:ne.btlMax)==null?void 0:oe[X])??z1(k)[X]),onChange:O=>n(W=>{var ae,I,Z;return{...W,assessments:{...W.assessments||{},cia1:{...((ae=W.assessments)==null?void 0:ae.cia1)||{},btlMax:{...((Z=(I=W.assessments)==null?void 0:I.cia1)==null?void 0:Z.btlMax)||{},[X]:Math.max(0,Number(O.target.value||0))}}}}}),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db",textAlign:"center"}})]},X)})})]}),a.jsxs("div",{style:{flex:"2 1 520px",border:"1px solid #eef2f7",borderRadius:12,padding:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",alignItems:"center"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:700},children:"CIA1 Question Headers"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Select question rows and apply Max / CO / BTL in bulk."})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("input",{placeholder:"Max",value:h,onChange:X=>p(X.target.value),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}}),a.jsxs("select",{value:m,onChange:X=>g(X.target.value),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db"},children:[a.jsx("option",{value:"",children:"CO"}),a.jsx("option",{value:"1",children:"CO-1"}),a.jsx("option",{value:"2",children:"CO-2"}),a.jsx("option",{value:"1&2",children:"CO-1&CO-2 (split)"})]}),a.jsxs("select",{value:y,onChange:X=>b(X.target.value),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db"},children:[a.jsx("option",{value:"",children:"BTL"}),[1,2,3,4,5,6].map(X=>a.jsxs("option",{value:String(X),children:["BTL-",X]},X))]}),a.jsxs("button",{onClick:A,disabled:!j.length,style:{padding:"8px 10px"},children:["Apply to Selected (",j.length,")"]})]})]}),a.jsx("div",{style:{overflowX:"auto",marginTop:10,border:"1px solid #e5e7eb",borderRadius:10},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:720},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"center"},children:"Sel"}),a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"left"},children:"Key"}),a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"left"},children:"Label"}),a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"center"},children:"Max"}),a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"center"},children:"CO"}),a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"center"},children:"BTL"})]})}),a.jsx("tbody",{children:k.map((X,Q)=>a.jsxs("tr",{style:{background:Q%2===0?"#fff":"#f9fafb"},children:[a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,textAlign:"center"},children:a.jsx("input",{type:"checkbox",checked:!!d[X.key],onChange:ne=>f(oe=>({...oe,[X.key]:ne.target.checked}))})}),a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10},children:X.key}),a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10},children:a.jsx("input",{value:X.label,onChange:ne=>n(oe=>{var ae,I,Z;const W=(((I=(ae=oe.assessments)==null?void 0:ae.cia1)==null?void 0:I.questions)||Vu).slice().map(me=>me.key===X.key?{...me,label:ne.target.value}:me);return{...oe,assessments:{...oe.assessments||{},cia1:{...((Z=oe.assessments)==null?void 0:Z.cia1)||{},questions:W}}}}),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db",width:"100%"}})}),a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,textAlign:"center"},children:a.jsx("input",{type:"number",value:String(X.max),onChange:ne=>n(oe=>{var Z,me,Te,Ae,Be,Ee,ze;const O=Math.max(0,Number(ne.target.value||0)),W=(((me=(Z=oe.assessments)==null?void 0:Z.cia1)==null?void 0:me.questions)||Vu).slice(),ae=W.map(Xe=>Xe.key===X.key?{...Xe,max:O}:Xe),I=wv({prevQuestions:W,nextQuestions:ae,existingCoMax:(Ae=(Te=oe.assessments)==null?void 0:Te.cia1)==null?void 0:Ae.coMax,existingBtlMax:(Ee=(Be=oe.assessments)==null?void 0:Be.cia1)==null?void 0:Ee.btlMax});return{...oe,assessments:{...oe.assessments||{},cia1:{...((ze=oe.assessments)==null?void 0:ze.cia1)||{},questions:ae,coMax:I.coMax,btlMax:I.btlMax}}}}),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90,textAlign:"center"}})}),a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,textAlign:"center"},children:a.jsxs("select",{value:String(X.co),onChange:ne=>n(oe=>{var me,Te,Ae,Be,Ee,ze,Xe;const O=String(ne.target.value),W=O==="1&2"?"1&2":Number(O)===2?2:1,ae=(((Te=(me=oe.assessments)==null?void 0:me.cia1)==null?void 0:Te.questions)||Vu).slice(),I=ae.map(Pt=>Pt.key===X.key?{...Pt,co:W}:Pt),Z=wv({prevQuestions:ae,nextQuestions:I,existingCoMax:(Be=(Ae=oe.assessments)==null?void 0:Ae.cia1)==null?void 0:Be.coMax,existingBtlMax:(ze=(Ee=oe.assessments)==null?void 0:Ee.cia1)==null?void 0:ze.btlMax});return{...oe,assessments:{...oe.assessments||{},cia1:{...((Xe=oe.assessments)==null?void 0:Xe.cia1)||{},questions:I,coMax:Z.coMax,btlMax:Z.btlMax}}}}),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db"},children:[a.jsx("option",{value:"1",children:"1"}),a.jsx("option",{value:"2",children:"2"}),a.jsx("option",{value:"1&2",children:"1&2"})]})}),a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,textAlign:"center"},children:a.jsx("select",{value:String(X.btl),onChange:ne=>n(oe=>{var Z,me,Te,Ae,Be,Ee,ze;const O=Math.min(6,Math.max(1,Number(ne.target.value||1))),W=(((me=(Z=oe.assessments)==null?void 0:Z.cia1)==null?void 0:me.questions)||Vu).slice(),ae=W.map(Xe=>Xe.key===X.key?{...Xe,btl:O}:Xe),I=wv({prevQuestions:W,nextQuestions:ae,existingCoMax:(Ae=(Te=oe.assessments)==null?void 0:Te.cia1)==null?void 0:Ae.coMax,existingBtlMax:(Ee=(Be=oe.assessments)==null?void 0:Be.cia1)==null?void 0:Ee.btlMax});return{...oe,assessments:{...oe.assessments||{},cia1:{...((ze=oe.assessments)==null?void 0:ze.cia1)||{},questions:ae,coMax:I.coMax,btlMax:I.btlMax}}}}),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db"},children:[1,2,3,4,5,6].map(ne=>a.jsx("option",{value:String(ne),children:ne},ne))})})]},X.key))})]})})]})]})]})]}),a.jsx("div",{style:{marginTop:16,display:"flex",gap:12},children:a.jsx("button",{onClick:S,disabled:i,style:{padding:"10px 14px",borderRadius:8,border:"1px solid #2563eb",background:"#2563eb",color:"#fff",fontWeight:600,cursor:"pointer"},children:i?"Saving...":c==="po"?"Save Global PO Mapping":"Save Assessment Headers"})})]})})}function wOe(){var u,d;const e=dl(),r=x.useMemo(()=>new URLSearchParams(e.search),[e.search]).get("tab")||"obe",[n,i]=x.useState(r),s=((u=window.__APP_ME__)==null?void 0:u.permissions)||((d=window.__ME__)==null?void 0:d.permissions)||[],l=(Array.isArray(s)?s.map(f=>String(f||"").toLowerCase()):[]).includes("obe.master.manage"),c=x.useMemo(()=>{const f=[];return f.push({key:"obe",label:"OBE"}),l&&(f.push({key:"obe_master",label:"OBE Master"}),f.push({key:"due_dates",label:"OBE: Due Dates"})),f},[l]);return on.useEffect(()=>{var f;c.some(h=>h.key===n)||i(((f=c[0])==null?void 0:f.key)||"obe")},[c,n]),x.useEffect(()=>{const f=new URLSearchParams(e.search).get("tab");f&&c.some(h=>h.key===f)&&f!==n&&i(f)},[e.search]),a.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[a.jsxs("div",{style:{marginBottom:12},children:[a.jsx("h2",{style:{margin:0,fontSize:20},children:"Academic"}),a.jsx("div",{style:{color:"#6b7280",marginTop:6},children:"Quick access to OBE tools."})]}),a.jsx("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:18},children:c.map(f=>a.jsx("button",{onClick:()=>i(f.key),style:{padding:"8px 12px",borderRadius:8,border:n===f.key?"1px solid #10b981":"1px solid #e5e7eb",background:n===f.key?"#ecfdf5":"#fff",fontWeight:700,cursor:"pointer"},children:f.label},f.key))}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[n==="obe"&&a.jsx(EK,{}),n==="obe_master"&&l&&a.jsx(vOe,{}),n==="due_dates"&&l&&a.jsx(k3,{})]})]})}const SOe="https://db.krgi.co.in",GF=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":SOe;function KF(){const e=window.localStorage.getItem("access");return e?{Authorization:`Bearer ${e}`}:{}}function _Oe(){var P,F;const[e,t]=x.useState(null),[r,n]=x.useState(!1),[i,s]=x.useState(null),[o,l]=x.useState([]),[c,u]=x.useState(null),[d,f]=x.useState(""),[h,p]=x.useState("pending"),[m,g]=x.useState(!1),[y,b]=x.useState(null),[v,w]=x.useState(null),[S,k]=x.useState(null),j=x.useMemo(()=>o.filter(E=>{const T=String(E.marks??"").trim().toUpperCase(),B=String(E.btl??"").trim().toUpperCase(),q=String(E.course_outcomes??"").trim().toUpperCase();return!(T==="(OR)"&&B==="(OR)"&&q==="(OR)")}),[o]);async function A(){if(!e){s("Please select a .docx file first.");return}n(!0),s(null),b(null),w(null);const E=new FormData;E.append("file",e);try{const T=await fetch(`${GF}/api/template/scan-docx`,{method:"POST",headers:{...KF()},body:E});if(!T.ok){const U=await T.text();s(U||`Scan failed (${T.status})`),l([]);return}const B=await T.json(),q=Array.isArray(B==null?void 0:B.questions)?B.questions:[];u((B==null?void 0:B.debug)??null);try{console.debug("scan_docx response: questions=",q.length,"sample=",q[0]?{q0:q[0].question_text,imgs:(q[0].images||[]).slice(0,2)}:null),q.length&&q.forEach((U,se)=>{console.log(`Q#${se+1} images:`,Array.isArray(U.images)?U.images.map(de=>typeof de=="string"?de.slice(0,80):typeof de):U.images)})}catch(U){console.warn("scan_docx debug log failed",U)}l(q)}catch(T){s((T==null?void 0:T.message)||"Scan failed"),l([])}finally{n(!1)}}async function L(){if(!d.trim()){w("Title is required to import.");return}g(!0),w(null),b(null);try{const E={title:d.trim(),status:h,questions:j},T=await fetch(`${GF}/api/import/questions`,{method:"POST",headers:{"Content-Type":"application/json",...KF()},body:JSON.stringify(E)});if(!T.ok){const q=await T.text();w(q||`Import failed (${T.status})`);return}const B=await T.json();b(B)}catch(E){w((E==null?void 0:E.message)||"Import failed")}finally{g(!1)}}return a.jsxs("div",{style:{maxWidth:1100,margin:"0 auto",padding:24},children:[a.jsx("h1",{style:{marginTop:0},children:"Question Import"}),a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",flexWrap:"wrap"},children:[a.jsx("input",{type:"file",accept:".docx",onChange:E=>{var T;return t(((T=E.target.files)==null?void 0:T[0])||null)}}),a.jsx("button",{onClick:A,disabled:r||!e,children:r?"Scanning":"Scan DOCX"}),a.jsx("div",{style:{color:"#666",fontSize:13},children:o.length?`${o.length} scanned (${j.length} visible)`:""})]}),i&&a.jsx("div",{style:{marginTop:10,color:"#b91c1c"},children:i}),c&&a.jsxs("div",{style:{marginTop:10,padding:10,background:"#f8fafc",border:"1px solid #e6eef8",borderRadius:8},children:[a.jsx("div",{style:{fontSize:13,color:"#0747a6",fontWeight:700},children:"Scan debug"}),a.jsxs("div",{style:{fontSize:13,color:"#333"},children:["Questions parsed: ",c.parsed_questions??"-"]}),a.jsxs("div",{style:{fontSize:13,color:"#333"},children:["Total images: ",c.total_images??0]}),a.jsxs("div",{style:{fontSize:12,color:"#666",marginTop:6},children:["Sample questions: ",Array.isArray(c.sample_questions)?c.sample_questions.join(" | "):"-"]}),a.jsxs("div",{style:{fontSize:12,color:"#666",marginTop:6},children:["Sample image prefix: ",a.jsx("code",{style:{background:"#fff",padding:"2px 6px",borderRadius:4},children:String(c.sample_image_prefix||"").slice(0,200)})]}),a.jsxs("div",{style:{fontSize:12,color:"#666",marginTop:6},children:["First questions' images (raw):",a.jsx("pre",{style:{whiteSpace:"pre-wrap",maxHeight:160,overflow:"auto",background:"#fff",padding:8,borderRadius:6},children:JSON.stringify(o.slice(0,3).map(E=>E.images),null,2)})]})]}),a.jsx("hr",{style:{margin:"20px 0"}}),a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",flexWrap:"wrap"},children:[a.jsx("input",{value:d,onChange:E=>f(E.target.value),placeholder:"Title (e.g., Midterm 2026)",style:{padding:"8px 10px",border:"1px solid #e5e7eb",borderRadius:6,minWidth:260}}),a.jsxs("select",{value:h,onChange:E=>p(E.target.value),style:{padding:"8px 10px",border:"1px solid #e5e7eb",borderRadius:6},children:[a.jsx("option",{value:"pending",children:"pending"}),a.jsx("option",{value:"approved",children:"approved"})]}),a.jsx("button",{onClick:L,disabled:m||j.length===0,children:m?"Importing":"Import to Bank"})]}),v&&a.jsx("div",{style:{marginTop:10,color:"#b91c1c"},children:v}),y&&a.jsxs("div",{style:{marginTop:10,color:"#166534"},children:["Imported ",y.inserted," question(s)",(P=y.failed)!=null&&P.length?`, ${y.failed.length} failed.`:"."]}),(F=y==null?void 0:y.failed)!=null&&F.length?a.jsxs("div",{style:{marginTop:10},children:[a.jsx("h3",{style:{margin:"10px 0"},children:"Failures"}),a.jsx("ul",{children:y.failed.map(E=>a.jsxs("li",{style:{color:"#b91c1c"},children:["#",E.index+1,": ",E.error]},E.index))})]}):null,a.jsx("hr",{style:{margin:"20px 0"}}),a.jsx("h2",{style:{margin:"10px 0"},children:"Preview"}),j.length===0?a.jsx("div",{style:{color:"#666"},children:"No questions to preview yet."}):a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:12},children:[j.slice(0,50).map((E,T)=>a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:14},children:[a.jsxs("div",{style:{fontWeight:700,marginBottom:6},children:[T+1,". ",E.question_text]}),a.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap",color:"#555",fontSize:13,marginBottom:8},children:[E.marks!=null&&a.jsxs("span",{children:["Marks: ",String(E.marks)]}),E.btl!=null&&a.jsxs("span",{children:["BTL: ",String(E.btl)]}),E.course_outcomes&&a.jsxs("span",{children:["CO: ",E.course_outcomes]}),E.chapter&&a.jsxs("span",{children:["Chapter: ",E.chapter]})]}),Array.isArray(E.options)&&E.options.length?a.jsx("ol",{type:"a",style:{marginTop:0},children:E.options.map((B,q)=>a.jsx("li",{children:String(B)},q))}):null,E.correct_answer?a.jsxs("div",{style:{marginTop:6,color:"#111",fontSize:13},children:[a.jsx("strong",{children:"Answer:"})," ",E.correct_answer]}):null,E.answer_text?a.jsxs("div",{style:{marginTop:4,color:"#444",fontSize:13},children:[a.jsx("strong",{children:"Explanation:"})," ",E.answer_text]}):null,Array.isArray(E.images)&&E.images.length?a.jsx("div",{style:{marginTop:10,display:"flex",gap:10,flexWrap:"wrap"},children:E.images.slice(0,6).map((B,q)=>{let U=null;try{if(typeof B=="string")U=B,!U.startsWith("data:")&&/^[A-Za-z0-9+/=\n\r]+$/.test(U)&&U.length>100&&(U=`data:image/png;base64,${U.replace(/\s+/g,"")}`);else if(B&&typeof B=="object"){if(B.url)U=B.url;else if(B.base64)U=B.base64.startsWith("data:")?B.base64:`data:image/png;base64,${B.base64}`;else if(B.binary&&B.binary instanceof Uint8Array){const se=new Blob([B.binary],{type:"image/png"});U=URL.createObjectURL(se)}}else if(B instanceof Uint8Array){const se=new Blob([B],{type:"image/png"});U=URL.createObjectURL(se)}}catch{U=null}return U?a.jsx("img",{src:U,alt:`q${T+1}-img${q+1}`,onClick:()=>k(U),style:{maxHeight:140,borderRadius:8,border:"1px solid #eee",cursor:"pointer",objectFit:"contain"}},q):null})}):null]},T)),j.length>50&&a.jsx("div",{style:{color:"#666"},children:"Showing first 50 questions."})]}),S&&a.jsx("div",{role:"dialog",onClick:()=>{k(null)},style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:60},children:a.jsx("div",{onClick:E=>E.stopPropagation(),style:{maxWidth:"90%",maxHeight:"90%",padding:12},children:a.jsx("img",{src:S,alt:"preview",style:{maxWidth:"100%",maxHeight:"100%",borderRadius:8}})})})]})}function kOe({courseId:e,classType:t,questionPaperType:r,enabledAssessments:n}){const[i,s]=x.useState(e||""),[o,l]=x.useState(!1);return x.useEffect(()=>{e&&e!==i&&s(e),!e&&i&&s("")},[e]),a.jsx("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #ecfdf5 0%, #ffffff 60%)",padding:"0"},children:a.jsxs("div",{style:{background:"#ffffff",minHeight:"100vh",display:"flex",flexDirection:"column"},children:[a.jsxs("div",{style:{background:"linear-gradient(135deg, #10b981, #059669)",color:"#ffffff",padding:"20px 24px",flexShrink:0},children:[a.jsx("div",{style:{fontSize:24,fontWeight:800},children:"Mark Entry"}),a.jsxs("div",{style:{fontSize:14,opacity:.9},children:[" ",i?`Course: ${i}`:"No course selected"," "]})]}),a.jsxs("div",{style:{padding:"20px 24px",flex:1},children:[!e&&a.jsxs("div",{className:"obe-card",style:{marginBottom:12},children:[a.jsx("label",{style:{display:"block",fontSize:12,fontWeight:700,color:"#065f46",textTransform:"uppercase",letterSpacing:"0.03em"},children:"Course ID"}),a.jsx("input",{value:i,onChange:c=>s(c.target.value),placeholder:"Enter course id",className:"obe-input",style:{marginTop:6,...o?{boxShadow:"0 0 0 3px rgba(16,185,129,0.2)",borderColor:"#a7f3d0"}:{}},onFocus:()=>l(!0),onBlur:()=>l(!1)})]}),i?a.jsx(N6,{subjectId:i,classType:t,questionPaperType:r,enabledAssessments:n}):a.jsx("div",{style:{background:"#d1fae5",border:"1px solid #a7f3d0",color:"#065f46",fontSize:14,padding:12,borderRadius:10},children:"Select a course to start mark entry."})]})]})})}const Ec={header:["CO1","CO1","CO1","CO2","CO2","CO2","CO3","CO3","CO3","CO4","CO4","CO4","CO1","CO2","CO3","CO4","CO5"],weights:[1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,2,2,2,2,4],cycles:["ssa","cia","fa","ssa","cia","fa","ssa","cia","fa","ssa","cia","fa","ME","ME","ME","ME","ME"]},jOe=[{key:"q1",max:2,co:1},{key:"q2",max:2,co:1},{key:"q3",max:2,co:1},{key:"q4",max:2,co:2},{key:"q5",max:2,co:2},{key:"q6",max:2,co:2},{key:"q7",max:16,co:1},{key:"q8",max:16,co:2},{key:"q9",max:16,co:"1&2"}],AOe=[{key:"q1",max:2,co:3},{key:"q2",max:2,co:3},{key:"q3",max:2,co:3},{key:"q4",max:2,co:4},{key:"q5",max:2,co:4},{key:"q6",max:2,co:4},{key:"q7",max:16,co:3},{key:"q8",max:16,co:4},{key:"q9",max:16,co:"3&4"}],NOe=[{key:"q1",max:2},{key:"q2",max:2},{key:"q3",max:2},{key:"q4",max:2},{key:"q5",max:2},{key:"q6",max:2},{key:"q7",max:2},{key:"q8",max:2},{key:"q9",max:2},{key:"q10",max:2},{key:"q11",max:14},{key:"q12",max:14},{key:"q13",max:14},{key:"q14",max:14},{key:"q15",max:14},{key:"q16",max:10}],Sv=[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5,5];function fi(e,t,r){return Math.max(t,Math.min(r,e))}function Uf(e){return Math.round(e*100)/100}function To(e){if(e===""||e==null)return null;const t=Number(e);return Number.isFinite(t)?t:null}function YF(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const o=r.localeCompare(n);if(o)return o}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim();return i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}function COe(e){return e==="1&2"?{co1:.5,co2:.5}:e===2?{co1:0,co2:1}:{co1:1,co2:0}}function EOe(e){return e==="3&4"?{co3:.5,co4:.5}:e===4?{co3:0,co4:1}:{co3:1,co4:0}}function wj(e){if(e==="both"||e==="1&2")return"1&2";if(Array.isArray(e)){const r=e.map(s=>String(s??"").trim().toUpperCase());if(r.some(s=>s==="BOTH"))return"1&2";const n=r.some(s=>s==="1"||s==="CO1"),i=r.some(s=>s==="2"||s==="CO2");return n&&i?"1&2":i?2:1}if(typeof e=="string"){const r=e.trim().toUpperCase();if(r==="BOTH"||r==="1&2"||r==="1,2"||r==="1/2"||r==="2/1"||r==="CO1&CO2"||r==="CO1,CO2")return"1&2";if(r==="2"||r==="CO2")return 2;if(r==="1"||r==="CO1")return 1}const t=Number(e);return t===2?2:t===12?"1&2":1}function Sj(e){if(e==="both"||e==="3&4")return"3&4";if(Array.isArray(e)){const r=e.map(l=>String(l??"").trim().toUpperCase());if(r.some(l=>l==="BOTH"))return"3&4";const n=r.some(l=>l==="1"||l==="CO1"),i=r.some(l=>l==="2"||l==="CO2"),s=r.some(l=>l==="3"||l==="CO3"),o=r.some(l=>l==="4"||l==="CO4");return s&&o||n&&i?"3&4":o||i?4:3}if(typeof e=="string"){const r=e.trim().toUpperCase();if(r==="BOTH"||r==="1&2"||r==="1,2"||r==="1/2"||r==="2/1"||r==="CO1&CO2"||r==="CO1,CO2"||r==="3&4"||r==="3,4"||r==="3/4"||r==="4/3"||r==="CO3&CO4"||r==="CO3,CO4")return"3&4";if(r==="4"||r==="CO4")return 4;if(r==="3"||r==="CO3")return 3;if(r==="2"||r==="CO2")return 4;if(r==="1"||r==="CO1")return 3}const t=Number(e);return t===4?4:t===34?"3&4":t===2?4:t===1?3:t===12?"3&4":3}function _j(e,t){const r=e[t];if(!r)return{co1:0,co2:0};if(r.co==="1&2")return{co1:.5,co2:.5};const n=e.some(o=>o.co==="1&2"),i=t===e.length-1,s=String(r.key||"").trim().toLowerCase()==="q9";return!n&&i&&s?{co1:.5,co2:.5}:COe(r.co)}function kj(e,t){const r=e[t];if(!r)return{co3:0,co4:0};if(r.co==="3&4")return{co3:.5,co4:.5};const n=e.some(o=>o.co==="3&4"),i=t===e.length-1,s=String(r.key||"").trim().toLowerCase()==="q9";return!n&&i&&s?{co3:.5,co4:.5}:EOe(r.co)}function XF(e,t,r,n){const i=Number(e),s=Number(t),o=Number(r),l=Number(n),c=(Number.isFinite(s)?s:0)+(Number.isFinite(o)?o:0)+(Number.isFinite(l)?l:0);if(!Number.isFinite(i)||i<=0||!c)return[0,0,0];const u=Uf(i*(s||0)/c),d=Uf(i*(o||0)/c),f=Uf(i*(l||0)/c);return[u,d,f]}function TOe(e,t){const r=ti(e),n=Ec.header,i=Ec.cycles,s=["CO1-SSA","CO1-CIA","CO1-FA","CO2-SSA","CO2-CIA","CO2-FA","CO3-SSA","CO3-CIA","CO3-FA","CO4-SSA","CO4-CIA","CO4-FA","ME-CO1","ME-CO2","ME-CO3","ME-CO4","ME-CO5"];let o=Array.from({length:17},(h,p)=>p),l=[...i],c=[...s];if(r==="TCPR"&&(l=l.map((h,p)=>p===2||p===5||p===8||p===11?"review":h),c=c.map((h,p)=>p===2||p===5||p===8||p===11?h.replace("-FA","-Review"):h)),r==="TCPL"&&(l=l.map((h,p)=>p===2||p===5||p===8||p===11?"lab":h),c=c.map((h,p)=>p===2||p===5?h.replace("-FA","-LAB1"):p===8||p===11?h.replace("-FA","-LAB2"):h)),r==="LAB"||r==="PRACTICAL")return o=[1,4,7,10,16],{visible:o,header:["CO1","CO2","CO3","CO4","ME"],cycles:["CIA 1","CIA 1","CIA 2","CIA 2","MODEL"],labels:["CO1-CIA1","CO2-CIA1","CO3-CIA2","CO4-CIA2","ME-CO5"]};if(r==="SPECIAL"&&t.size){const h=[],p=(m,g)=>{if(m)for(const y of g)h.push(y)};p(t.has("ssa1"),[0,3]),p(t.has("cia1"),[1,4]),p(t.has("formative1"),[2,5]),p(t.has("ssa2"),[6,9]),p(t.has("cia2"),[7,10]),p(t.has("formative2"),[8,11]),o=h}const u=o.map(h=>n[h]),d=o.map(h=>l[h]),f=o.map(h=>c[h]);return{visible:o,header:u,cycles:d,labels:f}}function POe({courseId:e,enabledAssessments:t}){const r=x.useMemo(()=>new Set((t||[]).map(O=>String(O||"").trim().toLowerCase()).filter(Boolean)),[t]),[n,i]=x.useState([]),[s,o]=x.useState(null),[l,c]=x.useState(null),[u,d]=x.useState(null),[f,h]=x.useState(null),[p,m]=x.useState([]),[g,y]=x.useState(null),[b,v]=x.useState(!1),[w,S]=x.useState({ssa1:1.5,cia1:3,formative1:2.5}),[k,j]=x.useState([...Ec.weights]),[A,L]=x.useState({ssa1:{},ssa2:{},f1:{},f2:{},cia1:null,cia2:null}),[P,F]=x.useState({r1:{},r2:{}}),[E,T]=x.useState({cia1:null,cia2:null,model:null}),[B,q]=x.useState({lab1:null,lab2:null}),[U,se]=x.useState(null),[de,z]=x.useState({cia1:null,cia2:null}),[G,ie]=x.useState(null),[Y,C]=x.useState(!1),[K,H]=x.useState(null);x.useEffect(()=>{let O=!0;return(async()=>{try{const W=await ku();if(!O)return;h(W||null)}catch{}})(),()=>{O=!1}},[e]),x.useEffect(()=>{let O=!0;return(async()=>{var W;try{const ae=await fc();if(!O)return;let I=(ae||[]).filter(Te=>String(Te.subject_code)===String(e));if(I.length===0)try{const Te=await xr(`/api/academics/teaching-assignments/?subject_code=${encodeURIComponent(String(e||""))}`);if(Te.ok){const Ae=await Te.json();I=(Array.isArray(Ae.results)?Ae.results:Array.isArray(Ae)?Ae:Ae.items||[])||[]}}catch(Te){console.warn("Server TA list fetch failed:",Te)}i(I);const Z=Jn(`internalMark_selectedTa_${e}`),me=(typeof Z=="number"&&I.some(Te=>Te.id===Z)?Z:(W=I[0])==null?void 0:W.id)??null;o(me),c(null)}catch(ae){if(!O)return;i([]),o(null),c((ae==null?void 0:ae.message)||"Failed to load teaching assignments")}})(),()=>{O=!1}},[e]),x.useEffect(()=>{!e||s==null||Kn(`internalMark_selectedTa_${e}`,s)},[e,s]),x.useEffect(()=>{let O=!0;return(async()=>{try{const W=(n||[]).find(Z=>Z.id===s)||null,ae=W==null?void 0:W.curriculum_row_id;if(!ae){const Z=String(e).trim().toUpperCase(),me=await Sl();if(!O)return;const Te=(me||[]).find(ze=>String(ze.course_code||"").trim().toUpperCase()===Z),Ae=(Te==null?void 0:Te.class_type)??null;if(Ae){d(Ae);return}const Be=await Kd();if(!O)return;const Ee=(Be||[]).find(ze=>String(ze.course_code||"").trim().toUpperCase()===Z);d((Ee==null?void 0:Ee.class_type)??null);return}const I=await j3(Number(ae));if(!O)return;d((I==null?void 0:I.class_type)??null)}catch{O&&d(null)}})(),()=>{O=!1}},[n,s,e]),x.useEffect(()=>{let O=!0;return(async()=>{try{const W=ti(u),ae=I=>{if(!I||typeof I!="object")return!1;const Z=Number.isFinite(Number(I.ssa1))?Number(I.ssa1):1.5,me=Number.isFinite(Number(I.cia1))?Number(I.cia1):3,Te=Number.isFinite(Number(I.formative1))?Number(I.formative1):2.5;S({ssa1:Z,cia1:me,formative1:Te});const Ae=I.internal_mark_weights;if(Array.isArray(Ae)&&Ae.length){let Be=Ae.map(Ee=>{const ze=Number(Ee);return Number.isFinite(ze)?ze:0});if(Be.length===13&&Ec.weights.length===17){const[Ee,ze,Xe]=XF(Be[0]||0,Z,me,Te),[Pt,ft,He]=XF(Be[1]||0,Z,me,Te);Be=[Ee,ze,Xe,Pt,ft,He,...Be.slice(2)]}for(;Be.length<Ec.weights.length;)Be.push(Ec.weights[Be.length]??0);j(Be.slice(0,Ec.weights.length))}else j([...Ec.weights]);return!0};try{const I=await wS();if(!O)return;const Z=I&&I[W]||null;if(ae(Z))return}catch{}try{const I=Jn("iqac_class_type_weights"),Z=I&&I[W]||null;if(ae(Z))return}catch{}}catch{}})(),()=>{O=!1}},[u]),x.useEffect(()=>{let O=!0;return(async()=>{if(s){v(!0),y(null);try{const ae=(n||[]).find(I=>I.id===s)||null;if(ae&&ae.elective_subject_id&&!ae.section_id){const I=ae.elective_subject_id,Z=await xr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(I))}`);if(!Z.ok)throw new Error(`Elective-choices fetch failed: ${Z.status}`);const me=await Z.json();if(!O)return;const Ae=((Array.isArray(me.results)?me.results:Array.isArray(me)?me:me.items||[])||[]).map(Be=>({id:Number(Be.student_id??Be.id),reg_no:String(Be.reg_no??Be.registration_no??Be.regno??""),name:String(Be.name??Be.full_name??Be.username??""),section:Be.section_name??Be.section??null}));if(!O)return;m(Ae.filter(Be=>Number.isFinite(Be.id)).sort(YF))}else{const I=await Vc(s);if(!O)return;const Z=(I.students||[]).map(me=>({id:Number(me.id),reg_no:String(me.reg_no??""),name:String(me.name??""),section:me.section??null})).filter(me=>Number.isFinite(me.id)).sort(YF);m(Z)}}catch(ae){if(!O)return;m([]),y((ae==null?void 0:ae.message)||"Failed to load roster")}finally{O&&v(!1)}}})(),()=>{O=!1}},[s]),x.useEffect(()=>{let O=!0;return(async()=>{C(!0),H(null);try{const ae=ti(u),I=s??void 0,Z=ae==="TCPL",me=ae==="TCPR",Te=ae==="LAB"||ae==="PRACTICAL",Ae=ae==="SPECIAL"&&r.size,Be=wt=>Ae?r.has(String(wt).toLowerCase()):!0;F({r1:{},r2:{}}),T({cia1:null,cia2:null,model:null}),q({lab1:null,lab2:null}),se(null),z({cia1:null,cia2:null}),ie(null);const Ee=async wt=>{if(!ae)return null;try{const yt=await ah({class_type:String(ae).toUpperCase(),question_paper_type:null,exam:wt}),Fr=yt&&yt.pattern;if(Fr&&Array.isArray(Fr.marks)&&Fr.marks.length)return Fr}catch{}try{const yt=await ah({class_type:String(ae).toUpperCase(),question_paper_type:null,exam:"CIA"}),Fr=yt&&yt.pattern;if(Fr&&Array.isArray(Fr.marks)&&Fr.marks.length)return Fr}catch{}return null};try{const[wt,yt]=await Promise.all([Ee("CIA1"),Ee("CIA2")]);O&&z({cia1:wt,cia2:yt})}catch{O&&z({cia1:null,cia2:null})}let ze=null,Xe=null,Pt=null,ft=null,He=null,tt=null,_e=null,Se=null,he=null,ye=null,ht=null,Ge=null,lt=null,jt=null;if(Te){try{const wt=await ei("cia1",e,I);wt!=null&&wt.draft&&(he={data:wt.draft.data??wt.draft})}catch{}try{const wt=await ei("cia2",e,I);wt!=null&&wt.draft&&(ye={data:wt.draft.data??wt.draft})}catch{}try{const wt=await ei("model",e,I);wt!=null&&wt.draft&&(ht={data:wt.draft.data??wt.draft})}catch{}if(!(he!=null&&he.data))try{he=await po("cia1",e,I)}catch{he=null}if(!(ye!=null&&ye.data))try{ye=await po("cia2",e,I)}catch{ye=null}if(!(ht!=null&&ht.data))try{ht=await Rm(e,I)}catch{ht=null}if(!O)return;T({cia1:(he==null?void 0:he.data)??null,cia2:(ye==null?void 0:ye.data)??null,model:(ht==null?void 0:ht.data)??null}),L({ssa1:{},ssa2:{},f1:{},f2:{},cia1:null,cia2:null});return}if(Be("ssa1"))try{const wt=await ei("ssa1",e,I);wt!=null&&wt.draft&&wt.draft.marks&&(ze={marks:wt.draft.marks})}catch{}if(Be("ssa2"))try{const wt=await ei("ssa2",e,I);wt!=null&&wt.draft&&wt.draft.marks&&(Xe={marks:wt.draft.marks})}catch{}if(Be("ssa1")&&!(ze!=null&&ze.marks))try{ze=await rg(e,I)}catch{ze=null}if(Be("ssa2")&&!(Xe!=null&&Xe.marks))try{Xe=await ey(e,I)}catch{Xe=null}if(me){try{const wt=await ei("review1",e,I);wt!=null&&wt.draft&&wt.draft.marks&&(_e={marks:wt.draft.marks})}catch{}try{const wt=await ei("review2",e,I);wt!=null&&wt.draft&&wt.draft.marks&&(Se={marks:wt.draft.marks})}catch{}if(!(_e!=null&&_e.marks))try{_e=await SS(e)}catch{_e=null}if(!(Se!=null&&Se.marks))try{Se=await _S(e)}catch{Se=null}if(!O)return;F({r1:(_e==null?void 0:_e.marks)||{},r2:(Se==null?void 0:Se.marks)||{}})}if(Z){try{const wt=await ei("formative1",e,I);wt!=null&&wt.draft&&(Ge={data:wt.draft.data??wt.draft})}catch{}try{const wt=await ei("formative2",e,I);wt!=null&&wt.draft&&(lt={data:wt.draft.data??wt.draft})}catch{}if(!(Ge!=null&&Ge.data))try{Ge=await po("formative1",e,I)}catch{Ge=null}if(!(lt!=null&&lt.data))try{lt=await po("formative2",e,I)}catch{lt=null}if(!O)return;q({lab1:(Ge==null?void 0:Ge.data)??null,lab2:(lt==null?void 0:lt.data)??null})}else{if(!me&&Be("formative1")){try{const wt=await ei("formative1",e,I);wt!=null&&wt.draft&&wt.draft.marks&&(Pt={marks:wt.draft.marks})}catch{}if(!(Pt!=null&&Pt.marks))try{Pt=await v0("formative1",e,I)}catch{Pt=null}}if(!me&&Be("formative2")){try{const wt=await ei("formative2",e,I);wt!=null&&wt.draft&&wt.draft.marks&&(ft={marks:wt.draft.marks})}catch{}if(!(ft!=null&&ft.marks))try{ft=await v0("formative2",e,I)}catch{ft=null}}}if(Be("cia1")){try{const wt=await ei("cia1",e,I);wt!=null&&wt.draft&&(He={data:wt.draft.data??wt.draft})}catch{}if(!(He!=null&&He.data))try{He=await w0("cia1",e,I)}catch{He=null}}if(Be("cia2")){try{const wt=await ei("cia2",e,I);wt!=null&&wt.draft&&(tt={data:wt.draft.data??wt.draft})}catch{}if(!(tt!=null&&tt.data))try{tt=await w0("cia2",e,I)}catch{tt=null}}try{const wt=await ei("model",e,I);wt!=null&&wt.draft&&(jt={data:wt.draft.data??wt.draft})}catch{}if(!(jt!=null&&jt.data))try{jt=await Rm(e,I)}catch{jt=null}try{const wt=jt==null?void 0:jt.data,yt=String((wt==null?void 0:wt.qpType)||"").trim().toUpperCase(),Fr=yt==="QP2"?"QP2":yt==="QP1"?"QP1":null,Tt=String(ae||"").toUpperCase(),hr=await ah({class_type:Tt,question_paper_type:Tt==="THEORY"?Fr:null,exam:"MODEL"}),rn=hr==null?void 0:hr.pattern;rn&&Array.isArray(rn.marks)&&rn.marks.length&&O&&ie(rn)}catch{}if(!O)return;L({ssa1:(ze==null?void 0:ze.marks)||{},ssa2:(Xe==null?void 0:Xe.marks)||{},f1:(Pt==null?void 0:Pt.marks)||{},f2:(ft==null?void 0:ft.marks)||{},cia1:(He==null?void 0:He.data)||null,cia2:(tt==null?void 0:tt.data)||null}),se((jt==null?void 0:jt.data)||null)}catch(ae){if(!O)return;H((ae==null?void 0:ae.message)||"Failed to load marks")}finally{O&&C(!1)}})(),()=>{O=!1}},[e,u,r,s]);const R=x.useMemo(()=>TOe(u,r),[u,r]),J=x.useMemo(()=>{const W=(Array.isArray(k)&&k.length?k:Ec.weights).slice(0,Ec.weights.length);for(;W.length<Ec.weights.length;)W.push(Ec.weights[W.length]??0);const ae=R.visible.map(I=>W[I]??0);return{header:R.header,weights:ae,cycles:R.cycles,visible:R.visible,labels:R.labels}},[k,R]),V=x.useMemo(()=>J.weights.map(W=>Number(W)||0).reduce((W,ae)=>W+ae,0),[J]),X=x.useMemo(()=>{var zr,bn,or,kr,Tr,Or,Gt,ur,Ve,Rt,_t,Xt,Ue,Ct,et,ut,Bt,Kt,Jt,ar,nt,Ht;const O=ti(u),W=new Array(17).fill(0);for(let Pe=0;Pe<J.visible.length;Pe++){const Ot=J.visible[Pe];W[Ot]=Number(J.weights[Pe])||0}const ae=W[0]||0,I=W[1]||0,Z=W[2]||0,me=W[3]||0,Te=W[4]||0,Ae=W[5]||0,Be=W[6]||0,Ee=W[7]||0,ze=W[8]||0,Xe=W[9]||0,Pt=W[10]||0,ft=W[11]||0,He=W[12]||0,tt=W[13]||0,_e=W[14]||0,Se=W[15]||0,he=W[16]||0,ye=A.cia1&&typeof A.cia1=="object"?A.cia1:null,ht=A.cia2&&typeof A.cia2=="object"?A.cia2:null,Ge=de==null?void 0:de.cia1,lt=de==null?void 0:de.cia2,jt=Array.isArray((bn=(zr=f==null?void 0:f.assessments)==null?void 0:zr.cia1)==null?void 0:bn.questions)?f.assessments.cia1.questions.map(Pe=>({key:String((Pe==null?void 0:Pe.key)||""),max:Number((Pe==null?void 0:Pe.max)??(Pe==null?void 0:Pe.maxMarks)??0),co:wj(Pe==null?void 0:Pe.co)})).filter(Pe=>Pe.key):[],wt=Array.isArray((kr=(or=f==null?void 0:f.assessments)==null?void 0:or.cia2)==null?void 0:kr.questions)?f.assessments.cia2.questions.map(Pe=>({key:String((Pe==null?void 0:Pe.key)||""),max:Number((Pe==null?void 0:Pe.max)??(Pe==null?void 0:Pe.maxMarks)??0),co:Sj(Pe==null?void 0:Pe.co)})).filter(Pe=>Pe.key):[],yt=Ge&&Array.isArray(Ge.marks)&&Ge.marks.length?Ge.marks.map((Pe,Ot)=>{const mt=jt[Ot],Nt=Array.isArray(Ge.cos)?Ge.cos[Ot]:void 0;return{key:`q${Ot+1}`,max:Number(Pe)||0,co:Nt!=null?wj(Nt):(mt==null?void 0:mt.co)??1}}).filter(Pe=>!!Pe.key):[],Fr=lt&&Array.isArray(lt.marks)&&lt.marks.length?lt.marks.map((Pe,Ot)=>{const mt=wt[Ot],Nt=Array.isArray(lt.cos)?lt.cos[Ot]:void 0;return{key:`q${Ot+1}`,max:Number(Pe)||0,co:Nt!=null?Sj(Nt):(mt==null?void 0:mt.co)??3}}).filter(Pe=>!!Pe.key):[],Tt=Array.isArray(ye==null?void 0:ye.questions)?ye.questions.map(Pe=>({key:String((Pe==null?void 0:Pe.key)||""),max:Number((Pe==null?void 0:Pe.max)??(Pe==null?void 0:Pe.maxMarks)??0),co:wj(Pe==null?void 0:Pe.co)})).filter(Pe=>Pe.key):yt.length?yt:jt.length?jt:jOe,hr=Array.isArray(ht==null?void 0:ht.questions)?ht.questions.map(Pe=>({key:String((Pe==null?void 0:Pe.key)||""),max:Number((Pe==null?void 0:Pe.max)??(Pe==null?void 0:Pe.maxMarks)??0),co:Sj(Pe==null?void 0:Pe.co)})).filter(Pe=>Pe.key):Fr.length?Fr:wt.length?wt:AOe,rn=ye!=null&&ye.rowsByStudentId&&typeof ye.rowsByStudentId=="object"?ye.rowsByStudentId:{},en=ht!=null&&ht.rowsByStudentId&&typeof ht.rowsByStudentId=="object"?ht.rowsByStudentId:{},$r=Tt.reduce((Pe,Ot,mt)=>{const Nt=_j(Tt,mt);return Pe+Ot.max*Nt.co1},0),Kr=Tt.reduce((Pe,Ot,mt)=>{const Nt=_j(Tt,mt);return Pe+Ot.max*Nt.co2},0),Rn=hr.reduce((Pe,Ot,mt)=>{const Nt=kj(hr,mt);return Pe+Ot.max*Nt.co3},0),Pr=hr.reduce((Pe,Ot,mt)=>{const Nt=kj(hr,mt);return Pe+Ot.max*Nt.co4},0),Sn=((Tr=f==null?void 0:f.assessments)==null?void 0:Tr.ssa1)||{},Me=((Or=f==null?void 0:f.assessments)==null?void 0:Or.ssa2)||{},je=((Gt=f==null?void 0:f.assessments)==null?void 0:Gt.formative1)||{},Mt=((ur=f==null?void 0:f.assessments)==null?void 0:ur.formative2)||{},pt=((Ve=f==null?void 0:f.assessments)==null?void 0:Ve.cia1)||{},Ut=((Rt=f==null?void 0:f.assessments)==null?void 0:Rt.cia2)||{},ir=Number((_t=Sn==null?void 0:Sn.coMax)==null?void 0:_t.co1),fr=Number((Xt=Sn==null?void 0:Sn.coMax)==null?void 0:Xt.co2),vr=Number(((Ue=Me==null?void 0:Me.coMax)==null?void 0:Ue.co3)??((Ct=Me==null?void 0:Me.coMax)==null?void 0:Ct.co1)),re=Number(((et=Me==null?void 0:Me.coMax)==null?void 0:et.co4)??((ut=Me==null?void 0:Me.coMax)==null?void 0:ut.co2)),le=Number((Bt=pt==null?void 0:pt.coMax)==null?void 0:Bt.co1),te=Number((Kt=pt==null?void 0:pt.coMax)==null?void 0:Kt.co2),ue=Number(((Jt=Ut==null?void 0:Ut.coMax)==null?void 0:Jt.co3)??((ar=Ut==null?void 0:Ut.coMax)==null?void 0:ar.co1)),Ne=Number(((nt=Ut==null?void 0:Ut.coMax)==null?void 0:nt.co4)??((Ht=Ut==null?void 0:Ut.coMax)==null?void 0:Ht.co2)),ke=Number(je==null?void 0:je.maxCo),vt=Number(Mt==null?void 0:Mt.maxCo),rt=O==="TCPL",De={ssa1:{co1:Number.isFinite(ir)?Math.max(0,ir):10,co2:Number.isFinite(fr)?Math.max(0,fr):10},ssa2:{co3:Number.isFinite(vr)?Math.max(0,vr):10,co4:Number.isFinite(re)?Math.max(0,re):10},cia1:{co1:rt?$r>0?$r:Number.isFinite(le)?Math.max(0,le):30:Number.isFinite(le)?Math.max(0,le):$r,co2:rt?Kr>0?Kr:Number.isFinite(te)?Math.max(0,te):30:Number.isFinite(te)?Math.max(0,te):Kr},cia2:{co3:rt?Rn>0?Rn:Number.isFinite(ue)?Math.max(0,ue):30:Number.isFinite(ue)?Math.max(0,ue):Rn,co4:rt?Pr>0?Pr:Number.isFinite(Ne)?Math.max(0,Ne):30:Number.isFinite(Ne)?Math.max(0,Ne):Pr},f1:{co1:Number.isFinite(ke)?Math.max(0,ke):10,co2:Number.isFinite(ke)?Math.max(0,ke):10},f2:{co3:Number.isFinite(vt)?Math.max(0,vt):10,co4:Number.isFinite(vt)?Math.max(0,vt):10},review1:{co1:15,co2:15},review2:{co3:15,co4:15}},We=O==="TCPL",st=O==="TCPR",zt=We||st,Wt=Array.isArray(G==null?void 0:G.marks)?G.marks:null,xt=(()=>{if(Array.isArray(Wt)&&Wt.length)return Wt.map((Pe,Ot)=>({key:`q${Ot+1}`,max:Number(Pe)||0}));if(zt){const Pe=st?12:15,Ot=st?8:10;return Array.from({length:Pe},(mt,Nt)=>{const er=Nt+1;return{key:`q${er}`,max:er<=Ot?2:16}})}return NOe})(),Dt=(()=>{const Pe=Array.isArray(G==null?void 0:G.cos)?G.cos:null;if(Array.isArray(Pe)&&Pe.length===xt.length)return Pe.map(Ot=>{const mt=Number(Ot);if(Number.isFinite(mt))return fi(Math.round(mt),1,5);const er=String(Ot??"").toUpperCase().match(/\d+/);return er?fi(Number(er[0]),1,5):1});if(st){const Ot=[1,1,2,2,3,3,4,4,1,2,3,4];return xt.length===Ot.length?Ot:Array.from({length:xt.length},(mt,Nt)=>Ot[Nt%Ot.length])}if(We){const Ot=[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5];return xt.length===Ot.length?Ot:Array.from({length:xt.length},(mt,Nt)=>Ot[Nt%Ot.length])}return xt.length===Sv.length?[...Sv]:Array.from({length:xt.length},(Ot,mt)=>Sv[mt%Sv.length])})(),Vt=(()=>{const Pe={co1:0,co2:0,co3:0,co4:0,co5:0};for(let Ot=0;Ot<xt.length;Ot++){const mt=xt[Ot],Nt=Dt[Ot]??1;Nt===1?Pe.co1+=mt.max:Nt===2?Pe.co2+=mt.max:Nt===3?Pe.co3+=mt.max:Nt===4?Pe.co4+=mt.max:Nt===5&&(Pe.co5+=mt.max)}return Pe})(),gr=(()=>{const Pe={...Vt};return st?{...Pe,co5:Pe.co5+30}:We?{co1:Pe.co1+6,co2:Pe.co2+6,co3:Pe.co3+6,co4:Pe.co4+6,co5:Pe.co5+6}:Pe})(),sr=String(s??"none"),Lr=U&&typeof U=="object"?U:null,Zr=(()=>{if(Lr){const $t=ti(Lr==null?void 0:Lr.classType),Ye=$t==="TCPL"||$t==="TCPR"?Lr==null?void 0:Lr.tcplSheet:Lr==null?void 0:Lr.theorySheet;if(Ye&&typeof Ye=="object")return Ye}const Pe=`model_theory_sheet_${e}_${sr}`,Ot=`model_theory_sheet_${e}_none`,mt=`model_tcpl_sheet_${e}_${sr}`,Nt=`model_tcpl_sheet_${e}_none`,er=`model_tcpr_sheet_${e}_${sr}`,pr=`model_tcpr_sheet_${e}_none`,we=`model_sheet_${e}`,Ie=Jn(Pe);if(Ie&&typeof Ie=="object")return Ie;const Ze=Jn(Ot);if(Ze&&typeof Ze=="object")return Ze;const bt=Jn(mt);if(bt&&typeof bt=="object")return bt;const St=Jn(Nt);if(St&&typeof St=="object")return St;const Sr=Jn(er);if(Sr&&typeof Sr=="object")return Sr;const Yr=Jn(pr);if(Yr&&typeof Yr=="object")return Yr;const ct=Jn(we);return ct&&typeof ct=="object"?ct:null})(),Er=Pe=>{const Ot=gr;if(!Zr)return{co1:null,co2:null,co3:null,co4:null,co5:null,max:Ot};const mt=`id:${String(Pe.id)}`,Nt=Pe.reg_no?`reg:${String(Pe.reg_no).trim()}`:"",er=Zr[mt]||(Nt?Zr[Nt]:null)||null;if(!er||typeof er!="object")return{co1:null,co2:null,co3:null,co4:null,co5:null,max:Ot};const pr=!!er.absent,we=String(er.absentKind||"AL").toUpperCase(),Ie=er.q&&typeof er.q=="object"?er.q:{},Ze=To(er.lab);let bt=!1;const St={co1:0,co2:0,co3:0,co4:0,co5:0};for(let Sr=0;Sr<xt.length;Sr++){const Yr=xt[Sr],ct=Ie[Yr.key],$t=To(ct);if($t==null)continue;bt=!0;const qe=fi($t,0,Yr.max),Ye=Dt[Sr]??1;Ye===1?St.co1+=qe:Ye===2?St.co2+=qe:Ye===3?St.co3+=qe:Ye===4?St.co4+=qe:Ye===5&&(St.co5+=qe)}if(zt&&Ze!=null){bt=!0;const Sr=fi(Ze,0,30);if(st)St.co5+=Sr;else{const Yr=Sr/5;St.co1+=Yr,St.co2+=Yr,St.co3+=Yr,St.co4+=Yr,St.co5+=Yr}}return bt?pr&&we==="AL"?{co1:0,co2:0,co3:0,co4:0,co5:0,max:Ot}:{co1:fi(St.co1,0,Ot.co1),co2:fi(St.co2,0,Ot.co2),co3:fi(St.co3,0,Ot.co3),co4:fi(St.co4,0,Ot.co4),co5:fi(St.co5,0,Ot.co5),max:Ot}:pr&&we==="AL"?{co1:0,co2:0,co3:0,co4:0,co5:0,max:Ot}:{co1:null,co2:null,co3:null,co4:null,co5:null,max:Ot}},qt=(Pe,Ot,mt)=>Pe==null||!Ot||!Number.isFinite(Ot)?null:fi(Pe/Ot*mt,0,mt);if(O==="LAB"||O==="PRACTICAL"){const Ot=(we,Ie,Ze)=>{const bt=we!=null&&we.sheet&&typeof we.sheet=="object"?we.sheet:{},St=bt!=null&&bt.rowsByStudentId&&typeof bt.rowsByStudentId=="object"?bt.rowsByStudentId:{},Sr=fi(Number((bt==null?void 0:bt.expCountA)??0),0,12),Yr=fi(Number((bt==null?void 0:bt.expCountB)??0),0,12),ct=!!(bt!=null&&bt.coAEnabled),$t=!!(bt!=null&&bt.coBEnabled),qe=!!(bt!=null&&bt.ciaExamEnabled),Ye=bt!=null&&bt.coConfigs&&typeof bt.coConfigs=="object"?bt.coConfigs:null,ot=Ye?Ye[String(Ie)]:null,$e=Ze!=null&&Ye?Ye[String(Ze)]:null,kt=ot?!!ot.enabled:ct,It=Ze!=null?$e?!!$e.enabled:$t:!1,Zt=ot?fi(Number(ot.expCount??0),0,12):Sr,sn=Ze!=null?$e?fi(Number($e.expCount??0),0,12):Yr:0,mn=ot&&Number.isFinite(Number(ot.expMax))?Number(ot.expMax):Number.isFinite(Number(bt==null?void 0:bt.expMaxA))?Number(bt.expMaxA):25,hn=Ze!=null?$e&&Number.isFinite(Number($e.expMax))?Number($e.expMax):Number.isFinite(Number(bt==null?void 0:bt.expMaxB))?Number(bt.expMaxB):25:0,Tn=mn+(qe?15:0),Ir=Ze!=null?hn+(qe?15:0):0,gn=(at,Re)=>Array.isArray(at)?at.map(dt=>typeof dt=="number"&&Number.isFinite(dt)?dt:null):at==null?[]:[],fn=at=>{const Re=(at||[]).filter(dt=>typeof dt=="number"&&Number.isFinite(dt));return Re.length?Re.reduce((dt,Rr)=>dt+Rr,0)/Re.length:null};return{get:at=>{const Re=St[String(at)]||{},dt=Re!=null&&Re.marksByCo&&typeof Re.marksByCo=="object"?Re.marksByCo:{},Rr=(dt==null?void 0:dt[String(Ie)])??Re.marksA,nn=Ze!=null?(dt==null?void 0:dt[String(Ze)])??Re.marksB:[],tn=gn(Rr).slice(0,kt?Zt:0),_n=gn(nn).slice(0,It?sn:0),zn=fn(tn),Hn=fn(_n),ri=Re==null?void 0:Re.ciaExam,M=typeof ri=="number"&&Number.isFinite(ri)?ri:null,ce=zn!=null||Hn!=null||M!=null,Le=ce?(zn??0)+(qe?(M??0)/2:0):null,it=ce?(Hn??0)+(qe?(M??0)/2:0):null;return{a:Le==null?null:fi(Le,0,Tn),b:it==null?null:fi(it,0,Ir)}},CO_MAX_A:Tn,CO_MAX_B:Ir}},mt=Ot(E.cia1,1,2),Nt=Ot(E.cia2,3,4),er=Ot(E.model,5,null),pr=(we,Ie,Ze)=>we==null||!Ie||!Number.isFinite(Ie)?null:fi(we/Ie*Ze,0,Ze);return p.map((we,Ie)=>{const Ze=mt.get(we.id),bt=Nt.get(we.id),St=er.get(we.id),Sr=null,Yr=pr(Ze.a,mt.CO_MAX_A,I),ct=null,$t=null,qe=pr(Ze.b,mt.CO_MAX_B,Te),Ye=null,ot=null,$e=pr(bt.a,Nt.CO_MAX_A,Ee),kt=null,It=null,Zt=pr(bt.b,Nt.CO_MAX_B,Pt),sn=null,mn=null,hn=null,Tn=null,Ir=null,gn=pr(St.a,er.CO_MAX_A,he),fn=[Sr,Yr,ct,$t,qe,Ye,ot,$e,kt,It,Zt,sn,mn,hn,Tn,Ir,gn],ve=J.visible.map(Rr=>fn[Rr]),Re=ve.some(Rr=>typeof Rr=="number"&&Number.isFinite(Rr))?Uf(ve.reduce((Rr,nn)=>Rr+(typeof nn=="number"&&Number.isFinite(nn)?nn:0),0)):null,dt=Re==null||!V?null:Uf(Re/V*100);return{sno:Ie+1,...we,cells:ve,total:Re,pct:dt}})}return p.map((Pe,Ot)=>{const mt=To(A.ssa1[String(Pe.id)]),Nt=To(A.ssa2[String(Pe.id)]),er=mt==null?null:Number(mt)/2,pr=Nt==null?null:Number(Nt)/2,we=er==null?null:fi(er,0,De.ssa1.co1),Ie=er==null?null:fi(er,0,De.ssa1.co2),Ze=pr==null?null:fi(pr,0,De.ssa2.co3),bt=pr==null?null:fi(pr,0,De.ssa2.co4),St=(A.f1||{})[String(Pe.id)]||{},Sr=(A.f2||{})[String(Pe.id)]||{},Yr=To(St==null?void 0:St.skill1)!=null&&To(St==null?void 0:St.att1)!=null?fi(Number(St.skill1)+Number(St.att1),0,De.f1.co1):null,ct=To(St==null?void 0:St.skill2)!=null&&To(St==null?void 0:St.att2)!=null?fi(Number(St.skill2)+Number(St.att2),0,De.f1.co2):null,$t=To(Sr==null?void 0:Sr.skill1)!=null&&To(Sr==null?void 0:Sr.att1)!=null?fi(Number(Sr.skill1)+Number(Sr.att1),0,De.f2.co3):null,qe=To(Sr==null?void 0:Sr.skill2)!=null&&To(Sr==null?void 0:Sr.att2)!=null?fi(Number(Sr.skill2)+Number(Sr.att2),0,De.f2.co4):null,Ye=To(P.r1[String(Pe.id)]),ot=To(P.r2[String(Pe.id)]),$e=Ye==null?null:Number(Ye)/2,kt=ot==null?null:Number(ot)/2,It=$e==null?null:fi($e,0,De.review1.co1),Zt=$e==null?null:fi($e,0,De.review1.co2),sn=kt==null?null:fi(kt,0,De.review2.co3),mn=kt==null?null:fi(kt,0,De.review2.co4),hn=(Ur,Xr,br)=>{const Mr=Ur!=null&&Ur.sheet&&typeof Ur.sheet=="object"?Ur.sheet:{},un=Mr!=null&&Mr.rowsByStudentId&&typeof Mr.rowsByStudentId=="object"?Mr.rowsByStudentId:{},kn=30/2,vn=Mr!=null&&Mr.coConfigs&&typeof Mr.coConfigs=="object"?Mr.coConfigs:null,Cn=vn?vn[String(Xr)]:null,In=br!=null&&vn?vn[String(br)]:null,Fn=fi(Number((Mr==null?void 0:Mr.expCountA)??0),0,12),ci=fi(Number((Mr==null?void 0:Mr.expCountB)??0),0,12),xi=(Mr==null?void 0:Mr.coAEnabled)!==!1,Fi=br!=null?(Mr==null?void 0:Mr.coBEnabled)!==!1:!1,Ho=Cn?!!Cn.enabled:xi,Vo=br!=null?In?!!In.enabled:Fi:!1,Rl=Cn?fi(Number(Cn.expCount??0),0,12):Fn,Zs=br!=null?In?fi(Number(In.expCount??0),0,12):ci:0,Fl=Cn&&Number.isFinite(Number(Cn.expMax))?Number(Cn.expMax):Number.isFinite(Number(Mr==null?void 0:Mr.expMaxA))?Number(Mr.expMaxA):25,Ya=br!=null?In&&Number.isFinite(Number(In.expMax))?Number(In.expMax):Number.isFinite(Number(Mr==null?void 0:Mr.expMaxB))?Number(Mr.expMaxB):25:0,Zi=(Mr==null?void 0:Mr.ciaExamEnabled)!==!1,Di=Fl+(Zi?kn:0),ba=br!=null?Ya+(Zi?kn:0):0,cs=qn=>Array.isArray(qn)?qn.map(_i=>typeof _i=="number"&&Number.isFinite(_i)?_i:null):[],Yc=qn=>{const _i=(qn||[]).filter(ea=>typeof ea=="number"&&Number.isFinite(ea));return _i.length?_i.reduce((ea,bo)=>ea+bo,0)/_i.length:null};return{get:qn=>{const _i=un[String(qn)]||{},ea=_i!=null&&_i.marksByCo&&typeof _i.marksByCo=="object"?_i.marksByCo:{},bo=(ea==null?void 0:ea[String(Xr)])??(_i==null?void 0:_i.marksA),Qc=br!=null?(ea==null?void 0:ea[String(br)])??(_i==null?void 0:_i.marksB):[],pc=cs(bo).slice(0,Ho?Rl:0),Jc=cs(Qc).slice(0,Vo?Zs:0),mc=Yc(pc),vo=Yc(Jc),fl=_i==null?void 0:_i.ciaExam,hl=typeof fl=="number"&&Number.isFinite(fl)?fl:null,gc=mc!=null||vo!=null||hl!=null,pl=gc?(mc??0)+(Zi?(hl??0)/2:0):null,Cu=gc?(vo??0)+(Zi?(hl??0)/2:0):null;return{a:pl==null?null:fi(pl,0,Di),b:Cu==null?null:fi(Cu,0,ba)}},CO_MAX_A:Di,CO_MAX_B:ba}},Tn=O==="TCPL"?hn(B.lab1,1,2):null,Ir=O==="TCPL"?hn(B.lab2,3,4):null,gn=Tn?Tn.get(Pe.id):null,fn=Ir?Ir.get(Pe.id):null,ve=(gn==null?void 0:gn.a)??null,at=(gn==null?void 0:gn.b)??null,Re=(fn==null?void 0:fn.a)??null,dt=(fn==null?void 0:fn.b)??null,Rr=rn[String(Pe.id)]||{},nn=en[String(Pe.id)]||{},tn=!!(Rr!=null&&Rr.absent),_n=!!(nn!=null&&nn.absent);let zn=null,Hn=null;if(!tn){const Ur=Rr!=null&&Rr.q&&typeof Rr.q=="object"?Rr.q:{};let Xr=!1,br=0,Mr=0;for(let un=0;un<Tt.length;un++){const kn=Tt[un],vn=To(Ur==null?void 0:Ur[kn.key]);if(vn==null)continue;Xr=!0;const Cn=fi(vn,0,kn.max||vn),In=_j(Tt,un);br+=Cn*In.co1,Mr+=Cn*In.co2}Xr&&(zn=fi(br,0,De.cia1.co1),Hn=fi(Mr,0,De.cia1.co2))}let ri=null,M=null;if(!_n){const Ur=nn!=null&&nn.q&&typeof nn.q=="object"?nn.q:{};let Xr=!1,br=0,Mr=0;for(let un=0;un<hr.length;un++){const kn=hr[un],vn=To(Ur==null?void 0:Ur[kn.key]);if(vn==null)continue;Xr=!0;const Cn=fi(vn,0,kn.max||vn),In=kj(hr,un);br+=Cn*In.co3,Mr+=Cn*In.co4}Xr&&(ri=fi(br,0,De.cia2.co3),M=fi(Mr,0,De.cia2.co4))}const ce=qt(we,De.ssa1.co1,ae),Le=qt(zn,De.cia1.co1,I),it=O==="TCPR"?qt(It,De.review1.co1,Z):O==="TCPL"?qt(ve,(Tn==null?void 0:Tn.CO_MAX_A)??De.f1.co1,Z):qt(Yr,De.f1.co1,Z),At=qt(Ie,De.ssa1.co2,me),lr=qt(Hn,De.cia1.co2,Te),nr=O==="TCPR"?qt(Zt,De.review1.co2,Ae):O==="TCPL"?qt(at,(Tn==null?void 0:Tn.CO_MAX_B)??De.f1.co2,Ae):qt(ct,De.f1.co2,Ae),yr=qt(Ze,De.ssa2.co3,Be),Wr=qt(ri,De.cia2.co3,Ee),Vr=O==="TCPR"?qt(sn,De.review2.co3,ze):O==="TCPL"?qt(Re,(Ir==null?void 0:Ir.CO_MAX_A)??De.f2.co3,ze):qt($t,De.f2.co3,ze),dn=qt(bt,De.ssa2.co4,Xe),Pn=qt(M,De.cia2.co4,Pt),li=O==="TCPR"?qt(mn,De.review2.co4,ft):O==="TCPL"?qt(dt,(Ir==null?void 0:Ir.CO_MAX_B)??De.f2.co4,ft):qt(qe,De.f2.co4,ft),fe=Er(Pe),xe=qt(fe.co1,fe.max.co1,He),Ke=qt(fe.co2,fe.max.co2,tt),Fe=qt(fe.co3,fe.max.co3,_e),gt=qt(fe.co4,fe.max.co4,Se),dr=qt(fe.co5,fe.max.co5,he),Ft=[ce,Le,it,At,lr,nr,yr,Wr,Vr,dn,Pn,li,xe,Ke,Fe,gt,dr],jr=J.visible.map(Ur=>Ft[Ur]),qr=jr.some(Ur=>typeof Ur=="number"&&Number.isFinite(Ur))?Uf(jr.reduce((Ur,Xr)=>Ur+(typeof Xr=="number"&&Number.isFinite(Xr)?Xr:0),0)):null,Qr=qr==null||!V?null:Uf(qr/V*100);return{sno:Ot+1,...Pe,cells:jr,total:qr,pct:Qr}})},[J,A,P,E,B,U,p,w,V,e,s,f,u,de,G]),Q=J.header,ne=J.cycles,oe=J.weights;return a.jsxs("div",{style:{padding:12},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",gap:12,flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{children:[a.jsx("h3",{style:{margin:0},children:"INTERNAL MARK"}),a.jsx("div",{style:{color:"#6b7280",marginTop:4},children:"Summative + Formative (based on IQAC mapping)"})]}),a.jsx("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center"},children:a.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[a.jsx("span",{style:{color:"#374151",fontWeight:700},children:"Section"}),a.jsxs("select",{value:s??"",onChange:O=>o(O.target.value?Number(O.target.value):null),style:{padding:8,borderRadius:8,border:"1px solid #d1d5db"},children:[a.jsx("option",{value:"",disabled:!0,children:""}),n.map(O=>{const W=O.department,ae=(W==null?void 0:W.short_name)||(W==null?void 0:W.code)||(W==null?void 0:W.name)||O.department_name||"",I=O.semester,Z=`${O.section_name||`TA ${O.id}`} ${I?` Sem ${I}`:""} ${ae?` ${ae}`:""}`;return a.jsx("option",{value:O.id,children:Z},O.id)})]})]})})]}),l?a.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:l}):null,g?a.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:g}):null,K?a.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:K}):null,b||Y?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading"}):null,a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:10},children:a.jsxs("table",{style:{borderCollapse:"collapse",width:"100%",fontSize:12},children:[a.jsxs("thead",{children:[a.jsxs("tr",{children:[a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb"},children:"S.No"}),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb"},children:"Register No."}),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb"},children:"Name"}),Q.map((O,W)=>a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f3f4f6"},children:String(O)},W)),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb"},children:Uf(V)}),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb"},children:"100"})]}),a.jsxs("tr",{children:[a.jsx("th",{colSpan:3,style:{border:"1px solid #e5e7eb",padding:8,background:"#fff",textAlign:"left",fontWeight:800},children:"internal weightage"}),oe.map((O,W)=>a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f3f4f6"},children:Number(O).toFixed(1)},`w-${W}`)),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#fff"}}),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#fff"}})]}),a.jsxs("tr",{children:[a.jsx("th",{colSpan:3,style:{border:"1px solid #e5e7eb",padding:8,background:"#fff",textAlign:"left",fontWeight:800},children:"cycle"}),ne.map((O,W)=>a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#fff"},children:String(O)},`c-${W}`)),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#fff"}}),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#fff"}})]})]}),a.jsx("tbody",{children:X.map(O=>a.jsxs("tr",{children:[a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6},children:O.sno}),a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6},children:O.reg_no}),a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6},children:O.name}),(Array.isArray(O.cells)?O.cells:[]).map((W,ae)=>a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6,textAlign:"center"},children:W==null?"":Number(W).toFixed(2)},ae)),a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6,textAlign:"center",fontWeight:800},children:O.total==null?"":Number(O.total).toFixed(2)}),a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6,textAlign:"center"},children:O.pct==null?"":Number(O.pct).toFixed(2)})]},O.id))})]})})]})}function OOe(){const{code:e}=z0(),t=xo(),r=dl(),n=e?decodeURIComponent(e):"",[i,s]=on.useState(()=>"marks"),[o,l]=on.useState(null),[c,u]=on.useState(null),[d,f]=on.useState(!1),[h,p]=on.useState(()=>{if(!n)return"QP1";try{const b=localStorage.getItem(`obe_course_qp_${n}`);return String(b||"").trim().toUpperCase()==="QP2"?"QP2":"QP1"}catch{return"QP1"}}),[m,g]=on.useState(null);on.useEffect(()=>{if(!r||!r.pathname)return;const b=r.pathname.toLowerCase();b.includes("/lca/instructions")||b.includes("/lca_instructions")||b.includes("/lca")||b.includes("/cdap")||b.includes("/articulation")?s("lca_instructions"):b.includes("/marks")?s("marks"):b.includes("/co_attainment")?s("co_attainment"):b.includes("/internal_mark")||b.includes("/internal-mark")?s("internal_mark"):b.includes("/cqi")?s("cqi"):s("marks")},[r]);const y=on.useMemo(()=>{const b=String((r==null?void 0:r.pathname)||"").toLowerCase();return b.includes("/cdap")?"cdap":b.includes("/articulation")?"articulation":b.includes("/lca")&&!(b.includes("/lca/instructions")||b.includes("/lca_instructions"))?"lca":"instructions"},[r==null?void 0:r.pathname]);return on.useEffect(()=>{if(!n)return;let b=!0;return(async()=>{try{b&&f(!1);const v=await fc();if(!b)return;const w=(v||[]).filter(L=>String(L.subject_code)===String(n)),S=w[0]||null;S&&l(S.subject_name||null);let k=null;try{const L=localStorage.getItem(`markEntry_selectedTa_${n}`),P=L==null?NaN:Number(L);k=Number.isFinite(P)?P:null}catch{k=null}const j=k!=null&&w.find(L=>Number(L.id)===Number(k))||w.find(L=>String((L==null?void 0:L.class_type)||"").trim())||S,A=String((j==null?void 0:j.class_type)||"").trim();A&&(u(A),f(!0))}catch{}})(),()=>{b=!1}},[n]),on.useEffect(()=>{if(!n)return;let b=!0;return(async()=>{try{const v=await Sl();if(!b)return;const w=String(n),S=w.toUpperCase(),k=(v||[]).filter(F=>String((F==null?void 0:F.course_code)||"").trim()===w||String((F==null?void 0:F.course_code)||"").trim().toUpperCase()===S),j=F=>String(F||"").trim().toUpperCase(),A=k.find(F=>{const E=j(F==null?void 0:F.question_paper_type);return E&&E!=="QP1"})||k.find(F=>j(F==null?void 0:F.question_paper_type))||k.find(F=>String((F==null?void 0:F.class_type)||"").trim())||k[0];if(!d&&A&&A.class_type){const F=String(A.class_type||"").trim();u(F||null)}else if(!d)try{const F=await hm();if(!b)return;const E=(Array.isArray(F)?F:F.results||[]).find(T=>String(T.course_code||"").trim().toUpperCase()===S);E&&E.class_type&&(u(String(E.class_type||"").trim()||null),Array.isArray(E.enabled_assessments)&&E.enabled_assessments.length&&g(E.enabled_assessments.map(T=>String(T).trim().toLowerCase()).filter(Boolean)))}catch{}let L=null;try{L=localStorage.getItem(`obe_course_qp_${n}`)}catch{L=null}const P=String(L||"").trim().toUpperCase();if(P==="QP1"||P==="QP2")p(P);else{const F=String((A==null?void 0:A.question_paper_type)||"").trim().toUpperCase();p(F==="QP2"?"QP2":"QP1")}if(ti(A==null?void 0:A.class_type)==="SPECIAL"){g([]);try{const F=await bS(w);g(Array.isArray(F)?F:[])}catch{const F=A==null?void 0:A.enabled_assessments;g(Array.isArray(F)?F.map(E=>String(E).trim().toLowerCase()).filter(Boolean):[])}}else g(null)}catch{}})(),()=>{b=!1}},[n]),e?a.jsx("main",{className:"obe-course-page",style:{padding:"32px 48px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',minHeight:"100vh",background:"linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)"},children:a.jsxs("div",{style:{width:"100%",minWidth:0,boxSizing:"border-box"},children:[a.jsx("div",{style:{marginBottom:24,background:"#fff",padding:"28px 32px",borderRadius:16,boxShadow:"0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04)"},children:a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:24,flexWrap:"wrap"},children:[a.jsxs("div",{style:{flex:1},children:[a.jsxs("h2",{style:{margin:0,fontSize:32,fontWeight:700,color:"#0f172a",letterSpacing:"-0.02em"},children:["OBE - ",n]}),a.jsx("div",{style:{color:"#64748b",marginTop:8,fontSize:16},children:"Course OBE workspace"}),o&&a.jsx("div",{style:{color:"#1e293b",marginTop:12,fontWeight:700,fontSize:20},children:o}),a.jsxs("div",{style:{marginTop:16,display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[c&&a.jsxs("div",{style:{background:"#eff6ff",color:"#3b82f6",padding:"6px 14px",borderRadius:8,fontWeight:600,fontSize:14,border:"1px solid #bfdbfe"},children:[" Class type: ",a.jsx("strong",{children:String(c).toLowerCase()[0].toUpperCase()+String(c).toLowerCase().slice(1)})]}),a.jsxs("div",{style:{background:"#f8fafc",color:"#475569",padding:"6px 14px",borderRadius:8,fontWeight:600,fontSize:14,border:"1px solid #e2e8f0",display:"flex",alignItems:"center",gap:8},children:[a.jsx("span",{children:" QP Type:"}),a.jsxs("select",{value:String(h||"QP1").trim().toUpperCase()==="QP2"?"QP2":"QP1",onChange:b=>{const w=String(b.target.value||"").trim().toUpperCase()==="QP2"?"QP2":"QP1";p(w);try{localStorage.setItem(`obe_course_qp_${n}`,w)}catch{}},style:{padding:"4px 10px",borderRadius:6,border:"1px solid #cbd5e1",fontSize:14,fontWeight:600,color:"#0f172a",background:"#fff",cursor:"pointer"},children:[a.jsx("option",{value:"QP1",children:"QP1"}),a.jsx("option",{value:"QP2",children:"QP2"})]})]})]})]}),a.jsx("div",{children:a.jsx("button",{onClick:()=>t("/obe"),onMouseEnter:b=>{b.currentTarget.style.background="#f8fafc",b.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:b=>{b.currentTarget.style.background="#fff",b.currentTarget.style.borderColor="#e2e8f0"},style:{padding:"10px 20px",borderRadius:10,border:"1px solid #e2e8f0",background:"#fff",color:"#475569",cursor:"pointer",fontWeight:600,fontSize:15,transition:"all 0.2s ease",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:" Back to courses"})})]})}),a.jsx("div",{style:{display:"flex",gap:6,marginBottom:24,background:"#fff",padding:"8px",borderRadius:12,boxShadow:"0 1px 3px rgba(0,0,0,0.06)",flexWrap:"wrap"},"aria-label":"OBE Tabs",children:[{key:"lca_instructions",label:" Learner Centric Approach",icon:""},{key:"marks",label:" Mark Entry",icon:""},{key:"co_attainment",label:" CO Attainment",icon:""},{key:"cqi",label:" CQI",icon:""},{key:"internal_mark",label:" Internal Mark",icon:""}].map(b=>{const v=i===b.key;return a.jsx("button",{onClick:()=>{if(s(b.key),e){const w=encodeURIComponent(e),S=b.key==="lca_instructions"?"lca/instructions":String(b.key);t(`/obe/course/${w}/${S}`)}},onMouseEnter:w=>{v||(w.currentTarget.style.background="rgba(59,130,246,0.08)",w.currentTarget.style.color="#3b82f6")},onMouseLeave:w=>{v||(w.currentTarget.style.background="transparent",w.currentTarget.style.color="#64748b")},style:{padding:"10px 24px",borderRadius:8,border:"none",background:v?"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)":"transparent",color:v?"#fff":"#64748b",cursor:"pointer",fontWeight:v?600:500,fontSize:15,transition:"all 0.2s ease",boxShadow:v?"0 2px 8px rgba(37,99,235,0.2)":"none"},children:b.label},b.key)})}),a.jsxs("div",{children:[i==="marks"&&a.jsx(kOe,{courseId:n,classType:c,questionPaperType:h,enabledAssessments:m}),i==="lca_instructions"&&a.jsx(jK,{courseCode:n,courseName:o,initialTab:y}),i==="co_attainment"&&a.jsx(NK,{courseId:n,enabledAssessments:m,classType:c}),i==="internal_mark"&&a.jsx(POe,{courseId:n,enabledAssessments:m}),i==="cqi"&&a.jsx(CK,{courseId:n})]})]})}):a.jsxs("div",{style:{padding:24},children:[a.jsx("p",{style:{color:"#666"},children:"No course selected."}),a.jsx("button",{onClick:()=>t("/obe"),className:"obe-btn obe-btn-primary",children:"Back"})]})}function MOe(){const e=xo(),[t]=WJ(),r=x.useMemo(()=>{const y=String(t.get("subject_code")||"").trim(),b=String(t.get("assessment")||"").trim().toLowerCase(),v=String(t.get("reason")||"Edit Marks").trim(),w=t.get("teaching_assignment_id"),S=w?Number(w):void 0;return{subject_code:y,assessment:b,reason:v,teaching_assignment_id:Number.isFinite(S)?S:void 0}},[t]),[n,i]=x.useState(r.subject_code),[s,o]=x.useState(r.assessment),[l,c]=x.useState(r.reason),[u,d]=x.useState(String(r.teaching_assignment_id??"")),[f,h]=x.useState(!1),[p,m]=x.useState(null);async function g(){h(!0),m(null);try{const y=(u||"").trim(),b=y?Number(y):void 0;await _h({assessment:s,subject_code:n,reason:l,teaching_assignment_id:Number.isFinite(b)?b:void 0,force:!0}),alert("Edit request sent to IQAC."),e(-1)}catch(y){m((y==null?void 0:y.message)||"Request failed")}finally{h(!1)}}return a.jsxs("div",{style:{maxWidth:720},children:[a.jsx("div",{style:{fontWeight:900,fontSize:16,marginBottom:12},children:"OBE Request"}),a.jsx("div",{className:"obe-card",children:a.jsxs("div",{style:{display:"grid",gap:10},children:[a.jsxs("label",{style:{display:"grid",gap:6},children:[a.jsx("div",{className:"obe-small-muted",style:{fontWeight:800},children:"Subject Code"}),a.jsx("input",{className:"obe-input",value:n,onChange:y=>i(y.target.value),placeholder:"e.g., GEA1268"})]}),a.jsxs("label",{style:{display:"grid",gap:6},children:[a.jsx("div",{className:"obe-small-muted",style:{fontWeight:800},children:"Assessment"}),a.jsx("input",{className:"obe-input",value:s,onChange:y=>o(y.target.value),placeholder:"cia1 | cia2 | model | formative1 | formative2"})]}),a.jsxs("label",{style:{display:"grid",gap:6},children:[a.jsx("div",{className:"obe-small-muted",style:{fontWeight:800},children:"Teaching Assignment ID (optional)"}),a.jsx("input",{className:"obe-input",value:u,onChange:y=>d(y.target.value),placeholder:"e.g., 123"})]}),a.jsxs("label",{style:{display:"grid",gap:6},children:[a.jsx("div",{className:"obe-small-muted",style:{fontWeight:800},children:"Reason"}),a.jsx("textarea",{className:"obe-input",value:l,onChange:y=>c(y.target.value),rows:3,placeholder:"Edit Marks",style:{resize:"vertical"}})]}),p?a.jsx("div",{className:"obe-danger-pill",children:p}):null,a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[a.jsx("button",{className:"obe-btn",type:"button",onClick:()=>e(-1),disabled:f,children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-primary",type:"button",onClick:g,disabled:f||!n||!s,children:f?"Requesting":"Request Edit"})]})]})})]})}function LOe(){const[e,t]=x.useState([]),[r,n]=x.useState([]),[i,s]=x.useState([]),[o,l]=x.useState(!1),[c,u]=x.useState(!1),[d,f]=x.useState(null),[h,p]=x.useState(new Set);x.useEffect(()=>{m()},[]);async function m(){l(!0);try{const v=await xr("/api/academics/section-advisors/?page_size=0"),w=await xr("/api/academics/sections/?page_size=0"),S=await xr("/api/academics/hod-staff/?page_size=0"),k=await xr("/api/accounts/me/");async function j(A){if(!(A.headers.get("content-type")||"").includes("application/json")){const P=await A.text();throw console.error("Expected JSON but got:",P),new Error("Server returned non-JSON response (see console)")}return A.json()}if(v.ok){const A=await j(v);s(A.results||A)}if(w.ok){const A=await j(w);t(A.results||A)}if(S.ok){const A=await j(S);n(A.results||A)}if(k.ok){const A=await j(k);u(!!(A.permissions&&(A.permissions.includes("academics.assign_advisor")||A.permissions.includes("academics.add_sectionadvisor"))))}}catch(v){console.error(v),alert("Failed to load HOD assignments. Check console for server response.")}finally{l(!1)}}async function g(v,w){l(!0);try{if(!c)return alert("You do not have permission to assign advisors");const k=await xr("/api/academics/section-advisors/",{method:"POST",body:JSON.stringify({section_id:v,advisor_id:w,is_active:!0})});if(k.ok)p(j=>{const A=new Set(j);return A.delete(v),A}),await m();else{const j=await k.text();alert("Error: "+j)}}finally{l(!1)}}function y(v){p(w=>{const S=new Set(w);return S.has(v)?S.delete(v):S.add(v),S})}function b(v){return i.find(w=>w.section_id===v&&w.is_active)}return a.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:a.jsx(W0,{className:"h-6 w-6 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Advisor Assign"}),a.jsx("p",{className:"text-gray-600",children:"Assign advisors to sections and edit existing assignments"})]})]})}),o&&a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-12",children:a.jsxs("div",{className:"flex items-center justify-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),a.jsx("span",{className:"ml-3 text-gray-600",children:"Loading assignments..."})]})}),!o&&e.length>0&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Filter by Department"}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx("button",{onClick:()=>f(null),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${d===null?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All Departments"}),Array.from(new Set(e.map(v=>v.department_id||0))).filter(v=>v>0).map(v=>{var j,A;const w=e.filter(L=>(L.department_id||0)===v);if(w.length===0)return null;const S=((j=w[0])==null?void 0:j.department_short_name)||((A=w[0])==null?void 0:A.department_code)||`Dept ${v}`,k=d===v;return a.jsx("button",{onClick:()=>f(k?null:v),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${k?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:S},v)})]})]}),a.jsx("div",{className:"space-y-6",children:Array.from(new Set(e.map(v=>v.department_id||0))).filter(v=>d===null||d===v).map(v=>{var j,A;const w=e.filter(L=>(L.department_id||0)===v);if(w.length===0)return null;const S=((j=w[0])==null?void 0:j.department_short_name)||((A=w[0])==null?void 0:A.department_code)||`Department ${v}`,k=r.filter(L=>(L.department||0)===v);return a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:[S," Department"]}),a.jsx("div",{className:"overflow-x-auto mb-6",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-blue-50 border-b-2 border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-700",children:"Section"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-700",children:"Select Advisor"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-700",children:"Action"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:w.map(L=>{const P=b(L.id),F=h.has(L.id),E=!P||F;return a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-4 py-3 text-gray-700",children:L.name}),a.jsx("td",{className:"px-4 py-3",children:E?a.jsxs("select",{id:`advisor-${L.id}`,className:"w-full p-2 border border-gray-300 rounded-lg bg-white text-gray-700 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",defaultValue:(P==null?void 0:P.advisor_id)||"",children:[a.jsx("option",{value:"",children:"-- Select Advisor --"}),k.map(T=>a.jsxs("option",{value:T.id,children:[T.staff_id," - ",T.user]},T.id))]}):a.jsx("div",{className:"text-gray-900 font-medium",children:(P==null?void 0:P.advisor)||"No advisor assigned"})}),a.jsx("td",{className:"px-4 py-3",children:P&&!F?a.jsx("button",{disabled:!c,className:`p-2 text-sm font-medium rounded-lg transition-colors ${c?"text-blue-600 hover:bg-blue-50 border border-blue-300":"text-gray-400 bg-gray-100 cursor-not-allowed"}`,onClick:()=>c&&y(L.id),title:"Edit Assignment",children:a.jsx(uh,{className:"h-4 w-4"})}):a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{disabled:!c,className:`p-2 text-sm font-medium rounded-lg transition-colors ${c?"text-blue-600 hover:bg-blue-50 border border-blue-300":"text-gray-400 bg-gray-100 cursor-not-allowed"}`,onClick:()=>{if(!c)return;const B=document.getElementById(`advisor-${L.id}`).value;if(!B)return alert("Select an advisor first");g(L.id,Number(B))},title:"Save Assignment",children:a.jsx(id,{className:"h-4 w-4"})}),F&&a.jsx("button",{className:"p-2 text-sm font-medium rounded-lg transition-colors text-red-600 hover:bg-red-50 border border-red-300",onClick:()=>y(L.id),title:"Cancel",children:a.jsx(vu,{className:"h-4 w-4"})}),P&&a.jsx("button",{disabled:!c,className:`p-2 text-sm font-medium rounded-lg transition-colors flex items-center justify-center ${c?"bg-red-50 text-red-700 border border-red-300 hover:bg-red-100":"text-gray-400 bg-gray-100 cursor-not-allowed"}`,onClick:async()=>{if(c&&confirm("Delete advisor assignment for this section?"))try{const T=await xr(`/api/academics/section-advisors/${P.id}/`,{method:"DELETE"});if(!T.ok){const B=await T.text();return alert("Delete failed: "+B)}await m()}catch(T){console.error(T),alert("Delete failed")}},title:"Delete Assignment",children:a.jsx(s1,{className:"h-4 w-4"})})]})})]},L.id)})})]})})]},v)})})]}),!o&&e.length===0&&a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-12",children:a.jsxs("div",{className:"text-center",children:[a.jsx(gs,{className:"mx-auto h-12 w-12 text-gray-300 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No sections available"}),a.jsx("p",{className:"text-gray-600",children:"There are no sections available for advisor assignment at this time."})]})})]})})}const QF=e=>{if(typeof e.user=="string")return e.user;if(e.user&&typeof e.user=="object"){const t=e.user.first_name||"",r=e.user.last_name||"";return`${t} ${r}`.trim()||e.user.username||e.staff_id}return e.staff_id},JF=e=>{if(!e)return"";if(typeof e.user=="string")return e.user;if(e.user&&typeof e.user=="object"){const t=e.user.first_name||"",r=e.user.last_name||"";return`${t} ${r}`.trim()||e.user.username||e.staff_id}return e.staff_id||""};function ROe(){const[e,t]=x.useState([]),[r,n]=x.useState([]),[i,s]=x.useState([]),[o,l]=x.useState([]),[c,u]=x.useState(null),[d,f]=x.useState(null),[h,p]=x.useState([]),[m,g]=x.useState([]),[y,b]=x.useState([]),[v,w]=x.useState([]),[S,k]=x.useState(!0),[j,A]=x.useState(new Set),[L,P]=x.useState(new Set),F=(()=>{try{return JSON.parse(localStorage.getItem("permissions")||"[]")}catch{return[]}})(),E=F.includes("academics.view_elective_teaching"),T=F.includes("academics.assign_elective_teaching");x.useEffect(()=>{B()},[]);async function B(){try{k(!0);const R=await xr("/api/academics/my-students/?page_size=0"),J=E||T?"/api/academics/hod-staff/?page_size=0":"/api/academics/advisor-staff/?page_size=0";let V=await xr(c&&J.includes("hod-staff")?`${J}&department=${c}`:J);if(V.status===403&&J.includes("hod-staff")){console.warn("hod-staff returned 403  falling back to advisor-staff endpoint");const O=c?`/api/academics/advisor-staff/?page_size=0&department=${c}`:"/api/academics/advisor-staff/?page_size=0";try{const W=await xr(O);W.ok&&(V=W)}catch(W){console.error("fallback to advisor-staff failed",W)}}const X=await xr("/api/curriculum/department/?page_size=0"),Q=await xr("/api/curriculum/elective/?page_size=0"),ne=await xr("/api/academics/teaching-assignments/?page_size=0"),oe=async O=>{if(!(O.headers.get("content-type")||"").includes("application/json"))throw new Error("non-json");return O.json()};if(R.ok){const O=await oe(R),W=(O.results||O).map(ae=>({id:ae.section_id,name:ae.section_name,batch:ae.batch,batch_regulation:ae.batch_regulation,department_id:ae.department_id,semester:ae.semester,department:ae.department}));t(W)}if(V.ok){const O=await oe(V);let W=O.results||O;c&&(W=W.filter(ae=>ae.department&&ae.department.id===c||ae.department===c)),n(W)}if(X.ok){const O=await oe(X),W=O.results||O;p(W),w(W.filter(I=>I.is_elective));const ae=new Map;W.forEach(I=>{I.department&&I.department.id&&ae.set(I.department.id,I.department)}),ae.size>0&&l(Array.from(ae.values()));try{const I=await xr("/api/academics/departments/?page_size=0");if(I.ok){const Z=await oe(I),me=Z.results||Z;Array.isArray(me)&&me.length>0&&s(me)}else ae.size>0&&s(Array.from(ae.values()))}catch{ae.size>0&&s(Array.from(ae.values()))}}if(Q.ok){const O=await oe(Q);b(O.results||O)}if(ne.ok){const O=await oe(ne);g(O.results||O)}}catch(R){console.error(R),alert("Failed to load teaching assignment data")}finally{k(!1)}}x.useEffect(()=>{async function R(){try{const J=E||T?"/api/academics/hod-staff/?page_size=0":"/api/academics/advisor-staff/?page_size=0",V=c&&J.includes("hod-staff")?`${J}&department=${c}`:J,X=await xr(V);let Q=X;if(X.status===403&&J.includes("hod-staff")){console.warn("hod-staff returned 403 in loadStaff  trying advisor-staff");const O=c?`/api/academics/advisor-staff/?page_size=0&department=${c}`:"/api/academics/advisor-staff/?page_size=0";try{const W=await xr(O);if(W.ok)Q=W;else if(W.status!==200)return}catch(W){console.error("fallback failed",W);return}}if(!Q.ok)return;const ne=await Q.json();let oe=ne.results||ne;!J.includes("hod-staff")&&c&&(oe=oe.filter(O=>O.department&&O.department.id===c||O.department===c)),n(oe)}catch(J){console.error("loadStaff failed",J)}}R()},[c]);const q=(R,J)=>m.find(V=>{const X=V.section_details&&V.section_details.id===R||V.section_details&&V.section_details.id===R||V.section===R||V.section_id===R,Q=V.curriculum_row_details&&V.curriculum_row_details.id===J||V.curriculum_row_details&&V.curriculum_row_details.id===J||V.curriculum_row&&V.curriculum_row.id===J||V.curriculum_row_id===J;return X&&Q}),U=(R,J)=>`${R}-${J}`,se=(R,J)=>{const V=U(R,J);A(X=>new Set(X).add(V))},de=(R,J)=>{const V=U(R,J);A(X=>{const Q=new Set(X);return Q.delete(V),Q})},z=(R,J)=>{const V=U(R,J);return j.has(V)},G=R=>m.find(J=>{const V=J.elective_subject_id||J.elective_subject&&J.elective_subject.id||J.elective_subject_details&&J.elective_subject_details.id||J.elective_subject;return Number(V)===Number(R)}),ie=R=>`elective-${R}`,Y=R=>{const J=ie(R);P(V=>new Set(V).add(J))},C=R=>{const J=ie(R);P(V=>{const X=new Set(V);return X.delete(J),X})},K=R=>{const J=ie(R);return L.has(J)};async function H(R,J,V){if(!J)return alert("Select staff"),Promise.reject("No staff selected");try{if(V){const X={staff_id:Number(J),is_active:!0},Q=await xr(`/api/academics/teaching-assignments/${V}/`,{method:"PATCH",body:JSON.stringify(X)});if(Q.ok)return alert("Updated successfully"),B(),Promise.resolve();{const ne=await Q.text();return alert("Error: "+ne),Promise.reject(ne)}}else{const X={elective_subject_id:R,staff_id:Number(J),is_active:!0},Q=await xr("/api/academics/teaching-assignments/",{method:"POST",body:JSON.stringify(X)});if(Q.ok)return alert("Assigned successfully"),B(),Promise.resolve();{const ne=await Q.text();return alert("Error: "+ne),Promise.reject(ne)}}}catch(X){return alert("Error: "+X),Promise.reject(X)}}return S?a.jsx("div",{style:{padding:"28px",minHeight:"100vh",background:"linear-gradient(180deg, #f7fbff 0%, #ffffff 60%)"},children:a.jsx("div",{style:{padding:"16px",borderRadius:"8px",background:"#fff",border:"1px solid rgba(15,23,42,0.04)",color:"#6b7280"},children:"Loading teaching assignments"})}):a.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:a.jsx(W0,{className:"h-6 w-6 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Teaching Assign"}),a.jsx("p",{className:"text-gray-600",children:"Assign faculty to courses and sections"})]})]})}),i.length>0&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Filters"}),a.jsx("div",{className:"flex flex-wrap gap-4",children:i.length>0&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Department:"}),a.jsxs("select",{value:c??"",onChange:R=>u(R.target.value?Number(R.target.value):null),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-700 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"All Departments"}),i.map(R=>a.jsx("option",{value:R.id,children:R.short_name||R.code||R.name||`Dept ${R.id}`},R.id))]})]})})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(gs,{className:"h-5 w-5 text-blue-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Course Assignments"})]}),e.length===0?a.jsx("div",{className:"text-center py-8",children:a.jsx("div",{className:"text-gray-500 text-sm",children:"No sections available for the selected filters."})}):a.jsx("div",{className:"space-y-6",children:e.map(R=>{const J=h.filter(V=>(R.semester?V.semester===R.semester:!0)&&(R.batch_regulation?V.regulation===R.batch_regulation.code:!0)&&!V.is_elective);return a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsx("div",{className:"bg-blue-50 rounded-lg p-4 mb-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h4",{className:"text-lg font-semibold text-blue-900",children:[R.batch," / ",R.name]}),a.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[a.jsxs("p",{className:"text-blue-700 text-sm",children:["Semester: ",R.semester||"Not specified"]}),R.batch_regulation&&a.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800 border border-indigo-200",children:["Regulation: ",R.batch_regulation.code]})]})]}),a.jsxs("div",{className:"text-blue-600 text-sm font-medium",children:["Section ID: ",R.id]})]})}),J.length===0?a.jsx("div",{className:"text-gray-500 text-sm py-4",children:"No subjects available for this section."}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-50 border-b border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Subject Code"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Subject Name"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Assigned Staff"}),a.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Action"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:J.map(V=>{var ne,oe;const X=q(R.id,V.id),Q=z(R.id,V.id);return a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-4 py-3 font-medium text-gray-900",children:V.course_code||"-"}),a.jsx("td",{className:"px-4 py-3 text-gray-700",children:V.course_name||"Unnamed"}),a.jsx("td",{className:"px-4 py-3",children:Q?a.jsxs("select",{id:`staff-${R.id}-${V.id}`,defaultValue:((ne=X==null?void 0:X.staff_details)==null?void 0:ne.id)||(X==null?void 0:X.staff)||"",className:"w-full p-2 border border-gray-300 rounded-lg bg-white text-gray-700 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"-- select staff --"}),r.map(O=>a.jsxs("option",{value:O.id,children:[O.staff_id," - ",QF(O)]},O.id))]}):X?a.jsxs("div",{className:"text-sm text-gray-900 font-medium",children:[(oe=X.staff_details)==null?void 0:oe.staff_id," - ",JF(X.staff_details)]}):a.jsx("div",{className:"text-sm text-gray-500 italic",children:"Not assigned"})}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsx("div",{className:"flex items-center justify-center gap-2",children:Q?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>{const O=document.getElementById(`staff-${R.id}-${V.id}`);if(!(O!=null&&O.value))return alert("Select staff member");if(X){const W={staff_id:Number(O.value),is_active:!0};xr(`/api/academics/teaching-assignments/${X.id}/`,{method:"PATCH",body:JSON.stringify(W)}).then(ae=>{ae.ok?(alert("Updated successfully"),de(R.id,V.id),B()):ae.text().then(I=>alert("Error: "+I))})}else{const W={section_id:R.id,staff_id:Number(O.value),curriculum_row_id:V.id,is_active:!0};xr("/api/academics/teaching-assignments/",{method:"POST",body:JSON.stringify(W)}).then(ae=>{ae.ok?(alert("Assigned successfully"),de(R.id,V.id),B()):ae.text().then(I=>alert("Error: "+I))})}},className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors border border-green-300",title:"Save Assignment",children:a.jsx(id,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>de(R.id,V.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border border-red-300",title:"Cancel",children:a.jsx(vu,{className:"h-4 w-4"})}),X&&a.jsx("button",{onClick:async()=>{if(confirm("Delete teaching assignment for this subject/section?"))try{const O=await xr(`/api/academics/teaching-assignments/${X.id}/`,{method:"DELETE"});if(O.ok)alert("Deleted"),de(R.id,V.id),B();else{const W=await O.text().catch(()=>null);alert("Failed: "+(W||O.status))}}catch(O){console.error(O),alert("Failed to delete")}},className:"p-2 text-red-700 hover:bg-red-50 rounded-lg transition-colors border border-red-300",title:"Delete Assignment",children:a.jsx(s1,{className:"h-4 w-4"})})]}):a.jsx(a.Fragment,{children:a.jsx("button",{onClick:()=>se(R.id,V.id),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors border border-blue-300",title:"Edit Assignment",children:a.jsx(uh,{className:"h-4 w-4"})})})})})]},`${R.id}-${V.id}`)})})]})})]},R.id)})})]}),E&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Elective Subject Assignments"}),o.length>1&&a.jsxs("div",{className:"mb-6",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Filter by Department"}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx("button",{onClick:()=>f(null),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${d===null?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All Departments"}),o.map(R=>a.jsx("button",{onClick:()=>f(R.id),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${d===R.id?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:R.short_name||R.code||R.name||`Dept ${R.id}`},R.id))]})]}),a.jsx("div",{className:"space-y-4",children:v.filter(R=>!d||R.department&&R.department.id===d).length===0?a.jsx("div",{className:"text-gray-500 text-sm",children:"No elective parents found for the selected department."}):v.filter(R=>!d||R.department&&R.department.id===d).map(R=>a.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[a.jsx("div",{className:"flex justify-between items-center mb-4",children:a.jsx("div",{className:"font-semibold text-gray-900",children:R.course_name||R.course_code||"Elective"})}),a.jsx("div",{className:"space-y-3",children:(y&&y.filter(J=>J.parent===R.id)).map(J=>{var Q,ne;const V=G(J.id),X=K(J.id);return console.log(`Elective ${J.course_code} (ID: ${J.id}):`,{opt:J,existingElectiveAssignment:V,allAssignments:m.filter(oe=>oe.subject&&(oe.subject.includes(J.course_code)||oe.subject.includes(J.course_name)))}),a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white rounded-lg border border-gray-200",children:[a.jsxs("div",{className:"flex-1 text-sm font-medium text-gray-900",children:[J.course_code||"-","  ",J.course_name||"-"]}),a.jsx("div",{className:"min-w-[200px]",children:X?a.jsxs("select",{id:`elective-staff-${J.id}`,defaultValue:((Q=V==null?void 0:V.staff_details)==null?void 0:Q.id)||(V==null?void 0:V.staff)||"",className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-700 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"-- select staff --"}),r.map(oe=>a.jsxs("option",{value:oe.id,children:[oe.staff_id," - ",QF(oe)]},oe.id))]}):V?a.jsxs("div",{className:"text-sm text-gray-900 font-medium",children:[(ne=V.staff_details)==null?void 0:ne.staff_id," - ",JF(V.staff_details)]}):a.jsx("div",{className:"text-sm text-gray-500 italic",children:"Not assigned"})}),a.jsx("div",{className:"flex items-center gap-2",children:X?a.jsxs(a.Fragment,{children:[a.jsx("button",{disabled:!T,onClick:()=>{if(!T)return alert("No permission to assign electives");const oe=document.getElementById(`elective-staff-${J.id}`);if(!(oe!=null&&oe.value))return alert("Select staff member");H(J.id,Number(oe.value),V==null?void 0:V.id).then(()=>{C(J.id)}).catch(()=>{})},className:`p-2 rounded-lg transition-colors ${T?"text-green-600 hover:bg-green-50 border border-green-300":"text-gray-400 bg-gray-100 cursor-not-allowed border border-gray-300"}`,title:T?"Save Assignment":"No permission",children:a.jsx(id,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>C(J.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border border-red-300",title:"Cancel",children:a.jsx(vu,{className:"h-4 w-4"})}),V&&a.jsx("button",{onClick:async()=>{if(confirm("Delete elective teaching assignment for this option?"))try{const oe=await xr(`/api/academics/teaching-assignments/${V.id}/`,{method:"DELETE"});if(oe.ok)alert("Deleted"),C(J.id),B();else{const O=await oe.text().catch(()=>null);alert("Failed: "+(O||oe.status))}}catch(oe){console.error(oe),alert("Failed to delete")}},className:"p-2 text-red-700 hover:bg-red-50 rounded-lg transition-colors border border-red-300",title:"Delete Assignment",children:a.jsx(s1,{className:"h-4 w-4"})})]}):a.jsx(a.Fragment,{children:a.jsx("button",{onClick:()=>Y(J.id),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors border border-blue-300",title:"Edit Assignment",children:a.jsx(uh,{className:"h-4 w-4"})})})})]},J.id)})})]},R.id))})]})]})})}function FOe(){const[e,t]=x.useState(!1),[r,n]=x.useState(null),[i,s]=x.useState([]),[o,l]=x.useState({});async function c(){t(!0),n(null);try{const m=await b9(),g=Array.isArray(m==null?void 0:m.results)?m.results:[];s(g)}catch(m){n((m==null?void 0:m.message)||"Failed to load requests")}finally{t(!1)}}x.useEffect(()=>{c()},[]);const u=x.useMemo(()=>[...i].sort((m,g)=>String(g.requested_at||"").localeCompare(String(m.requested_at||""))),[i]);function d(m){const g=String(m||"").trim();if(!g)return"?";const y=g.split(/\s+/g).filter(Boolean);return y.length===1?y[0].slice(0,2).toUpperCase():(y[0][0]+y[y.length-1][0]).toUpperCase()}function f(m){if(!m)return"";const g=new Date(m);return Number.isNaN(g.getTime())?String(m):g.toLocaleString()}async function h(m){l(g=>({...g,[m]:!0})),n(null);try{await j9(m),await c()}catch(g){n((g==null?void 0:g.message)||"Forward failed")}finally{l(g=>({...g,[m]:!1}))}}async function p(m){l(g=>({...g,[m]:!0})),n(null);try{await A9(m),await c()}catch(g){n((g==null?void 0:g.message)||"Reject failed")}finally{l(g=>({...g,[m]:!1}))}}return a.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",padding:20},children:[a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center",marginBottom:20},children:[a.jsx(sc,{size:24,color:"#9a3412"}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:24,fontWeight:950,color:"#111827"},children:"HOD: OBE Edit Requests"}),a.jsx("div",{style:{color:"#6b7280",fontSize:14},children:"Approve requests from your department before they go to IQAC"})]}),a.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:a.jsxs("button",{className:"obe-btn obe-btn-secondary",onClick:c,disabled:e,children:[a.jsx(T2,{size:16,style:{marginRight:6}}),e?"Refreshing":"Refresh"]})})]}),r?a.jsxs("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:12,borderRadius:12,marginBottom:20},children:[a.jsx(y3,{size:16,style:{marginRight:8,verticalAlign:"middle"}}),r]}):null,a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontSize:16,fontWeight:950,color:"#111827"},children:"Pending with HOD"}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["(",u.length,")"]})]}),u.length===0?a.jsxs("div",{style:{textAlign:"center",padding:22,color:"#6b7280",border:"1px dashed #e5e7eb",borderRadius:14,background:"#fff"},children:[a.jsx(x3,{size:34,color:"#10b981",style:{marginBottom:8}}),a.jsx("div",{children:"No pending requests"})]}):a.jsx("div",{style:{display:"grid",gap:10},children:u.map(m=>{var v,w;const g=!!o[m.id],y=String(((v=m.staff)==null?void 0:v.name)||((w=m.staff)==null?void 0:w.username)||"Unknown"),b=m.scope==="MARK_MANAGER"?"Mark Manager":"Mark Entry";return a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:14,background:"#fff",padding:12,display:"flex",gap:12,alignItems:"center"},children:[a.jsx("div",{style:{width:44,height:44,borderRadius:999,background:"#fff7ed",border:"1px solid #fed7aa",display:"grid",placeItems:"center",fontWeight:950,color:"#9a3412",flex:"0 0 auto"},children:d(y)}),a.jsxs("div",{style:{flex:1,minWidth:240},children:[a.jsx("div",{style:{fontWeight:900,color:"#111827"},children:y}),a.jsxs("div",{style:{fontSize:13,color:"#374151",fontWeight:700},children:[m.subject_code,"  ",a.jsx("span",{style:{color:"#2563eb",fontWeight:800},children:m.subject_name||m.subject_code})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[b,"  ",String(m.assessment||"").toUpperCase(),"  ",f(m.requested_at)]}),m.reason?a.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#374151"},children:[a.jsx("span",{style:{fontWeight:800},children:"Reason:"})," ",String(m.reason)]}):null]}),a.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center",flex:"0 0 auto"},children:[a.jsxs("div",{style:{background:"#fef3c7",color:"#92400e",padding:"4px 8px",borderRadius:999,fontSize:12,fontWeight:800,whiteSpace:"nowrap"},children:[a.jsx(sc,{size:12,style:{marginRight:4,verticalAlign:"middle"}}),"Pending"]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[a.jsxs("button",{className:"obe-btn obe-btn-success",onClick:()=>h(m.id),disabled:g,children:[a.jsx(Ete,{size:16,style:{marginRight:6}}),g?"Forwarding":"Forward to IQAC"]}),a.jsx("button",{className:"obe-btn obe-btn-danger",onClick:()=>p(m.id),disabled:g,children:g?"Rejecting":"Reject"})]})]})]},m.id)})})]})]})}function BOe(){const[e,t]=x.useState([]),[r,n]=x.useState(!1),[i,s]=x.useState(null);x.useEffect(()=>{o()},[]),x.useEffect(()=>{e.length>0&&i===null&&s(e[0].section_id)},[e]);async function o(){n(!0);try{const u=await xr("/api/academics/my-students/");if(!u.ok)throw new Error(await u.text());const d=await u.json();t(d.results||[])}catch(u){console.error(u),alert("Failed to load your students. See console for details.")}finally{n(!1)}}const l=e.find(u=>u.section_id===i),c=[...(l==null?void 0:l.students)||[]].sort((u,d)=>u.reg_no.localeCompare(d.reg_no));return r?a.jsx("div",{className:"min-h-screen p-4 md:p-6 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Yu,{className:"w-8 h-8 text-indigo-600 animate-spin"}),a.jsx("span",{className:"text-slate-600 text-lg",children:"Loading student information..."})]})}):a.jsxs("div",{className:"min-h-screen p-4 md:p-6 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-6 border border-slate-200",children:a.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 p-3 rounded-xl shadow-lg",children:a.jsx(Z1,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"My Students"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"View and manage your assigned student profiles"})]})]}),a.jsx("div",{className:"px-4 py-2 bg-gradient-to-r from-slate-100 to-indigo-100 rounded-lg",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(bs,{className:"w-5 h-5 text-indigo-700"}),a.jsxs("span",{className:"text-sm font-semibold text-indigo-900",children:["Total: ",e.reduce((u,d)=>u+d.students.length,0)]})]})})]})}),e.length===0&&!r&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-12",children:a.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[a.jsx("div",{className:"bg-slate-100 p-4 rounded-full mb-4",children:a.jsx(bs,{className:"w-16 h-16 text-slate-400"})}),a.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"No Students Assigned"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"You don't have any students assigned to your sections yet."})]})}),e.length>0&&a.jsx("div",{className:"mb-6 flex flex-wrap gap-3",children:e.map(u=>{const d=i===u.section_id;return a.jsxs("button",{onClick:()=>s(u.section_id),className:`px-5 py-2 rounded-full font-medium text-sm transition-all duration-200 flex items-center gap-2 ${d?"bg-gradient-to-r from-indigo-600 to-cyan-500 text-white shadow-lg shadow-indigo-200":"bg-white text-slate-700 border border-slate-200 hover:border-indigo-300 hover:bg-slate-50"}`,children:[u.section_name,a.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-bold ${d?"bg-white/25 text-white":"bg-slate-100 text-slate-700"}`,children:u.students.length})]},u.section_id)})}),c.length>0&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-slate-50 to-indigo-50 border-b-2 border-slate-200",children:[a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-indigo-900",children:"S.No"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-indigo-900",children:"Registration No"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-indigo-900",children:"Student Name"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-indigo-900",children:"Email"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-200",children:c.map((u,d)=>a.jsxs("tr",{className:"hover:bg-blue-50 transition-colors",children:[a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"text-sm font-medium text-slate-600",children:d+1})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:u.reg_no})}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Vee,{className:"w-5 h-5 text-slate-400"}),a.jsx("span",{className:"text-sm font-medium text-slate-900",children:u.first_name&&u.last_name?`${u.first_name} ${u.last_name}`.trim():u.username})]})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("div",{className:"flex items-center gap-2 text-slate-600",children:u.email?a.jsxs(a.Fragment,{children:[a.jsx(b3,{className:"w-4 h-4 text-slate-400"}),a.jsx("span",{className:"text-sm",children:u.email})]}):a.jsx("span",{className:"text-sm text-slate-400",children:"-"})})})]},u.id))})]})})})]})}const IOe=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];function ZF(e){if(!e)return"";if(typeof e=="string"){const i=e.trim();return i.split(/[\s\-\_]+/)[0]||i.slice(0,15)+(i.length>15?"":"")}if(e.course_code)return e.course_code;const t=e.course_name||e.course||e.subject_text||"",r=String(t).trim();if(!r)return"";const n=r.split(/[\s\-\_]+/).filter(i=>i.length>0);return n.length>0?n[0]:r.slice(0,15)+(r.length>15?"":"")}function DOe(){const[e,t]=x.useState(null),[r,n]=x.useState([]),[i,s]=x.useState([]),[o,l]=x.useState(!1),[c,u]=x.useState(null);x.useEffect(()=>{d()},[]);async function d(){try{const f=await xr("/api/accounts/me/");if(!f.ok)throw new Error(await f.text());const h=await f.json(),p=h.profile||{};u(h.id),p.section_id&&t(p.section_id)}catch(f){console.error(f)}}return x.useEffect(()=>{e&&(l(!0),(async()=>{try{const f=await xr(`/api/timetable/section/${e}/timetable/`);if(!f.ok)throw new Error(await f.text());let p=(await f.json()).results||[];n(p);const m=[];for(const g of p||[])for(const y of g.assignments||[])m.find(b=>b.id===y.period_id)||m.push({id:y.period_id,index:y.period_index,is_break:y.is_break,label:y.label});m.sort((g,y)=>(g.index||0)-(y.index||0)),s(m)}catch(f){console.error(f)}finally{l(!1)}})())},[e]),a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6 border border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl",children:a.jsx(ys,{className:"h-6 w-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Timetable"}),a.jsx("p",{className:"text-gray-600",children:"View your class schedule for the week"})]})]})}),o&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-8 border border-gray-100",children:a.jsx("div",{className:"text-center",children:a.jsxs("div",{className:"inline-flex items-center gap-2 text-gray-600",children:[a.jsx(Yu,{className:"animate-spin h-5 w-5 text-indigo-600"}),a.jsx("span",{children:"Loading timetable..."})]})})}),!o&&!e&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-8 border border-gray-100",children:a.jsxs("div",{className:"text-center",children:[a.jsx(rd,{className:"h-12 w-12 text-amber-500 mx-auto mb-3"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Section Not Assigned"}),a.jsx("p",{className:"text-gray-600",children:"You are not assigned to a section or your profile is incomplete."})]})}),!o&&e&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sc,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Weekly Schedule"})]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-slate-50 to-blue-50 border-b-2 border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700 min-w-[100px] sticky left-0 bg-gradient-to-r from-slate-50 to-blue-50 z-10",children:"Day / Period"}),i.map(f=>a.jsx("th",{className:"px-4 py-3 text-left min-w-[140px]",children:a.jsx("div",{className:"text-sm font-bold text-indigo-700",children:f.is_break||f.is_lunch?f.label||(f.is_break?"Break":"Lunch"):f.label||`${f.start_time||""}${f.start_time&&f.end_time?" - ":""}${f.end_time||""}`})},`period-${f.id}`))]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:IOe.map((f,h)=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-4 py-3 font-bold text-gray-900 bg-gray-50 sticky left-0 z-10",children:f}),i.map(p=>{const g=((r.find(b=>b.day===h+1)||{assignments:[]}).assignments||[]).filter(b=>b.period_id===p.id),y=g.some(b=>b.is_special);return a.jsx("td",{className:`px-4 py-3 align-top ${y&&g.some(b=>!b.is_special)?"bg-red-50":""}`,children:p.is_break?a.jsx("div",{className:"flex items-center justify-center py-2",children:a.jsx("span",{className:"text-sm text-gray-500 italic",children:p.label||"Break"})}):g&&g.length?a.jsx("div",{className:"space-y-2",children:g.map((b,v)=>{var S,k;const w=y&&!b.is_special;return a.jsxs("div",{className:`rounded-lg p-2.5 ${b.is_special?"bg-amber-50 border border-amber-200":w?"bg-red-50 border border-red-200":"bg-blue-50 border border-blue-200"}`,children:[a.jsxs("div",{className:"font-semibold text-gray-900 text-xs leading-tight flex items-center gap-1",children:[a.jsx(gs,{className:"h-3 w-3"}),b.is_special?b.timetable_name||"Special":ZF(b.curriculum_row||b.subject_text),b.is_special&&a.jsxs("span",{className:"text-amber-600 ml-1",children:[" ",ZF(b.curriculum_row||b.subject_text)]})]}),a.jsxs("div",{className:"text-xs text-gray-700 mt-1 flex items-center gap-1",children:[a.jsx(bs,{className:"h-3 w-3"}),"Staff: ",((S=b.staff)==null?void 0:S.username)||""]}),w&&a.jsx("div",{className:"text-xs text-red-600 mt-1 font-medium",children:"Overridden by special"}),b.is_special&&a.jsxs("div",{className:"text-xs text-amber-700 mt-1 flex items-center gap-1",children:[a.jsx(ys,{className:"h-3 w-3"}),b.date||"","  ",p.label||""]}),b.subject_batch&&a.jsxs("div",{className:"text-xs text-blue-700 mt-1 font-medium",children:["Batch: ",b.subject_batch.name]}),w&&b.elective_subject&&a.jsxs("div",{className:"text-xs text-red-600 mt-1",children:["Elective: ",b.elective_subject.course_code||b.elective_subject.course_name]})]},`${b.id||((k=b.curriculum_row)==null?void 0:k.id)||v}`)})}):a.jsx("div",{className:"flex items-center justify-center py-4",children:a.jsx("span",{className:"text-gray-300 text-sm",children:""})})},`cell-${h}-${p.id}`)})]},`day-${h}`))})]})})]})]})})}const $Oe=["Mon","Tue","Wed","Thu","Fri","Sat"];function eB(e){if(!e)return"";if(typeof e=="string"){const i=e.trim();return i.split(/[\s\-\_]+/)[0]||i.slice(0,15)+(i.length>15?"":"")}const t=(e==null?void 0:e.course_name)||(e==null?void 0:e.course)||(e==null?void 0:e.subject_text)||(e==null?void 0:e.course_code)||"",r=String(t).trim();if(!r)return"";const n=r.split(/[\s\-\_]+/).filter(i=>i.length>0);return n.length>0?n[0]:r.slice(0,15)+(r.length>15?"":"")}function UOe(e){var i,s;if(Array.isArray(e)){const o=[],l=new Set;for(const c of e){const u=c.section,d=c.subject_batch||(u==null?void 0:u.batch);let f="";d!=null&&d.name&&(f+=d.name),u!=null&&u.name&&(f+=(f?" / ":"")+u.name),f||(u!=null&&u.id?f="Sec "+u.id:(i=c.subject_batch)!=null&&i.name&&(f=c.subject_batch.name)),f&&!l.has(f)&&(o.push(f),l.add(f))}return o.length?o.join(" + "):""}const t=e.section,r=e.subject_batch||(t==null?void 0:t.batch);let n="";return r!=null&&r.name&&(n+=r.name),t!=null&&t.name&&(n+=(n?" / ":"")+t.name),n||(t!=null&&t.id?n="Sec "+t.id:(s=e.subject_batch)!=null&&s.name&&(n=e.subject_batch.name)),n||""}function zOe(){const[e,t]=x.useState([]),[r,n]=x.useState([]),[i,s]=x.useState(!1);x.useEffect(()=>{o()},[]);async function o(){s(!0);try{const l=new Date().toISOString().slice(0,10),c=await xr(`/api/timetable/staff/?date=${l}`);if(!c.ok)throw new Error(await c.text());const u=await c.json();t(u.results||[]);const d=await xr("/api/timetable/templates/");if(d.ok){const f=await d.json(),h=f.find(p=>p.is_active)||f[0];if(h&&h.periods)n(h.periods);else{const p=[];for(const m of u.results||[])for(const g of m.assignments||[])p.find(y=>y.id===g.period_id)||p.push({id:g.period_id,index:g.period_index,is_break:g.is_break,is_lunch:g.is_lunch,label:g.label,start_time:g.start_time,end_time:g.end_time});p.sort((m,g)=>(m.index||0)-(g.index||0)),n(p)}}}catch(l){console.error(l)}finally{s(!1)}}return a.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:a.jsx(ys,{className:"h-6 w-6 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Timetable"}),a.jsx("p",{className:"text-gray-600",children:"View your assigned teaching schedule"})]})]})}),i?a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-8",children:a.jsx("div",{className:"text-center",children:a.jsxs("div",{className:"inline-flex items-center gap-2 text-gray-600",children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-blue-600 border-t-transparent"}),a.jsx("span",{children:"Loading timetable..."})]})})}):a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(sc,{className:"h-5 w-5 text-blue-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Weekly Schedule"})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-blue-50 border-b-2 border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-700",children:"Day / Period"}),r.map(l=>a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-700 min-w-[120px]",children:l.label||`${l.start_time||""}${l.start_time&&l.end_time?" - ":""}${l.end_time||""}`},l.id))]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:$Oe.map((l,c)=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-4 py-3 font-semibold text-gray-900 bg-gray-50",children:l}),r.map(u=>{const f=((e.find(p=>p.day===c+1)||{assignments:[]}).assignments||[]).filter(p=>p.period_id===u.id),h=f.some(p=>p.is_special);return a.jsx("td",{className:`px-4 py-3 ${h&&f.some(p=>!p.is_special)?"bg-red-50":""}`,children:u.is_break||u.is_lunch?a.jsx("div",{className:"flex items-center justify-center",children:a.jsx("span",{className:"text-sm text-gray-500 italic",children:u.label||(u.is_break?"Break":"Lunch")})}):f&&f.length?a.jsx("div",{className:"space-y-2",children:(()=>{var m;const p={};for(const g of f){let y="";g.is_special?y=`special_${g.timetable_name||g.id}`:g.curriculum_row&&g.curriculum_row.id?y=`curr_${g.curriculum_row.id}`:g.subject_batch&&g.subject_batch.id?y=`batch_${g.subject_batch.id}`:g.elective_subject&&g.elective_subject.id?y=`elective_${g.elective_subject.id}`:g.subject_text?y=`subj_${(g.subject_text||"").replace(/[^A-Za-z0-9]/g,"").toLowerCase()}`:y=`section_${((m=g.section)==null?void 0:m.id)||Math.random()}`,p[y]=p[y]||[],p[y].push(g)}return Object.keys(p).map((g,y)=>{const b=p[g],v=b[0],w=h&&!v.is_special,S=v.is_special?"bg-amber-50 border border-amber-200":w?"bg-red-50 border border-red-200":"bg-blue-50 border border-blue-200";return a.jsxs("div",{className:`rounded-lg p-2.5 ${S}`,children:[a.jsxs("div",{className:"font-semibold text-gray-900 text-xs leading-tight",children:[v.is_special?v.timetable_name||"Special":eB(v.elective_subject||v.curriculum_row||v.subject_text),v.is_special&&a.jsxs("span",{className:"text-amber-600 ml-1",children:[" ",eB(v.elective_subject||v.curriculum_row||v.subject_text)]})]}),a.jsx("div",{className:"text-xs text-blue-700 font-medium mt-1",children:UOe(b)}),w&&a.jsx("div",{className:"text-xs text-red-600 mt-1 font-medium",children:"Overridden"}),v.is_special&&a.jsx("div",{className:"text-xs text-amber-700 mt-1",children:v.date||""})]},y)})})()}):a.jsx("div",{className:"flex items-center justify-center py-4",children:a.jsx("span",{className:"text-gray-300 text-sm",children:""})})},u.id)})]},l))})]})})]})]})})}async function WOe(e){const t=e?`/api/academics/staff/${e}/assigned-subjects/`:"/api/academics/staff/assigned-subjects/",r=await xr(t);if(!r.ok)throw new Error("Failed to fetch assigned subjects");const n=await r.json();return n.results||n}async function _v(){const e=await xr("/api/academics/subject-batches/?page_size=0");if(!e.ok)throw new Error("Failed to fetch subject batches");const t=await e.json();return t.results||t}async function qOe(e){var i;const t=await xr("/api/academics/subject-batches/",{method:"POST",body:JSON.stringify(e)}),r=t.headers.get("content-type")||"",n=await t.text();if(!t.ok){const s=r.includes("application/json")&&((i=JSON.parse(n))==null?void 0:i.detail)||n;throw new Error(s)}return r.includes("application/json")?JSON.parse(n):n}function HOe(){const[e,t]=x.useState([]),[r,n]=x.useState([]),[i,s]=x.useState({}),[o,l]=x.useState(!0),[c,u]=x.useState(null),[d,f]=x.useState(null),[h,p]=x.useState(""),[m,g]=x.useState([]),[y,b]=x.useState([]),[v,w]=x.useState(null),[S,k]=x.useState([]),[j,A]=x.useState(!1),[L,P]=x.useState([]),[F,E]=x.useState(null),[T,B]=x.useState([]);x.useEffect(()=>{q()},[]);async function q(){l(!0),u(null);try{const R=await WOe(),J=await _v();t(R),n(J)}catch(R){console.error(R),u((R==null?void 0:R.message)||"Failed to load assigned subjects")}finally{l(!1)}}async function U(R){var V;console.log("openPickerForAssignment clicked",R),u(null);const J=i[R.id]||`Batch for ${R.subject_code||R.subject_name||R.id}`;E(R),s(X=>({...X,[R.id]:J}));try{const X=await xr(`/api/academics/sections/${R.section_id}/students/`);if(!X.ok){const O=await X.text();throw new Error(O||"Failed to load students")}const Q=await X.json();let ne=Q.results||Q;const oe=R.curriculum_row_id||((V=R.curriculum_row)==null?void 0:V.id);if(oe){const O=new Set;for(const W of r)if(W.curriculum_row&&W.curriculum_row.id===oe)for(const ae of W.students||[])O.add(ae.id);ne=ne.filter(W=>!O.has(W.id))}P(ne),B(ne.map(O=>O.id)),A(!0)}catch(X){console.error("openPickerForAssignment error",X),u((X==null?void 0:X.message)||String(X)),alert("Failed to load students: "+((X==null?void 0:X.message)||X))}}async function se(R){u(null),E(R),P([]),B([]);try{let J;if(R.section_id){const Q=await xr(`/api/academics/sections/${R.section_id}/students/`);if(!Q.ok)throw new Error(await Q.text());J=await Q.json()}else if(R.elective_subject_id){const Q=await xr(`/api/curriculum/elective-choices/?elective_subject_id=${R.elective_subject_id}`);if(!Q.ok)throw new Error(await Q.text());J=await Q.json()}else throw new Error("No student mapping available for this assignment");const X=(J.results||J||[]).map(Q=>({id:Number(Q.id),reg_no:String(Q.reg_no??Q.regno??""),name:String(Q.username??Q.name??Q.full_name??""),section:Q.section_name??Q.section??null,section_id:Q.section_id??null}));P(X),B(X.map(Q=>Q.id)),A(!0)}catch(J){console.error("openListStudents error",J),u((J==null?void 0:J.message)||String(J)),alert("Failed to load students: "+((J==null?void 0:J.message)||J))}}function de(R){B(J=>J.includes(R)?J.filter(V=>V!==R):[...J,R])}async function z(){if(!F)return;const R=r.map(Q=>{const ne=String(Q.name||"").match(/Batch\s*(\d+)/i);return ne?parseInt(ne[1],10):null}).filter(Boolean),X={name:`Batch ${(R.length?Math.max(...R):0)+1}`,student_ids:T};F.curriculum_row_id&&(X.curriculum_row_id=F.curriculum_row_id);try{await qOe(X);const Q=await _v();n(Q),A(!1),P([]),E(null),alert("Batch created for subject")}catch(Q){console.error(Q),alert("Failed to create batch: "+((Q==null?void 0:Q.message)||Q))}}async function G(R){if(f(R.id),p(R.name||""),w(R),b((R.students||[]).map(J=>J.id)),R.curriculum_row&&R.curriculum_row.id)try{const J=e.find(V=>V.curriculum_row_id===R.curriculum_row.id);if(J&&J.section_id){const V=await xr(`/api/academics/sections/${J.section_id}/students/`);if(V.ok){const X=await V.json(),Q=X.results||X;g(Q)}}}catch(J){console.error("Failed to load students for batch editing:",J),g(R.students||[])}else g(R.students||[])}async function ie(){if(d)try{const R={name:h,student_ids:y},J=await xr(`/api/academics/subject-batches/${d}/`,{method:"PATCH",body:JSON.stringify(R)});if(!J.ok)throw new Error(await J.text());const V=await _v();n(V),Y(),alert("Batch updated successfully")}catch(R){console.error("saveBatchEdit failed",R),alert("Failed to update batch: "+((R==null?void 0:R.message)||R))}}function Y(){f(null),p(""),w(null),g([]),b([])}function C(R){b(J=>J.includes(R)?J.filter(V=>V!==R):[...J,R])}async function K(R){if(confirm("Delete this batch?"))try{const J=await xr(`/api/academics/subject-batches/${R}/`,{method:"DELETE"});if(!J.ok)throw new Error(await J.text());const V=await _v();n(V),alert("Batch deleted")}catch(J){console.error("deleteBatch failed",J),alert("Failed to delete: "+((J==null?void 0:J.message)||J))}}const H={};return r.forEach(R=>{const J=R.curriculum_row&&R.curriculum_row.id?String(R.curriculum_row.id):"___no_cr";H[J]||(H[J]=[]),H[J].push(R)}),a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-blue-50 via-white to-gray-50 p-6",children:[a.jsx("div",{className:"bg-gradient-to-r from-white to-blue-50 rounded-xl shadow-lg p-6 mb-6",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-100 to-indigo-200 rounded-xl flex items-center justify-center",children:a.jsx(gs,{className:"w-6 h-6 text-blue-700"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Assigned Subjects"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View all subjects assigned to you for the current academic session"})]})]}),!o&&!c&&e.length>0&&a.jsxs("div",{className:"flex items-center gap-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-4 py-2 rounded-full",children:[a.jsx("span",{className:"text-sm font-medium",children:"Total Subjects"}),a.jsx("span",{className:"bg-white/20 text-white px-3 py-1 rounded-full text-sm font-semibold",children:e.length})]})]})}),o&&a.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[a.jsx("div",{className:"w-8 h-8 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin mb-4"}),a.jsx("p",{className:"text-gray-600 font-medium",children:"Loading your assigned subjects..."})]}),c&&!o&&a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(rd,{className:"w-8 h-8 text-red-600"})}),a.jsx("p",{className:"text-red-600 font-medium mb-4",children:c}),a.jsx("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium transition-colors",onClick:q,children:"Try Again"})]}),!o&&!c&&e.length===0&&a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-12 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(nte,{className:"w-8 h-8 text-gray-400"})}),a.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Subjects Assigned"}),a.jsx("p",{className:"text-gray-600",children:"You don't have any subjects assigned for the current session."})]}),!o&&!c&&e.length>0&&a.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-blue-50 border-b-2 border-gray-200",children:[a.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-blue-700",children:"S.No"}),a.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-blue-700",children:"Subject"}),a.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-blue-700",children:"Section"}),a.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-blue-700",children:"Batch"}),a.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-blue-700",children:"Semester"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:e.map((R,J)=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:"text-sm font-medium text-gray-900",children:J+1})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold text-gray-900",children:R.subject_name||"Unnamed Subject"}),R.subject_code&&a.jsx("div",{className:"text-sm text-blue-600 font-medium",children:R.subject_code})]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:R.section_id?a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1.5 rounded-lg text-xs font-medium transition-colors",onClick:()=>U(R),children:"Create Batch"}),a.jsx("button",{type:"button",className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors",onClick:()=>se(R),children:"List Students"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors",onClick:()=>se(R),children:"List Students"}),a.jsx("span",{className:"text-xs text-gray-500 px-2 py-1",children:"Department-wide elective"})]})})]})}),a.jsx("td",{className:"px-6 py-4",children:R.section_name?a.jsxs("div",{className:"flex items-center gap-2 bg-blue-50 text-blue-700 px-3 py-1 rounded-full w-fit",children:[a.jsx(bs,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-medium",children:R.section_name})]}):a.jsx("span",{className:"text-gray-400",children:""})}),a.jsx("td",{className:"px-6 py-4",children:R.batch?a.jsxs("div",{className:"flex items-center gap-2 bg-green-50 text-green-700 px-3 py-1 rounded-full w-fit",children:[a.jsx(ys,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-medium",children:R.batch})]}):a.jsx("span",{className:"text-gray-400",children:""})}),a.jsx("td",{className:"px-6 py-4",children:R.semester!=null?a.jsxs("span",{className:"bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-semibold",children:["Sem ",R.semester]}):a.jsx("span",{className:"text-gray-400",children:""})})]},R.id))})]})})}),a.jsx("div",{className:"mt-6",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[a.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[a.jsx(bs,{className:"w-5 h-5 text-blue-600"}),"Student Subject Batches"]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Existing Batches"}),r.length===0&&a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx(bs,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),a.jsx("p",{children:"No batches created yet"})]}),e.map(R=>{const J=R.curriculum_row_id?String(R.curriculum_row_id):null,V=J?H[J]||[]:[];return!V||V.length===0?null:a.jsxs("div",{className:"mb-6 border-b border-gray-100 pb-4 last:border-b-0",children:[a.jsx("div",{className:"font-bold text-gray-900 mb-3",children:R.subject_name||R.subject_code||"Unnamed Subject"}),a.jsx("div",{className:"space-y-3",children:V.map(X=>a.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:X.name}),a.jsx("div",{className:"text-sm text-gray-600",children:a.jsxs("span",{className:"font-medium",children:[(X.students||[]).length," students"]})})]}),a.jsxs("div",{className:"ml-4 flex gap-2",children:[a.jsx("button",{className:"bg-blue-100 hover:bg-blue-200 text-blue-700 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",onClick:()=>G(X),children:"Edit"}),a.jsx("button",{className:"bg-red-100 hover:bg-red-200 text-red-700 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",onClick:()=>K(X.id),children:"Delete"})]})]})},X.id))})]},`subject-${R.id}`)}),(()=>{const R=r.filter(J=>{const V=J.curriculum_row&&J.curriculum_row.id?J.curriculum_row.id:null;return!V||!e.some(X=>X.curriculum_row_id===V)});return R.length===0?null:a.jsxs("div",{className:"mt-6",children:[a.jsx("div",{className:"font-bold text-gray-900 mb-3",children:"Other Batches"}),a.jsx("div",{className:"space-y-3",children:R.map(J=>a.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:J.name}),a.jsx("div",{className:"text-sm text-gray-600",children:a.jsxs("span",{className:"font-medium",children:[(J.students||[]).length," students"]})})]}),a.jsxs("div",{className:"ml-4 flex gap-2",children:[a.jsx("button",{className:"bg-blue-100 hover:bg-blue-200 text-blue-700 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",onClick:()=>G(J),children:"Edit"}),a.jsx("button",{className:"bg-red-100 hover:bg-red-200 text-red-700 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",onClick:()=>K(J.id),children:"Delete"})]})]})},`other-${J.id}`))})]})})()]})]})}),j&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[80vh] overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:i[(F==null?void 0:F.id)||""]||"Create Batch"}),a.jsx("div",{className:"text-sm text-gray-600",children:(F==null?void 0:F.subject_name)||(F==null?void 0:F.subject_code)})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",className:"bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded-lg font-medium transition-colors",onClick:()=>{A(!1),P([]),E(null)},children:"Cancel"}),a.jsx("button",{type:"button",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",onClick:z,children:"Create Batch"})]})]})}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-4",children:[a.jsxs("h4",{className:"font-semibold text-gray-900 mb-2",children:["Students (",L.length,")"]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Select students to include in this batch"})]}),a.jsx("div",{className:"max-h-96 overflow-y-auto",children:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:L.map(R=>a.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",children:[a.jsx("input",{type:"checkbox",checked:T.includes(R.id),onChange:()=>de(R.id),className:"w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:R.username||R.full_name||R.reg_no}),R.reg_no&&a.jsx("div",{className:"text-xs text-gray-500",children:R.reg_no})]})]},R.id))})})]})]})}),d&&v&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[80vh] overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:"Edit Batch"}),a.jsx("div",{className:"text-sm text-gray-600",children:"Modify batch name and student assignments"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",className:"bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded-lg font-medium transition-colors",onClick:Y,children:"Cancel"}),a.jsx("button",{type:"button",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",onClick:ie,children:"Save Changes"})]})]})}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:"Batch Name"}),a.jsx("input",{type:"text",value:h,onChange:R=>p(R.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter batch name"})]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-semibold text-gray-900 mb-2 flex items-center justify-between",children:[a.jsxs("span",{children:["Students (",y.length," selected)"]}),a.jsx("div",{className:"text-sm text-gray-600",children:"Click to add/remove students"})]}),a.jsx("div",{className:"max-h-80 overflow-y-auto border border-gray-200 rounded-lg p-4",children:m.length===0?a.jsxs("div",{className:"text-center text-gray-500 py-4",children:[a.jsx(bs,{className:"w-8 h-8 mx-auto mb-2 text-gray-300"}),a.jsx("p",{children:"No students available for this batch"})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:m.map(R=>a.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-lg cursor-pointer transition-colors ${y.includes(R.id)?"border-blue-300 bg-blue-50":"border-gray-200 hover:bg-gray-50"}`,children:[a.jsx("input",{type:"checkbox",checked:y.includes(R.id),onChange:()=>C(R.id),className:"w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:R.username||R.full_name||R.reg_no}),R.reg_no&&a.jsx("div",{className:"text-xs text-gray-500",children:R.reg_no})]})]},R.id))})})]})]})]})})]})}function VOe(){const[e,t]=x.useState(new Date().toISOString().slice(0,10)),[r,n]=x.useState([]),[i,s]=x.useState(!1),[o,l]=x.useState(null),[c,u]=x.useState([]),[d,f]=x.useState({}),[h,p]=x.useState(!1),[m,g]=x.useState(!1),[y,b]=x.useState(!1),[v,w]=x.useState(new Date().toISOString().slice(0,7)),[S,k]=x.useState([]),[j,A]=x.useState({}),[L,P]=x.useState([]),[F,E]=x.useState(!1),[T,B]=x.useState({}),[q,U]=x.useState({}),[se,de]=x.useState({}),[z,G]=x.useState(!1),[ie,Y]=x.useState(null),[C,K]=x.useState(null);x.useEffect(()=>{R()},[e]);function H(Z){const me={};for(const Te of Z){let Ae="";if(Te.period&&Te.period.index!==void 0){const Be=Te.period.index;Te.subject_batch_id?Ae=`batch_${Be}_${Te.subject_batch_id}`:Te.elective_subject_id?Ae=`elective_${Be}_${Te.teaching_assignment_id||Te.elective_subject_id}`:Te.subject?Ae=`subj_${Be}_${String(Te.subject||"").replace(/[^A-Za-z0-9]/g,"").toLowerCase()}`:Ae=`section_${Be}_${Te.section_id}`}else Te.subject_batch_id?Ae=`batch_${Te.subject_batch_id}`:Te.elective_subject_id?Ae=`elective_${Te.teaching_assignment_id||Te.elective_subject_id}`:Te.subject?Ae=`subj_${String(Te.subject).replace(/[^A-Za-z0-9]/g,"").toLowerCase()}`:Ae=`section_${Te.section_id}`;if(!me[Ae])me[Ae]={...Te,section_ids:[Te.section_id],section_names:[Te.section_name],attendance_session_ids:[Te.attendance_session_id]};else{const Be=me[Ae];Be.section_ids.includes(Te.section_id)||Be.section_ids.push(Te.section_id),Te.section_name&&!Be.section_names.includes(Te.section_name)&&Be.section_names.push(Te.section_name),Be.attendance_session_ids=Array.from(new Set([...Be.attendance_session_ids||[],Te.attendance_session_id]))}}return Object.keys(me).map(Te=>({...me[Te],id:Te}))}async function R(){s(!0);try{const Z=await xr(`/api/academics/staff/periods/?date=${e}`);if(!Z.ok)throw new Error("Failed to load periods");const me=await Z.json();n(me.results||[])}catch(Z){console.error("fetchPeriods",Z),n([])}finally{s(!1)}}function J(Z){var Pt;const me=Z.section_ids&&Array.isArray(Z.section_ids)&&Z.section_ids.length?Z.section_ids:[Z.section_id],Te=r.filter(ft=>!ft||ft.attendance_session_locked||!me.includes(ft.section_id)||Z.id&&ft.id===Z.id?!1:!!(Z.subject_batch_id&&ft.subject_batch_id===Z.subject_batch_id||Z.teaching_assignment_id&&ft.teaching_assignment_id===Z.teaching_assignment_id||Z.elective_subject_id&&ft.elective_subject_id===Z.elective_subject_id||Z.subject&&ft.subject===Z.subject));if(Te.length===0)return null;const Ae=[...Te].sort((ft,He)=>ft.period.index-He.period.index),Be=((Pt=Z.period)==null?void 0:Pt.index)||Z.period&&Z.period.index||0,Ee=Ae.find(ft=>ft.period.index>Be),ze=[...Ae].reverse().find(ft=>ft.period.index<Be),Xe=4;return Ee&&Ee.period.index-Be<=Xe?Ee:ze&&Be-ze.period.index<=Xe?ze:null}function V(Z){const me=J(Z);me?(Y(Z),K(me),G(!0)):X(Z)}async function X(Z){l(Z),u([]),f({}),s(!0);try{let me=[];if(Z.section_ids&&Array.isArray(Z.section_ids)&&Z.section_ids.length>1)if(Z.elective_subject_id){const Ee=await xr(`/api/curriculum/elective-choices/?elective_subject_id=${Z.elective_subject_id}`);Ee.ok&&(me=(await Ee.json()).results||[])}else{const Ee=[];for(const Xe of Z.section_ids)Ee.push(xr(`/api/academics/sections/${Xe}/students/`).then(Pt=>Pt.ok?Pt.json():{results:[]}).catch(()=>({results:[]})));const ze=await Promise.allSettled(Ee);for(const Xe of ze)if(Xe.status==="fulfilled"){const Pt=Xe.value||{},ft=Pt.results||Pt.students||[];me=me.concat(ft)}}else if(Z.elective_subject_id){const Ee=await xr(`/api/curriculum/elective-choices/?elective_subject_id=${Z.elective_subject_id}`);Ee.ok&&(me=(await Ee.json()).results||[])}else if(Z.subject_batch_id){const Ee=await xr(`/api/academics/subject-batches/${Z.subject_batch_id}/`);if(Ee.ok){const ze=await Ee.json();me=ze.students||ze.results||[]}}else{const Ee=await xr(`/api/academics/sections/${Z.section_id}/students/`);Ee.ok&&(me=(await Ee.json()).results||[])}const Te={};for(const Ee of me||[])Ee&&Ee.id&&(Te[Ee.id]=Ee);const Ae=Object.values(Te);u((Ae||[]).map(Ee=>({id:Number(Ee.id),reg_no:String(Ee.reg_no||Ee.regno||String(Ee.id)),name:String(Ee.name??Ee.full_name??Ee.username??""),username:String(Ee.username??Ee.name??""),section:Ee.section_name??Ee.section??null,section_id:Ee.section_id??null})));const Be={};if((Ae||[]).forEach(Ee=>Be[Ee.id]="P"),f(Be),Z.attendance_session_id||Z.attendance_session_ids&&Z.attendance_session_ids.length)try{const ze=(Z.attendance_session_ids&&Z.attendance_session_ids.length?Z.attendance_session_ids:[Z.attendance_session_id]).map(ft=>xr(`/api/academics/period-attendance/${ft}/`).then(He=>He.ok?He.json():null).catch(()=>null)),Xe=await Promise.allSettled(ze),Pt={...Be};for(const ft of Xe){if(ft.status!=="fulfilled"||!ft.value)continue;(ft.value.records||[]).forEach(_e=>{const Se=_e.student_pk||_e.student&&_e.student.id||null;Se&&(Pt[Se]=_e.status||Pt[Se]||"A")})}f(Pt)}catch(Ee){console.error("load session records",Ee)}}catch(me){console.error("openPeriod",me)}finally{s(!1)}}function Q(Z,me){f(Te=>({...Te,[Z]:me}))}async function ne(){if(o){p(!0);try{const Z=c.map(ze=>({student_id:ze.id,status:d[ze.id]||"P"})),me=o.consecutive_periods&&Array.isArray(o.consecutive_periods)&&o.consecutive_periods.length>0?o.consecutive_periods.map(ze=>ze.period_id):[o.period.id],Te=o.section_ids&&Array.isArray(o.section_ids)&&o.section_ids.length>0?o.section_ids:[o.section_id],Ae={};for(const ze of Te){const Xe=c.filter(Pt=>(Pt.section_id||null)===ze).map(Pt=>({student_id:Pt.id,status:d[Pt.id]||"P"}));if(Xe.length===0&&o.section_name){const Pt=new Set(String(o.section_name).split(" + ").map(He=>He.trim())),ft=c.filter(He=>Pt.has(String(He.section_name||He.section||"").trim())).map(He=>({student_id:He.id,status:d[He.id]||"P"}));Ae[ze]=ft.length?ft:c.map(He=>({student_id:He.id,status:d[He.id]||"P"}))}else Ae[ze]=Xe.length?Xe:c.map(Pt=>({student_id:Pt.id,status:d[Pt.id]||"P"}))}const Be=[];for(const ze of me)for(const Xe of Te){const Pt={section_id:Xe,period_id:ze,teaching_assignment_id:o.teaching_assignment_id??null,date:e,records:Ae[Xe]||[]};console.log("Saving attendance for section",Xe,"period",ze,Pt);const ft=await xr("/api/academics/period-attendance/bulk-mark/",{method:"POST",body:JSON.stringify(Pt)}),He=await(ft.ok?ft.json().catch(()=>null):ft.json().catch(()=>null));Be.push({section:Xe,period:ze,ok:ft.ok,data:He})}const Ee=Be.filter(ze=>!ze.ok);if(Ee.length)console.error("Some saves failed:",Ee),alert("Attendance saved for some sections/periods, but failed for others. Check console for details.");else{await R();const ze=o.combined_period_label||o.period&&(o.period.label||`Period ${o.period.index}`);alert(`Attendance saved successfully!

Date: ${e}
Period(s): ${ze}
Sections: ${Te.length}
Students: ${c.length}`),l(null)}}catch(Z){console.error("saveMarks error:",Z),alert("Failed to save attendance: "+(Z instanceof Error?Z.message:String(Z)))}finally{p(!1)}}}async function oe(){var Z,me,Te,Ae,Be,Ee;if(!(!ie||!C)){G(!1);try{const ze=ie;let Xe=[];if(ze.section_ids&&Array.isArray(ze.section_ids)&&ze.section_ids.length>1){const Se=ze.section_ids.map(he=>xr(`/api/academics/sections/${he}/students/`).then(ye=>ye.ok?ye.json():{results:[]}).catch(()=>({results:[]})));if(ze.elective_subject_id){const he=await xr(`/api/curriculum/elective-choices/?elective_subject_id=${ze.elective_subject_id}`);he.ok&&(Xe=(await he.json()).results||[])}else{const he=await Promise.allSettled(Se);for(const ye of he)if(ye.status==="fulfilled"){const ht=ye.value||{};Xe=Xe.concat(ht.results||ht.students||[])}}}else if(ze.elective_subject_id){const Se=await xr(`/api/curriculum/elective-choices/?elective_subject_id=${ze.elective_subject_id}`);Se.ok&&(Xe=(await Se.json()).results||[])}else if(ze.subject_batch_id){const Se=await xr(`/api/academics/subject-batches/${ze.subject_batch_id}/`);if(Se.ok){const he=await Se.json();Xe=he.students||he.results||[]}}else{const Se=await xr(`/api/academics/sections/${ze.section_id}/students/`);Se.ok&&(Xe=(await Se.json()).results||[])}const Pt={};for(const Se of Xe||[])Se&&Se.id&&(Pt[Se.id]=Se);let ft=Object.values(Pt).map(Se=>({id:Number(Se.id),reg_no:String(Se.reg_no||Se.regno||String(Se.id)),username:Se.username||Se.name||"",section_id:Se.section_id||Se.sectionId||null,section_name:Se.section_name||Se.section||""}));if((!ft||ft.length===0)&&ze.section_ids&&Array.isArray(ze.section_ids)&&ze.section_ids.length>0){const Se=ze.section_ids.map(Ge=>xr(`/api/academics/sections/${Ge}/students/`).then(lt=>lt.ok?lt.json():{results:[]}).catch(()=>({results:[]}))),he=await Promise.allSettled(Se),ye=[];for(const Ge of he)if(Ge.status==="fulfilled"){const lt=Ge.value||{},jt=lt.results||lt.students||[];ye.push(...jt)}const ht={};for(const Ge of ye)Ge&&Ge.id&&(ht[Ge.id]=Ge);ft=Object.values(ht).map(Ge=>({id:Number(Ge.id),reg_no:String(Ge.reg_no||Ge.regno||String(Ge.id)),username:Ge.username||Ge.name||"",section_id:Ge.section_id||Ge.sectionId||null,section_name:Ge.section_name||Ge.section||""}))}const He={};ft.forEach(Se=>He[Se.id]="P"),u(ft),f(He);const tt=`${((Z=ie.period)==null?void 0:Z.label)||`Period ${(me=ie.period)==null?void 0:me.index}`} & ${((Te=C.period)==null?void 0:Te.label)||`Period ${(Ae=C.period)==null?void 0:Ae.index}`}`,_e=ze.section_names&&ze.section_names.length?ze.section_names.join(" + "):ze.section_name||"";l({...ie,consecutive_periods:[{period_id:ie.period.id,label:((Be=ie.period)==null?void 0:Be.label)||""},{period_id:C.period.id,label:((Ee=C.period)==null?void 0:Ee.label)||""}],combined_period_label:tt,section_name:_e,section_ids:ze.section_ids||[ze.section_id]})}catch(ze){console.error("markBothPeriods error:",ze),alert("Failed to prepare marking for both periods: "+(ze instanceof Error?ze.message:String(ze)))}finally{G(!1),Y(null),K(null)}}}function O(){ie&&(G(!1),X(ie),Y(null),K(null))}async function W(){var Ae;if(!o||!o.attendance_session_id){alert("No active attendance session to lock/unlock");return}const Z=o.attendance_session_locked,me=o.attendance_session_id;if(window.confirm(Z?"Are you sure you want to request an unlock for this attendance session? Unlocking requires approval.":"Are you sure you want to lock this attendance session? This will prevent any further changes to attendance records.")){g(!0);try{if(Z){const Be=await xr("/api/academics/attendance-unlock-requests/",{method:"POST",body:JSON.stringify({session:o.attendance_session_id,note:""})});if(Be.ok){const Ee=await Be.json();console.log("Unlock request created:",Ee),alert('Unlock request submitted successfully! Check the "My Requests" button in the Analytics page to view the status.');try{l(ze=>ze&&{...ze,unlock_request_status:Ee.status,unlock_request_id:Ee.id}),n(ze=>ze.map(Xe=>Xe.attendance_session_id&&me&&Xe.attendance_session_id===me?{...Xe,unlock_request_status:Ee.status,unlock_request_id:Ee.id}:Xe))}catch(ze){console.warn("Failed to update local unlock status",ze)}}else{const Ee=await Be.json().catch(()=>({}));if(Be.status===400&&((Ae=Ee.detail)!=null&&Ae.includes("already pending")))alert("An unlock request for this session already exists and is pending approval. Please check the Requests section for status.");else throw new Error(Ee.detail||"Failed to create unlock request")}}else{const Be=await xr(`/api/academics/period-attendance/${o.attendance_session_id}/lock/`,{method:"POST"});if(!Be.ok){const ze=await Be.json().catch(()=>({}));throw new Error(ze.detail||"Failed to lock session")}const Ee=await Be.json();console.log("Session locked successfully:",Ee),l({...o,attendance_session_locked:Ee.is_locked}),await R(),alert("Attendance session locked successfully!")}}catch(Be){console.error("toggleLock error:",Be),alert("Failed to perform lock/unlock: "+(Be instanceof Error?Be.message:String(Be)))}finally{g(!1)}}}async function ae(){try{const Z=await xr("/api/timetable/staff/");if(!Z.ok)throw new Error("Failed to load assignments");const me=await Z.json(),Te=[];for(const Ae of me.results||[]){const Be=Ae.day;for(const Ee of Ae.assignments||[])Te.push({...Ee,_day:Be})}await I(v,Te),k(Te),b(!0),A({}),B({}),U({})}catch(Z){console.error("openBulkModal",Z),alert("Failed to open bulk modal")}}async function I(Z,me){var Te,Ae;try{const[Be,Ee]=Z.split("-").map(_e=>parseInt(_e)),ze=new Date(Be,Ee-1,1).toISOString().slice(0,10),Xe=new Date(Be,Ee,0).toISOString().slice(0,10),Pt=await xr(`/api/academics/period-attendance/?date_after=${ze}&date_before=${Xe}`);if(!Pt.ok){console.warn("Failed to load existing sessions"),de({});return}const He=(await Pt.json()).results||[],tt={};for(const _e of He){const Se=_e.date,he=((Te=_e.section)==null?void 0:Te.id)||_e.section_id,ye=((Ae=_e.period)==null?void 0:Ae.id)||_e.period_id;if(!Se||!he||!ye)continue;const ht=new Date(Se),Ge=ht.getDay()===0?7:ht.getDay(),lt=me.find(jt=>{var wt,yt;return jt._day===Ge&&(jt.period_id===ye||((wt=jt.period)==null?void 0:wt.id)===ye)&&(jt.section_id===he||((yt=jt.section)==null?void 0:yt.id)===he)});if(lt){const jt=lt.id?String(lt.id):`${lt._day}_${ye}_${he}`;tt[jt]||(tt[jt]=new Set),tt[jt].add(Se)}}de(tt),console.log("Loaded marked sessions:",tt)}catch(Be){console.error("Error loading marked sessions:",Be),de({})}}return x.useEffect(()=>{y&&S.length>0&&I(v,S)},[v]),x.useEffect(()=>{async function Z(){var Te,Ae,Be,Ee;if(!Object.keys(j).filter(ze=>j[ze]).length){P([]);return}E(!0);try{const ze=[];for(const ft of S){const He=ft.id?String(ft.id):`${ft._day}_${ft.period_id}_${ft.section_id}`;if(j[He]){if(ft.elective_subject_id)ze.push(xr(`/api/curriculum/elective-choices/?elective_subject_id=${ft.elective_subject_id}`).then(tt=>tt.ok?tt.json():{results:[]}));else if(ft.subject_batch_id||(Te=ft.subject_batch)!=null&&Te.id){const tt=ft.subject_batch_id||((Ae=ft.subject_batch)==null?void 0:Ae.id);ze.push(xr(`/api/academics/subject-batches/${tt}/`).then(_e=>_e.ok?_e.json():{students:[]}))}else if(ft.section_id||(Be=ft.section)!=null&&Be.id){const tt=ft.section_id||((Ee=ft.section)==null?void 0:Ee.id);ze.push(xr(`/api/academics/sections/${tt}/students/`).then(_e=>_e.ok?_e.json():{results:[]}))}}}const Xe=await Promise.allSettled(ze),Pt=[];for(const ft of Xe){if(ft.status!=="fulfilled")continue;const He=ft.value||{},tt=He.results||He.students||[];for(const _e of tt)!_e||!_e.id||Pt.find(Se=>Se.id===_e.id)||Pt.push({id:_e.id,reg_no:_e.reg_no||_e.regno||String(_e.id),username:_e.username||_e.name||""})}P(Pt),U(ft=>{const He={...ft};for(const tt of Pt)He[tt.id]===void 0&&(He[tt.id]=!1);return He})}catch(ze){console.error("loadAgg",ze),P([])}finally{E(!1)}}Z()},[j,S]),a.jsxs("div",{className:"min-h-screen p-4 md:p-6 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-6 border border-slate-200",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 p-3 rounded-xl shadow-lg",children:a.jsx(ys,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Mark Attendance"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"Record student attendance for periods"})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-4 border border-slate-200",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("label",{className:"text-sm font-medium text-slate-700 flex items-center gap-2",children:[a.jsx(sc,{className:"w-4 h-4 text-indigo-600"}),"Select Date:"]}),a.jsx("input",{type:"date",value:e,onChange:Z=>t(Z.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 mb-6",children:[a.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-slate-50",children:a.jsxs("h2",{className:"text-lg font-semibold text-slate-900 flex items-center gap-2",children:[a.jsx(bs,{className:"w-5 h-5 text-indigo-600"}),"Assigned Periods"]})}),a.jsx("div",{className:"p-6",children:i?a.jsxs("div",{className:"flex items-center justify-center py-12",children:[a.jsx(Yu,{className:"w-8 h-8 text-indigo-600 animate-spin"}),a.jsx("span",{className:"ml-3 text-slate-600",children:"Loading periods..."})]}):a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[H(r).map(Z=>a.jsxs("div",{className:"border border-slate-200 rounded-lg p-4 bg-white hover:shadow-md transition-shadow",children:[a.jsx("div",{className:"flex items-start justify-between mb-2",children:a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-semibold text-slate-900 mb-1",children:Z.period.label||`Period ${Z.period.index}`}),a.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-slate-600 mb-1",children:[a.jsx(sc,{className:"w-4 h-4"}),Z.period.start_time||"",Z.period.start_time&&Z.period.end_time?`  ${Z.period.end_time}`:""]}),a.jsx("div",{className:"text-sm text-slate-700 mb-1",children:a.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-md bg-blue-100 text-blue-800 font-medium",children:Z.section_names&&Z.section_names.length?Z.section_names.join(" + "):Z.section_name})}),a.jsx("div",{className:"text-sm italic text-slate-600",children:Z.subject_display||Z.subject||"No subject"}),Z.unlock_request_status&&a.jsxs("div",{className:"mt-2",children:[Z.unlock_request_status==="PENDING"&&a.jsx("span",{className:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-amber-100 text-amber-800 border border-amber-300 rounded-md text-xs font-medium",children:"Pending"}),Z.unlock_request_status==="APPROVED"&&a.jsx("span",{className:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-green-100 text-green-800 border border-green-300 rounded-md text-xs font-medium",children:"Approved"}),Z.unlock_request_status==="REJECTED"&&a.jsx("span",{className:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-red-100 text-red-800 border border-red-300 rounded-md text-xs font-medium",children:"Rejected"})]})]})}),a.jsx("div",{className:"mt-3",children:Z.attendance_session_locked?a.jsxs("button",{onClick:()=>X(Z),className:"w-full px-3 py-2 bg-amber-100 text-amber-800 border border-amber-300 rounded-lg text-sm font-medium hover:bg-amber-200 flex items-center justify-center gap-2",children:[a.jsx(i0,{className:"w-4 h-4"}),Z.attendance_session_id?"View Locked Session":"View Locked Period"]}):a.jsx("button",{onClick:()=>V(Z),className:"w-full px-3 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2",children:Z.attendance_session_id?a.jsxs(a.Fragment,{children:[a.jsx(Hf,{className:"w-4 h-4"}),"Open Session"]}):a.jsxs(a.Fragment,{children:[a.jsx(ys,{className:"w-4 h-4"}),"Take Attendance"]})})})]},Z.id)),!r.length&&a.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center py-12 text-center",children:[a.jsx("div",{className:"bg-slate-100 p-4 rounded-full mb-4",children:a.jsx(ys,{className:"w-12 h-12 text-slate-400"})}),a.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-1",children:"No Periods Found"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"No periods assigned for this date"})]}),a.jsx("div",{className:"col-span-full mt-2",children:a.jsx("button",{onClick:ae,className:"w-full px-4 py-3 border-2 border-dashed border-indigo-300 text-indigo-600 rounded-lg font-medium hover:bg-indigo-50 transition-colors",children:"Bulk Mark (All Assignments)"})})]})})]}),o&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 mb-6",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-slate-200 bg-slate-50 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("h3",{className:"text-lg font-semibold text-slate-900",children:[o.combined_period_label||o.period.label||`Period ${o.period.index}`,"  ",o.section_name,a.jsxs("span",{className:"ml-3 inline-flex items-center px-2 py-0.5 rounded-md bg-slate-100 text-slate-700 text-sm font-medium",children:[c.length," student",c.length!==1?"s":""]})]}),o.attendance_session_locked&&a.jsxs(a.Fragment,{children:[a.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-amber-100 text-amber-800 border border-amber-300 rounded-lg text-sm font-medium",children:[a.jsx(i0,{className:"w-3.5 h-3.5"}),"Locked"]}),o.unlock_request_status==="PENDING"&&a.jsx("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-amber-50 text-amber-800 border border-amber-200 rounded-lg text-sm font-medium ml-3",children:"Pending"}),o.unlock_request_status==="APPROVED"&&a.jsx("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-green-50 text-green-800 border border-green-200 rounded-lg text-sm font-medium ml-3",children:"Approved"}),o.unlock_request_status==="REJECTED"&&a.jsx("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-red-50 text-red-800 border border-red-200 rounded-lg text-sm font-medium ml-3",children:"Rejected"})]})]}),a.jsxs("button",{onClick:()=>l(null),className:"px-3 py-1.5 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-lg text-sm font-medium transition-colors flex items-center gap-2",children:[a.jsx(vu,{className:"w-4 h-4"}),"Close"]})]}),a.jsxs("div",{className:"p-6",children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-slate-200",children:[a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Reg No"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Student"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Status"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-200",children:c.map(Z=>{const me=d[Z.id]||"P",Te={P:"bg-green-50 text-green-800 border-green-300",A:"bg-red-50 text-red-800 border-red-300",LEAVE:"bg-amber-50 text-amber-800 border-amber-300",OD:"bg-blue-50 text-blue-800 border-blue-300",LATE:"bg-indigo-50 text-indigo-800 border-indigo-300"},Ae={P:"bg-green-600",A:"bg-red-600",LEAVE:"bg-amber-600",OD:"bg-blue-600",LATE:"bg-indigo-600"},Be=Te[me]||Te.P,Ee=Ae[me]||Ae.P;return a.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[a.jsx("td",{className:"py-3 px-4 text-sm font-medium text-slate-900",children:Z.reg_no}),a.jsx("td",{className:"py-3 px-4 text-sm text-slate-700",children:Z.username}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:`inline-block w-3 h-3 rounded-full mr-2 ${Ee}`}),a.jsxs("div",{className:"relative inline-block",children:[a.jsxs("select",{value:d[Z.id]||"P",onChange:ze=>Q(Z.id,ze.target.value),disabled:o.attendance_session_locked,className:`appearance-none px-3 py-1.5 pr-8 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent ${Be} ${o.attendance_session_locked?"disabled:bg-slate-100 disabled:text-slate-500 disabled:cursor-not-allowed":""}`,children:[a.jsx("option",{value:"P",children:"Present"}),a.jsx("option",{value:"A",children:"Absent"}),a.jsx("option",{value:"LEAVE",children:"Leave"}),a.jsx("option",{value:"OD",children:"On Duty"}),a.jsx("option",{value:"LATE",children:"Late"})]}),a.jsx(Uee,{className:"w-4 h-4 text-slate-400 absolute right-2 top-1/2 -translate-y-1/2 pointer-events-none"})]})]})})]},Z.id)})})]})}),a.jsxs("div",{className:"mt-6 flex flex-wrap gap-3",children:[a.jsx("button",{onClick:ne,disabled:h||o.attendance_session_locked,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-300 text-white rounded-lg font-medium transition-colors flex items-center gap-2",children:h?a.jsxs(a.Fragment,{children:[a.jsx(Yu,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(id,{className:"w-4 h-4"}),"Save Attendance"]})}),o.attendance_session_id&&a.jsx("button",{onClick:W,disabled:m,className:`px-4 py-2 rounded-lg font-medium transition-colors flex items-center gap-2 ${o.attendance_session_locked?"bg-amber-600 hover:bg-amber-700 disabled:bg-amber-300 text-white":"bg-slate-600 hover:bg-slate-700 disabled:bg-slate-300 text-white"}`,children:m?a.jsxs(a.Fragment,{children:[a.jsx(Yu,{className:"w-4 h-4 animate-spin"}),o.attendance_session_locked?"Unlocking...":"Locking..."]}):a.jsx(a.Fragment,{children:o.attendance_session_locked?a.jsxs(a.Fragment,{children:[a.jsx(dte,{className:"w-4 h-4"}),"Unlock Session"]}):a.jsxs(a.Fragment,{children:[a.jsx(i0,{className:"w-4 h-4"}),"Lock Session"]})})})]})]})]}),y&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-3xl max-h-[85vh] overflow-y-auto shadow-2xl",children:[a.jsx("div",{className:"sticky top-0 bg-white border-b border-slate-200 px-6 py-4 rounded-t-xl",children:a.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Bulk Mark Attendance"})}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[a.jsx(ys,{className:"w-4 h-4 text-indigo-600"}),"Select Month:"]}),a.jsx("input",{type:"month",value:v,onChange:Z=>w(Z.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-900 mb-3",children:"Assignments"}),a.jsxs("div",{className:"border border-slate-200 rounded-lg p-4 max-h-60 overflow-y-auto bg-slate-50",children:[a.jsxs("label",{className:"flex items-center gap-2 mb-3 text-sm font-medium text-slate-700",children:[a.jsx("input",{type:"checkbox",checked:Object.keys(j).length>0&&Object.values(j).every(Boolean),onChange:Z=>{const me=Z.target.checked,Te={};for(const Ae of S){const Be=Ae.id?String(Ae.id):`${Ae._day}_${Ae.period_id}_${Ae.section_id}`;Te[Be]=me}A(Te)},className:"w-4 h-4 text-indigo-600 border-slate-300 rounded focus:ring-indigo-500"}),"Select / Deselect all"]}),a.jsx("div",{className:"space-y-2",children:(()=>{const Z=S.filter(me=>{const Te=me.id?String(me.id):`${me._day}_${me.period_id}_${me.section_id}`,Ae=se[Te];if(!Ae)return!0;try{const[Be,Ee]=v.split("-").map(Pt=>parseInt(Pt)),ze=new Date(Be,Ee,0).getDate();let Xe=0;for(let Pt=1;Pt<=ze;Pt++){const ft=new Date(Be,Ee-1,Pt);(ft.getDay()===0?7:ft.getDay())===me._day&&Xe++}return Ae.size<Xe}catch{return!0}});return Z.length===0?a.jsxs("div",{className:"text-center py-8 text-slate-600",children:[a.jsx(Hf,{className:"w-12 h-12 text-green-500 mx-auto mb-2"}),a.jsx("p",{className:"font-medium",children:"All assignments are fully marked for this month!"})]}):Z.map(me=>{var Ee;const Te=me.id?String(me.id):`${me._day}_${me.period_id}_${me.section_id}`,Ae=se[Te],Be=Ae?Ae.size:0;return a.jsxs("label",{className:"flex items-start gap-3 p-2 hover:bg-white rounded-lg transition-colors cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:!!j[Te],onChange:()=>A(ze=>({...ze,[Te]:!ze[Te]})),className:"w-4 h-4 text-indigo-600 border-slate-300 rounded focus:ring-indigo-500 mt-0.5"}),a.jsxs("div",{className:"flex-1 text-sm",children:[a.jsxs("div",{className:"font-medium text-slate-900",children:[me.label||`Period ${me.period_index}`,"  ",["Mon","Tue","Wed","Thu","Fri","Sat"][me._day-1]||`Day ${me._day}`,me.start_time?` ${me.start_time}${me.end_time?" - "+me.end_time:""}`:""]}),a.jsxs("div",{className:"text-xs text-slate-600 mt-0.5",children:[me.section_name||((Ee=me.section)==null?void 0:Ee.name)||(me.section_id?`Section ${me.section_id}`:""),"  ",me.subject_display||me.subject_text||"",Be>0&&a.jsxs("span",{className:"ml-2 text-green-600 font-medium",children:["(",Be," day",Be!==1?"s":""," marked)"]})]})]})]},Te)})})()})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-900 mb-3",children:"Dates (month view for selected assignments)"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(()=>{try{const[Z,me]=v.split("-").map(Xe=>parseInt(Xe)),Te=new Date(Z,me,0),Ae=new Set;for(const Xe of S){const Pt=Xe.id?String(Xe.id):`${Xe._day}_${Xe.period_id}_${Xe.section_id}`;j[Pt]&&Ae.add(Xe._day)}const Be=[];for(let Xe=1;Xe<=Te.getDate();Xe++){const Pt=new Date(Z,me-1,Xe),ft=Pt.getDay()===0?7:Pt.getDay();Ae.size>0&&Ae.has(ft)&&Be.push(Pt.toISOString().slice(0,10))}const Ee=Object.keys(j).filter(Xe=>j[Xe]),ze=Be.filter(Xe=>Ee.length===0?!0:Ee.some(Pt=>{const ft=se[Pt];return!ft||!ft.has(Xe)}));return ze.length===0&&Ee.length>0?a.jsxs("div",{className:"text-center py-4 text-slate-600",children:[a.jsx(Hf,{className:"w-8 h-8 text-green-500 mx-auto mb-2"}),a.jsx("p",{className:"text-sm",children:"All dates are already marked for selected assignments"})]}):ze.map(Xe=>{const Pt=Ee.filter(ft=>{const He=se[ft];return He&&He.has(Xe)}).length;return a.jsxs("label",{className:"inline-flex items-center gap-2 px-3 py-1.5 border border-slate-300 rounded-lg text-sm hover:bg-slate-100 cursor-pointer transition-colors",children:[a.jsx("input",{type:"checkbox",checked:!!T[Xe],onChange:()=>B(ft=>({...ft,[Xe]:!ft[Xe]})),className:"w-4 h-4 text-indigo-600 border-slate-300 rounded focus:ring-indigo-500"}),a.jsxs("span",{children:[Xe,Pt>0&&Ee.length>1&&a.jsxs("span",{className:"ml-1 text-xs text-amber-600",children:["(",Pt,"/",Ee.length," marked)"]})]})]},Xe)})}catch{return a.jsx("div",{})}})()})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-slate-900 mb-3",children:["Students (derived from selected assignments)",a.jsxs("span",{className:"ml-2 text-sm text-slate-600",children:["(",L.length," student",L.length!==1?"s":"",")"]})]}),a.jsxs("div",{className:"border border-slate-200 rounded-lg p-4 max-h-64 overflow-y-auto bg-slate-50",children:[F&&a.jsxs("div",{className:"flex items-center justify-center py-8 text-slate-600",children:[a.jsx(Yu,{className:"w-6 h-6 animate-spin mr-2"}),"Loading students..."]}),!F&&L.length===0&&a.jsx("div",{className:"text-center py-8 text-slate-600",children:"No students for selected assignments"}),!F&&L.length>0&&a.jsx("div",{className:"space-y-1",children:L.map(Z=>a.jsxs("label",{className:"flex items-center gap-2 p-2 hover:bg-white rounded-lg transition-colors cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:!!q[Z.id],onChange:me=>U(Te=>({...Te,[Z.id]:!Te[Z.id]})),className:"w-4 h-4 text-indigo-600 border-slate-300 rounded focus:ring-indigo-500"}),a.jsxs("span",{className:"text-sm text-slate-900",children:[Z.reg_no,"  ",Z.username]})]},Z.id))})]})]})]}),a.jsxs("div",{className:"sticky bottom-0 bg-white border-t border-slate-200 px-6 py-4 flex gap-3 rounded-b-xl",children:[a.jsxs("button",{onClick:async()=>{var Ae,Be,Ee,ze;const Z=Object.keys(T).filter(Xe=>T[Xe]);if(!Z.length){alert("Select at least one date");return}const me=[];for(const Xe of S){const Pt=Xe.id?String(Xe.id):`${Xe._day}_${Xe.period_id}_${((Ae=Xe.section)==null?void 0:Ae.id)||Xe.section_id}`;if(!j[Pt])continue;const ft=Xe.section_id||Xe.section&&(Xe.section.id||Xe.section.pk)||((Be=Xe.section)==null?void 0:Be.pk)||((Ee=Xe.section)==null?void 0:Ee.id),He=Xe.period_id||Xe.period&&(Xe.period.id||Xe.period_id)||((ze=Xe.period)==null?void 0:ze.id)||Xe.period_id,tt=Number(ft),_e=Number(He);!Number.isFinite(tt)||!Number.isFinite(_e)||me.push({section_id:tt,period_id:_e})}const Te=Object.keys(q).filter(Xe=>q[Number(Xe)]).map(Xe=>Number(Xe));if(!me.length){alert("No assignments selected");return}if(!Te.length){alert("No students selected");return}try{const Xe=await xr("/api/academics/period-attendance/bulk-mark/",{method:"POST",body:JSON.stringify({assignments:me,dates:Z,student_ids:Te})});if(!Xe.ok){let Pt="Failed";try{const ft=await Xe.json();Pt=JSON.stringify(ft)}catch{try{Pt=await Xe.text()}catch{}}alert("Failed: "+Pt);return}alert("Bulk attendance saved"),b(!1)}catch(Xe){console.error("bulk save",Xe),alert("Failed to save bulk attendance")}},className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors flex items-center gap-2",children:[a.jsx(id,{className:"w-4 h-4"}),"Save Bulk"]}),a.jsx("button",{onClick:()=>b(!1),className:"px-4 py-2 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-lg font-medium transition-colors",children:"Close"})]})]})}),z&&ie&&C&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md shadow-2xl",children:[a.jsx("div",{className:"bg-gradient-to-br from-amber-500 to-orange-600 px-6 py-4 rounded-t-xl",children:a.jsxs("div",{className:"flex items-center gap-3 text-white",children:[a.jsx(rd,{className:"w-6 h-6"}),a.jsx("h3",{className:"text-xl font-bold",children:"Consecutive Periods Detected"})]})}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:[a.jsxs("p",{className:"text-sm text-slate-700 mb-3",children:["The same subject has consecutive periods",Math.abs(C.period.index-ie.period.index)>1?" (with break/lunch in between)":"",":"]}),a.jsxs("div",{className:"space-y-2 mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-600"}),a.jsx("span",{className:"font-semibold text-slate-900",children:ie.period.label||`Period ${ie.period.index}`}),a.jsxs("span",{className:"text-slate-600",children:["(",ie.period.start_time," - ",ie.period.end_time,")"]})]}),Math.abs(C.period.index-ie.period.index)>1&&a.jsx("div",{className:"flex items-center gap-2 text-sm pl-4",children:a.jsxs("span",{className:"text-slate-500 italic",children:[" ",Math.abs(C.period.index-ie.period.index)-1," period(s) in between (break/lunch)"]})}),a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-600"}),a.jsx("span",{className:"font-semibold text-slate-900",children:C.period.label||`Period ${C.period.index}`}),a.jsxs("span",{className:"text-slate-600",children:["(",C.period.start_time," - ",C.period.end_time,")"]})]})]}),a.jsxs("p",{className:"text-sm font-medium text-slate-900",children:["Subject: ",a.jsx("span",{className:"text-indigo-600",children:ie.subject||ie.subject_display||"Same Subject"})]})]}),a.jsx("p",{className:"text-sm text-slate-600",children:"Would you like to mark attendance for both periods at once (all students Present), or just the selected period?"})]}),a.jsxs("div",{className:"px-6 pb-6 flex flex-col gap-3",children:[a.jsxs("button",{onClick:oe,className:"w-full px-4 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors flex items-center justify-center gap-2",children:[a.jsx(Hf,{className:"w-5 h-5"}),"Mark Both Periods (All Present)"]}),a.jsx("button",{onClick:O,className:"w-full px-4 py-3 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-lg font-medium transition-colors",children:"Single Period Only"}),a.jsx("button",{onClick:()=>{G(!1),Y(null),K(null)},className:"w-full px-4 py-2 text-slate-600 hover:text-slate-800 text-sm font-medium transition-colors",children:"Cancel"})]})]})})]})}const GOe=()=>{const[e,t]=x.useState(!1),[r,n]=x.useState(null),[i,s]=x.useState(!1),[o,l]=x.useState([]),[c,u]=x.useState(!1),[d,f]=x.useState([]),[h,p]=x.useState(null),[m,g]=x.useState("overall"),[y,b]=x.useState(!1),[v,w]=x.useState(null),[S,k]=x.useState([]),[j,A]=x.useState([]),[L,P]=x.useState(null),[F,E]=x.useState({}),[T,B]=x.useState(!1);x.useEffect(()=>{U()},[]),x.useEffect(()=>{se()},[]),x.useEffect(()=>{de()},[]),x.useEffect(()=>{q()},[]),x.useEffect(()=>{h&&(h==="all"||h==="department"?g("overall"):h==="class"&&g("assigned"))},[h]);async function q(){try{const Y=await xr("/api/academics/analytics/filters/");if(!Y.ok)return p(null);const C=await Y.json().catch(()=>null);p((C==null?void 0:C.permission_level)||null),k((C==null?void 0:C.departments)||[]),A((C==null?void 0:C.sections)||[]),((C==null?void 0:C.departments)||[]).length>0&&P((C.departments[0]||{}).id||null)}catch(Y){console.error("Failed to load analytics filters",Y),p(null)}}async function U(){t(!0);try{const Y=await xr("/api/academics/analytics/today-periods/"),C=await Y.json().catch(()=>null);Y.ok?n(C):n(null)}catch(Y){console.error("Failed to load today periods",Y),n(null)}finally{t(!1)}}async function se(){s(!0);try{const Y=new Date().toISOString().split("T")[0],C=await xr(`/api/academics/staff/periods/?date=${Y}`),K=await C.json().catch(()=>({results:[]}));C.ok?l(K.results||[]):l([])}catch(Y){console.error("Failed to load assigned periods",Y),l([])}finally{s(!1)}}async function de(){u(!0);try{const Y=new Date().toISOString().split("T")[0],C=await xr(`/api/academics/analytics/overall-section/?date=${Y}`);if(!C.ok){f([]),u(!1);return}const K=await C.json().catch(()=>({sections:[]}));f(K.sections||[])}catch(Y){console.error("Failed to load overall sections",Y),f([])}finally{u(!1)}}async function z(Y){if(!Y)return;B(!0);const C=new Date().toISOString().split("T")[0],K=j.filter(R=>String(R.batch__course__department__id)===String(Y)),H={};try{await Promise.all(K.map(async R=>{try{const J=await xr(`/api/academics/analytics/class-report/?section_id=${R.id}&date=${C}&period_index=1`);if(!J.ok)return;const V=await J.json().catch(()=>null);V&&(H[R.id]=V)}catch{}})),E(R=>({...R,...H}))}finally{B(!1)}}const G=async Y=>{if(!Y)return alert("No session available");if(confirm("Request unlock for this session?"))try{const C=await xr("/api/academics/attendance-unlock-requests/",{method:"POST",body:JSON.stringify({session:Y,note:""})});if(!C.ok){const K=await C.json().catch(()=>({}));C.status===400&&K.detail&&String(K.detail).includes("already pending")?alert("An unlock request for this session is already pending."):alert("Failed to create unlock request: "+(K.detail||C.status));return}alert("Unlock request submitted successfully")}catch(C){console.error(C),alert("Failed to submit request")}};async function ie(Y){if(Y){b(!0),w(null);try{const C=new Date().toISOString().split("T")[0],K=await xr(`/api/academics/analytics/class-report/?section_id=${Y}&date=${C}`);if(!K.ok){const R=await K.json().catch(()=>({}));alert("Failed to load section report: "+(R.detail||K.status)),b(!1);return}const H=await K.json().catch(()=>null);w(H),g("section")}catch(C){console.error("Failed to load section report",C),alert("Failed to load section report")}finally{b(!1)}}}return a.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Attendance Unlock Requests"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Request unlock for a locked attendance session from the list below."})]}),e&&a.jsx("div",{className:"py-6 text-gray-600",children:"Loading today's periods"}),a.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[(h==="all"||h==="department")&&a.jsx("button",{onClick:()=>g("overall"),className:`px-3 py-1 rounded ${m==="overall"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700"}`,children:"Overall"}),a.jsx("button",{onClick:()=>g("assigned"),className:`px-3 py-1 rounded ${m==="assigned"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700"}`,children:"My Assigned"})]}),m==="overall"&&!c&&a.jsx("div",{className:"mb-6 bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"text-sm text-gray-700",children:"Overall sections (permissioned)"}),S&&S.length>0&&a.jsxs("select",{value:L??"",onChange:Y=>{const C=Y.target.value,K=C?Number(C):null;P(K),K&&z(K)},className:"px-2 py-1 border rounded",children:[a.jsx("option",{value:"",children:"-- Select department --"}),S.map(Y=>a.jsx("option",{value:Y.id,children:Y.short_name||Y.name},Y.id))]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:de,className:"flex items-center gap-2 px-3 py-1 text-sm bg-gray-100 rounded hover:bg-gray-200",children:[a.jsx(T2,{className:"w-4 h-4"})," Refresh"]}),L&&a.jsx("button",{onClick:()=>L&&z(L),className:"flex items-center gap-2 px-3 py-1 text-sm bg-gray-100 rounded hover:bg-gray-200",children:"Load Dept Sections"})]})]}),a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Section"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Present"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Absent"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"OD"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Total"}),a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Status"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Action"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:L?j.filter(Y=>String(Y.batch__course__department__id)===String(L)).map(Y=>{const C=F[Y.id];return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:Y.name}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-green-600 font-semibold",children:(C==null?void 0:C.present)??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-red-600 font-semibold",children:(C==null?void 0:C.absent)??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-600",children:(C==null?void 0:C.on_duty)??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-900",children:(C==null?void 0:C.total_strength)??"-"}),a.jsx("td",{className:"px-4 py-3 text-sm",children:C!=null&&C.is_locked?a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-red-100 text-red-700",children:[a.jsx(i0,{className:"w-3 h-3 mr-1"}),"Locked"]}):C!=null&&C.total_marked?a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-50 text-green-700",children:"Saved"}):a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-50 text-gray-700",children:"Not saved"})}),a.jsx("td",{className:"px-4 py-3 text-right",children:a.jsx("button",{onClick:()=>ie(Y.id),className:"px-3 py-1 rounded text-sm bg-gray-100 text-gray-700 hover:bg-gray-200",children:"View"})})]},Y.id)}):d.map(Y=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:(Y.department_short||Y.department_name?`${Y.department_short||Y.department_name} - `:"")+(Y.section_name||"")}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-green-600 font-semibold",children:Y.present??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-red-600 font-semibold",children:Y.absent??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-600",children:Y.on_duty??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-900",children:Y.total_strength??"-"}),a.jsx("td",{className:"px-4 py-3 text-sm",children:Y.is_locked?a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-red-100 text-red-700",children:[a.jsx(i0,{className:"w-3 h-3 mr-1"}),"Locked"]}):Y.marked_at?a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-50 text-green-700",children:"Saved"}):a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-50 text-gray-700",children:"Not saved"})}),a.jsx("td",{className:"px-4 py-3 text-right",children:a.jsx("button",{onClick:()=>ie(Y.section_id),className:"px-3 py-1 rounded text-sm bg-gray-100 text-gray-700 hover:bg-gray-200",children:"View"})})]},Y.section_id))})]})]})}),m==="section"&&v&&a.jsxs("div",{className:"mb-6 bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-lg font-medium",children:v.section_name}),a.jsxs("div",{className:"text-sm text-gray-600",children:["Date: ",v.date]})]}),a.jsx("div",{children:a.jsx("button",{onClick:()=>g("overall"),className:"px-3 py-1 rounded bg-gray-100",children:"Back"})})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:["Present",a.jsx("br",{}),a.jsx("strong",{className:"text-2xl",children:v.present})]}),a.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:["Absent",a.jsx("br",{}),a.jsx("strong",{className:"text-2xl",children:v.absent})]}),a.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:["OD",a.jsx("br",{}),a.jsx("strong",{className:"text-2xl",children:v.on_duty})]})]})]}),!i&&o&&o.length>0&&a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("div",{className:"text-sm text-gray-700"}),a.jsxs("button",{onClick:se,className:"flex items-center gap-2 px-3 py-1 text-sm bg-gray-100 rounded hover:bg-gray-200",children:[a.jsx(T2,{className:"w-4 h-4"})," Refresh"]})]}),a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Period"}),a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Subject"}),a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Section"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Present"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Absent"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"OD"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Total"}),a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Status"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Action"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(Y=>{var C,K;return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:((C=Y.period)==null?void 0:C.label)||((K=Y.period)==null?void 0:K.index)||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:Y.subject_display||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:Y.section_name||"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-green-600 font-semibold",children:Y.present??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-red-600 font-semibold",children:Y.absent??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-600",children:Y.on_duty??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-900",children:Y.total_strength??"-"}),a.jsx("td",{className:"px-4 py-3 text-sm",children:Y.attendance_session_locked?a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-red-100 text-red-700",children:[a.jsx(i0,{className:"w-3 h-3 mr-1"}),"Locked"]}):Y.present!==null?a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-50 text-green-700",children:"Saved"}):a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-50 text-gray-700",children:"Not saved"})}),a.jsx("td",{className:"px-4 py-3 text-right",children:a.jsx("button",{onClick:()=>{var H;return G(Y.attendance_session_id||((H=Y.attendance_session)==null?void 0:H.id)||Y.session_id)},className:`px-3 py-1 rounded text-sm ${Y.attendance_session_locked?"bg-indigo-600 text-white hover:bg-indigo-700":"bg-gray-100 text-gray-600 cursor-not-allowed"}`,disabled:!Y.attendance_session_locked,children:"Request Unlock"})})]},Y.id||Y.session_id)})})]})]})}),!e&&(!r||r.periods.length===0)&&a.jsx("div",{className:"text-gray-600 py-6",children:"No periods available for today."})]})};function KOe(){const[e,t]=x.useState(""),[r,n]=x.useState(""),[i,s]=x.useState([]),[o,l]=x.useState(null),[c,u]=x.useState(!1);x.useEffect(()=>{const p=new Date,m=p.toISOString().slice(0,10),g=new Date(p.getTime()-1e3*60*60*24*30).toISOString().slice(0,10);t(g),n(m)},[]),x.useEffect(()=>{e&&r&&d()},[e,r]);async function d(){u(!0);try{const p=`?start_date=${e}&end_date=${r}`;console.log("Fetching student attendance:",{startDate:e,endDate:r,url:`/api/academics/student/attendance/${p}`});const m=await xr(`/api/academics/student/attendance/${p}`);if(!m.ok){const y=await m.text();throw console.error("Failed to fetch attendance:",m.status,y),new Error(`Failed to fetch (${m.status})`)}const g=await m.json();console.log("Student attendance response:",{recordCount:(g.results||[]).length,summary:g.summary,records:g.results}),s(g.results||[]),l(g.summary||null)}catch(p){console.error("fetchRecords error:",p),s([]),alert("Failed to load attendance records: "+(p instanceof Error?p.message:String(p)))}finally{u(!1)}}function f(p){switch(p){case"P":return"bg-green-100 text-green-800 border-green-200";case"A":return"bg-red-100 text-red-800 border-red-200";case"LEAVE":return"bg-blue-100 text-blue-800 border-blue-200";case"OD":return"bg-purple-100 text-purple-800 border-purple-200";case"LATE":return"bg-amber-100 text-amber-800 border-amber-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}}function h(p){switch(p){case"P":return a.jsx(Hf,{className:"h-3.5 w-3.5"});case"A":return a.jsx(y3,{className:"h-3.5 w-3.5"});default:return a.jsx(rd,{className:"h-3.5 w-3.5"})}}return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6 border border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl",children:a.jsx(Hf,{className:"h-6 w-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Attendance"}),a.jsx("p",{className:"text-gray-600",children:"View your attendance records and statistics"})]})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6 border border-gray-100",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(ys,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Select Date Range"})]}),a.jsxs("div",{className:"flex flex-wrap items-end gap-4",children:[a.jsxs("div",{className:"flex-1 min-w-[200px]",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"From Date"}),a.jsx("input",{type:"date",value:e,onChange:p=>t(p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),a.jsxs("div",{className:"flex-1 min-w-[200px]",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"To Date"}),a.jsx("input",{type:"date",value:r,onChange:p=>n(p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),a.jsx("button",{onClick:d,disabled:c,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:bg-indigo-300 transition-colors font-medium flex items-center gap-2",children:c?a.jsxs(a.Fragment,{children:[a.jsx(Yu,{className:"h-4 w-4 animate-spin"}),"Loading..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ys,{className:"h-4 w-4"}),"Refresh"]})})]}),!c&&i.length>0&&a.jsxs("div",{className:"mt-3 text-sm text-gray-600 flex items-center gap-2",children:[a.jsx(Hf,{className:"h-4 w-4 text-green-600"}),"Showing ",i.length," attendance record",i.length!==1?"s":""," from ",e," to ",r]})]}),c?a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-8 border border-gray-100",children:a.jsx("div",{className:"text-center",children:a.jsxs("div",{className:"inline-flex items-center gap-2 text-gray-600",children:[a.jsx(Yu,{className:"animate-spin h-5 w-5 text-indigo-600"}),a.jsx("span",{children:"Loading attendance records..."})]})})}):a.jsx("div",{children:i.length===0?a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-8 border border-gray-100",children:a.jsxs("div",{className:"text-center",children:[a.jsx(rd,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Records Found"}),a.jsx("p",{className:"text-gray-600",children:"No attendance records found for the selected date range."})]})}):a.jsxs("div",{className:"space-y-6",children:[o&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(Rte,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Overall Attendance"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg p-4 border border-green-200",children:[a.jsx("div",{className:"text-sm text-green-700 font-medium mb-1",children:"Attendance Rate"}),a.jsx("div",{className:"text-3xl font-bold text-green-900",children:o.overall.percentage!=null?`${o.overall.percentage.toFixed(1)}%`:"N/A"})]}),a.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg p-4 border border-blue-200",children:[a.jsx("div",{className:"text-sm text-blue-700 font-medium mb-1",children:"Present"}),a.jsx("div",{className:"text-3xl font-bold text-blue-900",children:o.overall.present})]}),a.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg p-4 border border-purple-200",children:[a.jsx("div",{className:"text-sm text-purple-700 font-medium mb-1",children:"Total Periods"}),a.jsx("div",{className:"text-3xl font-bold text-purple-900",children:o.overall.total_marked_periods})]})]})]}),o&&o.by_subject&&o.by_subject.length>0&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(gs,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Subject-wise Breakdown"})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.by_subject.map(p=>{const m=p.percentage!=null?p.percentage:0,g=p.counts||{};return a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[a.jsxs("div",{className:"flex justify-between items-start mb-3",children:[a.jsx("div",{className:"font-semibold text-gray-900",children:p.subject_display||p.subject_key}),a.jsx("div",{className:"text-lg font-bold text-indigo-600",children:m!=null?`${m.toFixed(1)}%`:"N/A"})]}),a.jsx("div",{className:"h-2.5 bg-gray-200 rounded-full overflow-hidden mb-3",children:a.jsx("div",{className:`h-full transition-all ${m>=75?"bg-green-500":m>=50?"bg-amber-500":"bg-red-500"}`,style:{width:`${Math.max(0,Math.min(100,m))}%`}})}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded border border-green-200",children:["P: ",g.P||0]}),a.jsxs("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs font-medium rounded border border-red-200",children:["A: ",g.A||0]}),a.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded border border-blue-200",children:["LEAVE: ",g.LEAVE||0]}),a.jsxs("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs font-medium rounded border border-purple-200",children:["OD: ",g.OD||0]}),a.jsxs("span",{className:"px-2 py-1 bg-amber-100 text-amber-800 text-xs font-medium rounded border border-amber-200",children:["LATE: ",g.LATE||0]})]})]},p.subject_key)})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sc,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Attendance Records"})]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Date"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Period"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Section"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Subject"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Status"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Marked By"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:i.map(p=>{var m,g,y;return a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ys,{className:"h-4 w-4 text-gray-400"}),p.date]})}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:((m=p.period)==null?void 0:m.label)||((g=p.period)!=null&&g.index?`Period ${p.period.index}`:"")}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:((y=p.section)==null?void 0:y.name)||""}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 font-medium",children:p.subject_display||""}),a.jsx("td",{className:"px-6 py-4 text-sm",children:a.jsxs("span",{className:`inline-flex items-center gap-1 px-2.5 py-1 rounded-md text-xs font-medium border ${f(p.status)}`,children:[h(p.status),p.status]})}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(W0,{className:"h-3.5 w-3.5 text-gray-400"}),p.marked_by||""]})})]},p.id)})})]})})]})]})})]})})}const kg="";async function YOe(){const e=await xr(`${kg}/api/academics/mentor/staff/`);return e.ok?e.json():{results:[]}}async function XOe(e){const t=await xr(`${kg}/api/academics/mentor/staff/${e}/students/`);return t.ok?t.json():{results:[]}}async function QOe(e,t){return await xr(`${kg}/api/academics/mentor/map/`,{method:"POST",body:JSON.stringify({mentor_id:e,student_ids:t})})}async function tB(){const e=await xr(`${kg}/api/academics/my-students/`);return e.ok?e.json():{results:[]}}async function JOe(e,t){const r={student_ids:[e]};return t&&(r.mentor_id=t),await xr(`${kg}/api/academics/mentor/unmap/`,{method:"POST",body:JSON.stringify(r)})}async function ZOe(){const e=await xr(`${kg}/api/academics/mentor/my-mentees/`);return e.ok?e.json():{results:[]}}function eMe(){const[e,t]=x.useState([]),[r,n]=x.useState(null),[i,s]=x.useState([]),[o,l]=x.useState([]),[c,u]=x.useState(!1);x.useEffect(()=>{d()},[]);async function d(){const y=await YOe();t(y.results||[])}async function f(){const b=(await tB()).results||[],v=[];b.forEach(w=>{(w.students||[]).forEach(k=>v.push(k))}),s(v)}async function h(y){n(y),l([]),s([]);const v=(await XOe(y)).results||[],S=(await tB()).results||[],k=[];S.forEach(L=>{(L.students||[]).forEach(F=>k.push(F))});const j=new Set(v.map(L=>L.id)),A=k.filter(L=>!j.has(L.id)&&!L.has_mentor);l(v),s(A)}async function p(y){if(!r)return alert("Select a mentor first");u(!0);const b=await QOe(r,[y]);if(b.ok)await f(),r&&await h(r);else{const v=await b.json().catch(()=>null);alert("Failed: "+(v&&v.detail?v.detail:b.statusText))}u(!1)}async function m(y){if(!r)return;u(!0);const b=await JOe(y,r);if(b.ok)await f(),r&&await h(r);else{const v=await b.json().catch(()=>null);alert("Failed to remove: "+(v&&v.detail?v.detail:b.statusText))}u(!1)}const g=e.find(y=>y.id===r);return a.jsxs("div",{className:"min-h-screen p-4 md:p-6 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-6 border border-slate-200",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 p-3 rounded-xl shadow-lg",children:a.jsx($v,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Mentor Assignment"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"Assign and manage mentor mappings for your students"})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6",children:[a.jsx("div",{className:"lg:col-span-2",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[a.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-slate-50",children:a.jsxs("h3",{className:"text-lg font-semibold text-slate-900 flex items-center gap-2",children:[a.jsx(bs,{className:"w-5 h-5 text-indigo-600"}),"Staff Members",a.jsx("span",{className:"ml-auto px-2.5 py-0.5 bg-indigo-100 text-indigo-700 text-xs font-medium rounded-full",children:e.length})]})}),a.jsx("div",{className:"p-4 max-h-[600px] overflow-y-auto",children:e.length===0?a.jsx("div",{className:"text-center py-8 text-slate-500",children:"No staff members available"}):a.jsx("div",{className:"space-y-2",children:e.map(y=>a.jsx("div",{className:`p-4 rounded-lg border transition-all cursor-pointer ${r===y.id?"bg-gradient-to-r from-indigo-50 to-blue-50 border-indigo-300 shadow-md":"bg-white border-slate-200 hover:border-indigo-200 hover:shadow-sm"}`,onClick:()=>h(y.id),children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:`font-medium ${r===y.id?"text-indigo-900":"text-slate-900"}`,children:y.username}),a.jsx("div",{className:"text-sm text-slate-600 mt-1",children:a.jsx("span",{className:"font-mono",children:y.staff_id||"N/A"})})]}),a.jsxs("button",{onClick:b=>{b.stopPropagation(),h(y.id)},className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5 ${r===y.id?"bg-indigo-600 text-white":"bg-indigo-100 text-indigo-700 hover:bg-indigo-200"}`,children:[a.jsx(r9,{className:"w-4 h-4"}),"View"]})]})},y.id))})})]})}),a.jsx("div",{className:"lg:col-span-3",children:r?a.jsxs("div",{className:"space-y-6",children:[g&&a.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl p-4 shadow-lg",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx($v,{className:"w-6 h-6"}),a.jsxs("div",{children:[a.jsxs("div",{className:"font-semibold",children:["Selected Mentor: ",g.username]}),a.jsxs("div",{className:"text-sm opacity-90",children:["Staff ID: ",g.staff_id||"N/A"]})]})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[a.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-green-50",children:a.jsxs("h4",{className:"text-base font-semibold text-green-900 flex items-center gap-2",children:[a.jsx(Z1,{className:"w-5 h-5 text-green-700"}),"Assigned Students",a.jsx("span",{className:"ml-auto px-2.5 py-0.5 bg-green-200 text-green-800 text-xs font-medium rounded-full",children:o.length})]})}),a.jsx("div",{className:"p-4 max-h-[300px] overflow-y-auto",children:o.length>0?a.jsx("div",{className:"space-y-2",children:o.map(y=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg hover:bg-slate-100 transition-colors",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"text-sm font-medium text-slate-900",children:[y.reg_no,"  ",y.username]}),a.jsx("div",{className:"text-xs text-slate-600 mt-0.5",children:y.section_name})]}),a.jsxs("button",{className:"px-3 py-1.5 bg-red-600 hover:bg-red-700 disabled:bg-red-300 text-white rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5",onClick:()=>m(y.id),disabled:c,children:[a.jsx(Ute,{className:"w-4 h-4"}),"Remove"]})]},y.id))}):a.jsx("div",{className:"text-center py-8 text-slate-500",children:"No students currently assigned to this mentor"})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[a.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-blue-50",children:a.jsxs("h4",{className:"text-base font-semibold text-blue-900 flex items-center gap-2",children:[a.jsx(bs,{className:"w-5 h-5 text-blue-700"}),"Available to Assign",a.jsx("span",{className:"ml-auto px-2.5 py-0.5 bg-blue-200 text-blue-800 text-xs font-medium rounded-full",children:i.length})]})}),a.jsx("div",{className:"p-4 max-h-[300px] overflow-y-auto",children:i.length>0?a.jsx("div",{className:"space-y-2",children:i.map(y=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg hover:bg-slate-100 transition-colors",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"text-sm font-medium text-slate-900",children:[y.reg_no,"  ",y.username]}),a.jsx("div",{className:"text-xs text-slate-600 mt-0.5",children:y.section_name})]}),a.jsxs("button",{className:"px-3 py-1.5 bg-green-600 hover:bg-green-700 disabled:bg-green-300 text-white rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5",onClick:()=>p(y.id),disabled:c||!r,children:[c?a.jsx(Yu,{className:"w-4 h-4 animate-spin"}):a.jsx(Dte,{className:"w-4 h-4"}),"Assign"]})]},y.id))}):a.jsx("div",{className:"text-center py-8 text-slate-500",children:"No available students to assign"})})]})]}):a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-12",children:a.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[a.jsx("div",{className:"bg-slate-100 p-4 rounded-full mb-4",children:a.jsx($v,{className:"w-16 h-16 text-slate-400"})}),a.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-1",children:"Select a Staff Member"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"Click on a staff member to view and manage their mentee assignments"})]})})})]})]})}function tMe(){const[e,t]=x.useState([]),[r,n]=x.useState(!1);x.useEffect(()=>{i()},[]);async function i(){n(!0);try{const s=await ZOe();t(s.results||[])}catch(s){console.error(s),alert("Failed to load mentees")}finally{n(!1)}}return a.jsxs("div",{className:"min-h-screen p-4 md:p-6 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-6 border border-slate-200",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 p-3 rounded-xl shadow-lg",children:a.jsx(bs,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"My Mentees"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"Students assigned to you as mentor"})]})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[a.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-slate-50",children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("h2",{className:"text-lg font-semibold text-slate-900 flex items-center gap-2",children:[a.jsx($v,{className:"w-5 h-5 text-indigo-600"}),"Mentees List",!r&&e.length>0&&a.jsx("span",{className:"ml-2 px-2.5 py-0.5 bg-indigo-100 text-indigo-700 text-xs font-medium rounded-full",children:e.length})]})})}),a.jsxs("div",{className:"p-6",children:[r&&a.jsxs("div",{className:"flex items-center justify-center py-12",children:[a.jsx(Yu,{className:"w-8 h-8 text-indigo-600 animate-spin"}),a.jsx("span",{className:"ml-3 text-slate-600",children:"Loading mentees..."})]}),!r&&e.length===0&&a.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[a.jsx("div",{className:"bg-slate-100 p-4 rounded-full mb-4",children:a.jsx(bs,{className:"w-12 h-12 text-slate-400"})}),a.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-1",children:"No Mentees Assigned"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"You don't have any students assigned as mentees yet."})]}),!r&&e.length>0&&a.jsx("div",{children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-slate-200",children:[a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Reg No"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Name"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Section"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-200",children:e.map(s=>a.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"text-sm font-medium text-slate-900",children:s.reg_no})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"text-sm text-slate-700",children:s.username})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-md text-xs font-medium bg-blue-100 text-blue-800",children:s.section_name||"N/A"})})]},s.id))})]})})]})]})]})}async function rMe(){var t;return((t=(await rl.get("notification-templates/")).data)==null?void 0:t.templates)||[]}async function nMe(e){return(await rl.put("notification-templates/",{templates:e})).data}const kv=[{label:"{otp}",value:"{otp}",description:"Auto-generated OTP code",category:"auth"},{label:"{username}",value:"{username}",description:"User's username",category:"user"},{label:"{email}",value:"{email}",description:"User's email",category:"user"},{label:"{mobile}",value:"{mobile}",description:"Mobile number",category:"user"},{label:"{name}",value:"{name}",description:"Full name",category:"user"},{label:"{expiry}",value:"{expiry}",description:"OTP/time expiry",category:"time"},{label:"{subject}",value:"{subject}",description:"Subject/course name",category:"academic"},{label:"{assessment}",value:"{assessment}",description:"Assessment type (CIA1, CIA2, etc.)",category:"academic"},{label:"{percentage}",value:"{percentage}",description:"Percentage value",category:"academic"},{label:"{time}",value:"{time}",description:"Timestamp",category:"time"},{label:"{date}",value:"{date}",description:"Date",category:"time"}],jj=[{id:"mobile_verify",name:"Mobile Number Verification OTP",template:"Your OTP is {otp}. It is valid for {expiry} minutes. - IQAC",enabled:!0,expiry_minutes:5},{id:"password_reset",name:"Password Reset OTP",template:"Hello {username}, your password reset OTP is {otp}. Valid for {expiry} minutes. - IQAC",enabled:!1,expiry_minutes:10},{id:"login_alert",name:"Login Alert Notification",template:"Hello {name}, a login was detected on your account from a new device at {time}.",enabled:!1},{id:"obe_approval",name:"OBE Edit Request Approved",template:"Your OBE edit request for {subject} ({assessment}) has been approved. Edit until: {expiry}",enabled:!1},{id:"attendance_alert",name:"Low Attendance Alert",template:"Dear {name}, your attendance is {percentage}% in {subject}. Please improve to meet requirements.",enabled:!1}];function iMe(){const[e,t]=x.useState(jj),[r,n]=x.useState("mobile_verify"),[i,s]=x.useState(null),[o,l]=x.useState(!0),[c,u]=x.useState(null),d=e.find(S=>S.id===r),f=x.useMemo(()=>{const S=d==null?void 0:d.expiry_minutes;return typeof S=="number"&&Number.isFinite(S)&&S>0?String(S):"5"},[d]);x.useEffect(()=>{let S=!0;return l(!0),u(null),rMe().then(k=>{var j;if(S&&k&&k.length){const A=new Map(k.map(T=>[T.code,{id:T.code,name:T.name,template:T.template,enabled:!!T.enabled,expiry_minutes:T.expiry_minutes??null,updated_at:T.updated_at}])),L=jj.map(T=>A.get(T.id)||T),P=k.filter(T=>!jj.some(B=>B.id===T.code)).map(T=>A.get(T.code)).filter(Boolean),F=[...L,...P];t(F);const E=F.some(T=>T.id==="mobile_verify")?"mobile_verify":((j=F[0])==null?void 0:j.id)||null;n(E)}}).catch(k=>{var j,A;S&&u(String(((A=(j=k==null?void 0:k.response)==null?void 0:j.data)==null?void 0:A.detail)||(k==null?void 0:k.message)||k||"Failed to load templates"))}).finally(()=>{S&&l(!1)}),()=>{S=!1}},[]);const h=S=>{r&&t(k=>k.map(j=>j.id===r?{...j,template:j.template+" "+S}:j))},p=(S,k)=>{t(j=>j.map(A=>A.id===S?{...A,template:k}:A))},m=S=>{t(k=>k.map(j=>j.id===S?{...j,enabled:!j.enabled}:j))},g=async()=>{var S,k;s("saving");try{await nMe(e.map(j=>({code:j.id,name:j.name,template:j.template,enabled:!!j.enabled,expiry_minutes:j.expiry_minutes??null,updated_at:j.updated_at}))),s("saved"),setTimeout(()=>s(null),2e3)}catch(j){s("error"),setTimeout(()=>s(null),2500),alert(String(((k=(S=j==null?void 0:j.response)==null?void 0:S.data)==null?void 0:k.detail)||(j==null?void 0:j.message)||j||"Failed to save"))}},y=()=>{const S=`template_${Date.now()}`,k={id:S,name:"New Message Template",template:"Enter your message here...",enabled:!1,expiry_minutes:null};t(j=>[...j,k]),n(S)},b=S=>{var k;confirm("Are you sure you want to delete this template?")&&(t(j=>j.filter(A=>A.id!==S)),r===S&&n(((k=e[0])==null?void 0:k.id)||null))},v=(S,k)=>{t(j=>j.map(A=>A.id===S?{...A,name:k}:A))},w=(S,k)=>{const j=String(k??"").trim(),A=j===""?null:Number(j);t(L=>L.map(P=>P.id!==S?P:A===null?{...P,expiry_minutes:null}:!Number.isFinite(A)||A<=0?P:{...P,expiry_minutes:Math.floor(A)}))};return a.jsx(e0,{children:a.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[a.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Ax,{className:"w-8 h-8 text-blue-600"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Notification Templates"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Configure message templates for OTP, alerts, and notifications"})]})]}),a.jsxs("button",{onClick:y,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx(Mm,{className:"w-4 h-4"}),"Add Template"]})]}),c?a.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-800 rounded-lg p-3 text-sm",children:c}):null,a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[a.jsx("div",{className:"lg:col-span-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[a.jsx("div",{className:"bg-gray-50 px-4 py-3 border-b border-gray-200",children:a.jsx("h2",{className:"font-semibold text-gray-900",children:"Message Templates"})}),a.jsx("div",{className:"divide-y divide-gray-200",children:e.map(S=>a.jsx("div",{onClick:()=>n(S.id),className:`p-4 cursor-pointer transition-colors ${r===S.id?"bg-blue-50 border-l-4 border-blue-600":"hover:bg-gray-50"}`,children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-medium text-gray-900 truncate",children:S.name}),a.jsx("p",{className:"text-xs text-gray-500 mt-1 line-clamp-2",children:S.template})]}),a.jsx("div",{className:"ml-2 flex items-center gap-2",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded ${S.enabled?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"}`,children:S.enabled?"Active":"Inactive"})})]})},S.id))})]})}),a.jsx("div",{className:"lg:col-span-8",children:o?a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 text-gray-600",children:"Loading templates"}):d?a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[a.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("input",{type:"text",value:d.name,onChange:S=>v(d.id,S.target.value),className:"text-lg font-semibold text-gray-900 bg-transparent border-none focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 -mx-2"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>m(d.id),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${d.enabled?"bg-green-600 text-white hover:bg-green-700":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:d.enabled?"Enabled":"Disabled"}),a.jsx("button",{onClick:()=>b(d.id),className:"p-1.5 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Delete template",children:a.jsx(vu,{className:"w-5 h-5"})})]})]})}),a.jsxs("div",{className:"p-6 space-y-6",children:[d.template.includes("{expiry}")?a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-blue-900",children:"Validity Time"}),a.jsxs("div",{className:"text-xs text-blue-800",children:["Controls ","{expiry}"," and OTP expiry minutes."]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"number",min:1,value:String(d.expiry_minutes??""),onChange:S=>w(d.id,S.target.value),className:"w-24 px-3 py-2 border border-blue-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"5"}),a.jsx("span",{className:"text-sm text-blue-900",children:"minutes"})]})]})}):null,a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message Template"}),a.jsx("textarea",{value:d.template,onChange:S=>p(d.id,S.target.value),rows:6,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm",placeholder:"Enter your message template here..."}),a.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Use placeholders from the buttons below to insert dynamic values"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Insert Placeholders"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"User Information"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:kv.filter(S=>S.category==="user").map(S=>a.jsxs("button",{onClick:()=>h(S.value),className:"group relative px-3 py-2 bg-gray-50 hover:bg-blue-50 border border-gray-200 hover:border-blue-300 rounded-lg text-sm font-medium text-gray-700 hover:text-blue-700 transition-all text-left",title:S.description,children:[a.jsx("span",{className:"font-mono",children:S.label}),a.jsxs("div",{className:"hidden group-hover:block absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg whitespace-nowrap z-10",children:[S.description,a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})]})]},S.value))})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"Authentication"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:kv.filter(S=>S.category==="auth").map(S=>a.jsxs("button",{onClick:()=>h(S.value),className:"group relative px-3 py-2 bg-gray-50 hover:bg-blue-50 border border-gray-200 hover:border-blue-300 rounded-lg text-sm font-medium text-gray-700 hover:text-blue-700 transition-all text-left",title:S.description,children:[a.jsx("span",{className:"font-mono",children:S.label}),a.jsxs("div",{className:"hidden group-hover:block absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg whitespace-nowrap z-10",children:[S.description,a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})]})]},S.value))})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"Academic"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:kv.filter(S=>S.category==="academic").map(S=>a.jsxs("button",{onClick:()=>h(S.value),className:"group relative px-3 py-2 bg-gray-50 hover:bg-blue-50 border border-gray-200 hover:border-blue-300 rounded-lg text-sm font-medium text-gray-700 hover:text-blue-700 transition-all text-left",title:S.description,children:[a.jsx("span",{className:"font-mono",children:S.label}),a.jsxs("div",{className:"hidden group-hover:block absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg whitespace-nowrap z-10",children:[S.description,a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})]})]},S.value))})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"Date & Time"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:kv.filter(S=>S.category==="time").map(S=>a.jsxs("button",{onClick:()=>h(S.value),className:"group relative px-3 py-2 bg-gray-50 hover:bg-blue-50 border border-gray-200 hover:border-blue-300 rounded-lg text-sm font-medium text-gray-700 hover:text-blue-700 transition-all text-left",title:S.description,children:[a.jsx("span",{className:"font-mono",children:S.label}),a.jsxs("div",{className:"hidden group-hover:block absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg whitespace-nowrap z-10",children:[S.description,a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})]})]},S.value))})]})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Preview (valid for ",f," minutes)"]}),a.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:a.jsx("div",{className:"text-sm text-gray-700 font-mono whitespace-pre-wrap",children:d.template.replace(/{otp}/g,"123456").replace(/{username}/g,"john_doe").replace(/{email}/g,"john@example.com").replace(/{mobile}/g,"+91XXXXXXXXXX").replace(/{name}/g,"John Doe").replace(/{expiry}/g,f).replace(/{subject}/g,"Mathematics").replace(/{assessment}/g,"CIA1").replace(/{percentage}/g,"75").replace(/{time}/g,new Date().toLocaleTimeString()).replace(/{date}/g,new Date().toLocaleDateString())})}),a.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"This is how your message will look with sample data"})]}),a.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[a.jsx("div",{className:"text-sm text-gray-600",children:i==="saved"&&a.jsx("span",{className:"text-green-600 font-medium",children:" Template saved successfully"})}),a.jsxs("button",{onClick:g,disabled:i==="saving",className:"flex items-center gap-2 px-6 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[a.jsx(id,{className:"w-4 h-4"}),i==="saving"?"Saving...":"Save Template"]})]})]})]}):a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[a.jsx(Ax,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-500",children:"Select a template from the list or create a new one"})]})})]})]})})}function aMe(){const[e,t]=x.useState(null),[r,n]=x.useState(!0),{collapsed:i}=v3();return x.useEffect(()=>{b0().then(o=>{const l={...o,roles:Array.isArray(o.roles)?o.roles.map(c=>typeof c=="string"?c:c.name):[],permissions:Array.isArray(o.permissions)?o.permissions:[],profile_type:o.profile_type||null,profile:o.profile||null};t(l)}).catch(()=>t(null)).finally(()=>n(!1))},[]),r?a.jsx("div",{className:"flex justify-center items-center h-screen",children:a.jsx("p",{className:"text-gray-600",children:"Loading..."})}):((Array.isArray(e==null?void 0:e.permissions)?e==null?void 0:e.permissions:[]).map(o=>String(o||"").toLowerCase()),a.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-x-hidden",children:[a.jsx(i9,{user:e}),e?a.jsxs("div",{className:"flex",children:[a.jsx(bre,{}),a.jsx("main",{className:`flex-1 min-w-0 transition-all duration-300 pt-20 overflow-x-hidden ${i?"lg:pl-20":"lg:pl-64"}`,children:a.jsx("div",{className:"app-main-zoom",children:a.jsxs(b4,{children:[a.jsx(ii,{path:"/",element:a.jsx(Jp,{to:"/dashboard",replace:!0})}),a.jsx(ii,{path:"/dashboard",element:a.jsx(dOe,{})}),a.jsx(ii,{path:"/profile",element:a.jsx(hOe,{user:e})}),a.jsx(ii,{path:"/notifications",element:a.jsx(iMe,{})}),a.jsx(ii,{path:"/import/questions",element:a.jsx(_Oe,{})}),a.jsx(ii,{path:"/curriculum/master",element:a.jsx(pOe,{})}),a.jsx(ii,{path:"/curriculum/master/:id",element:a.jsx(VF,{})}),a.jsx(ii,{path:"/curriculum/master/new",element:a.jsx(VF,{})}),a.jsx(ii,{path:"/curriculum/department",element:a.jsx(mOe,{})}),a.jsx(ii,{path:"/curriculum/elective-import",element:a.jsx(wa,{user:e,requiredPermissions:["curriculum.import_elective_choices"],element:a.jsx(gOe,{})})}),a.jsx(ii,{path:"/obe",element:a.jsx(EK,{})}),a.jsx(ii,{path:"/obe/course/:code/lca/cotarget",element:a.jsx(sMe,{})}),a.jsx(ii,{path:"/obe/course/:code/*",element:a.jsx(OOe,{})}),a.jsx(ii,{path:"/obe/request",element:a.jsx(wa,{user:e,requiredProfile:"STAFF",element:a.jsx(MOe,{})})}),a.jsx(ii,{path:"/obe/master/requests",element:a.jsx(wa,{user:e,requiredPermissions:["obe.master.manage"],element:a.jsx(cOe,{})})}),a.jsx(ii,{path:"/obe/master/due-dates",element:a.jsx(wa,{user:e,requiredPermissions:["obe.master.manage"],element:a.jsx(k3,{})})}),a.jsx(ii,{path:"/academic",element:a.jsx(wOe,{})}),a.jsx(ii,{path:"/hod/advisors",element:a.jsx(wa,{user:e,requiredRoles:["HOD"],requiredPermissions:["academics.assign_advisor"],element:a.jsx(LOe,{})})}),a.jsx(ii,{path:"/hod/obe-requests",element:a.jsx(wa,{user:e,requiredRoles:["HOD"],requiredPermissions:["academics.assign_advisor"],element:a.jsx(FOe,{})})}),a.jsx(ii,{path:"/advisor/teaching",element:a.jsx(wa,{user:e,requiredRoles:["ADVISOR"],requiredPermissions:["academics.assign_teaching"],element:a.jsx(ROe,{})})}),a.jsx(ii,{path:"/iqac/timetable",element:a.jsx(wa,{user:e,requiredPermissions:["timetable.manage_templates"],element:a.jsx(_re,{})})}),a.jsx(ii,{path:"/iqac/academic-controller",element:a.jsx(wa,{user:e,requiredRoles:["IQAC"],requiredPermissions:["obe.master.manage"],element:a.jsx(tne,{})})}),a.jsx(ii,{path:"/iqac/academic-controller/course/:courseCode",element:a.jsx(wa,{user:e,requiredRoles:["IQAC"],requiredPermissions:["obe.master.manage"],element:a.jsx(ine,{})})}),a.jsx(ii,{path:"/iqac/academic-controller/course/:courseCode/marks/:taId",element:a.jsx(wa,{user:e,requiredRoles:["IQAC"],requiredPermissions:["obe.master.manage"],element:a.jsx(OPe,{})})}),a.jsx(ii,{path:"/iqac/academic-controller/course/:courseCode/internal-mark/:taId",element:a.jsx(wa,{user:e,requiredRoles:["IQAC"],requiredPermissions:["obe.master.manage"],element:a.jsx(lOe,{})})}),a.jsx(ii,{path:"/iqac/academic-controller/course/:courseCode/obe/:taId/*",element:a.jsx(wa,{user:e,requiredRoles:["IQAC"],requiredPermissions:["obe.master.manage"],element:a.jsx(oOe,{})})}),a.jsx(ii,{path:"/iqac/obe-requests",element:a.jsx(wa,{user:e,requiredPermissions:["obe.master.manage"],element:a.jsx(R9,{})})}),a.jsx(ii,{path:"/advisor/timetable",element:a.jsx(wa,{user:e,requiredRoles:["ADVISOR"],requiredPermissions:["timetable.assign"],element:a.jsx(Sre,{})})}),a.jsx(ii,{path:"/advisor/students",element:a.jsx(wa,{user:e,requiredRoles:["ADVISOR"],requiredPermissions:["academics.view_my_students"],element:a.jsx(BOe,{})})}),a.jsx(ii,{path:"/advisor/mentor",element:a.jsx(wa,{user:e,requiredRoles:["ADVISOR"],requiredPermissions:["academics.assign_mentor"],element:a.jsx(eMe,{})})}),a.jsx(ii,{path:"/student/timetable",element:a.jsx(wa,{user:e,requiredProfile:"STUDENT",requiredPermissions:["timetable.view"],element:a.jsx(DOe,{})})}),a.jsx(ii,{path:"/student/attendance",element:a.jsx(wa,{user:e,requiredProfile:"STUDENT",element:a.jsx(KOe,{})})}),a.jsx(ii,{path:"/staff/timetable",element:a.jsx(wa,{user:e,requiredProfile:"STAFF",requiredPermissions:["timetable.view"],element:a.jsx(zOe,{})})}),a.jsx(ii,{path:"/staff/assigned-subjects",element:a.jsx(wa,{user:e,requiredProfile:"STAFF",requiredPermissions:["academics.view_assigned_subjects"],element:a.jsx(HOe,{})})}),a.jsx(ii,{path:"/staff/period-attendance",element:a.jsx(wa,{user:e,requiredProfile:"STAFF",requiredPermissions:["academics.mark_attendance"],element:a.jsx(VOe,{})})}),a.jsx(ii,{path:"/staff/analytics",element:a.jsx(wa,{user:e,requiredProfile:"STAFF",requiredPermissions:["academics.view_all_attendance","academics.view_attendance_overall","academics.view_all_departments","academics.view_department_attendance","academics.view_class_attendance","academics.view_section_attendance"],element:a.jsx(GOe,{})})}),a.jsx(ii,{path:"/staff/mentees",element:a.jsx(wa,{user:e,requiredProfile:"STAFF",requiredPermissions:["academics.view_mentees"],element:a.jsx(tMe,{})})}),a.jsx(ii,{path:"*",element:e?a.jsx(Jp,{to:"/dashboard",replace:!0}):a.jsx(bj,{user:e})})]})})})]}):a.jsx("div",{className:"pt-16",children:a.jsxs(b4,{children:[a.jsx(ii,{path:"/",element:e?a.jsx(Jp,{to:"/dashboard",replace:!0}):a.jsx(bj,{user:e})}),a.jsx(ii,{path:"*",element:e?a.jsx(Jp,{to:"/dashboard",replace:!0}):a.jsx(bj,{user:e})})]})})]}))}function sMe(){const{code:e}=z0(),t=e?decodeURIComponent(e):void 0;return a.jsx(kK,{courseCode:t})}function oMe(){const[e,t]=x.useState(""),[r,n]=x.useState(""),[i,s]=x.useState(!1),[o,l]=x.useState(null),[c,u]=x.useState(!1),d=xo();function f(p){if(typeof p!="object"||p===null)return null;const g=p.response;if(!g)return null;const y=g.data;if(!y)return null;const b=y.non_field_errors;return Array.isArray(b)&&b.length>0?String(b[0]):typeof y.detail=="string"?y.detail:null}const h=async p=>{p.preventDefault(),l(null),u(!0);try{await XD(e,r),d("/dashboard")}catch(m){const g=f(m)||"Login failed";l(g)}finally{u(!1)}};return a.jsxs(a.Fragment,{children:[a.jsx(i9,{user:null}),a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:a.jsx("div",{className:"max-w-md w-full",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 sm:p-10",children:[a.jsxs("div",{className:"mb-8 text-center",children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Welcome Back"}),a.jsx("p",{className:"text-gray-600",children:"Sign in to access your account"})]}),a.jsxs("form",{className:"space-y-6",onSubmit:h,children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",htmlFor:"identifier",children:"Email or Register No"}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(b3,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"identifier",type:"text",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"College Email or Reg. No.",value:e,onChange:p=>t(p.target.value),required:!0,disabled:c})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",htmlFor:"password",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(i0,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"password",type:i?"text":"password",className:"block w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"Enter your password",value:r,onChange:p=>n(p.target.value),required:!0,disabled:c}),a.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 transition-colors",onClick:()=>s(!i),"aria-label":i?"Hide password":"Show password",children:i?a.jsx(Jee,{className:"h-5 w-5"}):a.jsx(r9,{className:"h-5 w-5"})})]})]}),a.jsx("div",{className:"flex items-center justify-end",children:a.jsx(es,{to:"/forgot-password",className:"text-sm font-medium text-blue-600 hover:text-blue-700 transition-colors",children:"Forgot Password?"})}),o&&a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3",children:[a.jsx(rd,{className:"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-sm text-red-800",children:o})]}),a.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 disabled:opacity-60 disabled:cursor-not-allowed transform hover:scale-[1.02] active:scale-[0.98]",disabled:c,children:c?a.jsxs("span",{className:"flex items-center justify-center gap-2",children:[a.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing In..."]}):"Sign In"}),a.jsx("div",{className:"text-center pt-4",children:a.jsx(es,{to:"/",className:"text-sm text-gray-600 hover:text-gray-900 font-medium transition-colors",children:" Back to Home"})})]})]})})})]})}mD(document.getElementById("root")).render(a.jsx(on.StrictMode,{children:a.jsx(DJ,{children:a.jsx(Yte,{children:a.jsxs(b4,{children:[a.jsx(ii,{path:"/login",element:a.jsx(oMe,{})}),a.jsx(ii,{path:"/*",element:a.jsx(aMe,{})})]})})})}));export{Hi as _,cMe as c,af as g};
